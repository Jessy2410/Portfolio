'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1308:function(A,u,a){u=a(483);a=a(1483);a=a.Qw?a.default:a;"string"===typeof a&&(a=[[A.i,a,""]]);u(a,{insert:"head",eD:!1});A.exports=a.EH||{}},1483:function(A,u,a){u=a(484)(!1);u.push([A.i,".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}",
""]);A.exports=u},1484:function(A,u,a){(function(c){a.d(u,"a",function(){return J});var b=a(0),h=a(15),r=a(189),f=a(153),l=a(1485),m=a(40),x=a(287),n=a(46),t=a(427),w=a(216),v=a(64),k=a(83),y=a(12),C=a(23),B=a(47),E=a(1486),K=a(1),F=a(101),W=a(5);class J extends m.a{constructor(L,M,Q,H){super();this.Q9i=l.a.getTypeName();this.nUb=this.D4=this.Nh=null;this.imageHeight=this.imageWidth=0;this.H0a=this.errorMessage=this.tableData=null;this.ASd=0;this.Zmd=!1;this.ynf=ba=>{if(ba){var U={};if((()=>{let X=
B.d(this.Rbi(ba.data));({zz:U}=X);return X})().returnValue){var D=Object(f.a)(Object,U);if("."===D.DataFromPictureWildcard)if(D.SessionId!==this.H0a)h.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(h.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),D.CmdType){case "ACK":this.Zmd=!0;
this.C_g.stop();h.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.Wzk();0<this.errorMessage.length?this.gNg():0<this.tableData.length&&this.yNg();break;case "insert_html":const X=this.$.pa.ta,Y={};var I=C.f(this.$).ha.qa.jj.clone();Y.PasteId=r.a.create().toString();Y.DestinationRanges=n.u(n.x(I,this.$));I=D.Parameters.split("|",3);K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||h.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${I[0]}|${I[1]}|${I[2]}.`);I=D.Parameters.indexOf("|");I=D.Parameters.indexOf("|",I+1);I=D.Parameters.indexOf("|",I+1);Y.SourceHtml=D.Parameters.substring(I+1);Y.CopyOperationId=null;const ja=X.$a(1,X.Vh());ja.pasteHtmlParameters=Y;t.a(this.$.userOperationManager,(Ua,ka,fb)=>v.h(X,"pasteHtmlContent",ja,Ua,ka,fb,null,64),Ua=>new w.a(204,0,Ua,1),null);this.ASd++;h.ULS.sendTraceTag(523805135,
0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.ASd.toString()}`);F.b("DataFromPictureCompleted")}}}};this.P9i=(ba,U)=>{if(ba=U.annotation)if(!U.parentPath||1>=U.parentPath.length||U.parentPath[1]!==this.H0a)h.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{h.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");
U=ba.errorCode;switch(U){case null:case -1:this.errorMessage=y.a.instance.ia(2273);break;case 1:this.errorMessage=y.a.instance.ia(2274);break;case 2:this.errorMessage=y.a.instance.ia(2275)}0<this.errorMessage.length&&h.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${U?U.toString():"null"}.`);this.T6e.stop();this.tableData=ba.html;this.Zmd&&(0<this.errorMessage.length?this.gNg():0<this.tableData.length&&this.yNg())}else h.ULS.sendTraceTag(523805125,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=L;this.ddaFacade=H;this.Yo=M;this.uploaderCreator=Q;this.initialize()}dispose(){window.removeEventListener("message",this.ynf,!1);this.Yo.unregister("DataFromPicture");super.dispose()}T_j(L,M){h.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let Q=new Image;Q.onload=()=>{var H=document.createElement("canvas");H.width=Q.width;H.height=Q.height;const ba=
H.getContext("2d");try{ba.drawImage(Q,0,0,Q.width,Q.height)}catch(I){h.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${I.message}`);return}let U;try{U=H.toDataURL("image/jpeg")}catch(I){h.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${I.message}`);return}H=U.split(",");if(2>H.length)h.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{H=H[1];try{var D=window.self.atob(H)}catch(I){h.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${I.message}`);return}28E5<D.length?(h.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),M.jPk()):(this.Gvk(this.Nh,this.D4,H,Q.width,Q.height),URL.revokeObjectURL(Q.src),Q=null,h.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
Q.src=L}w9j(L,M,Q,H){this.Nh=L;this.D4=H;this.uploaderCreator.fcj(this.$,M,Q,H,this)}Gvk(L,M,Q,H,ba){this.H0a=r.a.create().toString();this.ASd=0;this.nUb=Q;this.imageWidth=H;this.imageHeight=ba;this.errorMessage=this.tableData="";this.Zmd=!1;this.C_g=this.$.Eh.em("LoadResource","DataFromPictureTaskpaneLaunch");this.C_g.start();this.z2j(L,M);this.T6e=this.$.Eh.em("LoadResource","DataFromPictureAnnotation");this.T6e.start();this.Bal()}Bal(){if(this.nUb.length){var L=window.self.atob(this.nUb),M=new Uint8Array(L.length);
for(let Q=0;Q<L.length;Q++)M[Q]=L.charCodeAt(Q);this.Yo.Aal(M,this.H0a,this.imageWidth,this.imageHeight)}else h.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}z2j(L,M){M.SessionID=this.H0a;M.DataFromPictureAssetId="FA000000050";M.LoadDataFromPictureTaskpane=!0;L=new k.a(-859308420,L.method,L.mode,L.jk,L.tabName);this.$.Ma.qh(L,M)}$Dd(L){try{const M=c.from(L,"utf16le").toString("base64");return E.a.OXa(this.H0a,M)}catch(M){return h.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Rbi(L){try{const M=E.a.OXa(this.H0a,L);return c.from(M,"base64").toString("utf16le")}catch(M){return h.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}Wzk(){if(this.nUb.length){var L=W.xb.Aa()?this.ddaFacade.x5("FA000000050"):x.a(this.$).x5("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.imageData=this.$Dd(this.nUb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(L,
"onCustomMessage",M,Q=>{Q&&h.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else h.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}yNg(){if(this.tableData.length){var L=W.xb.Aa()?this.ddaFacade.x5("FA000000050"):x.a(this.$).x5("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.tableHtml=this.$Dd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(L,
"onCustomMessage",M,Q=>{Q&&h.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else h.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}gNg(){if(this.errorMessage.length){var L=W.xb.Aa()?this.ddaFacade.x5("FA000000050"):x.a(this.$).x5("FA000000050"),M={["DataFromPictureWildcard"]:"."};M.errorMessage=this.$Dd(this.errorMessage);
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(L,"onCustomMessage",M,Q=>{Q&&h.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else h.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.ynf,!1);this.Yo.register(this.Yo.J5().n8("DataFromPicture").m8(()=>
{}).activateAnnotation({annotationType:this.Q9i,Ny:!1,BV:this.P9i}).build())}}Object(b.a)(J,"DataFromPictureManager",m.a,[884])}).call(this,a(774).Buffer)},1485:function(A,u,a){a.d(u,"a",function(){return b});A=a(0);u=a(938);var c=a(913);class b extends u.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.getBaseTypes()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(A.a)(b,"DetectedHtmlTableAnnotation",u.a,[])},1486:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{static OXa(b,h){if(!(b&&h&&b.length&&h.length)||256<b.length)return"";const r=Array(256),f=Array(256);let l,m=0,x=0;let n,t="";for(l=0;256>l;l++)r[l]=l;for(l=0;256>l;l++){var w=b.charCodeAt(l%b.length);if(256<=w)return"";m=(m+r[l]+w)%256;w=r[l];r[l]=r[m];r[m]=w}for(l=0;256>l;l++)f[l]=r[256-l-1];m=l=0;for(b=0;b<h.length;b++){l=(l+1)%256;m=(m+r[l])%256;w=r[l];r[l]=r[m];r[m]=w;w=h.charCodeAt(b);
if(256<=w)return"";n=w^r[(r[l]+r[m])%256];x=(x+f[l])%256;w=f[l];f[l]=f[x];f[x]=w;t+=String.fromCharCode(n^r[(f[l]+f[x])%256])}return t}}Object(A.a)(c,"RC4A",null,[])},185:function(A,u,a){function c(G,ta){if(!ta)return G;ta=ta.sheet;if(!ta)return G;ta=ta.cssRules;if(!ta)return G;var jb=Array.clone(ta);jb.reverse();let sc=ta=0,Vc=0,nd=0;for(const Hd of jb){jb=Hd.style;var xd=Hd.selectorText;jb=jb?jb.cssText:null;xd=xd?xd.split(","):null;if(jb&&xd&&Hd.type===Hd.STYLE_RULE){nd+=xd.length;for(const ke of xd){0<=
ke.indexOf("#")&&ta++;0<=ke.indexOf(".")&&sc++;0>ke.indexOf("#")&&0>ke.indexOf(".")&&Vc++;xd=null;try{xd=G.querySelectorAll(ke)}catch(V){I.ULS.sendTraceTag(507536148,0,50,"Exception in querySelectorAll: {0}",V.message)}if(xd)for(let V=0;V<xd.length;V++)xd[V].setAttribute("style",jb+(xd[V].getAttribute("style")||""))}}}I.ULS.sendTraceTag(507536147,0,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",nd,ta,sc,Vc);return G}function b(G){if(void 0===G||-1===
G.indexOf("px"))return 0;G=G.match(Uf);let ta=11;G&&(1===G.length?ta=parseFloat(G[0]):3===G.length&&(ta=parseFloat(G[1])));return Xd.HelperMethods.dSc(ta)}function h(G){const ta=[];if("none"!==G.borderTopStyle&&""!==G.borderTopStyle){var jb=b(G.borderTopWidth);ta.push({BorderLineStyle:r(G.borderTopStyle,jb),BorderPosition:0,Weight:jb,Color:f(G.borderTopColor)})}"none"!==G.borderBottomStyle&&""!==G.borderBottomStyle&&(jb=b(G.borderBottomWidth),ta.push({BorderLineStyle:r(G.borderTopStyle,jb),BorderPosition:1,
Weight:jb,Color:f(G.borderBottomColor)}));"none"!==G.borderLeftStyle&&""!==G.borderLeftStyle&&(jb=b(G.borderLeftWidth),ta.push({BorderLineStyle:r(G.borderTopStyle,jb),BorderPosition:2,Weight:jb,Color:f(G.borderLeftColor)}));"none"!==G.borderRightStyle&&""!==G.borderRightStyle&&(jb=b(G.borderRightWidth),ta.push({BorderLineStyle:r(G.borderTopStyle,jb),BorderPosition:3,Weight:jb,Color:f(G.borderRightColor)}));return ta}function r(G,ta){switch(G){case "solid":return 1>ta?1:1.5>ta?2:5;case "dashed":return 1>
ta?3:8;case "double":return 6;case "dotted":return 4;case "dotDash":return 10;case "dotDotDash":return 1>ta?12:10;case "dotDashSlanted":return 13;case "triple":return 6;case "hairline":return 7;default:return 0}}function f(G){const ta={};if(void 0===G||""===G)return ta.Red=0,ta.Green=0,ta.Blue=0,ta;Ua.a.compare(G,"windowtext",!0)?(G=Cd.a.Ou(G),ta.Red=G.r,ta.Green=G.g,ta.Blue=G.b):(ta.Red=0,ta.Green=0,ta.Blue=0);return ta}function l(G){G=Cd.a.Ou(G);return Cd.a.DJ(G)}function m(G,ta,jb,sc,Vc){try{if(ta&&
G.parentElement){jb.fontFamily="Aptos Narrow";if(Vc.map(Hd=>Hd.sHa.fontFamily).some(Hd=>Hd)&&ta.fontFamily){const Hd=ta.fontFamily.replace(/['"]+/g,"").split(",");0<Hd.length&&(Bf.hasOwnProperty(Hd[0])?jb.fontFamily=Bf[Hd[0]]:jb.fontFamily=Hd[0])}jb.fontSize=11;const nd=Vc.map(Hd=>Hd.sHa.fontSize),xd=Vc.map(Hd=>Hd.element.tagName);(nd.some(Hd=>Hd)||xd.some(Hd=>ce.includes(Hd)))&&ta.fontSize&&(jb.fontSize=Math.round(b(ta.fontSize)));ta.fontWeight&&700<=parseInt(ta.fontWeight,10)&&(jb.bold=!0);jb.borders=
h(ta);ta.textDecoration&&"underline"===ta.a0g&&("solid"===ta.b0g?jb.Nwe=1:"double"===ta.b0g&&(jb.Nwe=2));ta.textDecoration&&"line-through"===ta.a0g&&(jb.yBf=!0);jb.color="#000000";Vc.map(Hd=>Hd.sHa.color).some(Hd=>Hd)&&ta.color&&(jb.color=l(ta.color));if(sc){const Hd=G.parentElement.closest("td,th");jb.backgroundColor=Hd.style.backgroundColor?l(Hd.style.backgroundColor):""}if("italic"===ta.fontStyle||"oblique"===ta.fontStyle)jb.italic=!0}}catch(nd){I.ULS.sendTraceTag(507377813,0,10,"CssStyleProcessor.setHtmlCellStyle: Error while setting cell style",
nd)}return jb}a.r(u);var x={};a.r(x);a.d(x,"FocusBasedReadout",function(){return Ca});var n={};a.r(n);a.d(n,"AriaLiveNotifier",function(){return Va});var t={};a.r(t);a.d(t,"DataFromPictureCommandHandler",function(){return sa});var w={};a.r(w);a.d(w,"EmbeddedWorkbookReadoutHandler",function(){return ab});var v={};a.r(v);a.d(v,"EwaAccessibilityManager",function(){return La});var k={};a.r(k);a.d(k,"GridHighlightBehaviorEventManager",function(){return fa});var y={};a.r(y);a.d(y,"GridHighlightsBehaviorManager",
function(){return Wb});var C={};a.r(C);a.d(C,"PictureCommandHandler",function(){return sd});var B={};a.r(B);a.d(B,"PasteIndicationManager",function(){return af});var E={};a.r(E);a.d(E,"PasteShortcutManager",function(){return uf});var K={};a.r(K);a.d(K,"SelectionReadoutHandler",function(){return le});var F={};a.r(F);a.d(F,"SessionReloadActivity",function(){return Ra});var W={};a.r(W);a.d(W,"SessionReloadSilentActivity",function(){return ma});var J={};a.r(J);a.d(J,"SparklineManager",function(){return Xb});
var L={};a.r(L);a.d(L,"TableManager",function(){return Ke});var M={};a.r(M);a.d(M,"UploaderCreator",function(){return Ma});var Q={};a.r(Q);a.d(Q,"WorkbookReadoutHandler",function(){return Na});var H={};a.r(H);a.d(H,"HtmlProcessor",function(){return ug});var ba={};a.r(ba);a.d(ba,"PastableIframe",function(){return ag});var U=a(135),D=a(0),I=a(15),X=a(29),Y=a(7),ja=a(16),Ua=a(28),ka=a(12),fb=a(438),ha=a(23),ea=a(33);class aa{constructor(G){this.QWc=G||""}static get $sf(){return aa.lLe||(aa.lLe=new aa(""))}static get O3d(){return aa.URe||
(aa.URe=aa.pga(2).QWc)}static Owa(G){G=ea.a.Or(G||"");return new aa(G)}static IQb(G){return aa.Owa(ka.a.instance.ia(G))}static pga(G){return new aa(ka.a.instance.Ea(G))}static oCf(G,...ta){return aa.uAi(ka.a.instance.sh(G),...ta)}static uAi(G,...ta){const jb=ta.length,sc=Array(jb);for(let Vc=0;Vc<jb;Vc++)sc[Vc]=(ta[Vc]||aa.$sf).QWc;return new aa(String.format(G,sc))}}aa.lLe=null;aa.URe=null;Object(D.a)(aa,"SafeHtml",null,[258]);const ca=(G,ta)=>{ta&&(G.append(ta),G.append(aa.O3d))};var xa=a(1),Oa=
a(181),ua=a(126),Ia=a(161),Sa=a(103),Ya=a(955),da=a(35),Ea=a(248),oa=a(5),za=a(95),la;let Ca=la=class{constructor(G,ta,jb){this.nca=this.c2=this.QV=null;this.Kwa=oa.uc.Aa()?ta.cellTextEditBox.Wa.Yl:jb;this.n9h(G);this.q9j()}get isActive(){return!!this.Kwa&&document.activeElement===this.Kwa}readText(G){G=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?G:String.format(ka.a.instance.sh(30),G);this.QV.setAttribute(Y.a.tD,G);this.c2.setAttribute(Y.a.tD,
G);this.zXk()}dispose(){this.nca&&this.nca.parentNode&&this.nca.parentNode.removeChild(this.nca);this.c2=this.QV=this.nca=this.Kwa=null}n9h(G){var ta=G.xi+"readoutElementWrapper";const jb=G.xi+"readoutElement1",sc=G.xi+"readoutElement2";this.nca=document.getElementById(ta);this.nca||(this.nca=document.createElement(Ea.a.div),this.nca.id=ta,this.QV=document.createElement(Ea.a.label),this.QV.id=jb,this.QV.setAttribute(Y.a.ik,Y.a.yoc),this.QV.setAttribute("aria-roledescription",""),this.QV.setAttribute("aria-multiline",
!1),this.c2=document.createElement(Ea.a.label),this.c2.id=sc,this.c2.setAttribute(Y.a.ik,Y.a.yoc),this.c2.setAttribute("aria-roledescription",""),this.c2.setAttribute("aria-multiline",!1),this.QV.style.width="0px",this.QV.style.height="0px",this.c2.style.width="0px",this.c2.style.height="0px",this.QV.tabIndex=-1,this.c2.tabIndex=-1,this.nca.appendChild(this.QV),this.nca.appendChild(this.c2),G=G.xi+Y.a.tsc,ta=document.getElementById(G),I.ULS.shipAssertTag(537153942,3,!!ta,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${G}`),
ta&&ta.appendChild(this.nca))}q9j(){this.Kwa&&this.QV&&this.c2&&(this.Kwa.setAttribute(Y.a.Nea,this.QV.id),this.Kwa.setAttribute(Y.a.xoc,`${this.QV.id} ${this.c2.id}`))}zXk(){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.isActive){let G="";ja.DOMElementExtensions.hasAttribute(this.Kwa,Y.a.Nea)&&(G=this.Kwa.getAttribute(Y.a.Nea).toString());this.Kwa.setAttribute(Y.a.Nea,G===this.QV.id?this.c2.id:this.QV.id)}this.isActive||I.ULS.sendTraceTag(537153941,
0,50,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static nob(){if(null==la.sQb)if(da.a.Foa){if(la.sQb=!1,da.a.vP||da.a.Am)la.sQb=!0}else la.sQb=!0;return la.sQb}};Ca.sQb=null;Ca=la=Object(U.__decorate)([Object(za.d)(oa.uc),Object(U.__param)(0,Object(oa.Nb)()),Object(U.__param)(1,Object(oa.id)())],Ca);Object(D.a)(Ca,"FocusBasedReadout",null,[238,4]);let Va=class{constructor(G,ta,jb,sc){jb=void 0===jb?G.pK:jb;sc=void 0===sc?G.Bl:sc;this.dNg=()=>{this.$.ea.ki||Oa.a.sendTelemetryEvent({name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",
dataFields:ua.a.Rm({["AriaLiveOffCount"]:this.nHe,["AriaLivePoliteCount"]:this.oHe,["AriaLiveAssertiveCount"]:this.mHe,["AriaLiveRudeCount"]:this.pHe,["ScreenReaderDivCount"]:this.nXe,["AlertScreenReaderDivCount"]:this.XGe,["AuxScreenReaderDivCount"]:this.xHe,["AriaAlertCount"]:this.kHe,["ReadCommandOnCompletionCount"]:this.SVe,["TotalAriaLiveRegionUpdates"]:this.a_e})})};this.$=G;this.Bi=void 0===ta?null:ta;this.cka=document.createElement("div");this.cka.setAttribute(Y.a.Oea,Y.a.Jr);this.cka.className=
X.J;jb.insertBefore(this.cka,sc);this.dla=document.createElement("div");this.dla.setAttribute(Y.a.Oea,Y.a.Jr);this.dla.className=X.J;jb.insertBefore(this.dla,this.cka);this.jph=ka.a.instance.Ea(2);this.Rea=document.createElement("div");this.Rea.setAttribute(Y.a.ik,Y.a.wua);this.Rea.setAttribute(Y.a.xua,Y.a.JGa);this.Rea.className=X.J;jb.insertBefore(this.Rea,this.dla);this.a_e=this.SVe=this.kHe=this.xHe=this.XGe=this.nXe=this.pHe=this.mHe=this.oHe=this.nHe=0;this.register();xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)||this.$.la.Hh(211,this)}get D3a(){return this.jph}get isActive(){return!0}get DGh(){return this.cka}get Jxk(){return this.dla}get activeCell(){return ha.f(this.$).zh(null)}dispose(){this.$&&this.unregister();ja.DOMElementExtensions.an(this.Rea);ja.DOMElementExtensions.an(this.cka);ja.DOMElementExtensions.an(this.dla);this.dla=this.cka=this.Rea=this.$=null}setEnabled(G){this.TOg(this.dla,G)}wDk(){this.TOg(this.cka,!0)}readText(G){this.g4b(aa.Owa(G),!0)}mca(G){this.g4b(aa.Owa(G),!1)}cBg(G,ta){if(1>
ta||!G)I.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var jb=new Sys.StringBuilder;G=String.format(ka.a.instance.sh(34),ta,G);ca(jb,G);ca(jb,ka.a.instance.ia(857));this.g4b(aa.Owa(jb.toString()),!1)}}Mek(G,ta,jb){if(1>jb||1>ta||ta>jb||!G)I.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var sc=new Sys.StringBuilder;ca(sc,G);sc.append(String.format(ka.a.instance.sh(55),ta,jb));this.g4b(aa.Owa(sc.toString()),!1)}}Kek(G){G=this.nVi(G);this.g4b(G,
!1,!0)}g4b(G,ta,jb){jb=void 0===jb?!1:jb;if(G=G?G.QWc:null)ta=ta?this.dla:this.cka,Ua.a.equals(ta.innerHTML,G,!1)&&(G+=aa.O3d),this.M1g(ta,jb),this.Bi.hr(ta,G)}HOa(G,ta){this.Rea.getAttribute(Y.a.xua)!==ta&&this.Rea.setAttribute(Y.a.xua,ta);G=G?aa.Owa(G).QWc:"";this.M1g(this.Rea);this.Bi.hr(this.Rea,G)}Nek(G,ta,jb,sc){var Vc=!0;Vc=void 0===Vc?!1:Vc;const nd=ka.a.instance.sh(54);I.ULS.shipAssertTag(537153949,0,!(void 0===G||null===G));I.ULS.shipAssertTag(537153948,0,!(void 0===ta||null===ta));I.ULS.shipAssertTag(537153947,
0,!(void 0===jb||null===jb));I.ULS.shipAssertTag(537153946,0,!(void 0===sc||null===sc));I.ULS.shipAssertTag(537153945,0,!(void 0===nd||null===nd));G=String.format(nd,G||"",ta||"",jb||"",sc||"");Vc?this.HOa(G,Y.a.KGa):this.readText(G)}I6k(G){var ta=this.dla.style;G?(G=fb.a.wQh(G.cell,ta),ta=G.hF,ta.top=ta.left=ta.bottom=ta.right=null,G.n$()):ta.cssText=""}nVi(G){if(6!==G.jk)return null;const ta=this.activeCell;if(!ta)return null;switch(G.command){case -1985798686:return aa.IQb(12);case -911352779:return aa.IQb(11);
case 237279923:return aa.IQb(13);case -1502853784:return aa.pga(81);case -111689794:return aa.pga(78);case 368460465:G=ha.f(this.$).oh.Kl(ta.range,!0);if(null!==G)return this.F_a(2291,!G.hasAutoFilter,!1);G=this.$.sa.ma;if(!G)break;return this.F_a(2291,null===G.rL,!1);case -1522760979:return this.F_a(1150,ha.f(this.$).isFormulaView,!1);case 1941920197:return aa.IQb(836);case 1051390410:return aa.pga(589);case 1542466017:return aa.pga(591);case -706918724:return aa.pga(590);case 369708605:return aa.pga(592);
case -1215659745:return aa.pga(523);case 1783960667:return aa.pga(521);case -1355155015:return aa.pga(554);case -1158102843:return aa.pga(522);case -287251124:return G=this.yHc(G.command,ta),null===G?null:this.F_a(1333,G);case -1925065947:return G=this.yHc(G.command,ta),null===G?null:this.F_a(1334,G);case 1764140053:return G=this.yHc(G.command,ta),null===G?null:this.F_a(1335,G);case -1590502662:return G=this.yHc(G.command,ta),null===G?null:this.F_a(1336,G);case 862890474:case 963349338:G=this.bKa(ta);
if(null===G)break;G=aa.Owa(String(G));return aa.oCf(214,G);case 1896159024:return aa.Owa(ka.a.instance.sh(228));case -1554384558:return aa.Owa(ka.a.instance.sh(229))}return null}register(){I.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(I.ULS.shipAssertTag(537153943,0,!!this.$.Ma,"Can't register to CommandHandlerManager's event"),this.$.ea&&this.$.ea.dK(this.dNg))}unregister(){this.$&&this.$.ea.hL(this.dNg)}TOg(G,ta){const jb=G===this.cka;ta?(jb&&Ca.nob()||
G.setAttribute(Y.a.xua,Y.a.KGa),jb&&G.setAttribute(Y.a.ik,Y.a.wua),G.setAttribute(Y.a.Oea,Y.a.nC),G.removeAttribute(Y.a.Oea),this.Bi.hr(G,G.innerHTML+" ")):(G.removeAttribute(Y.a.xua),jb&&G.removeAttribute(Y.a.ik),G.setAttribute(Y.a.Oea,Y.a.Jr))}M1g(G,ta){ta=void 0===ta?!1:ta;switch(G.getAttribute(Y.a.xua)){case Y.a.X8e:++this.nHe;break;case Y.a.KGa:++this.oHe;break;case Y.a.JGa:++this.mHe;break;case Y.a.JJh:++this.pHe}switch(G){case this.Jxk:++this.nXe;break;case this.DGh:++this.XGe;break;case this.Rea:++this.xHe}G.getAttribute(Y.a.ik)===
Y.a.wua&&++this.kHe;ta&&++this.SVe;this.a_e++}F_a(G,ta,jb){jb=void 0===jb?!0:jb;return aa.oCf(ta?jb?7:216:jb?8:217,aa.IQb(G))}yHc(G,ta){return ha.f(this.$).ha.$e.isFloatingObjectSelected?this.qlj(G):this.rlj(G,ta)}qlj(G){const ta={};switch(G){case -287251124:G="QueryBold";break;case -1925065947:G="QueryItalics";break;case 1764140053:G="QueryUnderline";break;case -1590502662:G="QueryStrikethrough";break;default:return!1}const jb=Sa.a(this.$);return jb?(jb.e0a(G,ta),ta[Ya.a.On]):!1}rlj(G,ta){if(!ta)return null;
var jb=ha.f(this.$);ta=Ia.a(ta);jb.isEditing&&(ta.Font=jb.Bp.cKa(ta.Font));jb=ta.Font;switch(G){case -287251124:return jb.Bold;case -1925065947:return jb.Italic;case 1764140053:return jb.Underline;case -1590502662:return jb.Strikethrough}return!1}bKa(G){if(!G)return null;const ta=ha.f(this.$);if(ta.ha.$e.isFloatingObjectSelected)return null;G=Ia.a(G);ta.isEditing&&(G.Font=ta.Bp.cKa(G.Font));return G.Font.FontSize}};Va=Object(U.__decorate)([Object(za.d)(oa.l),Object(U.__param)(0,Object(oa.Nb)()),Object(U.__param)(1,
Object(oa.pd)())],Va);Object(D.a)(Va,"AriaLiveNotifier",null,[237,238,4]);var ia=a(97),wa=a(6),Jb=a(1484),$a=a(269),Ka=a(211),nb=a(67);let sa=class{constructor(G,ta,jb,sc){this.sNb=null;this.$=G;this.ddaFacade=sc;ta?(I.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.sNb=new Jb.a(G,ta,jb,this.ddaFacade)):I.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Ri(){return!1}executeCommand(G,
ta,jb){G=!1;switch(ta.command){case 73979048:this.sNb&&this.sNb.w9j(ta,ia.TaskManager.instance,wa.AFrameworkApplication.fa,jb),G=!0}return G?nb.Task.Ua(!0):Ka.a(ta.command)}Gi(G,ta){return 73979048===ta.command&&wa.AFrameworkApplication.rba($a.a)}dj(){return!1}dispose(){this.sNb&&this.sNb.dispose()}};sa=Object(U.__decorate)([Object(za.d)(oa.qb),Object(U.__param)(0,Object(oa.Nb)()),Object(U.__param)(1,Object(oa.p)()),Object(U.__param)(2,Object(oa.Lg)()),Object(U.__param)(3,Object(oa.xb)())],sa);Object(D.a)(sa,
"DataFromPictureCommandHandler",null,[34,4]);class na{constructor(G,ta){this.$=ta;this.ariaLiveNotifier=G}gBg(){const G=this.TEi();this.ariaLiveNotifier.HOa(G,Y.a.JGa)}TEi(){const G=new Sys.StringBuilder;this.$.workbookContext&&ca(G,this.$.workbookContext.WorkbookFileName);ca(G,ka.a.instance.ia(855));ca(G,this.VEi());ca(G,this.UEi());ca(G,ka.a.instance.ia(856));return G.toString()}VEi(){return this.$.isEditMode?ka.a.instance.ia(860):ka.a.instance.ia(861)}UEi(){var G=this.Wdl();const ta=this.$.sa.ma;
G=1!==G?String.format(ka.a.instance.sh(32),G):ka.a.instance.ia(854);G=new Sys.StringBuilder(G);ta&&ta.sheetName&&(G.append(aa.O3d),G.append(String.format(ka.a.instance.sh(33),ta.sheetName)));return G.toString()}Wdl(){let G=0;for(const ta of this.$.sa.items)ta.visible&&G++;return G}}Object(D.a)(na,"WorkbookReadout",null,[]);let ab=class{constructor(G,ta,jb){this.Bmg=()=>{this.DCe.gBg();this.ariaLiveNotifier.setEnabled(!0)};this.$=ta;this.ariaLiveNotifier=G;this.DCe=new na(G,ta);this.Vyc=jb.BNd(this.$);
this.Vyc.$Ch(this.Bmg)}dispose(){this.Vyc&&this.Vyc.gnk(this.Bmg);this.Vyc=this.ariaLiveNotifier=this.$=null}};ab=Object(U.__decorate)([Object(za.d)(oa.Kb),Object(U.__param)(0,Object(oa.l)()),Object(U.__param)(1,Object(oa.Nb)()),Object(U.__param)(2,Object(oa.Qf)())],ab);Object(D.a)(ab,"EmbeddedWorkbookReadoutHandler",null,[4]);var Ja=a(144),Pa=a(283),hb=a(394),ac=a(667),Hc=a(482),bd=a(105),zc=a(305),oc=a(168),Nb=a(87),Aa=a(308),Ub=a(77),Db=a(39),Ib=a(83),yc=a(69),xc=a(673),zb=a(25);class vb extends bd.a{constructor(G,
ta){super(G);this.x3=[];this.mQe=null;this.Q3f=!1;this.j7a=jb=>{let sc="forward";jb.Values[hb.a.direction]?sc=jb.Values[hb.a.direction].toLowerCase():I.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");jb=0;let Vc=!0;"backward"===sc?(jb=this.E0d.length-1,Vc=!1):"forward"===sc?(jb=0,Vc=!0):I.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${sc}`);this.udg(Vc,jb,!1)};this.zmg=()=>{this.x3=[]};this.M4a=jb=>{this.$.shortcutKeyManager.dgk(jb);const sc=
this.$.shortcutKeyManager.FD(jb);if(-411645385===sc&&this.W_f()||this.Q3f&&(369708605===sc||1542466017===sc))this.$.Ma.qh(new Ib.a(sc,1,this.$.hi,6,null),{["event"]:jb},jb),jb.stopPropagation()};this.RVj=jb=>{this.cAa(jb)};this.th=ta;this.lE=ha.f(this.th);this.Q3f=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8797275_unhideRowColKeyBoardCommandBugFix");this.oj.Ba("keydown",this.RVj);this.oj.Ba("keyup",this.M4a);zc.a(ta).yEh(this.zmg);Nb.a(ta.ua,27)&&(oa.nd.Aa()?void za.a.resolve(oa.nd,{va:1}).then(jb=>
{jb.kr(Ja.a.BEc);jb.aq(Ja.a.BEc,this.j7a)}):Db.TaskExtensions.Xa(Ub.GetServiceTaskFactory.Tj(ta.la,21,137,1),jb=>{jb=jb.result;jb.kr(Ja.a.BEc);jb.aq(Ja.a.BEc,this.j7a)},ta.ya))}get $(){return this.th}get E0d(){this.x3.length||(this.x3=this.oIf());return this.x3}get eza(){return this.mQe}set eza(G){this.mQe=G;this.x3=this.oIf()}dispose(){this.$&&zc.a(this.$).rok(this.zmg);this.th=null;this.x3.length=0;super.dispose()}cak(G){this.cAa(G)}udg(G,ta,jb,sc){sc=void 0===sc?null:sc;var Vc=this.uXk(G,ta,void 0===
jb?!0:jb,sc);if(!Vc){jb=ta;var nd=G?1:-1,xd=this.E0d;do{Vc=!1;if(Nb.a(this.$.ua,27)){if(jb+=nd,jb>=xd.length||0>jb)Vc=!0}else jb=(jb+nd+xd.length)%xd.length;if(Vc){this.GCj(G,ta,sc);break}else if(Vc=this.XZg(G,ta,jb,!1,sc))break}while(jb!==ta)}}uXk(G,ta,jb,sc){sc=void 0===sc?null:sc;let Vc=null;0<=ta&&(Vc=this.x3[ta]);return(null===Vc||void 0===Vc?0:Vc.Zo)&&Vc.Vp(G,void 0===jb?!0:jb)?(sc&&yc.g(sc),I.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${Vc.hl} into a sub region`),
Vc.Qs(),!0):!1}XZg(G,ta,jb,sc,Vc){Vc=void 0===Vc?null:Vc;jb=this.x3[jb];const nd=zc.a(this.th).TF(Pa.a.lJa),xd=zc.a(this.th).TF(Pa.a.ZSb),Hd=this.lE.ha.$e.isFloatingObjectSelected;if(jb===xd&&Hd||jb===nd&&!sc&&!Hd)return!1;if((null===jb||void 0===jb?0:jb.Zo)&&jb.Vp(G,!1)){Vc&&yc.g(Vc);jb.Qs();if(G=this.x3[ta])G.nu(),I.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${G.hl} to ${jb.hl}`);return!0}return!1}GCj(G,ta,jb){(jb=void 0===jb?null:jb)&&yc.g(jb);if(ta=this.x3[ta])ta.nu(),I.ULS.sendTraceTag(537166666,
0,50,`Lost focus from section ${ta.hl}`);oa.nd.Aa()?void za.a.resolve(oa.nd,{va:0}).then(sc=>{sc.sendMessage(Ja.a.ZFa,{[hb.a.direction]:G?"forward":"backward"})}):Db.TaskExtensions.Xa(Ub.GetServiceTaskFactory.Tj(this.$.la,21,137,0),sc=>{sc.result.sendMessage(Ja.a.ZFa,{[hb.a.direction]:G?"forward":"backward"})},this.$.ya)}cAa(G){var ta=this.$.isEditMode?oc.a(this.$):null;vb.F_f(ta)&&this.$.shortcutKeyManager.j3k(G,ta.us);if(!this.$.vh.hba||vb.F_f(ta))if(117===G.keyCode&&(G.ctrlKey||yc.b(G))){ta=this.zLf(G.target);
var jb=!G.shiftKey;I.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${ta}`);var sc=zc.a(this.th).TF(Pa.a.i6b);sc=this.x3.indexOf(sc);wa.AFrameworkApplication.ra.$g.ZI&&this.$.E6&&-1!==sc&&ta===sc&&ac.a.GX(this.$.q9b,0);this.udg(jb,ta,!0,G)}else 117!==G.keyCode||vb.Qyf?-411645385===this.$.shortcutKeyManager.FD(G)?this.W_f()&&(this.$.Ma.qh(new Ib.a(-411645385,1,this.$.hi,6,null),{["event"]:G},G),G.stopPropagation()):1588554917===this.$.shortcutKeyManager.FD(G)?
0===this.mode?(xc.a(this.$)||this.$.Ma.qh(new Ib.a(1588554917,1,this.$.hi,6,null),{["event"]:G},G),G.preventDefault(),G.stopPropagation()):3===this.mode&&(G.preventDefault(),G.stopPropagation()):1058684758===this.$.shortcutKeyManager.FD(G)?(ta=this.zLf(G.target),sc=zc.a(this.th).TF(Pa.a.i6b),jb=zc.a(this.th).TF(Pa.a.lJa),sc=this.x3.indexOf(sc),jb=this.x3.indexOf(jb),wa.AFrameworkApplication.ra.$g.ZI&&this.$.E6&&-1!==sc&&ta===sc&&1===this.$.q9b&&ac.a.GX(1,0),-1!==jb&&ta!==jb&&this.XZg(!0,ta,jb,!0,
G)):xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8198803_AddingScopeToShortcuts")&&1===this.$.shortcutKeyManager.SWi(G)?(ta=this.$.shortcutKeyManager.FD(G),I.ULS.sendTraceTag(508342917,0,50,`AccessibilityManager.OnKeyDownHandler : RibbonCommand ${ta} fired in ${this.mode} mode`),0===this.mode?(this.$.Ma.qh(new Ib.a(ta,1,this.$.hi,6,null)),G.preventDefault(),G.stopPropagation()):4===this.mode&&-1966746939===ta&&(G.preventDefault(),G.stopPropagation())):this.O2i(G):(G=Aa.a.eB.VK.PX(Hc.a.oLi(),!1),
G.image=zb.a.Xob()?3:0,Aa.a.eB.VK.EF(G),vb.Qyf=!0)}zLf(G){const ta=this.E0d;for(let jb=0,sc=ta.length;jb<sc;++jb){const Vc=ta[jb];if(Vc&&Vc.tq(G))return jb}return-1}oIf(){const G=[];for(let ta=0,jb=this.eza.length;ta<jb;ta++){const sc=zc.a(this.$).TF(this.eza[ta]);sc&&G.push(sc)}return G}W_f(){return 0===this.mode||4===this.mode}static F_f(G){return G?G.inKeytipMode:!1}}vb.Qyf=!1;Object(D.a)(vb,"AccessibilityManager",bd.a,[882,4]);var bb=a(178);let La=class extends vb{constructor(G){super(document.documentElement,
G);this.TL=0;this.YLh=[Pa.a.Ajf,Pa.a.K7d,Pa.a.fEc,Pa.a.Exe,Pa.a.i6b,Pa.a.eud,Pa.a.LId,Pa.a.xOf,Pa.a.ctd,Pa.a.pwe,Pa.a.zSk,Pa.a.tSg,Pa.a.ZSb,Pa.a.bCf,Pa.a.evd,Pa.a.lJa,Pa.a.gre,Pa.a.ivd,Pa.a.pYg,Pa.a.o7f,Pa.a.Ctd];this.xdl=[Pa.a.fEc,Pa.a.g9g,Pa.a.f9g,Pa.a.h9g];this.A$j=[Pa.a.fEc,Pa.a.vxg,Pa.a.wxg,Pa.a.zxg];this.LUh=[Pa.a.SBf,Pa.a.wOf,Pa.a.RBf,Pa.a.OBf,Pa.a.Hnf];this.W9j=[Pa.a.Ajf,Pa.a.K7d,Pa.a.eud,Pa.a.LId,Pa.a.ctd,Pa.a.pwe,Pa.a.ZSb,Pa.a.evd,Pa.a.lJa,Pa.a.gre,Pa.a.Owg,Pa.a.ivd,Pa.a.Ctd];this.m$j=[Pa.a.ZSb,
Pa.a.PId];const ta=ka.a.instance.Ea(253);this.$Dk=this.$.shortcutKeyManager.Flb(ta);this.mode=0;oa.nd.Aa()?void za.a.resolve(oa.nd,{va:1}).then(jb=>{jb.kr(Ja.a.ZFa);jb.aq(Ja.a.ZFa,this.j7a)}):Db.TaskExtensions.Xa(Ub.GetServiceTaskFactory.Tj(G.la,21,137,1),jb=>{jb=jb.result;jb.kr(Ja.a.ZFa);jb.aq(Ja.a.ZFa,this.j7a)},G.ya)}get mode(){return this.TL}set mode(G){this.TL=G;switch(G){case 0:this.eza=this.YLh;break;case 2:this.eza=this.xdl;break;case 3:this.eza=this.A$j;break;case 4:this.eza=this.LUh;break;
case 5:this.eza=this.W9j;break;case 6:this.eza=this.m$j;break;default:I.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}cAa(G){this.$.Ij&65536&&super.cAa(G)}O2i(G){if(Ua.a.equals(this.$Dk,this.$.shortcutKeyManager.kMd(G),!1)){const ta=bb.b(this.$);if(null===ta||void 0===ta?0:ta.Zo)yc.g(G),ta.Vp(!0,!1)}}};La=Object(U.__decorate)([Object(za.d)(oa.Mb),Object(U.__param)(0,Object(oa.Nb)())],La);Object(D.a)(La,"EwaAccessibilityManager",vb,[]);var pb=a(40);let fa=class extends pb.a{constructor(){super()}PEh(G){this.addHandler("TAF",
G)}Jok(G){this.removeHandler("TAF",G)}Dck(){this.raiseEvent("TAF")}};fa=Object(U.__decorate)([Object(za.d)(oa.ed),Object(U.__param)(0,Object(oa.Nb)())],fa);Object(D.a)(fa,"GridHighlightBehaviorEventManager",pb.a,[867,4]);var kb=a(78),db=a(306),gb=a(17),Kb=a(193),ub=a(140);class lb extends Sys.EventArgs{constructor(G,ta){super();this.start=G;this.CUb=ta}}Object(D.a)(lb,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);class Ba extends pb.a{constructor(G){super();this.Gbg=[3];this.zbb=void 0;
this.da=G}get ED(){if(this.zbb)return this.zbb;const G=oa.Ec.Aa()?za.a.nh(oa.Ec):this.da.$.la.kh(464);G||I.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");G.ED||I.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.zbb=G.ED}mDh(G){this.addHandler("mrek",
G)}lqa(G,ta,jb){for(const sc of this.da.Wu)db.a.instance.xa(gb.a.zv,sc.domElement,G);db.a.instance.xa(gb.a.Co,document.documentElement,ta);this.da.cellTextEditBox.xjb(!0);jb&&db.a.instance.xa(gb.a.bL,this.da.yn,ta)}Vhk(G,ta,jb){document.documentElement.addEventListener("pointermove",G);document.documentElement.addEventListener("pointerup",ta);this.da.cellTextEditBox.xjb(!0);jb&&this.da.yn.addEventListener("pointerleave",ta)}ize(G,ta,jb){for(const sc of this.da.Wu)db.a.instance.Qa(gb.a.zv,sc.domElement,
G);db.a.instance.Qa(gb.a.Co,document.documentElement,ta);this.da.cellTextEditBox.xjb(!1);jb&&db.a.instance.Qa(gb.a.bL,this.da.yn,ta)}E5k(G,ta,jb){document.documentElement.removeEventListener("pointermove",G);document.documentElement.removeEventListener("pointerup",ta);this.da.cellTextEditBox.xjb(!1);jb&&this.da.yn.removeEventListener("pointerleave",ta)}Whk(G,ta){for(const jb of this.da.Wu)Kb.a.instance.xa(gb.a.Jn,jb.domElement,G);Kb.a.instance.xa(gb.a.ml,document.documentElement,ta)}F5k(G,ta){for(const jb of this.da.Wu)Kb.a.instance.Qa(gb.a.Jn,
jb.domElement,G);Kb.a.instance.Qa(gb.a.ml,document.documentElement,ta)}Jkf(G,ta,jb,sc){const Vc=document.createElement("div");Vc.className=ta;for(const nd of jb)Vc.classList.add(nd);G.appendChild(Vc);db.a.instance.xa(gb.a.qj,Vc,sc);return Vc}BLf(G){G=G.li.parentNode;if(!G)return I.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;G=parseInt(G.getAttribute(Y.a.CUb),10);return isNaN(G)?(I.ULS.shipAssertTag(537159393,0,
!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.da.Gh.VU(3,1,G)}V7b(G,ta,jb){G=(void 0===jb?!0:jb)&&!!this.ED&&this.ED.Enj(G);for(const sc of ta)ja.DOMElementExtensions.setVisible(sc,G)}RJd(){return this.da.xA?ub.a(this.da.$):this.da.Fh}rBg(){const G=this.RJd();G&&this.ED?G.$Z(null):(I.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateFormulaHighlights: Can't UpdateFormulaHighlights, will hide all marquee as a last fallback."),
this.da.Gh.Mq(this.Gbg),this.da.Gh.tt(null,this.Gbg))}Dzg(G,ta){this.raiseEvent("mrek",new lb(G,ta))}}Object(D.a)(Ba,"BehaviorHelperMethods",pb.a,[]);var ra=a(94),wb=a(59),mc=a(91);class xb extends bd.a{constructor(G,ta){super(G,void 0===ta?null:ta)}$eb(){}}Object(D.a)(xb,"HighlightFlyweightBehavior",bd.a,[]);var Ec=a(19),ed=a(490),jd=a(65),Xd=a(13),Td=a(137),gc=a(290),nc=a(53),dc=a(265),Gc=a(10),vd=a(57);class zd extends dc.a{constructor(G,ta,jb,sc){super(document.createElement("div"));this.Ttc=
null;this.Obc=!1;this.onPointerDown=Vc=>{Vc=this.zoomManager?this.zoomManager.il(Vc):Vc;this.Obc=!1;if(3===(jd.a.rh=Vc.Dh)){const nd=Vc.La.rawEvent,xd=nd.srcElement||nd.target;ja.DOMElementExtensions.eo(this.domElement,xd)&&ja.DOMElementExtensions.eo(nd.currentTarget,xd)&&(this.Obc=!0,this.Ttc=Vc.clientPoint)}return!1};this.Bo=Vc=>{Vc=this.zoomManager?this.zoomManager.il(Vc):Vc;this.raiseEvent("GrPointerUp",Vc);return this.Obc=!1};this.Rr=Vc=>{Vc=this.zoomManager?this.zoomManager.il(Vc):Vc;3===Vc.Dh&&
this.Obc&&this.z6i(Vc.clientPoint)&&(this.raiseEvent("GrDrag"),this.Obc=!1);return!1};this.vj=Vc=>{this.zoomManager&&this.zoomManager.il(Vc);return!0};this.$=jb;this.zoom=sc;this.domElement.classList.add(vd.pb);this.domElement.classList.add(vd.rb);G.appendChild(this.domElement);ja.DOMElementExtensions.setVisible(this.domElement,!1);this.a0a=document.createElement("div");this.a0a.classList.add(vd.qb);this.a0a.style.borderColor=ta;this.domElement.appendChild(this.a0a);db.a.instance.xa(gb.a.qj,this.domElement,
this.onPointerDown);db.a.instance.xa(gb.a.Co,this.domElement,this.Bo);Kb.a.instance.xa(gb.a.ml,this.domElement,this.Bo);db.a.instance.xa(gb.a.zv,this.domElement,this.Rr);Kb.a.instance.xa(gb.a.Jn,this.domElement,this.Rr);gc.a.instance.xa(gb.a.click,this.domElement,this.vj)}get zoomManager(){return this.zoom.zoomManager}n4e(G){this.addHandler("GrDrag",G)}oFg(G){this.removeHandler("GrDrag",G)}m4e(G){this.addHandler("GrContxt",G)}nFg(G){this.removeHandler("GrContxt",G)}o4e(G){this.addHandler("GrPointerUp",
G)}pFg(G){this.removeHandler("GrPointerUp",G)}dispose(){nc.a.VOa(this.domElement);super.dispose()}dOg(){this.domElement.classList.remove(vd.rb);this.a0a.classList.remove(vd.qb);this.a0a.classList.add(xa.EwaSettings.aG?vd.vb:vd.ub)}L4g(){this.a0a.classList.remove(xa.EwaSettings.aG?vd.vb:vd.ub);this.a0a.classList.add(vd.qb);this.domElement.classList.add(vd.rb)}z6i(G){return!!this.Ttc&&(3<Math.abs(G.x-this.Ttc.x)||3<Math.abs(G.y-this.Ttc.y))}static kRb(G){return Math.round(9/Math.max(G.zoomManager?G.zoomManager.zoom:
Gc.a.Z6,1))}}zd.Z4d=0;Object(D.a)(zd,"TouchGrippie",dc.a,[]);var Yb=a(176);class Pb extends xb{constructor(G,ta,jb,sc,Vc){super(ta);this.t_d=this.$Ib=!1;this.Npc=null;this.dN=this.toa=this.p_d=!1;this.kG=()=>{this.$Ib&&this.p_d?this.VBa():this.Tga()};this.Alg=xd=>{3===xd.Dh&&(this.p_d=!0,this.VBa());return!1};this.Blg=xd=>{if(3===xd.Dh){if(!xd.li||this.tkj(xd))return!1;this.p_d=!1;this.Tga()}return!1};this.tm=()=>{this.toa&&this.mze();this.VBa();this.t_d=!1};this.Vy=()=>{this.Tga();this.t_d=!0};this.iia=
(xd,Hd)=>{Hd.Laa===this.Laa&&(Hd.visible?this.t_d||this.VBa():this.Tga())};this.Grg=()=>{this.Clg(this.K2.domElement,!1)};this.Ehg=()=>{this.Clg(this.U_.domElement,!0)};this.vPc=(xd,Hd)=>{this.dN&&Yb.b(this.da.$).TA(Hd.La.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.IAa(Hd)};this.wPc=(xd,Hd)=>{this.dN&&Yb.b(this.da.$).TA(Hd.La.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.IAa(ed.b(Hd))};this.q1b=()=>{3===jd.a.rh?this.VBa():this.Tga();this.toa&&1===jd.a.rh&&this.mze()};this.Hrg=
()=>{this.bCk()};this.dsf=()=>{this.Tga()};this.aw=()=>{this.ha.$e.Lh&&this.Tga()};this.shg=()=>{this.Tga()};this.tlg=(xd,Hd)=>{this.mze();3===Hd.Dh?this.VBa():this.Tga()};this.ATc=()=>{this.$Ib&&(this.Tga(),this.VBa())};const nd=jb.$;this.lE=jb;this.zoom=Vc;this.ha=jb.ha;this.ZR=G;this.kzk=ta;this.paneType=sc;G=this.domElement.currentStyle;ta="#000000";G&&(ta=G.borderTopColor);this.K2=new zd(this.Wzf(),ta,nd,Vc);this.U_=new zd(this.Wzf(),ta,nd,Vc);this.K2.n4e(this.Grg);this.K2.m4e(this.vPc);this.K2.o4e(this.wPc);
this.U_.n4e(this.Ehg);this.U_.m4e(this.vPc);this.U_.o4e(this.wPc);for(const xd of this.da.Wu)Kb.a.instance.xa(gb.a.Lm,xd.domElement,this.Blg),Kb.a.instance.xa(gb.a.ml,xd.domElement,this.Alg);jb.view.oz(this.kG);jb.Fh.Iv(this.dsf);jb.Gh.Neb(this.iia);jb.zmc(this.shg);nd.xI(this.ATc);jb.dA(this.ATc);this.ha.e4(this.tm);this.ha.wla(this.Vy);jb.lO(this.aw);this.ha.ZHb(this.tlg);jd.a.t4e(this.q1b);Db.TaskExtensions.Xa(Object(mc.d)(za.a.resolve(oa.ed,{va:0})),xd=>{xd.result.PEh(this.Hrg)},nd.ya,3);this.dN=
xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncContextMenu",!1)}get da(){return this.lE}dispose(){ra.a.gj([this.K2,this.U_]);this.K2.oFg(this.Grg);this.K2.nFg(this.vPc);this.K2.pFg(this.wPc);this.U_.oFg(this.Ehg);this.U_.nFg(this.vPc);this.U_.pFg(this.wPc);for(var G of this.da.Wu)Kb.a.instance.Qa(gb.a.Lm,G.domElement,this.Blg),Kb.a.instance.Qa(gb.a.ml,G.domElement,this.Alg);this.da.view.dy(this.kG);this.da.Fh.Cv(this.dsf);this.da.Gh.tvb(this.iia);this.da.QUc(this.shg);this.da.$.gL(this.ATc);
this.da.$E(this.ATc);this.ha.Q7(this.tm);this.ha.Jia(this.Vy);this.da.$P(this.aw);this.ha.d5b(this.tlg);jd.a.vFg(this.q1b);this.toa&&I.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(G=za.a.nh(oa.ed))&&G.Jok(this.Hrg);super.dispose()}v8a(){if(!this.ZR.range||!this.ZR.range.equals(this.uwb))return!1;const G=!this.da.m2a();return this.da.isEditing&&G&&(this.uwb.isRow||this.uwb.lk)?!1:this.toa?!0:3===jd.a.rh}Tga(){this.$Ib&&(this.K2.set_visible(!1),
this.U_.set_visible(!1),this.$Ib=!1)}VBa(){if(this.v8a()){var G=ja.DOMElementExtensions.getBoundingClientRect(this.Npc);G||I.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.da.yn,this.da.fh.pp);var ta=ja.DOMElementExtensions.getBoundingClientRect(this.kzk),jb=new Sys.UI.Bounds(ta.x-G.x,ta.y-G.y,ta.width,ta.height),sc=this.uwb,Vc=sc.topLeft,nd=sc.bottomRight,xd=sc.isRow||sc.lk;if(sc.lk){var Hd=this.xwi();sc=jb.x-2*zd.kRb(this.zoom);
var ke=Hd;var V=jb.x+ta.width}else sc.isRow?(sc=V=this.wwi(),ke=jb.y-2*zd.kRb(this.zoom),Hd=jb.y+ta.height):(ke=jb.y,Hd=jb.y+ta.height,this.da.rtl?(sc=jb.x+ta.width,V=jb.x):(sc=jb.x,V=jb.x+ta.width));ta=zd.Z4d+(xd?0:zd.kRb(this.zoom));this.K2.style.left=Xd.HelperMethods.Ki(sc-ta);this.K2.style.top=Xd.HelperMethods.Ki(ke-ta);this.U_.style.left=Xd.HelperMethods.Ki(V-ta);this.U_.style.top=Xd.HelperMethods.Ki(Hd-ta);this.K2.set_visible(this.j_f(ke,sc,Vc,xd,G));this.U_.set_visible(this.j_f(Hd,V,nd,xd,
G));this.$Ib=!0}}j_f(G,ta,jb,sc,Vc){const nd=ja.DOMElementExtensions.getBoundingClientRect(this.da.sl(this.paneType).domElement);Vc=new Sys.UI.Bounds(nd.x-Vc.x-3,nd.y-Vc.y-3,nd.width+6,nd.height+6);return(this.da.fh.Lo(jb)===this.paneType||sc)&&wb.a.DY(Vc,new Sys.UI.Point(ta,G))}xwi(){return(this.da.view.visibleArea.height+this.da.fh.height+zd.Z4d-zd.kRb(this.zoom))/2}wwi(){return(this.da.view.visibleArea.width+this.da.fh.width+zd.Z4d-zd.kRb(this.zoom))/2}Wpg(){this.VBa()}tkj(G){return ja.DOMElementExtensions.iwb(G.li,
Ec.a.oH)&&(this.Ylj(G)||this.Zlj(G))}Zlj(G){if(this.da.rtl)G=G.clientPoint.x;else{const ta=ja.DOMElementExtensions.getBoundingClientRect(G.li);G=G.clientPoint.x-(ta.x+ta.width-Td.a.ey)}return 0<G&&G<=Td.a.ey}Ylj(G){const ta=ja.DOMElementExtensions.getBoundingClientRect(G.li);G=G.clientPoint.y-(ta.y+ta.height-Td.a.ey);return 0<G&&G<=Td.a.ey}Clg(G,ta){this.toa&&I.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.Xud(G,ta,this.toa);this.Tga()}bCk(){this.toa||
(I.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.toa=!0,this.K2.dOg(),this.U_.dOg(),this.da.ha.sourceRange=this.da.ha.qa.jj,this.VBa())}mze(){this.toa&&(I.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.toa=!1,this.K2.L4g(),this.U_.L4g())}Wzf(){this.Npc||(this.Npc=this.da.yn);return this.Npc}}Object(D.a)(Pb,"SelectionTouchGrippiesBehaviorBase",xb,[]);class $c extends Pb{constructor(G,ta,jb,sc,Vc){super(G,ta,
jb,sc,Vc)}get Laa(){return 19}get uwb(){return this.da.ha.qa.activeRange}v8a(){const G=this.da.lq||this.da.isEditing;return!this.da.ha.qa.Bn&&!G&&super.v8a()}}Object(D.a)($c,"DiscontinuousSelectionTouchGrippiesBehavior",Pb,[]);var wd=a(764);class Bd extends xb{constructor(G){super(G);const ta=document.createElement("div");ta.className=vd.Mb;G.appendChild(ta)}}Object(D.a)(Bd,"SelectionBorderBehavior",xb,[]);class tc{}tc.yxf="ewr-selection-draghandle-grab";tc.Yri="ewr-selection-draghandle-top";tc.Zri=
"ewr-selection-draghandle-top-enhanced";tc.Ori="ewr-selection-draghandle-bottom";tc.Pri="ewr-selection-draghandle-bottom-enhanced";tc.Rri="ewr-selection-draghandle-left";tc.Sri="ewr-selection-draghandle-left-enhanced";tc.Vri="ewr-selection-draghandle-right";tc.Wri="ewr-selection-draghandle-right-enhanced";tc.$ri="ewr-selection-draghandle-top-updated";tc.Qri="ewr-selection-draghandle-bottom-updated";tc.Tri="ewr-selection-draghandle-left-updated";tc.Xri="ewr-selection-draghandle-right-updated";tc.asi=
"ewr-selection-dragtooltip-updated";tc.Mri="ewr-selection-drag-tooltip-fluent";tc.Nri="ewr-selection-drag-tooltip-shift-instruction";tc.zxf="ewr-selection-draghandle-reduced";tc.osi="ewr_selection_rearrangeleft";tc.psi="ewr_selection_rearrangeright";tc.qsi="ewr_selection_rearrangetop";tc.nsi="ewr_selection_rearrangebottom";tc.gsi="ewr_selection_rearrange-flange-left";tc.ksi="ewr_selection_rearrange-fullrowcol-flange-left";tc.hsi="ewr_selection_rearrange-flange-right";tc.lsi="ewr_selection_rearrange-fullrowcol-flange-right";
tc.isi="ewr_selection_rearrange-flange-top";tc.msi="ewr_selection_rearrange-fullrowcol-flange-top";tc.fsi="ewr_selection_rearrange-flange-bottom";tc.jsi="ewr_selection_rearrange-fullrowcol-flange-bottom";tc.selecting="selecting";tc.Lri="ewr-selection-drag-shadow";tc.rsi="ewr-selection-resizemarqueehandle";tc.usi="ewr-selection-resizemarqueehandle-topleft";tc.vsi="ewr-selection-resizemarqueehandle-topright";tc.ssi="ewr-selection-resizemarqueehandle-bottomleft";tc.tsi="ewr-selection-resizemarqueehandle-bottomright";
tc.Eri="ewr-marquee-thick";tc.Gri="ewr-resizemarqueehandle-thick";Object(D.a)(tc,"CssClassNames",null,[]);var Zc=a(287);class Ab extends Bd{constructor(G,ta,jb,sc,Vc){super(G);this.j9a=!1;this.Fnd=this.Gnd=null;this.hAb=this.Umb=this.MX=this.pla=0;this.y7=this.Oh=this.sourceRange=this.lub=null;this.Bo=nd=>{nd=this.zoomManager.il(nd);return this.Bog(nd)};this.onPointerDown=nd=>{nd=this.zoomManager.il(nd);if(!this.qse())return!1;if(2===nd.Dh&&nd.Iw===Sys.UI.MouseButton.leftButton&&!this.j9a){var xd=
this.uOd(nd);if(!xd)return I.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.Oh=xd.clone();this.sourceRange=this.Oh.clone();this.lub=this.Oh;if(xd=this.uQi(nd))return this.hAb=xd.top-this.sourceRange.top,this.Umb=xd.left-this.sourceRange.left,ha.f(this.$).co.PA(Ab.fDd),this.$$d(nd),this.j9a=!0,Zc.b(this.$,!0),!0}return!1};this.Rr=nd=>{nd=this.zoomManager.il(nd);if(this.aae(nd))return!0;if(nd=this.KC?this.ha.l4(nd.clientPoint,nd.li,
5,!0):this.ha.Yy(nd.clientPoint,nd.li,5,void 0,void 0,!0)){nd=this.rKb(nd);if(this.Oh.equals(nd))return!0;this.Oh=nd;if(!this.Fzb())return I.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Sxc(!0),!1}return!0};this.zog=nd=>{nd=new Sys.UI.DomEvent(nd);nd=wd.a.create(nd.type,nd.target,nd,2);return this.Fnd(nd)};this.Fog=nd=>{nd=new Sys.UI.DomEvent(nd);nd=wd.a.create(nd.type,nd.target,nd,2);return this.Gnd(nd)};this.Cj=(nd,xd)=>{xd.q1||
this.wYc(this.$.isEditMode)};this.YO=[];this.$=ta;this.da=ha.f(this.$);this.zoom=Vc;this.ha=ha.f(this.$).ha;this.paneType=jb;this.ow=sc;this.KC=xa.EwaSettings.KC();xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragHandleUsabilityImprovement",!1)?this.FXc=[tc.Yri,tc.Ori,tc.Rri,tc.Vri]:xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8683878_UpdateDragDropHitRegionOfActiveCell")?this.FXc=[tc.$ri,tc.Qri,tc.Tri,tc.Xri]:this.FXc=[tc.Zri,tc.Pri,tc.Sri,tc.Wri];this.$.mr(this.Cj)}get zoomManager(){return this.zoom.zoomManager}get Gh(){return ha.f(this.$).Gh}get yz(){return this.ha.selectionType}set yz(G){this.ha.selectionType=
G}dispose(){this.YO.forEach(G=>{db.a.instance.Qa(gb.a.qj,G,this.onPointerDown)});this.YO.length=0;this.lub=this.sourceRange=this.Oh=null;I.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.pla}, EwaControl is null : ${!this.$}`);this.$&&(this.$.Wr(this.Cj),1===this.pla&&(I.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.kHa(this.Fnd,this.Gnd,!1)));super.dispose()}Bog(G){if(5!==
this.yz)return!1;(G=this.T4a(G))||this.Sxc(!1);Zc.b(this.$,!1);return G}lqa(G,ta){I.ULS.shipAssertTag(537159377,0,!this.pla,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.pla}`);this.pla+=1;this.Fnd=G;this.Gnd=ta;this.KC?this.ow.Vhk(this.zog,this.Fog,this.kac()):this.ow.lqa(G,ta,this.kac())}rKb(G){if(!G||!this.Oh)return I.ULS.shipAssertTag(537159376,0,!!G,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),
I.ULS.shipAssertTag(537159375,0,!!this.Oh,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ta=this.Oh.clone();1!==this.MX&&(ta.left=Math.max(G.left-this.Umb,1),ta.right=ta.left+this.sourceRange.width-1);2!==this.MX&&(ta.top=Math.max(G.top-this.hAb,1),ta.bottom=ta.top+this.sourceRange.height-1);return this.xIb(ta)}kHa(G,ta,jb,sc){jb=void 0===jb?!0:jb;sc=void 0===sc?!0:sc;I.ULS.shipAssertTag(537159374,0,1===this.pla,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.pla}`);
--this.pla;this.KC?this.ow.E5k(this.zog,this.Fog,this.kac()):this.ow.ize(G,ta,this.kac());jb&&this.qff(sc);this.MX=0;this.j9a=!1}xIb(G){var ta=ha.f(this.$);const jb=G.clone();if(ta.fh.Fy){const sc=ta.fh.pH;ta=ta.fh.xK;jb.left<sc&&1!==this.MX&&(jb.left=sc,jb.right=Math.min(jb.left+G.width-1,Gc.a.Gk));jb.top<ta&&2!==this.MX&&(jb.top=ta,jb.bottom=Math.min(jb.top+G.height-1,Gc.a.Rk))}return this.lub=jb}wYc(G){this.YO.forEach(ta=>{ja.DOMElementExtensions.setVisible(ta,G)})}uQi(G){const ta=G.li;G=G.clientPoint;
if(!ta||!G)return I.ULS.shipAssertTag(537159373,0,!!ta,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),I.ULS.shipAssertTag(537159372,0,!!G,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;G.y+=ta===this.YO[Ab.dDd]?2:ta===this.YO[Ab.Crf]?-2:0;G.x+=ta===this.YO[Ab.Drf]?2:ta===this.YO[Ab.cDd]?-2:0;return this.KC?this.ha.l4(G,ta,5,!0):this.ha.Yy(G,ta,5,void 0,void 0,!0)}}Ab.Jsc="copy";Ab.fDd="grabbing";Ab.dDd=0;Ab.Crf=1;Ab.Drf=2;Ab.cDd=3;Object(D.a)(Ab,
"DragSelectionClickBehaviorBase",Bd,[]);class rb extends Ab{constructor(G,ta,jb,sc,Vc,nd,xd){super(G,ta,jb,Vc,xd);this.Zi=this.gW=null;this.MPf=()=>{this.Sxc(!0)};for(const Hd of this.FXc)ta=this.ow.Jkf(G,Hd,[tc.yxf],this.onPointerDown),this.YO.push(ta);this.wYc(this.$.isEditMode);this.GP=sc;G=oa.Ec.Aa()?za.a.nh(oa.Ec):this.$.la.kh(464);I.ULS.shipAssertTag(512312961,0,!!G,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");
this.ED=G.ED;for(const Hd of this.YO)db.a.instance.xa(gb.a.z7,Hd,this.GP.iTf),db.a.instance.xa(gb.a.bL,Hd,this.GP.jTf);this.$eb(nd)}$eb(G){this.ow.V7b(G,this.YO);this.GP.AZ()}$$d(G){I.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.da.eLa=!0;this.Zi.xO(!1);this.yz=5;this.GP.Grf(G.li);this.Zi.Wa.removeSelection();this.Zi.Omc(this.MPf);this.lqa(this.Rr,this.Bo);this.MX=this.sourceRange.isRow?1:this.sourceRange.lk?2:0}T4a(){const G=
this.q8();this.yz=-1;this.kHa(this.Rr,this.Bo);return G}qff(){this.da.eLa=!1;this.GP.Hrf(this.YO[0]);this.Zi.Wa.setCaretPositionToEnd();this.Zi.cVc(this.MPf);this.ow.rBg()}Sxc(G){I.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate formula highlights as a fallback in CleanUp.");G&&this.kHa(this.Rr,this.Bo)}uOd(G){this.Zi=this.ow.RJd();this.gW=this.ow.BLf(G);return this.Zi&&this.gW&&this.gW.range?this.gW.range:(I.ULS.shipAssertTag(537159388,
0,!!this.Zi,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),I.ULS.shipAssertTag(537159387,0,!!this.gW,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),I.ULS.shipAssertTag(537159386,0,!!this.gW.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}q8(){return this.gW?this.ED.wdg(this.Zi,this.gW,this.Oh):(I.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}Fzb(){return this.q8()}kac(){return!0}aae(){return!1}qse(){return!0}}Object(D.a)(rb,"DragMarqueeClickBehavior",Ab,[]);var Fb=a(98),jc=a(158),Oc=a(189),cd=a(355),Ed=a(925),Sd=a(71),$d=a(232),be=a(36),Fe=a(44),Pe=a(369),hc=a(234),Lb=a(46),kc=a(434);class dd extends Ab{constructor(G,ta,jb,sc,Vc,nd){super(G,ta,jb,Vc,nd);this.Cva=this.KF=null;this.lk=this.isRow=!1;this.ms=xa.EwaSettings.ms();this.uya=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragAnimationTracking",!1);this.eYb=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseSPDForDrag",
!1);this.H1a=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8732599_DragInsertIndicatorAlignmentBugFix");this.Z5=xa.EwaSettings.t6()&&xa.EwaSettings.eXd();this.xY=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragTooltipRedesign",!1);this.ijb=Sd.a.Z$;this.$vc=0;this.Elg=(xd,Hd)=>{this.BWb=!0;this.onPointerDown(Hd)};this.tm=()=>{this.domElement.classList.remove(tc.selecting);this.wYc(this.$.isEditMode&&!this.Imi());if(dd.Fgk&&this.ha.qa.G6){const xd=this.zh(this.ha.qa.jj);null!==xd&&
(xd.hasAutoFilter?this.domElement.classList.add(tc.zxf):this.domElement.classList.remove(tc.zxf))}};this.Vy=()=>{this.domElement.classList.add(tc.selecting)};this.Qj=sc;this.iWd=!1;if(0===dd.Gvc[jb].length)for(const xd of this.FXc)ta=document.createElement("div"),ta.className=xd,ta.classList.add(tc.yxf),dd.Gvc[jb].push(ta);for(const xd of dd.Gvc[jb])G.appendChild(xd),db.a.instance.xa(gb.a.qj,xd,this.onPointerDown),this.YO.push(xd);this.wYc(this.$.isEditMode);this.ez={};this.da.fV=!1;this.ha.wla(this.Vy);
this.ha.e4(this.tm);this.KC&&1===this.paneType&&(this.mHa(),this.da.EDh(this.Elg));this.uya&&void za.a.resolve(oa.Ed).then(xd=>{this.mLa=xd})}dispose(){this.ha&&(this.ha.Jia(this.Vy),this.ha.Q7(this.tm));if(this.ez)for(var G=1;4>=G;G++)ja.DOMElementExtensions.an(this.ez[G.toString()]);for(G=1;4>=G;G++)dd.Gvc[G].length=0;this.ez=this.KF=null;this.KC&&1===this.paneType&&this.da.Fnk(this.Elg);super.dispose()}qff(G){G&&(ha.f(this.$).co.PA(Y.a.Gaa),this.rff(),this.da.fV=!1);for(G=1;4>=G;G++){const ta=
this.ez[G.toString()];ta&&ta.parentNode.removeChild(ta);this.ez[G.toString()]=null}this.KF=null}uOd(){return this.ha.qa.jj}q8(){this.ha.updateSelection(this.Oh,this.Oh.topLeft,0);return!0}F8a(G,ta){ta=void 0===ta?!1:ta;var jb=!isNullOrUndefined(this.Efa);if(G&&ta||G!==jb){jb=this.i1();var sc=this.gha();G&&(jb||sc)?(ta&&this.Efa&&(this.Gh.Mq(this.Efa),this.Efa=null),this.Gh.YTb(!0),this.Efa=this.hWd()?[65]:[62,jb?63:64],this.Gh.tt(this.sourceRange,this.Efa),this.Gh.Nw(this.Efa),I.ULS.sendTraceTag(507872737,
0,50,`DragSelectionClickBehavior.showOrHideSourceHighlights: show source highlights for ${this.hWd()?"copy":"cut"} operation`)):this.Efa&&(this.Gh.Mq(this.Efa),this.Efa=null,this.Gh.Oca(),I.ULS.sendTraceTag(507872736,0,50,"DragSelectionClickBehavior.showOrHideSourceHighlights: hide source highlights"))}}Fdf(G){this.Irf=G}g9b(G){isNullOrUndefined(this.Efa)&&Math.abs(this.i1()?G.y-this.Irf.y:G.x-this.Irf.x)>=dd.ETk&&this.F8a(!0)}n4c(){const G=!isNullOrUndefined(this.Efa);this.F8a(G,!0)}Fzb(G){G=void 0===
G?!1:G;if(this.ms){const jb=this.i1();var ta=this.gha();jb||ta?(ta=this.g4f(),this.Cva=jb?dd.eii:dd.dii,this.Gh.tt(this.Oh,this.Cva),ta?this.Gh.Nw(this.Cva):this.TTb()):(this.Cva=dd.MYa,this.Gh.tt(this.Oh,this.Cva),this.Gh.Nw(this.Cva))}else this.Gh.tt(this.Oh,dd.MYa),this.Gh.Nw(dd.MYa);this.iQ(G);return!0}TTb(){this.Cva&&(this.Gh.Mq(this.Cva),this.Cva=null)}L3c(G){G=void 0===G?!1:G;this.Gh.tt(this.Oh,this.KF);if(this.ms){const ta=this.i1()||this.gha(),jb=this.h4f();ta&&!jb?this.Gh.Mq(this.KF):this.Gh.Nw(this.KF)}else this.Gh.Nw(this.KF);
this.iQ(G)}mHa(){this.BWb=!1}dSh(G,ta,jb,sc,Vc,nd,xd,Hd,ke){ta?(ta=xd,Vc=sc.y+Vc.y-nd.y-Hd,xd=nd.width-ke-ta,sc=sc.height,G=G.y-nd.y-Vc):(ta=jb?sc.x-Vc.right+nd.right+Hd:sc.x+Vc.left-nd.left-Hd,Vc=xd,xd=sc.width,sc=nd.height-ke-Vc,G=jb?nd.width-(G.x-nd.left)-ta:G.x-nd.left-ta);return{ijb:new Sd.a(ta,Vc,xd,sc),$vc:G}}eSh(G,ta,jb,sc,Vc,nd){ta?(ta=sc.x,G=G.y-nd.y-Vc):(ta=jb?nd.width-(G.x-nd.left)-Vc:G.x-nd.left-Vc,G=sc.y);return new Sys.UI.Point(ta*(jb?-1:1),G)}KRg(G){var ta=this.da.yn,jb=ta.getBoundingClientRect(),
sc=this.da.oh.iFf(G),Vc=this.da.oh.bKf(sc)||this.da.sl(1);sc=Vc.domElement;const nd=sc.getBoundingClientRect();Vc=this.Gh.ZZa(this.sourceRange,Vc.paneType,!1);const xd=this.i1(),{ijb:Hd,$vc:ke}=this.dSh(G,xd,this.da.rtl,Vc,nd,jb,(xd?this.da.Cca:this.da.d0).oMd(),xd?sc.scrollTop:sc.scrollLeft,Td.a.ey/this.zoomManager.zoom);this.ijb=Hd;this.$vc=ke;dd.Nfa||(dd.Nfa=document.createElement("div"),dd.Nfa.id=`${this.da.$.xi}rowColDragShadow`,dd.Nfa.className=tc.Lri,ja.DOMElementExtensions.setVisible(dd.Nfa,
!1),ta.appendChild(dd.Nfa));ta=new hc.a(dd.Nfa.style);jb=ta.hF;jb.height=`${this.ijb.height}px`;jb.width=`${this.ijb.width}px`;this.Pxb(G,ta)}UTb(){dd.Nfa&&ja.DOMElementExtensions.setVisible(dd.Nfa,!1)}Pxb(G,ta){if(dd.Nfa){ta=ta||new hc.a(dd.Nfa.style);var jb=ta.hF,sc=this.da.yn.getBoundingClientRect(),{x:Vc,y:nd}=this.eSh(G,this.i1(),this.da.rtl,this.ijb,this.$vc,sc);jb.transform=`translate(${Vc}px, ${nd}px)`;ja.DOMElementExtensions.jqe(ta,dd.Nfa,!0);ta.n$()}}zh(G){return(G=this.da.za.Rx(G))?new Pe.a(G,
this.da):null}Imi(){if(this.ha.qa.Bn){const G=this.ha.qa.jj;if(null!=G&&1===G.top&&1===G.left&&G.bottom===G.maxRows&&G.right===G.maxColumns)return!0}return!1}Sxc(){I.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}kac(){return!1}exb(G,ta,jb,sc){sc=void 0===sc?!1:sc;var Vc=ja.DOMElementExtensions.getBoundingClientRect(ta);let nd=ta===this.YO[Ab.dDd]||ta===this.YO[Ab.Crf];var xd=ta===this.YO[Ab.Drf]||ta===this.YO[Ab.cDd];
this.isRow&&xd||this.lk&&nd?xd="100px":(nd=this.isRow||nd,xd=this.ms?nd?(sc?dd.B0k:dd.G0k)+"px":(sc?dd.y0k:dd.C0k)+"px":(nd?sc?dd.A0k:dd.F0k:sc?dd.z0k:dd.D0k)+"px");ta=nd?ta===this.YO[Ab.dDd]?"top":"bottom":ta===this.YO[Ab.cDd]?"right":"left";G=100*(nd?G.x-Vc.x:G.y-Vc.y)/(nd?Vc.width:Vc.height);for(Vc=1;4>=Vc;Vc++){var Hd=document.createElement("div");const V=document.createElement("div");if(!this.xY){var ke=document.createElement("div");Hd.appendChild(ke)}Hd.appendChild(V);sc&&(ke=document.createElement("div"),
Hd.appendChild(ke),this.xY?ke.className=tc.Nri:V.style.fontWeight="bold");Hd.className=this.ms?tc.Mri:tc.asi;this.ez[Vc.toString()]=Hd;this.Gh.VU(jb,Vc).rl.appendChild(Hd);if(Hd=this.ez[Vc.toString()])Hd.style[ta]=xd,Hd.style[nd?"left":"top"]=G+"%"}}ZJd(G,ta,jb,sc){var Vc=ha.f(this.$);let nd;if(this.H1a){nd=Vc.sl(sc);const xd=kc.a.mP(sc,nd.view.xn);jb=Ed.a.fz(xd,nd.domElement,jb,Vc.rtl);sc=Vc.yl(G,sc,!0)}else nd=Vc.sl(this.paneType),jb=Ed.a.fz(nd.view.xn,this.domElement.parentNode,jb,Vc.rtl),sc=Vc.yl(G,
void 0,!0);Vc=this.da.kj;return ta&&jb.y-sc.topLeft.y>sc.height/2?Lb.E(Vc.WZa(G)):!ta&&jb.x-sc.topLeft.x>sc.width/2?Lb.E(Vc.G_a(G)):G}C6g(G,ta,jb,sc){const Vc=ha.f(this.$);let nd;if(this.H1a){nd=Vc.yl(G,sc);var xd=Vc.sl(sc);sc=kc.a.mP(sc,xd.view.xn);jb=Ed.a.fz(sc,xd.domElement,jb,Vc.rtl)}else nd=Vc.yl(G),xd=Vc.sl(this.paneType),jb=Ed.a.fz(xd.view.xn,this.domElement.parentNode,jb,Vc.rtl);xd=!1;sc=2;ta&&jb.y-nd.topLeft.y>nd.height/2?(xd=!0,sc=1):!ta&&jb.x-nd.topLeft.x>nd.width/2&&(xd=!0);if(xd){ta=
Vc.ot("DragSelectionClickBehavior.updateMouseSelectionRange",Vc.H5,sc);try{ta.hG(G),ta.$$mn(),ta.$$cu()}finally{ta&&ta.dispose()}}}jXa(G){this.Gh.Mq(this.KF);this.kHa(this.gQc,this.hQc,void 0,G);this.uya&&this.r0c()}IX(G){this.ms?this.TTb():this.Gh.Mq(dd.MYa);this.kHa(this.Rr,this.Bo,void 0,G);this.uya&&this.r0c()}r0c(){var G;this.aDd&&(null===(G=this.mLa)||void 0===G?void 0:G.stopTrackAnimation(this.aDd));this.aDd=void 0}O9b(G,ta){var jb;this.r0c();if(null===(jb=this.mLa)||void 0===jb?0:jb.startTrackAnimation(ta,
G))this.aDd=G}Xnb(G){return G.La.keyCode===Fb.a.F$a||da.a.isMac&&G.La.keyCode===Fb.a.tbc}TVd(G){return G.La.ctrlKey||da.a.isMac&&G.La.altKey}dVb(G){G=ha.f(this.$).getRangeInformation(G);for(let ta=0,jb=G.length;ta<jb;++ta)if(Object(cd.a)($d.PivotTableRange,G[ta]))return G=be.a.nj(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),Fe.a(this.$).aD([G]),!0;return!1}Q2e(){this.iWd||(this.ha.S4e(this.uae),this.iWd=!0)}K6a(){this.ha&&(this.ha.NFg(this.uae),this.iWd=!1)}S7a(G){var ta;this.da.fV=G;null===
(ta=za.a.nh(oa.jd))||void 0===ta?void 0:ta.Z2i(G)}i1(){return 1===this.MX}gha(){return 2===this.MX}}dd.D0k=-85;dd.F0k=-40;dd.z0k=-120;dd.A0k=-50;dd.C0k=-95;dd.G0k=-50;dd.y0k=-130;dd.B0k=-60;dd.ETk=2;dd.MYa=[48];dd.eii=[66,68];dd.dii=[67,69];dd.sfk=[58,60];dd.rfk=[59,61];dd.Gvc=[[],[],[],[],[],[]];dd.Fgk=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8196440_ReduceDragAreaIfAutoFilter");Object(D.a)(dd,"DragSelectionClickBehavior",Ab,[]);var yb=a(27),Ta;(function(G){G[G.none=0]="none";G[G.copyPasteLengthTooLong=
1]="copyPasteLengthTooLong";G[G.applyLinkFailed=2]="applyLinkFailed";G[G.pasteHtmlFailed=3]="pasteHtmlFailed";G[G.pasteStringFailed=4]="pasteStringFailed";G[G.pasteRangeFailed=5]="pasteRangeFailed";G[G.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";G[G.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";G[G.clipboardIsInaccessible=8]="clipboardIsInaccessible";G[G.pasteArtFailed=9]="pasteArtFailed";G[G.noArtSourceItem=
10]="noArtSourceItem";G[G.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";G[G.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";G[G.invalidShadowWorkbook=13]="invalidShadowWorkbook";G[G.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";G[G.failedToPasteExternalImage=15]="failedToPasteExternalImage";G[G.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";G[G.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";G[G.pasteFromExternalNotSupportDiscontinuousSelection=
18]="pasteFromExternalNotSupportDiscontinuousSelection";G[G.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";G[G.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";G[G.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";G[G.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed";G[G.invalidHtml=23]="invalidHtml";G[G.failedToProcessClipboardHtml=24]="failedToProcessClipboardHtml"})(Ta||
(Ta={}));Object(D.b)("PasteErrorType",Ta);class Hb{constructor(G,ta){this.errorName=this.innerError=null;this.errorName=G;this.innerError=void 0===ta?null:ta}}Object(D.a)(Hb,"CCPError",null,[]);class uc extends Hb{constructor(G,ta){ta=void 0===ta?null:ta;super(be.a.Yh(void 0===G?null:G,"_"),ta)}}Object(D.a)(uc,"EwaCCPError",Hb,[]);class Sc extends Hb{constructor(G,ta,jb,sc,Vc){ta=void 0===ta?null:ta;jb=void 0===jb?null:jb;sc=void 0===sc?"":sc;Vc=void 0===Vc?100:Vc;super(Ta[G]);this.pasteErrorName=
0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=G;this.ewaErrors=ta;this.validationFailureReason=Vc;this.innerError=ta?new uc(ta,jb):jb;this.message=sc}}Object(D.a)(Sc,"PasteInnerError",Hb,[]);var bc=a(216),vc=a(124),Xc=a(264),ad=a(64);class Id{constructor(G,ta){this.destinationRange=this.sourceRange=null;this.sourceRange=G;this.destinationRange=ta}}Object(D.a)(Id,"MacroRecorderTableRowColumnRearrangedPayload",null,[60]);class ue extends dd{constructor(G,ta,jb,
sc,Vc,nd,xd){super(G,ta,jb,sc,Vc,nd);this.cra=null;this.$I=this.DH=!1;this.DYb=0;this.q8b=this.tOb=null;this.wR=0;this.Erf=this.xY?ka.a.instance.sh(246):ka.a.instance.ia(2269);this.kii=this.xY?ka.a.instance.sh(247):ka.a.instance.ia(2270);this.vSg=this.xY?ka.a.instance.ia(2552):ka.a.instance.ia(2271);this.hKk=this.xY?ka.a.instance.ia(2553):ka.a.instance.ia(2272);this.Bi=null;this.onKeyDown=Hd=>{if(this.Xnb(Hd)||Hd.La.keyCode===Fb.a.bAb){this.z4b();!this.p6&&this.Xnb(Hd)&&(this.p6=!0,ha.f(this.$).co.PA(Ab.Jsc),
this.ms&&this.n4c());if(!this.YI&&Hd.La.keyCode===Fb.a.bAb){this.YI=!0;const ke=this.xY?!0:!1;2===this.wR?(this.IX(!1),this.MX=0,this.DH=this.$I,this.P9b(ke,Hd.La.rawEvent)):3===this.wR?(this.iXa(!1),this.MX=this.isRow?1:2,this.Rca(ke,Hd.La.rawEvent)):1===this.wR&&(this.jXa(!1),this.Rca(ke,Hd.La.rawEvent))}return!0}return!1};this.onKeyUp=Hd=>this.Xnb(Hd)||Hd.La.keyCode===Fb.a.bAb?(this.DYb=this.Xnb(Hd)?0:1,this.xY&&this.hRa(this.DYb),1===this.DYb&&(2===this.wR?(this.iXa(!1),this.MX=0,this.Rca(!0,
Hd.La.rawEvent)):3===this.wR?(this.IX(!1),this.MX=this.isRow?1:2,this.P9b(!0,Hd.La.rawEvent)):1===this.wR&&(this.IX(!1),this.iyb(!0,Hd.La.rawEvent))),this.xY||this.hRa(this.DYb),0===this.DYb&&(this.da.fV&&ha.f(this.$).co.PA(Ab.fDd),this.ms&&this.n4c()),!0):!1;this.hQc=Hd=>{Hd=this.zoomManager.il(Hd);this.K6a();5===this.yz?this.Bog(Hd):(this.Z5?this.S7a(!1):this.da.fV=!1,this.ms&&(this.F8a(!1),this.UTb()),!this.$.uy([this.Oh],!1)||this.tfk()||this.aYd()||(this.ha.sourceRange=this.sourceRange.clone(),
this.qak(),this.$I?this.Oh.top>this.sourceRange.top&&(Hd=this.Oh.height,this.Oh.top-=Hd,this.Oh.bottom-=Hd):this.Oh.left>this.sourceRange.left&&(Hd=this.Oh.width,this.Oh.left-=Hd,this.Oh.right-=Hd),this.q8()));this.jXa(!0);this.tableRange=null;this.yz=-1;this.cra=null;this.wR=0;return!0};this.Eog=()=>{this.Z5?this.S7a(!1):this.da.fV=!1;this.K6a();this.wR=0;this.ms&&(this.F8a(!1),this.UTb());if(!this.$.uy([this.Oh],!1))return this.iXa(!0),this.yz=-1,this.mHa(),!0;if(this.U8g()&&!this.dVb(this.Oh)&&
!this.dVb(this.sourceRange)&&!this.aYd()){this.q8();this.ha.sourceRange=this.sourceRange.clone();var Hd=this.ha.sourceRange;const ke=this.ha.qa.jj;this.KC?this.$.si(-694765314,2,30,{[Y.a.Rma]:this.p6,[Y.a.Yvc]:!0,[Y.a.Zvc]:this.DH,[Y.a.h5]:Hd,[Y.a.g5]:ke,[Y.a.Zva]:this.YI,[Y.a.fjb]:this.BWb}):this.$.si(-694765314,2,30,{[Y.a.Rma]:this.p6,[Y.a.Yvc]:!0,[Y.a.Zvc]:this.DH,[Y.a.h5]:Hd,[Y.a.g5]:ke,[Y.a.Zva]:this.YI});this.p6||(this.Oh.top>this.sourceRange.top&&(this.isRow||this.Oh.left===this.sourceRange.left&&
this.DH)?(Hd=this.Oh.height,this.Oh.top-=Hd,this.Oh.bottom-=Hd):this.Oh.left>this.sourceRange.left&&(this.lk||this.Oh.top===this.sourceRange.top&&!this.DH)&&(Hd=this.Oh.width,this.Oh.left-=Hd,this.Oh.right-=Hd),this.q8())}this.iXa(!0);this.cra=this.tableRange=null;this.yz=-1;this.DH=!1;this.mHa();return!0};this.gQc=Hd=>{Hd=this.zoomManager.il(Hd);var ke=Hd.clientPoint;this.y7=Hd;var V=this.KC?this.ha.l4(ke,Hd.li,5,!0):this.ha.Yy(ke,Hd.li,5,void 0,void 0,!0);this.ms&&(this.i1()||this.gha())&&(this.Pxb(ke),
this.g9b(ke));if(V){if(this.tableRange.contains(V.topLeft)){if(Hd=this.H1a?this.da.fh.Lo(V):void 0,this.eYb?V=this.ZJd(V,this.$I,ke,Hd):this.C6g(V,this.$I,ke,Hd),this.Oh=this.OWa(V),this.ha.sourceRange=this.Oh,this.Gh.tt(this.Oh,this.KF),this.Gh.Nw(this.KF),this.ms?this.TTb():this.Gh.Mq(dd.MYa),6!==this.yz){for(ke=1;4>=ke;ke++)if(V=this.ez[ke.toString()])V.parentNode.removeChild(V),this.Gh.VU(this.$I?11:12,ke).rl.appendChild(V);this.yz=6}}else this.Oh=this.rKb(V),this.ePf(Hd,!1);this.iQ(!1)}return!0};
this.xog=Hd=>{Hd=this.zoomManager.il(Hd);var ke=Hd.clientPoint;this.y7=Hd;var V=this.KC?this.ha.l4(ke,Hd.li,5,!0):this.ha.Yy(ke,Hd.li,5,void 0,void 0,!0);this.ms&&(this.i1()||this.gha())&&(this.Pxb(ke),this.g9b(ke));if(V){if(this.UQf(V))return this.Oh=this.rKb(V),this.dPf(Hd,!1),!0;var Wa=this.H1a?this.da.fh.Lo(V):void 0;if(this.isRow||this.lk){if(this.eYb)V=this.ZJd(V,this.isRow,ke,Wa);else{Hd=ha.f(this.$);if(this.H1a){var Eb=Hd.yl(V,Wa);var Jc=Hd.sl(Wa);Wa=kc.a.mP(Wa,Jc.view.xn);ke=Ed.a.fz(Wa,Jc.domElement,
ke,Hd.rtl)}else Eb=Hd.yl(V),Jc=Hd.sl(this.paneType),ke=Ed.a.fz(Jc.view.xn,this.domElement.parentNode,ke,Hd.rtl);Wa=!1;Jc=2;this.DH=!1;this.isRow&&ke.y-Eb.topLeft.y>Eb.height/2?(Wa=!0,Jc=1):this.lk&&ke.x-Eb.topLeft.x>Eb.width/2&&(Wa=!0);if(Wa){Hd=Hd.ot("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Hd.H5,Jc);try{Hd.hG(V),Hd.$$mn(),V=Hd.$$cu().range}finally{Hd&&Hd.dispose()}}}this.Oh=this.rKb(V)}else{Eb=ha.f(this.$);if(this.H1a){Jc=Eb.sl(Wa);var od=kc.a.mP(Wa,Jc.view.xn);ke=Ed.a.fz(od,
Jc.domElement,ke,Eb.rtl);Wa=Eb.yl(V,Wa,!0)}else Wa=Eb.yl(V),Jc=Eb.sl(this.paneType),ke=Ed.a.fz(Jc.view.xn,this.domElement.parentNode,ke,Eb.rtl);Jc=!1;od=2;this.DH=!1;this.eYb?Math.abs(ke.x-Wa.topLeft.x)<.3*Wa.width?this.DH=!1:Math.abs(ke.x-Wa.bottomRight.x)<.15*Wa.width?(this.DH=!1,Jc=!0):ke.y-Wa.topLeft.y<=Wa.height/2?this.DH=!0:ke.y-Wa.topLeft.y>Wa.height/2&&(Jc=this.DH=!0):ke.x-Wa.topLeft.x===Wa.width?(this.DH=!1,Jc=!0):ke.y-Wa.topLeft.y>Wa.height/2&&(this.DH=Jc=!0,od=1);this.cra&&(this.DH=this.$I);
if(Jc)if(this.eYb)ke=this.da.kj,V=this.DH?Lb.E(ke.WZa(V)):Lb.E(ke.G_a(V));else{ke=Eb.ot("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Eb.H5,od);try{ke.hG(V),ke.$$mn(),V=ke.$$cu().range}finally{ke&&ke.dispose()}}this.Gh.Mq(this.KF);this.KF=this.DH?[11]:[12];for(ke=1;4>=ke;ke++)(Wa=this.ez[ke.toString()])&&Wa.parentNode.removeChild(Wa),this.ez[ke.toString()]=null;this.exb(Hd.clientPoint,Hd.li,this.DH?11:12);this.Oh=this.OWa(V)}this.ha.sourceRange=this.Oh;this.ms?this.L3c(!1):
(this.Gh.tt(this.Oh,this.KF),this.Gh.Nw(this.KF));this.ms?this.TTb():this.Gh.Mq(dd.MYa);if(6!==this.yz){for(V=1;4>=V;V++)if(Hd=this.ez[V.toString()])ke=this.ms?this.isRow?58:this.lk?59:this.DH?11:12:this.isRow||this.DH?11:12,Hd.parentNode.removeChild(Hd),this.Gh.VU(ke,V).rl.appendChild(Hd);this.yz=6}this.ms||this.iQ(!1)}return!0};this.uae=()=>{this.da.fV&&5<=this.yz&&(this.tableRange?this.YI?this.IX(!0):this.jXa(!0):this.YI?this.isRow||this.lk?this.IX(!0):this.iXa(!0):this.isRow||this.lk?this.iXa(!0):
this.IX(!0));this.hRa(void 0);this.wR=0;this.yz=-1;this.K6a()};this.tableRange=null;this.Gya=this.p6=this.YI=!1;this.Bi=xd}dispose(){this.hRa(void 0);super.dispose()}$$d(G){this.y7=G;this.cra=null;this.$I=this.isRow=this.lk=this.DH=!1;jc.a.instance.xa(gb.a.Ui,this.domElement.ownerDocument.body,this.onKeyDown);if(G.La.shiftKey||this.TVd(G))this.z4b(),G.La.shiftKey&&(this.YI=!0),this.TVd(G)&&(this.p6=!0,ha.f(this.$).co.PA(Ab.Jsc));this.Q2e();this.Z5?this.S7a(!0):this.da.fV=!0;this.tableRange=this.KSh(this.Qj.Ey(this.sourceRange.topLeft));
const ta=this.xY?!0:!1;this.tableRange&&!this.tableRange.equals(this.sourceRange)?(this.cra=this.tableRange,this.wR=1,this.$I=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right,this.YI?this.Rca(ta,G.La.rawEvent):this.iyb(!0,G.La.rawEvent)):(this.tableRange=null,this.isRow=this.sourceRange.isRow,this.lk=this.sourceRange.lk,this.isRow||this.lk?(this.wR=3,this.MX=this.isRow?1:2,this.YI?this.Rca(ta,G.La.rawEvent):this.P9b(!0,G.La.rawEvent),this.ms&&(G=G.clientPoint,
this.KRg(G),this.Fdf(G))):(this.wR=2,this.MX=0,this.YI?this.P9b(ta,G.La.rawEvent):this.Rca(!0,G.La.rawEvent)))}T4a(){this.Z5?this.S7a(!1):this.da.fV=!1;this.K6a();this.wR=0;this.ms&&(this.F8a(!1),this.UTb());if(!this.$.uy([this.Oh],!1))return this.IX(!0),this.mHa(),this.yz=-1,!0;if(!this.U8g()||this.dVb(this.Oh)||this.dVb(this.sourceRange))this.yz=-1;else{this.q8();this.ha.sourceRange=this.sourceRange.clone();const G=this.ha.sourceRange,ta=this.ha.qa.jj;this.KC?this.$.si(-694765314,2,30,{[Y.a.Rma]:this.p6,
[Y.a.h5]:G,[Y.a.g5]:ta,[Y.a.Zva]:this.YI,[Y.a.fjb]:this.BWb}):this.$.si(-694765314,2,30,{[Y.a.Rma]:this.p6,[Y.a.h5]:G,[Y.a.g5]:ta,[Y.a.Zva]:this.YI})}this.IX(!0);this.mHa();return!0}aae(G){const ta=G.clientPoint,jb=this.KC?this.ha.l4(ta,G.li,5,!0):this.ha.Yy(ta,G.li,5,void 0,void 0,!0);this.y7=G;this.ms&&(this.i1()||this.gha())&&(this.Pxb(ta),this.g9b(ta));return this.UQf(jb)?(this.Oh=this.OWa(jb),this.dPf(G,!0),!0):this.d6i(jb)?(this.Oh=this.rKb(jb),this.ePf(G,!0),!0):!1}wYi(G){return!this.i1()||
this.YI&&1!==G.height?!this.gha()||this.YI&&1!==G.width?G.toString():yb.Range.rR(G.left):G.top.toString()}iQ(G){for(let ta=1;4>=ta;ta++){const jb=this.ez[ta.toString()];if(jb&&jb.childNodes&&0<jb.childNodes.length)if(this.xY){const sc='<span style="font-weight:600;">'+this.wYi(this.Oh)+"</span>";this.Bi.hr(jb.childNodes[0],String.format(this.tOb,sc));G&&(jb.childNodes[1].innerText=this.YI?"":this.q8b)}else jb.childNodes[0].innerText=this.Oh.toString(),jb.childNodes[1].innerText=this.tOb,G&&(jb.childNodes[2].innerText=
this.q8b)}}UQf(G){return!!this.cra&&1!==this.wR&&!!G&&this.cra.contains(G.topLeft)}d6i(G){return!!this.cra&&1===this.wR&&!!G&&!this.cra.contains(G.topLeft)}dPf(G,ta){this.tableRange=this.cra;this.wR=1;const jb=!this.YI;ta?(this.IX(!1),this.iyb(this.xY?!0:jb,G.La.rawEvent)):(this.iXa(!1),this.Rca(this.xY?!1:jb,G.La.rawEvent))}ePf(G,ta){this.tableRange=null;this.wR=2;const jb=!this.YI;ta?(this.IX(!1),this.DH=this.$I,this.P9b(this.xY?!1:jb,G.La.rawEvent)):(this.jXa(!1),this.Rca(this.xY?!0:jb,G.La.rawEvent))}qse(){if(!ha.f(this.$).ha.qa.Bn)return I.ULS.sendTraceTag(507875651,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;const G=ha.f(this.$).getRangeInformation(this.ha.qa.jj);for(const ta of G)if(Object(cd.a)($d.PivotTableRange,ta))return I.ULS.sendTraceTag(507875650,0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because intersecting a pivot table"),!1;return!0}KSh(G){if(G&&G.contains(this.sourceRange)&&!G.equals(this.sourceRange)){if(G.Oxa&&
this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===G.top){const ta=new yb.Range(this.sourceRange.top,this.sourceRange.left,G.bottom,this.sourceRange.right,!1,!1);if(!ta.equals(G))return this.sourceRange=ta,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),G}this.$I=G.left===this.sourceRange.left&&G.right===this.sourceRange.right;if(G.top===this.sourceRange.top&&G.bottom===this.sourceRange.bottom||this.$I)return G}return null}OWa(G){const ta=G.clone();this.$I?
ta.left=Math.max(G.left-this.Umb,1):ta.top=Math.max(G.top-this.hAb,1);ta.right=ta.left+this.sourceRange.width-1;ta.bottom=ta.top+this.sourceRange.height-1;return this.xIb(ta)}aYd(){const G=this.Oh.topLeft.Xi(this.sourceRange);return!G&&(this.tableRange||this.ms&&(this.isRow||this.lk))?this.$I||this.ms&&this.isRow?this.Oh.top===this.sourceRange.bottom+1:this.Oh.left===this.sourceRange.right+1:G}tfk(){if(this.$I&&this.Oh.left!==this.tableRange.left||!this.$I&&this.Oh.top!==this.tableRange.top){const G=
be.a.nj(1,1,0,918,0,2065438552,"RearrangeInvalidDest");Fe.a(this.$).aD([G]);return!0}return!1}qak(){const G=this.$.Eh.Li("UserAction","RearrangeRowColumnClientSide"),ta={["CopyPasteTargetType"]:1,["OperationId"]:Oc.a.create().toString(),["Stopwatch"]:G,["DragDropIsShiftKeyDown"]:this.YI,["EncounteredDeploymentErrors"]:!1},jb=this.p6?2:1,sc=this.$.la.kh(254);(new Promise((Vc,nd)=>{this.jti(xd=>{xd.Errors&&0<xd.Errors.length?nd(new Sc(22,xd.Errors)):Vc(!0)},xd=>{xd=vc.a.gk(xd.data);nd(new Sc(22,xd))})})).then(()=>
{I.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');sc&&sc.uBj(ta,jb,this.sourceRange,this.Oh);return Promise.resolve(!0)},Vc=>{I.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Vc?copyPasteInfra.getStringifiedError(Vc):"null"}, copyPasteTargetType="${1}"`);return sc?sc.zYj(Vc,ta,jb,this.sourceRange,this.Oh):Promise.reject(Vc)})}jti(G,ta){G=void 0===G?null:G;ta=void 0===
ta?null:ta;const jb={};this.$I?(jb.FirstRow=this.Oh.top-1,jb.FirstColumn=0,jb.DeltaColumn=0,jb.DeltaRow=this.Oh.bottom-this.Oh.top+1):(jb.FirstRow=0,jb.FirstColumn=this.Oh.left-1,jb.DeltaColumn=this.Oh.right-this.Oh.left+1,jb.DeltaRow=0);jb.LastRow=Gc.a.eG;jb.LastColumn=Gc.a.PE;jb.SheetName=this.$.sa.ma?this.$.sa.ma.name:this.$.$h.getItemByName(this.$.$h.ma.name).sheetName;const sc=Lb.x(this.sourceRange,this.$);this.$.userOperationManager.enqueueOperation(new bc.a(514,0,(Vc,nd,xd)=>{var Hd=this.$.pa.ta;
Vc=G?Xc.c(Vc,G):Vc;nd=ta?Xc.b(nd,ta):nd;const ke=Hd.$a(41,null);ke.sourceRange=sc;ke.destinationRange=jb;return ad.h(Hd,"RearrangeRowColumn",ke,Vc,nd,xd,null,0)},64,()=>new Id(sc,jb)),null)}hRa(G){void 0===G?this.YI=this.p6=!1:0===G?this.p6=!1:1===G&&(this.YI=!1);!this.Gya||this.p6||this.YI||(jc.a.instance.Qa(gb.a.rk,this.domElement.ownerDocument.body,this.onKeyUp),this.Gya=!1)}z4b(){this.Gya||(jc.a.instance.xa(gb.a.rk,this.domElement.ownerDocument.body,this.onKeyUp),this.Gya=!0)}rff(){jc.a.instance.Qa(gb.a.Ui,
this.domElement.ownerDocument.body,this.onKeyDown);this.hRa(void 0)}the(G){G=void 0===G?!1:G;this.yz=5;this.lqa(this.Rr,this.Bo);this.tOb=this.kii;this.q8b=this.hKk;this.exb(this.y7.clientPoint,this.y7.li,this.ms&&this.isRow?66:this.ms&&this.lk?67:48,G)}Ahk(G){G=void 0===G?!1:G;this.yz=6;let ta;this.ms?this.isRow?(this.KF=dd.sfk,ta=58):this.lk?(this.KF=dd.rfk,ta=59):this.$I?(this.KF=[11],ta=11):(this.KF=[12],ta=12):(ta=this.isRow||this.$I?11:12,this.KF=[ta]);this.lqa(this.xog,this.Eog);this.tOb=this.Erf;
this.q8b=this.vSg;this.exb(this.y7.clientPoint,this.y7.li,ta,G)}Ehe(G){G=void 0===G?!1:G;this.yz=6;this.KF=this.$I?[11]:[12];this.lqa(this.gQc,this.hQc);this.tOb=this.Erf;this.q8b=this.vSg;this.exb(this.y7.clientPoint,this.y7.li,this.$I?11:12,G)}Rca(G,ta){this.uya&&this.O9b(this.isRow?"drag_row_replace":this.lk?"drag_column_replace":"drag_range_replace",ta);this.the(G);this.Fzb(G)}P9b(G,ta){this.uya&&this.O9b(this.isRow?"drag_row_insert":this.lk?"drag_column_insert":"drag_range_insert",ta);this.Ahk(G);
this.L3c(G)}iyb(G,ta){this.uya&&this.O9b(this.$I?"drag_table_row_rearrange":"drag_table_column_rearrange",ta);this.Ehe(G);this.L3c(G)}iXa(G){this.Gh.Mq(this.KF);this.kHa(this.xog,this.Eog,void 0,G);this.uya&&this.r0c()}g4f(){return!this.Oh.equals(this.sourceRange)}h4f(){return!this.aYd()}hWd(){return this.p6}U8g(){return this.ha.qa.jj.equals(this.Oh)?(I.ULS.sendTraceTag(507787463,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Drag Drop Not Allowed because source range and destination range are the same"),
!1):!0}}Object(D.a)(ue,"DragSelectionClickBehaviorCellRangeAndTable",dd,[]);var Vd=a(360),Kd=a(139);class Yd extends dd{constructor(G,ta,jb,sc,Vc,nd){super(G,ta,jb,sc,Vc,nd);this.uae=()=>{this.da.fV&&this.jXa(!0);5===this.yz&&this.IX(!0);this.K6a()};this.hQc=xd=>{this.zoomManager.il(xd);this.Z5?this.S7a(!1):this.da.fV=!1;this.K6a();this.ms&&(this.F8a(!1),this.UTb());this.ha.sourceRange=this.sourceRange.clone();if(this.W2f)this.$.si(927125067,jd.a.rh,30,null);else if(this.dha){this.q8();this.ha.sourceRange=
this.sourceRange.clone();xd=this.ha.sourceRange;const Hd=this.ha.qa.jj;this.KC?this.$.si(-694765314,2,30,{[Y.a.Rma]:!0,[Y.a.h5]:xd,[Y.a.g5]:Hd,[Y.a.Zva]:!1,[Y.a.fjb]:this.BWb}):this.$.si(-694765314,2,30,{[Y.a.Rma]:!0,[Y.a.h5]:xd,[Y.a.g5]:Hd,[Y.a.Zva]:!1});I.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells");ha.f(this.$).co.PA(Y.a.Gaa);this.dha=!1}else this.iak();this.jXa(!0);this.KC&&this.mHa();this.yz=-1;return!0};this.gQc=xd=>{xd=this.zoomManager.il(xd);
const Hd=xd.clientPoint;this.y7=xd;let ke=this.KC?this.ha.l4(Hd,xd.li,5,!0):this.ha.Yy(Hd,xd.li,5,void 0,void 0,!0);this.ms&&(this.i1()||this.gha())&&(this.Pxb(Hd),this.g9b(Hd));if(ke){if(!this.QYd(ke))return this.q2i(xd),!0;xd=this.H1a?this.da.fh.Lo(ke):void 0;this.eYb?ke=this.ZJd(ke,this.isRow,Hd,xd):this.C6g(ke,this.isRow,Hd,xd);if(this.isRow||this.lk)this.Oh=this.OWa(ke);this.ha.sourceRange=this.Oh;this.Gh.tt(this.Oh,this.KF);this.Gh.Nw(this.KF);this.ms?this.TTb():this.Gh.Mq(dd.MYa);this.iQ()}return!0};
this.onKeyDown=xd=>this.Xnb(xd)?(this.z4b(),this.dha||(this.dha=!0,ha.f(this.$).co.PA(Ab.Jsc),this.ms&&this.n4c()),!0):!1;this.onKeyUp=xd=>{this.Xnb(xd)&&(this.hRa(),this.da.fV?ha.f(this.$).co.PA(Ab.fDd):ha.f(this.$).co.PA(Y.a.Gaa),this.ms&&this.n4c());return!0};this.xng=xd=>{xd.Errors&&0<xd.Errors.length?(I.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${be.a.Yh(xd.Errors)}]`),this.Oh.left=this.sourceRange.left,this.Oh.right=this.sourceRange.right,
this.Oh.top=this.sourceRange.top,this.Oh.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.Oh.top&&this.sourceRange.bottom>=this.Oh.top-1?(this.Oh.top=this.sourceRange.top,this.Oh.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.Oh.top||(this.Oh.top-=this.sourceRange.height),this.Oh.bottom=this.Oh.top+this.sourceRange.height-1):this.sourceRange.left<=this.Oh.left&&this.sourceRange.right>=this.Oh.left-1?(this.Oh.left=this.sourceRange.left,this.Oh.right=this.sourceRange.right):
(this.sourceRange.left>this.Oh.left||(this.Oh.left-=this.sourceRange.width),this.Oh.right=this.Oh.left+this.sourceRange.width-1);this.q8();this.yz=-1};this.wng=xd=>{xd=vc.a.gk(xd.data);I.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${be.a.Yh(xd)}]`)};this.dha=this.Gya=!1}dispose(){super.dispose()}$$d(G){this.y7=G;this.isRow=this.lk=!1;this.Q2e();this.MX=null!=this.Oh?this.Oh.isRow?1:this.Oh.lk?2:0:0;this.Z5?this.S7a(!0):this.da.fV=!0;jc.a.instance.xa(gb.a.Ui,
this.domElement.ownerDocument.body,this.onKeyDown);this.TVd(G)&&(this.z4b(),this.dha=!0,ha.f(this.$).co.PA(Ab.Jsc));this.Rh=this.Qj.oxa(this.sourceRange);this.XXf=this.Kpj(this.Oh);this.Rh||I.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.W2f=(new Kd.a(this.$.sa)).wn;this.QYd(this.Oh)?(this.isRow=this.Bqj(),this.lk=this.Bij(),this.isRow||this.lk?(this.Pob=!1,this.Oh=this.OWa(this.Oh),this.iyb(G)):
(this.Pob=!0,this.Rca(G))):(this.Pob=!0,this.Rca(G),this.ms&&(this.i1()||this.gha())&&(G=G.clientPoint,this.KRg(G),this.Fdf(G)))}T4a(){this.Z5?this.S7a(!1):this.da.fV=!1;this.K6a();this.ms&&(this.F8a(!1),this.UTb());if(this.W2f)return this.$.si(927125067,jd.a.rh,30,null),this.KC&&this.mHa(),this.IX(!0),this.Pob=!1,this.yz=-1,!0;if(this.dha||this.XXf){this.q8();this.ha.sourceRange=this.sourceRange.clone();const G=this.ha.sourceRange,ta=this.ha.qa.jj;this.KC?this.$.si(-694765314,2,30,{[Y.a.Rma]:this.dha,
[Y.a.h5]:G,[Y.a.g5]:ta,[Y.a.Zva]:!1,[Y.a.fjb]:this.BWb}):this.$.si(-694765314,2,30,{[Y.a.Rma]:this.dha,[Y.a.h5]:G,[Y.a.g5]:ta,[Y.a.Zva]:!1});I.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.dha}"`);ha.f(this.$).co.PA(Y.a.Gaa);this.IX(!0);this.KC&&this.mHa();this.Pob=!1;this.yz=-1;this.XXf=!1;return!0}return 5===this.yz?(this.IX(!0),this.Pob=!1,this.aPk(),this.yz=-1,!0):!1}aae(G){const ta=G.clientPoint,jb=this.KC?
this.ha.l4(ta,G.li,5,!0):this.ha.Yy(ta,G.li,5,void 0,void 0,!0);this.y7=G;this.ms&&(this.i1()||this.gha())&&(this.Pxb(ta),this.g9b(ta));return this.Pob?!1:this.QYd(jb)?(this.r2i(G),!0):!1}iQ(){const G=new yb.Range(this.Oh.top,this.Oh.left,this.Oh.bottom,this.Oh.right,!1,!0);6===this.yz&&(this.isRow?(--G.top,G.bottom=G.top+this.Oh.height-1):(--G.left,G.right=G.left+this.Oh.width-1));for(let ta=1;4>=ta;ta++){const jb=this.ez[ta.toString()];jb&&jb.childNodes&&0<jb.childNodes.length&&(jb.childNodes[0].innerText=
G.toString())}}qse(){if(!ha.f(this.$).ha.qa.Bn)return I.ULS.sendTraceTag(507875653,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;var G=ha.f(this.$).getRangeInformation(this.ha.qa.jj);for(var ta of G)if(Object(cd.a)($d.PivotTableRange,ta)&&(G=this.Qj.oxa(ta)))return ta=!G.isOlap||!G.Dpb(!0),I.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",
G),G.isActionable&&ta;return!1}OWa(G){G=G.clone();this.isRow?(G.left=this.sourceRange.left,G.right=this.Rh.right,G.bottom=G.top+this.sourceRange.height-1):this.lk?(G.top=this.sourceRange.top,G.bottom=this.Rh.mL?this.Rh.mL.bottom:this.Rh.bottom,G.right=G.left+this.sourceRange.width-1):I.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.xIb(G)}iak(){const G={},ta=Lb.x(this.sourceRange,this.$);if(this.isRow){ta.FirstColumn=
G.FirstColumn=this.Oh.left-1;ta.LastColumn=G.LastColumn=this.Oh.right-1;if(this.sourceRange.top<=this.Oh.top&&this.sourceRange.bottom>=this.Oh.top-1){I.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.Oh.top?G.LastRow=G.FirstRow=this.Oh.top-1:(G.FirstRow=this.Oh.top-this.sourceRange.height-1,G.LastRow=G.FirstRow+this.sourceRange.height-1)}else{G.FirstRow=Math.min(this.Oh.top,this.Oh.bottom-1);G.LastRow=this.Oh.bottom-
1;if(this.sourceRange.left<=this.Oh.left&&this.sourceRange.right>=this.Oh.left-1){I.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}G.LastColumn=this.sourceRange.left>this.Oh.left?G.FirstColumn=this.Oh.left-1:G.FirstColumn=this.Oh.left-this.sourceRange.width-1}const jb={};jb.SheetName=this.$.sa.ma?this.$.sa.ma.name:this.$.$h.getItemByName(this.$.$h.ma.name).sheetName;jb.Ranges=Array(2);jb.Ranges[0]=ta;jb.Ranges[1]=G;this.eti(jb)}eti(G){this.$.userOperationManager.enqueueOperation(new bc.a(265,
0,(ta,jb,sc)=>{var Vc=this.$.pa.ta;ta=this.xng?Xc.c(ta,this.xng):ta;jb=this.wng?Xc.b(jb,this.wng):jb;const nd=Vc.$a(1,null);nd.moveRange=G;return ad.h(Vc,"MoveLineItems",nd,ta,jb,sc,null,0)},64),null)}QYd(G){return null!==this.Rh&&null!==G&&this.rnj(G)&&this.tqj(G)&&this.Ksj(G)&&this.zhj(G)}rnj(G){return this.Rh.mL?G.left>=this.Rh.mL.left:this.Rh.HI?G.left>=this.Rh.HI.left:G.left>=this.Rh.left}tqj(G){return this.Rh.HI?G.right<=this.Rh.HI.right:this.Rh.mL?G.right<=this.Rh.mL.right:G.right<=this.Rh.right}Ksj(G){return this.isRow?
null!==this.Rh.mL&&G.top>=this.Rh.mL.top:this.lk?null!==this.Rh.HI&&G.top>=this.Rh.HI.top:null===this.Rh.top||G.top>=this.Rh.top}zhj(G){return this.Rh.mL?G.bottom<=this.Rh.mL.bottom:this.Rh.HI?G.bottom<=this.Rh.HI.bottom:G.bottom<=this.Rh.bottom}Kpj(G){return null!==this.Rh&&this.Rh.left>=G.left&&this.Rh.right<=G.right&&this.Rh.top>=G.top&&this.Rh.bottom<=G.bottom}Bqj(){return null!==this.Rh&&null!==this.Rh.mL&&this.Rh.mL.top<=this.Oh.top&&this.Rh.mL.left<=this.Oh.left&&this.Rh.mL.right>=this.Oh.left}Bij(){return null!==
this.Rh&&null!==this.Rh.HI&&this.Rh.HI.top===this.Oh.top&&this.Rh.HI.left<=this.Oh.left&&this.Rh.HI.right>=this.Oh.right}Ehe(G){this.yz=6;this.KF=this.isRow?[11]:[12];this.lqa(this.gQc,this.hQc);this.exb(G.clientPoint,G.li,this.isRow?11:12,!1)}the(G){this.yz=5;this.lqa(this.Rr,this.Bo);this.exb(G.clientPoint,G.li,this.ms&&this.i1()?66:this.ms&&this.gha()?67:48,!1)}iyb(G){this.uya&&this.O9b(this.isRow?"drag_pivot_row_rearrange":"drag_pivot_column_rearrange",G.La.rawEvent);this.Ehe(G);this.L3c()}Rca(G){this.uya&&
this.O9b("drag_pivot_replace",G.La.rawEvent);this.the(G);this.Fzb()}r2i(G){this.IX(!1);this.Oh=this.OWa(this.Oh);this.iyb(G)}q2i(G){this.jXa(!1);this.Rca(G)}aPk(){if((null==this.sourceRange||null==this.Oh||this.sourceRange.FE(!1)!==this.Oh.FE(!1))&&!this.dVb(this.Oh)){var G=be.a.nj(1,0,904,903,0,2069074184,"PivotTableInvalidMove");G.HelpTopicId=Vd.a.tTk;G.HelpDescription=ka.a.instance.ia(913);Fe.a(this.$).aD([G])}}hRa(){this.dha=!1;this.Gya&&(jc.a.instance.Qa(gb.a.rk,this.domElement.ownerDocument.body,
this.onKeyUp),this.Gya=!1)}z4b(){this.Gya||(jc.a.instance.xa(gb.a.rk,this.domElement.ownerDocument.body,this.onKeyUp),this.Gya=!0)}g4f(){return!this.Oh.equals(this.sourceRange)}h4f(){return!1}hWd(){return this.dha}rff(){jc.a.instance.Qa(gb.a.Ui,this.domElement.ownerDocument.body,this.onKeyDown);this.hRa()}}Object(D.a)(Yd,"DragSelectionClickBehaviorPivotTableRange",dd,[]);var Bc=a(431);class Mc extends Bd{constructor(G,ta){super(G);this.tm=()=>{this.domElement.classList.remove(tc.selecting);Bc.c(this.da.$,
!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Vy=()=>{this.domElement.classList.add(tc.selecting)};this.onPointerDown=jb=>{2===jb.Dh&&jb.Iw===Sys.UI.MouseButton.leftButton&&(this.da.ha.selectionType=4,this.da.ha.sourceRange=this.da.ha.qa.jj,Bc.c(this.da.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.c7=()=>{this.da.$.si(1983983164,2,30,null);return!0};this.Cj=()=>{ja.DOMElementExtensions.setVisible(this.ena,this.da.$.isEditMode)};this.j2b=()=>{ja.DOMElementExtensions.setVisible(this.ena,
!1)};this.i2b=()=>{ja.DOMElementExtensions.setVisible(this.ena,!0)};this.vlg=()=>{ja.DOMElementExtensions.setVisible(this.ena,!1)};this.ulg=()=>{ja.DOMElementExtensions.setVisible(this.ena,!0)};this.X0b=(jb,sc)=>{ja.DOMElementExtensions.setVisible(this.ena,!sc.Lnd)};this.da=ta;ta=document.createElement("div");ta.className=xa.EwaSettings.aG()?vd.Lb:vd.Kb;this.ena=ta;this.Cj(null,null);G.appendChild(ta);db.a.instance.xa(gb.a.qj,this.ena,this.onPointerDown);gc.a.instance.xa(gb.a.Nr,this.ena,this.c7);
this.da.$.mr(this.Cj);this.da.$.vh.g5e(this.j2b);this.da.$.vh.f5e(this.i2b);this.da.T3e(this.X0b);this.da.cellTextEditBox.Iv(this.vlg);this.da.cellTextEditBox.Jx(this.ulg)}dispose(){db.a.instance.Qa(gb.a.qj,this.ena,this.onPointerDown);gc.a.instance.Qa(gb.a.Nr,this.ena,this.c7);this.da.$&&(this.da.ha.Jia(this.Vy),this.da.ha.Q7(this.tm),this.da.$.Wr(this.Cj),this.da.$.vh.aGg(this.j2b),this.da.$.vh.$Fg(this.i2b),this.da.XEg(this.X0b),this.da.cellTextEditBox.Cv(this.vlg),this.da.cellTextEditBox.Lw(this.ulg));
super.dispose()}}Object(D.a)(Mc,"FillHandleClickBehavior",Bd,[]);class Fd{constructor(G){this.iTf=ta=>{this.z3c(ta.li,1);return!0};this.jTf=ta=>{this.z3c(ta.li,-1);return!0};this.tm=()=>{this.rXd=!1};this.Vy=()=>{this.rXd=!0};this.da=G;this.Zmb=0;this.rXd=this.UHc=!1;this.Cha=Number.NaN;this.da.ha.wla(this.Vy);this.da.ha.e4(this.tm);this.da.ha.S4e(this.tm)}dispose(){this.da.ha.Jia(this.Vy);this.da.ha.Q7(this.tm);this.da.ha.NFg(this.tm)}AZ(){this.Zmb=0;this.UHc=!1;this.Cha=Number.NaN}Grf(G){this.UHc=
!0;this.z3c(G,1)}Hrf(G){this.UHc=!1;this.z3c(G,-1)}z3c(G,ta){if(G)if(G.parentNode)if(this.rXd)isNaN(this.Cha)||(this.U3c(this.Cha,!1),this.Cha=Number.NaN);else if(G=parseInt(G.parentNode.getAttribute(Y.a.CUb),10),isNaN(G))I.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.Cha)&&G!==this.Cha){if(this.UHc)return;this.U3c(this.Cha,!1)}if(isNaN(this.Cha)||G!==this.Cha)this.Cha=G,this.Zmb=0;!this.Zmb&&0<ta&&
this.U3c(G,!0);this.Zmb=Math.max(this.Zmb+ta,0);!this.Zmb&&0>ta&&(this.U3c(G,!1),this.Cha=Number.NaN)}else I.ULS.shipAssertTag(537159367,0,!!G.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else I.ULS.shipAssertTag(537159368,0,!!G,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}U3c(G,ta){var jb=this.da.fh.Lbc;for(const sc of jb)for(jb=this.da.Gh.VU(3,sc,G).rl,ja.DOMElementExtensions.toggleCssClass(jb,tc.Eri,ta),jb=jb.firstChild;jb;jb=jb.nextSibling)Ua.a.contains(jb.className,
"resizemarqueehandle",!0)&&ja.DOMElementExtensions.toggleCssClass(jb,tc.Gri,ta)}}Object(D.a)(Fd,"MarqueeHoveringManager",null,[]);var Md=a(327),oe=a(153),ye=a(1052),te=a(1389),ze=a(392);class He extends xb{constructor(G,ta){super(G);this.JDc=!1;this.fQc=()=>{if(!this.wB)return I.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.wB.ydk(this.Nna);this.wB.mli(this.Ona);if(3===this.wB.model.state)return!0;this.wB.wSd(!0);return!0};
this.Bpa=()=>{if(!this.wB)return!1;this.wB.nzg(!1);this.wB.ole(this.Ona,!1);if(3===this.wB.model.state)return!0;this.wB.wSd(!1);return!0};this.onPointerDown=jb=>this.wB?2===jb.Dh&&jb.Iw===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.w1b=()=>{if(!this.wB)return!1;this.wB.ole(this.Ona,!0);this.wB.wSd(!1);this.wB.Wib();return!0};this.onDoubleClick=jb=>{if(jb.La)return jb.La.stopPropagation(),!0;I.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");
return!0};this.container=G;this.wB=Object(oe.a)(te.a,ta.metadata);this.wTg(ta)&&this.DVf(ta.isVisible)}dispose(){this.DDg();this.wB=null;super.dispose()}$eb(G){this.wB=Object(oe.a)(te.a,G.metadata);this.wTg(G)?this.DVf(G.isVisible):this.DDg();!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")&&G.isVisible!==G.xMa&&this.wB&&(this.wB.JHk(G.isVisible?1:0),ja.DOMElementExtensions.setVisible(this.Ona,G.isVisible))}DVf(G){this.JDc||(this.JDc=!0,this.Ona=document.createElement("div"),
this.Ona.id=`${this.container.id}-${Y.a.Ndf}`,this.Ona.className=ye.f,this.Nna=document.createElement("div"),this.Nna.id=`${this.container.id}-${Y.a.BUh}`,this.Nna.className=ye.c,this.Y0=document.createElement("div"),this.Y0.appendChild(this.Nna),this.Y0.className=ye.d,this.Ona.appendChild(this.Y0),this.container.appendChild(this.Ona),I.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created."),db.a.instance.xa(gb.a.z7,
this.Y0,this.fQc),db.a.instance.xa(gb.a.bL,this.Y0,this.Bpa),db.a.instance.xa(gb.a.qj,this.Y0,this.onPointerDown),Md.a.instance.xa(gb.a.click,this.Y0,this.w1b),Md.a.instance.xa(gb.a.Nr,this.Y0,this.onDoubleClick),ja.DOMElementExtensions.setVisible(this.Y0,G))}DDg(){this.JDc&&(this.JDc=!1,db.a.instance.Qa(gb.a.z7,this.Y0,this.fQc),db.a.instance.Qa(gb.a.bL,this.Y0,this.Bpa),db.a.instance.Qa(gb.a.qj,this.Y0,this.onPointerDown),Md.a.instance.Qa(gb.a.click,this.Y0,this.w1b),Md.a.instance.Qa(gb.a.Nr,this.Y0,
this.onDoubleClick),ja.DOMElementExtensions.an(this.Nna),this.Nna=null,ja.DOMElementExtensions.an(this.Ona),this.Ona=null)}wTg(G){G=new ze.a(G.range,G.sheetId);return!!this.wB&&this.wB.gGc(G)}}Object(D.a)(He,"RangeCatchUpActivityHighlightBehavior",xb,[]);class ne extends Pb{constructor(G,ta,jb,sc,Vc){super(G,ta,jb,sc,Vc)}get Laa(){return 16}get uwb(){return this.da.ha.rangePicker.TJd(!1)}v8a(){return(this.da.inRangePicker||this.da.lq)&&super.v8a()}}Object(D.a)(ne,"RangePickerTouchGrippiesBehavior",
Pb,[]);class of extends xb{constructor(G,ta,jb){super(G);const sc=document.createElement("div"),Vc=document.createElement("div");xa.EwaSettings.ms()?jb?(sc.className=ta?tc.ksi:tc.msi,Vc.className=ta?tc.lsi:tc.jsi):(sc.className=ta?tc.gsi:tc.isi,Vc.className=ta?tc.hsi:tc.fsi):(sc.className=ta?tc.osi:tc.qsi,Vc.className=ta?tc.psi:tc.nsi);G.appendChild(sc);G.appendChild(Vc)}}Object(D.a)(of,"RearrangeHighlightBehavior",xb,[]);var lf;(function(G){G[G.topLeft=0]="topLeft";G[G.topRight=1]="topRight";G[G.bottomLeft=
2]="bottomLeft";G[G.bottomRight=3]="bottomRight";G[G.error=4]="error"})(lf||(lf={}));Object(D.b)("Corner",lf);class jf extends xb{constructor(G,ta,jb,sc,Vc,nd){super(G);this.Zi=this.gW=null;this.Afa=0;this.Oh=this.sourceRange=null;this.j9a=!1;this.onPointerDown=xd=>{xd=this.zoomManager.il(xd);if(this.XSg(xd)&&!this.j9a){this.S9f();this.Zi=this.ow.RJd();this.gW=this.ow.BLf(xd);if(!this.Zi||!this.gW||!this.gW.range)return I.ULS.shipAssertTag(537159361,0,!!this.Zi,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),
I.ULS.shipAssertTag(537159360,0,!!this.gW,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),I.ULS.shipAssertTag(537159331,0,!!this.gW.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.Oh=this.gW.range.clone();this.sourceRange=this.Oh.clone();this.Afa=this.NGf(xd);if(4===this.Afa)return I.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Hd=this.gJf(xd,!0);if(!Hd)return I.ULS.shipAssertTag(537159329,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.Flf(Hd))return I.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.da.eLa=!0;this.Zi.xO(!1);this.GP.Grf(xd.li);this.ow.Dzg(!0,this.ZR.jma);this.Zi.Wa.removeSelection();this.Zi.Omc(this.NPf);this.TCg();this.j9a=!0;Zc.b(this.$,!0)}return!0};this.Rr=xd=>{xd=this.zoomManager.il(xd);xd=this.gJf(xd,!1);if(!xd)return!0;
xd=this.Flf(xd);if(!xd)return I.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.Dyc(!0),!1;if(this.Oh.equals(xd))return!0;this.Oh=xd;xd=this.Fzb();xd||(I.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Dyc(!0));return xd};this.Bo=xd=>{this.zoomManager.il(xd);xd=this.q8();I.ULS.shipAssertTag(537159325,0,xd,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.Dyc(!xd);
return xd};this.NPf=()=>{this.Dyc(!0)};this.da=ta;this.zoom=nd;this.$=ta.$;this.$V=[];this.ha=this.da.ha;this.GP=jb;this.ow=sc;this.ZR=Vc;ta=oa.Ec.Aa()?za.a.nh(oa.Ec):this.$.la.kh(464);I.ULS.shipAssertTag(510255176,0,!!ta,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");this.ED=ta.ED;for(const xd of this.zIg())ta=this.ow.Jkf(G,xd,this.w5e(),this.onPointerDown),this.$V.push(ta);for(const xd of this.$V)db.a.instance.xa(gb.a.z7,
xd,this.GP.iTf),db.a.instance.xa(gb.a.bL,xd,this.GP.jTf);this.$eb(Vc)}dispose(){this.$V.forEach(G=>{db.a.instance.Qa(gb.a.qj,G,this.onPointerDown)});this.$V.length=0;super.dispose()}get zoomManager(){return this.zoom.zoomManager}$eb(G){this.ZR=G;this.E5e(G);this.ow.V7b(G,this.$V,this.pse());this.GP.AZ()}gJf(G,ta){const jb=G.li;G=G.clientPoint;if(!jb||!G)return I.ULS.shipAssertTag(537159324,0,!!jb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),I.ULS.shipAssertTag(537159323,0,!!G,
"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ta&&(G=this.xdg(G));ta=this.ha.Yy(G,jb,0,!0,!1,!0);ta||(G=this.xdg(G),ta=this.ha.Yy(G,jb,0,!0,!1,!0));return ta}xdg(G){G.y+=0===this.Afa||1===this.Afa?2:-2;G.x+=0===this.Afa||2===this.Afa?2:-2;return G}Flf(G){if(!G||!this.sourceRange)return I.ULS.shipAssertTag(537159322,0,!!G,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),I.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.Afa)return new yb.Range(G.top,G.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.Afa)return new yb.Range(G.top,this.sourceRange.left,this.sourceRange.bottom,G.right,!0,!1);if(2===this.Afa)return new yb.Range(this.sourceRange.top,G.left,G.bottom,this.sourceRange.right,!0,!1);if(3===this.Afa)return new yb.Range(this.sourceRange.top,this.sourceRange.left,G.bottom,G.right,!0,!1);I.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${lf[this.Afa]}`);
return null}q8(){return this.ED.wdg(this.Zi,this.gW,this.Oh)}Fzb(){return this.q8()}Dyc(G){G&&I.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate formula highlights as a fallback.");this.GP.Hrf(this.$V[0]);this.ow.Dzg(!1,this.ZR.jma);this.Zi.Wa.setCaretPositionToEnd();this.Zi.cVc(this.NPf);this.C4g();this.j9a=this.da.eLa=!1;Zc.b(this.$,!1);this.ow.rBg()}}Object(D.a)(jf,"ResizeMarqueeBehaviorBase",xb,[]);class Cf extends jf{constructor(G,
ta,jb,sc,Vc,nd){super(G,ta,jb,sc,Vc,nd)}zIg(){return[tc.usi,tc.vsi,tc.ssi,tc.tsi]}w5e(){return[tc.rsi]}NGf(G){G=G.li;if(G===this.$V[0])return 0;if(G===this.$V[1])return 1;if(G===this.$V[2])return 2;if(G===this.$V[3])return 3;I.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}TCg(){this.ow.lqa(this.Rr,this.Bo,!0)}C4g(){this.ow.ize(this.Rr,this.Bo,!0)}XSg(G){return 2===(jd.a.rh=G.Dh)&&G.Iw===Sys.UI.MouseButton.leftButton}pse(){return!0}S9f(){I.ULS.sendTraceTag(537159317,
0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}E5e(G){for(const ta of this.$V)ta.style.backgroundColor=G.rl.style.borderColor}}Object(D.a)(Cf,"ResizeMarqueeMouseBehavior",jf,[]);class Gf extends jf{constructor(G,ta,jb,sc,Vc,nd){super(G,ta,jb,sc,Vc,nd);this.q1b=()=>{const xd=3===jd.a.rh;this.$0d&&!xd?this.ow.V7b(this.ZR,this.$V,!1):!this.$0d&&xd&&this.ow.V7b(this.ZR,this.$V,!0);this.$0d=xd};this.WYj=(xd,Hd)=>{Hd.CUb===this.ZR.jma&&this.ow.V7b(this.ZR,
this.$V,!Hd.start&&this.pse())};jd.a.t4e(this.q1b);this.$0d=3===jd.a.rh;this.ow.mDh(this.WYj)}dispose(){jd.a.vFg(this.q1b);super.dispose()}zIg(){return[vd.tb,vd.sb]}w5e(){return[vd.pb,vd.rb,vd.qb]}NGf(G){G=G.li;if(G===this.$V[0])return 0;if(G===this.$V[1])return 3;I.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}TCg(){da.a.iS?this.ow.lqa(this.Rr,this.Bo,!1):this.ow.Whk(this.Rr,this.Bo)}C4g(){da.a.iS?this.ow.ize(this.Rr,
this.Bo,!1):this.ow.F5k(this.Rr,this.Bo)}XSg(G){return 3===(jd.a.rh=G.Dh)}pse(){return 3===jd.a.rh}S9f(){I.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}E5e(){}}Object(D.a)(Gf,"ResizeMarqueeTouchBehavior",jf,[]);class Af extends xb{constructor(G,ta){super(G);Af.vMb(G,Ec.a.Kri+" "+vd.v,null===ta||void 0===ta?void 0:ta.horizontal);Af.vMb(G,Ec.a.Jri+" "+vd.v,null===ta||void 0===ta?void 0:ta.vertical);Af.vMb(G,Ec.a.Hri+" "+
vd.v,null===ta||void 0===ta?void 0:ta.horizontal);Af.vMb(G,Ec.a.Iri+" "+vd.v,null===ta||void 0===ta?void 0:ta.vertical);Af.vMb(G,vd.Eb)}static vMb(G,ta,jb){const sc=document.createElement("div");sc.className=ta;jb&&(sc.style.backgroundImage=`url("${jb}")`);G.appendChild(sc)}}Object(D.a)(Af,"SelectionCutCopyBehavior",xb,[]);class Lf extends xb{constructor(G){super(G);appChrome.renderSpinner(G)}}Object(D.a)(Lf,"SelectionPasteBehavior",xb,[]);class Ef extends xb{constructor(G,ta){super(G);Ef.NMb(G,Ec.a.esi+
" "+vd.v,null===ta||void 0===ta?void 0:ta.horizontal);Ef.NMb(G,Ec.a.dsi+" "+vd.v,null===ta||void 0===ta?void 0:ta.vertical);Ef.NMb(G,Ec.a.bsi+" "+vd.v,null===ta||void 0===ta?void 0:ta.horizontal);Ef.NMb(G,Ec.a.csi+" "+vd.v,null===ta||void 0===ta?void 0:ta.vertical);Ef.NMb(G,vd.Pb)}static NMb(G,ta,jb){const sc=document.createElement("div");sc.className=ta;jb&&(sc.style.backgroundImage=`url("${jb}")`);G.appendChild(sc)}}Object(D.a)(Ef,"SelectionRangePickerBehavior",xb,[]);class Hf extends Pb{constructor(G,
ta,jb,sc,Vc){super(G,ta,jb,sc,Vc)}get Laa(){return 0}get uwb(){return this.da.ha.qa.jj}v8a(){const G=this.da.lq||this.da.isEditing;return this.da.ha.qa.Bn&&!G&&super.v8a()}}Object(D.a)(Hf,"SelectionTouchGrippiesBehavior",Pb,[]);var $b=a(60);let Wb=class extends kb.a{constructor(G,ta,jb,sc){super();this.pJb=(Vc,nd)=>{Vc=nd.Laa;const xd=this.da;nd=nd.x8i;const Hd=nd.rl,ke=nd.s$;switch(Vc){case 24:nd.s$.push(new He(Hd,nd));break;case 0:nd.s$.push(new Mc(Hd,xd));da.a.Zx||(ke.push(new ue(Hd,this.da.$,
nd.paneType,this.Qj,this.ow,this.zoom,this.e9i)),ke.push(new Yd(Hd,this.da.$,nd.paneType,this.Qj,this.ow,this.zoom)));ke.push(new Hf(nd,Hd,xd,nd.paneType,this.zoom));break;case 3:ke.push(new Bd(Hd));da.a.Zx||(ke.push(new rb(Hd,this.da.$,nd.paneType,this.GP,this.ow,nd,this.zoom)),ke.push(new Cf(Hd,this.da,this.GP,this.ow,nd,this.zoom)),ke.push(new Gf(Hd,this.da,this.GP,this.ow,nd,this.zoom)));break;case 4:case 5:case 65:ke.push(new Af(Hd,this.a7e));break;case 30:ke.push(new Lf(Hd));break;case 16:ke.push(new Ef(Hd,
this.a7e));ke.push(new ne(nd,Hd,xd,nd.paneType,this.zoom));break;case 11:case 12:case 58:case 59:case 60:case 61:ke.push(new of(Hd,11===Vc||58===Vc||60===Vc,58===Vc||59===Vc||60===Vc||61===Vc));break;case 17:ke.push(new Bd(Hd));break;case 19:ke.push(new Bd(Hd)),ke.push(new $c(nd,Hd,xd,nd.paneType,this.zoom))}nd.CJb=!0};this.$=G;this.zoom=jb;this.da=ha.f(G);this.e9i=sc;this.Qj=ta;this.GP=new Fd(this.da);this.ow=new Ba(this.da);this.da.Gh&&(this.da.Gh.GCh(this.pJb),this.da.Gh.update(!1))}get a7e(){xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.$6e&&(this.$6e={vertical:$b.a.current.Pu(104),horizontal:$b.a.current.Pu(105)});return this.$6e}dispose(){this.da.Gh.Omk(this.pJb);this.GP&&(this.GP.dispose(),this.GP=null);super.dispose()}};Wb=Object(U.__decorate)([Object(za.d)(oa.fd),Object(U.__param)(0,Object(oa.Nb)()),Object(U.__param)(1,Object(oa.vg)()),Object(U.__param)(2,Object(oa.ah)()),Object(U.__param)(3,Object(oa.pd)())],Wb);Object(D.a)(Wb,"GridHighlightsBehaviorManager",kb.a,[]);var Dc=a(183),Jf=a(1309),Rb=a(295),Gb=a(996),Cc=a(188),
cb=a(22);class pc extends Jf.a{constructor(G,ta,jb){super(G,ta,jb);this.wic=this.PFa=null}get SZ(){return wa.AFrameworkApplication.ra.yL}xGf(G){switch(G){case 1:return Object(cb.a)("ImageUploadNoFileSpecified");case 2:return Object(cb.a)("ImageUploadUnsupportedFileType");default:return""}}H8g(G){return pc.Lra(G,this.q_i())}q_i(){return pc.Q_e}Lra(G,ta){ta=void 0===ta?null:ta;G=this.H8g(G);return 0!==G?(ta&&ta.i2e(),2===G&&(ta=this.xGf(G),this.Ip(0,ta)),!1):!0}finalizeUpload(G,ta){I.ULS.sendTraceTag(36783360,
322,50,"PictureUploader.FinalizeUpload");this.Pae=ta;this.XPk();Rb.a.mark(5576);this.wic=this.SZ.Li("LoadResource","PictureUploadTime")}Ip(G,ta){const jb=new Cc.a;jb.Ph=0;jb.tL(G,Object(cb.a)("ImageUploadFailedTitle"),ta,null)}f2b(){I.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.f2b();this.wic&&(this.wic.stop(),this.wic=null);this.BYh()}XPk(){this.PFa=(new Gb.a).create();this.PFa.message=Object(cb.a)("ImageUploadWait");this.PFa.Ph=5;this.PFa.GC=!1;this.PFa.pQa(null,null,
null)}BYh(){this.PFa&&(this.PFa.close(),this.PFa=null)}static W6i(G,ta){G=ea.a.ys(G);for(let jb=0;jb<ta.length;++jb)if(G.endsWith(ta[jb]))return!0;return!1}static Lra(G,ta){ta=void 0===ta?null:ta;ta||(ta=pc.Q_e);return G?pc.W6i(G,ta)?0:2:1}}pc.Q_e=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(D.a)(pc,"PictureUploader",Jf.a,[]);var Ic=a(107),rd=a(42),Rd=a(653),va=a(427),Bb=a(358),Ac=a(254),Nc=a(240),hd=a(130),qd=a(247),je;(function(G){G[G.unknown=0]="unknown";G[G.bing=1]="bing";G[G.M365=
2]="M365"})(je||(je={}));Object(D.b)("InsertMediaProviders",je);var Ie=a(96),Oe=a(359),Vb=a(1067),fd=a(79);class Qd extends Vb.a{constructor(G,ta){super(G,fd.a.getOrigin(ta))}A4b(G,ta){this.isEnabled()&&this.sX(this.targetOrigin)&&(this.kr(G),this.aq(G,ta))}}Object(D.a)(Qd,"InsertMediaCrossDocumentMessenger",Vb.a,[924,439,4]);var me=a(2);class se{}Object(D.a)(se,"OnlineMediaSearchResult",null,[]);var Ne=a(433),Ue;(function(G){G[G.OK=0]="OK";G[G.cancel=1]="cancel";G[G.error=2]="error";G[G.open=3]=
"open"})(Ue||(Ue={}));Object(D.b)("HubbleAction",Ue);class nf extends Nc.a{constructor(G,ta,jb,sc,Vc,nd){super();this.ZHc=!1;this.f2d=this.cL=this.hLa=null;this.b2f=!1;this.correlationId=null;this.rOj=()=>{this.VIa(this.mgb);this.Gwb(1)};this.B0d=xd=>{xd.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==xd.target.id||xd.shiftKey?"KeepFocusStartDiv"===xd.target.id&&xd.shiftKey&&(xd.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(xd.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};
this.aWj=()=>{this.QIb&&(this.QIb.launchUpsellExperience("stockimages"),I.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.DXj=xd=>{xd&&xd.Values&&(xd=xd.Values,delete xd.m_Origin,delete xd.m_Source,delete xd.m_ReceivedTime,I.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+xd.eventName||!1),Oa.a.sendOtelEvent({otelEvent:xd}))};this.dialogTitle=nd;this.$=G;this.IVf=ta;this.QIb=jb;this.Wia=[];this.nrb=sc;this.Wei=Vc;this.q6e=this.$.ua.InsertOnlinePictureMaxCountOfImagesToInsert;
this.lp=this.Y6h();this.b2f=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8665911_RemoveMediaDetailsInTelemetry")}MPk(G){this.ZHc=!1;this.showDialog(this.dialogTitle,null);this.hLa=document.getElementById(this.ip("InsertMediaFrame"));if(!this.hLa)throw this.VIa(this.mgb),Error.invalidOperation("Couldn't get InsertMediaIframe.");const ta=document.getElementById(this.ip("WACDialogPanel"));ta&&ta.setAttribute(Hc.a.ik,Hc.a.cWa);var jb=document.createElement("div");jb.id="KeepFocusStartDiv";jb.tabIndex=
0;jb.className="keep-focus-start";this.hLa.parentNode.insertBefore(jb,this.hLa.parentNode.firstChild);jb=document.createElement("div");jb.id="KeepFocusDiv";jb.tabIndex=0;jb.className="keep-focus";this.correlationId=Oc.a.create();this.hLa.parentNode.appendChild(jb);$addHandler(this.Nib,"keydown",this.B0d);this.hLa.src=this.IVf;this.hLa.frameBorder="0";jb=document.getElementById(this.ip("WACDialogButtonPanel"));if(!jb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");jb.className="display-none";
jb=document.getElementById(this.ip("WACDialogTitleText"));if(!jb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");jb.className="display-none";2===this.nrb&&(document.getElementById(this.ip("WACDialogTitlePanel")).className="display-none",document.getElementById(this.ip("WACDialogBodyPanel")).className="padding-zero");xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728224_StockImagesDialogHeightFix")&&ta&&(ta.style.overflow="hidden",ta.style.height="auto",jb=document.getElementById(this.ip("WACDialogOuterContainer")))&&
(ta.style.marginTop="",ta.style.top=(jb.parentElement.clientHeight-ta.clientHeight)/2+"px");hd.FocusManager.instance().N0().scope.s1=!0;this.cL=new Qd(this.hLa.contentWindow,this.IVf);this.cL.sX("https://osiziwuspersimmon002.blob.core.windows.net");this.cL.sX("https://osizewuspersimmon001.blob.core.windows.net");this.cL.sX("https://osizpscuspersimmon000.blob.core.windows.net");this.cL.sX("https://cdn.hubblecontent.msit.osi.office.net");this.cL.sX("https://cdn.hubblecontent.osi.office.net");this.cL.A4b(Ja.a.Byh,
sc=>{this.gNj(sc,G.Nja)});this.cL.A4b(Ja.a.insert,()=>{this.wVj(G.Nja)});this.cL.A4b(Ja.a.Lud,this.rOj);this.cL.A4b(Ja.a.fzh,sc=>{this.DXj(sc)});2===this.nrb&&0===this.Wei&&(this.cL.A4b(Ja.a.cwj,this.aWj),this.f2d=this.QIb.v6a("MsoPremiumStockImages",sc=>{I.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");sc.isEnabled?this.cL.sendMessage(Ja.a.sal,{["LicenseTier"]:sc.toString()}):I.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));
this.Gwb(3)}dispose(){this.Wia=null;this.QIb&&this.f2d&&this.QIb.eie("MsoPremiumStockImages",this.f2d);this.cL&&(this.cL.dispose(),this.cL=null);super.dispose()}hide(){super.hide();Ie.a.BYc(this.$)}get qga(){return qd.a.Xuc+"/InsertMediaDialog"}get afa(){return!1}gNj(G,ta){G=G&&G.Values?(G=G.Values)?Object(me.a)(new se,{Action:G.action||"",Caption:G.caption||"",ContentType:G.contentType||"",FileExtension:G.extension||"",PageUrl:G.pageUrl||"",SourceUrl:G.sourceUrl||"",ThumbnailUrl:G.thumbnailUrl||
"",LicenseUrl:G.licenseUrl||"",LicenseDisplayName:G.licenseDisplayName||"",Height:G.height||0,Width:G.width||0}):null:null;G&&(this.Wia.push(G),this.ZHc&&(I.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),ta(this.Wia),this.ZHc=!1,this.VIa(this.mgb)))}wVj(G){this.Wia&&0<this.Wia.length?this.Wia.length<=this.q6e?(G(this.Wia),this.Gwb(0),this.VIa(this.mgb)):(this.tL(),I.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),
this.Wia.length=0,this.Gwb(2)):this.ZHc=!0}Y6h(){const G=document.createElement("div");G.id="InsertMediaDialog";G.className=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";const ta=document.createElement("div");ta.id="InsertMediaPanel";ta.className=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";
const jb=document.createElement("iframe");jb.id="InsertMediaFrame";jb.className="insert-media-frame";G.appendChild(ta);ta.appendChild(jb);return Ne.b(G)}tL(){const G=be.a.nj(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");G.Description=String.format(ka.a.instance.sh(206),this.q6e.toLocaleString());new Oe.a(this.$,G)}SPi(){return 2===this.nrb?"M365":"bing"}Gwb(G){var ta,jb;if(2===this.nrb||1===this.nrb){const Vc=wa.AFrameworkApplication.fa.Ya("InsertMediaDialogAriaTenantNameSpace");if(Vc&&
""!==Vc){var sc=[{name:"DialogMode",string:this.SPi()},{name:"Provider",string:je[this.nrb]},{name:"InsertedFiles",int64:null===(ta=this.Wia)||void 0===ta?void 0:ta.length},{name:"DialogResult",string:Ue[G]},{name:"CorrelationId",string:null===(jb=this.correlationId)||void 0===jb?void 0:jb.toString()}];this.b2f||sc.push({name:"MediaDetails",string:this.Wia?JSON.stringify(this.Wia.map(nd=>nd.SourceUrl)):null});Oa.a.sendTelemetryEvent({name:String.format("{0}.{1}",Vc,"InsertOnlineImages"),dataFields:sc})}}}}
Object(D.a)(nf,"InsertMediaDialog",Nc.a,[]);var tb=a(436),lc=a(310),Tc=a(357);class md extends pc{constructor(G,ta,jb,sc,Vc,nd){super(null,jb,sc);this.B$f=0;this.Nja=xd=>{if(xd){var Hd=Array(xd.length);for(var ke=0;ke<xd.length;ke++){const Eb=xd[ke];Hd[ke]={};Hd[ke].SourceUrl=Eb.SourceUrl;ea.a.zoa(Eb.LicenseUrl)&&ea.a.zoa(Eb.PageUrl)&&(Hd[ke].LicenseUrl=Eb.LicenseUrl,Hd[ke].LicenseDisplayName=Eb.LicenseDisplayName,Hd[ke].PageUrl=Eb.PageUrl);Hd[ke].AltText=-2053056795===this.Nh.command?Eb.Caption:
"";Hd[ke].IsCellPicture=15735758===this.Nh.command||570484235===this.Nh.command}var V=-2009825598===this.Nh.command?"bing":"M365";ke=ha.f(this.$);var Wa=Lb.q(ke.ha.qa.activeCell,this.$);va.a(this.$.userOperationManager,(Eb,Jc,od)=>Bb.w(this.$.pa.ta,Wa,Hd,V,Xc.c(Eb,this.SXj),Xc.b(Jc,this.RXj),od,null),Eb=>new bc.a(595,0,Eb),this.Nh);Xd.HelperMethods.fba?(ke=new Map,ke.set("MediaProvider",V),ke.set("ImagesCount",xd.length.toString()),ke.set("TimeTakenToOpenDialog",this.B$f.toString()),Ic.Health.instance.recordKpiUsage(lc.a.Cej,
Tc.b.SuccessBased,tb.a.L_g,ke)):I.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.f2b()}else I.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};this.SXj=xd=>{if(Ac.a(xd))I.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${be.a.Yh(xd.Errors)}`);else{I.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");
const Hd=this.Nh.command;15735758!==Hd&&570484235!==Hd&&(xd.Result?Sa.a(this.$).yPa(1,xd.Result):I.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};this.RXj=()=>{I.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=G;this.Nh=ta;this.uT=nd;this.g7e=rd.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let G=
null;G=this.$.Eh.Li("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Nh.command){case -2009825598:case 15735758:this.UOk();break;case -2053056795:case 570484235:this.g7e.execute(ta=>{ta.isFeatureEnabled("MsoPremiumStockImages",!1).catch(jb=>I.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${jb}`)).then(jb=>{this.VOk(jb);return null})})}G.stop();this.B$f=G.zi}UOk(){let G=this.$.ua.BingPictureEndpoint;
const ta=Rd.a.UU(wa.AFrameworkApplication.lcid),jb=Oc.a.create();G?(G=0<G.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(G,1,1):String.format(G,1,wa.AFrameworkApplication.lcid,ta?ta.name:"en-us",wa.AFrameworkApplication.buildVersion,jb.toString(),1,this.$.ua.DocumentHostInfo.LoggableUserId),this.$sc(G,1,-1,ka.a.instance.ia(1764))):(I.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.uT.setException(Error.create("Failed to access the Bing service endpoint")))}VOk(G){var ta=
this.$.ua.M365PictureEndpoint,jb=Oc.a.create();if(ta){var sc=this.$.ua.DocumentHostInfo.UserId;sc=sc?ea.a.qE(sc).toString():"0";var Vc=this.g7e.instance.isFreemiumUpsellEnabled();G=G?1:Vc?0:-1;jb=jb.toString();Vc=Rd.a.UU(wa.AFrameworkApplication.lcid).name;ta=String.format(ta,wa.AFrameworkApplication.lcid,Vc,wa.AFrameworkApplication.buildVersion,jb,1,sc,G,1);this.$sc(ta,2,G,ka.a.instance.ia(1763))}else I.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),
this.uT.setException(Error.create("Failed to access the M365 service endpoint"))}$sc(G,ta,jb,sc){try{(new nf(this.$,G,rd.a.instance.Ho("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),ta,jb,sc)).MPk(this),this.uT.setResult(!0)}catch(Vc){I.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${Vc}] [MediaProvider : ${ta}] [DialogLicenseTier : ${jb}]`),this.uT.setException(Vc)}}}Object(D.a)(md,"OnlinePictureUploaderWrapper",pc,[4]);let sd=
class{constructor(G,ta){this.$=G;this.uploaderCreator=ta}executeCommand(G,ta,jb){G=ta.command;switch(G){case 1403967063:case -2060689045:if(jb&&"dataUrl"in jb)return ta=new Dc.a,this.uploaderCreator&&this.uploaderCreator.Qbj(this.$,ia.TaskManager.instance,wa.AFrameworkApplication.fa,jb,jb.dataUrl,ta),ta.task;this.uploaderCreator&&this.uploaderCreator.bdj(this.$,ta,ia.TaskManager.instance,wa.AFrameworkApplication.fa,jb);return nb.Task.Ua(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return G=
new Dc.a,new md(this.$,ta,ia.TaskManager.instance,wa.AFrameworkApplication.fa,jb,G),G.task;default:return Ka.a(G)}}Gi(G,ta){let jb=this.$.isEditMode;if(jb)switch(ta.command){case 1403967063:jb=!0;break;case -2053056795:jb=!0;break;case -2009825598:jb=!0;break;case -2060689045:case 15735758:case 570484235:jb=zb.a.KWb()&&1===G;break;default:jb=!1}return jb}dj(){return!1}Ri(){return!1}};sd=Object(U.__decorate)([Object(za.d)(oa.zd),Object(U.__param)(0,Object(oa.Nb)()),Object(U.__param)(1,Object(oa.Lg)())],
sd);Object(D.a)(sd,"PictureCommandHandler",null,[34]);var Zd=a(73);class Ae{}Ae.jgi="DisplayNotInvoked";Ae.ECd="Displayed";Ae.M9j="PrerequisitesNotReady";Object(D.a)(Ae,"PasteIndicationDisplayStatus",null,[]);var Ee=a(58),Ze=a(54),Te=a(32),We=a(311),qf=a(922),bf;let af=bf=class{constructor(G){this.$Mb="";this.iG=this.pC=null;this.ttb=new Map;this.wea=null;this.CSc=!1;this.eSf=(ta,jb)=>{this.hide(void 0===ta?null:ta,void 0===jb?null:jb)};this.$=G;this.da=ha.f(G);this.da.ha.Zw(this.eSf)}XCd(){this.CSc||
(I.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.da.$.P5(G=>{G.taa(0).then(()=>{this.CSc=!0})}))}lxk(G){this.XCd();this.$Mb=G;this.ZLg(G)}MLg(G){const ta=G.commandParameters.id;I.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${ta}, cancelCtx is null = ${!this.pC}, PrerequisitesDownloaded = ${this.CSc}`);this.XCd();this.$Mb=ta;const jb=!this.Neg();if(!this.pC||jb)this.cdf(),this.pC=Ee.a.instance.create(()=>
{this.igi(G)},void 0===G.timeoutToShowSpinnerInMs||null===G.timeoutToShowSpinnerInMs?100:G.timeoutToShowSpinnerInMs,Ze.a.p5j);this.wea=G.commandParameters.originalDestinations;this.ZLg(ta)}igi(G){this.CSc?(this.display(G.commandParameters.originalDestinations),G.pasteIndicationDisplayStatus=Ae.ECd):(I.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),G.pasteIndicationDisplayStatus=Ae.M9j)}ZLg(G){this.ttb.set(G,Te.a.ih.$j);
Ee.a.instance.create(()=>{this.ugi(G)},this.$.ua.PasteToastNotificationDelayTime,Ze.a.q5j)}ugi(G){this.ttb.has(G)&&(this.iG?this.iG.displayTimeoutSeconds+=this.$.ua.PasteToastNotificationDefaultDisplayDuration:(G=ka.a.instance.ia(2341),this.iG=Aa.a.eB.VK.PX(G,!1),this.iG.image=5,this.iG.Z0=qf.a.Jgk,this.iG.displayTimeoutSeconds=this.$.ua.PasteToastNotificationDefaultDisplayDuration,Aa.a.eB.VK.EF(this.iG)))}Uga(G,ta,jb){G&&this.iG&&(G=jb?`"${ta}" ${ka.a.instance.ia(2433)}`:ka.a.instance.ia(2342),this.iG.N3c(G),
this.iG.image=5,this.iG.Z0=jb?qf.a.D_k:qf.a.cff);setTimeout(()=>{this.hlk()},3E3)}hlk(){this.iG&&(Aa.a.eB.VK.removeEntry(this.iG),this.iG=null)}display(G){I.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.da.Gh.fQ(ze.a.P9a(Zd.d(this.da.$.ma),G),bf.GRc,!0);this.da.Gh.Nw(bf.GRc)}Mmb(G,ta,jb,sc){ta=void 0===ta?!0:ta;jb=void 0===jb?null:jb;sc=void 0===sc?!1:sc;I.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${G}, currentPasteCommandId = ${this.$Mb}`);
G&&Ua.a.equals(G,this.$Mb,!1)&&this.hide();if(G&&this.ttb.has(G)){const Vc=We.a(Te.a.ih.$j,this.ttb.get(G));6E4<Vc&&I.ULS.sendTraceTag(508839751,0,50,`PasteIndicationManager.hideForPasteId: large paste. CommandId (${G}), scheduleDisplayToHideDurationInMs (${Vc}))`);this.ttb.delete(G);null!=this.iG&&0===this.ttb.size&&this.Uga(ta,jb,sc)}}hide(G){this.wea&&(void 0===G?0:G)&&this.Neg()&&I.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");
this.$Mb="";this.cdf();this.wea=null;0!==this.da.Gh.dKd([30]).length&&(this.da.Gh.Mq(bf.GRc),this.da.Gh.tt(null,bf.GRc))}Neg(){return Lb.X(this.da.ha.qa.selectedRanges,this.wea)}cdf(){this.pC&&(ra.a.dh(this.pC),this.pC=null)}dispose(){this.hide();this.iG&&this.Uga(!1);this.da.ha.vx(this.eSf)}};af.GRc=[30];af=bf=Object(U.__decorate)([Object(za.d)(oa.Be),Object(U.__param)(0,Object(oa.Nb)())],af);Object(D.a)(af,"PasteIndicationManager",null,[863,4]);var Nf=a(159);Object(za.b)(oa.Ce,{Fk:"singleton"})(G=>
Lo(function*(){const ta=yield za.a.resolve(oa.Nb,G),jb=jc.a.instance,sc=Nf.a.instance.BU();return new uf(ta,jb,sc)}));class uf extends pb.a{constructor(G,ta,jb){super();this.statusBarManager=null;this.Tpf=()=>{this.ovc()};this.Afi=()=>{this.ovc()};this.Spf=sc=>{10===sc&&this.ovc()};this.onKeyDown=sc=>13===sc.La.keyCode?(sc=new Ib.a(237279923,1,2,6,null),this.$.Ma.qh(sc,{[Y.a.skipClipboardAccess]:!0,[Y.a.nuf]:!0}),!0):!1;this.$=G;this.PD=ta;this.du=jb;this.zEd=!1;this.$.la.fi(29,sc=>{this.statusBarManager=
sc;sc.hO(this)})}dispose(){this.to();this.du=this.PD=this.$=null;this.statusBarManager&&(this.statusBarManager.tN(this),this.statusBarManager=null)}rr(){return!0}Ay(G,ta){if("QueryPasteShortcutEnabledLabel"!==G&&!uf.zVk.includes(G))return!1;const jb=this.wP();"QueryPasteShortcutEnabledLabel"===G?(ta.Visible=jb,I.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${jb} for commandId ${G}`)):(ta.Visible=!jb,I.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!jb} for commandId ${G}`));
return!0}Rki(){this.Hp();this.raiseEvent("pasteShortcutStatusChanged")}ovc(){this.to();this.raiseEvent("pasteShortcutStatusChanged")}wP(){return this.zEd}oy(G){this.addHandler("pasteShortcutStatusChanged",G)}cy(G){this.removeHandler("pasteShortcutStatusChanged",G)}Hp(){if(!this.wP()){this.zEd=!0;ha.f(this.$).Bp.Iv(this.Tpf);this.du.Ba("blur",this.Afi);const G=oa.Qb.Aa()?za.a.nh(oa.Qb):this.$.la.kh(65);G&&G.pfa&&G.pfa.registerForCommentEvents(this.Spf);this.PD.YD(gb.a.Ui,this.$.pK,this.onKeyDown,!0)}}to(){if(this.wP()){this.zEd=
!1;ha.f(this.$).Bp.Cv(this.Tpf);this.du.detach("blur");const G=oa.Qb.Aa()?za.a.nh(oa.Qb):this.$.la.kh(65);G&&G.pfa&&G.pfa.unregisterForCommentEvents(this.Spf);this.PD.hE(gb.a.Ui,this.$.pK,this.onKeyDown,!0)}}}uf.zVk=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(D.a)(uf,"PasteShortcutManager",pb.a,[866,155,156,4]);const pf=G=>{switch(G){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;
case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var ff=a(217),Qa=a(128);class Ob{static get Ndk(){return Ob.KVe||(Ob.KVe=RegExp("([A-Z]+)",
"g"))}static get Mdk(){return Ob.JVe||(Ob.JVe=RegExp("([A-Z])","g"))}static get rWh(){return Ob.EIe||(Ob.EIe=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static YNd(G){return Ob.GKf(G.toString())}static GKf(G){return Ob.rWh.test(G)?G.replace(Ob.Ndk,"$1 ").replace(Ob.Mdk,' "$1"').trim():G}static Zpk(G){const ta=G.lastIndexOf("!");return G.substring(0,-1<ta?ta+1:0)+Ob.GKf(G.substring(-1<ta?ta+1:0,G.length))}}Ob.KVe=null;
Ob.JVe=null;Ob.EIe=null;Object(D.a)(Ob,"RangeAriaExtensions",null,[]);class Pc{constructor(){this.activeItemName=null;this.D2f=!1;this.tableName=null;this.phb=0;this.g1c=!1}}Object(D.a)(Pc,"SelectionReadoutState",null,[]);var Cd=a(197),Ud=a(953),Wd;let le=Wd=class{constructor(G,ta,jb,sc,Vc){this.aHa=this.gridReadoutNotifier=null;this.bMg=!1;this.cqa=()=>{xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?I.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
ha.f(this.$).isEditing&&!ha.f(this.$).inRangePicker||this.Boc.MA()};this.bNj=()=>{if(!ha.f(this.$).ha.$e.mYd){var nd,xd=(()=>{let Hd=this.ODi();({activeCell:nd}=Hd);return Hd})().returnValue;this.readText(xd,nd)}};this.JS=()=>{const nd=this.activeCell;this.readText("Editing",nd);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||nd&&nd.QDc&&!ha.f(this.$).IQf||this.Boc.cancel()};this.Jj=()=>{xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&
!this.$?I.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):this.cqa()};this.$=ta;this.ariaLiveNotifier=G;this.K9b=sc;this.Qj=jb;this.sN=new Pc;this.nob=Ca.nob();this.bMg=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8582263_ScreenReaderShapeInfoReadoutEnabled");this.nob&&(this.gridReadoutNotifier=Vc,I.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7945213_removeActiveCellDelayForBraille")?
Wd.qnd=0:Wd.qnd=700);this.Boc=Ee.a.instance.create(this.bNj,Wd.qnd,Ze.a.qzk,!1);this.Hp()}get activeCell(){return ha.f(this.$).zh(null)}dispose(){this.$&&this.to();ra.a.dh(this.Boc);this.K9b=this.$=this.Boc=null}xKd(G,ta,jb){jb=void 0===jb?!0:jb;if(null!==this.$.vh.Hn&&"FindAndReplaceDialog"===this.$.vh.Hn.Di||!G)return"";var sc=this.$.la;const Vc=new Sys.StringBuilder;this.lIh(Vc,G,ta);if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var nd=this.Qj.oxa(G.range);(null===
nd||void 0===nd?0:nd.Use)&&this.x7e(Vc,nd);nd=this.Qj.Ey(G.range);(null===nd||void 0===nd?0:nd.Oxa)&&this.x7e(Vc,nd)}nd=G.X5?this.RHf(G):G.text;ca(Vc,nd);nd=this.$.activeItemName;this.sN.activeItemName!==nd&&(ca(Vc,nd),this.sN.activeItemName=nd);nd=1===ta.length?Lb.R(ta).isSingle?"":ka.a.instance.ia(853):String.format(ka.a.instance.sh(31),ta.length);ca(Vc,nd);for(var xd of ta)nd=this.nob?xd.toString():Ob.YNd(xd),ca(Vc,nd),1===ta.length&&Wd.Osj(xd)&&(nd=ha.f(this.$).za.Rx(xd.bottomRight),void 0!==
nd&&null!==nd&&nd.text&&(nd=nd.X5?this.QHf(nd,nd.text):nd.text,ca(Vc,nd)));xd=G.cell;xd=this.nSi(xd.ivk,xd.vZh);ca(Vc,xd);this.VHh(Vc,G);jb&&(G.Sob?ca(Vc,ka.a.instance.ia(841)):G.o2a&&ca(Vc,ka.a.instance.ia(842)));if(G.hasAutoFilter||G.Ina)this.mIh(Vc,G.hasAutoFilter?G.cell.autoFilterType:G.cell.r6j),jb&&ca(Vc,ka.a.instance.ia(844));ff.d(this.$,G.range)&&ca(Vc,ka.a.instance.ia(848));this.THh(Vc,G);jb=(jb=za.a.nh(oa.tb))?jb.QEi():"";ca(Vc,jb);G.HC&&(jb=ha.f(this.$).za.Rx(G.range),jb=!!jb&&jb.hasIgnorableError,
Wd.rKk(G)?Wd.UHh(Vc,G):xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&jb?ca(Vc,ka.a.instance.ia(846)):ca(Vc,ka.a.instance.ia(845)));G.XR&&(ca(Vc,ka.a.instance.ia(847)),G.vTb&&ca(Vc,String.format(ka.a.instance.sh(16),G.nbi)),ca(Vc,G.iconName));G.hasRichValueIcon&&(xd=za.a.nh(oa.hb),jb="",xd&&G.cell.ILc&&(xd=xd.f5(G.cell.ILc))&&xd.DomainId.Id!==Wd.Tel&&(jb=xd.Name),G.cell.Xgj?(ca(Vc,String.format(ka.a.instance.sh(187),jb)),ca(Vc,ka.a.instance.ia(1812))):(ca(Vc,String.format(ka.a.instance.sh(185),
jb)),ca(Vc,ka.a.instance.ia(1811))));this.n6i(G)&&ca(Vc,Wd.JMi(G));(sc=sc.kh(231))&&ca(Vc,sc.gIf(ta,!0));1===ta.length&&ta[0].isSingle&&Wd.qKk(G,ta[0])&&(ta=za.a.nh(oa.hb))&&ca(Vc,ta.fFi());G.cac&&G.dac&&ca(Vc,G.dac);(ta=G.cell.qvd)&&ca(Vc,ta);this.SHh(Vc,G);G.l2a&&G.U2b&&(G=G.Ece)&&(ca(Vc,ka.a.instance.ia(1985)),ca(Vc,G));return Vc.toString()}Rbf(G){this.aHa=this.sN;this.sN=Object(me.a)(new Pc,{activeItemName:this.aHa.activeItemName,g1c:G?this.aHa.g1c:!1,tableName:G?this.aHa.tableName:"",phb:G?this.aHa.phb:
-1})}RIg(){this.aHa&&(this.sN=this.aHa,this.aHa=null)}nSi(G,ta){return 2===G||2===ta?ka.a.instance.ia(875):1===G||1===ta?ka.a.instance.ia(876):""}RHf(G){return this.QHf(G.cell,G.text)}lIh(G,ta,jb){if(jb&&1===jb.length&&jb[0].isSingle){jb="";var sc=this.Qj.oxa(ta.range);if(sc){jb=sc.pivotTableName;this.erd(G,jb);var Vc=sc.bHc?ka.a.instance.ia(835):"";xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Vc+=(sc.altText?sc.altText+" . ":"")+(sc.altTextSummary?
sc.altTextSummary:""));this.z7e(G,!0,jb,Vc);ca(G,this.Qj.yqj(sc,ta.range)?ka.a.instance.ia(838):"");ca(G,this.Qj.zij(sc,ta.range)?ka.a.instance.ia(837):"")}else if(sc=this.Qj.Ey(ta.range)){jb=(Vc=ha.f(this.$).oh.Kl(ta.range))?Vc.name:"";this.erd(G,jb);let nd="";Vc&&(nd=(Vc.y9a?Vc.y9a+" . ":"")+(Vc.z9a?Vc.z9a:""));this.z7e(G,!1,jb,nd);ca(G,this.Qj.k_f(sc,ta.range)?ka.a.instance.ia(837):"")}else this.erd(G,jb),this.sN.tableName="",this.sN.phb=-1}}erd(G,ta){ta!==this.sN.tableName&&this.sN.tableName&&
(G.append(ka.a.instance.ia(this.sN.g1c?834:833)),ca(G," "+this.sN.tableName))}z7e(G,ta,jb,sc){jb!==this.sN.tableName&&(G.append(ka.a.instance.ia(ta?832:831)),ca(G," "+jb),ca(G,sc),this.sN.tableName=jb,this.sN.g1c=ta,this.sN.phb=-1)}x7e(G,ta){const jb=ha.f(this.$).ha.qa.activeCell;if(jb.top!==ta.top&&jb.left!==this.sN.phb){G.append(ka.a.instance.ia(837));ta=new yb.Range(ta.top,jb.left,ta.top,jb.left,!0,!0);ca(G,Ob.YNd(ta));if(ta=ha.f(this.$).zh(ta))ta=ta.X5?this.RHf(ta):ta.text,ca(G,ta);this.sN.phb=
jb.left}}QHf(G,ta){const jb=G.OD;return G.Kxa?String.format(ka.a.instance.sh(14),ta,jb):String.format(ka.a.instance.sh(13),ta,Ob.Zpk(jb))}Hp(){I.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var G=ha.f(this.$);I.ULS.shipAssertTag(537153929,0,!!G,"Can't register to grid's events");G&&(G.Fh.Iv(this.JS),G.za.ny(this.cqa),G.lO(this.cqa),G=G.ha,I.ULS.shipAssertTag(537153928,0,!!G,"Can't register to selectionManager's events"),G&&(G.Zw(this.Jj),G.add_activeCellChanged(this.cqa),
G.$e.nO(this.cqa)))}}to(){if(this.$){var G=ha.f(this.$);G&&(G.Fh.Cv(this.JS),G.za.ux(this.cqa),G.$P(this.cqa),G=G.ha)&&(G.vx(this.cqa),G.remove_activeCellChanged(this.cqa),G.$e.VV(this.cqa))}}readText(G,ta){this.nob&&this.gridReadoutNotifier&&(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.gridReadoutNotifier.isActive)?this.gridReadoutNotifier.readText(G):(this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(G),ta&&this.ariaLiveNotifier.I6k(ta))}ODi(){let G;
G=null;var ta=ha.f(this.$).ha;if(1!==ta.Ck&&!ta.$e.Lh)return I.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ta.Ck} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:G};switch(ta.Ck){case 2:return{returnValue:this.cHi(ta),activeCell:G};case 64:var jb=ta.$e.Lh.floatingObject;let sc="";if(ta=ta.$e.Lh.YB||ta.$e.Lh.Vj)sc=(ta=ta.firstChild)?ja.DOMElementExtensions.getTextContent(ta):"";return this.bMg?{returnValue:this.AWi(jb),activeCell:G}:
{returnValue:String.format(ka.a.instance.sh(53),Wd.Czc(jb.altText,jb.altTextDescription,jb.name),sc,jb.altTextDescription),activeCell:G};case 4:return{returnValue:Wd.aHh(ta.$e.Lh.floatingObject),activeCell:G};case 512:return{returnValue:Qa.a.nGf(ta.$e.Lh.floatingObject.sDd),activeCell:G};case 8:return jb=ta.$e.Lh.floatingObject,{returnValue:String.format(ka.a.instance.sh(51),jb?jb.name:""),activeCell:G};case 1:return G=this.activeCell,jb=ta.qa.selectedRanges,ha.f(this.$).inRangePicker?this.lUi(ta,
G):{returnValue:this.xKd(G,jb),activeCell:G}}return{returnValue:"",activeCell:G}}lUi(G,ta){G=G.rangePicker.pZ.map(sc=>sc.range);const jb=ha.f(this.$).zh(G[0]);return{returnValue:this.xKd(jb,G),activeCell:ta}}cHi(G){const ta=new Sys.StringBuilder;ta.append(Wd.CVh(G));const jb=this.$.la.kh(231);jb&&ca(ta,jb.gIf(G.$e.Lh.floatingObject,!1));return ta.toString()}AWi(G){var ta,jb,sc,Vc,nd,xd=null;isNullOrUndefined(null===(ta=G.Ch)||void 0===ta?void 0:ta.ShapeFillColor)||(-1===G.Ch.ShapeFillColor?xd=G.Ch.HasEffects?
"gradient":null:(xd=(null===(jb=G.Ch)||void 0===jb?0:jb.IsShapeConnector)?Cd.a.I2(G.Ch.ShapeOutlineColor):Cd.a.I2(G.Ch.ShapeFillColor),xd=Cd.a.Ou(xd.toUpperCase()),xd=Ud.a.hKa(xd)));jb=!ea.a.hXa(xd);return(ta=!ea.a.hXa(null===(sc=G.Ch)||void 0===sc?void 0:sc.ShapeText))&&jb?String.format(ka.a.instance.sh(235),G.altText,G.altTextDescription,G.name,xd,null===(Vc=G.Ch)||void 0===Vc?void 0:Vc.ShapeText):!jb&&ta?String.format(ka.a.instance.sh(236),G.altText,G.altTextDescription,G.name,null===(nd=G.Ch)||
void 0===nd?void 0:nd.ShapeText):!ta&&jb?String.format(ka.a.instance.sh(237),G.altText,G.altTextDescription,G.name,xd):String.format(ka.a.instance.sh(234),G.altText,G.altTextDescription,G.name)}n6i(G){G=G.FXf();let ta=!1;this.sN.D2f!==G&&(this.sN.D2f=G,ta=!0);return ta}VHh(G,ta){if(ta.Gmb)if(ta=this.K9b.mXi(ta)){var jb=ka.a.instance,sc=jb.ia;a:switch(ta.type){case 0:var Vc=828;break a;case 1:Vc=829;break a;default:Vc=830}jb=sc.call(jb,Vc);ca(G,String.format(ka.a.instance.sh(25),jb));ta=String.format(ka.a.instance.sh(24),
Ob.YNd(ta.MTk));ca(G,ta)}else I.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),ca(G,String.format(ka.a.instance.sh(25),""))}mIh(G,ta){switch(ta){case 1:case 11:ca(G,ka.a.instance.ia(849));break;case 6:ca(G,ka.a.instance.ia(849));ca(G,ka.a.instance.ia(851));break;case 7:ca(G,ka.a.instance.ia(849));ca(G,ka.a.instance.ia(852));break;case 2:ca(G,ka.a.instance.ia(850));ca(G,ka.a.instance.ia(851));break;case 3:ca(G,ka.a.instance.ia(850));ca(G,ka.a.instance.ia(852));
break;default:ca(G,ka.a.instance.ia(850))}}THh(G,ta){var jb;const sc=oa.Qb.Aa()?za.a.nh(oa.Qb):this.$.la.kh(65);ta=sc?sc.RJa(ta.range):null;let Vc="";const nd=Object(oe.a)(452,ta);if(ta)Vc=!ta.Aob&&nd&&nd.lsj?String.format(ka.a.instance.sh(29),nd.lYk):String.format(ka.a.instance.sh(23),ta.author);else if(null===(jb=null===sc||void 0===sc?void 0:sc.Zt)||void 0===jb?0:jb.EK)Vc=String.format(ka.a.instance.sh(28),sc.Zt.DV.author);ca(G,Vc)}SHh(G,ta){const jb=oa.J.Aa()?za.a.nh(oa.J):this.$.la.kh(286);jb&&
(ta=jb.SEi(Zd.d(this.$.ma),ta.range))&&0<ta.length&&(ta=String.format(ka.a.instance.sh(1===ta.length?220:221),ta[0]),ca(G,ta))}static aHh(G){return String.format(ka.a.instance.sh(52),Wd.Czc(G.altText,G.altTextDescription,G.name),G.altTextDescription)}static JMi(G){return ka.a.instance.ia(G.FXf()?839:840)}static Czc(G,ta,jb){return G||ta?G:jb}static CVh(G){var ta=G.$e.Lh;G=ta.floatingObject;const jb=G.Ti,sc=jb.ChartTitle,Vc=G.altText,nd=G.altTextDescription,xd=!!(jb.Attributes&4);return(ta=ta.getSelectionDescription())?
ta:jb.DataRangeForDisplay?String.format(ka.a.instance.sh(xd?49:47),Wd.Czc(Vc,nd,G.name),nd,sc,ka.a.instance.ia(pf(jb.ChartCategory)),jb.DataRangeForDisplay):String.format(ka.a.instance.sh(xd?50:48),Wd.Czc(Vc,nd,G.name),nd,sc,ka.a.instance.ia(pf(jb.ChartCategory)))}static rKk(G){return xa.EwaSettings.Ra(101)&&(G.cWb||G.YGc)}static UHh(G,ta){ta.e9a?ta.cWb?ca(G,String.format(ka.a.instance.sh(26),ta.e9a.topLeft.toString())):ta.YGc&&(ta=ta.e9a.jF(),ca(G,String.format(ka.a.instance.sh(27),(ta.LastColumn-
ta.FirstColumn+1).toString(),(ta.LastRow-ta.FirstRow+1).toString()))):I.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static qKk(G,ta){return G.HC||!xa.EwaSettings.Ra(131)?!1:(G=za.a.nh(oa.hb))?G.wGc(ta):!1}static Osj(G){return G.top===G.bottom&&G.left+1===G.right||G.top+1===G.bottom&&G.left===G.right}};le.Oml="#";le.Tel=268435712;le.qnd=500;le=Wd=Object(U.__decorate)([Object(za.d)(oa.Cf),
Object(U.__param)(0,Object(oa.l)()),Object(U.__param)(1,Object(oa.Nb)()),Object(U.__param)(2,Object(oa.vg)()),Object(U.__param)(3,Object(oa.pg)()),Object(U.__param)(4,Object(oa.uc)())],le);Object(D.a)(le,"SelectionReadoutHandler",null,[862,4]);var Fa=a(8),mb=a(127),e=a(37);let Ra=class extends mb.a{constructor(G,ta){G=void 0===G?Fa.a.Lwb:G;ta=void 0===ta?Fa.a.WG:ta;super(G,ta)}execute(G){const ta=Object(oe.a)(13,G.Nk);I.ULS.shipAssertTag(537153921,0,be.a.aJb(G.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");
ta.WP(!0,!0);G.activityState[e.a.Jlc]=ta.ea.sessionId;G.activityState[e.a.qHb]=!0;G.activityState[e.a.Plc]=!0;I.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}};Ra=Object(U.__decorate)([Object(za.d)(oa.Gf)],Ra);Object(D.a)(Ra,"SessionReloadActivity",mb.a,[]);var O=a(61),qa=a(312),ob=a(41),R=a(45),Za=a(279),Cb=a(112);const rc=(G,ta)=>new ma(G,ta,Fa.a.WG,Fa.a.Tp,Fa.a.czb);Object(za.b)(oa.Hf,{Fk:"singleton"})(()=>rc(Fa.a.Kqa,Fa.a.Sfb));
Object(za.b)(oa.If,{Fk:"singleton"})(()=>rc(Fa.a.s7b,Fa.a.WNa));Object(za.b)(oa.Jf,{Fk:"singleton"})(()=>rc(Fa.a.t7b,Fa.a.aRc));Object(za.b)(oa.Kf,{Fk:"singleton"})(()=>rc(Fa.a.NPa,Fa.a.EW));class ma extends mb.a{constructor(G,ta,jb,sc,Vc){super(G,ta);ma.F4d=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];ma.E4d=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];ma.$ag=[-1468309555,611268539,-1750576502,61029505,-658377927];ma.Zag=[-1468309555,
-315732528,1112506702,-238814601,-1750576502,61029505,-658377927,-1337545025];this.x_c=jb;this.VRk=sc;this.R0k=Vc}execute(G){var ta=Object(oe.a)(13,G.Nk);G.activityState[e.a.eGa]=!0;var jb=ma.bXi(G);if(ma.GKk(G,jb))return ma.DEj(G),jb=50,0<G.errors.length&&(jb=15),I.ULS.sendTraceTag(537153891,0,jb,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${be.a.Yh(G.errors)}`),G.activityState[e.a.eGa]=!1,this.so(Fa.a.idle),3;switch(jb){case 1:case 3:this.eej(G,jb);
break;case 2:this.dej(G);break;case 0:G.activityState[e.a.seb]=null}I.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${jb}. activityName:${this.activityName}. NextActivityName:${this.Oba}. TimeFromLastStatefulResponse:${ta.ea.K8}.`);var sc=ob.a.Wm(G.activityState,Cb.a.jzb);I.ULS.shipAssertTag(40502925,0,!sc||sc&&(1===jb||3===jb),`triggerSilentReloadAfterTokenRefresh: ${sc}, silentReloadType: ${jb}`);ta=ta.Ws.reloadCount;return 0!==jb&&0<ta?(sc=qa.a.Zlb(ta,200),
I.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${jb}] retryNum [${ta}] delayInMs [${sc}] activityName [${this.activityName}]`),Ee.a.instance.create(()=>{ma.vU(G)},sc,Ze.a.BBk),1):3}eej(G,ta){I.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const jb=Object(oe.a)(13,G.Nk);G.activityState[e.a.qHb]=!0;jb.hGc||R.a.instance.Pm("ReopenOnLoad");ma.isEditMode(G)&&xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient")&&
ma.u1a(G)||!be.a.aJb(G.errors)||(I.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),G.activityState[e.a.Jlc]=jb.ea.sessionId,G.activityState[e.a.Plc]=!0);G.$4d();3===ta?(jb.ea.dm()||jb.ea.wLj(),jb.WP(!0,!0),this.so(this.R0k),G.activityState[e.a.A1e]=jb.workbookContext.CalcMode):(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===ta&&jb.WP(!0,!0),G.activityState[e.a.Tnd]=
!1,this.so(this.x_c))}dej(G){I.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");G.activityState[e.a.seb]=null;G.$4d();this.so(this.VRk);G=Object(oe.a)(13,G.Nk);G.hGc||(R.a.instance.Pm("RefreshOnLoad"),G.D5b())}static vU(G){G.vU()}static bXi(G){const ta=Object(oe.a)(13,G.Nk),jb=ta.ea,sc=ma.isEditMode(G),Vc=ma.u1a(G);var nd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient"),xd=be.a.ko(G.errors,sc||nd&&
Vc?ma.E4d:ma.F4d);nd=be.a.ko(G.errors,sc||nd&&Vc?ma.Zag:ma.$ag);const Hd=ta.f1,ke=ta.Ws.reloadCount,V=ta.ua.MaxConsecutiveSilentReloadAllowed,Wa=ta.Ws.gRf(),Eb=be.a.Yh(G.errors),Jc=be.a.Yh(G.wOa),od=0<be.a.ZX(Ye=>!Ye.triggerSilentReopenOnly,G.errors).length;let Pd=xd;const ge=ob.a.Wm(G.activityState,Cb.a.jzb);ge&&(Pd=!0);const Be={name:"SessionReloadSilentActivity.GetSilentReloadType"};Be.editMode=sc;Be.isSilentReopenError=xd;Be.isSilentRefreshError=nd;Be.reloadSequenceCount=ta.Ws.G6a;Be.reloadCount=
ke;Be.maxReloads=V;Be.stopSilentReloads=Wa;Be.errorNames=Eb;Be.processedErrorNames=Jc;Be.isClientDirty=Hd;Be.errorsForSilentReopenOnly=od;Be.triggerSilentReloadAfterTokenRefresh=ge;Be.IsReopenDisabled=ta.s2a;Be.isCollabViewMode=Vc;xd=O.a.Ci(Be);I.ULS.sendTraceTag(21837004,0,50,xd);if(!Wa){if(Pd&&(sc||xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8671789_FixSilentRefreshInCollabView")&&Vc?ma.vKk(G):ma.yKk(G)))return Za.a.FSg(G,ta)?3:ta.s2a?2:1;if(nd&&(sc||xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8671789_FixSilentRefreshInCollabView")&&
Vc||!jb.Nub))return 2}return 0}static GKk(G,ta){for(const jb of G.errors)if(-1337545025===jb.MessageId||-238814601===jb.MessageId)return!1;return be.a.ZX(jb=>!jb.triggerSilentReopenOnly,G.errors).length?3!==ta:!1}static DEj(G){const ta=be.a.ZX(jb=>!jb.triggerSilentReopenOnly,G.errors);for(const jb of ta)G.ipa(jb)}static isEditMode(G){const ta=Object(oe.a)(13,G.Nk);return ta.ea.ki?ta.ix&&!!(ta.Ij&64):ob.a.Wm(G.activityState,e.a.aA)}static u1a(G){const ta=Object(oe.a)(13,G.Nk);I.ULS.sendTraceTag(507618584,
0,50,`SessionReloadSilentActivity.isEditMode: isEditMode [${ta.isEditMode}] Edit Mode capabilities [${ta.Ij&64}]`);return ta.ea.ki?ta.ea.u1a:ob.a.Wm(G.activityState,e.a.Pnd)}static yKk(G){const ta=Object(oe.a)(13,G.Nk);if(be.a.fga(G.errors,ma.F4d).some(jb=>jb.ForceVersionUpgrade))return!1;G=be.a.aJb(G.errors);return!ta.ea.Nub||G?!0:!1}static vKk(G){return!be.a.fga(G.errors,ma.E4d).some(ta=>ta.ForceVersionUpgrade)}}ma.F4d=null;ma.E4d=null;ma.$ag=null;ma.Zag=null;Object(D.a)(ma,"SessionReloadSilentActivity",
mb.a,[]);var qb=a(555);let Xb=class extends qb.a{constructor(G){super(Object(ha.f)(G))}mXi(G){for(const ta of this.rangeList)if(G.range.contains(ta))return ta;return null}Pfe(G){return G.GridBlockModel&&(G=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(G.GridBlockModel))?G.getSparklineRanges():null}};Xb=Object(U.__decorate)([Object(za.d)(oa.pg),Object(U.__param)(0,Object(oa.Nb)())],Xb);Object(D.a)(Xb,"SparklineManager",qb.a,[865]);var qc=a(610),Uc=a(192),ld=a(190);class yd extends bd.a{constructor(G,
ta,jb,sc,Vc){super(G);this.q_g=[6];this.l_g=[26];this.rz=null;this.VWb=this.YJc=!1;this.zB=this.Hna=null;this.onPointerDown=nd=>{if(1!==this.$.Ma.LR())return!0;nd=this.zoomManager.il(nd);if(this.PK)return!0;var xd=Fe.a(this.$).nXd||Fe.a(this.$).wv();if(this.DZd||xd)return this.Gvb(),!0;this.zB=this.Fv;this.die();this.bSd();xd=2===nd.Dh&&nd.Iw===Sys.UI.MouseButton.leftButton;const Hd=3===nd.Dh;if(xd||Hd)nd=this.ha.Yy(nd.clientPoint,nd.li,5,void 0,void 0,!0),nd||(nd=this.zB),this.VWb=xd,this.YJc=Hd,
this.zB=this.mNf(nd),this.bSd(),xd?this.sik():Hd&&this.ijk(),Zc.b(this.$,!0);return!0};this.Rr=nd=>{nd=this.zoomManager.il(nd);if(!this.PK)return!1;let xd=this.VWb?this.ha.Yy(nd.clientPoint,nd.li,5,void 0,void 0,!0):this.ha.Yy(nd.clientPoint,nd.li,5,!0,!1,!0);xd||(xd=this.ha.l4(nd.clientPoint,nd.li,5));xd&&(nd=this.mNf(this.xIb(xd)),this.spc(nd.bottomRight),this.zB.equals(nd)||(this.zB=nd,this.P4b(!1),this.die(!1),this.bSd(!1),this.r8i(),this.Gh.update(!1)),this.y7k(this.zB));return!0};this.Bo=nd=>
{this.zoomManager.il(nd);if(!this.PK)return!1;this.resizeTable();this.Gvb();return!0};this.c2b=nd=>{this.zoomManager.il(nd);if(!this.PK)return I.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Gvb();return!0};this.Bpa=nd=>{this.zoomManager.il(nd);this.Gvb();return!0};this.Rhg=()=>{this.PK&&this.Gvb()};this.da=ta;this.zoom=Vc;this.$=ta.$;this.Qj=sc;this.ha=ta.ha;this.Gh=ta.Gh;this.parentElement=G;this.pQh();
da.a.Zx||da.a.j1||db.a.instance.xa(gb.a.qj,this.Hna,this.onPointerDown);this.Fv=jb;this.ned=this.DZd=!1;this.Qj.tBh(this.Rhg)}get PK(){return this.VWb||this.YJc}get r3f(){return this.ned}dispose(){this.Gvb();this.Qj.Llk(this.Rhg);this.r3f||da.a.Zx||da.a.j1||db.a.instance.Qa(gb.a.qj,this.Hna,this.onPointerDown);if(this.PK){Zc.b(this.$,!1);try{this.mF()}catch(G){I.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${G}`)}}this.parentElement&&
this.parentElement.contains(this.Hna)&&this.parentElement.removeChild(this.Hna);this.Hna=this.parentElement=null;super.dispose()}get zoomManager(){return this.zoom.zoomManager}mNf(G){const ta=G.bottom-this.Fv.topLeft.bottom-1;return 0<=G.right-this.Fv.topLeft.right+1&&0<=ta&&G.bottom>=this.Fv.top&&G.right>=this.Fv.left?new yb.Range(this.Fv.top,this.Fv.left,G.bottom,G.right,!1,!1):this.zB}bSd(G){this.DYc([this.zB],6,void 0===G?!0:G);this.Gh.Nw(this.q_g)}P4b(G){G=void 0===G?!0:G;this.Gh.Mq(this.q_g);
this.DYc([null],6,G)}die(G){G=void 0===G?!0:G;this.Gh.Mq(this.l_g);this.DYc([null],26,G)}r8i(){var G=!1;G=void 0===G?!0:G;const ta=this.YXk();0<ta.length&&(this.DYc(ta,26,G),this.Gh.Nw(this.l_g))}YXk(){const G=[];this.Fv.contains(this.zB)&&(this.Fv.right!==this.zB.right&&G.push(new yb.Range(this.Fv.top,this.zB.right+1,this.zB.bottom,this.Fv.right,!1,!1)),this.Fv.bottom!==this.zB.bottom&&G.push(new yb.Range(this.zB.bottom+1,this.Fv.left,this.Fv.bottom,this.Fv.right,!1,!1)));return G}resizeTable(){if(!this.zB.equals(this.Fv)){const G=
new yb.Range(this.Fv.top,this.Fv.left,this.zB.bottom,this.zB.right,!1,!1);this.E2k(G);this.DZd=!0}}onKeyDown(G){this.zoomManager.il(G);return!0}E9d(){this.r3f&&(da.a.Zx||da.a.j1||(db.a.instance.xa(gb.a.qj,this.Hna,this.onPointerDown),this.Hna.classList.remove("ewr-table-resize-default-cursor"),this.ned=this.Hna.disabled=!1),this.ned=!1)}pQh(){const G=document.createElement("div");G.className="ewr-table-resize-handle";const ta=document.createElement("div");ta.className="ewr-table-resize-fillhandle-higher";
const jb=document.createElement("div");jb.className="ewr-table-resize-fillhandle-broader";G.appendChild(ta);G.appendChild(jb);this.Hna=G;this.parentElement.appendChild(this.Hna)}spc(G){let ta=60;const jb=this.zB.contains(G);let sc=G.top,Vc=G.bottom,nd=G.left,xd=G.right,Hd=null;if(jb){if(this.da.bG(this.Fv.topLeft)&&!this.Fv.Z8a)return;G.bottom<this.zB.bottom?(sc=Math.max(1,Vc-2,this.Fv.top),ta=16):(nd=Math.max(1,xd-2,this.Fv.left),ta=4);Vc=sc;xd=nd;Hd=new yb.Range(sc,nd,sc,nd,!1,!1)}else G.right>=
this.Fv.right?(xd+=2,ta=8):G.bottom>=this.Fv.bottom&&(Vc+=2,ta=32),sc=Vc,nd=xd,Hd=new yb.Range(Vc,xd,Vc,xd,!1,!1),ta=16;this.da.bG(Hd)||(this.rz?this.rz.Vt||(this.rz=Ee.a.instance.create(()=>{this.da.FC(Hd,ta,"TableResizeBehavior.BringRangeIntoView")},40,Ze.a.o_g)):this.rz=Ee.a.instance.create(()=>{this.da.FC(Hd,ta,"TableResizeBehavior.BringRangeIntoView")},40,Ze.a.o_g))}xIb(G){let ta=G;if(this.da.fh.Fy){if(!this.da.zh(G.topLeft)){const jb=this.da.ot("TableResizeBehavior.AdjustHiddenRowColumns",this.da.H5,
this.zB.top!==G.top?1:2);try{jb.hs=this.zB.top<G.top||this.zB.left<G.left,jb.hG(G.topLeft),ta=jb.$$cu().range}finally{jb&&jb.dispose()}}ta.right=ta.left+G.width-1;ta.bottom=ta.top+G.height-1}return ta}DYc(G,ta,jb){jb=void 0===jb?!0:jb;const sc=[];for(const Vc of G)sc.push(new ze.a(Vc,Zd.d(this.$.ma)));this.Gh.fQ(sc,[ta],!0,void 0,jb)}sik(){db.a.instance.xa(gb.a.zv,document.documentElement,this.Rr);for(const G of this.da.Wu)db.a.instance.xa(gb.a.zv,G.domElement,this.Rr);db.a.instance.xa(gb.a.Co,document.documentElement,
this.Bo);this.Rpf()}ijk(){Kb.a.instance.xa(gb.a.Jn,document.documentElement,this.Rr);for(const G of this.da.Wu)Kb.a.instance.xa(gb.a.Jn,G.domElement,this.Rr);Kb.a.instance.xa(gb.a.ml,document.documentElement,this.c2b);this.Rpf()}mF(){this.VWb&&this.K5k();this.YJc&&this.U5k()}K5k(){db.a.instance.Qa(gb.a.zv,document.documentElement,this.Rr);for(const G of this.da.Wu)db.a.instance.Qa(gb.a.zv,G.domElement,this.Rr);db.a.instance.Qa(gb.a.Co,document.documentElement,this.Bo);this.ZBg()}U5k(){Kb.a.instance.Qa(gb.a.Jn,
document.documentElement,this.Rr);for(const G of this.da.Wu)Kb.a.instance.Qa(gb.a.Jn,G.domElement,this.Rr);Kb.a.instance.Qa(gb.a.ml,document.documentElement,this.c2b);this.ZBg()}Rpf(){this.da.cellTextEditBox.xjb(!0)}ZBg(){this.da.cellTextEditBox.xjb(!1)}E2k(G){this.$.si(-1400250766,jd.a.rh,30,{["ResizeTableRange"]:G,["OriginalTableRange"]:this.Fv})}y7k(G){if(!this.Fv.contains(G)){G=this.XXk();for(const ta of G)if(this.Qj.d_d(ta)){this.da.co.PA(Y.a.JKj);return}}this.da.rtl?this.da.co.PA(Y.a.LJj):this.da.co.PA(Y.a.hMj)}Gvb(){if(this.PK){Zc.b(this.$,
!1);try{this.mF()}catch(G){I.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${G}`)}}this.rz&&(this.rz.cancel(),this.rz.dispose());this.YJc=this.VWb=!1;this.P4b();this.die();Zc.b(this.$,!1);this.da.co.PA(Y.a.Gaa)}XXk(){const G=[];this.Fv.right!==this.zB.right&&G.push(new yb.Range(this.Fv.top,this.Fv.right+1,this.zB.bottom,this.zB.right,!1,!1));this.Fv.bottom!==this.zB.bottom&&G.push(new yb.Range(this.Fv.bottom+1,this.Fv.left,this.zB.bottom,
this.Fv.right,!1,!1));return G}static createInstance(G,ta,jb,sc,Vc){if(!ta)return null;const nd=G.Gh;nd.fQ(jb,[27],!0);nd.Nw(yd.SXk);jb=nd.VU(27,G.fh.Lo(ta.bottomRight),yd.gKi(ta,jb)).rl;return new yd(jb,G,ta,sc,Vc)}static gKi(G,ta){var jb;for(let sc=0;sc<ta.length;sc++)if((null===(jb=ta[sc])||void 0===jb?0:jb.range)&&ta[sc].range.equals(G))return sc;return 0}}yd.SXk=[27];Object(D.a)(yd,"TableResizeBehavior",bd.a,[]);var fe=a(55),De=a(154),Tb=a(155),Yc=a(323);class Ld extends dc.a{constructor(G,ta){super(document.createElement("div"));
this.und=this.jWd=this.Stg=this.X0=!1;this.Sne=null;this.onActiveCellChanged=()=>{ff.d(this.$,this.da.ha.qa.activeCell)?(this.Y0a=!0,this.rMb(!1)):(this.Yaa=this.Y0a=!1,this.Q4g())};this.Uy=()=>{this.Y0a?this.rMb(!0):this.Yaa=!1};this.yNa=()=>{this.und=!0;this.Y0a&&(this.Yaa=!1)};this.onContentReady=()=>{this.$.isEditMode?ff.d(this.$,this.da.ha.qa.activeCell)&&(this.Y0a=!0,this.rMb(!1)):this.Yaa=!1};this.xNa=()=>{this.und=!1;this.Y0a?this.rMb(!1):this.Yaa=!1};this.onBlockCacheItemChanged=(jb,sc)=>
{this.Y0a&&(jb=this.da.o5a(sc.mj.block.wk.BlockCachePosition.PaneType).CL(sc.mj.hash))&&(jb.Cje(this.FRf),jb.bqd(this.FRf))};this.FRf=()=>{this.tGg()};this.$=G;this.zoom=ta;this.da=ha.f(this.$);this.parentElement=this.domElement;this.parentElement.className="ewa-ttrd-buttonarea";this.X_a=this.da.yn;this.GHd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.Y0a=!0;this.wcj();this.GHd&&this.V$i();this.qKh();this.rMb(!1);I.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get zoomManager(){return this.zoom.zoomManager}get Yaa(){return this.jWd}set Yaa(G){this.jWd!==
G&&(this.jWd=this.isVisible=G)}get dYb(){return!!(this.$.Ij&16)}get nnj(){const G=this.da.ha.qa.activeCell;return G.right===G.maxColumns}get jHb(){const G=this.da.zh(null);return G&&this.da.mba(G.range)?this.lKa(G):(G&&I.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.dei();this.$=this.da=this.parentElement=this.X_a=null;super.dispose()}EHi(G){const ta=this.sZi(this.da.zh(null).range);return ta?this.GHd?
`=${this.zMf()}(${G}${this.$.listSeparator}${ta})`:`=SUBTOTAL(${G},${ta})`:null}zMf(){var G,ta,jb;return null!==(jb=null===(ta=null===(G=this.Sj)||void 0===G?void 0:G.localeInfo)||void 0===ta?void 0:ta.getWorksheetFuncName(344))&&void 0!==jb?jb:"SUBTOTAL"}sZi(G){var ta=ha.f(this.$).oh.Kl(G);if(!ta)return null;ta=ld.a(ta,!1);ta.right=ta.left=G.left;return ta.toString()}wcj(){Ld.nU={};Ld.nU["100"]=ka.a.instance.ia(1105);Ld.nU["101"]=ka.a.instance.ia(1108);Ld.nU["102"]=ka.a.instance.ia(1107);Ld.nU["103"]=
ka.a.instance.ia(1112);Ld.nU["104"]=ka.a.instance.ia(1109);Ld.nU["105"]=ka.a.instance.ia(1110);Ld.nU["109"]=ka.a.instance.ia(1106);Ld.nU["107"]=ka.a.instance.ia(1113);Ld.nU["110"]=ka.a.instance.ia(1115);Ld.nU["111"]=ka.a.instance.ia(1166)}V$i(){void za.a.resolve(oa.E).then(G=>this.Sj=G)}u4j(){var G=this.da.zh(null);if(G&&(G=G.HC?G.formulaBarText:null))if(this.GHd){const ta="="+this.zMf()+"(",jb=ta.length;if(G.toUpperCase().startsWith(ta)){if(G=G.substring(jb,jb+3),G in Ld.nU)return G}else return"111"}else if("=SUBTOTAL("===
G.substring(0,10)){if(G=G.substring(10,13),G in Ld.nU)return G}else return"111";return"100"}qKh(){this.da.za.nz(this.onBlockCacheItemChanged);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.dA(this.onContentReady);this.da.cellTextEditBox.Iv(this.yNa);this.da.cellTextEditBox.Jx(this.xNa)}dei(){this.da&&(this.da.ha&&(this.da.ha.remove_activeCellChanged(this.onActiveCellChanged),this.da.za.Zy(this.onBlockCacheItemChanged)),this.da.$E(this.onContentReady),this.da.cellTextEditBox&&(this.da.cellTextEditBox.Cv(this.yNa),
this.da.cellTextEditBox.Lw(this.xNa)),this.Q4g())}rMb(G){this.N7k(G);this.dYb&&(this.xWk(),this.jHb?(this.Stg||this.BKh(),this.und?this.Yaa=!1:(this.Yaa=!0,this.tGg())):(I.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.Yaa=!1))}tGg(){appChrome.renderTableTotalRowOptions(this.parentElement,Ld.nU,Ld.nU[this.u4j()].toString(),Math.round(this.zoomManager.jo(17)),G=>{I.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${G}`);
const ta={["SelectedOption"]:Ld.nU[G],["FunctionKeyCode"]:G,["Location"]:"canvas"};Tb.b(this.$).Aj(De.a.bYk,ta,null,!0);if("111"===G)return this.Ufj(),!0;if("100"!==G){this.Sne=this.EHi(G);if(!this.Sne)return I.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.W7a(this.Sne)}else this.W7a("");ja.DOMElementExtensions.setFocus(this.da.Fh.Wa.domElement);return!0})}Ufj(){I.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const G=new Ib.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ma.qh(G)}lKa(G){if(!G)return null;var ta=this.da.cellTextEditBox.Wa.domElement;var jb=0<ja.DOMElementExtensions.getHeight(ta)&&0<ja.DOMElementExtensions.getWidth(ta)&&0<=ta.offsetTop&&0<=ta.offsetLeft;if(jb)ta=ja.DOMElementExtensions.lKa(ta,this.da.yn);else{ta=this.da.getCellBounds(G.cell);var sc=ja.DOMElementExtensions.getBoundingClientRect(this.da.yn);ta=new Sys.UI.Bounds(ta.x-sc.x,ta.y-sc.y,ta.width,ta.height)}if(ta)if(jb)2<ta.height&&
2<ta.height&&(ta.x+=1,ta.y+=1,ta.height-=2,ta.width-=2);else if(jb=ha.f(this.$).SU(G.cell))jb=jb.width,sc=Ua.a.equals(fb.a.sRb(G.cell,this.da.rtl),"right",!0),this.da.rtl&&sc&&(ta.x=ta.x+ta.width-jb),G.Wya&&this.da.rtl===sc&&(ta.width=jb);else return null;return ta}N7k(G){var ta=this.jHb;if(ta){var jb=17>=ta.height?ta.y:ta.y+ta.height-17-2;ta=this.nnj?this.da.rtl?ta.x:ta.x+ta.width-(17<ta.height?17:ta.height):this.da.rtl?ta.x-(17<ta.height?17:ta.height):ta.x+ta.width;var sc=this.zoomManager.Dga(new Sys.UI.Point(ta,
jb));this.parentElement.style.top=Xd.HelperMethods.Ki(sc.y);this.parentElement.style.left=Xd.HelperMethods.Ki(sc.x);this.zoomManager.CFk(this.parentElement);G&&(this.Yaa=this.da.oKc(new fe.a(ta,jb)))}else this.Yaa=!1}BKh(){this.X_a.insertBefore(this.parentElement,this.X_a.firstChild);this.Stg=!0}xWk(){this.X0||(this.da.view.oz(this.Uy),this.X0=!0)}Q4g(){this.X0&&this.da.view&&(this.da.view.dy(this.Uy),this.X0=!1)}W7a(G){const ta=this.da.Fh,jb=this.da.zh(null);jb&&(G=Object(me.a)(new Yc.a,{Text:G}),
this.da.setCell(G,jb.range,0,127,null),ta.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}Ld.aYk="TableTotalRowDropDownIconButtonId";Ld.nU=null;Object(D.a)(Ld,"TableTotalRowOptions",dc.a,[4]);var he=a(1308);let Ke=class extends qb.a{constructor(G,ta){super(ha.f(G));this.pKb=this.Zca=this.k1c=this.nKb=null;this.d7e=!1;this.qQe=null;this.qec=0;this.auc=null;this.Loc=()=>{const jb={},sc=this.bOd();for(const nd in sc){const xd=sc[nd];if(!xd)continue;const Hd=this.oYi(xd);if(Hd){if(Hd in this.lVa){var Vc=
this.lVa[Hd];if(Vc.PK){Vc.Fv.equals(xd)||(Vc.Fv=xd);delete this.lVa[Hd];jb[Hd]=Vc;continue}}(Vc=yd.createInstance(ha.f(this.$),xd,this.oEi(),this,this.zoom))?jb[Hd]=Vc:I.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${xd.FE(!1)}`)}}this.Uqc(null,null);this.Qcc=jb};this.Uqc=()=>{const jb=this.lVa;for(const nd in jb){var sc=nd,Vc=jb[nd];Vc&&(Vc.dispose(),delete this.lVa[sc])}this.Qcc={}};this.rAg=()=>{this.Uqc(null,null);this.Loc(null,null)};
this.onFocus=()=>{this.qQe=ha.f(this.$).ha.qa.activeCell};this.FA=()=>{if(this.$.isEditMode)this.onActiveCellChanged(null,null)};this.onActiveCellChanged=()=>{!this.d7e&&ff.d(this.$,this.da.ha.qa.activeCell)&&this.fyj()};this.iJ=()=>{this.MUb(1);xa.EwaSettings.wl()||this.$.ea.Bv(this.iJ)};this.g3b=()=>{this.d7e=!0;this.k1c=new Ld(this.$,this.zoom)};this.$=G;this.zoom=ta;this.da=ha.f(this.$);this.Qcc={};this.Loc(null,null);this.$.sa&&this.$.sa.pn(this.rAg);this.Opd(this.Loc);this.$.ea.cK(this.FA);
this.da.ha.add_activeCellChanged(this.onActiveCellChanged);if(this.$.isEditMode)this.onActiveCellChanged(null,null)}Opd(G){this.addHandler(qb.a.$3b,G)}rje(G){this.removeHandler(qb.a.$3b,G)}tBh(G){this.addHandler("tce",G)}Llk(G){this.removeHandler("tce",G)}get lVa(){return this.Qcc}get J0d(){return this.qQe}get oYa(){return this.qec}get tw(){const G=ha.f(this.$);return G.oh.Kl(G.ha.qa.activeCell,!1)}get qee(){return this.J0d?ha.f(this.$).oh.Kl(this.J0d,!1):null}d_d(G){return!!this.aKf(G)}Ey(G){return this.jUi(this.KKf(G))}aRb(G){return this.KKf(G)}fjk(G){G?
(this.pKb?this.pKb!==G&&(ra.a.dh(this.Zca),this.Zca=null,this.pKb=G):this.pKb=G,this.Zca||(this.Zca=Nf.a.instance.Yk(this.pKb)),this.Zca.Wv("focusin")||this.Zca.Ba("focusin",this.onFocus)):I.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement received")}k_f(G,ta){return G?G.Oxa&&G.top===ta.top:(I.ULS.shipAssertTag(537151244,0,!!G,"autofilterRange can't be null"),!1)}oxa(G){G=this.nKb?Lb.O(G,this.nKb):this.view.getRangeInformation(G);return 0<G.length&&
Object(cd.a)($d.PivotTableRange,G[0])?G[0]:null}zij(G,ta){return G?!G.bHc&&!!G.HI&&G.HI.Xi(ta):(I.ULS.shipAssertTag(537151243,0,!!G,"Pivot table can't be null"),!1)}yqj(G,ta){return G?!G.bHc&&!!G.mL&&G.mL.Xi(ta):(I.ULS.shipAssertTag(537151242,0,!!G,"Pivot table can't be null"),!1)}omc(G){super.omc(G);if((G=Xd.HelperMethods.mKf(G))&&0<G.length){this.nKb=Array(G.length);for(let ta=0;ta<G.length;ta++)this.nKb[ta]=Uc.a.SI(G[ta])}}I4b(){super.I4b();this.nKb=null}A3h(G,ta){let jb;jb=!1;if(!G||!ta)return{returnValue:!1,
t$:jb};G=G.clone();G.right+=1;G.left=G.right;if(!G.AB)return{returnValue:!1,t$:jb};if(G.top<ta.fh.Gm){const sc=G.clone();sc.bottom>=ta.fh.Gm&&(sc.bottom=ta.fh.Gm-1);if(!(()=>{let Vc=this.Pjf(sc,ta);({t$:jb}=Vc);return Vc})().returnValue)return{returnValue:!1,t$:jb}}if(G.bottom>=ta.fh.Gm){const sc=G.clone();sc.top<=ta.fh.Gm&&(sc.top=ta.fh.Gm);if(!(()=>{let Vc=this.Pjf(sc,ta);({t$:jb}=Vc);return Vc})().returnValue)return{returnValue:!1,t$:jb}}return{returnValue:!0,t$:jb}}p_g(G){(G=this.Ey(G.topLeft))&&
G.toString()in this.lVa&&(this.lVa[G.toString()].DZd=!1)}qck(){this.raiseEvent("tce")}Dq(G,ta){if(!this.k1c)return!1;switch(ta){case -569786022:case 541421805:if(this.k1c.Yaa){const jb=document.getElementById(Ld.aYk);jb&&Ee.a.instance.create(()=>{ja.DOMElementExtensions.UFc(jb,null)},0,Ze.a.UXk,!0,!0)}return!0;default:return!1}}dispose(){this.Uqc(null,null);this.rje(this.Loc);this.$.sa.Gn(this.rAg);this.$.Yu(this.Uqc);this.Qcc=null;this.$.ea&&this.$.ea.WH(this.FA);this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);
this.k1c=null;this.Zca&&(ra.a.dh(this.Zca),this.Zca=null);super.dispose()}oQf(G,ta,jb,sc){var Vc=this.da.oh.Kl(new yb.Range(ta,jb,ta,jb,!1,!1));if(this.auc=Vc){var nd=Vc.usedRange,xd=G.ctrlKey||da.a.isMac&&yc.b(G);Vc=!G.shiftKey&&xd;G=G.shiftKey&&!xd;ha.f(this.$).ha.selectionType=3;switch(sc){case 0:this.qec=0;ta=this.jAd(G,nd.top,jb,nd.bottom,jb);this.$pe(ta,Vc,G);break;case 1:this.qec=1;ta=this.jAd(G,ta,nd.left,ta,nd.right);this.$pe(ta,Vc,G);break;case 2:this.qec=2;ta=this.jAd(G,nd.top,nd.left,
nd.bottom,nd.right);this.$pe(ta,Vc,G);break;default:I.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${sc.toString()}`);return}ha.f(this.$).ha.selectionType=3;I.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else I.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}TKk(G){const ta=
this.auc.usedRange;return this.M1f(G)||1!==this.oYa&&this.M1f(new yb.Range(ta.top,G.left,ta.bottom,G.right,!1,!1))?!0:!1}Pfe(G){return G.Autofilters}Pjf(G,ta){let jb;jb=!1;const sc=ta.fh.Lo(G),Vc=ta.sl(sc).Dp;if(!Vc)return I.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${sc}`),{returnValue:!1,t$:jb};if(!Vc.Ik(G))return{returnValue:!0,t$:jb};G=ta.ot("TableManager.CouldExpandImpl",G,2);try{for(;G.$$mn();){if(G.$$cu().text||G.Iu.i0a)return jb=!0,{returnValue:!1,
t$:jb};if(G.$$cu().AH)return{returnValue:!1,t$:jb}}}finally{G&&G.dispose()}return{returnValue:!0,t$:jb}}jUi(G){if(!G)return null;const ta=new qc.AutofilterRange(G.top,G.left,G.bottom,G.right,null,null,null,G.id,G.Oxa);ta.Z8a=G.Z8a;const jb=this.da.oh.Kl(G,!0);if(!jb)return null;for(let sc=0,Vc=this.rangeList.length;sc<Vc;sc++){const nd=this.rangeList[sc],xd=this.da.oh.Kl(nd,!0);xd&&xd.name===jb.name&&nd!==G&&this.Dpj(nd)&&(ta.union(nd),nd.Z8a&&(ta.Z8a=!0))}return ta}Dpj(G){return!!ha.f(this.$).oh.Kl(G)}oEi(){const G=
[];for(const ta of this.rangeList){const jb=new ze.a(this.Ey(ta.topLeft),Zd.d(this.$.ma));G.push(jb)}return G}bOd(){const G={};for(const ta of this.rangeList){if(!ta)continue;const jb=this.Ey(ta.topLeft);jb&&(G[jb.toString()]=this.Ey(ta.topLeft))}return G}fyj(){this.$.ea.nm?this.MUb(0):xa.EwaSettings.wl()?this.$.ea.Yq(this.iJ):this.$.ea.lr(this.iJ)}MUb(G){this.$.P5(ta=>{ta.taa(G).then(this.g3b)})}oYi(G){const ta=this.da.oh.Kl(G);return ta?ta.name:G.toString()}$pe(G,ta,jb){G&&(jb=jb?ha.f(this.$).ha.qa.activeCell:
G.topLeft,ta?this.da.ha.updateSelection(G,jb,0,1):this.da.ha.yN([G],0,jb,0))}jAd(G,ta,jb,sc,Vc){const nd=ld.d(this.auc),xd=ld.g(this.auc),Hd=ta+(1!==this.oYa&&nd?1:0),ke=sc-(1!==this.oYa&&xd?1:0),V=this.da.inRangePicker||this.da.lq;if(G){var Wa=V&&!ze.a.utc(this.da.ha.rangePicker.pZ).length?new yb.Range(Hd,jb,ke,Vc,!1,!1):V?this.da.ha.rangePicker.activeCell:this.da.ha.qa.activeCell;Wa=new yb.Range(Wa.top<Hd?Wa.top:Hd,Wa.left<jb?Wa.left:jb,Wa.bottom>ke?Wa.bottom:ke,Wa.right>Vc?Wa.right:Vc,!1,!1)}else Wa=
new yb.Range(Hd,jb,ke,Vc,!1,!1);if(1!==this.oYa&&(nd||xd)&&(!G||G&&this.Hxd(Wa,Hd,jb,ke,Vc))){G=V?ze.a.utc(this.da.ha.rangePicker.pZ):this.da.ha.qa.selectedRanges;for(const Eb of G)if(this.Hxd(Eb,Hd,jb,ke,Vc)){Wa.top=ta;Wa.bottom=sc;break}}return Wa}M1f(G){const ta=this.da.inRangePicker||this.da.lq?ze.a.utc(this.da.ha.rangePicker.pZ):this.da.ha.qa.selectedRanges;for(const jb of ta)if(this.Hxd(jb,G.top,G.left,G.bottom,G.right))return!0;return!1}Hxd(G,ta,jb,sc,Vc){return!!G&&G.top===ta&&G.bottom===
sc&&G.left===jb&&G.right===Vc}};Ke=Object(U.__decorate)([Object(za.d)(oa.vg),Object(U.__param)(0,Object(oa.Nb)()),Object(U.__param)(1,Object(oa.ah)())],Ke);Object(D.a)(Ke,"TableManager",qb.a,[861,4]);String(he);window.___1710758625420_closurehack=he;var Me=a(765),df=a(645),xf=a(1310);class fg extends Nc.a{constructor(G,ta){ta=void 0===ta?!0:ta;super(!1,!1,!0);this.Tcb=null;this.RLe=!1;this.Xw=[];this.rq=null;this.MSj=jb=>{this.Dsh&&(this.rq=this.lRg(jb,this.Vkc))};this.Y0j=()=>{this.rq&&this.rq.dP&&
(this.RLe||(this.rq.yik(this.L9d),this.RLe=!0),this.rq.nzf())};this.L9d=jb=>{this.Tcb.uploadStatusLabel=jb;this.jRa(this.titleText,this.bUd,this.Tcb)};this.bUd=jb=>{1===jb&&this.isEnabled()?this.rq.dP&&!this.rq.dP.value?(this.Tcb.uploadStatusLabel=Object(cb.a)("FileUploadNoFileSpecified"),this.jRa(this.titleText,this.bUd,this.Tcb)):(this.Omb(),this.Vkc.finalizeUpload(this.rq,this.dispose)):0===jb&&this.hide()};this.Qae=()=>{this.Yxg()};this.onKeyDown=jb=>{4!==hd.FocusManager.instance().byg(jb)&&jb.preventDefault()};
this.Vkc=G;this.Dsh=ta;this.qI=this.uZe=!1;this.Cta=null;this.kl="InsertFileDialog";this.ti(1,this.actionButtonText);this.Tcb={["id"]:this.kl,["bodyControls"]:{["uploadButtonProps"]:{["label"]:Object(cb.a)("DialogChooseFile"),["onExecute"]:this.Y0j}},["uploadStatusLabel"]:Object(cb.a)("DialogNoFileChosen"),["onFrameReady"]:this.MSj};this.initializeAndShow(this.titleText,this.bUd,this.Tcb);this.O$c=!0}get Fal(){return this.Vkc}AHk(){this.PLe=!1;this.rq=this.lRg(document.getElementById("uploadFrameContainer"),
this.Vkc);wa.AFrameworkApplication.fa.ka("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Cta=this.Qae,nc.a.addHandler(this.rq.FSd,"load",this.Cta));this.rq.dP||I.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.Yxg()}Yxg(){if(this.rq&&!this.PLe){var G=this.rq.dP;G&&(nc.a.addHandler(G,gb.a.Ui,this.onKeyDown),G=[G],this.Xw=G.concat.apply(G,this.Xw),this.d9k(),this.PLe=!0)}}dispose(){if(this.rq){const G=this.rq.dP;G&&nc.a.removeHandler(G,gb.a.Ui,this.onKeyDown);this.Cta&&
nc.a.removeHandler(this.rq.FSd,"load",this.Cta)}this.rq=null;super.dispose()}d9k(){if(0<this.Xw.length){const G=new xf.a(this.Xw),ta=hd.FocusManager.instance().N0();ta&&(this.Xw[0].focus(),ta.zo=G,ta.Kha=!0)}}static tL(G){const ta=document.getElementById("errorText");ta.innerText=G;ta.style.display="inline-block"}}Object(D.a)(fg,"InsertFileDialog",Nc.a,[]);class xg{static get lp(){return Nc.a.rB(xg.uw,Object(cb.a)("ImageUploadDialogText"),Object(cb.a)("ImageUploadNoFileSpecified"))}}xg.uw="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(D.a)(xg,"InsertImageDialogHtml",null,[]);class lg extends fg{constructor(G,ta){super(G,void 0===ta?!0:ta)}get actionButtonText(){return Object(cb.a)("ImageUploadButtonText")}get titleText(){return Object(cb.a)("ImageUploadingTitle")}validate(){this.rq.dP||I.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var G=Object(oe.a)(pc,this.Fal);const ta=G.H8g(this.rq.dP.value);return 0!==ta?(G=G.xGf(ta),fg.tL(G),!1):!0}}Object(D.a)(lg,"InsertImageDialog",fg,[]);var Vf=a(855),
dg=a(142),Gg=a(1521);class Hg extends Gg.a{constructor(G,ta,jb,sc,Vc,nd,xd,Hd){Hd=void 0===Hd?!1:Hd;super(G,ta,jb,sc,Vc,"UploadFrame",nd.ea.sessionId,"image/*",!1,null,void 0===xd?!1:xd);this.$=nd;this.U7g=!0;this.$hj=Hd;this.RTd()}ia(G){return G}ZNg(G){I.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");vc.a.grd(G,this.$.ua);G.Eea(Gc.a.sessionId,this.sessionId);var ta=ha.f(this.$).ha;ta=Lb.q(ta.qa.saa,this.$);G.Eea(Gc.a.Iyg,this.$.sa.ma.name);G.Eea(Gc.a.kbk,ta.FirstRow.toString());
G.Eea(Gc.a.jbk,ta.FirstColumn.toString());G.Eea(Gc.a.Gej,this.$hj.toString())}uQf(){this.MIg("ServerUploadError")}c5a(G){this.MIg(G)}static Gkj(G){return!G||Ua.a.equals(G,"ServerUploadError",!1)}}Object(D.a)(Hg,"UploadFrameWrapper",Gg.a,[]);class Mg extends lg{constructor(G,ta,jb,sc){super(G,!1);this.mwa=null;this.CQa=!1;this.Bi=null;this.ZOc=()=>{this.Kze("");this.Y2c();return!1};this.$=ta;this.t4c=G;this.a1=Vf.a.instance;this.fa=jb;this.Bi=sc;this.AHk();this.Vbj();this.$.vh.ME=!0}lRg(G,ta){return new Hg(G,
Object(dg.a)(ta,ta.b5a,"onUploadFrameInitialized"),Object(dg.a)(ta,ta.Nja,"uploadResponseReceived"),this.fa,!0,this.$)}dispose(){this.Y2c();this.a1=this.t4c=null;super.dispose()}hide(){super.hide();this.$.vh.ME=!1}validate(){var G=this.t4c.ybc(this.rq.dP.value,this.t4c.X2g(this.rq));return 0!==G?(G=this.t4c.wLd(G).Description,this.Kze(G),this.Ave(),!1):!0}isEnabled(){return!0}Kze(G){var ta;null===(ta=this.Bi)||void 0===ta?void 0:ta.XOg(this.mwa,G)}Vbj(){this.mwa=document.getElementById("errorText");
this.mwa.style.display="inline-block";this.CQa=!1;this.Kze("");this.Nib.style.maxWidth=this.Nib.currentStyle.minWidth}Ave(){this.a1.xa(gb.a.click,this.rq.dP,this.ZOc);this.a1.xa(gb.a.Ui,this.rq.dP,this.ZOc);this.CQa=!0}Y2c(){this.CQa&&(this.a1.Qa(gb.a.click,this.rq.dP,this.ZOc),this.a1.Qa(gb.a.Ui,this.rq.dP,this.ZOc),this.CQa=!1)}}Object(D.a)(Mg,"InsertImageDialogWrapper",lg,[]);var Ff=a(62);class yf extends pc{constructor(G,ta,jb,sc,Vc){Vc=void 0===Vc?!0:Vc;super(null,ta,jb);this.twa=this.oQ=null;
this.oVd=this.zpb=!1;this.Gce=null;this.Nja=nd=>{this.oCe.stop();this.Foc.cancel();if(Hg.Gkj(nd))this.L8?this.hPf(4):(nd=new Me.a(0,2,null,null,!1,null,null,null),nd.status=8,this.lye(new df.a(nd),null,"InsertPictureWebMethod")),I.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.L8}`);else{const xd=yf.Qcl(nd);0!==xd?(I.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${nd}`),this.hPf(xd)):this.r5i(nd)}this.f2b();this.dispose()};this.RRj=nd=>{this.Lra(nd,
this.rq)&&this.finalizeUpload(this.rq,null)};this.b5a=nd=>{I.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.rq=nd;if(!this.iIa){if(this.w4c){if(this.Mcf()||this.h4a&&da.a.aJ){nd.iOb(this.RRj);return}const xd=nd.iOb(null);if(!this.Lra(xd,nd))return}this.finalizeUpload(nd,null)}};this.y0j=()=>{this.L8=!0};this.th=G;this.oCe=G.Eh.em("WebServiceCall","InsertPictureOperation");this.Foc=Ee.a.instance.create(this.y0j,1E5,Ze.a.$Lh,!1);this.L8=!1;this.WMc=this.$.ua.InsertPictureMaxFileSizeBytes;
sc&&(this.zpb="TestOnly"in sc);sc&&(this.oVd="IsCellPicture"in sc);Vc&&this.showDialog()}get $(){return this.th}get REj(){return this.WMc/1024/1024}dispose(){ra.a.dh(this.Foc);this.rq&&this.rq.i2e();this.rq=this.Foc=this.th=null}Vek(G){if(!this.$)return I.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),nb.Task.Ua(!0);if(!this.$.nha)return nb.Task.Ua(!0);const ta=new Dc.a,jb=new FileReader;G=G.dP.files[0];const sc=()=>{ta.lF(!0)};jb.onload=()=>{this.Gce=jb.result;ta.lF(!0)};
jb.onerror=sc;jb.onabort=sc;jb.readAsDataURL(G);return ta.task}X2g(G){let ta=-1;G=G.dP;(null===G||void 0===G?0:G.files)&&0<G.files.length&&(ta=G.files[0].size);return ta}ybc(G,ta){let jb=yf.Y2h(pc.Lra(G));0===jb?-1!==ta&&(I.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${ta}, maxAllowedSize: ${this.WMc}, remainingWorkbookSize: ${this.$.ea.e6f}`),ta>this.WMc?jb=3:ta>this.$.ea.e6f&&(jb=7)):6===jb&&this.nCj(G);I.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${jb}`);
return jb}Lra(G,ta){G=this.ybc(G,this.X2g(ta));return 0!==G?(this.iIa||1===G||this.jte(G),!1):!0}f2g(G){G.uWk()}wLd(G){let ta=0,jb=1,sc=-1100324317,Vc="InsertPictureUnknownError",nd=null;switch(G){case 1:ta=1758;jb=0;sc=940870981;Vc="InsertPictureNoFileSelected";break;case 3:jb=0;sc=1250467391;Vc="InsertPicturePictureTooBig";nd=String.format(ka.a.instance.sh(181),this.REj.toLocaleString());break;case 6:ta=1762;jb=0;sc=1380041209;Vc="InsertPictureUnsupportedFormat";break;case 7:ta=1759;jb=0;sc=-903115058;
Vc="InsertPictureExceedWorkbookSize";break;case 4:ta=1760;jb=0;sc=1218352119;Vc="InsertPictureUploadTimeout";break;case 5:ta=1761,jb=0,sc=1979899005,Vc="InsertPictureServiceNonDeterministicError"}G=yf.nj(ta,jb,sc,Vc);nd&&(G.Description=nd);return G}showDialog(){if(this.Mcf())this.iIa=!1,this.rq=new Hg(this.$.domElement,this.b5a,this.Nja,this.fa,!1,this.$,!0,this.oVd);else if(I.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.zpb&&(da.a.iS||da.a.aJ&&72>da.a.hff))this.iIa=!1,this.rq=
new Hg(this.$.domElement,this.b5a,this.Nja,this.fa,!1,this.$);else{this.iIa=!0;const G=Object(mc.d)(za.a.resolve(oa.pd,{va:0}));Db.TaskExtensions.Xa(G,()=>{this.rq=(new Mg(this,this.$,this.fa,G.result)).rq},this.$.ya,3)}}r5i(G){let ta={};try{if(ta=O.a.Sp(G),Ff.b().vI(this.oCe.id,ta.ServerCorrelationId,"actions","ServerActions"),!be.a.jl(ta.Errors)&&ta.Result&&(this.$.ea.P8(ta.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.oVd)){const jb=ta.Result;Sa.a(this.$).yPa(1,jb);const sc=
xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?za.a.nh(oa.Ng):this.$.la.kh(277);sc&&sc.qod(this.$,1,ta.Result,ta,"InsertPicture");I.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(jb){I.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${G?G.length:-1}, errror: ${jb}`)}this.t2c(ta,null,"InsertPictureWebMethod")}hPf(G){G=this.wLd(G);const ta=
{};ta.Errors=[G];this.t2c(ta,null,"InsertPictureWebMethod")}t2c(G,ta,jb){this.oQ(G,ta,jb)}lye(G,ta,jb){this.twa(G,ta,jb)}jte(G){G=this.wLd(G);new Oe.a(this.$,G)}nCj(G){const ta=this.$.ua.InsertPicturUnsupportedExtensionsForLogging;G=ea.a.ys(G);for(let jb=0;jb<ta.length;++jb)if(G.endsWith(ta[jb])){I.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${ta[jb]}`);break}}static Qcl(G){return!G||Ua.a.equals(G,Gc.a.insertPictureUnknownError,!0)?2:Ua.a.equals(G,Gc.a.insertPictureNoFileSelectedError,
!0)?1:Ua.a.equals(G,Gc.a.Fej,!0)?3:Ua.a.equals(G,Gc.a.Iej,!0)?5:0}static nj(G,ta,jb,sc){return be.a.nj(1,0,0,G,ta,jb,sc)}static Y2h(G){switch(G){case 1:return 1;case 2:return 6}return 0}Mcf(){return this.zpb||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(D.a)(yf,"BasePictureUploaderWrapper",pc,[4]);class mg extends yf{constructor(G,ta,jb,sc,Vc,nd){nd=void 0===nd?!0:nd;super(G,ta,jb,sc,!1);this.mvi=Vc;this.lyc=G.Eh.em("LoadResource","FileReaderUploaderLoadResource");nd&&
this.showDialog()}jPk(){this.WMc=28E5;this.jte(3)}aHd(G){I.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const ta=new FileReader;G=G.dP.files;if(0==G.length)I.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var jb=G[0];ta.onload=()=>{this.lyc.stop();this.mvi.T_j(ta.result,this);I.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${jb.type}, Size:${jb.size.toString()}`)};
ta.onerror=()=>{this.lyc.stop();I.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${jb.type}, Size:${jb.size.toString()}`)};ta.onabort=()=>{this.lyc.stop();I.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${jb.type}, Size:${jb.size.toString()}`)};this.lyc.start();ta.readAsDataURL(jb)}}finalizeUpload(G,ta){this.aHd(G,ta)}}Object(D.a)(mg,"FileReaderUploaderWrapper",yf,[883]);class jh{constructor(G,
ta){this.dataUri=this.sheetName=null;this.sheetName=G;this.dataUri=ta}getSheetName(){return this.sheetName}}Object(D.a)(jh,"MacroRecorderPictureInsertedPayload",null,[60]);class bg extends yf{constructor(G,ta,jb,sc,Vc,nd){nd=void 0===nd?!0:nd;super(G,jb,sc,Vc,!1);this.Nh=ta;nd&&this.showDialog()}aHd(G,ta){super.finalizeUpload(G,ta);va.a(this.$.userOperationManager,(jb,sc)=>{this.oQ=jb;this.twa=sc;this.oCe.start();this.Foc.MA();this.L8=!1;this.f2g(G);return this.Vek(G)},jb=>{const sc={};this.$.dr(sc);
const Vc=sc.SheetName;jb=new bc.a(510,0,jb,72,()=>new jh(Vc,this.Gce?this.Gce:""));jb.WPa(()=>!0);jb.Nh=this.Nh;return jb},this.Nh)}finalizeUpload(G,ta){this.aHd(G,ta)}}Object(D.a)(bg,"PictureUploaderWrapper",yf,[]);class Og{constructor(G,ta){this.filename=G;this.blob=ta}}Object(D.a)(Og,"UploadBlobParameters",null,[]);class rg extends bg{constructor(G,ta,jb,sc,Vc,nd,xd){super(G,ta,jb,sc,Vc,!1);this.w4c=!1;this.uT=xd;this.TEc=rg.GBi(nd);G=this.ybc(this.TEc.name,this.TEc.size);0!==G?(this.jte(G),this.uT.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),
this.dispose()):this.rq=new Hg(this.$.domElement,this.b5a,this.Nja,sc,!1,this.$)}lye(G,ta,jb){super.lye(G,ta,jb);this.uT.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}t2c(G,ta,jb){super.t2c(G,ta,jb);be.a.jl(G.Errors)?this.uT.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${be.a.Yh(G.Errors)}`)):this.uT.setResult(!0)}f2g(G){const ta=new Og(this.TEc.name,this.TEc);G.gZg(ta)}static GBi(G){var ta=
G.split(",");G=ta[0].includes("base64")?window.self.atob(ta[1]):window.self.decodeURI(ta[1]);ta=ta[0].split(":")[1].split(";")[0];const jb=new Uint8Array(G.length);for(let sc=0;sc<G.length;sc++)jb[sc]=G.charCodeAt(sc);G=new Blob([jb],{type:ta});G.name="Image.png";return G}}Object(D.a)(rg,"DataUrlUploaderWrapper",bg,[]);let Ma=class{constructor(){}bdj(G,ta,jb,sc,Vc){-2060689045===ta.command&&(Vc.IsCellPicture=!0);new bg(G,ta,jb,sc,Vc,!0)}Qbj(G,ta,jb,sc,Vc,nd){new rg(G,null,ta,jb,sc,Vc,nd)}fcj(G,ta,
jb,sc,Vc){new mg(G,ta,jb,sc,Vc,!0)}};Ma=Object(U.__decorate)([Object(za.d)(oa.Lg)],Ma);Object(D.a)(Ma,"UploaderCreator",null,[864]);let Na=class{constructor(G,ta){this.l7=()=>{this.Hj||this.V6e()};this.Hj=!1;this.O$=ta.QX;this.ariaLiveNotifier=G;this.DCe=new na(G,ta);this.O$&&this.O$.wY?this.V6e():this.Hp()}dispose(){this.to();this.ariaLiveNotifier=this.O$=null;this.Hj=!0}Hp(){if(this.O$){this.O$.dA(this.l7);this.O$.za.ny(this.l7);this.O$.lO(this.l7);var G=Object(oe.a)(168,this.O$);G&&(G.Fh.Iv(this.l7),
G.ha.Zw(this.l7),G.ha.add_activeCellChanged(this.l7),G.ha.$e.nO(this.l7))}else I.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}to(){if(this.O$){this.O$.za.ux(this.l7);this.O$.$P(this.l7);const G=Object(oe.a)(168,this.O$);G&&(G.Fh.Cv(this.l7),G.ha.vx(this.l7),G.ha.remove_activeCellChanged(this.l7),G.ha.$e.VV(this.l7))}}V6e(){this.DCe.gBg();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.wDk();this.dispose()}};Na=Object(U.__decorate)([Object(za.d)(oa.Vg),
Object(U.__param)(0,Object(oa.l)()),Object(U.__param)(1,Object(oa.Nb)())],Na);Object(D.a)(Na,"WorkbookReadoutHandler",null,[4]);var Qc=a(261);const ce="H1 H2 H3 H4 H5 H6".split(" "),ve=["TD","TH"],Ve=["P","DIV","TABLE","TBODY","THEAD","TFOOT","ARTICLE","ADDRESS","ASIDE","BLOCKQUOTE","CAPTION","CODE","FORM","DETAILS","SUMMARY","LEGEND","FIELDSET","FOOTER","HEADER","KBD","MAIN","SECTION",...ce],vf="SPAN A ABBR ACRONYM B STRONG I EM SUB SUP BDO BDI BUTTON CITE DATA LABEL DEL INS DFN DIALOG HGROUP MARK S TIME U V FONT".split(" "),
Kf=["UL","OL","LI","INPUT","SELECT","AREA","AUDIO","B","BASE","BR","CANVAS","COL","COLGROUP","DATALIST","DD","DETAILS","DFN","DIR","DL","DT","EMBED","FIGCAPTION","FIGURE","HR","IFRAME","IMG","LINK","MAP","MENU","MENUITEM","META","METER","NAV","NOSCRIPT","OBJECT","OPTGROUP","OPTION","OUTPUT","PICTURE","PRE","PROGRESS","Q","RP","RT","RUBY","SAMP","SMALL","SOURCE","TEMPLATE","TEXTAREA","TR","TRACK","VAR","VIDEO",...Ve,...vf,...ve],ng="table table;table ul;table ol;table dl;ul ul;ol ol;ol ul;ul ol;dl;img".split(";"),
Bf={"sans-serif":"Arial",Nul:"Times New Roman",Vnl:"Courier New",Yll:"Comic Sans MS",vml:"Algerian"},Uf=/^(\d+|\d+\.\d+)(\w+)$/,Qf=/>\s+</g;let ug=class{constructor(G){this.zSd=[];this.dV=[];this.L0d=this.eLc=this.Cma=this.Fma=0;this.M2b=G}J4j(G,ta){this.UP={d9i:-1,lTf:-1,f9i:-1,Uml:G.length,a9i:0};const jb=[];if(!ta.token.SM)try{const sc=this.qlk(G),Vc=performance.now();this.anb=this.M2b.$vk(sc);if(!this.anb)return I.ULS.sendTraceTag(507377812,0,50,"HtmlProcessor.parseHtml: htmlContent is null after sanitizeAndAppendPastedHtml call"),
Qc.a.Ua({x0a:jb,cseStatus:46,UP:this.UP});this.UP.d9i=performance.now()-Vc;G=!1;for(const ke of ng)if(this.anb.querySelector(ke)){G=!0;break}if(G){const ke=performance.now();this.M2b.nEg();this.UP.lTf=performance.now()-ke;return Qc.a.Ua({x0a:jb,cseStatus:41,UP:this.UP})}this.L9j();this.initialize();const nd=performance.now(),xd=this.$tj(this.anb,jb,ta);this.UP.f9i=performance.now()-nd;const Hd=performance.now();this.M2b.nEg();this.UP.lTf=performance.now()-Hd;return xd?(this.UP.a9i=jb.length,Qc.a.Ua({x0a:jb,
cseStatus:1,UP:this.UP})):Qc.a.Ua({x0a:jb,cseStatus:39,UP:this.UP})}catch(sc){return I.ULS.sendTraceTag(507377811,0,10,"HtmlProcessor.parseHtml: Error parsing the html",sc),Qc.a.Ua({x0a:jb,cseStatus:46,UP:this.UP})}return Qc.a.Ua({x0a:jb,cseStatus:39,UP:this.UP})}initialize(){this.L0d=this.eLc=this.Cma=this.Fma=0;this.PO=null;this.AUb=!1;this.dV=[]}L9j(){try{I.ULS.sendTraceTag(507377810,0,50,"HtmlProcessor.preprocessStyle: start");const G=this.anb.getElementsByTagName("style");if(G&&0<G.length){I.ULS.sendTraceTag(507536152,
0,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let ta=0;ta<G.length;ta++)this.anb=c(this.anb,G[ta]),G[ta]&&(G[ta].parentNode.removeChild(G[ta]),ta--)}}catch(G){I.ULS.sendTraceTag(507377809,0,10,"HtmlProcessor.preprocessStyle: Error while converting style elements to inline style",G)}}$tj(G,ta,jb){try{const sc=G.childNodes;for(G=0;G<sc.length;G++){if(jb.token.SM)return!1;this.IPf(sc[G],ta)}return!0}catch(sc){return I.ULS.sendTraceTag(507377808,0,10,"HtmlProcessor.iterateOverChildNodesOfBody: Error while iterating over child nodes of body",
sc),!1}}qlk(G){return G.replace(Qf,"><")}a4a(){this.Fma++;this.Fma>this.eLc&&(this.eLc=this.Fma);this.PO=null}zdg(){this.Cma++;this.Cma>this.L0d&&(this.L0d=this.Cma);this.PO=null}otc(G){const ta={borders:[],fontFamily:"",cellText:"",Nwe:0,yBf:!1,color:"",fontSize:11,italic:!1,backgroundColor:"",bold:!1,OD:"",rowIndex:this.Fma,colIndex:this.Cma};G.push(ta);return ta}JGc(){var G;return!(null===(G=this.PO)||void 0===G?0:G.cellText)||0===this.PO.cellText.length}sYb(G,ta){G=G.childNodes;for(let jb=0;jb<
G.length;jb++)this.IPf(G[jb],ta)}E5i(G,ta){let jb;if(G.textContent){if(this.dV.map(sc=>sc.element.tagName).some(sc=>ve.includes(sc))||G.nextElementSibling&&vf.includes(G.nextElementSibling.nodeName))jb=G.textContent;else if(jb=G.textContent.trim(),!jb||0===jb.length)return;this.PO||(this.PO=this.otc(ta));this.PO.cellText=this.PO.cellText?`${this.PO.cellText}${jb}`:jb;G.parentElement?(ta=this.M2b.czf(G.parentElement))?this.PO=m(G,ta,this.PO,this.AUb,this.dV):I.ULS.sendTraceTag(507536151,0,50,"Computed style is null for parent element"):
I.ULS.sendTraceTag(507536150,0,50,"Parent element is null")}}C3i(G,ta){const jb=G.getAttribute("href");jb&&0<jb.trim().length&&(this.PO||(this.PO=this.otc(ta)),this.PO.OD=jb);this.JPf(G,ta)}pQd(G,ta){this.JGc()||this.a4a();this.dV.push({element:G,sHa:G.style});this.sYb(G,ta);this.dV.pop();this.JGc()||this.a4a()}JPf(G,ta){this.dV.push({element:G,sHa:G.style});this.sYb(G,ta);this.dV.pop()}z5i(G,ta){const jb=this.Cma,sc=this.Fma;this.JGc()||this.a4a();this.dV.push({element:G,sHa:G.style});this.sYb(G,
ta);this.dV.pop();this.Fma=this.eLc;this.Fma===sc&&this.Cma>jb&&this.a4a();this.Cma=jb}y5i(G,ta){const jb=this.Fma;this.AUb=!0;this.dV.push({element:G,sHa:G.style});this.sYb(G,ta);this.dV.pop();this.AUb=!1;this.Fma=jb;this.zdg()}O1i(G){this.PO||(this.PO=this.otc(G));this.AUb?this.PO.cellText=`${this.PO.cellText}\n`:this.a4a()}X2i(G,ta){this.dV.push({element:G,sHa:G.style});this.zSd=[];this.pQd(G,ta);this.dV.pop()}E3i(G,ta){var jb=G.closest("ul, ol");if(jb){this.zSd.push(G);this.JGc()||this.a4a();
var sc=this.Cma;if("OL"===jb.nodeName){jb=this.otc(ta);jb.cellText=`${this.zSd.length}`;const Vc=this.M2b.czf(G);Vc?m(G,Vc,jb,this.AUb,this.dV):I.ULS.sendTraceTag(507536149,0,50,"Computed style is null for list item element");this.zdg()}this.dV.push({element:G,sHa:G.style});this.sYb(G,ta);this.dV.pop();this.Cma=sc;this.a4a()}}IPf(G,ta){switch(G.nodeName){case "#text":this.E5i(G,ta);break;case "A":this.C3i(G,ta);break;case "TR":this.z5i(G,ta);break;case "TD":case "TH":this.y5i(G,ta);break;case "BR":this.O1i(ta);
break;case "UL":case "OL":this.X2i(G,ta);break;case "LI":this.E3i(G,ta);break;case "CAPTION":G.parentElement&&"TABLE"===G.parentElement.nodeName&&this.pQd(G,ta);break;default:G.nodeType===Node.ELEMENT_NODE&&(-1<Ve.indexOf(G.nodeName)?this.pQd(G,ta):-1<vf.indexOf(G.nodeName)&&this.JPf(G,ta))}}};ug=Object(U.__decorate)([Object(za.d)(oa.od),Object(U.__param)(0,Object(oa.Ae)())],ug);Object(D.a)(ug,"HtmlProcessor",null,[]);let ag=class{constructor(G){this.Bi=G;this.yzd()}$vk(G){try{I.ULS.sendTraceTag(507377807,
0,50,"PastableIframe.sanitizeAndAppendPastedHtml: start");const ta=this.Bi.KVi(G);if(this.Kna.contentDocument)return this.Kna.contentDocument.body.replaceWith(ta),this.Kna.contentDocument.body;I.ULS.sendTraceTag(507529291,0,15,"iframe not loaded when append method was called");return ta}catch(ta){return I.ULS.sendTraceTag(507377806,0,10,"PastableIframe.sanitizeAndAppendPastedHtml: Error while sanitizing and appending html to iframe",ta),null}}nEg(){if(this.Kna.contentDocument){var G=this.Kna.contentDocument.body;
G?this.Bi.nM(G):I.ULS.sendTraceTag(507529290,0,15,"iframe body itself is null")}}czf(G){var ta;const jb=null===(ta=this.Kna.contentDocument)||void 0===ta?void 0:ta.body;return(null===jb||void 0===jb?0:jb.contains(G))?getComputedStyle(G):G?G.style:null}yzd(){const G=performance.now();this.Kna=document.createElement("iframe");Object.assign(this.Kna.style,{visibility:"hidden",zIndex:"-100",position:"absolute",contain:"strict"});this.Kna.setAttribute("sandbox","allow-same-origin");this.Kna.setAttribute("data-debug-id",
"paste-iframe");const ta=document.getElementsByTagName("body")[0];ta?ta.appendChild(this.Kna):I.ULS.sendTraceTag(507529289,0,15,"Body not found");I.ULS.sendTraceTag(507529288,0,50,"Time taken to create iframe: "+(performance.now()-G))}};ag=Object(U.__decorate)([Object(za.d)(oa.Ae),Object(U.__param)(0,Object(oa.pd)())],ag);Object(D.a)(ag,"PastableIframe",null,[]);const Dg=()=>rd.a.instance.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),Tg=()=>rd.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");
var ig=a(854),Yg=a(648),vh=a(1177),Zg=a(1054),Qg;(function(G){G[G.vCj=0]="loki";G[G.lll=1]="augloopACLP"})(Qg||(Qg={}));Object(D.b)("AlternateAuthSupportApp",Qg);var Wg=a(602),dh=a(47);class gh{constructor(){this.Token=null;this.ExpirationTime=0}}Object(D.a)(gh,"WacAlternateAuthToken",null,[]);class Gh{constructor(G,ta){this.o0k=3E5;this.w4j=jb=>{let sc=null;({zz:sc}=dh.d(jb));return sc};if(void 0===G||null===G||void 0===ta||null===ta)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ga=G;this.adc=new ig.a(Yg.a.zm());this.kDb=new vh.a(G,ta);void 0!==Wg.a.N3d&&null!==Wg.a.N3d&&void 0!==Wg.a.qMc&&null!==Wg.a.qMc&&0<Wg.a.qMc&&(G=new gh,G.Token=Wg.a.N3d,G.ExpirationTime=Wg.a.qMc,this.adc.ga("loki",G))}zEi(){let G=null;this.adc.lh(Qg[0])&&(G=this.adc.na(Qg[0]));return void 0===G||null===G||this.o_d(G)?this.Rui():Promise.resolve(G.Token)}o_d(G){return G.ExpirationTime-Date.now()<this.o0k}Rui(){const G=new ig.a(Yg.a.zm());G.ga("X-AlternateAuthApp",Qg[0]);return this.kDb.XXa(this.rna("/afhs/AlternateAuthHelperHandler.ashx",
this.Ga.ka("OwlOriginForAFHSIsEnabled")),this.w4j,2,G).then(ta=>{I.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",Qg[0]);this.adc.ga(Qg[0],ta);return ta.Token},ta=>{ta=Object(oe.a)(Zg.a,ta);I.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",ta.message,ta.httpStatusCode);return null})}rna(G,ta){G=String.format("{0}{1}?{2}",ta?this.Ga.Ya("OwlOrigin"):
this.Ga.Ya("WebServiceBase"),G,wa.AFrameworkApplication.Jo);ta&&(G+="&usid="+wa.AFrameworkApplication.userSessionId);return G}}Object(D.a)(Gh,"AlternateAuthHelper",null,[880]);var Ch=a(1169),Dh=a(1390),Xg=a(1413),og=a(282),Ug=a(1306),Rg=a(1305),fi=a(1307),Sg=a(1143);class Bg{constructor(){this.Wh=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}$n(G){this.Wh=G;wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.DemandLoadCloudPolicySettingsHelper",
!1)&&window.IsICloudPolicySettingsHelperRegistered||this.Wh.register(82,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").yi().Ei(()=>wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?Object(Rg.a)():new Dh.a(wa.AFrameworkApplication.fa,wa.AFrameworkApplication.rj));this.Wh.register(83,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").yi().Ei(()=>wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",
!1)?Object(fi.a)():new Xg.a(wa.AFrameworkApplication.fa,wa.AFrameworkApplication.rj));this.Wh.register(880,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").yi().Ei(()=>new Gh(wa.AFrameworkApplication.fa,wa.AFrameworkApplication.rj));this.Wh.register(69,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").yi().Ei(()=>wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?(Tg(),Dg(),Object(Sg.a)()):new Ch.a(wa.AFrameworkApplication.fa,
wa.AFrameworkApplication.rj,Tg(),Dg(),wa.AFrameworkApplication.yh))}init(){wa.AFrameworkApplication.fa.Yx(()=>{const G=rd.a.instance.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");wa.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&(G.isFeatureEnabled("LicensingTestFeature",!1).then(ta=>{I.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",ta,wa.AFrameworkApplication.fa.Ya("IsAnonymousUser"));
return null}),G.getFeatureTier("LicensingTestFeature",0).then(ta=>{I.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",ta,wa.AFrameworkApplication.fa.Ya("IsAnonymousUser"));return null}));rd.a.instance.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.HYk()})}dispose(){}HYk(){try{wa.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&Ug.a.sWg().then(G=>{I.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",G);return G})}catch(G){}}static main(){og.a.instance.Do(new Bg)}}Object(D.a)(Bg,"ApplicationFeatureHelperPackage",null,[11,12]);var zg=a(428),Ng=a(367),Ig=a(366);const bh=G=>{G?(G.isAsyncCopy=!1,G.isSelectionAllowed=!1,G.isFromCache=!1,G.plainTextPayloadSize=0,G.shadowWorkbookPayloadSize=0,G.htmlPayloadSize=0,G.htmlSizeExceedsLimit=!1,G.clientSideCopyTime=0,G.encounteredDeploymentErrors=!1,G.shadowWorkbookSizeExceedsLimit=
!1,G.originalSourceRangesCountExceedsLimit=!1,G.copyTotalSizeExceedsLimit=!1):I.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.")},wh=(G,ta,jb,sc,Vc)=>{const nd=G.Stopwatch,xd={};xd.a=Vc;xd.e=nd.id;xd.c="RearrangeRowColumn";xd.b="mouse";xd.d=G.OperationId.toString();xd.f=jb.toString();xd.g=sc.toString();xd.h=ta.toString();xd.i=G.DragDropIsShiftKeyDown;xd.j=!0;xd.o=nd.zi;xd.q=!1;xd.r=G.CopyPasteTargetType.toString();xd.s=G.EncounteredDeploymentErrors;
return xd};class Ga{constructor(G,ta){this.rBi=()=>{const jb={};jb.SourceItem=this.toString();return jb};this.sessionStateId=G;this.sessionId=ta;this.toJSON=this.rBi}cHc(G){return G?this.sessionStateId===G.sessionStateId&&this.sessionId===G.sessionId:!1}isFromCurrentSession(G){return this.sessionId===G.ua.UserSessionId}}Object(D.a)(Ga,"SourceItem",null,[]);class Qb extends Ga{constructor(G,ta,jb,sc,Vc){super(jb,sc);this.activeFloatingObjectControlId=G;this.sheetName=ta;this.type=Vc}isEqual(G){return G&&
Object.getType(G)===Qb?this.cHc(G)&&this.activeFloatingObjectControlId===G.activeFloatingObjectControlId&&this.sheetName===G.sheetName:!1}toString(){return this.type.toString()}}Object(D.a)(Qb,"ArtSourceItem",Ga,[]);var wc;(function(G){G[G.valid=0]="valid";G[G.notPairwiseDisjoint=1]="notPairwiseDisjoint";G[G.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";G[G.notValidForm=3]="notValidForm";G[G.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(wc||(wc={}));Object(D.b)("CopySourceValidationOptions",
wc);class S extends Ga{constructor(G,ta){super(G,ta)}isEqual(G){return this.cHc(G)}}Object(D.a)(S,"NonGridSourceItem",Ga,[]);class eb extends Ga{constructor(G,ta,jb,sc,Vc){super(sc,Vc);I.ULS.shipAssertTag(537167645,0,!!ta&&0<ta.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=G;this.ranges=ta;this.sheetName=jb}isEqual(G){return G&&Object.getType(G)===eb?this.cHc(G)&&Lb.X(this.ranges,G.ranges)&&this.sheetName===G.sheetName:!1}toString(){return Lb.j(this.ranges,",",this.$,!1)}}
Object(D.a)(eb,"RangeSourceItem",Ga,[]);const ec=G=>!!G&&Object.getType(G)===eb,Lc=G=>!!G&&Object.getType(G)===S;class Ad{}Ad.hbl="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(D.a)(Ad,"ExpectedErrorNames",null,[]);var pd=a(935);const de=G=>G.clipboardItems&&(G=G.clipboardItems.getItem(pd.a.pnj))&&"1"===G?!0:!1,Ge=G=>de(G)&&!(void 0===G.clipboardItems||null===G.clipboardItems)&&!!G.clipboardItems.getItem(pd.a.png)&&!G.clipboardItems.getItem(pd.a.plainText),Re=G=>G.clipboardItems&&
(G=G.clipboardItems.getItem(pd.a.pij))&&"1"===G?!0:!1,kf=G=>G&&(G=G.getCachedMetadata(),null===G||void 0===G?0:G.lastCopy)?G.lastCopy:null;class Xf{constructor(G,ta,jb,sc,Vc){this.$=G;this.zoom=Vc;this.originalDestinations=ta;this.Gxc=jb;this.chh=sc;this.urh=this.originalDestinations;this.dlh=this.Gxc;this.Roh="PasteRecoveryUI"}get zoomManager(){return this.zoom.zoomManager}get HFh(){return this.chh}get O6f(){return this.Roh}get zgk(){return this.urh}get ryf(){return this.dlh}TJa(){return Xf.u5j}cKi(){return this.Gxc&&
1===this.Gxc.length?this.dKi(this.Gxc[0]):null}jLd(){return"PasteRecoveryUI-Floatie"}dKi(G){var ta=ha.f(this.$);const jb=ta.fh.Lo(G);var sc=ta.yl(G,jb);ta=ta.rtl;if(!sc)return null;G=ha.f(this.$).sl(jb);const Vc=G.Vr;if(!Vc.Xi(sc))return null;sc=Vc.Ik(sc);const nd=sc.topLeft.y;var xd=sc.bottomRight.y;const Hd=ta?sc.bottomRight.x:sc.topLeft.x;sc=ta?sc.topLeft.x:sc.bottomRight.x;var ke=new fe.a(sc+(ta?-81:81),xd+38+6);if(Vc.qva(ke))return this.Ulb(G,Vc,jb,sc,xd,ta?12:-3,66);ke=new fe.a(sc+(ta?-81:81),
xd);if(Vc.qva(ke))return this.Ulb(G,Vc,jb,sc,xd,ta?20:3,22);ke=new fe.a(sc,xd+38+6);if(Vc.qva(ke))return this.Ulb(G,Vc,jb,sc,xd,-81+(ta?18:0),66);sc=new fe.a(Hd+(ta?81:-81),xd);if(Vc.qva(sc))return this.Ulb(G,Vc,jb,Hd,xd,-81+(ta?12:-6),22);xd=new fe.a(Hd,nd-38-6);return Vc.qva(xd)?this.Ulb(G,Vc,jb,Hd,nd,ta?15:0,16):this.Ulb(G,Vc,jb,ta?Vc.topLeft.x:Vc.bottomRight.x,Vc.bottomRight.y,-81+(ta?15:-6),22)}Ulb(G,ta,jb,sc,Vc,nd,xd){var Hd=ha.f(this.$);const ke=Hd.rtl;G=Sys.UI.DomElement.getLocation(G.domElement);
sc=new Sys.UI.Point(sc+(ke?0:G.x)-ta.topLeft.x,Vc+G.y-ta.topLeft.y);ke&&(Hd=Hd.view.visibleArea,sc.x=Hd.bottomRight.x-Hd.topLeft.x-sc.x,2===jb||4===jb)&&(sc.x+=ta.bottomRight.x);sc=this.zoomManager.Dga(sc);return new Sys.UI.Point(sc.x+nd,sc.y+xd)}}Xf.u5j=["PasteRecoveryUI"];Object(D.a)(Xf,"PasteRecoveryUI",null,[923]);var kg=a(651);class Yf{}Yf.Dwh="ActiveSelection";Yf.shadowWorkbook="ShadowWorkbook";Yf.Jch="GVML";Yf.plainText="PlainText";Yf.html="Html";Yf.BMh="Bitmap";Object(D.a)(Yf,"PayloadType",
null,[]);class eh{}eh.DSk="Slice6";Object(D.a)(eh,"SliceName",null,[]);class jg{}jg.KKj="NotCalled";jg.success="Success";jg.failed="Failed";Object(D.a)(jg,"SucceededPopulatingSystemClipboardOptions",null,[]);var Se=a(318);const P=(G,ta)=>G?ta&&ta.ua?G.sessionId!==ta.ua.UserSessionId:(I.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(I.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),Da=G=>{switch(G){case 0:return"None";case 2:return"Art";case 1:return"Range";
default:return"Unknown"}},ib=G=>{if(!G)return"null";const ta=[];for(const jb of G.get())ta.push(`${jb.clipboardDataFormat}(${jb.data.length})`);ta.sort();return ta.join(",")};var ic;(function(G){G[G.valid=0]="valid";G[G.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";G[G.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";G[G.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";G[G.multipleSourcesAndMultipleDestinationsAreNotSupported=
4]="multipleSourcesAndMultipleDestinationsAreNotSupported";G[G.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";G[G.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";G[G.copySourceNotValid=7]="copySourceNotValid";G[G.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";G[G.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";G[G.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";
G[G.unknown=100]="unknown"})(ic||(ic={}));Object(D.b)("PasteValidationOptions",ic);var Rc=a(243),kd=a(143),td=a(129),Z=a(665),Ha=a(106);class Mb extends Sys.EventArgs{constructor(G,ta,jb){super();this.command=G;this.destinationRange=ta;this.sourceRange=jb}}Object(D.a)(Mb,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var Zb=a(141);class gd extends Xf{constructor(G,ta,jb,sc,Vc){super(G,ta,jb,sc,Vc);this.vwj="DragRecoveryUI"}get O6f(){return this.vwj}TJa(){return gd.hii}jLd(){return"DragRecoveryUI-Floatie"}}
gd.hii=["DragRecoveryUI"];Object(D.a)(gd,"DragFillRecoveryUI",Xf,[]);var Nd=a(759),ae=a(429);class qe extends ae.a{constructor(G,ta,jb){super(G);this.Ph=0;this.initializeAndShow(ka.a.instance.ia(1060),ta,jb)}get Di(){return"CopyPasteShortcutReactDialog"}}Object(D.a)(qe,"CopyPasteShortcutReactDialog",ae.a,[]);var Le=a(430);class Je{constructor(G){this.mK=null;this.oXa=ta=>{this.mK(1===ta?Je.uLb:Nd.a[ta],!1);Je.uia=!1};this.$=G}showDialog(G,ta,jb,sc){this.mK=sc;Je.OWb=da.a.isMac||da.a.oo;this.mK||(this.mK=
()=>{});Je.uia?sc(Je.tLb,!1):(Je.uia=!0,ta={},G?(ta.forwardElementText=ka.a.instance.ia(1061),ta.cutText=Je.OWb?ka.a.instance.ia(1050):ka.a.instance.ia(1062),ta.copyText=Je.OWb?ka.a.instance.ia(1051):ka.a.instance.ia(1063),ta.pasteText=Je.OWb?ka.a.instance.ia(1052):ka.a.instance.ia(1064),ta.pasteTextOnly=Je.OWb?ka.a.instance.ia(1055):ka.a.instance.ia(1065)):(ta.forwardElementText=ka.a.instance.ia(1066),ta.cutText=ka.a.instance.ia(1067)),new qe(this.$,this.oXa,{[Le.a.xy]:Je.id,["bodyControls"]:ta}))}}
Je.uia=!1;Je.OWb=!1;Je.tLb="notOpened";Je.uLb="ok";Je.id="CopyPasteShortcutDialog";Object(D.a)(Je,"CopyPasteShortcutDialog",null,[922]);class cf extends ae.a{constructor(G,ta,jb){super(G);this.Ph=0;this.ti(1,ka.a.instance.ia(1054));this.dja(1);this.initializeAndShow(ka.a.instance.ia(1046),ta,jb)}get Di(){return"CopyPasteInstallReactDialog"}}Object(D.a)(cf,"CopyPasteInstallReactDialog",ae.a,[]);class If{constructor(G){this.mK=null;this.oXa=ta=>{1===ta?(I.ULS.sendTraceTag(508359137,0,50,"User clicked the install button"),
this.N4h(),this.c8j(),this.mK(If.uLb,!0)):(I.ULS.sendTraceTag(508359136,0,50,"User clicked the cancel button"),this.mK(Nd.a[ta],!1));If.uia=!1};this.$=G}showDialog(G,ta,jb,sc){this.mK=sc=void 0===sc?()=>{}:sc;ta=da.a.isMac||da.a.oo;If.uia?sc(If.tLb,!1):(If.uia=!0,sc={},G&&(sc.extensionStartText=sc.extensionStartText=da.a.GIc?ka.a.instance.ia(1048):ka.a.instance.ia(1047),sc.extensionLink=null,sc.extensionEndText=null,sc.shortcutsMessageText=ka.a.instance.ia(1049),sc.cutText=ta?ka.a.instance.ia(1050):
ka.a.instance.ia(1062),sc.copyText=ta?ka.a.instance.ia(1051):ka.a.instance.ia(1063),sc.pasteText=ta?ka.a.instance.ia(1052):ka.a.instance.ia(1064),sc.pasteTextOnly=ta?ka.a.instance.ia(1055):ka.a.instance.ia(1065)),new cf(this.$,this.oXa,{[Le.a.xy]:If.id,["bodyControls"]:sc}))}N4h(){void za.a.resolve(oa.C,{va:0}).then(G=>{G.Om(68,null)})}c8j(){const G=this.$.ua;wb.a.Cm(`${G.ChromeClipboardAccessExtensionLink}${da.a.GIc?G.ChromeClipboardAccessExtensionId:G.OfficeOnlineChromeExtensionId}`,"_blank",void 0,
"ChromeCCPInstallDialog")}}If.uia=!1;If.tLb="notOpened";If.uLb="ok";If.id="CopyPasteInstallDialog";Object(D.a)(If,"CopyPasteInstallDialog",null,[922]);class Pf extends Sys.EventArgs{constructor(G,ta){super();this.Wdi=G;this.Qo=ta}}Object(D.a)(Pf,"PasteSucceededEventArgs",Sys.EventArgs,[]);var Zf=a(156);class $e extends ae.a{constructor(G,ta,jb){super(G);this.Ph=0;wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?this.ti(1,CommonUiStrings.DialogOk):this.ti(1,CommonUIStrings.l_DialogOk);this.dja(1);
this.initializeAndShow(ka.a.instance.ia(2390),ta,jb)}get Di(){return"CopyPasteNoClipboardAccessReactDialog"}}Object(D.a)($e,"CopyPasteNoClipboardAccessReactDialog",ae.a,[]);class zf{constructor(G){this.mK=null;this.oXa=ta=>{1===ta?this.mK(zf.uLb,!0):this.mK(Nd.a[ta],!1);zf.uia=!1;this.Fyd&&URL.revokeObjectURL(this.Fyd)};this.$=G}showDialog(G,ta,jb,sc){this.mK=sc=void 0===sc?()=>{}:sc;ta=da.a.isMac||da.a.oo;zf.uia?sc(zf.tLb,!1):(zf.uia=!0,sc={},G&&(sc.startText=ka.a.instance.ia(2391),sc.endText=ka.a.instance.ia(2392),
wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?(sc.cutText=CommonUiStrings.CutString,sc.copyText=CommonUiStrings.CopyString,sc.pasteText=CommonUiStrings.PasteString,sc.cutShortcutText=ta?CommonUiStrings.CutShortcut_Mac:CommonUiStrings.CutShortcut,sc.copyShortcutText=ta?CommonUiStrings.CopyShortcut_Mac:CommonUiStrings.CopyShortcut,sc.pasteShortcutText=ta?CommonUiStrings.PasteShortcut_Mac:CommonUiStrings.PasteShortcut,sc.imageAltText=CommonUiStrings.NoClipboardAccessDialogImageAltText,sc.primaryButtonLabel=
CommonUiStrings.DialogOk):(sc.cutText=CommonUIStrings.l_CutString,sc.copyText=CommonUIStrings.l_CopyString,sc.pasteText=CommonUIStrings.l_PasteString,sc.cutShortcutText=ta?CommonUIStrings.l_CutShortcut_Mac:CommonUIStrings.l_CutShortcut,sc.copyShortcutText=ta?CommonUIStrings.l_CopyShortcut_Mac:CommonUIStrings.l_CopyShortcut,sc.pasteShortcutText=ta?CommonUIStrings.l_PasteShortcut_Mac:CommonUIStrings.l_PasteShortcut,sc.imageAltText=CommonUIStrings.l_NoClipboardAccessDialogImageAltText,sc.primaryButtonLabel=
CommonUIStrings.l_DialogOk),this.Fyd=URL.createObjectURL(new Blob(['\n<svg width="440" height="114" viewBox="0 0 457 114" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g filter="url(#filter0_dd_2_4645)">\n<rect x="15" y="8" width="427" height="85" rx="8" fill="#F3F3F3"/>\n<g clip-path="url(#clip0_2_4645)">\n<rect x="15" y="8" width="427" height="40" fill="#CECECE"/>\n<mask id="mask0_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="15" y="40" width="427" height="12">\n<rect x="15" y="40" width="427" height="12" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask0_2_4645)">\n<g filter="url(#filter1_dd_2_4645)">\n<rect x="15" y="48" width="427" height="4" fill="#F3F3F3"/>\n</g>\n</g>\n<mask id="mask1_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="23" y="12" width="256" height="36">\n<rect x="23" y="12" width="256" height="36" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask1_2_4645)">\n<g filter="url(#filter2_dd_2_4645)">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M31 24C31 19.5817 34.5817 16 39 16H263C267.418 16 271 19.5817 271 24V40C271 44.4183 274.582 48 279 48V52H271H31H23V48C27.4183 48 31 44.4183 31 40V24Z" fill="#F3F3F3"/>\n</g>\n</g>\n<g clip-path="url(#clip1_2_4645)">\n<path d="M251.089 28.2157L251.146 28.1464C251.32 27.9729 251.589 27.9536 251.784 28.0886L251.854 28.1464L255 31.293L258.146 28.1464C258.342 27.9512 258.658 27.9512 258.854 28.1464C259.049 28.3417 259.049 28.6583 258.854 28.8536L255.707 32L258.854 35.1464C259.027 35.32 259.046 35.5894 258.911 35.7843L258.854 35.8536C258.68 36.0271 258.411 36.0464 258.216 35.9114L258.146 35.8536L255 32.707L251.854 35.8536C251.658 36.0488 251.342 36.0488 251.146 35.8536C250.951 35.6583 250.951 35.3417 251.146 35.1464L254.293 32L251.146 28.8536C250.973 28.68 250.954 28.4106 251.089 28.2157L251.146 28.1464L251.089 28.2157Z" fill="#1A1A1A"/>\n</g>\n<g clip-path="url(#clip2_2_4645)">\n<path d="M55 28.6641V32L52.3359 33L49.6641 32L43 28.6641V25.3359C43 25.1484 43.0651 24.9896 43.1953 24.8594C43.3255 24.7292 43.4818 24.6641 43.6641 24.6641H49.6641L55 28.6641Z" fill="#21A366"/>\n<path d="M55 25.3359V28.6641H49.6641V24.6641H54.3359C54.4245 24.6641 54.5104 24.6823 54.5938 24.7188C54.6719 24.7552 54.7422 24.8047 54.8047 24.8672C54.862 24.9245 54.9089 24.9948 54.9453 25.0781C54.9818 25.1562 55 25.2422 55 25.3359Z" fill="#33C481"/>\n<path d="M55 35.3359V38.6641C55 38.8516 54.9349 39.0104 54.8047 39.1406C54.6745 39.2708 54.5182 39.3359 54.3359 39.3359H43.6641C43.4818 39.3359 43.3255 39.2708 43.1953 39.1406C43.0651 39.0104 43 38.8516 43 38.6641V35.375V32H49.6641L55 35.3359Z" fill="#185C37"/>\n<path d="M49.6641 28.6797V32H43V28.6797H49.6641ZM55 35.3359H49.6641V32.0078H55V35.3359Z" fill="black" fill-opacity="0.5"/>\n<path d="M48.2188 28C48.4375 28 48.6224 28.0755 48.7734 28.2266C48.9245 28.3776 49 28.5625 49 28.7812V36.4297C49 36.5391 48.974 36.6484 48.9219 36.7578C48.8698 36.862 48.7995 36.9583 48.7109 37.0469C48.6224 37.1302 48.5234 37.2005 48.4141 37.2578C48.2995 37.3099 48.1849 37.3359 48.0703 37.3359H43V28H48.2188Z" fill="black" fill-opacity="0.498"/>\n<path d="M47.5547 36.6641H39.7812C39.5625 36.6641 39.3776 36.5911 39.2266 36.4453C39.0755 36.2943 39 36.1094 39 35.8906V28.1094C39 27.8906 39.0755 27.7083 39.2266 27.5625C39.3776 27.4115 39.5625 27.3359 39.7812 27.3359H47.5547C47.7734 27.3359 47.9583 27.4115 48.1094 27.5625C48.2604 27.7083 48.3359 27.8906 48.3359 28.1094V35.8906C48.3359 36.1094 48.2604 36.2943 48.1094 36.4453C47.9583 36.5911 47.7734 36.6641 47.5547 36.6641Z" fill="#107C41"/>\n<path d="M41.2812 34.6641L43.0078 31.9922L41.4297 29.3359H42.7031L43.5625 31.0312C43.6042 31.1146 43.638 31.1849 43.6641 31.2422C43.6849 31.2995 43.7057 31.349 43.7266 31.3906H43.7422C43.7682 31.3281 43.7969 31.2656 43.8281 31.2031C43.8542 31.1406 43.8854 31.0781 43.9219 31.0156L44.8438 29.3359H46.0078L44.3828 31.9766L46.0469 34.6641H44.8047L43.8125 32.7969C43.7656 32.7292 43.724 32.6458 43.6875 32.5469H43.6719C43.6615 32.5781 43.6484 32.6146 43.6328 32.6562C43.612 32.6927 43.5885 32.737 43.5625 32.7891L42.5312 34.6641H41.2812Z" fill="white"/>\n</g>\n<rect x="67" y="29" width="96" height="6" rx="3" fill="#B2AFAC"/>\n<path d="M289 24.5C289 24.2239 288.776 24 288.5 24C288.224 24 288 24.2239 288 24.5V31H281.5C281.224 31 281 31.2239 281 31.5C281 31.7761 281.224 32 281.5 32H288V38.5C288 38.7761 288.224 39 288.5 39C288.776 39 289 38.7761 289 38.5V32H295.5C295.776 32 296 31.7761 296 31.5C296 31.2239 295.776 31 295.5 31H289V24.5Z" fill="#1A1A1A"/>\n</g>\n<rect x="15" y="48" width="427" height="38" fill="#F3F3F3"/>\n<rect x="15" y="86" width="427" height="1" fill="#CCCCCC"/>\n<path d="M42.159 73.3666C42.3629 73.5528 42.6792 73.5384 42.8654 73.3345C43.0515 73.1305 43.0371 72.8143 42.8332 72.6281L36.6653 66.9974H50.4961C50.7722 66.9974 50.9961 66.7735 50.9961 66.4974C50.9961 66.2212 50.7722 65.9974 50.4961 65.9974H36.6682L42.8332 60.3693C43.0371 60.1831 43.0515 59.8668 42.8654 59.6629C42.6792 59.459 42.3629 59.4446 42.159 59.6307L35.2426 65.9448C35.1027 66.0725 35.0229 66.2401 35.0031 66.4132C34.9985 66.4406 34.9961 66.4687 34.9961 66.4974C34.9961 66.5242 34.9982 66.5506 35.0023 66.5763C35.0205 66.7522 35.1006 66.9229 35.2426 67.0526L42.159 73.3666Z" fill="#1A1A1A"/>\n<g opacity="0.3">\n<path d="M87.8371 59.6307C87.6332 59.4446 87.3169 59.459 87.1307 59.6629C86.9446 59.8668 86.959 60.1831 87.1629 60.3693L93.3307 66H79.5C79.2239 66 79 66.2239 79 66.5C79 66.7761 79.2239 67 79.5 67H93.3279L87.1629 72.6281C86.959 72.8143 86.9446 73.1305 87.1307 73.3345C87.3169 73.5384 87.6332 73.5528 87.8371 73.3666L94.7535 67.0526C94.8934 66.9248 94.9732 66.7573 94.993 66.5841C94.9976 66.5568 95 66.5287 95 66.5C95 66.4731 94.9979 66.4468 94.9938 66.421C94.9756 66.2451 94.8955 66.0745 94.7535 65.9448L87.8371 59.6307Z" fill="#1A1A1A"/>\n</g>\n<path d="M124.066 66.05C124.59 62.2198 128.121 59.5401 131.951 60.0648C133.894 60.3309 135.54 61.3695 136.623 62.8297L136.749 63H133.5C133.224 63 133 63.2239 133 63.5C133 63.7761 133.224 64 133.5 64H137.5C137.776 64 138 63.7761 138 63.5V59.5C138 59.2239 137.776 59 137.5 59C137.224 59 137 59.2239 137 59.5V61.7073C135.776 60.3185 134.065 59.3451 132.087 59.074C127.709 58.4744 123.675 61.5369 123.075 65.9143C122.475 70.2917 125.538 74.3264 129.915 74.926C134.293 75.5256 138.327 72.4631 138.927 68.0857C139.001 67.5445 139.019 67.0079 138.986 66.4821C138.968 66.2065 138.73 65.9974 138.455 66.015C138.179 66.0326 137.97 66.2703 137.988 66.5459C138.017 67.0055 138.001 67.4752 137.936 67.95C137.412 71.7802 133.881 74.4599 130.051 73.9353C126.221 73.4106 123.541 69.8802 124.066 66.05Z" fill="#1A1A1A"/>\n<g filter="url(#filter3_d_2_4645)">\n<rect x="159" y="52" width="275" height="30" rx="8" fill="#FBFBFB"/>\n</g>\n<rect x="171" y="55" width="27" height="24" rx="4" fill="#F3F2F1"/>\n<path d="M190.051 65.3663V73H178.527V65.3663H180.686V62.1832C180.686 61.7458 180.782 61.3333 180.973 60.9457C181.159 60.558 181.415 60.2201 181.741 59.9318C182.067 59.6436 182.45 59.4175 182.888 59.2535C183.327 59.0845 183.794 59 184.289 59C184.784 59 185.251 59.0845 185.689 59.2535C186.128 59.4175 186.51 59.6436 186.837 59.9318C187.163 60.2201 187.422 60.558 187.613 60.9457C187.798 61.3333 187.891 61.7458 187.891 62.1832V65.3663H190.051ZM181.412 65.3663H187.166V62.1832C187.166 61.8353 187.09 61.5073 186.938 61.1991C186.786 60.886 186.581 60.6152 186.322 60.3866C186.063 60.158 185.76 59.9766 185.411 59.8424C185.057 59.7082 184.683 59.6411 184.289 59.6411C183.889 59.6411 183.515 59.7082 183.167 59.8424C182.818 59.9766 182.514 60.158 182.256 60.3866C181.997 60.6152 181.792 60.886 181.64 61.1991C181.488 61.5073 181.412 61.8353 181.412 62.1832V65.3663ZM189.325 66H179.252V72.3589H189.325V66Z" fill="black"/>\n</g>\n<defs>\n<filter id="filter0_dd_2_4645" x="0.6" y="4.76837e-07" width="455.8" height="113.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="6.4"/>\n<feGaussianBlur stdDeviation="7.2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="1.2"/>\n<feGaussianBlur stdDeviation="1.8"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter1_dd_2_4645" x="7.8" y="44" width="441.4" height="18.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter2_dd_2_4645" x="15.8" y="12" width="270.4" height="50.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter3_d_2_4645" x="155" y="50" width="283" height="38" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="2"/>\n<feGaussianBlur stdDeviation="2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_2_4645" result="shape"/>\n</filter>\n<clipPath id="clip0_2_4645">\n<path d="M15 16C15 11.5817 18.5817 8 23 8H434C438.418 8 442 11.5817 442 16V48H15V16Z" fill="white"/>\n</clipPath>\n<clipPath id="clip1_2_4645">\n<rect width="12" height="12" fill="white" transform="translate(249 26)"/>\n</clipPath>\n<clipPath id="clip2_2_4645">\n<rect width="16" height="16" fill="white" transform="translate(39 24)"/>\n</clipPath>\n</defs>\n</svg>\n'],
{type:"image/svg+xml"})),sc.imageSrc=this.Fyd,sc.learnMoreLink=null),new $e(this.$,this.oXa,{[Le.a.xy]:zf.id,["bodyControls"]:sc}))}}zf.uia=!1;zf.tLb="notOpened";zf.uLb="ok";zf.id="CopyPasteNoClipboardAccessDialog";Object(D.a)(zf,"CopyPasteNoClipboardAccesslDialog",null,[922]);var Rf=a(200),Sf=a(72),yg=a(66),$g;(function(G){G[G.source=0]="source";G[G.destination=1]="destination"})($g||($g={}));Object(D.b)("RangeType",$g);class rf extends pb.a{constructor(G,ta,jb,sc,Vc,nd,xd,Hd,ke,V,Wa,Eb){Eb=void 0===
Eb?null:Eb;super();this.q0g=this.r0g=this.vtb=this.vOb=null;this.jpb=!1;this.J2a=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StickyFormattingEnabled",!1);this.eqf=()=>{var Jc;(null===(Jc=this.vOb)||void 0===Jc?0:Jc.U1f())&&!Lb.X(ha.f(this.$).ha.qa.selectedRanges,this.vOb.bLc)&&(this.vOb.Uva(),this.vOb=null);this.da.ha.vx(this.eqf)};this.C$d=Jc=>{this.JKk(Jc)&&(this.kA.PRd(),I.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
this.PBj=(Jc,od)=>{I.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${Jc}]. userPressedExtensionLink=${od}`);this.da.focus()};this.PAj=(Jc,od)=>{I.ULS.sendTraceTag(508130372,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got No Clipboard Access Dialog, user pressed [${Jc}]. userPressedOK=${od}`);this.da.focus()};this.Cj=(Jc,od)=>{od.q1||od.dm||this.Nx("OnWorkbookOpened",!1).catch(()=>{})};this.wq=(Jc,od)=>
{Jc=kf(this.TK);const Pd=this.kA.eCc(Jc);Pd&&(od.ma&&od.ma.sheetName===Pd.sheetName&&Pd.isFromCurrentSession(this.$)?this.kA.ESf(Pd.ranges,Jc.commandParameters.commandType):this.kA.PRd())};this.BPc=(Jc,od)=>{Jc=kf(this.TK);(Jc=this.kA.eCc(Jc))&&od.item&&od.item.sheetName===Jc.sheetName&&Jc.isFromCurrentSession(this.$)&&this.Nx("OnItemDeleting",!1).catch(()=>{})};this.k7=()=>{this.r0g()};this.cZ=()=>{this.q0g()};this.O1=(Jc,od)=>{1===od.tx&&od.Ul.operation.flags&2&&this.Nx("OnQueueItemChanged/ItemRemoved",
!1).catch(()=>{})};this.$=G;this.zoom=ke;this.zqh=Wa;this.yk=jb;this.da=ha.f(G);this.kA=Vc;this.sej=nd;this.TK=ta;this.RXa=sc;this.mTf=V;this.getStringifiedError=Eb||copyPasteInfra.getStringifiedError;this.PTg=1===Hd;this.Hp();xd||(I.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),xd=rf.Gci);this.userHash=ea.a.qE(xd);this.rGj="CultureTag: "+ka.a.instance.Buc+" HASH: ";this.TK.addMetadataChangeListener(rf.Tcg,this.C$d);this.vFj=this.$.ua.CCPPastePlainTextLimit;
this.q_b=this.$.ua.CCPCopyPasteHtmlLimit;void za.a.sj(oa.Ce).then(Jc=>{this.vtb=Jc});this.r0g=Rc.b(()=>{this.J_j()},1,this.$.ya,"CopyPasteInfrastructure.OnStartEditInternal",!0);this.q0g=Rc.b(()=>{this.xRj()},1,this.$.ya,"CopyPasteInfrastructure.onEndEditInternal",!0)}get lvj(){return this.Moh}qIa(){var G=kf(this.TK);return G?(G=G.sourceItem)&&!G.isFromCurrentSession(this.$)?(I.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return oa.Be.Aa()?this.zqh:this.$.la.kh(373)}PDh(G){this.addHandler(rf.Hae,G)}Knk(G){this.removeHandler(rf.Hae,G)}Xmc(G){this.addHandler(rf.l6c,G)}Rnk(G){this.removeHandler(rf.l6c,G)}copy(G){G.stopwatch=this.$.Eh.Li("UserAction",Ff.b().zp(G.ribbonCommandInfo.command)+"ClientSide");void za.a.resolve(oa.Ce).then(nd=>{this.vtb=nd});const ta=!!kf(this.TK);kg.a.d1a&&(this.jpb=!1);this.Nx("Copy/before/"+Ng.a[G.ribbonCommandInfo.method],!1,void 0,!0,G.copyPasteTargetType).catch(()=>
{});var jb=-1985798686===G.ribbonCommandInfo.command;if(1===this.da.Ck&&(jb=this.kA.bYf(this.da.ha.qa.selectedRanges,jb),0!==jb)){const nd=rf.i2h(jb);this.mOa(nd,wc[jb],!1);return Promise.reject(!1)}G.userHash=this.userHash;G.id=Oc.a.create().toString();const sc=this,Vc=this;return this.RXa.onCopy(G).then(nd=>{var xd;nd.isAsyncCopy||G.stopwatch.stop();sc.pasteIndicationManager.XCd();var Hd=Se.d(G);I.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${Hd}`);
sc.Bzj(nd,ta);Hd=1===G.copyPasteTargetType;!G.isFormatPainter&&Hd&&(sc.vtb?sc.vtb.Rki():I.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));xa.EwaSettings.lba()&&ec(nd.sourceItem)&&1===nd.sourceItem.ranges.length&&(nd=nd.sourceItem.ranges[0],Hd=this.da.za.gxa(nd,this.$.activeItemName),nd=null===Hd||void 0===Hd?void 0:Hd.tB(nd),this.Moh=null===(xd=null===nd||void 0===nd?void 0:nd.formattedText)||void 0===xd?void 0:xd.Text);return Promise.resolve(!0)},nd=>{let xd=!1,Hd="none",
ke=rf.Bib,V=!0,Wa=-1,Eb=rf.copyErrorName+rf.NIa,Jc=!1,od=null;if(nd){od=nd.copyContext;Wa=nd.reason;Eb+=rf.dKa(nd);nd.message&&(ke=nd.message);var Pd=rf.h2h(nd);if(Pd)if(3===Pd.copyErrorName)xd=!0,ke=Hd="Async Copy canceled by the user.",V=!1;else if(be.a.Lx(Pd.ewaErrors))if(ke=Vc.QAc(Pd.ewaErrors),be.a.ko(Pd.ewaErrors,rf.operationSucceededWithAlert))Jc=xd=!0;else if(be.a.ko(Pd.ewaErrors,rf.pasteDataLimitHit)||be.a.ko(Pd.ewaErrors,rf.copyThrottlingError))xd=!0;13===nd.reason?(xd=!0,V=!1):11===nd.reason&&
(V=!1)}Pd=nd?Vc.getStringifiedError(nd):"null";xd?(Pd=Se.d(G),I.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${V}, Friendly message: ${Hd}, Error Message: ${ke}, CommandParameters: ${Pd}`)):I.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${V}, Error Message: ${Pd}, CommandParameters: ${Se.d(G)}`);V&&Vc.Nx("Copy/fail/"+Ng.a[G.ribbonCommandInfo.method],
!0,void 0,void 0,G.copyPasteTargetType).catch(()=>{});Vc.F8f(G,xd,ke,Eb,Wa,Jc,od);return Promise.reject(nd)})}writeToClipboard(G){G.stopwatch=this.$.Eh.Li("UserAction",Ff.b().zp(G.ribbonCommandInfo.command)+"ClientSide");this.Nx("Copy/before/"+Ng.a[G.ribbonCommandInfo.method],!1,void 0,!0,G.copyPasteTargetType).catch(()=>{});G.userHash=this.userHash;G.id=Oc.a.create().toString();return this.RXa.onCopy(G).then(()=>{G.stopwatch.stop();return Promise.resolve(!0)},ta=>{let jb=rf.Bib,sc=-1,Vc=rf.copyErrorName+
rf.NIa,nd=null;ta&&(nd=ta.copyContext,sc=ta.reason,Vc+=rf.dKa(ta),ta.message&&(jb=ta.message));const xd=Se.d(G);I.ULS.sendTraceTag(508074081,0,15,`CopyPasteInfrastructure.writeToClipboard: Copy operation failed with an error. Error Message: ${jb}, CommandParameters: ${xd}`);this.F8f(G,!1,jb,Vc,sc,!1,nd);return Promise.reject(ta)})}O5j(G){if(this.qIa())return mc.a(this.$Td(G.commandType,G.ribbonCommandInfo));const ta=Lb.d(this.da.ha.qa.selectedRanges);G.originalDestinations=ta;G.expandDestinations=
this.Ypc(G.originalDestinations,G.commandType);if(this.iqc(G.commandType,G.expandDestinations)||this.Ncf())G.userHash=this.userHash,G.id=Oc.a.create().toString(),this.RXa.onPaste(G).then(()=>Promise.resolve(!0),jb=>Promise.reject(jb));return Promise.resolve(!0)}L5j(G){const ta=Se.b();ta.ribbonCommandInfo=G;ta.userHash=this.userHash;ta.id=Oc.a.create().toString();ta.isKeyboardEvent=!1;ta.copyPasteTargetType=this.sMa();ta.skipSystemClipboardAccess=!1;ta.stopwatch=this.$.Eh.Li("UserAction",Ff.b().zp(ta.ribbonCommandInfo.command)+
"ClientSide");this.Nx("CopyPasteInfrastructure.performFullSheetCopy",!1).catch(jb=>Promise.reject(jb));return this.RXa.onCopy(ta).then(()=>{const jb=Se.d(ta);I.ULS.sendTraceTag(507818122,0,50,`CopyPasteInfrastructure.performFullSheetCopy: Operation finished successfully. ${jb}`);return Promise.resolve(!0)},jb=>Promise.reject(jb))}M5j(G,ta){if(this.qIa())return Promise.resolve(null);const jb=Se.c();jb.ribbonCommandInfo=G;jb.id=Oc.a.create().toString();jb.clearStateOnFinish=!1;jb.isKeyboardEvent=this.qob(G,
ta);jb.skipClipboardAccess=Rf.d(ta,Y.a.skipClipboardAccess);jb.copyPasteTargetType=this.sMa();jb.skipSystemClipboardAccess=!1;return this.RXa.onPaste(jb).then(sc=>sc).catch(sc=>Promise.reject(sc))}FHc(){var G;return null===(G=kf(this.TK))||void 0===G?void 0:G.isFullSheetCopy}yIi(){var G;return null===(G=kf(this.TK))||void 0===G?void 0:G.sourceItem.sheetName}ikg(G,ta){if(G.method){var jb=new gd(this.$,Lb.d(this.da.ha.qa.selectedRanges),Lb.d(this.da.ha.qa.selectedRanges),{},this.zoom);(sc=>{const Vc=
Object(mc.d)(za.a.resolve(oa.lf,{va:0}));Db.TaskExtensions.Xa(Vc,()=>{G.method&&sc(Vc.result)},this.ya,8)})(sc=>{sc.dtd(jb);sc.yte(G.method,ta);this.vOb=sc});I.ULS.sendTraceTag(508680074,0,50,"CopyPasteInfrastructure.OnFill: Drag Copy Fill Floatie");this.da.ha.Zw(this.eqf)}}paste(G){G.stopwatch=this.$.Eh.Li("UserAction",Ff.b().zp(G.ribbonCommandInfo.command)+"ClientSide");kg.a.d1a&&(I.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.jpb=
!1);ha.f(this.$).Hk&&ha.f(this.$).Hk.lQ(this.yNd(G.ribbonCommandInfo.command),G.stopwatch.id);if(G.isPasteCommandFromRecoveryUI){var ta=za.a.nh(oa.lf);var jb=Lb.d(ta.bLc);if(!jb)return I.ULS.sendTraceTag(508699777,0,20,"RecoveryUI paste destinations must not be null or undefined"),Promise.resolve(!0);ta=ta.K0d;G.pasteRecoveryCachedClipboardItems=ta?ta[rf.rug]:null}else jb=Lb.d(this.da.ha.qa.selectedRanges);G.originalDestinations=jb;G.expandDestinations=this.Ypc(G.originalDestinations,G.commandType);
if(this.iqc(G.commandType,G.expandDestinations)||this.Ncf())return G.userHash=this.userHash,G.id=Oc.a.create().toString(),Vg(this.$)&&(G.isAsyncSystemClipboardEnabled=!0),this.RXa.onPaste(G).then(sc=>this.cQc(sc,G),sc=>this.D1b(G,sc));this.$.si(927125067,jd.a.rh,30,null);jb=Lb.j(G.expandDestinations,",",this.$,!1);I.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${jb}, CommandType: ${G.commandType}, copyPasteTargetType="${G.copyPasteTargetType}"`);
return Promise.resolve(!0)}yNd(G){switch(G){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}Ncf(){return!!ha.f(this.$).ha.$e.activeFloatingObjectControlId&&this.$.uy(null,!1,470)}sMa(){const G=kf(this.TK);return G&&G.commandParameters?G.commandParameters.copyPasteTargetType:0}onj(){return!!kf(this.TK)&&P(kf(this.TK),this.$)}Nx(G,ta,jb,sc,Vc){jb=void 0===jb?!1:jb;sc=void 0===sc?!1:sc;Vc=void 0===Vc?0:Vc;try{this.vtb&&this.vtb.ovc();
let nd=Vc;const xd=this.mvj();if(!sc&&2===xd)return I.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${ta}', isExplicit = '${jb}', isForce = '${sc}', Current CCP operation copyPasteTargetType = '${Vc}', LastCopyPasteTargetType = '${xd}'`),Promise.reject(null);0===nd&&(nd=xd);const Hd=this.$.Eh.Li("UserAction","ClearCopyState"),ke=Hd.id;I.ULS.sendTraceTag(537167820,0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${ta}', isExplicit = '${jb}', isForce = '${sc}', Current CCP operation copyPasteTargetType = '${Vc}', LastCopyPasteTargetType = '${xd}'`);
this.kA.PRd();this.zdk();return this.RXa.onCancelCopy(ta).then(()=>{ta&&kg.a.d1a&&(this.jpb=!1);Hd.stop();this.E8f(G,ke,!0,jb,ta,"","",Hd.zi,nd);return Promise.resolve(!0)},V=>{var Wa=V?this.getStringifiedError(V):"null";I.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${Wa}`);Hd.stop();Wa=rf.YTh+rf.NIa;let Eb=rf.Bib;V&&(Wa+=rf.dKa(V),V.message&&(Eb=V.message));this.E8f(G,ke,!1,jb,ta,Eb,Wa,Hd.zi,nd);return Promise.reject(V)})}catch(nd){return Promise.reject(null)}}wwd(G,
ta,jb,sc){var Vc=void 0;Vc=void 0===Vc?!1:Vc;jb=void 0===jb?!1:jb;sc=void 0===sc?0:sc;return jb||this.qIa()?this.Nx(G,ta,Vc,jb,sc):(I.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}mOa(G,ta,jb){I.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${ta}`);
const sc=new Ha.a;sc.ga("reason",ta);Z.a(kd.a.discontinuousSelectionBlocking,[jb?td.a.m5j:td.a.m3h],!0,!0,!1,!1,sc);G=be.a.nj(1,1,751,G,0,371863010,"DiscontinuousSelectionBlocking");new Oe.a(this.$,G)}mvj(){const G=kf(this.TK);return G&&G.sourceItem&&Object.getType(G.sourceItem)!==S?Object.getType(G.sourceItem)===Qb?2:1:0}gii(G,ta,jb,sc,Vc){Vc=void 0===Vc?!1:Vc;G.stopwatch=this.$.Eh.Li("UserAction","DragDropReplaceClientSide");G.isDragDrop=!0;this.wwd("DragDropReplace/before/"+Ng.a[G.ribbonCommandInfo.method],
!1,void 0,G.copyPasteTargetType).catch(()=>{});const nd=Vc?2:1;let xd=0;xd=Vc?4:sc?256:128;const Hd={encounteredDeploymentErrors:!1};Hd.commandParameters=G;G.isDragInsert=!1;G.userHash=this.userHash;G.id=Oc.a.create().toString();return this.kA.pasteRange(G.ribbonCommandInfo,Lb.s(ta,this.$),Lb.s(jb,this.$),nd,xd,[G.stopwatch],Hd,!1,()=>{I.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${G.copyPasteTargetType}"`);this.L8f(G,nd,ta,jb,Hd)},
ke=>this.wjg(ke,G,nd,ta,jb,Hd)).then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},ke=>Promise.reject(ke))}fii(G,ta,jb,sc,Vc){Vc=void 0===Vc?!1:Vc;G.stopwatch=this.$.Eh.Li("UserAction","DragDropInsertClientSide");this.wwd("DragDropInsert/before/"+Ng.a[G.ribbonCommandInfo.method],!1,void 0,G.copyPasteTargetType).catch(()=>{});const nd=Vc?2:1,xd=Lb.R(this.Ypc([jb],nd));var Hd=this.$.ea.ma.sheetName;const ke=this.$.ea.ma.sheetName,V=Lb.x(ta,this.$);V.SheetName=Hd;Hd=Lb.x(xd,this.$);Hd.SheetName=
ke;sc=xd.isRow||ta.isRow||sc?1:0;const Wa={encounteredDeploymentErrors:!1};G.isDragInsert=!0;Wa.commandParameters=G;G.userHash=this.userHash;G.id=Oc.a.create().toString();Vc=this.kA.jii(Wa,V,Hd,Vc,sc,G.ribbonCommandInfo,()=>{I.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${G.copyPasteTargetType}"`);this.L8f(G,nd,ta,jb,Wa)},Eb=>{this.wjg(Eb,G,nd,ta,jb,Wa)});return mc.d(Vc.then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},
Eb=>Promise.reject(Eb))).lB(()=>!0)}$Td(G,ta,jb,sc,Vc,nd){var xd=kf(this.TK);if(!xd)return I.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),nb.Task.Ua(!1);if(!ec(xd.sourceItem))return I.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),nb.Task.Ua(!1);var Hd=xd.sourceItem;if(!Hd)return I.ULS.shipAssertTag(537167810,0,!!Hd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),nb.Task.Ua(!1);if(1<
Hd.ranges.length)return I.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.mOa(2192,"InsertCopiedCutCells",!0),nb.Task.Ua(!1);xd=Lb.R(Hd.ranges);var ke=this.da.ha.qa.jj.clone();G=Lb.R(this.Ypc([ke],G));const V=this.Z5f();Hd=Hd.sheetName;ke=this.$.ea.ma.sheetName;const Wa=Lb.x(xd,this.$);Wa.SheetName=Hd;const Eb=Lb.x(G,this.$);Eb.SheetName=ke;Hd=this.da.ha.qa.activeRange;const Jc=()=>{I.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},
od=()=>{I.ULS.sendTraceTag(508929746,0,50,"InsertCopiedCutCellsCrossSession Failed")};return(G.lk||xd.lk||this.kA.IMk(this.$,xd,Hd)?nb.Task.Ua(0):G.isRow||xd.isRow||this.kA.JMk(this.$,xd,Hd)?nb.Task.Ua(1):this.sej.$sc(this.$,ha.f(this.$).rtl)).lB(Pd=>this.qIa()?this.kA.executeInsertCopiedCutCellsOperation(Wa,Eb,V,Pd.result,ta,null,null):this.kA.executeInsertCopiedCutCellsAcrossSession(Wa,Eb,V,Pd.result,ta,Jc,od,jb,sc,Vc,nd)).continueWith(()=>{this.Nx("InsertCopiedCutCells/success/"+Ng.a[ta.method],
!0)})}JWb(){const G=kf(this.TK),ta=this.da.ha.qa.Bn;return!!G&&ec(G.sourceItem)&&ta&&1===G.sourceItem.ranges.length}Z5f(){return this.$5f(-911352779)}C2a(){var G,ta;const jb=kf(this.TK);return jb?(null===(G=jb.asyncClipboardItemsKeys)||void 0===G?void 0:G.includes(pd.a.shadowWorkbook))||(null===(ta=jb.syncClipboardItemsKeys)||void 0===ta?void 0:ta.includes(pd.a.shadowWorkbook))||3!==jb.copyStatus:!1}aLc(){return this.$5f(-1985798686)}iqc(G,ta){var jb=new Kd.a(this.$.sa),sc=36===G;const Vc=jb.Wj(4);
G=2===this.sMa()&&jb.Wj(1);sc=sc&&Vc;jb=!jb.wn||!this.aLc()||!Kd.a.Lvc(ta,ha.f(this.$));return sc||G||this.$.uy(ta,!0)&&jb}qob(G,ta){return this.kA.qob(G,ta)}dispose(){super.dispose();this.to();this.TK.removeMetadataChangeListener(rf.Tcg)}LCd(G,ta,jb,sc,Vc){if(!this.WXh(G.commandParameters.ribbonCommandInfo.command))return G.cseStatus=2,!1;if(sc.width%ta.width||sc.height%ta.height)return G.cseStatus=16,!1;if(sc.lk||sc.isRow)return G.cseStatus=31,!1;const nd=sc.Ik(this.da.Dp);if(!nd)return G.cseStatus=
7,!1;var xd=this.Z$e(this.da,G.commandParameters.ribbonCommandInfo.command,ta);if(0!==xd)return G.cseStatus=xd,!1;xd=this.Z$e(this.da,G.commandParameters.ribbonCommandInfo.command,nd);if(0!==xd)return G.cseStatus=xd,!1;xd=Lb.x(ta,this.$);xd.SheetName=jb;jb=this.yk.r5j(this.da,xd,Lb.x(nd,this.$),G.commandParameters.ribbonCommandInfo.command,G.commandParameters.stopwatch);1===jb&&(Vc&&(ta.Xi(sc)?(sc=Lb.fb(ta,G.commandParameters.expandDestinations[0]),this.yk.pwd(sc,!1,G.commandParameters.id),this.yk.pwd(sc,
!0,G.commandParameters.id)):(this.yk.erc(ta,!1),this.yk.erc(ta,!0))),ta=new Mb(G.commandParameters.ribbonCommandInfo.command,nd,ta),ha.f(this.$).Gfe(ta),this.pasteIndicationManager.Mmb(G.commandParameters.id,!0),this.rwb(G.commandParameters.expandDestinations,G.commandParameters.isPasteCommandFromRecoveryUI),this.jrc("DoPasteClientEstimation/"+Ng.a[G.commandParameters.ribbonCommandInfo.method],G));G.cseStatus=jb;return 1===jb}Z$e(G,ta,jb){G=new Zb.a("CopyPasteInfrastructure.blockCseForPaste",G,jb);
try{for(;G.moveNext();){const sc=G.get_current().cell;if(sc.$F)return 8;if(237279923===ta||1804571062===ta){if(!xa.EwaSettings.eMa()&&sc.oF)return 18;if(sc.XR)return 19}}}catch(sc){Sf.a.ro(sc,"CopyPasteInfrastructure.BlockCseForPasteRange: exception thrown before CSE")}finally{G&&G.dispose()}return 0}Pvg(){Vg(this.$)?(new zf(this.$)).showDialog(!0,!1,!1,this.PAj):(da.a.Xv||da.a.GIc||da.a.NXf?new If(this.$):new Je(this.$)).showDialog(!0,!1,!1,this.PBj)}uBj(G,ta,jb,sc){G=wh(G,ta,jb,sc,this.$.ua.UserSessionId);
G.k=!0;Ff.b().Ll(45,G,!0)}zYj(G,ta,jb,sc,Vc){var nd=!1,xd=!1,Hd=rf.Bib,ke=rf.zrf+rf.NIa;G&&(ke+=rf.dKa(G),be.a.Lx(G.ewaErrors)?(Hd=this.QAc(G.ewaErrors),be.a.ko(G.ewaErrors,[-103190598,1512686094])&&(nd=!0)):G.message&&(Hd=G.message));xd||(xd=this.zWd(G));ta=wh(ta,jb,sc,Vc,this.$.ua.UserSessionId);ta.k=!1;ta.l=xd;ta.n=Hd;ta.p=ke;ta.q=nd;Ff.b().Ll(45,ta,!0);return Promise.reject(G)}lsd(G,ta,jb,sc){let Vc;if(!this.mTf)return G.cseStatus=40,Qc.a.Ua(!1);const nd=this.Bkj(G.commandParameters.ribbonCommandInfo.command,
jb,this.da);if(0!==nd)return G.cseStatus=nd,Qc.a.Ua(!1);Db.TaskExtensions.ts(Qc.a.delay(0),()=>{Vc=this.mTf.J4j(ta,sc).result;return Qc.a.Ua(!0)},sc.token).continueWith(()=>{I.ULS.sendTraceTag(507582610,0,50,`CopyPasteInfrastructure.AttemptExternalHtmlPasteClientEstimation: pasteId=${G.id}, result=${JSON.stringify(null===Vc||void 0===Vc?void 0:Vc.UP)}`);if(1!==(null===Vc||void 0===Vc?void 0:Vc.cseStatus))return G.cseStatus=Vc?Vc.cseStatus:46,Qc.a.Ua(!1);if(sc.token.SM)return G.cseStatus=39,Qc.a.Ua(!1);
var xd=jb.topLeft?this.P6h(jb.topLeft,Vc.x0a):jb;G.commandParameters.expandDestinations=[xd];if(!ha.h(this.da,xd))return G.cseStatus=7,Qc.a.Ua(!1);G.cseStatus=this.yk.o5j(this.da,Vc.x0a,jb.topLeft,sc,G.commandParameters.stopwatch);return 1===G.cseStatus?(xd=new Mb(G.commandParameters.ribbonCommandInfo.command,jb,null),ha.f(this.$).Hk.rT(G.commandParameters.stopwatch.id,yg.BasicTelemetryCalculator.bS),ha.f(this.$).Gfe(xd),this.pasteIndicationManager.Mmb(G.commandParameters.id,!0),this.rwb(G.commandParameters.expandDestinations,
G.commandParameters.isPasteCommandFromRecoveryUI),this.jrc("AttemptExternalHtmlPasteClientEstimation/"+Ng.a[G.commandParameters.ribbonCommandInfo.method],G),Qc.a.Ua(!0)):Qc.a.Ua(!1)});return Qc.a.Ua(!1)}NKh(G,ta,jb){G.cseStatus=0;G.cseStatus=this.Dkj(G.commandParameters.ribbonCommandInfo.command,jb,this.da,ta);if(0!==G.cseStatus)return!1;G.cseStatus=this.yk.s5j(this.da,ta,jb,G.commandParameters.stopwatch);ta=new Mb(G.commandParameters.ribbonCommandInfo.command,jb,null);1===G.cseStatus&&(ha.f(this.$).Gfe(ta),
this.pasteIndicationManager.Mmb(G.commandParameters.id,!0),this.rwb(G.commandParameters.expandDestinations,G.commandParameters.isPasteCommandFromRecoveryUI),this.jrc("AttemptExternalPlainTextPasteClientEstimation/"+Ng.a[G.commandParameters.ribbonCommandInfo.method],G));return 1===G.cseStatus}Bkj(G,ta,jb){return 237279923!==G?2:jb.oh.Hob(ta)?8:jb.oh.EY(ta)?11:this.yk.Wvc(ta)?12:0}P6h(G,ta){return new yb.Range(G.top,G.left,G.top+Math.max(...ta.map(jb=>jb.rowIndex)),G.left+Math.max(...ta.map(jb=>jb.colIndex)),
!0,!0)}Dkj(G,ta,jb,sc){if(-875588320!==G&&-185374993!==G&&237279923!==G)return 2;if(jb.oh.Hob(ta))return 8;if(!xa.EwaSettings.eMa()&&jb.oh.Qtj(ta))return 18;if(jb.oh.EY(ta))return 11;if(this.yk.Wvc(ta))return 12;G=this.cSh(ta,sc);return ha.h(this.da,G)?0:7}cSh(G,ta){var jb=ta.indexOf("\r");jb=-1!==jb?"\n"===ta[jb+1]?ta.split("\r\n"):ta.split("\r"):ta.split("\n");ta=jb.length;jb=jb[0].split("\t").length;return new yb.Range(G.top,G.left,G.top+ta-1,G.left+jb-1,!0,!0)}WXh(G){switch(G){case 237279923:case 808159687:case -185374993:case 1804571062:case -875588320:return!0;
default:return!1}}$5f(G){const ta=kf(this.TK);return ta?ta.commandParameters.ribbonCommandInfo.command===G:!1}JKk(G){return G&&G.lastCopy?P(G.lastCopy,this.$):!0}kGf(G,ta,jb,sc,Vc){const nd={};nd.a=this.$.ua.UserSessionId;nd.e=G.stopwatch.id;nd.c=Ff.b().zp(G.ribbonCommandInfo.command);nd.b=Ng.a[G.ribbonCommandInfo.method];nd.d=G.id;nd.f=jb.toString();nd.g=sc.toString();nd.h=ta.toString();nd.o=G.stopwatch.zi;nd.q=!1;nd.r=G.copyPasteTargetType.toString();nd.s=Vc.encounteredDeploymentErrors;nd.i=Vc.commandParameters.dragDropIsShiftKeyDown;
nd.j=Vc.commandParameters.isDragInsert;xa.EwaSettings.KC()&&(nd.t=Vc.commandParameters.isHeaderDrag);return nd}L8f(G,ta,jb,sc,Vc){G=this.kGf(G,ta,jb,sc,Vc);G.k=!0;Ff.b().Ll(45,G,!0)}Jzj(G,ta,jb,sc,Vc,nd,xd,Hd,ke){G=this.kGf(G,ta,jb,sc,ke);G.k=!1;G.l=Vc;G.n=nd;G.p=xd;G.q=Hd;Ff.b().Ll(45,G,!0)}E8f(G,ta,jb,sc,Vc,nd,xd,Hd,ke){const V={};V.a=this.$.ua.UserSessionId;V.b=ta;V.c=G;V.f=jb;V.e=sc;V.d=Vc;V.g=nd;V.h=xd;V.i=Hd;V.j=ke.toString();Ff.b().Ll(46,V,!0)}Bzj(G,ta){G=this.FFf(G.commandParameters,G);G.l=
!0;G.j=ta;Ff.b().Ll(43,G,!0)}F8f(G,ta,jb,sc,Vc,nd,xd){G=this.FFf(G,xd);G.l=!1;G.m=ta;G.o=jb;G.y=sc;G.x=Vc;G.z=nd;Ff.b().Ll(43,G,!0);I.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${G.y},ErrorReason=${G.x},IsExpectedError=${G.m},IsSucceededWithAlert=${G.z},ErrorMessage=${G.o}`)}FFf(G,ta){const jb={};jb.a=this.$.ua.UserSessionId;jb.f=G.stopwatch.id;jb.g=G.id;jb.c=Ff.b().zp(G.ribbonCommandInfo.command);jb.b=Ng.a[G.ribbonCommandInfo.method];jb.q=G.stopwatch.zi;
jb.bd=rf.Wzc();jb.bg=G.copyPasteHandlerName;jb.bj=void 0===G.ribbonCommandInfo.jk||null===G.ribbonCommandInfo.jk?null:Ig.a[G.ribbonCommandInfo.jk];jb.bq=G.uploadToClipService;jb.br=G.floatingObjectType;jb.s=G.copyPasteTargetType.toString();jb.bc=Da(G.copyPasteTargetType);jb.z=!1;if(ta){jb.bk=ta.id;jb.bl=ta.serverRequestTimeInMs;ta.requestTelemetryData&&(jb.bm=ta.requestTelemetryData.EcsOperationDuration,jb.bn=ta.requestTelemetryData.EcsRequestDuration,jb.bo=ta.requestTelemetryData.WfeRequestDuration);
jb.d=ta.sourceItem?ta.sourceItem.toString():null;jb.e=-1;if(ec(ta.sourceItem)){jb.e=0;G=ta.sourceItem.ranges;for(const sc of G)jb.e+=sc.uz}jb.h=ta.isAsyncCopy;jb.i=ta.isFromCache;jb.k=ta.isSelectionAllowed;jb.r=ta.plainTextPayloadSize;jb.u=ta.htmlPayloadSize;jb.v=ta.htmlSizeExceedsLimit;jb.w=ta.copyTotalSizeExceedsLimit;jb.t=ta.shadowWorkbookPayloadSize;jb.p=ta.clientSideCopyTime;jb.ba=ta.encounteredDeploymentErrors;jb.bb=ta.shadowWorkbookSizeExceedsLimit;jb.be=ta.syncClipboardItemsKeys;jb.bf=ta.asyncClipboardItemsKeys;
jb.bh=this.ujf(ta.succeededPopulatingSystemClipboardSync);jb.bi=this.ujf(ta.succeededPopulatingSystemClipboardAsync);Vg(this.$)&&(jb.bs=ta.commandParameters.isAsyncClipboardAPI)}return jb}rwb(G,ta){ta=void 0===ta?!1:ta;if(!this.da.isEditing&&!this.da.lq){var jb=this.da.ha.qa,sc=!ta&&1===G.length&&Lb.X(G,jb.selectedRanges),Vc=sc?jb.activeCell:G[0].topLeft;G[0].contains(Vc)||(I.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${jb.selectedRanges}, IndexOfActiveRange ${jb.Jy}, ActiveCell ${jb.activeCell}, calculatedDestinationRanges ${G}, keepThePreviousActiveCell ${sc}, newActiveCell ${Vc}, isPasteCommandFromRecoveryUI ${ta}`),
Vc=G[0].topLeft);this.da.ha.yN(G,0,Vc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}fKf(G,ta){const jb={};jb.a=this.$.ua.UserSessionId;jb.g=G.stopwatch.id;jb.t=G.stopwatch.zi;jb.bz=!1;ta&&(jb.bv=ta.id,jb.bw=ta.serverRequestTimeInMs,jb.n=ta.commandParameters.clipboardFormatReadTimes,jb.o=ta.commandParameters.clipboardFormatReadStatus,jb.q=ta.commandParameters.asyncApiReadTimedOut,ta.requestTelemetryData&&(jb.cb=ta.requestTelemetryData.EcsOperationDuration,jb.cc=ta.requestTelemetryData.EcsRequestDuration,
jb.cd=ta.requestTelemetryData.WfeRequestDuration));jb.x=G.copyPasteTargetType.toString();jb.bl=Da(G.copyPasteTargetType);jb.br=G.copyPasteHandlerName;jb.i=(null===ta||void 0===ta?0:ta.isHtmlPaste)?Lb.j(Lb.h(ta.pastedRange.Ranges),",",this.$,!1):Lb.j(G.expandDestinations,",",this.$,!1);jb.h=Lb.j(G.originalDestinations,",",this.$,!1);jb.e=G.id;jb.d=G.commandType;jb.c=Ff.b().zp(G.ribbonCommandInfo.command);jb.b=Ng.a[G.ribbonCommandInfo.method];jb.bf=!1;jb.bg=!1;jb.bp=rf.Wzc();jb.bt=void 0===G.ribbonCommandInfo.jk||
null===G.ribbonCommandInfo.jk?null:Ig.a[G.ribbonCommandInfo.jk];jb.cj=G.isPasteCommandFromEnterShortcut;if(jb.ca=G.isPasteCommandFromRecoveryUI)jb.cf=G.pasteRecoveryUndoStopwatch.id,jb.cg=G.pasteRecoveryUndoStopwatch.zi;if(ta){if((G=ta.copyContextSnapshot)&&!ta.wasLastCopyExternal){jb.f=G.commandParameters.id;jb.j=G.sourceItem.toString();jb.k=-1;if(ec(G.sourceItem)){jb.k=0;const sc=G.sourceItem.ranges;for(const Vc of sc)jb.k+=Vc.uz}jb.bg=1===G.commandParameters.commandType}else ta.clipboardItems?
jb.f=ta.clipboardItems.getItem(pd.a.Ksc):I.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");jb.bz=ta.pasteRecoveryUIDisplayed;jb.ci=ta.cseStatus}else I.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return jb}YAj(G,ta,jb,sc,Vc,nd,xd,Hd,ke){var V,Wa;G=this.fKf(G,Hd);G.l=!1;G.m=ta;G.s=jb;G.bc=sc;G.be=Vc;G.bd=nd;G.bf=xd;if(Hd){G.y=de(Hd)||!Hd.copyContextSnapshot;G.bi=!G.y&&P(Hd.copyContextSnapshot,
this.$);G.bj=Hd.shadowWorkbookSizeExceedsLimit;G.v=Hd.shadowWorkbookPayloadSize;G.w=Hd.htmlPayloadSize;G.bq=ib(Hd.clipboardItems);G.bb=Hd.activeSelectionType;G.bs=Hd.isSameSession;G.bn=Hd.payloadOrigin;G.bo=Hd.payloadType;G.bu=Hd.externalAppSource;G.bx=Hd.indicationDisplayScheduled;G.by=Hd.pasteIndicationDisplayStatus;G.ck=Hd.pasteDestinationHasMergedCells;if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",
!1))G.cl=Hd.ArtSourceItemType;Vg(this.$)&&(G.cm=null===(V=Hd.commandParameters)||void 0===V?void 0:V.isAsyncClipboardAPI);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(G.cn=null===(Wa=Hd.commandParameters)||void 0===Wa?void 0:Wa.isChromiumExtension)}else G.bi=P(ke,this.$);Ff.b().Ll(44,G,!0);I.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${G.be},ErrorReason=${G.bd},IsExpectedError=${G.m},IsSucceededWithAlert=${G.bf},ErrorMessage=${G.s}`)}$Aj(G){var ta,
jb;const sc=this.fKf(G.commandParameters,G);sc.y=G.wasLastCopyExternal;sc.l=!0;sc.u=G.plainTextPayloadSize;sc.v=G.shadowWorkbookPayloadSize;sc.w=G.htmlPayloadSize;sc.z=G.isClipboardDataContainShadowWorkbook;sc.ba=G.isShadowWorkbookParsedSuccessfully;sc.bb=G.activeSelectionType;sc.bc=G.pasteResult;sc.bh=G.encounteredDeploymentErrors;sc.bj=G.shadowWorkbookSizeExceedsLimit;sc.bk=Re(G);sc.bq=ib(G.clipboardItems);sc.bs=G.isSameSession;sc.bn=G.payloadOrigin;sc.bo=G.payloadType;sc.bu=G.externalAppSource;
sc.bx=G.indicationDisplayScheduled;sc.by=G.pasteIndicationDisplayStatus;sc.ck=G.pasteDestinationHasMergedCells;sc.bm=G.clipboardItems?G.clipboardItems.getItem(pd.a.KWh):null;sc.bi=!G.isSameSession&&!G.wasLastCopyExternal;sc.ci=G.cseStatus;if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))sc.cl=G.ArtSourceItemType;Vg(this.$)&&(sc.cm=null===(ta=G.commandParameters)||
void 0===ta?void 0:ta.isAsyncClipboardAPI);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(sc.cn=null===(jb=G.commandParameters)||void 0===jb?void 0:jb.isChromiumExtension);Ff.b().Ll(44,sc,!0)}Hp(){this.$.sa.pn(this.wq);this.$.sa.TCh(this.BPc);this.$.userOperationManager.mw(this.O1);this.$.mr(this.Cj);ha.f(this.$).Fh.Iv(this.k7);ha.f(this.$).Fh.uX(this.cZ)}to(){this.$&&this.$.sa&&(this.$.sa.Gn(this.wq),this.$.sa.$mk(this.BPc));this.$&&this.$.userOperationManager&&
this.$.userOperationManager.uu(this.O1);this.da&&this.da.Fh&&(this.da.Fh.Cv(this.k7),this.da.Fh.i2(this.cZ))}D1b(G,ta){var jb=null;let sc=!1;var Vc=null;let nd="UnknownFailure",xd=-1,Hd=rf.Bib,ke=rf.pasteErrorName+rf.NIa,V=!1;this.pasteIndicationManager.Mmb(G.id,!1);this.pasteDestinationHasMergedCells(G.expandDestinations)&&(ta.pasteContext.pasteDestinationHasMergedCells=!0);const Wa=kf(this.TK);(G.clearStateOnFinish||G.clearSystemClipboard)&&this.Nx("Paste/fail/"+Ng.a[G.ribbonCommandInfo.method],
!0,void 0,void 0,G.copyPasteTargetType).catch(()=>{});if(ta){xd=ta.reason;ke+=rf.dKa(ta);ta.message&&(Hd=ta.message);if(jb=rf.y2h(ta))if(1===jb.pasteErrorName)sc=!0,nd="CopyPasteLengthTooLongPopup",Hd=Vc="The pasted content is too long. Popup a dialog to the user.",I.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${G.copyPasteTargetType}"`),jb=be.a.nj(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),new Oe.a(this.$,jb);else if(7===jb.pasteErrorName)sc=
!0,nd="No-Op",Hd=Vc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",I.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${G.copyPasteTargetType}"`);else if(8===jb.pasteErrorName)sc=!0,nd="UseShortcutsPopup",Hd=Vc="Unable to paste content from the system clipboard. Popup dialog to the user.",I.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${G.copyPasteTargetType}"`),
this.Pvg();else if(18===jb.pasteErrorName){sc=!0;nd="PasteExternalNotSupportMultipleSelectionPopup";Hd="Paste external not support multiple selection.";Vc="Unknown";var Eb=2192;100!==jb.validationFailureReason&&(Vc=ic[jb.validationFailureReason],Eb=rf.kjf(jb.validationFailureReason));this.mOa(Eb,Vc,!0)}else 20===jb.pasteErrorName||19===jb.pasteErrorName?(sc=!0,20===jb.pasteErrorName?(nd="PasteAcrossSessionNotSupportMultipleSelectionPopup",Hd="Paste across session does not support multiple selection."):
(nd="PasteInSameSessionNotSupportMultipleSelectionPopup",Hd="This kind of multiple selection is not supported for same session paste."),Vc="Unknown",Eb=2192,100!==jb.validationFailureReason&&(Vc=ic[jb.validationFailureReason],Eb=rf.kjf(jb.validationFailureReason)),jb=6===jb.validationFailureReason,this.iqc(G.commandType,G.expandDestinations)&&jb&&this.rwb(G.expandDestinations),this.mOa(Eb,Vc,!0)):6===jb.pasteErrorName?(sc=!0,nd="No-Op",Hd=Vc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
I.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${G.copyPasteTargetType}"`)):17===jb.pasteErrorName?(sc=!0,nd="No-Op",Hd=Vc="Paste text on Art is not yet a supported operation",I.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${G.copyPasteTargetType}"`)):16===jb.pasteErrorName?(sc=!0,nd="No-Op",Hd=Vc="Paste has failed because the previous copy has failed",jb=this.getStringifiedError(jb),I.ULS.sendTraceTag(537167771,
0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Vc}, copyPasteTargetType="${G.copyPasteTargetType}", error=${jb}`)):be.a.Lx(jb.ewaErrors)?(be.a.Mea(jb.ewaErrors)||be.a.ko(jb.ewaErrors,be.a.YCc())?(sc=!0,nd="CommunicationError",Vc=be.a.Yh(jb.ewaErrors),I.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Hd} copyPasteTargetType="${G.copyPasteTargetType}"`)):be.a.ko(jb.ewaErrors,rf.Swk)?(sc=!0,nd="SavingWorkbookError",Vc=be.a.Yh(jb.ewaErrors),I.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Hd} copyPasteTargetType="${G.copyPasteTargetType}"`)):
be.a.ko(jb.ewaErrors,rf.operationSucceededWithAlert)&&(V=sc=!0,nd="OperationSucceededWithAlert",Vc=be.a.Yh(jb.ewaErrors),I.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Hd} copyPasteTargetType="${G.copyPasteTargetType}"`)),sc||(Hd=this.QAc(jb.ewaErrors),sc=this.zWd(ta))):11===jb.pasteErrorName&&(sc=!0,nd="No-Op",Hd="Paste has failed because user try copy cross-session oart object");15===ta.reason&&(sc=!0,nd="No-Op",Hd="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Ua.a.equals(ke,Ad.hbl,!1)&&(sc=!0,nd="No-Op",Hd="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}sc||(jb=ta?this.getStringifiedError(ta):"null",I.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${jb}, copyPasteTargetType="${G.copyPasteTargetType}"`));this.YAj(G,sc,Hd,nd,ke,xd,V,ta.pasteContext,Wa);return Promise.reject(ta)}cQc(G,ta){var jb;I.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${ta.copyPasteTargetType}"`);
this.pasteIndicationManager.Mmb(ta.id,!0);if(this.x5j(ta.copyPasteTargetType,G)){kg.a.d1a&&G.wasLastCopyExternal&&G.payloadType===Yf.shadowWorkbook&&(this.jpb=!0);let sc=null;(null===(jb=G.pastedRange)||void 0===jb?0:jb.Ranges)&&0<G.pastedRange.Ranges.length?sc=Lb.h(G.pastedRange.Ranges):G.wasLastCopyExternal||(sc=ta.expandDestinations);this.Yyk(G,sc);if(this.hNk(G,sc)){jb=Lb.d(ta.originalDestinations);const Vc=1028===ta.commandType?Lb.d(ta.expandDestinations):Lb.d(sc);let nd=null;G.wasLastCopyExternal&&
(ta.isKeyboardEvent||ta.isPasteCommandFromRecoveryUI)&&(nd={[rf.rug]:G.clipboardItems});this.pasteDestinationHasMergedCells(ta.expandDestinations)&&(G.pasteDestinationHasMergedCells=!0);G.pasteRecoveryUIDisplayed=!0;const xd=new Xf(this.$,jb,Vc,nd,this.zoom),Hd=Object(mc.d)(za.a.resolve(oa.lf,{va:0}));264209770===ta.ribbonCommandInfo.command?this.da.za.GNa(()=>{Db.TaskExtensions.Xa(Hd,()=>{const ke=Hd.result;ke.dtd(xd);ke.yte(ta.ribbonCommandInfo.method)},this.ya,8)}):Db.TaskExtensions.Xa(Hd,()=>
{const ke=Hd.result;ke.dtd(xd);ke.yte(ta.ribbonCommandInfo.method,ta.event)},this.ya,8)}this.wQj(G,sc)}this.jrc("Paste/success/"+Ng.a[ta.ribbonCommandInfo.method],G);this.$Aj(G);this.PTg&&(!ta.isKeyboardEvent||Re(G))&&this.$.ea.Vn.get(66)&&(I.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.PTg=!1,this.m4h());G=new Pf(ta.expandDestinations,G.commandParameters.ribbonCommandInfo.command);this.ddk(G);return Promise.resolve(!0)}wQj(G,
ta){oa.xg.Aa()?void za.a.resolve(oa.xg,{va:1}).then(jb=>{jb.p2g(G,ta)}):Db.TaskExtensions.Xa(Ub.GetServiceTaskFactory.Tj(this.$.la,534,535,1),jb=>{jb.result.p2g(G,ta)},this.$.ya,3)}hNk(G,ta){return!ta||1!==ta.length||G.commandParameters.clearSystemClipboard||G.commandParameters.clearStateOnFinish||G.commandParameters.skipClipboardAccess?!1:de(G)&&(ta=G.clipboardItems.getItem(pd.a.plainText),G=G.clipboardItems.getItem(pd.a.html),void 0===ta||null===ta||ta.length>this.vFj||void 0===G||null===G||G.length>
this.q_b)?(I.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}x5j(G,ta){return 1===G||ta.payloadType===Yf.plainText||ta.payloadType===Yf.html||kg.a.d1a&&ta.payloadType===Yf.shadowWorkbook}pasteDestinationHasMergedCells(G){const ta=ha.f(this.$).za.qA();if(!ta||!ta.length)return!1;for(const jb of ta)if(jb.HD(G[0]))return!0;return!1}jrc(G,ta){let jb;(()=>{let sc=this.mij(ta);({kXa:jb}=sc);return sc})().returnValue&&
this.Nx(G,jb,void 0,void 0,ta.commandParameters.copyPasteTargetType).catch(()=>{})}wjg(G,ta,jb,sc,Vc,nd){const xd=G?this.getStringifiedError(G):"null";let Hd=!1,ke=!1,V=!1,Wa=rf.Bib,Eb=rf.zrf+rf.NIa;G&&(Eb+=rf.dKa(G),be.a.Lx(G.ewaErrors)?(Wa=this.QAc(G.ewaErrors),be.a.ko(G.ewaErrors,rf.operationSucceededWithAlert)&&(Hd=!0),be.a.ko(G.ewaErrors,rf.dragDropNonEmptyRange)&&(ke=V=!0)):G.message&&(Wa=G.message));V||(V=this.zWd(G));ke?this.da.ha.selectionType=-1:this.kA.Ggk(Vc);V||I.ULS.sendTraceTag(24150918,
0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${xd}, copyPasteTargetType="${ta.copyPasteTargetType}`);this.Jzj(ta,jb,sc,Vc,V,Wa,Eb,Hd,nd)}Ypc(G,ta){let jb=G;const sc=this.bPi();if(null===sc||void 0===sc?0:sc.ranges)jb=this.kA.BSh(ta,sc.ranges,G);return jb}bPi(){const G=kf(this.TK);return G&&ec(G.sourceItem)?G.sourceItem:null}zdk(){this.raiseEvent(rf.Hae,null)}ddk(G){Object(Zf.d)(()=>{this.raiseEvent(rf.l6c,G)})}Yyk(G,ta){const jb=G.commandParameters.originalDestinations;ta&&(Lb.X(this.da.ha.qa.selectedRanges,
jb)?(this.rwb(ta),G=Xd.HelperMethods.hJb(ta),I.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${G}`)):G.commandParameters.isPasteCommandFromRecoveryUI?(this.rwb(ta,!0),I.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${ta}, active cell: ${ta[0].topLeft}`)):(G=Xd.HelperMethods.hJb(jb),I.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${G}`)))}mij(G){if(G.isPlainTextPaste||
G.isHtmlPaste||Ge(G)||G.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,kXa:!1};var ta=G.copyContextSnapshot;if(G.commandParameters.clearStateOnFinish)return{returnValue:!0,kXa:!0};if(ta&&ec(ta.sourceItem)){var jb=ta.sourceItem;if(!jb.isFromCurrentSession(this.$))return{returnValue:!1,kXa:!0};ta=-1985798686===ta.commandParameters.ribbonCommandInfo.command;if(!(1<jb.ranges.length||1<G.commandParameters.expandDestinations.length)){const sc=Lb.R(jb.ranges),Vc=Lb.R(G.commandParameters.expandDestinations),
nd=this.$.ea.ma.sheetName;jb=jb.sheetName;if(jb===nd&&Vc.equals(sc))return{returnValue:!1,kXa:!0};if(jb===nd&&Vc.Ik(sc))return{returnValue:!(this.J2a&&G.commandParameters.isFormatPainter),kXa:!1}}return{returnValue:ta,kXa:!0}}return{returnValue:!1,kXa:!0}}J_j(){kf(this.TK)&&this.Nx("OnStartEdit",!1).catch(()=>{})}xRj(){kf(this.TK)&&this.Nx("OnEndEdit",!0).catch(()=>{})}QAc(G){G=be.a.aLi(G,rf.NIa);return this.rGj+ea.a.qE(G).toString()}zWd(G){G=rf.dKa(G);return!!G&&Ua.a.ROb(G,rf.qGj)}m4h(){const G=
be.a.nj(1,2,327,328,da.a.Xv?329:da.a.vP?330:331,530046625,"ActivateLocalStorage"),ta=Object(mc.d)(za.a.resolve(oa.C,{va:0}));Db.TaskExtensions.Xa(ta,()=>{ta.result.Om(43,G)},this.ya,3)}ujf(G){return void 0===G||null===G?jg.KKj:G?jg.success:jg.failed}static y2h(G){const ta=G.innerError;return ta&&0!==ta.pasteErrorName?G.innerError:null}static h2h(G){const ta=G.innerError;return ta&&0!==ta.copyErrorName?G.innerError:null}static dKa(G){let ta="";if(!G)return rf.$nf;G.errorName&&(ta=G.errorName,G.innerError&&
(ta+=rf.NIa+rf.dKa(G.innerError)));ta||(ta=G&&G.name?G.name:rf.$nf);return ta}static Wzc(){rf.Oa||(rf.Oa=eh.DSk);return rf.Oa}static kjf(G){switch(G){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return I.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${G}`),2199}}static i2h(G){switch(G){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;
default:return I.ULS.shipAssertTag(537167763,0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${G}`),2199}}}rf.Tcg="EwaJsMetadataChangeListenerId";rf.Hae="cpiOSC";rf.l6c="cpiPS";rf.Gci="cpiDID";rf.Bib="Unknown";rf.$nf="UnknownError";rf.NIa="_";rf.zrf="DragAndDropError";rf.pasteErrorName="PasteError";rf.YTh="CancelError";rf.copyErrorName="CopyError";rf.qGj="MergedCellOverlap";rf.rug="PasteRecoveryCachedClipboardItems";rf.Swk=[1352631530,1679665408];
rf.operationSucceededWithAlert=[-103190598,1512686094];rf.pasteDataLimitHit=[1306609195];rf.copyThrottlingError=[-386183710];rf.dragDropNonEmptyRange=[563945982];rf.Oa=null;Object(D.a)(rf,"CopyPasteInfrastructure",pb.a,[910,911,4]);class xh{constructor(){this.jhb=this.egf=null}}Object(D.a)(xh,"ClipboardPlatformInitializationResult",null,[]);var kh=a(769),Hh=a(768),oh=a(245),Zh=a(119);const Di=(G,ta,jb,sc,Vc,nd,xd,Hd)=>{Hd=void 0===Hd?null:Hd;xd=G.$a(1,xd);xd.pasteHtmlParameters=ta;return ad.h(G,"PasteHtmlContent",
xd,jb,sc,Vc,nd,64,Hd)},Pi=(G,ta,jb,sc,Vc,nd,xd,Hd,ke,V)=>{V=void 0===V?null:V;ke=G.$a(9,ke);const Wa={};Wa.DestinationRange=ta;Wa.Source=jb;Wa.AutoAdjustColumnsOn=sc;ke.pasteStringParameters=Wa;return ad.h(G,"PasteString",ke,Vc,nd,xd,Hd,64,V)},$h=(G,ta,jb,sc,Vc,nd,xd,Hd)=>{Hd=void 0===Hd?null:Hd;xd=G.$a(1,void 0===xd?null:xd);xd.copyParameters=ta;return ad.h(G,"Copy",xd,jb,sc,Vc,nd,0,Hd)},Ei=(G,ta,jb,sc,Vc,nd,xd,Hd)=>{Hd=void 0===Hd?null:Hd;xd=G.$a(1,void 0===xd?null:xd);xd.pasteParameters=ta;return ad.h(G,
"Paste",xd,jb,sc,Vc,nd,64,Hd)};class Fi{constructor(G,ta,jb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=G;this.destinationRange=ta;this.pasteFlags=jb}}Object(D.a)(Fi,"MacroRecorderPasteRangePayload",null,[60]);class rh{constructor(G,ta){this.content=this.destinationRange=null;this.destinationRange=G;this.content=ta}getContent(){return this.content}}Object(D.a)(rh,"MacroRecorderPasteStringPayload",null,[60]);class Gi{constructor(G){this.pasteParameters=null;this.pasteParameters=
G}}Object(D.a)(Gi,"MacroRecorderPastePayload",null,[60]);var li=a(692),Si=a(242);class qi{constructor(G){this.parameters=null;this.parameters=G}getParameters(){return this.parameters}}Object(D.a)(qi,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[60]);class gi{constructor(G){this.sheetName=null;this.sheetName=G}getSheetName(){return this.sheetName}}Object(D.a)(gi,"MacroRecorderFullSheetCopyPayload",null,[60]);class lh{constructor(G,ta){this.MYb=this.gza=null;this.GGc=xa.EwaSettings.getBooleanFeatureGate(kg.a.TMb,
!1);this.CUd=!1;this.O_=null;this.UE=(jb,sc)=>{if(2===sc.tx)this.IB=[],this.gza=null;else if(1===sc.tx&&this.IB&&this.IB.includes(sc.Ul)){jb=Zh.a(sc.Ul.operation.operationName);const Vc=sc.Ul.dequeueUtcTime.getTime()-sc.Ul.enqueueUtcTime.getTime();I.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${jb} returned, it took ${Vc} milliseconds to complete.`);this.IB.splice(this.IB.indexOf(sc.Ul),1);this.gza=null}};this.$=G;this.da=ta;this.CUd&&(this.$.userOperationManager.mw(this.UE),
this.IB=[]);zb.a.hoa()&&void za.a.resolve(oa.q,{va:1}).then(jb=>{this.O_=jb})}get q_b(){return this.$.ua.CCPCopyPasteHtmlLimit}get Xbg(){return this.$.ua.CCPPastePlainTextLimit}copy(G,ta,jb,sc,Vc){sc=void 0===sc?null:sc;Vc=void 0===Vc?null:Vc;const nd=this.$.pa.ta.Vh();this.CUd&&this.U9();this.MYb=nd.ClientRequestId;var xd=new bc.a(505,0,(Hd,ke,V)=>{const Wa={CopyPasteTargetType:1};Wa.SourceRanges=G;Wa.CopyOperationId=ta.id;return this.gza=$h(this.$.pa.Gyd,Wa,Xc.c(Hd,jb),sc?Xc.b(ke,sc):ke,V,ta.ribbonCommandInfo,
nd,Vc)},80);xd=this.$.userOperationManager.enqueueOperation(xd,ta.ribbonCommandInfo);this.CUd&&this.IB.push(xd)}fullSheetCopy(G,ta,jb,sc){sc=void 0===sc?null:sc;const Vc=this.$.pa.ta.Vh();this.MYb=Vc.ClientRequestId;const nd=new bc.a(609,0,(xd,Hd,ke)=>{var V=this.$.pa.ta;xd=Xc.c(xd,jb);Hd=sc?Xc.b(Hd,sc):Hd;var Wa=ta.ribbonCommandInfo;const Eb=V.$a(1,void 0===Vc?null:Vc);Eb.sheetName=G;return this.gza=ad.h(V,"CopySheetToShadowWorkbook",Eb,xd,Hd,ke,Wa,0)},80,()=>new gi(G));this.$.userOperationManager.enqueueOperation(nd,
ta.ribbonCommandInfo)}qug(G,ta,jb,sc,Vc,nd){return new Promise((xd,Hd)=>{var ke;const V=nd.commandParameters.stopwatch.zi;let Wa=2;20===nd.commandParameters.commandType&&(Wa=16);36===nd.commandParameters.commandType&&(Wa=32);68===nd.commandParameters.commandType&&(Wa=64);zb.a.a0d(this.$)&&1028===nd.commandParameters.commandType&&(Wa=1024);4100===nd.commandParameters.commandType&&(Wa=4096);let Eb=null;if(null===(ke=nd.copyContextSnapshot)||void 0===ke?0:ke.commandParameters)Eb=nd.copyContextSnapshot.commandParameters.id;
lh.moe(this.$,G,sc,ta,jb,null,Jc=>{lh.wDc(Jc,nd,xd,Hd,V,this.$,null,!0,null,null)},Jc=>{nd.serverRequestTimeInMs=nd.commandParameters.stopwatch.zi-V;Jc=vc.a.gk(Jc.data);Hd(new Sc(5,Jc))},Vc,Wa,Eb,nd.commandParameters.id)})}pasteRange(G,ta,jb,sc,Vc,nd,xd,Hd,ke,V){return new Promise((Wa,Eb)=>{const Jc=xd.commandParameters.stopwatch.zi;lh.iAk(this.$,G,ta,jb,sc|-5&Vc,od=>{lh.wDc(od,xd,Wa,Eb,Jc,this.$,null,!0,ke,V)},od=>{xd.serverRequestTimeInMs=xd.commandParameters.stopwatch.zi-Jc;od=vc.a.gk(od.data);
od=new Sc(5,od);null===V||void 0===V?void 0:V(od);Eb(od)},nd,Hd)})}nak(G,ta,jb,sc,Vc,nd,xd,Hd){const ke=new kh.a;return new Promise((V,Wa)=>{if(ta)if(ta.length>this.q_b){var Eb=xd.clipboardItems.getItem(pd.a.plainText);let Jc=-1;void 0!==Eb&&null!==Eb&&(Jc=Eb.length);I.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${ta.length}, MaxHtmlImportLength: ${this.q_b}, PlainTextLength: ${Jc}`);Wa(new Sc(1))}else Eb=new bc.a(204,
0,(Jc,od,Pd)=>{this.$.ZC();const ge=xd.commandParameters.stopwatch.zi;Jc=Xc.c(Jc,Of=>{oa.od.Aa()&&ke.cancel();lh.wDc(Of,xd,V,Wa,ge,this.$,ta,!1,null,null)});od=Xc.b(od,Of=>{xd.serverRequestTimeInMs=xd.commandParameters.stopwatch.zi-ge;Of=vc.a.gk(Of.data);oa.od.Aa()&&ke.cancel();Wa(new Sc(3,Of))});const Be=this.$.pa.ta.Vh(),Ye=Lb.x(G,this.$),gf={};gf.SourceHtml=ta;gf.DestinationRanges=Ye?Lb.u(Ye):null;gf.CopyOperationId=jb;gf.PasteId=sc;gf.AutoAdjustColumnsOn=this.bM();return Di(this.$.pa.Gyd,gf,Jc,
od,Pd,null,Be,nd)},65),this.$.userOperationManager.enqueueOperation(Eb,Vc),oa.od.Aa()&&this.lsd(xd,ta,G,Hd,ke),this.ZAj(ta);else V("")})}lsd(G,ta,jb,sc,Vc){return sc.lsd(G,ta,jb,Vc)}ZAj(G){if(G&&G.trim()&&xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8472105_EnablePasteHtmlTelemetry")){var ta=performance.now(),jb=(new DOMParser).parseFromString(G,"text/html");if(jb){G=[];jb.querySelector("table table")&&G.push("NestedTable");jb.querySelector("table ol")&&G.push("OrderedListInsideTable");jb.querySelector("table ul")&&
G.push("UnorderedListInsideTable");jb.querySelector("ol table")&&G.push("TableInsideOrderedList");jb.querySelector("ul table")&&G.push("TableInsideUnorderedList");jb.querySelector("ol ol")&&G.push("NestedOrderedList");jb.querySelector("ul ul")&&G.push("NestedUnorderedList");jb.querySelector("ol ul")&&G.push("UnorderedListInsideOrderedList");jb.querySelector("ul ol")&&G.push("OrderedListInsideUnorderedList");jb.querySelector("td[rowspan], td[colspan], th[rowspan], th[colspan]")&&G.push("TableWithCellSpan");
var sc=new Set;jb.querySelectorAll("*").forEach(Vc=>{Vc.nodeType===Node.ELEMENT_NODE&&xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8708534_PasteHtmlTelemetryFix")&&Kf.includes(Vc.tagName)&&sc.add(Vc.tagName)});jb=Array.from(sc);G.push(...jb);ta=performance.now()-ta;I.ULS.sendTraceTag(507545676,0,50,`htmlClipboardItem.logPasteHtmlStructureTelemetry | tagAnalysisTotalTime: ${ta.toFixed(2)} ms, htmlTagAnalysisResult: ${JSON.stringify(G)}`)}}}bM(){return null==this.O_?!1:this.O_.bM}oak(G,ta,jb,sc,Vc){return new Promise((nd,
xd)=>{I.ULS.sendTraceTag(537167754,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${Vc.id}`);ta&&(ta=Ua.a.trimEnd(ta,"\n","\r"));I.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${Vc.id}`);if(ta)if(ta.length>this.Xbg)I.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",
ta.length,this.Xbg),xd(new Sc(1));else{let ke,V;const Wa=Lb.x(G,this.$);I.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${Vc.id}`);var Hd=!this.$.ea.isNamedObjectViewMode&&!ta.includes("\n")&&!ta.includes("\t");I.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${Vc.id}. treatAsLink=${Hd}`);Hd=Hd&&Ua.a.g0f(ta);I.ULS.sendTraceTag(537167750,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${Vc.id}. treatAsLink=${Hd}`);const Eb=this.$.pa.ta.Vh();if(Hd){V=526;I.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${Vc.id}`);const Jc=Si.a.Oyc(ta);I.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${Vc.id}`);const od=Lb.u(Wa);Hd=(Pd,
ge,Be)=>{const Ye=Vc.commandParameters.stopwatch.zi;Pd=Xc.c(Pd,gf=>{I.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${Vc.id}`);Vc.requestTelemetryData=gf.RequestTelemetryData;Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.zi-Ye;gf.Errors&&0<gf.Errors.length?xd(new Sc(2,gf.Errors)):nd(ta)});ge=Xc.b(ge,gf=>{Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.zi-Ye;gf=vc.a.gk(gf.data);xd(new Sc(2,
gf))});this.$.ZC();I.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${Vc.id}`);return ad.b(this.$.pa.ta,od,ta,Jc,!1,!1,63,Pd,ge,Be,G,Eb,sc)};ke=()=>new li.a(od,ta,Jc)}else V=180,Hd=(Jc,od,Pd)=>{this.$.ZC();const ge=Vc.commandParameters.stopwatch.zi;Jc=Xc.c(Jc,Be=>{I.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${Vc.id}`);lh.wDc(Be,
Vc,nd,xd,ge,this.$,ta,!1,null,null)});od=Xc.b(od,Be=>{Vc.serverRequestTimeInMs=Vc.commandParameters.stopwatch.zi-ge;Be=vc.a.gk(Be.data);xd(new Sc(4,Be))});I.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${Vc.id}`);return Pi(this.$.pa.Gyd,Wa,ta,this.bM(),Jc,od,Pd,null,Eb,sc)},ke=()=>new rh(Wa,ta);I.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${Vc.id}`);
Hd=new bc.a(V,0,Hd,65,ke);I.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${Vc.id}`);this.$.userOperationManager.enqueueOperation(Hd,jb)}else nd("")})}ESf(G,ta){ta=[1===ta?4:5];this.da.Gh.fQ(ze.a.P9a(Zd.d(this.$.ma),G),ta,!0);this.da.Gh.Nw(ta);this.da.Gh.update(!0)}PRd(){const G=[4,5];this.da.Gh.Mq(G,!1,!1);this.da.Gh.tt(null,G,!1);1===this.da.ha.Ck&&this.da.Nw(!1,!1);this.da.Gh.update(!1,!1)}BSh(G,ta,jb){const sc=[];for(const Vc of jb)sc.push(this.ISh(G,
ta,Vc));return sc}U9(){if(this.IB)for(const G of this.IB)if(this.$&&this.$.userOperationManager){if(G.operation){const ta=Zh.a(G.operation.operationName);I.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${ta}.`)}this.WTh();this.$.userOperationManager.Qva(G)}}WTh(){if(this.gza){const G=this.gza.uD;I.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${G}`);vc.a.fE(G);!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&
this.MYb&&ad.i(this.$.pa.ta,this.MYb,null,null,null);this.MYb=this.gza=null}}ISh(G,ta,jb){I.ULS.shipAssertTag(537167713,0,!!ta,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");I.ULS.shipAssertTag(537167712,0,0<ta.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let sc=0,Vc=0;var nd=new Set;const xd=new Set;for(const Hd of ta){ta=`${Hd.left}_${Hd.right}`;const ke=`${Hd.top}_${Hd.bottom}`;xd.has(ta)||(xd.add(ta),Vc+=Hd.width);nd.has(ke)||
(nd.add(ke),sc+=Hd.height)}if(36===G)return jb.isSingle?lh.oyf(Vc,sc,jb):jb.clone();516===G&&(G=sc,sc=Vc,Vc=G);G=!(jb.width%Vc)&&!(jb.height%sc);nd=jb.o1&&!(jb.height%sc);jb.tba&&!(jb.width%Vc)||nd?jb=lh.oyf(Vc,sc,jb):G?jb=jb.clone():(jb=jb.clone(),jb.bottom=Math.min(Gc.a.Rk,jb.top+sc-1),jb.right=Math.min(Gc.a.Gk,jb.left+Vc-1));return jb}tJh(G,ta,jb,sc,Vc,nd,xd,Hd,ke,V,Wa){if(!sc||!sc.length)return 1;if(1<sc.length){if(!this.GGc&&nd)return 3;if(V)return 0;if(Hd)return 9;if(ke)return 8;if(Wa)return 2;
if(1<ta.length)return 4;const Eb=ta[0];if(!xd&&!oh.a.all(sc,Jc=>Jc.isSingle||!(Jc.width%Eb.width)&&!(Jc.height%Eb.height)))return 5;if((!this.GGc||!nd)&&Ua.a.equals(G,jb,!0))for(const Jc of Vc)if(Jc.Xi(Eb)&&!Jc.equals(Eb))return 6}else if(ta&&0<ta.length){if(0!==this.bYf(ta,ke))return 7;if(1<ta.length){if(!this.GGc&&nd)return 3;if((!this.GGc||!nd)&&Ua.a.equals(G,jb,!0))for(const Eb of ta)if(G=Vc[0],Eb.Xi(G)&&!Eb.equals(G))return 6}}return 0}bYf(G,ta){if(!G||1>=G.length)return 0;if(ta)return 2;if(!Lb.Z(G))return 1;
ta=new Hh.a(Yg.a.zm());for(const jb of G)for(const sc of G){const Vc=jb.top===sc.top&&jb.bottom===sc.bottom,nd=jb.left===sc.left&&jb.right===sc.right,xd=Math.max(jb.left,sc.left)<Math.min(jb.right,sc.right);if(Math.max(jb.top,sc.top)<Math.min(jb.bottom,sc.bottom)&&!Vc||xd&&!nd)return 3;ta.add(`${jb.top}-${jb.bottom}-${sc.left}-${sc.right}`);ta.add(`${sc.top}-${sc.bottom}-${jb.left}-${jb.right}`)}for(const jb of G)ta.remove(`${jb.top}-${jb.bottom}-${jb.left}-${jb.right}`);return 0<ta.count?3:0}Ggk(G){const ta=
this.da.ha;ta.updateSelection(G,G.topLeft,0);ta.selectionType=-1}eCc(G){if(null===G||void 0===G?0:G.sourceItem){if(!ec(G.sourceItem))return null;if((G=G.sourceItem)&&Lb.mb(G.ranges,!0))return G}return null}qob(G,ta){I.ULS.shipAssertTag(537167711,0,!!G,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return ta&&Y.a.gF in ta||G.tabName?!1:1===G.method}static iAk(G,ta,jb,sc,Vc,nd,xd,Hd,ke){const V=G.pa.ta.Vh(ke?{yza:!0,gya:1}:{yza:!1,gya:0});ke=new bc.a(506,0,(Wa,Eb,Jc)=>{G.ZC();
var od=G.pa.ta;Wa=Xc.c(Wa,nd);Eb=Xc.b(Eb,xd);var Pd=Hd;Pd=void 0===Pd?null:Pd;const ge=od.$a(9,V);ge.sourceRanges=jb;ge.destinationRanges=sc;ge.flags=Vc;return ad.h(od,"PasteRange",ge,Wa,Eb,Jc,null,64,Pd)},65,()=>new Fi(jb,sc,Vc));G.userOperationManager.enqueueOperation(ke,ta)}static wDc(G,ta,jb,sc,Vc,nd,xd,Hd,ke,V){xd=void 0===xd?null:xd;I.ULS.sendTraceTag(537167710,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${ta.id}`);ta.requestTelemetryData=
G.RequestTelemetryData;ta.serverRequestTimeInMs=ta.commandParameters.stopwatch.zi-Vc;be.a.jl(G.Errors)?be.a.tua(G.Errors)?(ta&&(ta.encounteredDeploymentErrors=!0),G=be.a.Yh(G.Errors),I.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${G}`)):(G=new Sc(5,G.Errors),null===V||void 0===V?void 0:V(G),sc(G)):G.Result?(sc=!!G&&!!G.RequestTelemetryData,ha.f(nd).Hk.D1(ta.commandParameters.stopwatch.id,
G.StateId,sc?G.RequestTelemetryData.EcsOperationDuration:0,sc?G.RequestTelemetryData.EcsRequestDuration:0,sc?G.RequestTelemetryData.WfeRequestDuration:0),sc=G.Result,ta.pastedRange=sc.SheetMultiRange,I.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${ta.id}`),null===ke||void 0===ke?void 0:ke(),jb(!0),xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&Hd&&!ta.commandParameters.isDragDrop?(ta=za.a.nh(oa.te))&&ta.Dja(6,G):zb.a.hoa()&&sc.AutoAdjustedColumns&&void za.a.resolve(oa.q,{va:1}).then(Wa=>{Wa.mhg("Paste")})):(I.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${ta.id}`),jb(xd||!0))}static moe(G,ta,jb,sc,Vc,nd,xd,Hd,ke,V,Wa,Eb){const Jc=G.pa.ta.Vh(),od=lh.Tlf(jb,sc,Vc,V,Wa,Eb);jb=new bc.a(503,0,(Pd,ge,Be)=>{G.ZC();return Ei(G.pa.ta,
od,Xc.c(Pd,xd),Xc.b(ge,Hd),Be,nd,Jc,ke)},65,()=>new Gi(od));G.userOperationManager.enqueueOperation(jb,ta)}static Tlf(G,ta,jb,sc,Vc,nd){const xd={};xd.ShadowWorkbookBase64=G.shadowWorkbookBase64;xd.SourceRanges={};xd.SourceRanges.Ranges=Array(1);xd.SourceRanges.Ranges[0]={};xd.SourceRanges.Ranges[0].FirstRow=G.rangeRowStart;xd.SourceRanges.Ranges[0].LastRow=G.rangeRowEnd;xd.SourceRanges.Ranges[0].FirstColumn=G.rangeColumnStart;xd.SourceRanges.Ranges[0].LastColumn=G.rangeColumnEnd;xa.EwaSettings.getBooleanFeatureGate(kg.a.TMb,
!1)?jb?xd.DestinationRanges=Lb.w(jb.SheetName,jb.NamedObjectName,Lb.h(jb.Ranges)):(I.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),xd.DestinationRanges=null):xd.DestinationRanges=ta?Lb.u(ta):null;xd.CopyPasteTargetType=1;xd.PasteType=sc;xd.CopyOperationId=Vc;xd.PasteId=nd;xd.SourceClientPath=G.sourceClientPath;xd.SourceSheetName=G.sourceSheetName;xd.SourceWorkbookName=G.sourceWorkbookName;if(!G.originalSourceRangesCountExceedsLimit&&
G.originalSourceRanges&&0<G.originalSourceRanges.length&&1024===sc){xd.OriginalSourceMultiRange={};ta=Array(G.originalSourceRanges.length);for(jb=0;jb<ta.length;++jb)ta[jb]={},ta[jb].FirstRow=G.originalSourceRanges[jb][0],ta[jb].FirstColumn=G.originalSourceRanges[jb][1],ta[jb].LastRow=G.originalSourceRanges[jb][2],ta[jb].LastColumn=G.originalSourceRanges[jb][3];xd.OriginalSourceMultiRange.Ranges=ta}return xd}static oyf(G,ta,jb){jb=jb.clone();jb.height<ta&&(jb.bottom=Math.min(Gc.a.Rk,jb.top+ta-1));
jb.width<G&&(jb.right=Math.min(Gc.a.Gk,jb.left+G-1));return jb}JMk(G,ta,jb){return(G=ha.f(G).oh.Kl(jb))?ta.width===G.usedRange.width&&jb.left===G.usedRange.left||jb.left===G.usedRange.left&&jb.right===G.usedRange.right&&0===jb.width%ta.width:!1}IMk(G,ta,jb){return(G=ha.f(G).oh.Kl(jb))?ta.height===G.usedRange.height&&jb.top===G.usedRange.top||jb.top===G.usedRange.top&&jb.bottom===G.usedRange.bottom&&0===jb.height%ta.height:!1}executeInsertCopiedCutCellsOperation(G,ta,jb,sc,Vc,nd,xd){nd=void 0===nd?
null:nd;xd=void 0===xd?null:xd;const Hd={};Hd.InsertDirection=sc;Hd.SourceRange=G;Hd.DestRange=ta;Hd.CopyCutOperation=jb?0:1;const ke=this.$.pa.ta,V=this.$.pa.ta.Vh(),Wa=()=>new qi(Hd);return va.a(this.$.userOperationManager,(Eb,Jc,od)=>{Eb=nd?Xc.c(Eb,nd):Eb;Jc=xd?Xc.b(Jc,xd):Jc;const Pd=ke.$a(41,null);Pd.insertCopiedCutCellsParameters=Hd;return ad.h(ke,"InsertCopiedCutCellsV2",Pd,Eb,Jc,od,V,0)},Eb=>new bc.a(104,0,Eb,void 0,Wa),Vc)}jii(G,ta,jb,sc,Vc,nd,xd,Hd){return new Promise((ke,V)=>{this.executeInsertCopiedCutCellsOperation(ta,
jb,sc,Vc,nd,Wa=>{G.requestTelemetryData=Wa.RequestTelemetryData;if(Wa.Errors&&0<Wa.Errors.length){const Eb=new Sc(21,Wa.Errors);null===Hd||void 0===Hd?void 0:Hd(Eb);V(new Sc(21,Wa.Errors))}else null===xd||void 0===xd?void 0:xd(),ke(!0)},Wa=>{Wa=vc.a.gk(Wa.data);Wa=new Sc(21,Wa);null===Hd||void 0===Hd?void 0:Hd(Wa);V(Wa)})})}executeInsertCopiedCutCellsAcrossSession(G,ta,jb,sc,Vc,nd,xd,Hd,ke,V,Wa){nd=void 0===nd?null:nd;xd=void 0===xd?null:xd;const Eb={};Eb.PasteParameters=lh.Tlf(V,Hd,ke,2,Wa.copyContextSnapshot.commandParameters.id,
Wa.commandParameters.id);Eb.InsertDirection=sc;Eb.SourceRange=G;Eb.DestRange=ta;Eb.CopyCutOperation=jb?0:1;const Jc=this.$.pa.ta,od=this.$.pa.ta.Vh(),Pd=()=>new qi(Eb);return va.a(this.$.userOperationManager,(ge,Be,Ye)=>{ge=nd?Xc.c(ge,nd):ge;Be=xd?Xc.b(Be,xd):Be;const gf=Jc.$a(41,null);gf.insertCopiedCutCellsParameters=Eb;return ad.h(Jc,"InsertCopiedCutCellsCrossSession",gf,ge,Be,Ye,od,0)},ge=>new bc.a(106,0,ge,void 0,Pd),Vc)}}Object(D.a)(lh,"CopyPasteUtils",null,[909]);var vi=a(502),wi;(function(G){G[G.range=
0]="range";G[G.art=1]="art";G[G.nonGrid=2]="nonGrid";G[G.fullSheet=3]="fullSheet"})(wi||(wi={}));Object(D.b)("SourceItemType",wi);class Hi extends Ga{constructor(G,ta,jb){super(ta,jb);this.sheetName=G}isEqual(G){return G&&Object.getType(G)===Hi?this.cHc(G)&&this.sheetName===G.sheetName:!1}}Object(D.a)(Hi,"FullSheetSourceItem",Ga,[]);class Oh{constructor(G){this.WYg={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1,["SourceItemType.NonGrid"]:2,["SourceItemType.FullSheet"]:3};this.b9a={};this.SYg=
{["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.Wrd={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",
["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.VYg={["RibbonCommand.Copy"]:-911352779,["RibbonCommand.Cut"]:-1985798686,["RibbonCommand.WriteToClipboard"]:396830482,["RibbonCommand.FullSheetCopy"]:-207190267};this.dme={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut",
["396830482"]:"RibbonCommand.WriteToClipboard",["-207190267"]:"RibbonCommand.FullSheetCopy"};this.UYg={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.dya={};this.TYg={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.Nkb={};this.XYg={["UILocation.Unknown"]:0,["UILocation.UpperRibbon"]:1,
["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,["UILocation.ContextMenu"]:19,
["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.UA={};this.$=G;this.dya.notDefined="InputManager.InputMethod.NotDefined";this.dya.unknown="InputManager.InputMethod.Unknown";this.dya.keyboard="InputManager.InputMethod.Keyboard";this.dya.mouse="InputManager.InputMethod.Mouse";this.dya.touch="InputManager.InputMethod.Touch";this.dya.crossSlide="InputManager.InputMethod.CrossSlide";this.Nkb.none="FrameMode.None";
this.Nkb.reading="FrameMode.Reading";this.Nkb.edit="FrameMode.Edit";this.UA.unknown="UILocation.Unknown";this.UA.upperRibbon="UILocation.UpperRibbon";this.UA.ribbon="UILocation.Ribbon";this.UA.QAT="UILocation.QAT";this.UA.jewel="UILocation.Jewel";this.UA.navigationPane="UILocation.NavigationPane";this.UA.keyboardShortcut="UILocation.KeyboardShortcut";this.UA.statusBar="UILocation.StatusBar";this.UA.dialog="UILocation.Dialog";this.UA.floatie="UILocation.Floatie";this.UA.notificationBar="UILocation.NotificationBar";
this.UA.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.UA.taskPane="UILocation.TaskPane";this.UA.heroDock="UILocation.HeroDock";this.UA.singleLineRibbon="UILocation.SingleLineRibbon";this.UA.multilineRibbon="UILocation.MultilineRibbon";this.UA.overflow="UILocation.Overflow";this.UA.tellMe="UILocation.TellMe";this.UA.farPeripheralControls="UILocation.FarPeripheralControls";this.UA.header="UILocation.Header";this.UA.fileMenu="UILocation.FileMenu";this.UA.contextMenu="UILocation.ContextMenu";
this.UA.dialogMenu="UILocation.DialogMenu";this.UA.toolbar="UILocation.Toolbar";this.UA.canvas="UILocation.Canvas";this.b9a.range="SourceItemType.Range";this.b9a.art="SourceItemType.Art";this.b9a.nonGrid="SourceItemType.NonGrid";this.b9a.fullSheet="SourceItemType.FullSheet"}serializeSourceItem(G){const ta={};if(G&&Object.getType(G)===eb)ta.sheetName=G.sheetName,ta.topArray=oh.a.map(G.ranges,jb=>jb.top),ta.leftArray=oh.a.map(G.ranges,jb=>jb.left),ta.bottomArray=oh.a.map(G.ranges,jb=>jb.bottom),ta.rightArray=
oh.a.map(G.ranges,jb=>jb.right),ta.sessionStateId=G.sessionStateId,ta.sessionId=G.sessionId,ta.sourceItemType=this.VXc(0);else if(G&&Object.getType(G)===Qb)ta.activeFloatingObjectControlId=G.activeFloatingObjectControlId,ta.sheetName=G.sheetName,ta.sessionStateId=G.sessionStateId,ta.sessionId=G.sessionId,ta.floatingObjectType=this.TAk(G.type),ta.sourceItemType=this.VXc(1);else if(G&&Object.getType(G)===S)ta.sessionStateId=G.sessionStateId,ta.sessionId=G.sessionId,ta.sourceItemType=this.VXc(2);else if(G&&
Object.getType(G)===Hi)ta.sheetName=G.sheetName,ta.sessionStateId=G.sessionStateId,ta.sessionId=G.sessionId,ta.sourceItemType=this.VXc(3);else return I.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(ta)}serializeCommandParameters(G){if(!G)return I.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const ta={};ta.id=G.id;ta.commandType=
G.commandType;ta.copyPasteTargetType=G.copyPasteTargetType;G.ribbonCommandInfo&&(ta.ribbonCommandName=this.cBk(G.ribbonCommandInfo.command),ta.inputMethodName=this.XAk(G.ribbonCommandInfo.method),ta.frameModeName=this.VAk(G.ribbonCommandInfo.mode),ta.uiLocationName=this.gBk(G.ribbonCommandInfo.jk),ta.tabName=G.ribbonCommandInfo.tabName);return JSON.stringify(ta)}deserializeSourceItem(G){if(!G)return null;try{const ta=JSON.parse(G);if(!ta)return I.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),
null;let jb=null;switch(this.Tdi(ta.sourceItemType)){case 0:jb=new eb(this.$,this.Qdi(ta),ta.sheetName,ta.sessionStateId,ta.sessionId);break;case 1:jb=new Qb(ta.activeFloatingObjectControlId,ta.sheetName,ta.sessionStateId,ta.sessionId,this.Ndi(ta.floatingObjectType));break;case 2:jb=new S(ta.sessionStateId,ta.sessionId);break;case 3:jb=new Hi(ta.sheetName,ta.sessionStateId,ta.sessionId)}return jb}catch(ta){return I.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${G?
G.length:0}, errror: ${ta}`),null}}deserializeCommandParameters(G){if(!G)return null;try{const ta=JSON.parse(G);if(!ta)return I.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const jb=Se.a();jb.id=ta.id;jb.ribbonCommandInfo=this.Sdi(ta);jb.commandType=ta.commandType;jb.copyPasteTargetType=ta.copyPasteTargetType;return jb}catch(ta){return I.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${G?
G.length:0}, errror: ${ta}`),null}}Qdi(G){const ta=[];I.ULS.shipAssertTag(537167699,0,!!G.topArray&&0<G.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${G.topArray?"empty":"null"}.`);I.ULS.shipAssertTag(537167698,0,!!G.leftArray&&0<G.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${G.leftArray?"empty":"null"}.`);I.ULS.shipAssertTag(537167697,0,!!G.bottomArray&&0<G.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${G.bottomArray?
"empty":"null"}.`);I.ULS.shipAssertTag(537167696,0,!!G.rightArray&&0<G.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${G.rightArray?"empty":"null"}.`);if(!(G.topArray&&G.leftArray&&G.bottomArray&&G.rightArray))return ta;I.ULS.shipAssertTag(537167695,0,G.topArray.length===G.bottomArray.length&&G.topArray.length===G.leftArray.length&&G.topArray.length===G.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${G.topArray.length}), BottomArray(${G.bottomArray.length}), LeftArray(${G.leftArray.length}), RightArray(${G.rightArray.length}) should be the same.`);
const jb=Math.min(G.topArray.length,G.bottomArray.length,G.leftArray.length,G.rightArray.length);for(let sc=0;sc<jb;sc++)ta.push(new yb.Range(G.topArray[sc],G.leftArray[sc],G.bottomArray[sc],G.rightArray[sc],!1,!1));return ta}Sdi(G){return new Ib.a(this.Rdi(G.ribbonCommandName),this.Pdi(G.inputMethodName),this.Odi(G.frameModeName),this.Vdi(G.uiLocationName),G.tabName)}cBk(G){return void 0!==G&&null!==G&&G.toString()in this.dme?this.dme[G.toString()]:(I.ULS.shipAssertTag(537167694,0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${G}`),
this.dme["-911352779"])}Rdi(G){return G&&G in this.VYg?this.VYg[G]:(I.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${G}`),-911352779)}XAk(G){return void 0!==G&&null!==G&&Ng.a[G]in this.dya?this.dya[Ng.a[G]]:(I.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${G}`),this.dya.unknown)}Pdi(G){return G&&
G in this.UYg?this.UYg[G]:(I.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${G}`),0)}VAk(G){return void 0!==G&&null!==G&&vi.a[G]in this.Nkb?this.Nkb[vi.a[G]]:(I.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${G}`),this.Nkb.edit)}Odi(G){return G&&G in this.TYg?this.TYg[G]:(I.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${G}`),
2)}VXc(G){return void 0!==G&&null!==G&&wi[G]in this.b9a?this.b9a[wi[G]]:(I.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${G}`),this.b9a.range)}Tdi(G){return G&&G in this.WYg?this.WYg[G]:(I.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${G}`),0)}TAk(G){return void 0!==G&&null!==G&&G.toString()in this.Wrd?this.Wrd[G.toString()]:(I.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${G}`),
this.Wrd["99"])}Ndi(G){return G&&G in this.SYg?this.SYg[G]:(I.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${G}`),99)}gBk(G){return void 0!==G&&null!==G&&Ig.a[G]in this.UA?this.UA[Ig.a[G]]:(I.ULS.shipAssertTag(36229129,0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${G}`),this.UA.ribbon)}Vdi(G){return G&&G in this.XYg?this.XYg[G]:(I.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${G}`),
2)}}Object(D.a)(Oh,"EnvironmentSerializationHelper",null,[]);class Wf{}Wf.OKg="SameSession";Wf.pAd="CrossSession";Wf.R6f="LegacyCrossSession";Wf.external="External";Object(D.a)(Wf,"PayloadOrigin",null,[]);const Kg=G=>G?G.shadowWorkbookSizeExceedsLimit&&void 0!==G.shadowWorkbookBlockedSize&&null!==G.shadowWorkbookBlockedSize?G.shadowWorkbookBlockedSize:G.shadowWorkbookBase64?G.shadowWorkbookBase64.length:0:0,Ph=G=>G.shadowWorkbookSizeExceedsLimit?!0:Kg(G)>Gc.a.aNc;var hh=a(101);class Ih{constructor(G,
ta,jb){jb=void 0===jb?null:jb;this.IVa=!1;this._name=ta;this.$=G;this.Vq=ka.a.instance;this.kA=new lh(G,ha.f(G));this.kMb=jb}get name(){return this._name}get jJb(){return this.Vq.Ea(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}P3k(G){let ta;ta=null;try{const jb=G.getItem(pd.a.shadowWorkbook);if(!jb)return{returnValue:!1,zN:ta};ta=JSON.parse(jb);return{returnValue:this.qtj(ta),zN:ta}}catch(jb){return I.ULS.sendTraceTag(537167835,0,50,
"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+jb),{returnValue:!1,zN:ta}}}qtj(G){return!!G&&(!!G.shadowWorkbookBase64||G.shadowWorkbookSizeExceedsLimit)&&void 0!==G.rangeRowStart&&void 0!==G.rangeRowEnd&&void 0!==G.rangeColumnStart&&void 0!==G.rangeColumnEnd}FRc(G){G.wasLastCopyExternal=!0;xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&G.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(G.commandParameters.commandType=
-185374993===this.$.shortcutKeyManager.yuc?20:4);if(kg.a.d1a&&516!==G.commandParameters.commandType&&1028!==G.commandParameters.commandType){let ta=null;if((()=>{let jb=this.P3k(G.clipboardItems);({zN:ta}=jb);return jb})().returnValue)return G.isShadowWorkbookParsedSuccessfully=!0,this.n5j(G,ta)}if(516!==G.commandParameters.commandType&&36!==G.commandParameters.commandType&&4100!==G.commandParameters.commandType){if(20!==G.commandParameters.commandType){const ta=G.clipboardItems.getItem(pd.a.html),
jb=this.e4f(ta),sc=G.clipboardItems.getItem(pd.a.Ksc),Vc=Ia.f(G.clipboardItems.getItem(pd.a.plainText));return!jb||!sc&&Vc?(Vc&&I.ULS.sendTraceTag(508863578,0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.hce(G)):this.mug(G,ta,void 0===sc?null:sc)}return this.hce(G)}return Promise.reject(new Sc(6))}n5j(G,ta){I.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");G.pasteResult="SystemClipboardShadowWorkbookPaste";
G.payloadType=Yf.shadowWorkbook;G.payloadOrigin=Wf.external;G.shadowWorkbookPayloadSize=Kg(ta);G.shadowWorkbookSizeExceedsLimit=Ph(ta);let jb=null,sc=null;const Vc=G.commandParameters.originalDestinations;xa.EwaSettings.getBooleanFeatureGate(kg.a.TMb,!1)?jb=Lb.t(Vc,this.$):sc=Lb.x(Lb.R(Vc),this.$);ta.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(G.originalSourceRangesCountExceedsLimit=ta.originalSourceRangesCountExceedsLimit);if(G.shadowWorkbookSizeExceedsLimit)return I.ULS.sendTraceTag(537167833,
0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${G.shadowWorkbookPayloadSize}) is over the limit(${Gc.a.aNc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${ta.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new Sc(1));I.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${G.commandParameters.id}`);return this.kA.qug(G.commandParameters.ribbonCommandInfo,sc,jb,ta,[G.commandParameters.stopwatch],
G)}hce(G){var ta=G.clipboardItems.getItem(pd.a.plainText);if(void 0!==ta&&null!==ta&&ta.trim()===this.jJb)return Promise.reject(new Sc(7));void 0!==ta&&null!==ta&&(G.plainTextPayloadSize=ta.length);let jb=!1;null!==this.kMb&&(jb=this.kMb.NKh(G,Ua.a.trimEnd(ta,"\n","\r"),Lb.R(G.commandParameters.originalDestinations)));jb&&ha.f(this.$).Hk.rT(G.commandParameters.stopwatch.id,yg.BasicTelemetryCalculator.bS);this.IVa||(this.IVa=!0,hh.b("AutoAdjustColumnWidthTriggered"));G.isPlainTextPaste=!0;G.pasteResult=
"SystemClipboardPaste";G.payloadOrigin=Re(G)?Wf.R6f:Wf.external;G.payloadType=Yf.plainText;I.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${G.id}, PasteOperationId=${G.commandParameters.id}`);ta=this.kA.oak(Lb.R(G.commandParameters.originalDestinations),ta,G.commandParameters.ribbonCommandInfo,[G.commandParameters.stopwatch],G);I.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${G.id}`);
return ta}mug(G,ta,jb){this.IVa||(this.IVa=!0,hh.b("AutoAdjustColumnWidthTriggered"));G.htmlPayloadSize=ta.length;G.isHtmlPaste=!0;G.pasteResult="SystemClipboardHtmlPaste";G.payloadType=Yf.html;G.payloadOrigin=Re(G)?Wf.R6f:Wf.external;G.cseStatus=3;I.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${G.commandParameters.id}`);return this.kA.nak(Lb.R(G.commandParameters.originalDestinations),ta,jb,G.commandParameters.id,G.commandParameters.ribbonCommandInfo,
[G.commandParameters.stopwatch],G,this.kMb)}$zd(G){const ta={};G&&(ta.shadowWorkbookBase64=G.ShadowWorkbookBase64,ta.shadowWorkbookSizeExceedsLimit=G.ShadowWorkbookSizeExceedsLimit,ta.originalSourceRangesCountExceedsLimit=G.OriginalSourceRangesCountExceedsLimit,ta.originalSourceRangesCount=G.OriginalSourceRangesCount,ta.shadowWorkbookBlockedSize=G.ShadowWorkbookBlockedSize);return ta}I8g(G,ta){const jb=de(G),sc=32===(G.commandParameters.commandType&32),Vc=1024===(G.commandParameters.commandType&1024);
let nd=!1,xd=null,Hd=null,ke=!1;if(!jb){nd=-1985798686===G.commandParameters.ribbonCommandInfo.command;var V=G.copyContextSnapshot;if(ta)ke=!V.sourceItem.isFromCurrentSession(this.$);else if(V=this.kA.eCc(V))xd=V.ranges,Hd=V.sheetName,ke=!G.isSameSession}return this.kA.tJh(Hd,xd,this.$.ma.sheetName,G.commandParameters.originalDestinations,G.commandParameters.expandDestinations,ke,sc,Vc,nd,ta,jb)}e4f(G){return!(void 0===G||null===G)&&!!G&&G.trim()!==this.jJb&&(G.startsWith("<")||da.a.Am&&G.startsWith("\n<"))}}
Object(D.a)(Ih,"BaseCopyPasteHandler",null,[915,901,916]);class Jh{constructor(G){this.clipboardItems=this.key=null;this.a0=G}CK(G){return this.key&&this.key.isEqual(G)?this.createClipboardItems(this.clipboardItems):null}setValue(G,ta){this.key=G;this.clipboardItems=this.createClipboardItems(ta)}createClipboardItems(G){const ta=this.a0.create();var jb=G.getItem(pd.a.plainText);jb&&ta.setItem(pd.a.plainText,jb);(jb=G.getItem(pd.a.shadowWorkbook))&&ta.setItem(pd.a.shadowWorkbook,jb);(G=G.getItem(pd.a.html))&&
ta.setItem(pd.a.html,G);return ta}}Object(D.a)(Jh,"CopyCache",null,[]);class xi extends Ih{constructor(G,ta,jb,sc,Vc){Vc=void 0===Vc?null:Vc;super(G,sc,ta);this.kMb=ta;this.a0=jb;this.iMb=Vc||new Jh(this.a0);this.da=ha.f(G);this.ha=this.da.ha;xa.EwaSettings.wVd()||(this.clipboardRangeFactory=G.la.kh(169))}getSourceItem(){const G=Lb.d(this.da.ha.qa.selectedRanges);return new eb(this.$,G,this.$.ea.ma.sheetName,this.$.ea.Ek,this.$.ua.UserSessionId)}beforeSerialize(G){G.isSelectionAllowed=!1;G.isAsyncCopy=
!1;G.isFromCache=!1;G.encounteredDeploymentErrors=!1;G.plainTextPayloadSize=0;G.shadowWorkbookPayloadSize=0;G.htmlPayloadSize=0;G.clientSideCopyTime=0;if(!G.isFullSheetCopy){var ta=new Kd.a(this.$.sa),jb=G.sourceItem;G.isSelectionAllowed=oh.a.all(jb.ranges,sc=>this.isSelectionAllowed(ta,sc));G.isSelectionAllowed&&this.kA.ESf(jb.ranges,G.commandParameters.commandType)}}q2a(G){return this.da.za.l6()&&ha.h(this.da,G)}Q5j(G,ta,jb,sc){if(!this.$.sa.Lq(jb.sheetName))return Promise.reject(new Sc(5));let Vc=
!1;const nd=1===ta.commandParameters.commandType,xd=sc[0].uz;1===jb.ranges.length&&1===sc.length?nd&&1!==xd&&xd!==jb.ranges[0].uz?G.cseStatus=17:Vc=this.kMb.LCd(G,Lb.R(jb.ranges),jb.sheetName,Lb.R(G.commandParameters.expandDestinations),nd):G.cseStatus=5;Vc&&ha.f(this.$).Hk.rT(G.commandParameters.stopwatch.id,yg.BasicTelemetryCalculator.bS);return this.v5j(G,jb,Lb.w(this.$.ma.sheetName,null,sc),ta.commandParameters.commandType,Vc)}isSelectionAllowed(G,ta){return G.qpb(ta,this.da)}v5j(G,ta,jb,sc,Vc){ta=
Lb.w(ta.sheetName,null,ta.ranges);G.pasteResult="SameSessionPaste";G.payloadOrigin=Wf.OKg;G.payloadType=Yf.Dwh;I.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${G.commandParameters.id}`);return this.kA.pasteRange(G.commandParameters.ribbonCommandInfo,ta,jb,sc,G.commandParameters.commandType,[G.commandParameters.stopwatch],G,Vc,null,null)}}Object(D.a)(xi,"BaseRangeCopyPasteHandler",Ih,[]);class mh{constructor(G){this.Z4=new ob.a(!0);
this.$=G}onDeferredPasteStarted(G){this.Z4.lh(G.id)||this.Z4.add(G.id,!0);if(0<this.Z4.count)if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void za.a.resolve(oa.C,{va:0}).then(ta=>{ta.Om(28,null)});else{const ta=Object(mc.d)(za.a.resolve(oa.C,{va:0}));Db.TaskExtensions.Xa(ta,()=>{ta.result.Om(28,null)},this.$.ya,3)}}onDeferredPasteCompleted(G){const ta=0<this.Z4.count;this.Z4.lh(G.id)&&this.Z4.remove(G.id);if(ta&&!this.Z4.count)if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",
!1))void za.a.resolve(oa.C,{va:0}).then(jb=>{jb.removeEntry(28)});else{const jb=Object(mc.d)(za.a.resolve(oa.C,{va:0}));Db.TaskExtensions.Xa(jb,()=>{jb.result.removeEntry(28)},this.$.ya,3)}}}Object(D.a)(mh,"DeferredPasteTracker",null,[]);var Od;(function(G){G[G.none=0]="none";G[G.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";G[G.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";G[G.asyncCopyCanceled=3]="asyncCopyCanceled";G[G.loadCopiedArtDataFromServerFailed=4]=
"loadCopiedArtDataFromServerFailed"})(Od||(Od={}));Object(D.b)("CopyErrorType",Od);class pe extends Hb{constructor(G,ta){ta=void 0===ta?null:ta;super(Od[G]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=G;this.ewaErrors=ta;if(null===ta||void 0===ta?0:ta.length)this.innerError=new uc(ta,null)}}Object(D.a)(pe,"CopyInnerError",Hb,[]);var ph=a(718);class Eg extends xi{constructor(G,ta,jb,sc){super(G,ta,jb,"AcrossSessionRangeCopyPasteHandler",void 0===sc?null:sc);this.Z4=new mh(G)}serialize(G){const ta=
G.sourceItem,jb={};let sc=this.iMb.CK(ta);if(sc)jb.synchronousResult=sc,G.isFromCache=!0,G.clientSideCopyTime=G.commandParameters.stopwatch.zi;else{let nd=null;var Vc=Lb.K(ta.ranges);if(!zb.a.z_f()&&this.q2a(Vc)){I.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Vc=xa.EwaSettings.wVd()?new ph.a(this.da,Vc):this.clipboardRangeFactory.create(Vc);try{nd=Vc.toString(),sc=this.a0.create(),sc.setItem(pd.a.plainText,
nd),this.iMb.setValue(ta,sc),jb.synchronousResult=sc,G.clientSideCopyTime=G.commandParameters.stopwatch.zi}finally{Vc&&Vc.dispose()}}else G.isAsyncCopy=!0,jb.synchronousResult=this.a0.create(),jb.synchronousResult.setItem(pd.a.plainText,this.jJb);jb.asynchronousResult=this.i_a(G,ta,nd)}G.syncClipboardItemsKeys=ib(jb.synchronousResult);return jb}shouldWaitForCopyToComplete(G){if(!G||!G.copyContextSnapshot)return I.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),
!1;I.ULS.shipAssertTag(537167906,0,!!this.$.ua,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(G.copyContextSnapshot.sessionId===this.$.ua.UserSessionId)return I.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;I.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(G){this.Z4.onDeferredPasteStarted(G)}onDeferredPasteCompleted(G){this.Z4.onDeferredPasteCompleted(G)}deserialize(G){var ta;
G.isClipboardDataContainShadowWorkbook=!(void 0===G.clipboardItems.getItem(pd.a.shadowWorkbook)||null===G.clipboardItems.getItem(pd.a.shadowWorkbook));if(ha.f(this.$).ha.Ck&326)return de(G)&&(G.wasLastCopyExternal=!0),Promise.reject(new Sc(17));var jb=this.I8g(G,!1);if(0!==jb)return Promise.reject(new Sc(de(G)?18:G.isSameSession?19:20,void 0,void 0,void 0,jb));jb=G.copyContextSnapshot;var sc=this.kA.eCc(jb);if(de(G)||(null===(ta=G.copyContextSnapshot)||void 0===ta?0:ta.sourceItem)&&Lc(G.copyContextSnapshot.sourceItem))return this.FRc(G);
ta=G.commandParameters.originalDestinations;if(sc&&G.isSameSession)return this.Q5j(G,jb,sc,ta);if(516!==G.commandParameters.commandType){let Vc=null;if((()=>{let nd=this.tac(G.clipboardItems);({zN:Vc}=nd);return nd})().returnValue)return G.isShadowWorkbookParsedSuccessfully=!0,sc=jb=null,xa.EwaSettings.getBooleanFeatureGate(kg.a.TMb,!1)?jb=Lb.t(ta,this.$):sc=Lb.x(Lb.R(ta),this.$),this.k5j(G,sc,jb,Vc);if(G.isClipboardInaccessible)return Promise.reject(new Sc(8));if(36!==G.commandParameters.commandType)return this.hce(G)}return Promise.reject(new Sc(6))}beforePaste(G){oa.Be.Aa()?
za.a.nh(oa.Be).MLg(G):this.$.la.kh(373).MLg(G);G.indicationDisplayScheduled=!0}wye(G){let ta;if(!(G&&G.SourceRanges&&G.SourceRanges.Ranges&&G.SourceRanges.Ranges.length&&(G.OriginalSourceRangesCountExceedsLimit||G.OriginalSourceMultiRange&&G.OriginalSourceMultiRange.Ranges&&G.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,zN:null};var jb=G.SourceRanges.Ranges[0];if(!G.ShadowWorkbookBase64&&!G.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,zN:null};ta=this.$zd(G);ta.rangeRowStart=
jb.FirstRow;ta.rangeRowEnd=jb.LastRow;ta.rangeColumnStart=jb.FirstColumn;ta.rangeColumnEnd=jb.LastColumn;ta.sourceClientPath=G.SourceClientPath;ta.sourceSheetName=G.SourceSheetName;ta.sourceWorkbookName=G.SourceWorkbookName;if(!G.OriginalSourceRangesCountExceedsLimit)for(G=G.OriginalSourceMultiRange.Ranges,ta.originalSourceRanges=Array(G.length),jb=0;jb<G.length;++jb)ta.originalSourceRanges[jb]=[G[jb].FirstRow,G[jb].FirstColumn,G[jb].LastRow,G[jb].LastColumn];return{returnValue:!0,zN:ta}}tac(G){let ta;
ta=null;G=G.getItem(pd.a.shadowWorkbook);if(!G)return{returnValue:!1,zN:ta};ta=JSON.parse(G);return{returnValue:this.M_d(ta),zN:ta}}i_a(G,ta,jb){I.ULS.shipAssertTag(537167901,0,!!G,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const sc=G.commandParameters.stopwatch.zi,Vc=Lb.w(ta.sheetName,null,ta.ranges);return new Promise((nd,xd)=>{I.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${G.id}`);
this.kA.copy(Vc,G.commandParameters,Hd=>{G.requestTelemetryData=Hd.RequestTelemetryData;G.serverRequestTimeInMs=G.commandParameters.stopwatch.zi-sc;if(be.a.jl(Hd.Errors))if(be.a.tua(Hd.Errors))G.encounteredDeploymentErrors=!0,Hd=be.a.Yh(Hd.Errors),I.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Hd}. copy Id: ${G.id}`);else{var ke=be.a.Yh(Hd.Errors);if(be.a.ko(Hd.Errors,
[-591377245])){var V=this.FE(Vc);if(V){V=String.format(this.Vq.sh(218),V.toLocaleUpperCase());var Wa=Hd.Errors.findIndex(od=>-591377245===od.MessageId);Hd.Errors[Wa].Description=V;I.ULS.sendTraceTag(509125507,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${G.id}`)}}I.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ke}. copy Id: ${G.id}`);
xd(new pe(2,Hd.Errors))}else if(I.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${G.id}`),G.markForCancellation)xd(new pe(3,Hd.Errors));else{var Eb=Hd.Result;V=Eb.PlainTextResult;void 0!==jb&&null!==jb&&(V=jb);void 0!==V&&null!==V&&(G.plainTextPayloadSize=V.length);ke=this.a0.create();var Jc;(()=>{let od=this.wye(Eb);({zN:Jc}=od);return od})().returnValue&&(G.shadowWorkbookPayloadSize=Kg(Jc),G.shadowWorkbookSizeExceedsLimit=
Ph(Jc),G.originalSourceRangesCountExceedsLimit=Eb.OriginalSourceRangesCountExceedsLimit,Wa=JSON.stringify(Jc),ke.setItem(pd.a.shadowWorkbook,Wa));ke.setItem(pd.a.plainText,V);zb.a.z_f()&&(V=Eb.HtmlResult,G.htmlSizeExceedsLimit=Eb.HtmlSizeExceedsLimit,void 0!==V&&null!==V&&(G.htmlPayloadSize=V.length),ke.setItem(pd.a.html,V));G.copyTotalSizeExceedsLimit=Eb.CopyTotalSizeExceedsLimit;ke.setItem(pd.a.Ksc,G.commandParameters.id);this.iMb.setValue(ta,ke);G.asyncClipboardItemsKeys=ib(ke);nd(ke);xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&(ke=1===G.commandParameters.commandType?8:7,(V=za.a.nh(oa.te))&&V.Dja(ke,Hd))}},Hd=>{G.serverRequestTimeInMs=G.commandParameters.stopwatch.zi-sc;Hd=vc.a.gk(Hd.data);const ke=be.a.Yh(Hd);I.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ke}. copy Id: ${G.id}`);xd(new pe(2,Hd))},[G.commandParameters.stopwatch])})}M_d(G){return!!G&&(!!G.shadowWorkbookBase64||G.shadowWorkbookSizeExceedsLimit)&&void 0!==G.rangeRowStart&&
void 0!==G.rangeRowEnd&&void 0!==G.rangeColumnStart&&void 0!==G.rangeColumnEnd}k5j(G,ta,jb,sc){I.ULS.shipAssertTag(537167903,0,!!sc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");G.pasteResult="CrossSessionPaste";G.payloadOrigin=Wf.pAd;G.payloadType=Yf.shadowWorkbook;G.shadowWorkbookPayloadSize=Kg(sc);G.shadowWorkbookSizeExceedsLimit=Ph(sc);G.cseStatus=3;sc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(G.originalSourceRangesCountExceedsLimit=
sc.originalSourceRangesCountExceedsLimit);if(G.shadowWorkbookSizeExceedsLimit)return I.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${G.shadowWorkbookPayloadSize}) is over the limit(${Gc.a.aNc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${sc.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new Sc(1));if(1028===G.commandParameters.commandType&&G.originalSourceRangesCountExceedsLimit)return I.ULS.sendTraceTag(572617859,
0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${sc.originalSourceRangesCount}) is over the limit(${Gc.a.$Ej}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${sc.originalSourceRangesCountExceedsLimit}`),Promise.reject(new Sc(1));I.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${G.commandParameters.id}`);return this.kA.qug(G.commandParameters.ribbonCommandInfo,
ta,jb,sc,[G.commandParameters.stopwatch],G)}FE(G){return null==G||null==G.Ranges||0===G.Ranges.length?(I.ULS.sendTraceTag(509125506,0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===G.Ranges.length?Lb.F(G.Ranges[0]):Lb.K(Lb.h(G.Ranges))).toString()}}Object(D.a)(Eg,"AcrossSessionRangeCopyPasteHandler",xi,[]);var Ji=a(1297);class yi{constructor(G,ta,jb,sc,Vc,nd,xd){this.floatingObjectId=G;this.commandParameters=ta;this.oQ=jb;this.Tai=sc;this.uwa=void 0===nd?null:
nd;this.XAe=void 0===xd?null:xd;this.f3h=Vc}}Object(D.a)(yi,"CopyArtRequest",null,[]);class Eh{constructor(G,ta,jb,sc,Vc,nd,xd,Hd,ke){this.promise=null;this.ribbonCommandInfo=G;this.destination=ta;this.Wof=jb;this.XAe=Vc;this.zN=nd;this.item=xd;this.pasteContext=Hd;this.E3a=jb||ta.FirstRow+"_"+ta.FirstColumn;this.Z_f=!0;this.agf=ke}}Object(D.a)(Eh,"PasteArtRequest",null,[]);class Ki{constructor(G,ta){this.N5b=new Ha.a;this.fWa=G;this.$=ta;this.Sak=jb=>Promise.resolve(jb);this.D1b=jb=>Promise.reject(jb)}M4i(G){if(this.Qoj(G.E3a)){I.ULS.sendTraceTag(537167681,
5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${G.E3a}`);const ta=this.N5b.na(G.E3a);this.N5b.ga(G.E3a,G);const jb=ta.promise;ta.Z_f=!1;return this.sli(G,jb)}this.N5b.ga(G.E3a,G);return this.nwj(G)}Qoj(G){return this.N5b.lh(G)}nwj(G){return new Promise((ta,jb)=>{G.promise=this.fWa.lug(G).then(sc=>{ta(null);return this.cQc(G,sc)},sc=>{jb(null);return this.D1b(sc)})})}sli(G,ta){return new Promise((jb,sc)=>{G.promise=ta.then(Vc=>{this.I9k(G,
Vc);return this.fWa.lug(G).then(nd=>{jb(null);return this.cQc(G,nd)},nd=>{sc(null);return this.D1b(nd)})},Vc=>this.D1b(Vc))})}cQc(G,ta){G.Z_f&&(this.wXh(G.E3a),this.Pne(G,ta));return this.Sak(ta)}wXh(G){this.N5b.remove(G)}Pne(G,ta){const jb=this.dWi();G.E3a===jb&&this.fWa.Pne(G.destination,ta,G.item.type)}dWi(){var G=ha.f(this.$).ha.$e.activeFloatingObjectControlId;G||(G=Lb.x(ha.f(this.$).ha.qa.activeCell,this.$),G=G.FirstRow+"_"+G.FirstColumn);return G}I9k(G,ta){G.destination=null;G.Wof=ta}}Object(D.a)(Ki,
"PasteArtRequestManager",null,[]);var Kh=a(212);class Li extends Ih{constructor(G,ta,jb,sc,Vc){Vc=void 0===Vc?null:Vc;super(G,"ArtCopyPasteHandler");this.nYh="XLO";this.oYh="3";this.Z4=new mh(G);this.a0=ta;this.fWa=jb;this.ha=ha.f(G).ha;this.Isc=Vc||new Jh(this.a0);this.l5j=new Ki(jb,G);this.iJb=sc}getSourceItem(){I.ULS.shipAssertTag(537167896,0,!!this.ha.$e.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");I.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ha.$e.activeFloatingObjectControlId}]`);
return new Qb(this.ha.$e.activeFloatingObjectControlId,this.$.ea.ma.sheetName,this.$.ea.Ek,this.$.ua.UserSessionId,this.ha.$e.Lh.floatingObject.type)}beforeSerialize(G){G&&G.commandParameters?(bh(G),G.commandParameters.copyPasteTargetType=2):I.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(G){const ta=G.sourceItem,jb={};if(!ta)return I.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),
jb;if(!this.bsj())return I.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),jb;I.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${ta.activeFloatingObjectControlId}]`);this.Hde();let sc=this.Isc.CK(ta);if(sc)jb.synchronousResult=sc,G.isFromCache=!0,G.isAsyncCopy=!1,G.clientSideCopyTime=G.commandParameters.stopwatch.zi,1===G.commandParameters.commandType&&
this.$.si(2045211913,G.commandParameters.ribbonCommandInfo.method,G.commandParameters.ribbonCommandInfo.jk,null);else{G.isFromCache=!1;G.isAsyncCopy=!0;sc=this.a0.create();if(G.commandParameters.uploadToClipService){const Vc={};Vc["data-clipservice-ccpid"]=G.commandParameters.id;Vc["data-pkey"]=G.commandParameters.pKey;Vc["data-clipservice-type"]=G.commandParameters.clipServiceDataType;Vc["data-clipservice-count"]=G.commandParameters.objectCount.toString();Vc["data-clipservice-dc"]=G.commandParameters.clipServiceDataCenter;
Vc["data-clipservice-client"]=this.nYh;Vc["data-TimeStamp"]=(new Date).toUTCString();Vc["data-clipservice-version"]=this.oYh;sc.setItem(pd.a.IFh,JSON.stringify(Vc))}zb.a.Aya()?(jb.synchronousResult=this.dYi(sc),jb.asynchronousResult=this.YEi(G,ta,sc)):(jb.synchronousResult=this.C2e(sc),jb.asynchronousResult=this.i_a(G,ta,sc))}G.syncClipboardItemsKeys=ib(jb.synchronousResult);return jb}dYi(G){return this.ha.$e.Lh.floatingObject.cba?(G.setItem(pd.a.plainText,this.jJb),G):this.C2e(G)}C2e(G){I.ULS.shipAssertTag(537167891,
0,!!this.ha.$e.Lh,"Expecting a floating object to be currently selected for copy");G||(G=this.a0.create());const ta=this.ha.$e.Lh.NQb();ta&&G.setItem(pd.a.html,`<img src='${ta}'>`);return G}Hde(){const G=this.ha.$e.Lh;this.iJb.Hde(Qa.a.lhb(G.floatingObject),Qa.a.qYh(G.Cz))}shouldWaitForCopyToComplete(){I.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(G){this.Z4.onDeferredPasteStarted(G)}onDeferredPasteCompleted(G){this.Z4.onDeferredPasteCompleted(G)}deserialize(G){var ta=
de(G),jb=null;let sc=null;var Vc=!1;if(!ta){jb=G.copyContextSnapshot;sc=jb.sourceItem;if(!sc)return Promise.reject(new Sc(10));Vc=sc.isFromCurrentSession(this.$)}var nd=this.I8g(G,!0);if(0!==nd)return Promise.reject(new Sc(ta?18:Vc?19:20,void 0,void 0,void 0,nd));if(ta)return this.FRc(G);if(!Vc&&!Li.Zij(sc))return G=`User attempted to paste art of type [${sc.type}] between sessions.`,I.ULS.sendTraceTag(537167889,0,50,G),Promise.reject(new Sc(11,void 0,void 0,G));if(jb.isAsyncSerializeFailed)return Promise.reject(new Sc(16,
void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));let xd;try{const Hd=G.clipboardItems.getItem(pd.a.shadowWorkbook);if(zb.a.Aya()&&!Hd&&1===sc.type)return this.X$j(G);xd=JSON.parse(Hd)}catch(Hd){return G=copyPasteInfra.getStringifiedError(Hd),I.ULS.sendTraceTag(507798424,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${G}`),Promise.reject(new Sc(12,void 0,Hd))}xd.floatingObjectId!==sc.activeFloatingObjectControlId?
I.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${sc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${xd.floatingObjectId}]`):I.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${sc.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${xd.floatingObjectId}]`);if(!xd||
!xd.shadowWorkbookBase64)return Promise.reject(new Sc(13,void 0,void 0,`shadowWorkbookPayload is null = ${!xd}`));G.isShadowWorkbookParsedSuccessfully=!0;G.shadowWorkbookPayloadSize=Kg(xd);G.shadowWorkbookSizeExceedsLimit=Ph(xd);G.payloadOrigin=Vc?Wf.OKg:Wf.pAd;G.payloadType=Yf.Jch;G.cseStatus=0;if(Ph(xd))return G=`Shadow workbook size [${G.shadowWorkbookPayloadSize}] is over the limit [${Gc.a.aNc}]. ShadowWorkbookSizeExceedsLimit: ${xd.shadowWorkbookSizeExceedsLimit}`,I.ULS.sendTraceTag(36304156,
0,15,`ArtCopyPasteHandler.Deserialize: ${G}`),Promise.reject(new Sc(1,void 0,void 0,G));jb=ta=null;ha.f(this.$).ha.Ck&326?jb=ha.f(this.$).ha.$e.activeFloatingObjectControlId:ta=this.$.ma&&this.$.ma.activeCell?Lb.x(this.$.ma.activeCell,this.$):Lb.x(Lb.R(G.commandParameters.originalDestinations),this.$);Vc||!xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&!xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)||
(G.ArtSourceItemType=Ji.a[sc.type],I.ULS.sendTraceTag(508422155,0,20,`User is attempting to paste art of type [${sc.type}] between sessions.`));Vc=null;if(this.iJb.mTg(sc))try{Vc=this.iJb.LCd(),G.cseStatus=1}catch(Hd){G.cseStatus=15,nd=copyPasteInfra.getStringifiedError(Hd),I.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${nd}`)}else G.cseStatus=26;return this.l5j.M4i(new Eh(G.commandParameters.ribbonCommandInfo,
ta,jb,G.commandParameters.commandType,[G.commandParameters.stopwatch],xd,sc,G,Vc))}FRc(G){G.wasLastCopyExternal=!0;if(G.clipboardItems.getItem("image/png")){const ta=G.commandParameters.stopwatch.zi;G.payloadType=Yf.BMh;return mc.c(this.$.si(1403967063,G.commandParameters.ribbonCommandInfo.method,G.commandParameters.ribbonCommandInfo.jk,{["dataUrl"]:G.clipboardItems.getItem("image/png")})).then(jb=>{G.serverRequestTimeInMs=G.commandParameters.stopwatch.zi-ta;return jb?Promise.resolve(null):Promise.reject(new Sc(15))},
()=>{G.serverRequestTimeInMs=G.commandParameters.stopwatch.zi-ta;return Promise.reject(new Sc(15))})}I.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return super.FRc(G)}X$j(G){try{const ta=G.clipboardItems.getItem(pd.a.html);return this.e4f(ta)?this.mug(G,ta,null):Promise.reject(new Sc(23))}catch(ta){return G=copyPasteInfra.getStringifiedError(ta),I.ULS.sendTraceTag(507782405,0,10,`ArtCopyPasteHandler.processClipboardHtml: Failed to process clipboard html with exception: ${G}`),
Promise.reject(new Sc(24,void 0,ta))}}bsj(){const G=ha.f(this.$).ha;return G.$e.activeFloatingObjectControlId&&G.$e.Lh&&G.$e.Lh.floatingObject?G.$e.Lh.floatingObject.Kve():!1}YEi(G,ta,jb){return this.ha.$e.Lh.floatingObject.cba?new Promise((sc,Vc)=>{const nd=this.ZEi(G,jb),xd=this.i_a(G,ta,jb);void Promise.allSettled([nd,xd]).then(Hd=>{var [ke,V]=Hd;"rejected"===ke.status?(1===G.commandParameters.commandType&&this.fWa.U3g(ta.type,ta.activeFloatingObjectControlId),Vc(ke.reason)):("rejected"===V.status&&
I.ULS.sendTraceTag(507811728,0,50,`ArtCopyPasteHandler.getAsyncData: Promise fetching data from server has failed with error ${V.reason}. Proceeding with resolving clipboard items from asyncArtData.`),Hd=ke.value,this.Isc.setValue(ta,Hd),sc(Hd))})}):this.i_a(G,ta,jb)}ZEi(G,ta){return new Promise((jb,sc)=>{const Vc=this.ha.$e.Lh;Vc.Zkb().continueWith(nd=>{var xd;try{const Hd=nd.result;ta.setItem(pd.a.plainText,"");if(Hd){const ke=new Image;ke.src=Hd;ta.setItem(pd.a.html,Ne.b(ke))}else return I.ULS.sendTraceTag(507811727,
0,15,`ArtCopyPasteHandler.getAsyncImageData: Base64 URL of picture is null. ArtSourceItem id: ${Vc.floatingObject.wi}`),sc(new pe(4));G.asyncClipboardItemsKeys=ib(ta);jb(ta)}catch(Hd){nd=null===(xd=null===Vc||void 0===Vc?void 0:Vc.floatingObject)||void 0===xd?void 0:xd.wi,I.ULS.sendTraceTag(507811726,0,10,`ArtCopyPasteHandler.getAsyncImageData: Failed to fetch base64 URL of picture. ArtSourceItem id: ${nd}. Exception: ${Hd}`),sc(new pe(4))}})})}i_a(G,ta,jb){return new Promise((sc,Vc)=>{const nd=G.commandParameters.stopwatch.zi,
xd=this.ha.$e.Lh;I.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.fWa.i3h(new yi(ta.activeFloatingObjectControlId,G.commandParameters,Hd=>{var ke;G.requestTelemetryData=Hd.RequestTelemetryData;G.serverRequestTimeInMs=G.commandParameters.stopwatch.zi-nd;if(be.a.jl(Hd.Errors))if(be.a.tua(Hd.Errors))G.encounteredDeploymentErrors=!0,Hd=be.a.Yh(Hd.Errors),I.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Hd}`);
else{var V=be.a.Yh(Hd.Errors);I.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${V}`);Vc(new pe(4,Hd.Errors))}else if(I.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${ta.activeFloatingObjectControlId}].`),G.markForCancellation)Vc(new pe(3,Hd.Errors));else{if(be.a.Lx(Hd.Errors)){var Wa=be.a.Yh(Hd.Errors);I.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${Wa}`)}if(Wa=
Hd.Result){Wa=this.$zd(Wa);Wa.floatingObjectId=ta.activeFloatingObjectControlId;G.shadowWorkbookPayloadSize=Kg(Wa);G.shadowWorkbookSizeExceedsLimit=Ph(Wa);try{V=JSON.stringify(Wa)}catch(Eb){Vc(new Sc(14,void 0,Eb,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${G.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${Wa.floatingObjectId}]`));return}I.ULS.shipAssertTag(537167881,0,!!jb,"Expecting syncClipboardItems to be defined");zb.a.Aya()&&(null===
(ke=null===xd||void 0===xd?void 0:xd.floatingObject)||void 0===ke?0:ke.cba)?(ke=new Blob([V]),1048576<ke.size?I.ULS.sendTraceTag(507798425,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: ShadowWorkbookPayload size is ${ke.size} for floating object id ${xd.floatingObject.wi}. Ignoring shadow workbook to avoid failure in saving to local storage.`):jb.setItem(pd.a.shadowWorkbook,V)):jb.setItem(pd.a.shadowWorkbook,V);1===G.commandParameters.commandType&&(this.p9j(ta.type,ta.activeFloatingObjectControlId,
Hd.StateId),this.deleteFloatingObject(ta.activeFloatingObjectControlId,ta.type));this.Isc.setValue(ta,jb);G.asyncClipboardItemsKeys=ib(jb);sc(jb)}else I.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${ta.activeFloatingObjectControlId}`),sc(this.Isc.CK(ta))}},G.commandParameters.commandType,ta.type,Hd=>{G.serverRequestTimeInMs=G.commandParameters.stopwatch.zi-nd;Hd=vc.a.gk(Hd.data);1!==G.commandParameters.commandType||
zb.a.Aya()&&xd.floatingObject.cba||this.fWa.U3g(ta.type,ta.activeFloatingObjectControlId);const ke=be.a.Yh(Hd);I.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ke}`);Vc(new pe(4,Hd))},[G.commandParameters.stopwatch]))})}deleteFloatingObject(G,ta){G=Kh.a.bH(ta,G);if(G=Sa.a(this.$).Tx(G))Sa.a(this.$).deleteFloatingObject(G,14,!0),ha.f(this.$).ha.$e.sK=null}p9j(G,ta,jb){const sc=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?
za.a.nh(oa.Ng):this.$.la.kh(277);if(sc){let nd=null;G=Kh.a.bH(G,ta);G=Sa.a(this.$).Tx(G);if(null===G||void 0===G?0:G.Xp)nd=G.Xp.block;if(nd){var Vc=G.floatingObject.rn();sc.$lc(()=>!nd.$o.lh(Vc),jb,"CutArt")}}}static Zij(G){return 1===G.type||5===G.type||xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&0===G.type||xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)&&8===G.type}}Object(D.a)(Li,"ArtCopyPasteHandler",
Ih,[]);class ai extends Gi{constructor(G,ta,jb,sc){super(G);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=ta;this.top=jb;this.left=sc}}Object(D.a)(ai,"MacroRecorderPasteArtPayload",Gi,[]);class sh{constructor(G,ta){this.$=G;this.iJb=ta}Z$i(G,ta,jb,sc,Vc,nd,xd){nd=void 0===nd?null:nd;xd=void 0===xd?null:xd;const Hd=this.$.pa.ta.Vh();let ke=null;const V={CopyPasteTargetType:2};V.FloatingObjectId=G;V.CopyOperationId=jb.id;jb.floatingObjectType=ta;V.UploadToClipService=jb.uploadToClipService;
V.PKey=jb.pKey;V.ClipServiceDataCenter=jb.clipServiceDataCenter;let Wa=0;2===Vc?(Vc=505,Wa=16,ke=(Eb,Jc,od)=>$h(this.$.pa.ta,V,Xc.c(Eb,sc),nd?Xc.b(Jc,nd):Jc,od,jb.ribbonCommandInfo,Hd,xd)):(Vc=179,ke=(Eb,Jc,od)=>{this.bhi(ta,G);this.$.ZC();var Pd=this.$.pa.ta;Eb=Xc.c(Eb,sc);Jc=nd?Xc.b(Jc,nd):Jc;var ge=jb.ribbonCommandInfo,Be=xd;Be=void 0===Be?null:Be;const Ye=Pd.$a(1,void 0===Hd?null:Hd);Ye.copyParameters=V;return ad.h(Pd,"Cut",Ye,Eb,Jc,od,ge,0,Be)});this.$.userOperationManager.enqueueOperation(new bc.a(Vc,
0,ke,Wa|64),jb.ribbonCommandInfo)}bhi(G,ta){var jb=Kh.a.bH(G,ta);(jb=Sa.a(this.$).Tx(jb))?(ha.f(this.$).ha.$e.XO(jb),jb.isVisible=!1):I.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${G}, FloatingObjectId: ${ta}`)}U3g(G,ta){G=Kh.a.bH(G,ta);if(G=Sa.a(this.$).Tx(G))G.isVisible=!0}i3h(G){this.Z$i(G.floatingObjectId,G.f3h,G.commandParameters,G.oQ,G.Tai,G.uwa,G.XAe)}Faj(G,ta,jb,sc,Vc,nd,xd,Hd,ke){Hd=void 0===Hd?null:Hd;ke=
void 0===ke?!0:ke;return new Promise((V,Wa)=>{const Eb=nd.commandParameters.stopwatch.zi;this.moe(G,Vc,ta,jb,Jc=>{nd.requestTelemetryData=Jc.RequestTelemetryData;nd.serverRequestTimeInMs=nd.commandParameters.stopwatch.zi-Eb;if(be.a.tua(Jc.Errors))nd&&(nd.encounteredDeploymentErrors=!0),Jc=be.a.Yh(Jc.Errors),I.ULS.sendTraceTag(537167875,0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Jc}`);else if(be.a.jl(Jc.Errors)){var od=
be.a.Yh(Jc.Errors);I.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${od}`);Wa(new Sc(9,Jc.Errors))}else Jc.Result?(od=Jc.Result,I.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.B9j(xd,od.FloatingObjectId,Jc.StateId),V(sh.VSd(od.FloatingObjectId))):(I.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Wa(new Sc(9,Jc.Errors)))},Jc=>{nd.serverRequestTimeInMs=
nd.commandParameters.stopwatch.zi-Eb;Jc=vc.a.gk(Jc.data);I.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${be.a.Yh(Jc)}`);Wa(new Sc(9,Jc))},sc,Hd,ke)})}B9j(G,ta,jb){const sc=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?za.a.nh(oa.Ng):this.$.la.kh(277);if(sc){const Vc=Kh.a.bH(G,sh.VSd(ta));sc.$lc(()=>!!Sa.a(this.$).Tx(Vc),jb,"PasteArt")}}Vye(G,ta){ta&&this.iJb.Vye(G,Kh.a.bH(G.type,ta))}lug(G){return this.Faj(G.ribbonCommandInfo,
G.destination,G.Wof,G.XAe,G.zN,G.pasteContext,G.item.type,G.agf,G.item.isFromCurrentSession(this.$)).then(ta=>ta,ta=>{this.Vye(G.item,G.agf);return Promise.reject(ta)})}Pne(G,ta,jb){G||(G=Lb.x(ha.f(this.$).ha.qa.activeCell,this.$));ha.f(this.$).bJc(Lb.H(G),1)?Sa.a(this.$).yPa(jb,ta,!0):ha.f(this.$).ha.$e.dXa(G,ta,jb).continueWith(sc=>{sc.result?I.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${ta}]`):I.ULS.sendTraceTag(537167842,
5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${ta}]`)})}moe(G,ta,jb,sc,Vc,nd,xd,Hd,ke){ke=void 0===ke?!0:ke;const V=this.$.pa.ta.Vh(),Wa={};Wa.ShadowWorkbookBase64=ta.shadowWorkbookBase64;Wa.FloatingObjectId=sc;Wa.DestinationRanges=jb?Lb.u(jb):null;Wa.CopyPasteTargetType=2;Wa.ClientEstimationFloatingObjectId=Hd;jb=new bc.a(503,0,(Eb,Jc,od)=>{Hd||this.$.ZC();return Ei(this.$.pa.ta,Wa,Xc.c(Eb,Vc),Xc.b(Jc,nd),od,null,V,xd)},void 0,()=>{if(ke){let Eb;Eb=
O.a.Sp(O.a.Ci(Wa));Eb.FloatingObjectId=ta.floatingObjectId;Wa.DestinationRanges||(Eb.DestinationRanges=Lb.r(this.$.sa.ma.sheetName,"",0,0,0,0));return new ai(Eb,ke,0,0)}return new ai(Wa,ke,0,0)});jb.flags=65;this.$.userOperationManager.enqueueOperation(jb,G)}static VSd(G){return`${G.length+2}.{${G.toUpperCase()}}`}}Object(D.a)(sh,"ArtCopyPasteUtils",null,[904]);var kj=a(207);class Qi{constructor(G){this.Ayd=this.CHa=null;this.utb=15;this.$=G}Hde(G,ta){this.CHa=G;this.Ayd=ta}LCd(){if(!this.CHa||!this.Ayd)return I.ULS.sendTraceTag(537167841,
0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";const G=Qa.a.lhb(new Kh.a(this.CHa));G.Id=sh.VSd(Oc.a.create().toString());G.Version=-1;G.Name="";G.IsClientEstimation=!0;var ta=this.icj(G);if(!ta)return null;const jb=new Kh.a(G);ta.block.$o.add(jb);jb.Lvb();const sc=Sa.a(this.$);sc.Ysc(jb,ta);ta=sc.Tx(Kh.a.rNi(G));!ta||ta.floatingObject.NK||ta.floatingObject.y2a||ta.$7a(this.Ayd);sc.yPa(G.Type,
G.Id,!0);return G.Id}mTg(G){return xa.EwaSettings.Ra(205)&&G.isFromCurrentSession(this.$)&&!ha.f(this.$).rtl&&!ha.f(this.$).fh.pp}Vye(G,ta){this.mTg(G)&&(G=Sa.a(this.$).Tx(ta))&&(I.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${ta}] of type [${G.floatingObject.type}]`),Sa.a(this.$).deleteFloatingObject(G,15,!0),G.Xp&&G.dvb(G.Xp,!1))}icj(G){if(!G)return I.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),
null;if(ha.f(this.$).ha.$e.activeFloatingObjectControlId){var ta=ha.f(this.$).ha.$e.sK.floatingObject;G.OriginDeltaX=ta.offsetX+this.utb;G.OriginDeltaY=ta.offsetY+this.utb;G.AbsoluteLeft+=this.utb;G.AbsoluteTop+=this.utb;G.AbsoluteRight+=this.utb;G.AbsoluteBottom+=this.utb;G.ZOrder=ta.LJ+1;return ha.f(this.$).ha.$e.sK.Xp}if(!this.$.ma||!this.$.ma.activeCell)return I.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var jb=this.$.ma.activeCell;ta=ha.f(this.$).GW(jb);if(!ta)return I.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${jb.toString()} is null.`),null;const sc=Xd.HelperMethods.uNd(ta.domElement,ta.Iq.domElement);jb=ta.da.yl(jb,2);if(!sc||!jb)return I.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!sc}. cellPositionRelativeToGridOrigin is null: ${!jb} .`),
null;G.OriginDeltaX=jb.topLeft.x-sc.x;G.OriginDeltaY=jb.topLeft.y-sc.y;G.AbsoluteLeft=jb.topLeft.x;G.AbsoluteTop=jb.topLeft.y;G.AbsoluteRight=G.AbsoluteLeft+Math.abs(this.CHa.AbsoluteRight-this.CHa.AbsoluteLeft);G.AbsoluteBottom=G.AbsoluteTop+Math.abs(this.CHa.AbsoluteBottom-this.CHa.AbsoluteTop);G.ZOrder=this.CHa.ZOrder+100;return new kj.a(ta.da.za.Wn(ta.hashCode),ta.hashCode)}}Object(D.a)(Qi,"ArtPasteClientEstimation",null,[903]);class hi{create(){const G=window.clipboardPlatform;return G?G.createClipboardItems():
null}}Object(D.a)(hi,"ClipboardItemsFactory",null,[902]);class Jg{}Jg.undefined="Undefined";Object(D.a)(Jg,"CCPTelemetryConsts",null,[]);class yh{}yh.cells="Cells";yh.floatingObject="FloatingObject";yh.unknown="Unknown";Object(D.a)(yh,"ActiveSelection",null,[]);class Xi extends Eg{constructor(G,ta,jb,sc){super(G,ta,jb,void 0===sc?null:sc);this.SXa=null}beforePaste(){I.ULS.sendTraceTag(508121693,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(G){G.isClipboardDataContainShadowWorkbook=
!(void 0===G.clipboardItems.getItem(pd.a.shadowWorkbook)||null===G.clipboardItems.getItem(pd.a.shadowWorkbook));const ta=G.commandParameters.originalDestinations;if(!G.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let jb=null;if((()=>{let sc=this.tac(G.clipboardItems);({zN:jb}=sc);return sc})().returnValue){G.isShadowWorkbookParsedSuccessfully=!0;let sc=null,Vc=null;xa.EwaSettings.getBooleanFeatureGate(kg.a.TMb,!1)?sc=Lb.t(ta,this.$):Vc=Lb.x(Lb.R(ta),this.$);return this.J5j(G,Vc,
sc,jb)}return G.isClipboardInaccessible?Promise.reject(new Sc(8)):Promise.reject(new Sc(6))}get copyPasteInfrastructure(){var G;null!==(G=this.SXa)&&void 0!==G?G:this.SXa=this.$.la.kh(254,!0);return this.SXa}rej(G,ta,jb,sc){return this.copyPasteInfrastructure?mc.a(this.copyPasteInfrastructure.$Td(null,sc.commandParameters.ribbonCommandInfo,G,ta,jb,sc)):Promise.reject(new Sc(0))}J5j(G,ta,jb,sc){G.pasteResult="CrossSessionPaste";G.payloadOrigin=Wf.pAd;G.payloadType=Yf.shadowWorkbook;G.shadowWorkbookPayloadSize=
Kg(sc);G.shadowWorkbookSizeExceedsLimit=Ph(sc);sc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(G.originalSourceRangesCountExceedsLimit=sc.originalSourceRangesCountExceedsLimit);return G.shadowWorkbookSizeExceedsLimit?Promise.reject(new Sc(1)):1028===G.commandParameters.commandType&&G.originalSourceRangesCountExceedsLimit?Promise.reject(new Sc(1)):this.rej(ta,jb,sc,G)}}Object(D.a)(Xi,"AcrossSessionInsertCopiedCutCellsHandler",Eg,[]);class zh{constructor(G,ta){this.$=G;this.a0=ta}get name(){return"NonGridCopyHandler"}getSourceItem(){return new S(this.$.ea.Ek,
this.$.ua.UserSessionId)}beforeSerialize(G){bh(G);G.commandParameters.copyPasteTargetType=0}serialize(G){const ta={};if(!G.sourceItem)return I.ULS.sendTraceTag(508074082,0,10,"NonGridCopyHandler.Serialize: sourceItem should not be null"),ta;G.isFromCache=!1;G.isAsyncCopy=!1;const jb=this.a0.create();pd.a.plainText in G.commandParameters.clipboardItems&&jb.setItem(pd.a.plainText,G.commandParameters.clipboardItems[pd.a.plainText]);pd.a.html in G.commandParameters.clipboardItems&&jb.setItem(pd.a.html,
G.commandParameters.clipboardItems[pd.a.html]);ta.synchronousResult=jb;return ta}}Object(D.a)(zh,"NonGridCopyHandler",null,[901]);class zi extends Eg{constructor(G,ta,jb,sc){super(G,ta,jb,void 0===sc?null:sc)}getSourceItem(){return new Hi(this.$.ea.ma.sheetName,this.$.ea.Ek,this.$.ua.UserSessionId)}beforeSerialize(G){G.isFullSheetCopy=!0;super.beforeSerialize(G)}wye(G){if(!G.ShadowWorkbookBase64&&!G.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,zN:null};const ta=this.$zd(G);ta.sourceClientPath=
G.SourceClientPath;ta.sourceSheetName=G.SourceSheetName;ta.sourceWorkbookName=G.SourceWorkbookName;return{returnValue:!0,zN:ta}}i_a(G,ta){I.ULS.shipAssertTag(507834589,0,!!G,"AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const jb=G.commandParameters.stopwatch.zi;return new Promise((sc,Vc)=>{I.ULS.sendTraceTag(507815952,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${G.id}`);
this.kA.fullSheetCopy(ta.sheetName,G.commandParameters,nd=>{G.requestTelemetryData=nd.RequestTelemetryData;G.serverRequestTimeInMs=G.commandParameters.stopwatch.zi-jb;if(!be.a.jl(nd.Errors)){I.ULS.sendTraceTag(507834588,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for copy Id: ${G.id}`);const xd=this.a0.create();let Hd;const ke=nd.Result;(()=>{let V=this.wye(ke);({zN:Hd}=V);return V})().returnValue&&(G.shadowWorkbookPayloadSize=Kg(Hd),G.shadowWorkbookSizeExceedsLimit=
Ph(Hd),G.originalSourceRangesCountExceedsLimit=ke.OriginalSourceRangesCountExceedsLimit,xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8790502_FullSheetCCPEnhancement")&&!G.shadowWorkbookSizeExceedsLimit&&(nd=JSON.stringify(Hd),xd.setItem(pd.a.shadowWorkbook,nd)));xd.setItem(pd.a.Ksc,G.commandParameters.id);this.iMb.setValue(ta,xd);G.asyncClipboardItemsKeys=ib(xd);sc(xd)}},nd=>{G.serverRequestTimeInMs=G.commandParameters.stopwatch.zi-jb;nd=vc.a.gk(nd.data);const xd=be.a.Yh(nd);I.ULS.sendTraceTag(507834587,
0,10,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${xd}. copy Id: ${G.id}`);Vc(new pe(2,nd))})})}beforePaste(){}deserialize(G){G.isClipboardDataContainShadowWorkbook=!G.clipboardItems.getItem(pd.a.shadowWorkbook);return G.isClipboardDataContainShadowWorkbook?this.tac(G.clipboardItems).returnValue?(G.isShadowWorkbookParsedSuccessfully=!0,Promise.resolve(!0)):G.isClipboardInaccessible?Promise.reject(new Sc(8)):Promise.reject(new Sc(6)):Promise.resolve(!0)}serialize(G){const ta=
G.sourceItem,jb={},sc=this.iMb.CK(ta);sc?(jb.synchronousResult=sc,G.isFromCache=!0,G.clientSideCopyTime=G.commandParameters.stopwatch.zi):(G.isAsyncCopy=!0,jb.synchronousResult=this.a0.create(),jb.synchronousResult.setItem(pd.a.plainText,this.jJb),jb.asynchronousResult=this.i_a(G,ta,null));G.syncClipboardItemsKeys=ib(jb.synchronousResult);return jb}}Object(D.a)(zi,"AcrossSessionFullSheetCopyPasteHandler",Eg,[]);class Fh{constructor(G){this.Lgd=this.kbd=this.Tcd=this.b8c=this.wid=null;this.$=G}get BKj(){!this.Lgd&&
this.$.la.kh(254,!0)&&(this.Lgd=new zh(this.$,new hi));return this.Lgd}get Ofe(){if(!this.wid){const G=this.$.la.kh(254,!0);G&&(this.wid=new Eg(this.$,G,new hi))}return this.wid}get uej(){if(!this.Tcd){const G=this.$.la.kh(254,!0);G&&(this.Tcd=new Xi(this.$,G,new hi))}return this.Tcd}get rCf(){if(!this.kbd){const G=this.$.la.kh(254,!0);G&&(this.kbd=new zi(this.$,G,new hi))}return this.kbd}get Vrd(){if(!this.b8c&&this.$.la.kh(254,!0)){const G=new Qi(this.$);this.b8c=new Li(this.$,new hi,new sh(this.$,
G),G)}return this.b8c}getCopyFlowHandler(G){if(-207190267===G.commandParameters.ribbonCommandInfo.command)return this.rCf;if(G.commandParameters.clipboardItems)return this.BKj;const ta=this.BIi(ha.f(this.$).Ck);G.commandParameters.copyPasteHandlerName=ta.name;return ta}getPasteFlowHandler(G){var ta=G.copyContextSnapshot;switch(G.commandParameters.ribbonCommandInfo.command){case 440556491:return G=this.rCf;case -160032004:case -1065525230:return G=this.uej;default:return ta=Ge(G)?this.Vrd:de(G)?this.Ofe:
(null===ta||void 0===ta?0:ta.sourceItem)&&Object.getType(ta.sourceItem)===Qb?this.Vrd:this.Ofe,G.commandParameters.copyPasteHandlerName=ta.name,ta}}initializePasteContext(G){if(G){G.isSameSession=!1;G.isShadowWorkbookParsedSuccessfully=!1;G.pasteResult=Jg.undefined;G.payloadOrigin=Jg.undefined;G.payloadType=Jg.undefined;G.encounteredDeploymentErrors=!1;G.shadowWorkbookSizeExceedsLimit=!1;G.originalSourceRangesCountExceedsLimit=!1;G.activeSelectionType=this.RDi();G.indicationDisplayScheduled=!1;G.pasteDestinationHasMergedCells=
!1;G.cseStatus=0;G.pasteIndicationDisplayStatus=Ae.jgi;if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))G.ArtSourceItemType=Jg.undefined;if(G.copyContextSnapshot){var ta=G.copyContextSnapshot;const xd=ec(ta.sourceItem);var jb=ta.sourceItem;var sc=!!jb&&Object.getType(jb)===Qb;jb=0;var Vc=!1;xd?(Vc=ta.sourceItem,G.isSameSession=Vc.isFromCurrentSession(this.$),
jb=1,Vc=this.Toj(Vc,G)):sc&&(G.isSameSession=ta.sourceItem.isFromCurrentSession(this.$),jb=2);if(G.copyContextSnapshot.commandParameters){const Hd=-1985798686===ta.commandParameters.ribbonCommandInfo.command;sc=G.commandParameters;var nd=this.$;ta?nd&&nd.ua?ta=ta.sessionId===nd.ua.UserSessionId:(I.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),ta=!1):(I.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),ta=!1);sc.clearSystemClipboard=ta&&Hd&&xd&&!Vc;G.commandParameters.copyPasteTargetType=
jb}}}}getSessionId(){return this.$.ua.UserSessionId}Toj(G,ta){const jb=G.ranges.some(sc=>sc.lk)&&ta.commandParameters.originalDestinations.some(sc=>1!==sc.top);return G.ranges.some(sc=>sc.isRow)&&ta.commandParameters.originalDestinations.some(sc=>1!==sc.left)||jb}BIi(G){switch(G){case 1:return this.Ofe;case 64:case 4:case 2:case 256:return this.Vrd;default:throw Error.invalidOperation("Unsupported selection");}}RDi(){return ha.f(this.$).ha.Ck&470?yh.floatingObject:1===ha.f(this.$).ha.Ck?yh.cells:
yh.unknown}getDialogResponse(){}}Object(D.a)(Fh,"ExcelCopyPasteApplicationHost",null,[894]);class Ah extends ae.a{constructor(G,ta){super(G);this.yC=null;this.tej=(jb,sc)=>{1===jb?(jb=Ah.rfi[sc[Ah.qfi]],I.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===jb?"Horizontal":"Vertical"}`),this.yC.setResult(jb)):(I.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),
this.yC.$C())};this.Zm(ta)}get Di(){return"InsertCopiedCutCellsDialog"}Zm(G){this.yC=new Dc.a;const ta=ka.a.instance.ia(16);G=this.PR(G);this.initializeAndShow(ta,this.tej,G)}PR(G){return{[Ah.xy]:this.Di,[Ah.Fqj]:G}}}Ah.qfi="direction";Ah.Fqj="isRtl";Ah.rfi={["Vertical"]:1,["Horizontal"]:0};Object(D.a)(Ah,"InsertCopiedCutCellsDialog",ae.a,[]);class Wh{$sc(G,ta){return(new Ah(G,ta)).yC.task}}Object(D.a)(Wh,"InsertCopiedCutCellsDialogFactory",null,[893]);var Sh=a(1205),lj=a(921),Mf=a(609);const ii=
()=>{var G=navigator.userAgentData;if(G)for(let ta=0;ta<G.brands.length;ta++){if("Microsoft Edge"===G.brands[ta].brand&&79<=parseFloat(G.brands[ta].version))return!0}else if(navigator.userAgent&&(G=navigator.userAgent.match(/(Edg|EdgiOS|EdgA)\/(\d+)/i))&&79<=parseFloat(G[2]))return!0;return!1},Vg=G=>{const ta=kg.a.ehj&&!G.isMobileMode,jb=kg.a.fhj&&G.isMobileMode&&G.isEditMode;G=G.uk.get(57);return(ta||jb)&&!G&&!!(navigator&&navigator.clipboard&&navigator.clipboard.read&&navigator.clipboard.write&&
(ii()||da.a.Xv&&da.a.uLa(86)))};class ah extends zg.a{constructor(G){super();this.mYh="clipboard-read";this.$=G;this.Vq=ka.a.instance;this.qij=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8282600_EnableClipboardPermissionLogging");this.gm()}create(){const G=$b.a.R6([75,76],4,this.xh,void 0,void 0,void 0,ah.p7b),ta=Object(mc.d)(za.a.resolve(oa.xc,{va:this.xh})),jb=Object(mc.d)(za.a.resolve(oa.ah)),sc=oa.od.Aa()?Object(mc.d)(za.a.resolve(oa.od,{va:this.xh})):Qc.a.Ua(null),Vc=oa.Be.Aa()?Object(mc.d)(za.a.resolve(oa.Be,
{va:this.xh})):Qc.a.Ua(null);Db.TaskExtensions.Xa(Db.TaskExtensions.Vo([ta,G,jb,sc,Vc],this.ya),()=>{const nd=new Sh.a;let xd=null;this.o0h(nd).then(Hd=>{xd=Hd.egf;const ke=copyPasteInfra.createCopyPasteInfra(xd,new Fh(this.$),nd);I.ULS.shipAssertTag(537167762,0,!!this.$.ua,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");I.ULS.shipAssertTag(537167761,0,!!this.$.ua&&!!this.$.ua.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");
const V=xd.getMetadataManager();var Wa=Object(lj.a)(this.$.la,254,()=>new rf(this.$,V,ta.result,ke,new lh(this.$,ha.f(this.$)),new Wh,this.$.ua.DocumentHostInfo.UserId,xd.getInitializationError(),jb.result,sc.result,Vc.result));this.Bk(Wa);if(Hd.jhb){Wa=rf.Wzc();const Eb=JSON.stringify(Hd.jhb.dataClipboardCapabilities),Jc=Hd.jhb.clipboardStrategiesToInitialize[0].clipboardStrategyType===Hd.jhb.dataClipboardStrategyType,od=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?
"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();I.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${Wa}, StrategyType=${Hd.jhb.dataClipboardStrategyType}, StrategyCapabilities=${Eb}, IsBestStrategyTypeInitialized=${Jc}, InfraLoadTimeMS=${od}`)}else I.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},Hd=>{const ke=
rf.Wzc();Hd=Hd?copyPasteInfra.getStringifiedError(Hd):"null";I.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${ke} error: ${Hd}`)})},this.ya,3)}dispose(){super.dispose()}o0h(G){var ta,jb;let sc=null;var Vc=window.clipboardPlatform;Vc&&(sc=Vc.getClipboardPlatformEnvironment(),null===(ta=Vc.setClipboardPlatformFeatureGateManager)||void 0===ta?void 0:
ta.call(Vc,Mf.a()));if(!sc)return I.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);ta=this.$.ua;Vc=[ta.OfficeOnlineChromeExtensionId,ta.ChromeClipboardAccessExtensionId];const nd=this.Vq.Ea(5),xd=this.$.uk.get(57);let Hd=!xd&&this.$.uk.get(5);var ke=this.$.ea.Ih;ke&&(ke.inWebPart||ke.inViewerFromWebPart||ke.isDivSyndicated)&&(Hd=!1);(ke=Vg(this.$))&&I.ULS.sendTraceTag(508703874,
0,50,"CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Async System Clipboard is allowed");try{this.qij&&(null===(jb=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===jb?0:jb.query)&&navigator.permissions.query({name:this.mYh}).then(V=>{I.ULS.sendTraceTag(508151361,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Clipboard read permission state: ${null===V||void 0===V?void 0:V.state}`)}).catch(V=>{I.ULS.sendTraceTag(508151360,
0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(V)}`)})}catch(V){I.ULS.sendTraceTag(508151331,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(V)}`)}jb=this.pHi(Hd,!xd,ke);I.ULS.shipAssertTag(537167758,0,!!ta.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");
return sc.init(G,Vc,ta.SharedClipboardHostingApp,ta.SharedClipboardHostingApps,ta.SharedClipboardHostingEnvironments,ta.SharedClipboardOverrideOrigin,ta.SharedClipboardSchemaVersion,ta.SharedClipboardExpirationInMinutes,ta.ClipboardPromiseTimeoutInMinutes,nd,ta.MachineCluster,new Oh(this.$),jb,ta.DocumentHostInfo.UserId,ta.ClipboardTtlInMS,xa.EwaSettings.Ra(273),ta.UserSessionId,ta.BulsEndpointUrl).then(V=>Object(me.a)(new xh,{egf:sc,jhb:V}),V=>Promise.reject(V))}pHi(G,ta,jb){const sc=[];G&&jb&&sc.push(this.xmf(9));
G&&ta&&sc.push(this.xmf(6));ta&&(sc.push(this.iAd(7)),sc.push(this.iAd(0)));G&&sc.push(this.tlf());sc.push({clipboardStrategyType:4});jb=sc?sc.map(Vc=>JSON.stringify(Vc)).join(","):"[]";I.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${G}, isSystemClipboardAllowed=${ta}, result = ${jb}`);return sc}tlf(){const G=this.$.ua,ta={clipboardStrategyType:5};ta.sessionId=G.UserSessionId;ta.useSharedClipboardIframe=
!0;ta.sharedClipboardHostingApp=G.SharedClipboardHostingApp;ta.sharedClipboardHostingApps=G.SharedClipboardHostingApps;ta.sharedClipboardHostingEnvironments=G.SharedClipboardHostingEnvironments;ta.sharedClipboardOverrideOrigin=G.SharedClipboardOverrideOrigin;ta.sharedClipboardSchemaVersion=G.SharedClipboardSchemaVersion;ta.sharedClipboardExpirationInMinutes=G.SharedClipboardExpirationInMinutes;ta.wacCluster=G.MachineCluster;return ta}xmf(G){const ta={};ta.clipboardStrategyType=G;ta.localStorageStrategyParameters=
this.tlf();ta.systemClipboardStrategyParameters=this.iAd(0);return ta}iAd(G){const ta={};ta.clipboardStrategyType=G;ta.skipFilesIfPlainTextExists=!0;return ta}static Ba(G){oa.Be.Aa()||G.la.Hh(373,new af(G));G.la.Hh(ah.p7b,new ah(G))}}ah.p7b=255;Object(D.a)(ah,"CopyPasteInfrastructureFactory",zg.a,[]);var ih=a(9),mi=a(592),Xh=a(210),Ti=a(444);class ji{constructor(){this.eqa=this.xDf=null}}Object(D.a)(ji,"GestureAdapterInfo",null,[]);var Ui=a(530),Yi=a(294);class ni{constructor(){this.D$c=null}Lxj(){if(!this.D$c){var G=
"hammer.min.js";wa.AFrameworkApplication.fa.Nv("IsServerFlavorDebug")&&(G=wa.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");G=wa.AFrameworkApplication.vJ(String.format("{0}",G),5);G=Yi.a.create(G,null,null);Ui.a.hwa(G);this.D$c=G.Gqb}return this.D$c}static get instance(){ni.Va||(ni.Va=new ni);return ni.Va}}ni.Va=null;Object(D.a)(ni,"HammerJsDependencyLoader",null,[907]);var bi;(function(G){G[G.none=-1]="none";G[G.YRc=0]="pinch";G[G.pan=1]="pan";G[G.Yve=2]="swipe"})(bi||
(bi={}));Object(D.b)("GestureEvent",bi);var mj=a(82);class Zi extends mj.a{constructor(G,ta,jb,sc,Vc,nd,xd,Hd){super(G,jb,sc,nd);this.rBb=ta;this.pta=xd;this.m9=Hd;this.Vlh=Vc}get shiftKey(){return this.pta}get ctrlKey(){return this.m9}get clientPoint(){return this.rBb}get BJa(){return this.Vlh}static create(G,ta,jb,sc,Vc,nd){if(jb.rawEvent)if(nd){var xd=jb.rawEvent;xd=new Sys.UI.Point(xd.clientX,xd.clientY)}else xd=mj.a.mRb(jb);else xd=new Sys.UI.Point(jb.clientX,jb.clientY);return new Zi(G,xd,ta,
jb,sc,Vc,jb.shiftKey,jb.ctrlKey,nd)}}Object(D.a)(Zi,"GestureEventArgs",mj.a,[]);class Ai{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(D.a)(Ai,"GestureManagerData",
null,[]);class ci{}ci.yeh=2;ci.zeh=4;ci.Aeh=8;ci.Beh=8;Object(D.a)(ci,"HammerConstants",null,[]);var $i=a(108),Vi=a(221),Xe=a(172);class th extends nc.a{constructor(G,ta){super();this.AEa=Ti.a.yDi;this.Shd=!!window.PointerEvent;this.b_e=window.hasOwnProperty("ontouchstart");this.Bbb=this.SEb=null;this.Fka=!1;this.C3=new Ha.a;this.lFb=new Ha.a;this.Wlh=new Xh.a;this.VDa=null;this.Aab=this.Fbd=this.DIe=this.j9c=this.Efd=this.oWe=this.JIe=this.RGb=!1;this.wEb=-1;this.curRecognizer=this.element=this.handlers=
this.session=this.Zkd=null;this.NNa=(jb,sc,Vc)=>{jb=this.cIf(jb);sc=this.gOi(Vc);Hammer.inputHandler(this,jb,sc);this.Fka&&Vc.preventDefault();return this.Fka};this.S4a=(jb,sc,Vc)=>{var nd=Vc.rawEvent.pointerType.toString();const xd=Vc.rawEvent.pointerId.toString();if("touch"!==nd)return!1;jb=this.cIf(jb);if(1!==jb&&!this.C3.lh(xd))return!1;this.JIe&&1===jb&&Vc.rawEvent.isPrimary&&this.C3.count&&(I.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.oqc());this.RGb?this.bzh(xd,
sc,Vc):this.C3.ga(xd,Vc);this.Efd&&2===jb&&(!this.j9c||this.j9c&&"function"===typeof Vc.rawEvent.getCoalescedEvents)&&(sc=Vc.rawEvent.getCoalescedEvents())&&this.xQf()&&(this.wEb=Math.max(this.wEb,sc.length));this.oWe&&(this.Fka=!1);nd=this.fOi(this.C3,Vc,nd);Hammer.inputHandler(this,jb,nd);if(4===jb||8===jb)this.RGb?this.pEg(xd):this.C3.remove(xd),this.C3.count||(this.session=null,this.Efd&&-1!==this.wEb&&(I.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.wEb),this.wEb=
-1));this.Fka&&Vc.preventDefault();return this.Fka};this.RPc=()=>!1;this.kk=$i.EventHandlerManager.instance;this.Shd?(I.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.SEb=this.S4a,this.Bbb=gb.a.ADi):this.b_e?(I.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.SEb=this.NNa,this.Bbb=gb.a.ezb):(I.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.SEb=this.RPc,this.Bbb=gb.a.zDi);this.Io=ta;this.msa=G;wa.AFrameworkApplication.fa&&(this.RGb=wa.AFrameworkApplication.fa.ka("UsePointerCaptureIsEnabled"),
this.JIe=wa.AFrameworkApplication.fa.ka("ClearCacheOnPrimaryPointerIsEnabled"),this.oWe=wa.AFrameworkApplication.fa.ka("ResetHandledBeforeInputHandlerIsEnabled"),this.Efd=wa.AFrameworkApplication.fa.ka("LogCoalescedEventsIsEnabled"),this.j9c=wa.AFrameworkApplication.fa.ka("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.DIe=wa.AFrameworkApplication.fa.ka("CheckIfHammerExistsAfterDownloadIsEnabled"),this.Fbd=wa.AFrameworkApplication.fa.ka("HammerJsPerformanceTimersIsEnabled"),this.Aab=this.RGb&&
wa.AFrameworkApplication.fa.ka("CancelDragFromGestureInputManagerIsEnabled")&&wa.AFrameworkApplication.fa.ka("UseGestureInputManagerPointerCacheIsEnabled"))}WMi(){return this.Shd?0:this.b_e?1:2}Uv(G){super.Uv(G);this.kk.bya(this.Bbb,G,0,this.SEb)}Ku(G){super.Ku(G);this.kk.zYa(G,this.Bbb)}Phk(G,ta,jb){jb=void 0===jb?null:jb;var sc=void 0===sc?null:sc;wa.AFrameworkApplication.uIc()?ni.instance.Lxj().continueWith(Vc=>{this.cVk();if(Vc.Hm||Vc.mo)I.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",
Vc.status);else{I.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Vc.status);if(this.DIe){Vc=window.Hammer;if("undefined"===typeof Vc){I.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.v0c();return}if("undefined"===typeof Vc.inputHandler){I.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.v0c();return}}if(!G)throw this.v0c(),Error.argumentNull("source element can not be null");Vc=Vi.a.kKa(G,this.AEa);if(void 0===Vc||null===Vc)Vc=new Ha.a,
Vi.a.Xwb(G,this.AEa,Vc),this.Qhk(G);var nd=null;if(!Vc.lh(bi[0])){nd=Object;var xd=nd.assign,Hd=new ji,ke=bi[0],V=sc;V=void 0===V?null:V;if(void 0===this||null===this)throw I.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Wa=null;switch(ke){case gb.a.YRc:Wa=new Hammer.Pinch(V);break;case gb.a.pan:Wa=new Hammer.Pan(V)}Wa&&(Wa.manager=this);nd=xd.call(nd,Hd,{eqa:Wa,xDf:ta});Vc.add(bi[0],nd)}if(void 0!==jb&&null!==jb)for(xd=0;xd<jb.length;xd++)Vc.lh(bi[jb[xd]])&&
(Hd=Vc.na(bi[jb[xd]]),nd.eqa.recognizeWith(Hd.eqa))}this.v0c()}):I.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}cVk(){this.Fbd&&(this.Io?this.Zkd=this.Io.Li("Task","RegisterGestureAdapterAfterLoad"):I.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}v0c(){this.Fbd&&(this.Zkd?this.Zkd.stop():I.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Qhk(G){this.Wlh.add(G);this.kk.bya(this.Bbb,
G,0,this.SEb)}recognize(G){var ta=Array(G.pointers.length);for(var jb=0;jb<G.pointers.length;jb++)ta[jb]=G.pointers[jb].target;jb=null;for(this.VDa=this.HPi(ta);void 0!==this.VDa&&null!==this.VDa&&(jb=Vi.a.kKa(this.VDa,this.AEa),void 0===jb||null===jb);this.VDa=this.VDa.parentNode);if(void 0!==jb&&null!==jb){this.curRecognizer&&this.curRecognizer.state===ci.Beh&&(this.curRecognizer=null);ta=jb.keys;for(const sc of ta){ta=jb.na(sc);void 0!==ta&&null!==ta&&void 0!==ta.eqa&&null!==ta.eqa&&(void 0===
this.curRecognizer||null===this.curRecognizer||ta.eqa===this.curRecognizer||ta.eqa.canRecognizeWith(this.curRecognizer))&&ta.eqa.recognize(G);const Vc=ta.eqa.state;this.curRecognizer||ci.yeh!==Vc&&ci.zeh!==Vc&&ci.Aeh!==Vc||(this.curRecognizer=ta.eqa)}}}emit(G,ta){if("hammer.input"!==G){this.Fka=!1;ta=Zi.create(G,this.VDa,ta.srcEvent,ta,3,this.Shd);var jb=Vi.a.kKa(this.VDa,this.AEa);if(this.Zoj(G))var sc=0;else if(this.Koj(G))sc=1;else if(this.gsj(G))sc=2;else{I.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");
return}({value:jb}=jb.wj(bi[sc]));void 0!==jb&&null!==jb&&((jb=jb.xDf,jb.Qlj())?G.endsWith("start")?this.Fka=jb.TSj(ta):G.endsWith("end")?(jb.RSj(ta),this.Fka=!0):G.endsWith("cancel")?(jb.QSj(ta),this.Fka=!0):G.endsWith("move")&&(this.Fka=jb.SSj(ta)):I.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",G))}}get(G){return Object(oe.a)(Hammer.Recognizer,G)}HPi(G){if(1>G.length)return null;if(1===G.length)return G[0];var ta=G[0],jb=!0;for(let sc=1;sc<G.length;sc++){if(!G[sc])return null;
if(ta!==G[sc]){jb=!1;break}}if(jb)return ta;ta=this.MDf(G[0]);jb=0;for(const sc of G){G=this.MDf(sc);if(ta.na(ta.count-1)!==G.na(G.count-1))return null;for(let Vc=ta.count-2,nd=G.count-2;Vc>=jb&&0<=nd;Vc--,nd--)if(ta.na(Vc)!==G.na(nd)){jb=Vc+1;break}}return ta.na(jb)}MDf(G){const ta=new Xh.a;for(;void 0!==G&&null!==G;G=G.parentNode)ta.add(G);return ta}cIf(G){switch(G){case gb.a.Lm:case gb.a.Oua:return 1;case gb.a.Jn:case gb.a.wWa:return 2;case gb.a.ml:case gb.a.PJb:return 4;case gb.a.k2c:case gb.a.Etd:return 8}return 0}xQf(){return 1<
this.C3.count}oqc(){I.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.RGb)for(const G of this.C3)this.pEg(G.key);else this.C3=new Ha.a;this.session=null}bzh(G,ta,jb){I.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",G);if(!this.lFb.lh(G)){try{ta.setPointerCapture(G)}catch(sc){I.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",sc)}this.lFb.add(G,ta)}this.C3.ga(G,jb);this.Aab&&1<this.C3.count&&this.msa&&!this.msa.zKb&&(this.msa.zKb=!0)}pEg(G){I.ULS.sendTraceTag(594055957,
310,50,"RemovePointerFromCaches: pointerId: {0}",G);if(this.lFb.lh(G)){try{this.lFb.na(G).releasePointerCapture(G)}catch(ta){I.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ta)}this.lFb.remove(G)}else I.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",G);this.C3.remove(G);this.Aab&&1>=this.C3.count&&this.msa&&this.msa.zKb&&(this.msa.zKb=!1)}gOi(G){const ta=new Ai;var jb=G.rawEvent;const sc=jb.touches;jb=jb.changedTouches;ta.pointers=Array.clone(sc);
ta.pointers=Array.clone(0<sc.length?sc:jb);ta.changedPointers=Array.clone(jb);ta.srcEvent=G;ta.pointerType="touch";return ta}fOi(G,ta,jb){const sc=new Ai;sc.pointers=Xe.toArray(G.values);sc.changedPointers=[ta];sc.pointerType=jb;sc.srcEvent=ta;return sc}Zoj(G){return ea.a.startsWith(G,gb.a.YRc)}Koj(G){return ea.a.startsWith(G,gb.a.pan)}gsj(G){return ea.a.startsWith(G,gb.a.Yve)}}Object(D.a)(th,"GestureInputManager",nc.a,[891,892]);var aj=a(386);class nj{constructor(){this.Wh=null;this.FG=!1}get name(){return"Common.App.GestureInputManager"}$n(G){G.register(th,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").yi().Ei(()=>new th(aj.a.instance,wa.AFrameworkApplication.ra.yL));this.Wh=G}init(){this.FG||(rd.a.instance.resolve("Common.App.GestureManager.GestureInputManager"),this.FG=!0)}dispose(){}static main(){og.a.instance.Do(new nj)}}Object(D.a)(nj,"GestureInputManagerPackage",null,[11,12]);const Wi=()=>rd.a.instance.Ho("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo");var ri=a(113);class hf extends ri.a{constructor(){super()}static instance(){return hf.Va||
(hf.Va=new hf)}}hf.p0j="OnTextSelectionHighlightChangeEvent";hf.Va=null;Object(D.a)(hf,"TextSelectionHighlightChangeEvent",ri.a,[]);class bj extends Nc.a{constructor(G,ta){super(!1,!1,!0);this.c6b=(jb,sc)=>{1===jb&&(this.ZRa.ySd=sc.tooltipPersistenceEnabled,jb=sc.textSelectionChangeEnabled,this.ZRa.H$b!==jb&&this.suh.raiseEvent(hf.p0j),this.ZRa.H$b=jb)};this.ZRa=G;this.suh=ta}start(){const G={["tooltipPersistenceEnabled"]:this.ZRa.ySd};G.textSelectionChangeEnabled=this.ZRa.H$b;this.initializeAndShow("",
this.c6b,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:G});I.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}Object(D.a)(bj,"AccessibilitySettingsDialog",Nc.a,[]);var Bi=a(136),pj=a(26);class vg{constructor(G,ta){this.dOk=()=>{(new bj(this.ZRa,hf.instance())).start();return 32};this.$f=G;this.ZRa=ta}ho(){this.$f.Uh(pj.a.cOk,Bi.a.frame,this.dOk)}}Object(D.a)(vg,"AccessibilitySettingsDialogActor",null,[912]);const si=G=>{const ta=new Dc.a;wa.AFrameworkApplication.rj.ov(Ag(G),
1,null,null,!0,2,jb=>{200===jb.data.httpStatus?ta.setResult("true"===jb.data.responseData.toLowerCase()):ta.setResult(!1)},()=>{ta.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ta.task},cj=(G,ta)=>{wa.AFrameworkApplication.rj.ov(Ag(G),2,ta.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},Ag=G=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",wa.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",G,wa.AFrameworkApplication.Jo);
var uh=a(117);class Mi{constructor(){this.Mdb=this.Kbb=null}get ySd(){return!!this.Kbb}set ySd(G){G!==this.Kbb&&(this.Kbb=G,uh.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(G),this.tJc()&&cj("saveHoverableRibbonTooltipIsEnabled",G))}get H$b(){return!!this.Mdb}set H$b(G){G!==this.Mdb&&(this.Mdb=G,this.tJc()&&cj("saveTextSelectionHighlightChangeIsEnabled",G))}Txj(){const G=new Dc.a;if(this.Kbb)G.setResult(this.Kbb);else if(this.tJc()){const ta=si("getHoverableRibbonTooltipIsEnabled");
ta.continueWith(()=>{this.Kbb=ta.result;uh.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ta.result);G.setResult(ta.result)},8)}else G.setResult(!1)}ryj(){const G=new Dc.a;if(this.Mdb)G.setResult(this.Mdb);else if(this.tJc()){const ta=si("getTextSelectionHighlightChangeIsEnabled");ta.continueWith(()=>{this.Mdb=ta.result;G.setResult(ta.result)},8)}else G.setResult(!1)}tJc(){const G=wa.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),ta=wa.AFrameworkApplication.fa.ka("IsAnonymousUser");
return G&&!ta}}Object(D.a)(Mi,"AccessibilitySettingsInfo",null,[890]);var Ci=a(102);class Ni{constructor(){this.Wh=null}get name(){return"Common.App.AccessibilitySettings"}$n(G){this.Wh=G;this.Wh.register(Mi,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ei(()=>new Mi).yi();this.Wh.register(vg,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ei(()=>
new vg(wa.AFrameworkApplication.yh,Wi())).yi()}init(){const G=Wi(),ta=rd.a.instance.Ho("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");G&&ta?(ta.ho(),G.Txj(),G.ryj(),Ci.a(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",G.H$b)):Ci.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){og.a.instance.Do(new Ni)}}Object(D.a)(Ni,"AccessibilitySettingsPackage",
null,[11,12]);class Lh extends Nc.a{constructor(G,ta){super(!1,!1,!0);this.c6b=(jb,sc)=>{if(1===jb){jb=sc.showRibbonChoice;if(this.EWe!==sc.ribbonLayoutChoice)appChrome.onRibbonModeToggle();this.vYe!==jb&&("AlwaysShow"===jb?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.EWe=G;this.vYe=ta}start(){this.initializeAndShow("",this.c6b,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["ribbonLayoutChoice"]:this.EWe,["showRibbonChoice"]:this.vYe}})}}Object(D.a)(Lh,
"RibbonSettingsDialog",Nc.a,[]);class oi{constructor(G){this.$f=G}ho(){this.$f.Uh(pj.a.bRk,Bi.a.frame,this.cRk)}cRk(){let G="SingleLineRibbon";"Multiline"===appChrome.selectors.getRibbonMode()&&(G="ClassicRibbon");const ta=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new Lh(G,ta)).start();return 32}}Object(D.a)(oi,"RibbonSettingsDialogActor",null,[913]);class di{constructor(){this.Wh=null}get name(){return"Common.App.RibbonSettings"}$n(G){this.Wh=G;this.Wh.register(oi,
"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").Ei(()=>new oi(wa.AFrameworkApplication.yh)).yi()}init(){const G=rd.a.instance.Ho("Common.App.RibbonSettings.IRibbonSettingsDialogActor");G?G.ho():Ci.a(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){og.a.instance.Do(new di)}}Object(D.a)(di,"RibbonSettingsPackage",null,[11,12]);class Mh extends zg.a{constructor(G){super();
this.$=G;this.gm()}create(){const G=Object(mc.d)(za.a.resolve(oa.pd,{va:this.xh}));Db.TaskExtensions.Xa(Db.TaskExtensions.Vo([G],this.$.ya),()=>{this.Bk(this.$.la.kh(211)||new Va(this.$,G.result,this.$.pK,this.$.Bl))},this.ya,3)}static Ba(G){G.la.Hh(212,new Mh(G))}}Object(D.a)(Mh,"AriaLiveNotifierFactory",zg.a,[]);var Bh=a(598),pi=a(1268),N=a(1416);class pa extends N.a{constructor(){super();this.$kd=this.jFb=null;this.state=0;this.Zcd=this.iOe=!1}get oZ(){return this.jFb}get fCa(){return this.$kd}get afj(){return this.iOe}eLf(){return"GetMoreInfo Result"}}
Object(D.a)(pa,"GetMoreInfoResult",N.a,[852,581]);var Xa=a(1127),Sb=a(125);class fc{constructor(G,ta,jb){this.Fjc=this.Aq=null;this.fjd=0;this.xsh=G;this.vk=ta;this.kKe=jb}jGh(){this.fjd=this.Tvb+1}tle(G){this.Aq&&(this.vk.Px(this.Aq),this.Aq=null);G&&(this.fjd=0)}UUk(G){const ta=this.n_k;0<=ta?(this.jGh(),this.tle(!1),this.Aq=new Sb.a(4,1,ta,G,107),this.vk.jm(this.Aq)):(this.tle(!0),I.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.kKe}))}get Tvb(){return this.fjd}get n_k(){return this.Tvb>=
this.JNg.length?-1:this.JNg[this.Tvb]}get JNg(){if(!this.Fjc){const G=(this.xsh.value||"0").split(",");this.Fjc=[];for(let ta=0;ta<G.length;ta++){const jb=parseInt(G[ta]);isNaN(jb)?I.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.kKe,["Entry"]:G[ta]}):Array.add(this.Fjc,jb)}}return this.Fjc}}Object(D.a)(fc,"RetryHelper",null,[]);class Kc extends pi.a{constructor(G,ta){super();this.bea=G;this.MFb=new fc(ta,this.I_b.UNc,"GetMoreInfo");this.Zz=
new pa}IDj(){this.Q4d("Document opened")}v7h(G){return()=>{this.Q4d(G,!0)}}wpg(G,ta){ta=void 0===ta?null:ta;I.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:G});3===this.Zz.state?(ta&&this.Wsf(ta,this.Zz),I.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:G})):this.Q4d(G);return this.Zz}Q4d(G,ta){this.MFb.tle(!(void 0===ta?0:ta));1===this.Zz.state?I.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
{["Trigger"]:G,["RetryIndex"]:this.MFb.Tvb}):(I.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:G,["RetryIndex"]:this.MFb.Tvb}),this.Zz.state=1,ta=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.I_b.H1,wa.AFrameworkApplication.Jo),this.I_b.Mrb.c$(ta,1,null,null,[Kc.SUe,Kc.aZe],!1,5,this.z6h(),this.y6h(G),null))}z6h(){return G=>{var ta=!1;let jb=!1;var sc=!1,Vc;if(wa.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody"))if(G.data.responseData){let nd=dh.d(G.data.responseData);
({zz:Vc}=nd);nd.returnValue?Vc?(sc=!0,this.Zz.$kd=Vc.StorageServiceDisplayName,this.Zz.jFb=Kc.j4f(Vc.PersonalFileStorageUrl)?Vc.PersonalFileStorageUrl:"",""===this.Zz.oZ&&"SharePointOnlineConsumer"===wa.AFrameworkApplication.fa.Ya("FileSource")&&(this.Zz.jFb=fd.a.sca(wa.AFrameworkApplication.breadcrumbFolderUrl)),ta=""===this.Zz.oZ&&""!==this.Zz.fCa):I.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
I.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else I.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");sc||((Vc=G.data.responseHeaders)?(this.Zz.$kd=(Vc[Kc.aZe]||"").toString(),ta=(Vc[Kc.SUe]||"").toString(),this.Zz.jFb=Kc.j4f(ta)?ta:"",""===this.Zz.oZ&&"SharePointOnlineConsumer"===wa.AFrameworkApplication.fa.Ya("FileSource")?
(this.Zz.jFb=fd.a.sca(wa.AFrameworkApplication.breadcrumbFolderUrl),ta=""===this.Zz.oZ&&""!==this.Zz.fCa):ta=""===ta&&""!==this.Zz.fCa):(I.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),jb=!0));sc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.MFb.Tvb,jb,ta,sc);this.I_b.apa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",G.data,sc);this.YNg(3,ta,jb)}}y6h(G){return ta=>{this.I_b.apa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
ta.data,"Failure");this.YNg(2);this.MFb.UUk(this.v7h(G))}}YNg(G,ta,jb){this.Zz.state=G;this.Zz.iOe=void 0===ta?!1:ta;this.Zz.Zcd=void 0===jb?!1:jb;this.TDd(this.Zz)}get I_b(){return this.bea.value}static get instance(){return Kc.Va||(Kc.Va=Kc.kY())}static kY(){return new Kc(new Bh.a(()=>Xa.a.instance),new Bh.a(()=>wa.AFrameworkApplication.qQi))}static j4f(G){if(!G)return I.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(ea.a.ys(G).startsWith("https://"))return!0;
I.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Kc.SUe="PersonalFileStorageUrl";Kc.aZe="StorageServiceDisplayName";Kc.Va=null;Object(D.a)(Kc,"GetMoreInfoActor",pi.a,[]);class ud{constructor(G,ta,jb,sc,Vc){this.anh=6E4;this.dUf="inactive";this.b1e="active";this.UJ=!0;this.vk=G;this.cmh=ta;this.ubd=jb;this.Jkc=sc;this.hh=new ri.a;Vc&&this.JUk();this.rQe=this.vIf()}V1e(G){this.hh.addHandler(this.b1e,G)}$yh(G){this.hh.addHandler(this.dUf,G)}JUk(){const G=new Sb.a(5,2,this.anh,
Object(dg.a)(this,this.f$i,"inactiveLoop"),108);this.g$i.jm(G)}f$i(){const G=this.vIf(),ta=this.SF()-G;ta>this.P1c&&this.UJ&&(I.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:ta}),this.UJ=!1,this.hh.raiseEvent(this.dUf));G-this.rQe>this.P1c&&(this.UJ=!0,this.hh.raiseEvent(this.b1e));this.rQe=G}get g$i(){return this.vk.value}get vIf(){return this.cmh}get SF(){return this.ubd}get P1c(){return this.Jkc.value}static get instance(){return ud.Va||(ud.Va=ud.kY())}static kY(){return new ud(new Bh.a(()=>
ia.TaskManager.instance),()=>wa.AFrameworkApplication.f3a.getTime(),()=>(new Date).getTime(),new Bh.a(()=>wa.AFrameworkApplication.P1c),!0)}}ud.Va=null;Object(D.a)(ud,"InactivityManager",null,[]);var Jd=a(1391);class ie{constructor(){this.QGb=this.UVe=this.Wh=null;this.mv=!1;this.mdi=()=>{ia.TaskManager.instance.Px(this.Gdg)};this.y2e=()=>{ia.TaskManager.instance.jm(this.Gdg)}}get name(){return"Common.App.NewAndOpen.Core"}$n(G){this.Wh=G;G.register(576,"Common.INewAndOpenCommonHelpers").yi().Ei(()=>
Xa.a.instance);G.register(582,"Common.IEventEmitter<Common.IGetMoreInfoResult>").yi().Ei(()=>Kc.instance);G.register(582,"Common.IEventEmitter<Common.IMruResult>").yi().Ei(()=>Jd.a.instance)}init(){wa.AFrameworkApplication.fa.Yx(()=>{this.FUb()})}FUb(){rd.a.instance.resolve("Common.INewAndOpenCommonHelpers");rd.a.instance.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");rd.a.instance.resolve("Common.IEventEmitter<Common.IMruResult>");var G=!1;Xa.a.instance.uhk();wa.AFrameworkApplication.lN&&
(G=!0);wa.AFrameworkApplication.bBg&&(Jd.a.instance.KDj(),0<wa.AFrameworkApplication.Fdg&&this.y2e(),this.NIk(),G=!0);wa.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&G&&Kc.instance.IDj();wa.AFrameworkApplication.k9k&&(G=Jd.a.instance,G.rjk(),G.TDj(),ia.TaskManager.instance.jm(this.l9k))}NIk(){ud.instance.V1e(Object(dg.a)(Jd.a.instance,Jd.a.instance.JDj,"makeGetMruRequestActivityTrigger"));ud.instance.V1e(this.y2e);ud.instance.$yh(this.mdi)}get Gdg(){return this.UVe||(this.UVe=new Sb.a(5,
2,wa.AFrameworkApplication.Fdg,Object(dg.a)(Jd.a.instance,Jd.a.instance.AQi,"getMruFromServerTask"),109))}get l9k(){return this.QGb||(this.QGb=new Sb.a(2,2,6E4*wa.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(dg.a)(Jd.a.instance,Jd.a.instance.UDj,"makeUpdateMruTask"),197))}dispose(){this.mv||(this.mv=!0,this.QGb&&(ia.TaskManager.instance.Px(this.QGb),this.QGb=null))}}Object(D.a)(ie,"CorePackageManager",null,[11,12,4]);var we=a(970);
class Qe{constructor(G,ta){this.mkd=this.lkd=null;this.xdb=new Dc.a;this.W1b=jb=>{let sc=null;sc&&sc.length||!jb||!jb.data||(sc=jb.data.responseData);if(sc&&sc.length)try{const Vc=dh.a(sc);this.lkd=Vc.NavBarDataJson;I.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.lkd?(()=>{let nd=dh.d(Vc.NavBarDataJson);({zz:this.mkd}=nd);return nd})().returnValue?(this.NAj(this.mkd),this.xdb.setResult(this.mkd)):(I.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",
{["ShellData"]:we.a.Z9a(this.lkd)}),this.xdb.$C()):(I.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.xdb.$C())}catch(Vc){I.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.xdb.$C()}else I.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.d1b=()=>{this.xdb.$C();I.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.Yn=G;this.lla=ta.appSettings[Qe.Del]||""}get fKk(){return this.xdb.task}get hma(){return this.Yn.value}Mrk(){const G=
{};G[Qe.S5i]=wa.AFrameworkApplication.Jo;G["Content-Type"]="application/json; charset=utf-8";I.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ta=fd.a.Ir(this.lla+Qe.gKk,Qe.xMj,wa.AFrameworkApplication.ra.$g.kn.toString());this.hma.ov(ta,1,"",G,!0,2,this.W1b,this.d1b,null,void 0,void 0,void 0,void 0,"20")}NAj(G){try{const ta={};ta.FlightName=G.FlightName;ta.SessionID=G.SessionID;I.ULS.sendTraceTag(594883776,215,50,dh.c(ta))}catch(ta){I.ULS.sendTraceTag(594883747,
215,10,"Unable to log NavBarData")}}static get instance(){return Qe.Va||(Qe.Va=Qe.Swa())}static Swa(){return new Qe(new Bh.a(()=>wa.AFrameworkApplication.rj),wa.AFrameworkApplication.fa,wa.AFrameworkApplication.ra.$g.kn)}}Qe.S5i="X-qs";Qe.xMj="at";Qe.gKk="O365ShellServiceProxy.ashx";Qe.Va=null;Qe.Del="ShellWebServiceBase";Object(D.a)(Qe,"O365ShellActor",null,[833]);class ef{constructor(){this.Wh=null;this.XK=()=>{wa.AFrameworkApplication.useO365ShellService&&wa.AFrameworkApplication.ra.$g.Ew&&rd.a.instance.resolve("Common.App.O365Shell.O365ShellActor").Mrk()}}get name(){return"Common.App.O365Shell"}$n(G){this.Wh=
G;this.Wh.register(Qe,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").yi().Ei(()=>new Qe(new Bh.a(()=>wa.AFrameworkApplication.rj),wa.AFrameworkApplication.fa,wa.AFrameworkApplication.ra.$g.kn))}init(){wa.AFrameworkApplication.fa.Yx(this.XK)}dispose(){}static main(){og.a.instance.Do(new ef)}}Object(D.a)(ef,"PackageManager",null,[11,12]);class wf extends zg.a{constructor(G,ta){super();this.activityName=G;this.DU=ta;this.gm()}create(){this.Bk(new ma(this.activityName,
this.DU,Fa.a.WG,Fa.a.Tp,Fa.a.czb))}static Ba(G){G.la.Hh(143,new wf(Fa.a.Kqa,Fa.a.Sfb));G.la.Hh(144,new wf(Fa.a.s7b,Fa.a.WNa));G.la.Hh(145,new wf(Fa.a.t7b,Fa.a.aRc));G.la.Hh(154,new wf(Fa.a.NPa,Fa.a.EW))}}Object(D.a)(wf,"SessionReloadSilentActivityFactory",zg.a,[]);var Tf=a(285),gg=a(145),wg=a(1055);class Lg{constructor(G){this.VZb=G}get name(){return"CopilotBootVisibilityCheck"}$n(){}init(){const G=ta=>{const jb=this;return Lo(function*(){var sc=Date.now();const Vc=yield ta.isFeatureEnabled("Copilot",
!1);sc=Date.now()-sc;I.ULS.sendTraceTag(507839317,3050,50,"[Copilot Chat] Early call to Copilot license check latency: "+sc);wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?uh.c()?(I.ULS.sendTraceTag(507331603,306,50,"Copilot Chat loaded so dispatching visibility"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(jb.VZb,!Vc))):(I.ULS.sendTraceTag(507331602,3050,50,"[Copilot Chat] AppChrome not loaded so setting cached visibility in local storage"),
Object(wg.b)(jb.VZb,Vc),gg.a.get_instance().Fm(10,()=>{uh.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(jb.VZb,!Vc)),I.ULS.sendTraceTag(507839316,306,50,"Copilot Chat visibility marked early"))})):gg.a.get_instance().Fm(10,()=>{uh.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(jb.VZb,!Vc)),I.ULS.sendTraceTag(507331601,306,50,"Copilot Chat visibility marked early"))})})};wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",
!1)?Object(wg.a)(this.VZb)?I.ULS.sendTraceTag(507331875,306,50,"Copilot Chat visibility already cached, skipping early check"):wa.AFrameworkApplication.fa.Yx(()=>G(Object(Sg.a)())):Object(Tf.a)().execute(G)}dispose(){}}Object(D.a)(Lg,"CopilotBootVisibilityCheck",null,[11,12]);(()=>{var G;null!==(G=wa.AFrameworkApplication.fa)&&void 0!==G&&G.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DemandLoadApplicationFeatureHelper",!1)||(Type.registerNamespace("Common"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),
Bg.main())})();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(()=>{ih.a.gh(G=>{ah.Ba(G)})})();mi.a.Bw(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
Type.registerNamespace("Common.App.GestureManager");nj.main();Type.registerNamespace("Common.App.AccessibilitySettings");Ni.main();Type.registerNamespace("Common.App.RibbonSettings");di.main();(()=>{ih.a.gh(G=>{xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||Mh.Ba(G)})})();mi.a.Bw(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(1px + 4px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1));border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:calc(-1px - 2px/var(--zoom-level-canvas,1));height:calc(1px + 2px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1));border-top:1.25px solid transparent}.ewr-selection-draghandle-left{top:0;left:calc(-1px - 1px/var(--zoom-level-canvas,1));bottom:0;width:calc(1px + 5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1));border-left:1.5px solid transparent}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(1px + 5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1));border-right:1.5px solid transparent}.ewr-selection-draghandle-top-updated{border-top:1px solid transparent;top:-2px;left:-2px;right:-2px;height:calc(3.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-updated{border-top:.75px solid transparent;right:0;left:-2px;bottom:-2px;height:calc(2.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-updated{border-left:1.25px solid transparent;top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-updated{border-right:1.25px solid transparent;top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr-selection-drag-tooltip-fluent{position:absolute;background-color:#fff;box-shadow:0 0 2px 0 #0000001f,0 4px 8px 0 #00000024;outline:1px solid transparent;border-radius:4px;height:fit-content;width:max-content;font-size:10px;padding:4px 8px 6px 8px}.ewr-selection-drag-tooltip-shift-instruction{font-style:italic;color:#8a8886}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-top-enhanced{height:calc(3px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-bottom-enhanced{height:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right-enhanced,.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right{width:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left-enhanced,.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left{width:calc(3px/var(--zoom-level-canvas,1))}.ewr_selection_rearrangeleft{border-left:3px solid #107c41;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #107c41;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #107c41;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #107c41;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr_selection_rearrange-flange-left,.ewr_selection_rearrange-fullrowcol-flange-left{border-left:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;left:-2px;top:-3.5px}.ewr_selection_rearrange-flange-right,.ewr_selection_rearrange-fullrowcol-flange-right{border-right:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;right:-5px;top:-3.5px}.ewr_selection_rearrange-flange-top,.ewr_selection_rearrange-fullrowcol-flange-top{border-top:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;top:-2px;left:-3.5px}.ewr_selection_rearrange-flange-bottom,.ewr_selection_rearrange-fullrowcol-flange-bottom{border-bottom:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;bottom:-5px;left:-3.5px}.ewr_selection_rearrange-fullrowcol-flange-left{left:0}.ewr_selection_rearrange-fullrowcol-flange-right{right:-3px}.ewr_selection_rearrange-fullrowcol-flange-top{top:0}.ewr_selection_rearrange-fullrowcol-flange-bottom{bottom:-3px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-drag-shadow{position:absolute;top:0;background-color:#107c41;opacity:15%;z-index:52;pointer-events:none;border-radius:2px}.ewa-grid-ltr .ewr-selection-drag-shadow{left:0}.ewa-grid-rtl .ewr-selection-drag-shadow{right:0}@media(forced-colors:active){.ewr-selection-drag-shadow{forced-color-adjust:none;background-color:#fff;opacity:20%}}@media(forced-colors:active) and (prefers-color-scheme:light){.ewr-selection-drag-shadow{background-color:#000}}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#107c41;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}");
Type.registerNamespace("Common.App.NewAndOpen.Core");og.a.instance.Do(new ie);Type.registerNamespace("Common.App.O365Shell");ef.main();xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1308);og.a.instance.Do(new Lg("Copilot"));(()=>{ih.a.gh(G=>{oa.Hf.Aa()||wf.Ba(G)})})();String(n);String(t);String(w);String(v);String(x);String(k);String(y);String(C);String(B);String(E);String(K);String(F);String(W);String(J);String(L);String(M);String(Q);String(H);String(ba);
window.___1710758652258_closurehack=n;window.___1710758652258_closurehack=t;window.___1710758652258_closurehack=w;window.___1710758652258_closurehack=v;window.___1710758652258_closurehack=x;window.___1710758652258_closurehack=k;window.___1710758652258_closurehack=y;window.___1710758652258_closurehack=C;window.___1710758652258_closurehack=B;window.___1710758652258_closurehack=E;window.___1710758652258_closurehack=K;window.___1710758652258_closurehack=F;window.___1710758652258_closurehack=W;window.___1710758652258_closurehack=
J;window.___1710758652258_closurehack=L;window.___1710758652258_closurehack=M;window.___1710758652258_closurehack=Q;window.___1710758652258_closurehack=H;window.___1710758652258_closurehack=ba}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.frs.js.map/73011c75407f4d4a4f71e99d5ad078a9/EwaTS.frs.js.map