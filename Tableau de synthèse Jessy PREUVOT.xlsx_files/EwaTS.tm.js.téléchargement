'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1066:function(A,u,a){a.d(u,"a",function(){return r});A=a(0);var c=a(15);class b{}Object(A.a)(b,"ExtraInfo",null,[]);class h{}Object(A.a)(h,"PerfOperation",null,[]);class r{constructor(f,l){this.XN=this.jt=null;this.Tw=f;this.Gr=l}get Vt(){return!!this.jt}get zi(){return this.jt?(new Date).getTime()-this.jt.getTime():0}get id(){throw Error.notImplemented();}start(){this.jt=new Date;return this.XN=null}stop(){this.jt&&
c.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",{["Operation"]:this.Tw,["Target"]:this.Gr,["StartTime"]:this.jt.toUTCString(),["DurationInMilliseconds"]:this.zi})}reset(){this.stop();this.XN=this.jt=null}Im(f){return!f||""===f}}Object(A.a)(r,"Stopwatch",null,[99,100])},1067:function(A,u,a){a.d(u,"a",function(){return n});A=a(0);var c=a(15);u=a(933);var b=a(598),h=a(6),r=a(17),f=a(125);class l{constructor(t,w,v,k){this.origin=t;this.data=w;this.source=v;this.La=void 0===k?null:k}}Object(A.a)(l,
"MessageEventArgs",null,[]);class m{constructor(t,w){this.uea=null;this.i3b=v=>this.r_?this.r_(new l(v.origin,v.data,v.source,v.La)):!1;this.WGb=t;this.vk=w;this.r_=null}get I8(){return this.WGb.value}get CN(){return this.vk.value}hWa(t,w){this.r_=t;this.uea=this.i3b;this.I8.addHandler(r.a.message,this.uea,w)}CYa(){this.r_=null;this.I8.removeHandler(r.a.message,this.uea)}oLa(t,w){const v=new f.a(0,1,1,()=>{t(w)},7);this.CN.jm(v)}iVb(t,w){const v=new f.a(0,1,1,()=>{t(w)},7);this.CN.jm(v)}static get instance(){return m.Swa()}static Swa(){return new m(new b.a(()=>
h.AFrameworkApplication.I8),new b.a(()=>h.AFrameworkApplication.Lp))}}Object(A.a)(m,"MessageEventHandler",null,[416]);var x=a(957);class n extends u.a{constructor(t,w,v){super(t,w,(void 0===v?null:v)||m.instance,n.OUb)}static OUb(){x.a.sendTraceTag=n.g7b;x.a.debugAssertTag=n.zNb}static g7b(t,w,v,...k){c.ULS.sendTraceTag.apply(null,[t,204,n.SMb(w),v].concat(k))}static zNb(){}static SMb(t){switch(t){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}
n.G3b="wdPreviousSession";n.gNb="wdUserSession";Object(A.a)(n,"CommonCrossDocumentMessenger",u.a,[])},1091:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{}c.qDd="stid";c.oDd="iid";c.pDd="DynamicImageProvider.aspx";c.k2="RequestStartTime";c.isEwaJsSplitEnabled="IsEwaJsSplitEnabled";c.d2a="IsJsSelfProfilerOnBootEnabled";Object(A.a)(c,"WebServiceConstants",null,[])},1175:function(A,u,a){a.r(u);a.d(u,"RenderingFidelityTracker",function(){return n});A=a(135);u=a(0);var c=a(15),b=a(107),
h=a(78),r=a(13),f=a(428);class l extends f.a{constructor(t){super();this.$=t;this.gm()}create(){const {RenderingFidelityTracker:t}=a(1175);let w=this.$.la.kh(462);w||(w=this.$.la.Hh(462,new t));this.Bk(w)}}Object(u.a)(l,"RenderingFidelityTrackerFactory",f.a,[]);var m=a(45);f=a(5);var x=a(95);let n=class extends h.a{constructor(){super();this.PGj=3E4;this.$yb={};this.JBe={};this.baf={};b.Health.instance.addQosPillar("Fidelity")}static Ba(t){t.la.Hh(463,new l(t))}C6e(t,w,v,k){if(!(m.a.instance.Gga(new Date)<
this.PGj)){var y=r.HelperMethods.jN(()=>{var C=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(w),B=Object.keys(C),E=this.baf[t];for(var K=0;K<B.length;K++){var F=B[K];this.JBe[F]||(null===E||void 0===E?0:E[F])&&this.$yb[F]&&(this.$yb[F]-=E[F])}this.baf[t]=C;for(K=0;K<B.length;K++)if(E=B[K],!this.JBe[E])if(F=C[E],this.$yb[E]&&(F+=this.$yb[E]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(E,F)){this.JBe[E]=!0;C=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(E);
B=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(E);K=!("ThickBorder"===E||"MediumBorder"===E);C&&B&&K&&b.Health.instance.recordQosError(C,[B],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+E+", isHC:"+v+", scaleFactor:"+k+"}");break}else this.$yb[E]=F});1<y&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${y}`)}}};n=Object(A.__decorate)([Object(x.d)(f.rf)],
n);Object(u.a)(n,"RenderingFidelityTracker",h.a,[667,4])},1220:function(A,u,a){a.d(u,"a",function(){return b});A=a(0);var c=a(15);class b{static PXa(h){h=new Date(h);return c.ULS.dif([b.Cyh(h.getUTCFullYear()),"-",b.veb(h.getUTCMonth()+1),"-",b.veb(h.getUTCDate()),"T",b.veb(h.getUTCHours()),":",b.veb(h.getUTCMinutes()),":",b.veb(h.getUTCSeconds()),".",b.E2e(h.getUTCMilliseconds()),"Z"])}static Cyh(h){return 1E3>h?"0"+b.E2e(h):h.toString()}static E2e(h){return 100>h?"0"+b.veb(h):h.toString()}static veb(h){return 10>
h?"0"+h:h.toString()}}Object(A.a)(b,"UlsUtils",null,[])},362:function(A,u,a){function c(Ma){switch(!0){case Ma.$F:return Q.MergedCell;case Ma.XR:return Q.Bbh;case Ma.HC:return Q.Formula;case Ma.hasAutoFilter:return Q.AutoFilter;case Ma.Ina:return Q.PivotFilter;case !!Ma.$Rc:return Q.PivotTable;case Ma.Jxa:return Q.Comment;case Ma.Gmb:return Q.Sparkline;case Ma.i0a:return Q.InCellImage;case Ma.hasRichText:return Q.qeh;default:return""}}function b(Ma){if(Ia.get(Ma))return Ia.get(Ma);var Na=Ma.replace(/-.*/g,
()=>"");Na=Ia.get(Na);return null!==Na&&void 0!==Na?Na:Ma.startsWith("ooux")?"ooux":"other"}a.r(u);var h={};a.r(h);a.d(h,"DocumentVisibilityObserver",function(){return W});var r={};a.r(r);a.d(r,"GridActionTelemetryManager",function(){return H});var f={};a.r(f);a.d(f,"EwaHostMessenger",function(){return ca});var l={};a.r(l);a.d(l,"InteractivityTrackerService",function(){return Ea});var m={};a.r(m);a.d(m,"PageLoadEngagementInfo",function(){return sa});var x={};a.r(x);a.d(x,"ServiceWorkerRegistrationManager",
function(){return hb});var n={};a.r(n);a.d(n,"ValidationTelemetryManager",function(){return Nb});var t={};a.r(t);a.d(t,"VirtualGetRangeTelemetryManager",function(){return Aa});var w=a(135),v=a(0),k=a(94),y=a(40),C=a(131),B=a(32),E=a(159),K=a(5),F=a(95);let W=class extends y.a{constructor(){super();this.VT=!1;this.EQe=this.DQe=null;this.A9d=()=>{this.p6g()};this.T$d=()=>{k.a.dh(this.U$);k.a.dh(this.du)};this.U$=E.a.instance.VXa();this.du=E.a.instance.BU();this.U$.Ba("visibilitychange",this.A9d);this.du.Ba("pagehide",
this.T$d);this.p6g()}get un(){return this.VT}get C5f(){return this.DQe}get JKc(){return this.EQe}f$(Ma){this.addHandler("ekdh",Ma)}S6a(Ma){this.removeHandler("ekdh",Ma)}c4(Ma){this.addHandler("ekduh",Ma)}ZOa(Ma){this.removeHandler("ekduh",Ma)}UM(Ma){return this.un?!0:this.JKc?C.getElapsedMilliseconds(this.JKc,B.a.ih.ri)<Ma:!1}dispose(){k.a.dh(this.U$);k.a.dh(this.du);super.dispose()}p6g(){this.VT="hidden"===window.document.visibilityState;this.un?(this.raiseEvent("ekdh"),this.DQe=B.a.ih.ri):(this.raiseEvent("ekduh"),
this.EQe=B.a.ih.ri)}};W=Object(w.__decorate)([Object(F.d)(K.Cb)],W);Object(v.a)(W,"DocumentVisibilityObserver",y.a,[246,4]);var J=a(15),L=a(1),M=a(23);const Q={MergedCell:"MergedCell",Bbh:"ConditionalFormat",Comment:"Comment",Formula:"Formula",AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",PivotTable:"PivotTable",Sparkline:"Sparkline",InCellImage:"InCellImage",qeh:"RichText"};let H=class{constructor(Ma){this.ej=()=>{const Na=JSON.stringify(this.fhf),Qc=JSON.stringify(this.ehf);J.ULS.sendTraceTag(508929763,
0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${Na}}`);J.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${Qc}}`)};this.$=Ma;this.fhf=[];this.ehf=[];L.EwaSettings.yWb()&&this.$.gq(this.ej)}dispose(){this.$=null}c3e(Ma,Na){this.fhf.push({commandName:Na,rowColCount:Ma.toString()})}god(Ma,Na){if(Ma&&0!==Ma.length){var Qc=[];const ce={};for(const ve of Ma)ve.Zhj()&&(Ma=c(ve),""!==Ma&&(ce[Ma]=ce[Ma]?ce[Ma]+
1:1));for(const ve of Object.keys(ce))Qc.push({cellType:ve,count:ce[ve]});0!==Qc.length&&this.ehf.push({commandName:Na,complexCellTypes:Qc})}}b2e(Ma,Na,Qc,ce,ve){const Ve=M.f(this.$);var vf=L.EwaSettings.X1a()?L.EwaSettings.wme():L.EwaSettings.i5d(),Kf=Ve.za.Qzc(1554436520===ve||1051390410===ve?vf:0,674605324===ve||-706918724===ve?vf:0);ve=[];vf=!1;"UnhideColumn"!==Ma&&"UnhideRow"!==Ma&&"insertColumns"!==Ma&&"insertRows"!==Ma||(vf=!0);for(const ug of Kf){{Kf=ug.yj;var ng=ce,Bf=Qc,Uf=Na,Qf=vf;let ag=
null;if(ng&&Kf||!L.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))Qf?Kf.Xi(ng)&&(ag=Kf,Uf?ag.top=ag.bottom-Bf+1:ag.left=ag.right-Bf+1):Kf.Xi(ng)||(ag=Kf,Uf?ag.bottom=ag.top+Bf-1:ag.right=ag.left+Bf-1);Kf=ag}Kf&&(Kf=Ve.za.iY(Kf))&&(ve=[...ve,...Kf])}this.god(ve,Ma+"Cascade")}};H=Object(w.__decorate)([Object(F.d)(K.Zc),Object(w.__param)(0,Object(K.Nb)())],H);Object(v.a)(H,"GridActionTelemetryManager",null,[670,4]);var ba=a(1067),U=a(6),D=a(42),I=a(113),X=a(144),
Y=a(394),ja=a(235),Ua=a(267),ka=a(63),fb=a(83),ha=a(28),ea=a(162),aa=a(933);Object(F.b)(K.nd,{Fk:"singleton"})(Ma=>Lo(function*(){const Na=yield F.a.resolve(K.Nb,Ma),Qc=window.parent,ce=L.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?Na.ua.DocumentHostInfo.PostMessageOrigin||aa.a.aM:U.AFrameworkApplication.rSc||aa.a.aM,ve=U.AFrameworkApplication.fa.ka("HostSendReadyToAcceptPostMessage");D.a.instance.register(ca,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").yi().Ei(()=>
new ca(Na,Qc,ce,ve));return D.a.instance.resolve("Postmessage.IHostPostmessenger")}));class ca extends ba.a{constructor(Ma,Na,Qc){super(Na,Qc);this.eh=new I.a;this.L8i=ce=>{if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const ve=ce.Values.m_Origin;U.AFrameworkApplication.wopiHostOriginFromPostMessage||(U.AFrameworkApplication.wopiHostOriginFromPostMessage=ve)}switch(ce.MessageId){case X.a.oSd:ea.a(this.$).HPf(ce);break;case X.a.C2d:Ua.a.ltas(null);break;case X.a.GEc:this.cVj();
break;case X.a.sSd:this.bVj(ce)}};this.$=Ma;Qc!==aa.a.aM&&this.sX(Qc);this.ndj();this.scj();Ma=this.L8i;this.aq(X.a.oSd,Ma);this.aq(X.a.C2d,Ma);this.aq(X.a.GEc,Ma);this.aq(X.a.sSd,Ma)}dispose(){this.$=null;super.dispose()}ndj(){this.kr(X.a.Fcf);this.kr(X.a.oSd);this.kr(X.a.GEc);this.kr(X.a.sSd);this.pVa(X.a.C2d);this.kr(X.a.rSd)}scj(){this.rX("App_EwrWorkbookNotSupportedCancelResponse");this.rX(X.a.ZFa);this.rX(X.a.d5);this.rX("App_CloseTab");this.rX(X.a.O$a);this.rX(X.a.P$a);this.rX(X.a.TSf);this.rX(X.a.CEc);
this.rX("App_ModifyURLState")}cVj(){const Ma={};Ma.hostMessageReceived=(new Date).getTime();J.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");U.AFrameworkApplication.JJc=!0;Ma.appUnloadStart=(new Date).getTime();Ma.sendBeaconFlight=U.AFrameworkApplication.fa.ka("SendBeaconOnShuttingDownRequestsEnabled");Ma.sendBeaconSupported=ka.a.Jqa();ka.a.r7e();Ma.appUnloadEnd=(new Date).getTime();Ma.appMessageSent=(new Date).getTime();this.sendMessage(X.a.OHh,Ma)}bVj(Ma){J.ULS.sendTraceTag(537162882,
0,50,"EwaHostMessenger.OnHostSwitchMode");Ma.Values&&Y.a.i7d in Ma.Values&&ha.a.equals(Ma.Values[Y.a.i7d],ja.a.edit,!0)&&!this.$.isEditMode&&(J.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${Ma.Values[Y.a.i7d]}`),Ma=new fb.a(-8805455,0,1,0,null),this.$.Ma.qh(Ma))}}Object(v.a)(ca,"EwaHostMessenger",ba.a,[669,439,4]);var xa=a(17),Oa=a(45);const ua="context-menu floatie task-pane context-menu-auto-filter context-menu-auto-filter-items dialog".split(" "),Ia=new Map;
[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])},{name:"scroll_animation",actions:new Set(["viewport_scroll"])},{name:"zoom_animation",actions:new Set(["viewport_zoom"])},{name:"drag_animation",actions:new Set("drag_range_insert drag_range_replace drag_table_row_rearrange drag_table_column_rearrange drag_row_insert drag_row_replace drag_column_insert drag_column_replace drag_pivot_replace drag_pivot_row_rearrange drag_pivot_column_rearrange".split(" "))},{name:"async_ui",actions:new Set(ua)},{name:"freeze_pane_drag_animation",
actions:new Set(["freeze_pane_header_drag_vertical","freeze_pane_header_drag_horizontal","freeze_pane_line_drag_vertical","freeze_pane_line_drag_horizontal"])}].forEach(Ma=>{Ma.actions.forEach(Na=>{Ia.set(Na,Ma.name)})});class Sa{constructor(Ma){this.$=Ma}getAppState(){const Ma=Oa.a.instance.Gga(new Date);return-1===Ma?"boot":3E4>Ma?"postboot":"steady"}isChangeGateEnabled(Ma){return L.EwaSettings.isChangeGateEnabled(Ma)}getBooleanFeatureGate(Ma,Na){return L.EwaSettings.getBooleanFeatureGate(Ma,Na)}getCurrentAppInfo(){return{appState:this.getAppState(),
appInfoProperties:[{key:"coauthCount",value:this.$.ea.Wt.length.toString()}]}}sendBeaconTraceTag(Ma,Na,Qc,ce){this.$.sendBeaconTraceTag(Ma,Na,Qc,ce)}getActionBucket(Ma){return b(Ma)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.MFj}`}logSlowActionsHandler(){return""}logAsyncActionHandler(){return""}}Object(v.a)(Sa,"InteractivityTrackerCallbacks",null,[]);var Ya=a(916);const da=(Ma,Na)=>Lo(function*(){return Object(Ya.a)("interactivity",Na)});Object(F.b)(K.Ed,{Fk:"singleton"})(Ma=>
Lo(function*(){const Na=yield F.a.resolve(K.Nb,Ma);yield da(Na,Ma);const Qc=interactivity.InteractivityTrackerFactoryGlobal.create();return new Ea(Na,Qc)}));class Ea{constructor(Ma,Na){this.uA=void 0===Na?null:Na;Ea.bIc?J.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(Ma),Ea.bIc=!0)}initialize(Ma){J.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");this.uA?(L.EwaSettings.u_d()&&
Ea.R0c.push(xa.a.Oua),Ea.R0c.push("mouseup"),Ea.R0c.push("touchstart"),Ma={events:Ea.R0c,durationThresholdInMs:Ea.durationThresholdInMs,callbacks:new Sa(Ma)},L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncUI",!1)&&(Ma.asyncUiTracking={slowUiEventThresholdMs:L.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowUIEventThresholdMs",500),asyncUiEventTimeoutMs:L.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AsyncUIEventTimeoutMs",3E4),allowedAsyncUiNames:[...ua],slowActionTimeoutOverrides:[]}),
Ma.periodicReport={isPassiveTestEnabled:!1,intervalMs:6E4},L.EwaSettings.isChangeGateEnabled("OfficeVSO:8570179_TrackingScrollAnimation")&&(Ma.animationTracking={chunkDurationMs:L.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimationChunkDurationMs",100),minFramesPerChunk:L.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimationMinFramesPerChunk",3),animationTimeoutMs:L.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.animationTimeoutMs",5E3)}),Ma=
this.uA.start(Ma),Ma.started?J.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):J.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+Ma.failureReason)):J.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}TA(Ma,Na,Qc,ce){if(this.uA)return this.uA.trackInteraction(Ma,Na,Qc,ce);J.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Na}`)}qmf(){return this.uA?
this.uA.createActionsRetriever():(J.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.uA&&(this.uA.stop(),this.uA=null)}addContext(Ma,Na,Qc){this.uA?this.uA.addContext(Ma,Na,Qc):J.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}startTrackAnimation(Ma,Na){return this.uA?Ea.bIc?this.uA.startTrackAnimation(Ma,Na):(J.ULS.sendTraceTag(507847813,
0,50,"InteractivityTrackerService.startTrackAnimation: trying startTrackAnimation but interactivityTrackerService instance was no created."),!1):(J.ULS.sendTraceTag(508343192,0,50,"InteractivityTrackerService.startTrackAnimation: interactivityTracker not initialized."),!1)}stopTrackAnimation(Ma){this.uA?L.EwaSettings.isChangeGateEnabled("OfficeVSO:8500180_checkIfInteractivityServiceExistsBeforeStartTracking")&&!Ea.bIc?J.ULS.sendTraceTag(507847812,0,50,"InteractivityTrackerService.startTrackAnimation: trying stopTrackAnimation but interactivityTrackerService instance was no created."):
this.uA.stopTrackAnimation(Ma):J.ULS.sendTraceTag(508343191,0,50,"InteractivityTrackerService.endTrackAnimation: interactivityTracker not initialized.")}}Ea.durationThresholdInMs=100;Ea.R0c="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");Ea.bIc=!1;Object(v.a)(Ea,"InteractivityTrackerService",null,[77]);var oa=a(2),za=a(154),la=a(58),Ca=a(54);class Va{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(v.a)(Va,"ActionData",
null,[]);class ia{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(v.a)(ia,"BlockedEngagementInfo",null,[]);class wa extends Va{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(v.a)(wa,"SuccessfulActionData",Va,[]);class Jb{constructor(){this.successfulActions=[]}}Object(v.a)(Jb,"SuccessfulEngagementInfo",null,[]);var $a=a(44),Ka=a(47),nb;let sa=nb=class{constructor(Ma){this.wZa=new Set;this.e$b=null;this.yAf=this.uZg=!1;this.Vsb=(Na,Qc)=>{this.LJb.hasBlockedActions=
!0;Na=this.LJb.blockedActions.length;const ce=Qc.details?Qc.actionName+"_"+Qc.details:Qc.actionName;Qc=Object(oa.a)(new Va,{order:Na+1,name:ce,componentName:Qc.componentName,timeFromNavigationStart:Qc.timeFromNavigationStart});this.LJb.blockedActions.push(Qc)};this.Jm=()=>{$a.a(this.$).k5b(this.Vsb);this.jzj();this.e$b=la.a.instance.create(()=>{this.FZb()},nb.KWk,Ca.a.FZb)};this.ej=()=>{this.FZb()};this.Ife=()=>{this.$.si(2009315810,-1,0,null);this.fse=!1};this.LJb=new ia;this.LJb.hasBlockedActions=
!1;this.qyb=new Jb;this.Evi();this.$=Ma;L.EwaSettings.wl()?this.$.ea.Yq(this.Jm):this.$.ea.lr(this.Jm);this.$.gq(this.ej);this.NWk=0;this.fse=!1;L.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.zjf=new Promise(Na=>{this.d3h=Na}));$a.a(this.$).Vmc(this.Vsb)}dispose(){this.$.ea&&!L.EwaSettings.wl()&&this.$.ea.Bv(this.Jm);this.$.Yu(this.ej);k.a.dh(this.e$b);this.$=this.e$b=null}tgk(Ma,Na,Qc){if(void 0!==Ma&&null!==Ma&&Na){var ce=this.qyb.successfulActions.length+
1,ve="InputMethod"in Na?Na.InputMethod:"",Ve="IsCommand"in Na&&Na.IsCommand;if(this.atj(Ma,Na,ve,Ve)){++this.NWk===nb.Yal?(this.fse=!0,this.V5j=la.a.instance.create(this.Ife,5E3,Ca.a.Ife)):this.fse&&this.V5j.MA();if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const vf=!Ve&&Ma;this.yAf||vf===za.a.F9g||vf===za.a.G9g||vf===za.a.A9g||vf===za.a.B9g||(this.yAf=!0,this.d3h(void 0))}ce>nb.Ubg||(Ma=Object(oa.a)(new wa,{order:ce,name:Ma,componentName:"Location"in
Na?Na.Location:"",timeFromNavigationStart:Qc,inputMethod:ve,isCommand:Ve}),this.qyb.successfulActions.push(Ma),1===ce?this.eAj():ce===nb.Ubg&&this.FZb())}}}jzj(){J.ULS.sendTraceTag(254546634,0,50,`${Ka.c(this.LJb)}`)}eAj(){Oa.a.instance.Gga(new Date)>nb.Tvi?J.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${Ka.c(this.qyb.successfulActions[0])}`):J.ULS.sendTraceTag(254563592,0,50,`${Ka.c(this.qyb.successfulActions[0])}`)}FZb(){!this.uZg&&this.qyb.successfulActions.length&&(this.uZg=
!0,k.a.dh(this.e$b),this.e$b=null,this.$.sendBeaconTraceTag(254559496,50,!1,Ka.c(this.qyb)))}Evi(){this.wZa.add(za.a.Cnd);this.wZa.add(za.a.Xne);this.wZa.add(za.a.Ude);this.wZa.add(za.a.Gwg);this.wZa.add(za.a.Iwg);this.wZa.add(za.a.Kwg)}atj(Ma,Na,Qc,ce){Qc=!Qc||"unknown"===Qc;const ve="IsSystemInitiated"in Na&&Na.IsSystemInitiated;Na="NoReporting"in Na&&Na.NoReporting;const Ve=this.wZa.has(Ma);Ma=ha.a.equals(Ma,za.a.CXc,!0)&&Qc;return!ve&&!Na&&!Ve&&!Ma&&!(ce&&Qc)}};sa.Ubg=10;sa.Tvi=6E4;sa.KWk=12E4;
sa.Yal=25;sa=nb=Object(w.__decorate)([Object(F.d)(K.ve),Object(w.__param)(0,Object(K.Nb)())],sa);Object(v.a)(sa,"PageLoadEngagementInfo",null,[]);var na=a(1175),ab=a(10),Ja=a(35),Pa;let hb=Pa=class{constructor(){this.I4i=()=>{const Ma=this;return Lo(function*(){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseServiceWorker",!1)?yield Ma.register():yield Ma.unregister()})};this.init().then(()=>{J.ULS.sendTraceTag(507654145,0,50,"ServiceWorkerRegistrationManager.init: Initialization complete")}).catch(Ma=>
{J.ULS.sendTraceTag(507654144,0,15,`ServiceWorkerRegistrationManager.init: Initialization failed: ${Ma}`)})}init(){const Ma=this;return Lo(function*(){Ja.a.$Nh&&navigator.serviceWorker.getRegistrations?(Oa.a.instance.Pm("ServiceWorkerSupported"),navigator.serviceWorker.controller&&Oa.a.instance.Pm("ServiceWorkerControlled"),yield Ma.I4i(),Ma.AMh()):Oa.a.instance.Pm("ServiceWorkerNotSupported")})}register(){return Lo(function*(){try{const Ma=yield navigator.serviceWorker.register(`${ab.a.rBk}`);J.ULS.sendTraceTag(507795410,
0,15,`ServiceWorkerRegistrationManager.register: Registration succeeded. workerState = ${Ma.active?"active":Ma.waiting?"waiting":Ma.installing?"installing":"none"}, scope = ${Ma.scope}`)}catch(Ma){J.ULS.sendTraceTag(507795409,0,15,`ServiceWorkerRegistrationManager.register: call to serviceWorker.register failed: ${Ma}`)}})}unregister(){return Lo(function*(){try{const Ma=yield navigator.serviceWorker.getRegistrations();for(const Na of Ma)(yield Na.unregister())?J.ULS.sendTraceTag(507795408,0,15,"ServiceWorkerRegistrationManager.unregister: Unregistration succeeded"):
J.ULS.sendTraceTag(507795407,0,10,"ServiceWorkerRegistrationManager.unregister: Unregistration failed")}catch(Ma){J.ULS.sendTraceTag(507795406,0,50,`ServiceWorkerRegistrationManager.unregister: call to serviceWorker.unregister failed: ${Ma}`)}})}static Y4i(Ma){try{const Na=Date.now(),Qc=JSON.parse(Ma.data).serviceWorkerTime;J.ULS.sendTraceTag(507606657,0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: delta between sending message from SW to processing message in main thread: ${Na-
Qc}`)}catch(Na){J.ULS.sendTraceTag(507606656,0,10,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: failed: ${Na}`)}}static Z4i(Ma){L.EwaSettings.isChangeGateEnabled("OfficeVSO:8617694_HandleServiceWorkerHeartbeat")&&Ma.data.includes("heartbeat")?Pa.Y4i(Ma):J.ULS.sendTraceTag(507795405,0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerMessage: ${Ma.data}`)}AMh(){navigator.serviceWorker.addEventListener("message",Pa.Z4i)}};hb=Pa=Object(w.__decorate)([Object(F.d)(K.Ff)],
hb);Object(v.a)(hb,"ServiceWorkerRegistrationManager",null,[]);var ac=a(210),Hc=a(212),bd=a(103);class zc{constructor(Ma,Na,Qc){this.$cl=Ma;this.t5=Na;this.name=Qc}}Object(v.a)(zc,"Validation",null,[]);var oc;let Nb=oc=class{constructor(Ma){this.csb=()=>{this.Eug(this.OAf)};this.vp=()=>{this.Eug(this.JMh)};this.$=Ma;this.JMh=new ac.a;this.OAf=new ac.a;M.f(this.$).za.ny(this.vp);M.f(this.$).za.J3e(this.csb)}qod(Ma,Na,Qc,ce,ve){if(Ma&&ce){const Ve=Hc.a.bH(Na,Qc);this.$lc(()=>!!bd.a(Ma).Tx(Ve),ce.StateId,
ve)}}$lc(Ma,Na,Qc){this.MAh(this.OAf,Ma,Na,Qc)}MAh(Ma,Na,Qc,ce){Ma&&Na&&Qc!==ab.a.Dk&&Ma.add(new zc(Na,Qc,ce))}Eug(Ma){if(Ma){var Na=new ac.a;for(const Qc of Ma){if(Qc.t5===this.$.ea.Ek)try{Qc.$cl()||J.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${Qc.name}]`)}catch(ce){J.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${Qc.name}]. Exception: [${ce}]`)}Na.add(Qc)}for(const Qc of Na)Ma.remove(Qc)}else J.ULS.shipAssertTag(537151011,
0,!!Ma,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){M.f(this.$)&&M.f(this.$).za&&(M.f(this.$).za.ux(this.vp),M.f(this.$).za.Gie(this.csb));this.$=null}static Ba(Ma){const Na=new oc(Ma);Ma.la.Hh(277,Na)}};Nb=oc=Object(w.__decorate)([Object(F.d)(K.Ng),Object(w.__param)(0,Object(K.Nb)())],Nb);Object(v.a)(Nb,"ValidationTelemetryManager",null,[666,4]);let Aa=class{constructor(Ma){this.S5a=void 0;this.Cbg=()=>{this.a9g(!0)};this.Bbg=()=>{this.a9g(!1)};this.L1=
(Na,Qc)=>{Qc.A8d!==ab.a.Dk&&(this.S5a=Qc.eKj===ab.a.Dk?this.$.ea.NC:Qc.A8d)};this.m0c=new Map;Ma.ea.dK(this.L1);this.da=M.f(Ma);this.$=Ma}Abg(Ma){this.m0c.set(this.$.ea.NC,Ma);this.syh()}a9g(Ma){if(void 0!==this.S5a&&this.m0c.has(this.S5a)){const Na=this.m0c.get(this.S5a);this.hBj(Na,this.S5a,Ma);this.m0c.delete(this.S5a)}else this.gBj(this.S5a);this.Akk()}hBj(Ma,Na,Qc){J.ULS.sendTraceTag(507623310,1,20,`VirtualGetRangeTelemetryManager.logPrefetchResult. PrefetchResult is ${Qc} for the operation with the details OpName ${Ma} and stateId ${Na}`)}gBj(Ma){J.ULS.sendTraceTag(507623309,
1,20,`VirtualGetRangeTelemetryManager.logPrefetchErrorForStateId. currentStateID ${Ma} is not present in StateIdToOperationData`)}syh(){this.da.cq.fFh(this.Cbg);this.da.cq.eFh(this.Bbg)}Akk(){this.da.cq.$ok(this.Cbg);this.da.cq.Zok(this.Bbg)}};Aa=Object(w.__decorate)([Object(F.d)(K.Tg),Object(w.__param)(0,Object(K.Nb)())],Aa);Object(v.a)(Aa,"VirtualGetRangeTelemetryManager",null,[665]);class Ub{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=
this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(v.a)(Ub,"BrowserInfo",
null,[]);class Db{constructor(){this.Version=this.Name=null}}Object(v.a)(Db,"PluginInfo",null,[]);class Ib{static qAj(){if(U.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var Ma=Ib.cBi();try{const Na=JSON.stringify(Ma);J.ULS.sendTraceTag(6903563,102,50,Na)}catch(Na){J.ULS.sendTraceTag(6903564,102,15,Na.message)}}else J.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static QSi(){const Ma=window.navigator.plugins;if(!Ma||!Ma.length)return null;const Na=[];for(let Qc=
0;Qc<Ma.length;Qc++){const ce=Ma[Qc].name,ve=Ma[Qc].version;Array.add(Na,Object.assign(new Db,{Name:ce,Version:ve}))}return Na}static cBi(){const Ma=new Ub,Na=new Sys.StringBuilder;Ib.BC(Qc=>{Ma.DocElemClientHeight=Qc},()=>document.documentElement.clientHeight,Na);Ib.BC(Qc=>{Ma.DocElemClientWidth=Qc},()=>document.documentElement.clientWidth,Na);Ib.BC(Qc=>{Ma.DocElemOffsetHeight=Qc},()=>document.documentElement.offsetHeight,Na);Ib.BC(Qc=>{Ma.DocElemOffsetWidth=Qc},()=>document.documentElement.offsetWidth,
Na);Ib.BC(Qc=>{Ma.ScreenAvailHeight=Qc},()=>window.screen.availHeight,Na);Ib.BC(Qc=>{Ma.ScreenAvailWidth=Qc},()=>window.screen.availWidth,Na);Ib.BC(Qc=>{Ma.ScreenWidth=Qc},()=>window.screen.width,Na);Ib.BC(Qc=>{Ma.ScreenHeight=Qc},()=>window.screen.height,Na);Ib.BC(Qc=>{Ma.ScreenLogicalXdpi=Qc},()=>window.screen.logicalXDPI,Na);Ib.BC(Qc=>{Ma.ScreenLogicalYdpi=Qc},()=>window.screen.logicalYDPI,Na);Ib.BC(Qc=>{Ma.ScreenDeviceXdpi=Qc},()=>window.screen.deviceXDPI,Na);Ib.BC(Qc=>{Ma.ScreenDeviceYdpi=Qc},
()=>window.screen.deviceYDPI,Na);Ib.BC(Qc=>{Ma.WinInnerHeight=Qc},()=>window.self.innerHeight,Na);Ib.BC(Qc=>{Ma.WinInnerWidth=Qc},()=>window.self.innerWidth,Na);Ib.BC(Qc=>{Ma.WinOuterHeight=Qc},()=>window.self.outerHeight,Na);Ib.BC(Qc=>{Ma.WinOuterWidth=Qc},()=>window.self.outerWidth,Na);Ib.BC(Qc=>{Ma.WinOrientation=Qc},()=>window.self.orientation,Na);Ib.BC(Qc=>{Ma.WinDevicePixelRatio=Qc},()=>window.self.devicePixelRatio,Na);Ib.BC(Qc=>{Ma.SupportsTouch=Qc},()=>Ja.a.U0c,Na);Ib.BC(Qc=>{Ma.NavAppName=
Qc},()=>window.navigator.appName,Na);Ib.BC(Qc=>{Ma.NavAppVersion=Qc},()=>window.navigator.appVersion,Na);Ib.BC(Qc=>{Ma.NavLanguage=Qc},()=>window.navigator.browserLanguage||window.navigator.language,Na);Ib.BC(Qc=>{Ma.NavUserAgent=Qc},()=>window.navigator.userAgent,Na);Ib.BC(Qc=>{Ma.NavPlatform=Qc},()=>window.navigator.platform,Na);U.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipLoggingPluginsEnabled",!1)||Ib.BC(Qc=>{Ma.NavPlugins=Qc},Ib.QSi,Na);Ib.BC(Qc=>{Ma.CalculatedDevicePixelRatio=
Qc},()=>Ib.devicePixelRatio,Na);Ma.Error=Na.toString();return Ma}static get devicePixelRatio(){const Ma=window.devicePixelRatio;return isNaN(Ma)?window.screen.deviceXDPI/window.screen.logicalXDPI:Ma}static BC(Ma,Na,Qc){try{const ce=Na();Ma(ce)}catch(ce){Qc.isEmpty()||Qc.append(" | "),Qc.append(ce.message||"null")}}}Object(v.a)(Ib,"BrowserInfoLogger",null,[]);var yc=a(282);class xc{get name(){return"Common.App.BrowserInfoLogger"}$n(){}init(){Ib.qAj()}dispose(){}static main(){yc.a.instance.Do(new xc)}}
Object(v.a)(xc,"BrowserInfoLoggerPackage",null,[11,12]);var zb=a(79);class vb{constructor(Ma){this.H7c=Ma}HYf(Ma){if(!this.H7c)return!0;Ma=zb.a.rMd(Ma);if(!Ma)return!1;Ma=Ma.toLowerCase();for(let Na=0;Na<this.H7c.length;Na++)if(Ma.endsWith(this.H7c[Na]))return!0;return!1}}Object(v.a)(vb,"DomainAllowListManager",null,[]);class bb{constructor(Ma,Na){this.V4=null;this.Nld=Ma;this.url=Na}get MAe(){return zb.a.sca(this.url)}get Vz(){return this.Nld}rxe(){const Ma={},Na=this.Vz;Ma.a=this.MAe;Ma.b=this.round(Na.navigationStart);
Ma.c=this.round(Na.unloadEventStart);Ma.d=this.round(Na.unloadEventEnd);Ma.e=this.round(Na.redirectStart);Ma.f=this.round(Na.redirectEnd);Ma.g=this.round(Na.fetchStart);Ma.h=this.round(Na.domainLookupStart);Ma.i=this.round(Na.domainLookupEnd);Ma.j=this.round(Na.connectStart);Ma.k=this.round(Na.connectEnd);Ma.l=void 0!==Na.secureConnectionStart&&null!==Na.secureConnectionStart?this.round(Na.secureConnectionStart):0;Ma.m=this.round(Na.requestStart);Ma.n=this.round(Na.responseStart);Ma.o=this.round(Na.responseEnd);
Ma.q=this.round(Na.domInteractive);Ma.r=this.round(Na.domContentLoadedEventStart);Ma.s=this.round(Na.domContentLoadedEventEnd);Ma.t=this.round(Na.domComplete);Ma.u=this.round(Na.loadEventStart);Ma.v=this.round(Na.loadEventEnd);Ma.w=this.V4;return Ma}round(Ma){return Math.round(1E3*Ma)/1E3}}Object(v.a)(bb,"PerformanceTimingEntry",null,[]);const La=(Ma,Na)=>{var Qc,ce;const ve={};let Ve=null;switch(Ma){case 0:Ve="ResourceTiming";Ma=Na.a;null!=Ma&&(ve.Url=Ma);Ma=Na.b;null!=Ma&&(ve.InitiatorType=Ma);
Ma=null==Na.c?null:Na.c.toString();null!=Ma&&(ve.RedirectStart=Ma);Ma=null==Na.d?null:Na.d.toString();null!=Ma&&(ve.RedirectEnd=Ma);Ma=null==Na.e?null:Na.e.toString();null!=Ma&&(ve.FetchStart=Ma);Ma=null==Na.f?null:Na.f.toString();null!=Ma&&(ve.DomainLookupStart=Ma);Ma=null==Na.g?null:Na.g.toString();null!=Ma&&(ve.DomainLookupEnd=Ma);Ma=null==Na.h?null:Na.h.toString();null!=Ma&&(ve.ConnectStart=Ma);Ma=null==Na.i?null:Na.i.toString();null!=Ma&&(ve.ConnectEnd=Ma);Ma=null==Na.j?null:Na.j.toString();
null!=Ma&&(ve.SecureConnectionStart=Ma);Ma=null==Na.k?null:Na.k.toString();null!=Ma&&(ve.RequestStart=Ma);Ma=null==Na.l?null:Na.l.toString();null!=Ma&&(ve.ResponseStart=Ma);Ma=null==Na.m?null:Na.m.toString();null!=Ma&&(ve.ResponseEnd=Ma);Ma=Na.n;null!=Ma&&(ve.CustomText=Ma);Ma=null==Na.o?null:Na.o.toString();null!=Ma&&(ve.DecodedBodySize=Ma);Ma=null==Na.p?null:Na.p.toString();null!=Ma&&(ve.EncodedBodySize=Ma);Ma=null==Na.q?null:Na.q.toString();null!=Ma&&(ve.TransferSize=Ma);Na=null!==(ce=null===(Qc=
Na.r)||void 0===Qc?void 0:Qc.toString())&&void 0!==ce?ce:null;null!=Na&&(ve.responseStatus=Na);break;case 1:Ve="PerformanceTiming",Qc=Na.a,null!=Qc&&(ve.Url=Qc),Qc=null==Na.b?null:Na.b.toString(),null!=Qc&&(ve.NavigationStart=Qc),Qc=null==Na.c?null:Na.c.toString(),null!=Qc&&(ve.UnloadEventStart=Qc),Qc=null==Na.d?null:Na.d.toString(),null!=Qc&&(ve.UnloadEventEnd=Qc),Qc=null==Na.e?null:Na.e.toString(),null!=Qc&&(ve.RedirectStart=Qc),Qc=null==Na.f?null:Na.f.toString(),null!=Qc&&(ve.RedirectEnd=Qc),Qc=
null==Na.g?null:Na.g.toString(),null!=Qc&&(ve.FetchStart=Qc),Qc=null==Na.h?null:Na.h.toString(),null!=Qc&&(ve.DomainLookupStart=Qc),Qc=null==Na.i?null:Na.i.toString(),null!=Qc&&(ve.DomainLookupEnd=Qc),Qc=null==Na.j?null:Na.j.toString(),null!=Qc&&(ve.ConnectStart=Qc),Qc=null==Na.k?null:Na.k.toString(),null!=Qc&&(ve.ConnectEnd=Qc),Qc=null==Na.l?null:Na.l.toString(),null!=Qc&&(ve.SecureConnectionStart=Qc),Qc=null==Na.m?null:Na.m.toString(),null!=Qc&&(ve.RequestStart=Qc),Qc=null==Na.n?null:Na.n.toString(),
null!=Qc&&(ve.ResponseStart=Qc),Qc=null==Na.o?null:Na.o.toString(),null!=Qc&&(ve.ResponseEnd=Qc),Qc=null==Na.p?null:Na.p.toString(),null!=Qc&&(ve.DomLoading=Qc),Qc=null==Na.q?null:Na.q.toString(),null!=Qc&&(ve.DomInteractive=Qc),Qc=null==Na.r?null:Na.r.toString(),null!=Qc&&(ve.DomContentLoadedEventStart=Qc),Qc=null==Na.s?null:Na.s.toString(),null!=Qc&&(ve.DomContentLoadedEventEnd=Qc),Qc=null==Na.t?null:Na.t.toString(),null!=Qc&&(ve.DomComplete=Qc),Qc=null==Na.u?null:Na.u.toString(),null!=Qc&&(ve.LoadEventStart=
Qc),Qc=null==Na.v?null:Na.v.toString(),null!=Qc&&(ve.LoadEventEnd=Qc),Na=Na.w,null!=Na&&(ve.CustomText=Na)}ve.Table=Ve;return Sys.Serialization.JavaScriptSerializer.serialize(ve)};var pb=a(56),fa=a(173),kb=a(489);class db{constructor(Ma,Na,Qc){this.sI=Ma;this.LAe=this;this.amh=(void 0===Na?null:Na)||(()=>window.location.href);this.Q$c=new vb(void 0===Qc?null:Qc)}run(){if(db.t4(window.performance))try{const ve=this.amh();if(db.Quh.exec(ve)&&this.Q$c.HYf(ve)){var Ma=new bb(window.performance.timing,
ve);kb.a.instance.Ofk(Ma.Vz.fetchStart);kb.a.instance.Pfk(Ma.Vz.navigationStart);kb.a.instance.t_b(pb.a.Zzi,"connectStart","requestStart");kb.a.instance.t_b(pb.a.gAi,"requestStart","responseStart");kb.a.instance.t_b(pb.a.jAi,"responseStart","responseEnd");this.LAe.Ll(1,Ma.rxe());this.sI.Zq(pb.a.wJa,Ma.Vz.fetchStart);this.sI.Zq(pb.a.dAi,Ma.Vz.domainLookupStart);this.sI.Zq(pb.a.cAi,Ma.Vz.domainLookupEnd);this.sI.Zq(pb.a.aAi,Ma.Vz.connectStart);this.sI.Zq(pb.a.kAi,Ma.Vz.secureConnectionStart);this.sI.Zq(pb.a.$zi,
Ma.Vz.connectEnd);this.sI.Zq(pb.a.hAi,Ma.Vz.requestStart);this.sI.Zq(pb.a.GQb,Ma.Vz.responseStart);this.sI.Zq(pb.a.eAi,Ma.Vz.responseEnd-Ma.Vz.responseStart);this.sI.Zq(pb.a.iAi,Ma.Vz.responseStart-Ma.Vz.requestStart);var Na=0,Qc=0,ce=0;(()=>{let Ve=this.N3k(ve);({transferSize:Na,aEd:Qc,oBd:ce}=Ve);return Ve})().returnValue&&(this.sI.Zq(pb.a.lAi,Na),this.sI.Zq(pb.a.bAi,ce),this.sI.Zq(pb.a.fAi,Qc));this.sI.Zq(pb.a.WId,Ma.Vz.navigationStart)}}catch(ve){J.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",
ve)}}N3k(Ma){let Na,Qc,ce;ce=Qc=Na=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Na,aEd:Qc,oBd:ce};Ma=window.performance.getEntriesByName(Ma,"navigation");if(void 0===Ma||null===Ma||1!==Ma.length)return{returnValue:!1,transferSize:Na,aEd:Qc,oBd:ce};Ma=Ma[0];var ve=Ma.transferSize;void 0!==Na&&null!==Na&&(Na=ve);ve=Ma.decodedBodySize;void 0!==ve&&null!==ve&&(ce=ve);Ma=Ma.encodedBodySize;void 0!==Ma&&null!==Ma&&(Qc=
Ma);return{returnValue:!0,transferSize:Na,aEd:Qc,oBd:ce}}Ll(Ma,Na){J.ULS.sendTraceTag(4551815,306,50,La(Ma,Na))}static get instance(){return db.Va||(db.Va=new db(fa.a.instance,null,U.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?U.AFrameworkApplication.fa.Ez("ResourceLoggerDomainAllowList"):null))}static t4(Ma){return!(void 0===Ma||null===Ma)&&!(void 0===Ma.timing||null===Ma.timing)}}db.Va=null;db.Quh=RegExp("^https?://.*","i");Object(v.a)(db,"PerformanceTimingLogger",null,
[695]);var gb=a(153);class Kb{constructor(Ma,Na){this.V4=null;this.Nld=Ma;this.behavior=Na;this.url=this.Vz.name}get MAe(){return 2===this.behavior?this.url:zb.a.sca(this.url)}get Vz(){return this.Nld}rxe(){const Ma={},Na=this.Vz;Ma.a=this.MAe;Ma.b=Na.initiatorType;Ma.c=this.round(Na.redirectStart);Ma.d=this.round(Na.redirectEnd);Ma.e=this.round(Na.fetchStart);Ma.f=this.round(Na.domainLookupStart);Ma.g=this.round(Na.domainLookupEnd);Ma.h=this.round(Na.connectStart);Ma.i=this.round(Na.connectEnd);
Ma.j=void 0!==Na.secureConnectionStart&&null!==Na.secureConnectionStart?this.round(Na.secureConnectionStart):0;Ma.k=this.round(Na.requestStart);Ma.l=this.round(Na.responseStart);Ma.m=this.round(Na.responseEnd);Ma.o=this.round(Kb.pxa(Na,"decodedBodySize"));Ma.p=this.round(Kb.pxa(Na,"encodedBodySize"));Ma.q=this.round(Kb.pxa(Na,"transferSize"));Ma.n=this.V4;Ma.r=Kb.pxa(Na,"responseStatus")||0;return Ma}round(Ma){return Math.round(1E3*Ma)/1E3}static pxa(Ma,Na){return Ma[Na]}}Object(v.a)(Kb,"ResourceTimingEntry",
null,[706]);var ub=a(107),lb=a(202),Ba=a(92);class ra{constructor(Ma,Na,Qc){this.TYe=!1;this.dHe=Ma;this.lkc=void 0===Na?null:Na;this.yDa={};this.Dih=void 0===Qc?100:Qc;this.RGe=U.AFrameworkApplication&&U.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",!1)}$2k(Ma){var Na=Ma.name.toLowerCase();const Qc=zb.a.Aga(Na);this.KIg(Qc,Na)&&(Qc in this.yDa?J.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
Qc):(Na={},Na.starttime=Ma.startTime,Na.workerstart=Ma.workerStart,Na.redirectstart=Ma.redirectStart,Na.redirectend=Ma.redirectEnd,Na.fetchstart=Ma.fetchStart,Na.domainlookupstart=Ma.domainLookupStart,Na.domainlookupend=Ma.domainLookupEnd,Na.connectstart=Ma.connectStart,Na.secureconnectionstart=Ma.secureConnectionStart,Na.connectend=Ma.connectEnd,Na.requeststart=Ma.requestStart,Na.responsestart=Ma.responseStart,Na.responseend=Ma.responseEnd,Na.iscached=this.H3f(Ma),Na.nexthopprotocol=Ma.nextHopProtocol,
Na.encodedsize=Kb.pxa(Ma,"encodedBodySize"),Na.decodedsize=Kb.pxa(Ma,"decodedBodySize"),this.yDa[Qc]=Na))}a3k(Ma){var Na=Ma.name.toLowerCase();const Qc=zb.a.Aga(Na);this.ttk(Qc,Na)&&(Qc in this.yDa?J.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",Qc):(Na={},Na.starttime=Ma.startTime,Na.workerstart=Ma.workerStart,Na.redirectstart=Ma.redirectStart,Na.redirectend=Ma.redirectEnd,Na.fetchstart=Ma.fetchStart,Na.domainlookupstart=Ma.domainLookupStart,
Na.domainlookupend=Ma.domainLookupEnd,Na.connectstart=Ma.connectStart,Na.secureconnectionstart=Ma.secureConnectionStart,Na.connectend=Ma.connectEnd,Na.requeststart=Ma.requestStart,Na.responsestart=Ma.responseStart,Na.responseend=Ma.responseEnd,Na.iscached=this.H3f(Ma),Na.nexthopprotocol=Ma.nextHopProtocol,Na.encodedsize=Kb.pxa(Ma,"encodedBodySize"),Na.decodedsize=Kb.pxa(Ma,"decodedBodySize"),Na.it=Ma.initiatorType,Na.ress=Ma.responseStart,Na.cs=Ma.connectStart,Na.ce=Ma.connectEnd,Na.dls=Ma.domainLookupStart,
Na.dle=Ma.domainLookupEnd,Na.rs=Ma.redirectStart,Na.re=Ma.redirectEnd,Na.reqs=Ma.requestStart,Na.scs=Ma.secureConnectionStart,this.yDa[Qc]=Na))}KIg(Ma,Na){if(this.dHe)return Array.contains(this.dHe,Ma);if(this.lkc)for(Ma=zb.a.WU(Na),Na=0;Na<this.lkc.length;Na++)if(this.lkc[Na]&&Ma.endsWith(this.lkc[Na]))return!0;return!1}ttk(Ma,Na){return this.KIg(Ma,Na)?Ma.endsWith(".js")||Ma.endsWith(".css"):!1}H3f(Ma){try{const Na=Kb.pxa(Ma,"transferSize");if(void 0!==Na&&null!==Na)return!Na;J.ULS.sendTraceTag(51652510,
306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return Ma.responseEnd-Ma.fetchStart<this.Dih}catch(Na){J.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Na.message)}return!1}rgk(){if(Ba.a.Im(this.yDa))J.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else if(U.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.StaticResourceMetricsForKpiLogOnlyOnce",
!1)&&this.TYe)J.ULS.sendTraceTag(507581086,306,15,"Static Resource Metrics already logged in KPI");else{var Ma=U.AFrameworkApplication.flightId?U.AFrameworkApplication.flightId.split(";"):[],Na=Object.assign({},{extendedProperties:lb.a.wy()});Na.extendedProperties.set("Flights",Ka.c(Ma));this.zAj(Na,this.yDa,ub.Health.instance);this.TYe=!0}}aKd(Ma){var Na,Qc;let ce=0,ve=0,Ve=0,vf=0,Kf=0;const ng=this.yDa;for(const Qf in ng){var Bf=Qf,Uf=ng[Qf];Bf.endsWith(".js")&&(Uf=Object(gb.a)(Object,Uf),Uf.responseend<
Ma&&(ce+=1,ve+=Uf.decodedsize,vf+=Uf.encodedsize,Ve+=Uf.iscached?0:Uf.encodedsize,Bf=Bf.toLowerCase(),this.RGe&&((null===(Qc=null===(Na=U.AFrameworkApplication.fa)||void 0===Na?void 0:Na.Ya("Slice1Name"))||void 0===Qc?0:Qc.toLowerCase().endsWith(Bf))?Kf|=1:Bf.endsWith(".common.js")||Bf.endsWith(".othercommon.js")||Bf.endsWith(".ext.js")?Kf|=2:Bf.endsWith("common50.min.js")&&(Kf|=4))))}Ma={};Ma.filesLoaded=ce;Ma.decodedBytes=ve;Ma.transferredBytes=Ve;Ma.encodedBytes=vf;this.RGe&&(Ma.lazyChunksLoaded=
Kf);return Ma}zAj(Ma,Na,Qc){if(Na){var ce=0,ve=0,Ve=0,vf=0,Kf=0,ng=0,Bf=0,Uf=0,Qf=0,ug=0,ag=0;for(const Tg in Na){var Dg=Na[Tg];try{const ig=Object(gb.a)(Object,Dg);if(!ig)continue;const Yg=ig.iscached?Boolean.parse(ig.iscached.toString()):!1,vh=ig.fetchstart?this.parseFloat(ig.fetchstart.toString()):0,Zg=(ig.responseend?this.parseFloat(ig.responseend.toString()):0)-vh,Qg=ig.encodedsize?this.parseFloat(ig.encodedsize.toString()):0,Wg=ig.decodedsize?this.parseFloat(ig.decodedsize.toString()):0;ce+=
Zg;vf+=Qg;Bf+=Wg;ug++;Yg?(Ve+=Zg,ng+=Qg,Qf+=Wg,ag++):(ve+=Zg,Kf+=Qg,Uf+=Wg)}catch(ig){J.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",ig.message)}}Ma.extendedProperties.set("StaticResources",Ka.c(Na));Ma.extendedProperties.set("TotalResourceDownloadLatency",ce.toString());Ma.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",ve.toString());Ma.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",Ve.toString());Ma.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
vf.toString());Ma.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Kf.toString());Ma.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",ng.toString());Ma.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Bf.toString());Ma.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Uf.toString());Ma.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Qf.toString());Ma.extendedProperties.set("TotalNumberOfResourcesDownloaded",
ug.toString());Ma.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",ag.toString());Qc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);Qc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Ma)}}parseFloat(Ma){if(!Ma)return 0;Ma=parseFloat(Ma);return isNaN(Ma)?0:Ma}}Object(v.a)(ra,"AppStaticResourceManager",null,[]);class wb extends Sys.EventArgs{constructor(Ma){super();this.entries=Ma}}Object(v.a)(wb,"EntriesAvailableEventArgs",
Sys.EventArgs,[]);var mc=a(125);class xb{constructor(Ma,Na,Qc,ce,ve,Ve){Qc=void 0===Qc?null:Qc;ce=void 0===ce?null:ce;ve=void 0===ve?100:ve;Ve=void 0===Ve?!1:Ve;this.oed=!1;this.Aq=null;this.NBb=0;this.hh=new I.a;this.gSa=null;this.UJ=!1;this.WZe=0;this.vk=Ma;this.YJe=0;this.LAe=this;this.Q$c=new vb(Qc);this.nE=Na;ce&&(this.gSa=new ra(null,ce,ve));this.ghh=Ve}get Oaf(){try{return!(void 0===this.nE||null===this.nE)&&!(void 0===this.nE.getEntriesByType||null===this.nE.getEntriesByType)}catch(Ma){return J.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",Ma),!1}}get Vbi(){return this.YJe}get isActive(){return this.UJ}get fxe(){return this.WZe}fCh(Ma){this.hh.addHandler(xb.AEd,Ma)}smk(Ma){this.hh.removeHandler(xb.AEd,Ma)}$n(Ma,Na){const Qc=this.fxe!==Ma;this.WZe=Ma;this.isActive&&this.vk&&Qc&&(this.Px(),this.jm());this.YJe=Na}activate(){!this.isActive&&this.Oaf&&(this.jm(),this.UJ=!0)}deactivate(Ma){this.isActive&&(this.Px(),Ma&&this.flush(),this.UJ=!1)}flush(){if(this.isActive&&
this.Oaf)try{var Ma=window.performance.getEntriesByType("resource");0<Ma.length-this.NBb&&J.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Ma.length-this.NBb);const Na=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Na&&(window.performance.clearResourceTimings(),this.NBb=0);const Qc=[];for(let ce=this.NBb;ce<Ma.length;ce++)this.Q$c.HYf(Ma[ce].name)&&(this.gSa&&(this.ghh?
this.gSa.a3k(Ma[ce]):this.gSa.$2k(Ma[ce])),Qc.push(new Kb(Ma[ce],this.Vbi)));Na||(this.NBb=Ma.length);this.hh.raiseEvent(xb.AEd,new wb(Qc));for(Ma=0;Ma<Qc.length;Ma++)0!==Qc[Ma].behavior&&2!==Qc[Ma].behavior||this.LAe.Ll(0,Qc[Ma].rxe());0<Qc.length&&J.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",Qc.length)}catch(Na){J.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Na)}}Ll(Ma,Na){J.ULS.sendTraceTag(4310804,
306,50,La(Ma,Na))}Nfk(){this.gSa.rgk()}aKd(Ma){return this.gSa.aKd(Ma)}jm(){this.vk&&0<this.fxe&&(this.Aq=new mc.a(3,2,1E3*this.fxe,()=>{this.flush()},5),this.vk.jm(this.Aq),this.oed=!0)}Px(){this.oed&&(this.vk.Px(this.Aq),this.Aq=null,this.oed=!1)}}xb.AEd="EntriesAvailable";Object(v.a)(xb,"ResourceTimingLogger",null,[686,695]);var Ec=a(138);class ed{constructor(){this.Wh=null}get name(){return"Common.ResourceTiming"}init(){D.a.instance.resolve("Common.NetworkTiming.IResourceTimingLogger");db.instance.run()}dispose(){}$n(Ma){this.Wh=
Ma;let Na=null;if(U.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{Na=U.AFrameworkApplication.fa.Ez("ResourceLoggerDomainAllowList")}catch(Ve){J.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const Qc=[];Qc.push(zb.a.WU(Ec.a.sW).toLowerCase());Qc.push(zb.a.WU(Ec.a.nxb).toLowerCase());const ce=U.AFrameworkApplication.fa.Lj("AppStaticResourceMonitorCacheThresholdInMs",100),ve=U.AFrameworkApplication.fa.ka("PPTAggregateResourceTimingV2Enabled");
Ma.register(686,"Common.NetworkTiming.IResourceTimingLogger").yi().Ei(()=>new xb(U.AFrameworkApplication.Lp,window.performance,Na,Qc,ce,ve))}static main(){yc.a.instance.Do(new ed)}}Object(v.a)(ed,"ResourceTimingPackage",null,[11,12]);var jd=a(142);class Xd extends Sys.EventArgs{constructor(Ma,Na){super();this.mZk=Ma;this.actualValue=Na}}Object(v.a)(Xd,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var Td=a(102);class gc{constructor(){this.Kab=[];this.yJe=this.h$c=0;this.csa=null;this.hh=
new I.a;this.H3h=(Ma,Na)=>{Td.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.K5h(Na.mZk,Na.actualValue))}}init(Ma,Na,Qc){this.csa=Ma;this.h$c=Na;this.yJe=Qc;this.csa.F4e(Object(jd.a)(this,this.iQj,"onCpuMeterFrameAvailable"));this.zDh(this.H3h)}iQj(Ma,Na){Na.Heg&&(Array.enqueue(this.Kab,Na.Heg.CP),this.Kab.length>this.yJe&&(Array.dequeue(this.Kab),this.ZVh()))}ZVh(){var Ma=this.Kab.length;let Na=0;for(let Qc=0;Qc<Ma;Qc++){const ce=Array.dequeue(this.Kab);Na+=ce;Array.enqueue(this.Kab,
ce)}Ma=Na/Ma;Ma>this.h$c&&this.hh.raiseEvent("CPTTE",new Xd(this.h$c,Ma))}zDh(Ma){this.hh.addHandler("CPTTE",Ma)}K5h(Ma,Na){const Qc={};Qc.ThresholdValue=Ma;Qc.ActualValue=Na;return Qc}}Object(v.a)(gc,"CpuMeterMonitor",null,[699]);var nc=a(183);class dc{constructor(){this.S=this.T=this.M=this.C=0}}Object(v.a)(dc,"ProfileInformation",null,[]);var Gc=a(53),vd=a(292);class zd{constructor(Ma,Na){this.Fcd=!1;this.nTa={};this.qhc=void 0===Ma?0:Ma;this.Ahc=void 0===Na?0:Na;this.cmd=0;Gc.a.addHandler(window.self,
xa.a.uGh,()=>{this.Fcd=!0});Gc.a.addHandler(window.self,xa.a.vGh,()=>{this.Fcd=!1})}a6e(Ma,Na,Qc){const ce=zd.generateKey(Na,Qc);ce in this.nTa?Na=this.nTa[ce]:(Na=new dc,Na.S=Qc?1:0,this.nTa[ce]=Na,this.cmd++);Na.C++;Na.M=Ma>Na.M?Ma:Na.M;Na.T+=Ma}zla(Ma,Na){this.a6e(Ma,Na,!1);this.Fcd&&this.a6e(Ma,Na,!0)}getData(){if(0<this.Ahc&&this.cmd>this.Ahc)return this.OIi();const Ma=0<this.qhc,Na={},Qc=this.nTa;for(const ve in Qc){var ce=ve;const Ve=Qc[ve];this.WJg(Ve);Ma&&Ve.T>=this.qhc&&(Na[ce]=Ve)}return Ma?
Ba.a.Im(Na)?null:Na:this.nTa}OIi(){var Ma=0<this.qhc,Na=[];const Qc=this.nTa;for(const ce in Qc){const ve={key:ce,value:Qc[ce]},Ve=ve.value;(!Ma||Ve.T>=this.qhc)&&Array.add(Na,ve)}if(Na.length>this.Ahc)Na.sort((ce,ve)=>ve.value.T-ce.value.T),Na=Na.slice(0,this.Ahc);else if(!Na.length)return null;Ma={};for(const ce of Na)Na=ce.value,this.WJg(Na),Ma[ce.key]=Na;return Ma}WJg(Ma){Ma.M=vd.a.Ria(Ma.M,0);Ma.T=vd.a.Ria(Ma.T,0)}reset(){this.nTa={};this.cmd=0}static generateKey(Ma,Na){return Na?Ma+" [it]":
Ma}}Object(v.a)(zd,"FunctionCallAggregator",null,[696]);class Yb{}Yb.bMh="BatchedOperation";Yb.fqk="Replication";Yb.v4k="25";Yb.gqk="9_"+Yb.bMh+"_"+Yb.fqk;Object(v.a)(Yb,"CpuMeterConstants",null,[]);class Pb{}Object(v.a)(Pb,"CpuMeterFrame",null,[]);class $c extends Sys.EventArgs{constructor(Ma){super();this.Heg=Ma}}Object(v.a)($c,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class wd{}Object(v.a)(wd,"MiniTaskItemInfo",null,[]);class Bd{}Object(v.a)(Bd,"TaskItemInfo",null,[]);var tc=a(598),Zc=
a(106);class Ab{static g0i(){if(!Ab.Zcc&&(Ab.Zcc=new Zc.a,U.AFrameworkApplication.fa&&U.AFrameworkApplication.fa.Nv("AggregatorIdDisabledList"))){const Ma=U.AFrameworkApplication.fa.Ez("AggregatorIdDisabledList");for(let Na=0;Na<Ma.length;Na++)Ab.Zcc.ga(Ma[Na],!0)}return Ab.Zcc}}Ab.Zcc=null;Object(v.a)(Ab,"DisabledAggregatorListStore",null,[]);var rb=a(296);class Fb{constructor(Ma,Na,Qc,ce,ve,Ve,vf,Kf){Ve=void 0===Ve?!0:Ve;vf=void 0===vf?null:vf;this.rnf=Kf;this.q9=this.iZe=this.YPe=!1;this.vk=null;
if(!Ma)throw rb.a.argument("taskManagerLazy");if(!ve)throw rb.a.argument("dataAggregator");this.euh=Ma;this.Xgd=Na;this._id=Qc;this.kOe=6E4*ce;this.tec=ve;this.nWe=Ve;this.PFb=vf;Ab.g0i().lh(this._id.toString())&&(this.q9=!0)}get CN(){return this.vk||(this.vk=this.euh.value)}track(Ma,Na){Na=void 0===Na?null:Na;this.q9||(this.umi(),this.oxk(),this.tec.zla(Ma,Na))}oxk(){!this.YPe&&0<this.kOe&&(this.YPe=!0,this.TLg())}TLg(){const Ma=new mc.a(5,1,this.kOe,()=>{this.Ezk()},19,this._id.toString());this.CN.jm(Ma)}Ezk(){!this.PFb||
this.PFb.CKk()?this.fNg():this.nWe&&this.tec.reset();this.TLg()}fNg(){const Ma=this.tec.getData();if(Ma){const Na=parseInt(String(Ma.length));if(isNaN(Na)||0<Na)this.QXc(Ma),this.rnf&&this.rnf(Ma),this.nWe&&this.tec.reset()}}QXc(Ma){J.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:Ma})}umi(){this.iZe||(this.Xgd(()=>{this.fNg()}),this.iZe=!0)}static kY(Ma,Na,Qc,ce,ve,Ve){return new Fb(new tc.a(()=>U.AFrameworkApplication.Lp),U.AFrameworkApplication.BQa,Ma,Na,
Qc,ce,ve,Ve)}static glb(Ma,Na,Qc){return Fb.kY(Ma,Na,Qc,!0,null,void 0)}}Object(v.a)(Fb,"Aggregator",null,[697]);class jc{constructor(Ma){Ma=void 0===Ma?null:Ma;this.jv=null;this.reset();this.PFb=Ma}zla(Ma,Na){if(!this.PFb||this.PFb.CKk())Na in this.jv||(this.jv[Na]=[]),this.jv[Na].push(Ma)}getData(){return Ba.a.count(this.jv)?this.jv:null}reset(){this.jv={}}}Object(v.a)(jc,"NamedValuesAggregator",null,[696]);var Oc=a(245);class cd{constructor(Ma,Na,Qc,ce,ve){this.KUa=0;this.bO=null;this.rjc=this.RYe=
0;this.dXe=!1;this.mbb=0;this.EDb=!1;this.gFa=null;this.mgc=0;this.NTe=new I.a;this.cuh=[];this.WW=Ma;this.Nfd=Na;this.nbd=Qc;this.ZRe=ce;U.AFrameworkApplication.fa&&U.AFrameworkApplication.fa.ka("WrapSetTimeoutForTelemetryIsEnabled")&&this.y0d();this.elh=ve;this.obd=new zd(100);this.kph=Fb.glb(1,5,new jc)}F4e(Ma){this.NTe.addHandler("OnCpuMeterFrameAvailable",Ma)}nub(Ma,Na,Qc,ce){Qc=(ce=void 0===ce?null:ce)?ce.priority:7;const ve=this.WW();this.start(Na,Qc);try{Ma()}finally{this.stop(Na,ce),Ma=this.WW()-
ve,this.ZRe.track(Ma,Na)}}D7(Ma,Na){const Qc=this.WW();try{Ma()}finally{Ma=this.WW()-Qc,this.nbd.zla(Ma,Na),0<this.KUa&&this.obd.zla(Ma,Na),this.ZRe.track(Ma,Na)}}Kae(Ma){const Na=new Bd;Na.TN=Ma.pMc;Na.TP=Ma.priority;this.aAg(1,Na)}hrb(Ma){this.mgc|=Ma}start(Ma,Na){if(!this.KUa){this.obd.reset();const Qc=this.Z3f(Ma);Qc&&this.d5d(1);this.bO=new Bd;this.bO.TN=Ma;this.bO.TP=Na;this.bO.ST=(new Date).toISOString();this.bO.STS=vd.a.Ria(this.WW(),2);Qc?this.bO.UI=1:this.Vnj(Ma)?this.bO.UI=2:this.bO.UI=
0}this.KUa++}d5d(Ma){this.mbb|=Ma}iwd(Ma,Na){this.mbb=void 0===Ma||Ma?0:this.mbb&~(void 0===Na?0:Na)}stop(Ma,Na){Na=void 0===Na?null:Na;let Qc;this.KUa--;0>=this.KUa&&this.bO&&(Qc=this.WW()-this.bO.STS,this.rjc+=Qc,this.Nfd.zla(Qc,Ma),this.Z3f(Ma)&&this.iwd(!1,1),this.bO.TRT=vd.a.Ria(Qc,2),Na&&(this.bO.TQT=vd.a.Ria(Na.eck,2),this.bO.TDT=vd.a.Ria(Na.A5f,2)),this.elh&&(this.aAg(0,this.bO),this.Rqk()),this.KUa=0);0<=Ma.indexOf(Yb.v4k)&&this.hrb(2);0<=Ma.indexOf(Yb.gqk)&&this.hrb(4);1===(this.mbb&1)&&
this.hrb(1);2===(this.mbb&2)&&this.hrb(8)}Rqk(){var Ma=this.bO.TRT;if(750<Ma){let Qc=this.obd.getData();if(Qc){const ce={};for(const ve in Qc){var Na=Qc[ve];const Ve=ve;Ve.startsWith("SiOp_")||Ve.endsWith("[it]")||(ce[Ve]=Math.round(100*Na.T/Ma))}Qc=ce}Ma=Object.assign(new wd,{B:this.bO.STS,T:Ma,S:Qc});this.kph.track(Ma,this.bO.TN)}}nTk(){var Ma=this.WW()-this.RYe,Na=vd.a.Ria(this.rjc/Ma*100,2);Ma=new Pb;Ma.CP=Na;Ma.II=this.mgc;Na=this.Nfd.getData();Ba.a.count(Na)&&(Ma.LRT=Na);Na=this.nbd.getData();
Ba.a.count(Na)&&(Ma.FP=Na);this.NTe.raiseEvent("OnCpuMeterFrameAvailable",new $c(Ma));this.PXg()}PXg(){this.Nfd.reset();this.nbd.reset();this.rjc=this.KUa=0;this.RYe=this.WW();this.mgc=0;this.bO=null}run(){this.dXe?this.nTk():(this.PXg(),this.dXe=!0);this.gFa?this.gFa(Object(jd.a)(this,this.run,"run"),1E3):window.setTimeout(Object(jd.a)(this,this.run,"run"),1E3)}aAg(Ma,Na){Ma=this.cuh[Ma];if(!Oc.a.Im(Ma))for(let ce=0;ce<Ma.length;ce++){var Qc=Ma[ce];const ve=Qc[0];Qc=Qc[1];ve&&!ve(Na)||Qc(Na)}}y0d(){if(!this.EDb){const Ma=
window.setTimeout;this.gFa=(Na,Qc)=>Ma(Na,Qc);this.EDb=!0}}Z3f(Ma){return Ma.startsWith("key")||Ma.startsWith("input")}Vnj(Ma){return Ma.startsWith("click")||Ma.startsWith("mouse")||Ma.startsWith("pointer")}}Object(v.a)(cd,"CpuMeter",null,[110]);class Ed{constructor(Ma){this.LBb=null;this.kt=new nc.a;this.WW=Ma}initialize(Ma,Na,Qc,ce){this.LBb||(this.LBb=new cd(this.WW,Ma,Na,Qc,void 0===ce?!1:ce),this.kt.setResult(this.LBb));return this.LBb}}Object(v.a)(Ed,"CpuMeterProvider",null,[698]);class Sd{constructor(Ma){this.AF=
[];this.Bec=[];this._count=void 0===Ma?1:Ma}Dwi(){let Ma=0;for(let Na=0;Na<this.AF.length;Na++)this.AF[Na]<this.AF[Ma]&&(Ma=Na);return Ma}zla(Ma,Na){Ma=vd.a.Ria(Ma,2);if(this.AF.length<this._count)Array.add(this.AF,Ma),Array.add(this.Bec,Na);else{var Qc=this.Dwi();Ma>this.AF[Qc]&&(this.AF[Qc]=Ma,this.Bec[Qc]=Na)}}getData(){return this.AF.length?{["Vals"]:this.AF,["Desc"]:this.Bec}:null}reset(){this.AF=[];this.Bec=[]}}Object(v.a)(Sd,"MaxDataAggregator",null,[696]);var $d=a(59);class be{get name(){return"Common.App.CpuMeter"}$n(Ma){Ma.register(Ed,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").yi().Ei(()=>new Ed($d.a.Dj));Ma.register(gc,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").yi().Ei(()=>new gc)}init(){const Ma=U.AFrameworkApplication.fa;if(Ma.ka("CpuMeterIsEnabled")&&!Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableCpuMeter",!1)){const Na=D.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");kb.a.instance.h7e.continueWith(()=>{be.Obj(Ma,Na)})}}dispose(){}static Obj(Ma,
Na){const Qc=Fb.glb(10,5,new zd(Ma.Lj("TaskManagerLoggingThreshold",0),Ma.Lj("CpuMeterMaximumEntriesToLog",0)));Na=Na.initialize(new Sd(5),new zd,Qc,Ma.ka("CPUMeterExposeTaskDetailsIsEnabled"));Ma.ka("WordEditorInteractivePerfDisableCpuMeterFrames")||(Na.run(),Ma.ka("CpuMeterMonitorIsEnabled")&&D.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Na,Ma.wga("CpuMeterAverageCpuPercentThreshold",80),Ma.Lj("CpuMeterRollingAverageFramesCount",15)));Td.a(16827671,306,50,"Initializing CpuMeter")}static main(){yc.a.instance.Do(new be)}}
Object(v.a)(be,"CpuMeterPackage",null,[11,12]);var Fe=a(1166);class Pe{get name(){return"Common.App.EventsCachePackage"}$n(){}init(){Fe.a.instance.init()}dispose(){}static main(){yc.a.instance.Do(new Pe)}}Object(v.a)(Pe,"EventsCachePackage",null,[11,12]);var hc=a(9),Lb=a(428);class kc extends Lb.a{constructor(Ma){super();this.Whf=!1;this.$=Ma;this.gm()}create(){const Ma=this.$.la,Na=D.a.instance;if(!this.Whf){this.Whf=!0;let Qc;Qc=L.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?
this.$.ua.DocumentHostInfo.PostMessageOrigin||aa.a.aM:U.AFrameworkApplication.rSc||aa.a.aM;Na.register(ca,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").yi().Ei(()=>new ca(this.$,window.parent,Qc,U.AFrameworkApplication.fa.ka("HostSendReadyToAcceptPostMessage")))}this.Bk(Ma.kh(21)||Ma.Hh(21,Na.resolve("Postmessage.IHostPostmessenger")))}}Object(v.a)(kc,"HostMessengerFactory",Lb.a,[]);var dd=a(126),yb=a(181),Ta=a(854),Hb=a(648),uc=a(78),Sc=
a(243),bc=a(367),vc=a(366),Xc=a(502),ad=a(7),Id=a(62),ue=a(65);class Vd{constructor(Ma,Na,Qc){this.correlations=this.properties=this.operation=null;this.operation=Ma;this.properties=Na;this.correlations=Qc}static Xti(Ma,Na,Qc){const ce={},ve=Id.b();switch(Ma.command){case -1537138325:ce.Action=Na.LabelText;break;case -1104934572:ce.PrevTab=ve.zp(parseInt(Na.OldContextCommand,10));ce.NextTab=ve.zp(parseInt(Na.NewContextCommand,10));break;case 802602464:ce.Origin=Na[ad.a.cP];break;case -1027730316:case -1059615499:ce.MenuType=
Na.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Na&&(ce.SqmControlId=Na.SqmControlId);break;case 1371713064:case 875133075:ue.a.Qi in Na&&(ce.SampleTableId=Na[ue.a.Qi])}ce.InputMethod=bc.a[Ma.method];ce.Location=vc.a[Ma.jk];ce.Mode=Xc.a[Ma.mode];ce.ParentName=Ma.tabName;ce.IsSystemInitiated="IsSystemInitiated"in Na?Na.IsSystemInitiated:!1;ce.NoReporting="NoReporting"in Na?Na.NoReporting:!1;"ControlIdToLog"in Na&&(ce.ControlId=
Na.ControlIdToLog);"TerminalParentControlIdToLog"in Na&&(ce.TerminalParentControlId=Na.TerminalParentControlIdToLog);for(const Ve of Object.keys(Qc))ce[Ve]=Qc[Ve];return ce}}Object(v.a)(Vd,"InteractivityRecord",null,[]);class Kd extends Vd{constructor(Ma,Na,Qc){super(Ma.operation,Ma.properties,Ma.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Na;this.timeFromNavigationStart=Qc}}Object(v.a)(Kd,"FirstUserInteractivityRecord",Vd,[]);var Yd=a(768);
class Bc{constructor(){this.commandSurface=this.triggerMethod=dd.a.uzb}static gcj(){Bc.skb||(Bc.skb=new Yd.a(Hb.a.zm()),Bc.skb.add("InputMethod"),Bc.skb.add("Location"),Bc.skb.add("Mode"))}}Bc.skb=null;Object(v.a)(Bc,"ExcelUserAction",null,[]);var Mc=a(203),Fd=a(500),Md=a(115),oe=a(156),ye=a(110);class te extends uc.a{constructor(Ma){super();this.WVf=0;this.zAf=!1;this.i1d=Array(te.lrb);this.Stc=0;this.$=Ma;this.w3f=L.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");
dd.a.hSi();this.coa={};te.plc||(te.plc=new Ta.a(Hb.a.zm()),te.jbj(te.plc));Bc.gcj();if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Ma=0;Ma<te.lrb;Ma++)this.i1d[Ma]="NA"}dispose(){this.$=this.coa=null;super.dispose()}MGg(Ma,Na,Qc){const ce=Id.b().zp(Ma.command),ve=JSON.stringify(Ma);ce||J.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${ce}, command: ${Ma.command}, commandInfo: ${ve}`);Na=
Vd.Xti(Ma,Na,Qc);Qc=!!Na&&(!("IsSystemInitiated"in Na)||!Na.IsSystemInitiated);this.$&&this.$.ea.nm&&Qc&&Fe.a.instance.yBg("OtelUserAction",new Fd.a(ce,Ma.tabName,Date.now()));this.$Gg(ce,Na,null,!0,!0)}Aj(Ma,Na,Qc,ce){this.$Gg(Ma,Na,void 0===Qc?null:Qc,!1,void 0===ce?!1:ce)}TXg(Ma){if(this.coa){++this.WVf;this.coa[Ma]||(this.coa[Ma]=[]);var Na=this.WVf.toString();this.coa[Ma].push(Na);J.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${Ma}', correlation=${Na}`)}else J.ULS.shipAssertTag(537155554,
0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Ma}] == null`)}AYg(Ma){if(this.coa&&this.coa[Ma]){var Na=this.coa[Ma],Qc=Na.pop().toString();Na.length||delete this.coa[Ma];J.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${Ma}', correlation=${Qc}`)}else J.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Ma}] == null`)}i0(Ma,Na,Qc){Qc=void 0===
Qc?!1:Qc;return Sc.b(ce=>{this.Aj(Ma,ce(),void 0,Qc)},te.oZk,this.ya,Ca.a.jfj,!1,!Na)}jke(){let Ma="";for(let Na=0;Na<te.lrb;Na++)Ma+=this.i1d[(this.Stc+te.lrb-Na-1)%te.lrb]+",";J.ULS.sendTraceTag(557188890,0,15,`Last operations ${Ma}`)}X8k(Ma){Ma&&(this.i1d[this.Stc]=Ma,this.Stc=(this.Stc+1)%te.lrb)}vAj(Ma,Na,Qc){U.AFrameworkApplication.Iwc();const ce=Ma.operation,ve=Ma.properties;void 0!==Qc?void F.a.resolve(K.ve,{va:0}).then(Ve=>{Ve.tgk(ce,ve,Qc)}):this.F4k(Ma);this.G4k(Ma);this.U2j(Na,ve,ce)}F4k(Ma){this.sSk(Ma)||
(this.zAf=!0,Ma=new Kd(Ma,Oa.a.instance.Gga(new Date),Object(ye.b)()),Ma=Sys.Serialization.JavaScriptSerializer.serialize(Ma),J.ULS.sendTraceTag(458261331,0,50,`${Ma}`))}sSk(Ma){const Na=Ma.properties;Ma=Ma.operation;return this.zAf||void 0===Ma||null===Ma||Ma===za.a.Cnd||Ma===za.a.Xne||Ma===za.a.Ude||ka.a.IYd(Ma)||!!Na&&"IsSystemInitiated"in Na&&Na.IsSystemInitiated}G4k(Ma){L.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.X8k(Ma.operation);Ma=Sys.Serialization.JavaScriptSerializer.serialize(Ma);
J.ULS.sendTraceTag(21542793,0,50,`${Ma}`)}U2j(Ma,Na,Qc){dd.a.Zya()&&(Na?"NoReporting"in Na&&Na.NoReporting||"IsSystemInitiated"in Na&&Na.IsSystemInitiated||!Ma&&!this.w3f||((Ma=dd.a.Rm(Na,te.plc,Bc.skb))?(Na=te.fui(Na))?yb.a.sendUserActionEvent(dd.a.ytc(Qc,null,Na.triggerMethod,Na.commandSurface,Ma)):J.ULS.sendTraceTag(537155550,0,50,"user action was null"):J.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):J.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${Qc}`))}$Gg(Ma,
Na,Qc,ce,ve){const Ve=Mc.a(this.$);if(this.w3f){let Kf=null;ha.a.equals(Ma,za.a.CXc,!0)&&Na&&"InputMethod"in Na&&(Kf=za.a.KBf(Ma,Na.InputMethod));Ve.G5b(Kf||Ma,Qc)}else ha.a.equals(Ma,za.a.CXc,!0)&&Na&&"InputMethod"in Na&&(Ma=za.a.KBf(Ma,Na.InputMethod)),Ve.G5b(Ma,Qc);Na&&(Na.IsCommand=ce);const vf="ActionRelativeTime"in Na?Na.ActionRelativeTime:Object(ye.b)();Object(oe.e)(()=>{const Kf=new Vd(Ma,Na,this.coa);this.vAj(Kf,ve,vf)},this.$.ya,50)}static fui(Ma){if(!Ma)return null;const Na=new Bc;"InputMethod"in
Ma&&(Na.triggerMethod=Ma.InputMethod);"Location"in Ma&&(Na.commandSurface=Ma.Location);return Na}static jbj(Ma){Ma?(Ma.add("Origin",Md.g.String),Ma.add("InputMethod",Md.g.String),Ma.add("ButtonType",Md.g.String),Ma.add("selectedRange",Md.g.String),Ma.add("SelectedRanges",Md.g.String),Ma.add("editRange",Md.g.String),Ma.add("Location",Md.g.String),Ma.add("Mode",Md.g.String),Ma.add("CurrentSelectionMode",Md.g.String),Ma.add("Action",Md.g.String),Ma.add("type",Md.g.String),Ma.add("floatingObjectType",
Md.g.String),Ma.add("PrevTab",Md.g.String),Ma.add("NextTab",Md.g.String),Ma.add("DialogName",Md.g.String),Ma.add("dx",Md.g.Int64),Ma.add("dy",Md.g.Int64),Ma.add("NumberOfSelectedRanges",Md.g.Int64),Ma.add("IsCommand",Md.g.Boolean),Ma.add("IsInFormulaBarEdit",Md.g.Boolean),Ma.add("isLink",Md.g.Boolean),Ma.add("isSheetRef",Md.g.Boolean),Ma.add("isEmptyText",Md.g.Boolean),Ma.add("isFormula",Md.g.Boolean),Ma.add("IsResizingHiddenHeader",Md.g.Boolean)):J.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}
te.oZk=1E3;te.lrb=40;te.plc=null;Object(v.a)(te,"InteractivityLogger",uc.a,[23]);var ze=a(77),He=a(84),ne=a(145),of=a(597),lf=a(87),jf=a(61),Cf=a(308),Gf=a(39),Af=a(41),Lf=a(262);class Ef extends Sys.EventArgs{constructor(Ma){super();this.aP=Ma}}Object(v.a)(Ef,"ErrorDataArgs",Sys.EventArgs,[]);var Hf=a(772);class $b{constructor(Ma,Na){this.Qdc=null;this.luc=this.jSd=!1;this.pXe=this.qXe=null;this.Ymb=this.Xmb=0;this.eMg=Ma;this.vUe=Na}get Dtg(){return this.vUe}get I6b(){return this.qXe}get dMg(){return this.pXe}get Auj(){return this.scf(this.eMg.getTime())}get Z3j(){return this.scf(this.dMg.getTime())}get dTg(){return!(this.luc||
void 0===window.bsqmXLSPageLoadStartTime)}get Fwd(){try{return this.Qdc||(this.Qdc=C.toUtc(window.bsqmXLSPageLoadStartTime)),this.Qdc}catch(Ma){return null}}set Fwd(Ma){this.Qdc=Ma}IGk(Ma){this.luc||(this.qXe=Ma,this.pXe=C.toUtc(this.I6b))}S8i(Ma){if(Ma.Values&&(!this.Xmb||!this.Ymb))try{Y.a.YSf in Ma.Values&&(this.Xmb=parseInt(Ma.Values[Y.a.YSf].toString(),10));Y.a.ZSf in Ma.Values&&(this.Ymb=parseInt(Ma.Values[Y.a.ZSf].toString(),10));const Na=kb.a.instance;0<this.Xmb&&(this.e9f(this.Xmb,"PageLoadFromHostClick"),
Na.vgk(this.Xmb));0<this.Ymb&&(this.e9f(this.Ymb,"PageLoadFromHostFrameCreation"),Na.xgk(this.Ymb));const Qc=Ma.Values[Y.a.V8i]||0,ce=Ma.Values[Y.a.T8i]||Ma.Values[Y.a.U8i]||0;0<ce&&Na.$fk(ce);Na.agk(Qc)}catch(Na){}}Hsk(){this.eMg=this.Fwd=B.a.ih.ri;this.vUe=0;this.jSd=this.luc=!1}scf(Ma){const Na=this.Fwd.getTime();return Na>=Ma?0:Ma-Na+this.Dtg}e9f(Ma,Na){if(Ma){const Qc=Id.b();Qc.g0c("UserAction",Na,Na,B.a.O4d(Ma),Hf.EcmaDateClock.instance.appStart);Qc.Fwc(Na,C.toTimestamp(this.I6b))}}}Object(v.a)($b,
"PageLoadPerfInfo",null,[]);var Wb=a(69);class Dc{constructor(Ma,Na,Qc){this.Qkd=Ma.keyCode;this.x7b(Ma.ctrlKey,1);this.x7b(Ma.shiftKey,2);this.x7b(Ma.altKey,4);this.x7b(Wb.b(Ma),8);this.x7b(Qc,16);this.Qkd=this.eyb|Na<<24}get eyb(){return this.Qkd}get keyCode(){return this.eyb&65535}x7b(Ma,Na){Ma&&(this.Qkd=this.eyb|Na<<16)}}Object(v.a)(Dc,"ShortcutSqmData",null,[]);class Jf{constructor(){this.L3d=null;this.FZh={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.oIg()}oUh(Ma,Na,Qc){0===
Qc&&(Qc=this.FZh[Na.toString()]);return Jf.shouldLog(Ma,Qc)&&(Ma=new Dc(Ma,Qc,Ja.a.isMac),!Af.a.Wm(this.L3d,Ma.eyb.toString()))?(this.L3d[Ma.eyb.toString()]=!0,Ma):null}oIg(){this.L3d={}}static Klj(Ma){return 112<=Ma&&123>=Ma||61440<=Ma&&61451>=Ma}static Anj(Ma){return 17!==Ma&&18!==Ma&&16!==Ma&&91!==Ma&&93!==Ma}static shouldLog(Ma,Na){let Qc=Ma.ctrlKey||Ma.altKey||Wb.b(Ma);Ma=Ma.keyCode;Qc=Jf.Klj(Ma)||Qc;Qc=Jf.Anj(Ma)&&Qc;return 0!==Na&&Qc}}Object(v.a)(Jf,"UnhandledShortcutLogger",null,[]);class Rb{constructor(Ma){this.Prc=
[];this.MHh=null;this.sqmManager=Ma}Vlc(Ma){this.Prc.push(Ma)}T6(Ma,Na,Qc){try{if(Na)Na.endTime=Qc,this.sqmManager.$1e(Na);else for(let ce=0,ve=this.Prc.length;ce<ve;ce++){const Ve=this.Prc[ce];Ma?(Ve.endTime=Ve.startTime,Ve.ghf=0):Ve.endTime=Qc;this.sqmManager.$1e(Ve)}}catch(ce){}finally{this.Prc.length=0}}}Object(v.a)(Rb,"UserInteractionPerfInfo",null,[]);var Gb=a(37),Cc=a(74),cb=a(259);class pc extends uc.a{constructor(Ma,Na){super();this.aRd=this.J5b=!1;this.gTg=!0;this.eh=new y.a;this.l$c=!1;
this.ej=()=>{const Qc=Cc.a(this.$).xj.activityState,ce=Af.a.Wm(Qc,Gb.a.E1e);Af.a.Wm(Qc,Gb.a.qHb)||ce||this.upload()};this.$=Ma;this.BRb=Na;this.ea=Ma.ea;this.$.gq(this.ej);this.Z3g=new Jf;this.n5a=new $b(ka.a.bne,Ma.ua.PageGenerationMetrics.TimeToCompleteFirstFlush);this.G4c=new Rb(this)}dpd(Ma){this.eh.addHandler("EREK",Ma)}Pie(Ma){this.eh.removeHandler("EREK",Ma)}get Hai(){return this.l$c}get ffj(){return this.$.frame.p1?ab.a.hfj:ab.a.gfj}get workbookContext(){return this.$.workbookContext}get u4(){pc.ZAb||
(pc.ZAb=this.Ptf());pc.Itd||(pc.Itd=!0,this.$Uf());return pc.ZAb}set u4(Ma){pc.ZAb=Ma;pc.ZAb||(pc.Itd=!1)}get bfa(){return lf.a(this.$.ua,3)}dispose(){this.Hai&&U.AFrameworkApplication.cu&&U.AFrameworkApplication.cu.disable();this.$&&this.$.Yu(this.ej);this.$=this.G4c=this.n5a=this.u4=null;super.dispose()}HPf(Ma){this.n5a.S8i(Ma);this.lAj()}Joe(Ma){this.setDw(9415,Ma)}Vlc(Ma){this.G4c.Vlc(Ma)}T6(Ma,Na,Qc){this.G4c.T6(Ma,Na,Qc)}d3d(Ma){if(this.bfa){Ma=this.$.isEditMode||Ma&&!!(this.ea.workbookContext.Options&
512);if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:8784630_SupportCollabViewInApplicationModeExtended")){const Na=this.ea.u1a;Ma=Ma?2:Na?20:this.ea.Ih.inEmbedView?14:1}else Ma=Ma?2:this.ea.Ih.inEmbedView?14:1;this.setDw(8721,Ma);this.Gxi(Ma);this.l$c=!1}}u9f(){const Ma=this.n5a;this.bfa&&Ma.dTg&&(this.setDw(9450,Ma.Dtg),this.setDw(9085,Ma.Auj))}v9f(Ma){if(!this.J5b){this.J5b=!0;const Na=this.n5a;let Qc=0;this.bfa&&Na.dTg?(Na.IGk(Ma),this.G4c.MHh=Na.dMg,this.setDw(9086,Na.Z3j),Na.luc=!0,Qc=this.n5a.I6b.getTime()):
Qc=Ma.getTime();Gf.TaskExtensions.Xa(this.BRb.value,ce=>{ce.result.sendMessage(X.a.GHh,{[Y.a.HHh]:Qc})},this.ya,3)}}$1e(Ma){this.bfa&&Ma&&1!==Ma.gra&&this.cua(8327,Lf.b(Ma),Lf.l(Ma),Lf.a(Ma),2,Ma.ghf,Lf.m(Ma),Lf.d(Ma),Lf.e(Ma))}fke(Ma,Na){Ma&&Ma.MessageIdHash&&this.eke(Ma.MessageIdHash,Ma.MessageIdName,Ma.MessageId,Ma.ErrorCause?Ma.ErrorCause:He.a.P2c,!1,Na,Ma,null)}eke(Ma,Na,Qc,ce,ve,Ve,vf,Kf){pc.Yqd||(pc.Yqd=!0,ne.a.get_instance().isCompleted(13)||(ne.a.get_instance().fy(13),J.ULS.sendTraceTag(537151323,
0,50,"App encountered its first error so updating app init status")));Ma=this.Kjb(Ma);const ng=!!vf,Bf={};Bf.ErrorName=Na;Bf.ErrorHashCode=Ma.toString();Bf.ErrorId=Qc.toString();Bf.ErrorCause=ce.toString();Bf.ErrorType=0===Ve?"ErrorDialog":"BusinessBar";Bf.BusinessBarEntryName=Kf||"null";Bf.ServerCorrelationId=ng?vf.CorrelationId:"null";Bf.WebMethodName=ng?vf.WebMethodName:"null";Bf.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Bf.WfeServerId=ng?vf.WfeServerId:
"null";Na=jf.a.Ci(Bf);this.eh.raiseEvent("EREK",new Ef(Bf));J.ULS.sendTraceTag(1881314,0,15,Na);this.bfa&&(lb.a.ABg(Ma.toString()),this.cua(9134,Ma,ce,He.a.Zye),this.ea.wA||ve||(this.setDw(10459,Ma),this.d3d(!0),this.aRd=!0,this.upload(),this.$Uf()))}Kjb(Ma){return 5439488|(Ma>>>16^Ma&65535)&65535}D3d(Ma,Na,Qc){Ma=this.Z3g.oUh(Ma,Na,Qc);this.bfa&&Ma&&this.cua(11007,Ma.eyb)}upload(){!this.bfa||!this.J5b&&!this.aRd||Ja.a.Am&&U.AFrameworkApplication.Xl?Ja.a.Am&&U.AFrameworkApplication.Xl&&J.ULS.sendTraceTag(537151320,
0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.u4.jbc(),this.l$c=!0);U.AFrameworkApplication.cu=this.u4=null;this.n5a.Hsk();this.J5b=!1;U.AFrameworkApplication.cu=this.u4=this.Ptf();this.Z3g.oIg()}lAj(){const Ma=this.n5a;if(this.bfa&&!Ma.jSd){var Na=Ma.Xmb,Qc=Ma.Ymb,ce=Ma.I6b.getTime();U.AFrameworkApplication.TX=Ma.I6b;Na&&this.setDw(10324,Na>ce?0:ce-Na);Qc&&this.setDw(10325,Qc>ce?0:ce-Qc);Ma.jSd=!0}}cua(Ma,...Na){this.bfa&&this.u4.cua(Ma,...Na)}setDw(Ma,Na){this.bfa&&this.u4.setDw(Ma,Na)}Ptf(){Cf.a.muf(this.$.ua);
return U.AFrameworkApplication.cu}Gxi(Ma){let Na;try{Na=Object(gb.a)(Object,jf.a.Sp(U.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch(Qc){J.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${Qc.message}`);return}if(Na){let Qc=Object(gb.a)(String,Na.ApplicationModeExtended),ce=Object(gb.a)(String,Na.ApplicationMode);Qc&&ce&&(Qc=Qc.toUpperCase(),2!==Ma&&16!==Ma||"VIEW"!==Qc&&"UNIFIED"!==Qc?1!==Ma||"EDIT"!==Qc&&"UNIFIED"!==Qc||(Qc="VIEW",ce="View"):(Qc=
"EDIT",ce="Edit"),Na.ApplicationModeExtended=Qc,Na.ApplicationMode=ce,U.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=jf.a.Ci(Na))}}$Uf(){const Ma=this.$.ua;this.u4.HY=!0;this.u4.s$a(Ma.BWsaStartTime);this.setDw(59,83);this.J5b=!1;if(this.bfa){const Na=Ma.DocumentHostInfo;this.m$h();this.setDw(8491,this.$.EN);this.setDw(9236,Ma.RequestedUILcid);this.setDw(8473,Ma.WacHostId);this.setDw(9902,Lf.c(Na.ClusterId));L.EwaSettings.Ra(398)?this.u4.gPg(""):this.u4.gPg(Ma.FlightHolder?Ma.FlightHolder.FlightId:
"");this.Joe(this.ea.Ih.inEmbedView?1:0);this.aRd=!1;this.setDw(9104,Lf.c(Na.FileSourceId));this.setDw(10309,this.ffj);this.LIk();U.AFrameworkApplication.yh.Che(of.a.getInstance(!1))}}LIk(){kb.a.instance.pbj(this.u4);if(this.gTg){const Ma=kb.a.instance;Ma.Ufk();Ma.qgk();Ma.ngk();Ma.mgk();Ma.ggk();this.gTg=!1}}m$h(){this.createStream(8327,1,cb.a.uci,cb.a.Cib);this.createStream(9134,1,3,cb.a.Cib);this.createStream(11007,1,1,cb.a.Cib)}createStream(Ma,Na,Qc,ce){this.u4.createStream(Ma,Na,Qc,ce)}}pc.ZAb=
null;pc.Itd=!1;pc.Yqd=!1;Object(v.a)(pc,"SqmManager",uc.a,[216,684]);var Ic=a(91),rd=a(943);class Rd{constructor(Ma,Na){this.entryTypes=null;this.buffered=!1;this.entryTypes=Ma;this.buffered=void 0===Na?!1:Na}}Object(v.a)(Rd,"PerformanceObserverInit",null,[]);class va extends Sys.EventArgs{constructor(Ma){super();this.puf=Ma}}Object(v.a)(va,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class Bb extends Sys.EventArgs{constructor(Ma){super();this.xFc=Ma}}Object(v.a)(Bb,"LongTaskPerformanceObserverInitializedEventArgs",
Sys.EventArgs,[]);class Ac{constructor(Ma){this.eh=new y.a;this.Qcd=!1;this.Jm=()=>{if(Ja.a.Xv){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.CCj)).observe(new Rd([ab.a.P3d])),this.Qcd=!0)}catch(Na){this.Qcd=!1,J.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Na}`)}this.eh.raiseEvent("ltpoiek",new Bb(this.xFc))}};this.CCj=Na=>{this.eh.raiseEvent("ltoek",new va(Na))};this.$=Ma;this.$.ea.nm?this.Jm():L.EwaSettings.wl()?
this.$.ea.Yq(this.Jm):this.$.ea.lr(this.Jm)}get xFc(){return this.Qcd}v4e(Ma){this.eh.addHandler("ltoek",Ma)}pnk(Ma){this.eh.removeHandler("ltoek",Ma)}jDh(Ma){this.eh.addHandler("ltpoiek",Ma)}qnk(Ma){this.eh.removeHandler("ltpoiek",Ma)}dispose(){L.EwaSettings.wl()||this.$.ea.Bv(this.Jm);k.a.dh(this.eh);this.$=this.eh=null}}Object(v.a)(Ac,"LongTaskPerformanceObserver",null,[4]);var Nc=a(184);class hd{constructor(Ma,Na){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===
Ma?0:Ma;this.longTaskDuration=void 0===Na?0:Na}get Q3d(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}ytj(Ma){return 100*this.Q3d>Ma}zAh(Ma){this.u3e(Ma.longTaskDuration);this.Mod(Ma.activeSessionDuration)}u3e(Ma){this.longTaskDuration+=Ma}Mod(Ma){this.activeSessionDuration+=Ma}}Object(v.a)(hd,"LongTaskPerformanceData",null,[]);class qd{constructor(Ma,Na,Qc,ce,ve){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;
this.maxUsersCount=0;this.isVetoSession=Ma;this.entireSessionData=Na;this.worstWindowData=Qc;this.postBootWindowData=ce;this.maxUsersCount=ve}get reportName(){return"LongTaskPerformance"}static get Cki(){return new qd(!1,new hd,new hd,new hd,0)}}Object(v.a)(qd,"LongTaskPerformanceDataStatistics",null,[198]);class je extends Sys.EventArgs{constructor(Ma){super();this.R3d=Ma}}Object(v.a)(je,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Ie=a(436),Oe=a(310),Vb=a(357);class fd{constructor(Ma,Na){this.eh=
new y.a;this.a3a=this.Jha=this.X2=this.tk=null;this.q5f=this.zse=this.ZJc=!1;this.C3a=null;this.maxUsersCount=0;this.KPc=(Qc,ce)=>{Qc=ce.puf.getEntriesByType(ab.a.P3d);for(const ve of Qc)this.tk.UM(ve.duration)||U.AFrameworkApplication.H2a||(this.X2.u3e(ve.duration),this.eh.raiseEvent("lttek",new je(ve)),Qc={},Qc.LongTaskDuration=ve.duration,Qc.LongTaskStartTime=ve.startTime,J.ULS.sendTraceTag(187982418,0,50,JSON.stringify(Qc)))};this.Jm=()=>{this.zse=!0;this.S9b()};this.VE=(Qc,ce)=>{ce&&(this.maxUsersCount=
Math.max(this.maxUsersCount,ce.k8g));this.Jha.maxUsersCount=this.maxUsersCount};this.Cj=()=>{this.S9b()};this.ej=()=>{this.X9b()};this.Zmg=(Qc,ce)=>{ce.xFc&&this.S9b()};this.c$f=()=>{this.X2.Mod(C.getElapsedMilliseconds(this.a3a,B.a.ih.ri));this.Eue(!0);var Qc=!1;this.Jha.postBootWindowData.activeSessionDuration?(!this.q5f&&L.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Id.b().cHg(2),ub.Health.instance.recordKpiUsage(Oe.a.longJsTask,Vb.b.FailureBased,Ie.a.Buj,null),
this.q5f=!0),!this.Jha.isVetoSession&&this.X2.ytj(this.n9g)&&(this.Jha.isVetoSession=!0,L.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Id.b().dHg(2,this.ACj),ub.Health.instance.recordKpiFailure(Oe.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.Jha.worstWindowData.Q3d<=this.X2.Q3d&&(this.Jha.worstWindowData=this.X2),this.Jha.entireSessionData.zAh(this.X2)):(this.Jha.postBootWindowData=new hd(this.X2.activeSessionDuration,this.X2.longTaskDuration),Qc=
!0);const ce={};ce.LastWindowScore=this.X2;ce.postBootWindow=Qc;ce.CoauthersNumber=this.$.ea.Wt.length;Qc=JSON.stringify(ce);J.ULS.sendTraceTag(20779346,0,50,Qc);this.X2=new hd};this.COc=()=>{this.tk.un||U.AFrameworkApplication.H2a||this.Eue(!1)};this.BOc=()=>{this.X2.Mod(C.getElapsedMilliseconds(this.a3a,B.a.ih.ri));this.a3a=null;this.C3a.cancel()};this.$=Ma;this.n9g=Ma.ua.LongTaskPerformanceVetoThreshold;this.ACj="PercentageOver_"+this.n9g.toString();this.S3d=Ma.ua.LongTaskPerformanceWindowDurationInMs;
this.PY=Na;L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void F.a.resolve(K.Cb).then(Qc=>{this.tk=Qc;this.S9b()}):this.$.la.fi(291,Qc=>{this.tk=Qc;this.S9b()});this.$.ea.nm?this.Jm():L.EwaSettings.wl()?this.$.ea.Yq(this.Jm):this.$.ea.lr(this.Jm);this.PY.jDh(this.Zmg);this.$.mr(this.Cj);this.$.gq(this.ej)}kDh(Ma){this.eh.addHandler("lttek",Ma)}rnk(Ma){this.eh.removeHandler("lttek",Ma)}dispose(){this.zse=!1;this.X9b();this.$.Wr(this.Cj);this.$.Yu(this.ej);
this.PY.qnk(this.Zmg);k.a.dh(this.C3a);this.PY=this.$=this.C3a=null;void 0!==this.tk&&null!==this.tk&&k.a.dh(this.tk)}S9b(){void 0===this.tk||null===this.tk?J.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.PY.xFc?this.ZJc?J.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.zse?(this.ZJc=
!0,this.Jha=qd.Cki,this.X2=new hd,this.$.ea.Gea(this.VE),this.maxUsersCount=this.$.ea.Wt.length,this.PY.v4e(this.KPc),this.tk.f$(this.BOc),this.tk.c4(this.COc),U.AFrameworkApplication.Tod(this.BOc),U.AFrameworkApplication.Uod(this.COc),this.C3a=la.a.instance.create(this.c$f,this.S3d,Ca.a.j9f,!1),Mc.a(this.$).a4(this.Jha),this.tk.un||U.AFrameworkApplication.H2a||this.Eue(!0),J.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):J.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):J.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}X9b(){this.ZJc&&(this.ZJc=!1,L.EwaSettings.wl()||this.$.ea.Bv(this.Jm),this.PY.pnk(this.KPc),this.$.ea.R7(this.VE),void 0!==this.tk&&null!==this.tk&&(this.tk.S6a(this.BOc),this.tk.ZOa(this.COc)),
U.AFrameworkApplication.MEg(this.BOc),U.AFrameworkApplication.NEg(this.COc),this.C3a.cancel(),this.a3a=this.X2=this.Jha=null,this.maxUsersCount=0)}Eue(Ma){Ma||void 0===this.a3a||null===this.a3a?(this.a3a=B.a.ih.ri,this.C3a=Nc.AsyncMethodContext.IMb(this.c$f,Ma?this.S3d:this.S3d-this.X2.activeSessionDuration,Ca.a.j9f,this.C3a)):J.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}
Object(v.a)(fd,"LongTaskPerformanceTracker",null,[4]);var Qd=a(25);class me extends y.a{constructor(Ma,Na){super();this.statusBarManager=this.tk=null;this.$mg=(Qc,ce)=>{ce.R3d&&ce.R3d.duration>=this.DCj&&(this.v$f++,this.T5f=ce.R3d.duration)};this.$=Ma;this.$.la.fi(29,Qc=>{this.statusBarManager=Qc;Qc.hO(this)});L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void F.a.resolve(K.Cb).then(Qc=>{this.tk=Qc}):this.$.la.fi(291,Qc=>{this.tk=Qc});this.T5f=
this.v$f=0;this.DCj=Ma.ua.LongTaskThresholdMs;this.Tqb=Na;this.Tqb.kDh(this.$mg)}oy(Ma){this.addHandler("LTSCEK",Ma)}cy(Ma){this.removeHandler("LTSCEK",Ma)}$v(){this.rr("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}Ay(Ma,Na){if("QueryLongTasksCount"!==Ma)return!1;this.t4i(Na);return!0}rr(){return L.EwaSettings.Ra(505)}dispose(){this.statusBarManager&&(this.statusBarManager.tN(this),this.statusBarManager=null);this.Tqb.rnk(this.$mg);super.dispose()}t4i(Ma){const Na=`Long Tasks: ${this.v$f} | Last Task Duration: ${Math.round(this.T5f)}ms`;
Qd.a.Mo(this.$)?(Ma.LabelText=Na,Ma.Visible=!0):Ma.Value=Na}}Object(v.a)(me,"LongTasksStatusBarManager",y.a,[4,155,156]);var se=a(13);class Ne{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(v.a)(Ne,"NetworkInfoData",null,[]);class Ue extends y.a{constructor(Ma){super();this.statusBarManager=null;this.wod=!1;this.Afg=()=>{this.raiseEvent("NetworkInformation")};this.$=Ma;L.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&
(this.BS=this.Bye("connection")||this.Bye("mozConnection")||this.Bye("webkitConnection"))&&L.EwaSettings.Ra(410)&&Ma.la.fi(29,Na=>{this.statusBarManager=Na;Na.hO(this);this.BS.addEventListener("change",this.Afg);this.wod=!0})}oy(Ma){this.addHandler("NetworkInformation",Ma)}cy(Ma){this.removeHandler("NetworkInformation",Ma)}jKa(){return this.BS?Object(oa.a)(new Ne,{bandwidthMps:this.BS.downlink,rttMs:this.BS.rtt,connectionType:this.BS.type,effectiveConnection:this.BS.effectiveType,downlinkMaxMps:this.BS.downlinkMax}):
null}Ay(Ma,Na){if("QueryNetworkInformation"!==Ma)return!1;this.u4i(Na);return!0}rr(){return this.wod}dispose(){this.wod&&(this.statusBarManager&&(this.statusBarManager.tN(this),this.statusBarManager=null),this.BS&&this.BS.removeEventListener("change",this.Afg));this.$=null;super.dispose()}Bye(Ma){return se.HelperMethods.Yv(window.navigator,Ma)?window.navigator[Ma]:null}u4i(Ma){const Na="Network: "+this.BS.downlink.toString()+" Mbps, "+this.BS.rtt.toString()+" ms";Qd.a.Mo(this.$)?(Ma.LabelText=Na,
Ma.Visible=!0):Ma.Value=Na}}Object(v.a)(Ue,"NetworkInformationManager",y.a,[155,156]);class nf{constructor(Ma,Na,Qc,ce,ve,Ve,vf,Kf,ng,Bf){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===Ma?"":Ma;this.startTime=void 0===Na?-1:Na;this.startToNextFrame=void 0===Qc?-1:Qc;this.startToResponseRenderEnd=
void 0===ce?-1:ce;this.wasHidden=void 0===ve?!1:ve;this.isUserOperation=void 0===Ve?!0:Ve;this.isGroupBreaking=void 0===vf?!0:vf;this.operationThatLedToLogging=void 0===ng?"":ng;this.startToOperationThatLedToLogging=void 0===Bf?-1:Bf;this.isPartOfGroup=void 0===Kf?!1:Kf}}Object(v.a)(nf,"OperationStatisticsData",null,[]);class tb{constructor(){this.operationsGroups=null;this.Aaj()}isGroup(Ma,Na,Qc){const ce=new ac.a;ce.addRange(Ma);ce.addRange(Na);for(let ve=0;ve<this.operationsGroups.count;ve++)if(this.lpj(this.operationsGroups.na(ve),
ce,Qc))return J.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${Qc}' is part of a group ( operationsList: ${this.ltg(Ma)} , frameOperationsList: ${this.ltg(Na)})`),!0;J.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${Qc}' is NOT part of a group.`);return!1}lpj(Ma,Na,Qc){let ce=0;for(let ve=0;ve<Na.count;ve++)if(Na.na(ve).isGroupBreaking){if(Ma.count<=ce||!ha.a.equals(Na.na(ve).name,Ma.na(ce),!0))return!1;ce++}return Ma.count>ce&&ha.a.equals(Qc,Ma.na(ce),
!0)}ltg(Ma){return`[${Ma.toArray().map(Na=>Na.name).join(", ")}]`}Aaj(){this.operationsGroups=new ac.a;this.web(new ac.a(["Paste","SelectingRange_unknown"]));this.web(new ac.a(["AutoSum","SelectingRange_unknown"]));this.web(new ac.a(["ChangeSheetDirection","ActiveItemChanged"]));this.web(new ac.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.web(new ac.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.web(new ac.a(["EditBoxEndEdit","SetCell",
"SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}web(Ma){this.operationsGroups.add(Ma)}}Object(v.a)(tb,"OperationsGroupDetector",null,[]);var lc=a(26);class Tc{constructor(Ma,Na,Qc,ce){this.framePerformanceTracker=this.z5b=this.Yba=this.Xca=null;this.Eqk=()=>{this.Tqd=-1;const ve=se.HelperMethods.Kh();this.G$k(ve);this.Q6b&&(J.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.$ac(this.OO,
ve),this.Q6b=!1);this.eIc&&(this.$ac(this.SP,ve),this.Q6b||this.$ac(this.OO,ve));window.setTimeout(this.iAj,0)};this.iAj=()=>{var ve=[];const Ve=this.$.ua.OperationToPrevOperationThreshold;for(var vf=0;vf<this.OO.count;vf++){var Kf=this.OO.na(vf);vf<Ve&&ve.push(Kf);this.SP.add(Kf)}M.f(this.$)&&M.f(this.$).za?((vf=this.sessionStatisticsManager.cLd(0))?(Kf=JSON.stringify(this.MZb),ve=JSON.stringify(ve),J.ULS.sendTraceTag(237798547,1,50,`DOM count: (${vf.HGj}, ${vf.JLh}, ${vf.oFj}), long tasks: ${Kf}, operations count: ${this.OO.count}, operations: ${ve}`)):
J.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.OO.count>Ve&&J.ULS.sendTraceTag(537153875,1,50,`More than ${Ve} operations are in the operationsList. count: ${this.OO.count}`),this.OO.clear(),this.MZb.clear()):J.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.KPc=(ve,Ve)=>{this.BCj(Ve.puf)};this.$=Ma;this.kT=Na;this.Yp=this.Yp||B.a.ih;this.SP=new ac.a;this.OO=new ac.a;this.Tqd=this.bqb=-1;this.MZb=new ac.a;this.H2j=new tb;this.Q6b=
this.eIc=!1;this.dbj();this.Caj();this.Baj();this.sessionStatisticsManager=Qc;this.PY=ce;this.PY.v4e(this.KPc);L.EwaSettings.isChangeGateEnabled("OfficeVSO:8759538_removeXLFPSTag")||this.$.la.fi(263,ve=>{this.framePerformanceTracker=ve})}G5b(Ma,Na){var Qc=se.HelperMethods.Kh();const ce=this.H2j.isGroup(this.SP,this.OO,Ma);(this.eIc=this.Boj(Ma))&&0<this.SP.count&&!ce&&(this.B9k(),this.A9k(Ma,Qc),this.oyi());this.bqb=-1;if(M.f(this.$)&&M.f(this.$).za){var ve=!this.Xca.contains(Ma);Qc=new nf(Ma,Qc,
void 0,void 0,void 0,ve,this.eIc,ce);this.OO.add(Qc);this.framePerformanceTracker&&this.framePerformanceTracker.XUk(Qc.name,Na);!this.Q6b&&this.z5b.contains(Ma)&&(this.Q6b=!0);-1===this.Tqd&&(this.Tqd=window.requestAnimationFrame(this.Eqk))}else J.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}JVc(){this.bqb=se.HelperMethods.Kh()}SVc(){this.SP.count||this.OO.count?(this.$ac(this.OO,this.bqb),this.$ac(this.SP,this.bqb)):J.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistent when no operations in the list. Last block render time: ${this.bqb}`);
this.bqb=-1}Boj(Ma){return!this.Yba.contains(Ma)&&!Ma.includes("Menu")&&!Ma.includes("TellMe")}oyi(){for(let Ma=0;Ma<this.SP.count;Ma++){const Na=this.SP.na(Ma);this.kT.dwh(Na);this.QAj(Na)}this.SP.clear()}G$k(Ma){for(let Na=0;Na<this.OO.count;Na++)this.OO.na(Na).startToNextFrame=this.wNd(this.OO.na(Na).startTime,Ma),this.OO.na(Na).wasHidden=rd.a.UM(this.OO.na(Na).startToNextFrame)}A9k(Ma,Na){for(let Qc=0;Qc<this.SP.count;Qc++)-1===this.SP.na(Qc).startToResponseRenderEnd&&(this.SP.na(Qc).operationThatLedToLogging=
Ma,this.SP.na(Qc).startToOperationThatLedToLogging=this.wNd(this.SP.na(Qc).startTime,Na))}B9k(){var Ma=!1;for(const Na of this.SP)if(Na.isPartOfGroup){Ma=!0;break}if(Ma)for(Ma=0;Ma<this.SP.count;Ma++)this.SP.na(Ma).isPartOfGroup=this.SP.na(Ma).isGroupBreaking}$ac(Ma,Na){for(let Qc=0;Qc<Ma.count;Qc++)Ma.na(Qc).startToResponseRenderEnd=this.wNd(Ma.na(Qc).startTime,Na),Ma.na(Qc).wasHidden=rd.a.UM(Ma.na(Qc).startToResponseRenderEnd)}QAj(Ma){Ma=JSON.stringify(Ma);J.ULS.sendTraceTag(2020372336,1,50,`${Ma}`)}wNd(Ma,
Na){return-1===Ma?-1:-1===Na?-2:Na-Ma}BCj(Ma){Ma=Ma.getEntriesByType(ab.a.P3d);for(let Na=0;Na<Ma.length;Na++)if(30>this.MZb.count)if(this.OO.count)this.MZb.add(this.T5j(Ma[Na]));else{const Qc=Ma[Na];if(null===Qc||void 0===Qc?0:Qc.attribution)void 0!==Qc.attribution.containerSrc&&null!==Qc.attribution.containerSrc&&(Qc.attribution.containerSrc=""),void 0!==Qc.attribution.containerId&&null!==Qc.attribution.containerId&&(Qc.attribution.containerId=""),void 0!==Qc.attribution.containerName&&null!==Qc.attribution.containerName&&
(Qc.attribution.containerName="");J.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{J.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${Ma.length} First long task: ${this.MZb.na(0)}`);break}}T5j(Ma){return`name:${Ma.name}, startTime:${Ma.startTime}, duration:${Ma.duration}`}dbj(){this.Xca||(this.Xca=new Yd.a(Hb.a.zm()),this.Xca.add("ActiveItemChanged"),this.Xca.add(Id.b().zp(-1398645260)),
this.Xca.add(Id.b().zp(722290388)),this.Xca.add(Id.b().zp(974713501)),this.Xca.add(lc.a.P0(lc.a.Crc)),this.Xca.add(lc.a.P0(lc.a.Brc)),this.Xca.add(lc.a.P0(lc.a.wLb)),this.Xca.add(lc.a.P0(lc.a.Lyg)),this.Xca.add(lc.a.P0(lc.a.vqa)))}Caj(){this.Yba||(this.Yba=new Yd.a(Hb.a.zm()),this.Yba.add("PromptEditInBrowser"),this.Yba.add(Id.b().zp(-1398645260)),this.Yba.add(Id.b().zp(722290388)),this.Yba.add(Id.b().zp(974713501)),this.Yba.add(lc.a.P0(lc.a.Crc)),this.Yba.add(lc.a.P0(lc.a.Brc)),this.Yba.add(lc.a.P0(lc.a.wLb)),
this.Yba.add(lc.a.P0(lc.a.Lyg)),this.Yba.add(lc.a.P0(lc.a.vqa)))}Baj(){this.z5b||(this.z5b=new Yd.a(Hb.a.zm()),this.z5b.add("SelectingRange_keyboard"),this.z5b.add("SelectingRange_mouse"))}}Object(v.a)(Tc,"OperationStatistics",null,[]);var md=a(688);class sd{constructor(Ma,Na){this.messageIdName=null;this.errorCause=0;this.messageIdName=Ma;this.errorCause=Na}}Object(v.a)(sd,"RequestError",null,[]);class Zd{constructor(Ma,Na,Qc,ce,ve,Ve,vf,Kf,ng,Bf,Uf,Qf,ug,ag,Dg,Tg,ig){this.requestName=null;this.isPromotedUTRRequest=
this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=
null;this.responseToCallbackTime=0;this.requestName=Ma;this.isUserTriggeredRequest=Zd.DOi(Ma);this.isFullyLoggedKPIRequest=Zd.tOi(Ma);this.isPromotedUTRRequest=Zd.vOi(Ma);this.requestDuration=Na;this.totalOperationDuration=Qc;this.requestTimeInQueue=ce;this.requestInvokedTime=ve;this.ecsOperationDuration=Ve.EcsOperationDuration;this.EcsRequestDuration=Ve.EcsRequestDuration;this.WfeRequestDuration=Ve.WfeRequestDuration;this.TimeFromLastEcsFreeze=Ve.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=Ve.DuringLoadOnDemand;
this.correlationID=vf;this.errors=Zd.d1h(Kf);this.httpStatus=ng;this.requestResourceTiming=Bf;this.communicationErrorRetryCount=Uf;this.successfulCall=Qf;this.isDocumentHidden=ug;this.coauthorsCount=ag;this.responseSize=Dg;this.networkInfoData=Tg;this.responseToCallbackTime=ig}static d1h(Ma){if(!Ma)return[];const Na=[];for(const Qc of Ma)Na.push(new sd(Qc.MessageIdName,Qc.ErrorCause));return Na}static DOi(Ma){return!Zd.CKj.contains(Ma)}static lRi(){const Ma=new Yd.a(Hb.a.zm());Ma.add("CheckPersistedContentUpdate");
Ma.add("GetContentBundle");Ma.add("GetSessionStatus");Ma.add("GetStatusBarAggregates");Ma.add("PollSessionStatus");Ma.add("UpdatePresenceUsers");Ma.add("UploadLatencyTelemetry");return Ma}static tOi(Ma){return Zd.GAi.contains(Ma)}static vOi(Ma){return Zd.Mak.contains(Ma)}static MMi(){const Ma=new Yd.a(Hb.a.zm());Ma.add("SetRichTextCell");Ma.add("Copy");Ma.add("FormatCells");Ma.add("PasteRange");Ma.add("FindCell");Ma.add("ApplyToRangesV2");Ma.add("ResizeRowsColumns");Ma.add("InsertDeleteCells");Ma.add("FillRange");
Ma.add("PasteHtmlContent");Ma.add("ApplyFilter");Ma.add("PasteString");Ma.add("Undo");Ma.add("LineageUpdateView");Ma.add("FindAll");Ma.add("ApplyHyperlink");Ma.add("AutoFit");Ma.add("GetPrintSettings");Ma.add("GetEdgeCell");Ma.add("Paste");Ma.add("MoveAndResizeFloatingObject");Ma.add("FindRange");Ma.add("SetCustomFilter");Ma.add("RenameSheet");Ma.add("ApplyThreadedComment");Ma.add("SortFilterColumn");Ma.add("InsertCopiedCutCellsV2");Ma.add("InsertSheet");Ma.add("ToggleAutoFilter");Ma.add("ReorderSheets");
Ma.add("SetOutlineLevel");Ma.add("RefreshAll");Ma.add("LineageOpenPaneOrChangeFilter");Ma.add("ApplySlicerSelection");Ma.add("GetCardViewCardByCell");Ma.add("AutoSum");Ma.add("LineageClosePane");Ma.add("Sort");Ma.add("ClearAutoFilter");Ma.add("DeleteSheet");Ma.add("Redo");L.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Ma.add("RemovePageBreak"),Ma.add("InsertPageBreak"),Ma.add("SetPrintArea"),Ma.add("ClearPrintArea"));return Ma}static wOi(){const Ma=new Yd.a(Hb.a.zm());
Ma.add("DeleteConditionalFormattingRules");Ma.add("GetConditionalFormattingRules");Ma.add("AddConditionalFormattingRule");Ma.add("QuickEditConditionalFormattingRule");Ma.add("GetPrintSettings");Ma.add("UpdatePresenceUsers");Ma.add("GetThemeInfo");Ma.add("InsertCopiedCutCellsV2");Ma.add("PasteRange");Ma.add("FillRange");Ma.add("InsertCopiedCutCellsCrossSession");L.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(Ma.add("LineageOpenPaneOrChangeFilter"),Ma.add("LineageUpdateView"),
Ma.add("LineageRefreshView"),Ma.add("LineageLoadMore"));L.EwaSettings.isChangeGateEnabled("OfficeVSO:8609133_PromoteGetNumberFormatViewModelData")&&Ma.add("GetNumberFormatViewModelData");Ma.add("PasteString");return Ma}}Zd.CKj=Zd.lRi();Zd.GAi=Zd.MMi();Zd.Mak=Zd.wOi();Object(v.a)(Zd,"RequestStatisticsData",null,[]);class Ae{constructor(Ma,Na,Qc){this.$=Ma;this.kT=Na;this.Iza=Qc}WVc(Ma,Na,Qc,ce,ve,Ve,vf,Kf,ng,Bf,Uf,Qf,ug,ag){Qf=md.a(Qf);Ma=new Zd(Ma,Na,Qc,ce,ve,Ve,vf,Kf,ng,Qf,Bf,Uf,rd.a.UM(Na),this.KMd(null),
ug,this.Iza.jKa(),ag);this.Lke(Ma)}xp(Ma,Na){Ma="UnknownMethodName";var Qc=-1;void 0!==Na.context&&null!==Na.context&&(Ma=Na.context.methodName,Qc=Na.context.communicationErrorRetryCount);let ce,ve={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};Na.pk?(ce=Na.pk.Errors||[],this.kT.wqk(Na.pk.EditSessionIsDirty),void 0!==Na.pk.RequestTelemetryData&&null!==Na.pk.RequestTelemetryData&&(ve=Na.pk.RequestTelemetryData)):ce=[];const Ve=Na.duration,
vf=md.a(Na.url);Ma=new Zd(Ma,Ve,Na.totalOperationDuration,Na.Wwe,Na.tP,ve,Na.toe,ce,Na.httpStatus,vf,Qc,!0,rd.a.UM(Ve),this.KMd(Na.pk),Na.responseSize,this.Iza.jKa(),Na.responseToCallbackTime);this.Lke(Ma);Ma.requestResourceTiming&&(Qc=Ma.requestResourceTiming.totalDuration-Ma.WfeRequestDuration,Qc>=this.$.ua.LongNetworkTimeTelemetryThresholdInMilliseconds&&Na.responseHeaders&&J.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${Ma.requestName}, requestDuration = ${Ma.requestDuration}, networkTime = ${Qc},  ServerCorrelation = ${Ma.correlationID}, msEdgeHeader = ${ab.a.P_b in
Na.responseHeaders?Na.responseHeaders[ab.a.P_b]:""}, backendDatacenter = ${ab.a.m8d in Na.responseHeaders?Na.responseHeaders[ab.a.m8d]:""}, proxyDatacenter = ${ab.a.o8d in Na.responseHeaders?Na.responseHeaders[ab.a.o8d]:""}`))}Wy(Ma,Na){Ma="UnknownMethodName";let Qc=-1;void 0!==Na.context&&null!==Na.context&&(Ma=Na.context.methodName,Qc=Na.context.communicationErrorRetryCount);const ce=Na.duration,ve=md.a(Na.url);Na=new Zd(Ma,ce,Na.totalOperationDuration,Na.Wwe,Na.tP,{EcsOperationDuration:-1,EcsRequestDuration:-1,
WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},Na.toe,Na.errors||[],Na.httpStatus,ve,Qc,!1,rd.a.UM(ce),this.KMd(null),-1,this.Iza.jKa(),Na.responseToCallbackTime);this.Lke(Na)}Lke(Ma){this.kT.zGh(Ma);if(L.EwaSettings.Ra(212)){var Na=Ma.requestName;if(Na!==ab.a.rKa&&"SetCell"!==Na&&"FindRange"!==Na&&"FindAll"!==Na&&"FindCell"!==Na)return}Na=L.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Ma.requestName||null===Ma.requestName)&&Ma.isPromotedUTRRequest;
Ae.Aii(Ma,Na);this.kT.ewh(Ma)}KMd(Ma){var Na;if(null===(Na=null===Ma||void 0===Ma?void 0:Ma.CollaborationResult)||void 0===Na?0:Na.Users)return Ma.CollaborationResult.Users.length;Ma=this.$.ea.Wt.length;return 0<Ma?Ma:1}static Aii(Ma,Na){Na?Id.b().SXc(388829456,0,15,Ma):(Na=Sys.Serialization.JavaScriptSerializer.serialize(Ma),J.ULS.sendTraceTag(388829456,0,50,Na));if(L.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Ma.requestName&&null!==Ma.requestName&&Ma.isFullyLoggedKPIRequest){Na=
new Map;Na.set("isUserTriggeredRequest",Ma.isUserTriggeredRequest.toString());Na.set("requestDuration",Ma.requestDuration.toString());Na.set("totalOperationDuration",Ma.totalOperationDuration.toString());Na.set("requestTimeInQueue",Ma.requestTimeInQueue.toString());Na.set("requestInvokedTime",Ma.requestInvokedTime.toString());Na.set("ecsOperationDuration",Ma.ecsOperationDuration.toString());Na.set("ecsRequestDuration",Ma.EcsRequestDuration.toString());Na.set("wfeRequestDuration",Ma.WfeRequestDuration.toString());
Na.set("timeFromLastEcsFreeze",Ma.TimeFromLastEcsFreeze.toString());Na.set("duringLoadOnDemand",Ma.DuringLoadOnDemand.toString());Na.set("correlationID",Ma.correlationID);Na.set("errors",Ma.errors.toString());Na.set("httpStatus",Ma.httpStatus.toString());if(Ma.networkInfoData){var Qc=Ma.networkInfoData;Na.set("networkInfoData_bandwidthMps",void 0===Qc.bandwidthMps||null===Qc.bandwidthMps?"NA":Qc.bandwidthMps.toString());Na.set("networkInfoData_rttMs",void 0===Qc.rttMs||null===Qc.rttMs?"NA":Qc.rttMs.toString());
Na.set("networkInfoData_effectiveConnection",void 0===Qc.effectiveConnection||null===Qc.effectiveConnection?"NA":Qc.effectiveConnection)}Ma.requestResourceTiming&&(Qc=Ma.requestResourceTiming,Na.set("requestResourceTiming_fetchStart",void 0===Qc.downloadDuration||null===Qc.downloadDuration?"NA":Qc.downloadDuration.toString()));Na.set("communicationErrorRetryCount",Ma.communicationErrorRetryCount.toString());Na.set("successfulCall",Ma.successfulCall.toString());Na.set("isDocumentHidden",Ma.isDocumentHidden.toString());
Na.set("coauthorsCount",Ma.coauthorsCount.toString());Na.set("responseSize",Ma.responseSize.toString());Na.set("responseToCallbackTime",Ma.responseToCallbackTime.toString());Id.b().TVc(Ma.requestName,Ma.successfulCall,Na)}}}Object(v.a)(Ae,"RequestStatistics",null,[]);var Ee=a(236),Ze=a(64),Te=a(266);class We{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=
null}}Object(v.a)(We,"OperationTypeStatisticsData",null,[]);class qf{constructor(Ma,Na){this.data=new We;this.data.operationName=Ma;this.data.isUserOperation=Na;this.data.totalCount=0;this.fYg=[];this.gYg=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Aj(Ma){this.data.totalCount<qf.kDd&&(this.fYg.push(Ma.startToNextFrame),this.gYg.push(Ma.startToResponseRenderEnd));this.data.totalCount++;
this.data.longestStartToNextFrame<Ma.startToNextFrame&&(this.data.longestStartToNextFrame=Ma.startToNextFrame);this.data.longestStartToResponse<Ma.startToResponseRenderEnd&&(this.data.longestStartToResponse=Ma.startToResponseRenderEnd)}ZGd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.hKf(this.fYg),this.data.startToResponsePercentiles=this.hKf(this.gYg))}hKf(Ma){Ma.sort(se.HelperMethods.FS);let Na;Na="("+rd.a.bxa(Ma,25).toString();Na=Na+", "+rd.a.bxa(Ma,50).toString();Na=Na+
", "+rd.a.bxa(Ma,75).toString();Na=Na+", "+rd.a.bxa(Ma,95).toString();return Na+")"}}qf.kDd=1E3;Object(v.a)(qf,"OperationTypeStatistics",null,[]);class bf{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=
this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(v.a)(bf,"RequestTypeStatisticsData",null,[]);class af{constructor(Ma){this.data=new bf;this.data.requestName=Ma;this.data.totalCount=0;this.Evb=[];this.Xxe=this.Nxe=this.Oxe=this.Uxe=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=
-1;this.data.requestDurationPercentile95=-1}grk(Ma){this.data.totalCount<af.kDd&&this.Evb.push(Ma.requestDuration);this.data.totalCount++;this.Uxe+=Ma.requestDuration;this.Oxe+=af.WJd(Ma.ecsOperationDuration);this.Nxe+=af.WJd(Ma.EcsRequestDuration);this.Xxe+=af.WJd(Ma.WfeRequestDuration);0<Ma.TimeFromLastEcsFreeze&&Ma.TimeFromLastEcsFreeze<af.qAi&&this.data.callsDuringEcsFreeze++;Ma.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;Ma.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;
if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<Ma.requestDuration)this.data.longestRequest=Ma}ZGd(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.Uxe/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.Oxe/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.Nxe/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.Xxe/this.data.successfulCalls)):
(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Evb.sort(se.HelperMethods.FS),this.data.requestDurationPercentile25=rd.a.bxa(this.Evb,25),this.data.requestDurationPercentile50=rd.a.bxa(this.Evb,50),this.data.requestDurationPercentile75=rd.a.bxa(this.Evb,75),this.data.requestDurationPercentile95=rd.a.bxa(this.Evb,95))}static WJd(Ma){return 0>Ma?0:Ma}}af.qAi=3E3;af.kDd=1E3;Object(v.a)(af,"RequestTypeStatistics",null,[]);class Nf{constructor(Ma,
Na,Qc,ce,ve,Ve,vf,Kf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=Ma;this.ocsCapable=Na;this.endedBySplashScreen=Qc;this.dirtySessionOnLastRecordedRequest=ce;this.loadOnDemandCount=ve;this.maxCoauthorsCount=Ve;this.everConnectedToOcs=vf;Ma=[];for(const ng in Kf)Na=Kf[ng],Na.ZGd(),Ma.push(Na.data);this.requests=Ma}}Object(v.a)(Nf,"SessionStatisticsData",
null,[]);class uf{constructor(Ma){this.dirtySessionOnLastRecordedRequest=this.yue=!1;this.F7f=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Ma;this.bHb={};this.aHb={};this.NAd={}}ej(){var Ma=this.jai();if(ka.a.Jqa()){var Na={};Na.xlendJson=Ma;this.$.uBa(Ee.a.Ffl,Na,!1)}else Ze.O(this.$.pa.ta,Ma,null,null,null,null,null);Ma=this.kai();ka.a.Jqa()?(Na={},Na.xlenoJson=Ma,this.$.uBa(Ee.a.Gfl,Na,!1)):J.ULS.sendTraceTag(388776782,0,50,Ma);Ma=this.z5h();ka.a.Jqa()?(Na={},Na.xlencJson=Ma,this.$.uBa(Ee.a.Efl,
Na,!1)):J.ULS.sendTraceTag(388776770,0,50,Ma);this.Vrk()}dKc(){this.everConnectedToOcs=this.$.ea.Epb||this.everConnectedToOcs;ub.Health.instance&&ub.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}Jm(){const Ma=new Te.a;let Na="";const Qc=!this.$.isAnonymousUser(),ce=Ma.zl();if(ce){if(Qc){Ma.T7b("UMI_Linkable","true");return}Na=Ma.r_a("UMI_Linkable")}Qc||J.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${ce}, UMIIsLinkable:${!!Na}`)}Cvb(){this.yue=
!0}wqk(Ma){this.dirtySessionOnLastRecordedRequest=Ma}zGh(Ma){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,Ma.coauthorsCount);ub.Health.instance&&ub.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}ewh(Ma){if(!(Ma.requestName in this.bHb)){const Na=new af(Ma.requestName);this.bHb[Ma.requestName]=Na}this.bHb[Ma.requestName].grk(Ma)}dwh(Ma){if(!(Ma.name in this.aHb)){const Na=new qf(Ma.name,Ma.isUserOperation);this.aHb[Ma.name]=Na}this.aHb[Ma.name].Aj(Ma)}a4(Ma){this.NAd[Ma.reportName]=
Ma}Vrk(){this.dirtySessionOnLastRecordedRequest=this.yue=!1;this.F7f=this.$.ea.x2d;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.bHb={};this.aHb={};this.NAd={}}jai(){const Ma=new Nf(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.yue,this.dirtySessionOnLastRecordedRequest,this.$.ea.x2d-this.F7f,this.maxCoauthorsCount,this.everConnectedToOcs,this.bHb);return Sys.Serialization.JavaScriptSerializer.serialize(Ma)}kai(){var Ma=new ac.a;const Na=this.aHb;for(const Qc in Na){const ce=
Na[Qc];ce.ZGd();Ma.add(ce.data)}Ma=Ma.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Ma)}z5h(){return Sys.Serialization.JavaScriptSerializer.serialize(this.NAd)}}Object(v.a)(uf,"SessionStatistics",null,[]);class pf extends uc.a{constructor(Ma){super();this.aBa=this.lAa=null;this.pnf=Array(1);this.Mfd=this.T3d=null;this.xp=(Na,Qc)=>{L.EwaSettings.Ra(39)&&(this.aBa=this.aBa||new Ae(this.$,this.kT,this.Iza),this.aBa.xp(Na,Qc))};this.Wy=(Na,Qc)=>{L.EwaSettings.Ra(39)&&(this.aBa=this.aBa||
new Ae(this.$,this.kT,this.Iza),this.aBa.Wy(Na,Qc))};this.ej=(Na,Qc)=>{L.EwaSettings.Ra(39)&&this.kT.ej(Na,Qc)};this.Jm=()=>{L.EwaSettings.Ra(39)&&this.kT.Jm()};this.dKc=(Na,Qc)=>{L.EwaSettings.Ra(39)&&this.kT.dKc(Na,Qc)};this.$=Ma;L.EwaSettings.Ra(39)&&(rd.a.LUf(this.$),this.PY=new Ac(this.$),this.s7h(),L.EwaSettings.Ra(505)&&this.Tqb&&(this.T3d=new me(this.$,this.Tqb)),this.kT=new uf(this.$),this.Iza=new Ue(this.$),this.$.gq(this.ej),this.$.pa.yI(this.xp),this.$.pa.xX(this.Wy),this.$.ea.p4e(this.dKc),
L.EwaSettings.wl()?this.$.ea.Yq(this.Jm):this.$.ea.lr(this.Jm))}get Tqb(){return this.Mfd}dispose(){this.$&&L.EwaSettings.Ra(39)&&(this.$.Yu(this.ej),this.$.pa.iL(this.xp),this.$.pa.wZ(this.Wy),this.$.ea.qFg(this.dKc),L.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Bv(this.Jm));k.a.dh(this.Iza);k.a.dh(this.Tqb);this.Mfd=null;k.a.dh(this.PY);this.PY=null;k.a.dh(this.T3d);this.$=this.T3d=null;super.dispose()}Cvb(){L.EwaSettings.Ra(39)&&this.kT.Cvb()}WVc(Ma,Na,Qc,ce,ve,
Ve,vf,Kf,ng,Bf,Uf,Qf,ug,ag){L.EwaSettings.Ra(39)&&(this.aBa=this.aBa||new Ae(this.$,this.kT,this.Iza),this.aBa.WVc(Ma,Na,Qc,ce,ve,Ve,vf,Kf,ng,Bf,Uf,Qf,ug,ag))}G5b(Ma,Na){L.EwaSettings.Ra(39)&&(this.lAa=this.lAa||new Tc(this.$,this.kT,this,this.PY),this.lAa.G5b(Ma,Na))}JVc(){L.EwaSettings.Ra(39)&&(this.lAa=this.lAa||new Tc(this.$,this.kT,this,this.PY),this.lAa.JVc())}SVc(){L.EwaSettings.Ra(39)&&(this.lAa=this.lAa||new Tc(this.$,this.kT,this,this.PY),this.lAa.SVc())}a4(Ma){L.EwaSettings.Ra(39)&&this.kT.a4(Ma)}cLd(Ma){return L.EwaSettings.Ra(39)?
this.pnf[Ma]:null}KOg(Ma){Ma&&(this.pnf[Ma.type]=Ma)}jKa(){return this.Iza.jKa()}s7h(){Ja.a.Xv&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.Mfd=new fd(this.$,this.PY))}}Object(v.a)(pf,"SessionStatisticsManager",uc.a,[19]);var ff=a(123),Qa=a(1212),Ob=a(146);class Pc{constructor(Ma,Na){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=
0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Ma;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=
!1;this.wacSessionId=Na}nxe(){return jf.a.Ci(this)}}Object(v.a)(Pc,"AppUnloadInfo",null,[]);var Cd=a(908),Ud=a(119),Wd=a(663);class le{constructor(Ma){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Ma.Cgf+Ma.M3g;this.dataLossReason=Ma.Bcf;this.RRh(Ma.dBe)}RRh(Ma){const Na=new Cd.a(Wd.a.ZU());let Qc=0,ce=0;for(const ve of Ma)Na.lh(ve)||Na.ga(ve,0),Ma=Na.ga(ve,Na.na(ve)+1),Ma>Qc&&(Qc=Ma,ce=ve);Qc>this.mostCommonOperationCount&&
(this.mostCommonOperationName=Ud.a(ce),this.mostCommonOperationCount=Qc)}}Object(v.a)(le,"DataLossInfo",null,[]);var Fa=a(70);class mb{constructor(Ma){this.crd="AppUnloadInfo";this.du=this.$=this.workbookHashedId=this.zI=null;this.ZGe=this.tKe=!1;this.Hl=null;this.eUf=0;this.Cpa=(Na,Qc)=>{this.eUf=Qc.M1c};this.gsg=(Na,Qc)=>{Qc.dBe.length&&this.$.eV&&(this.zI.dataLossInfo=new le(Qc),this.zI.wasDataLostDuringUnload=!0,this.kwb())};this.Jm=()=>{this.b7b();this.$.ea.Bv(this.Jm)};this.gr=()=>{this.b7b();
this.$.ea.KA(this.gr)};this.v4a=()=>{this.zI.wasUpdatedOnBeforeUnload=!0;this.zI.inactivityDurationBeforeUnloadSeconds=this.Hl.Nyb<mb.HFj?this.eUf:this.Hl.Nyb;this.D6g()};this.d2b=()=>{this.zI.wasUpdatedOnUnload=!0;this.D6g();Sys.Application.remove_unload(this.d2b)};this.GQc=()=>{this.zI.lastSilentReopenStartTime=B.a.ih.ri;this.zI.lastSilentReopenEndTime=null;this.kwb();this.$.mr(this.U1b)};this.U1b=()=>{this.zI.lastSilentReopenEndTime=B.a.ih.ri;this.kwb();this.$.Wr(this.U1b)};this.localStorage=new Te.a;
this.localStorage.zl()&&(this.$=Ma,this.workbookHashedId=Fa.a(this.$),this.zI=new Pc(this.workbookHashedId,this.$.ua.UserSessionId),this.du=E.a.instance.BU(),this.du.Ba("beforeunload",this.v4a),this.$.userOperationManager.cFh(this.gsg),L.EwaSettings.isChangeGateEnabled("OfficeVSO:8779648_AppVisuallyReadyMigration-AppUnloadTelemetryManager")?Ma.ea.jn?this.b7b():this.$.ea.lw(this.gr):Ma.ea.nm?this.b7b():L.EwaSettings.wl()?this.$.ea.Yq(this.b7b):this.$.ea.lr(this.Jm),this.Hl=this.$.ea.Hl,this.Hl.qGa(this.Cpa),
Sys.Application.add_unload(this.d2b),this.$.ea.nIb(this.GQc))}get dialogPromptedOnUnload(){return this.tKe}set dialogPromptedOnUnload(Ma){this.tKe=Ma;this.zI?(this.zI.dialogPromptedOnUnload=Ma,this.kwb()):this.localStorage.zl()&&J.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.zl()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.ZGe}set apiBeforeCloseNotificationEnabledOnUnload(Ma){this.ZGe=
Ma;this.zI?(this.zI.apiBeforeCloseNotificationEnabledOnUnload=Ma,this.kwb()):this.localStorage.zl()&&J.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.zl()}`)}dispose(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.Xok(this.gsg);this.Hl&&(this.Hl.aPa(this.Cpa),this.Hl=null);this.du.zM();this.$=this.du=null}D6g(){this.xHk();this.kwb()}xHk(){this.zI.wasOfflineDuringUnload=this.$.km.uha;
this.zI.timeFromLastConnectivity=Ob.a(B.a.ih,this.$.km.q6f);this.zI.timeFromLastDisconnectionStart=Ob.a(B.a.ih,this.$.km.nvj);this.zI.disconnectionSource=Enum.toString(Qa.a,this.$.km.disconnectionSource);this.zI.hadConnectivityIssuesDuringUnload=this.$.km.vya;this.zI.timeFromLastStatusCode0=Ob.a(B.a.ih,this.$.km.p6f)}kwb(){this.zI.timestamp=Date.now();this.localStorage.T7b(this.crd,this.zI.nxe())}b7b(){const Ma=this.localStorage.r_a(this.crd);if(Ma)try{const Na=jf.a.Sp(Ma);this.localStorage.bEg(this.crd);
const Qc=this.MDj(Na);J.ULS.sendTraceTag(574677456,0,50,Qc)}catch(Na){J.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Na.message}`)}else J.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}MDj(Ma){const Na={};Na.WACSessionID=Ma.wacSessionId;Na.wasRefreshed=this.sWh(Ma,this.$.ua.MaxAppReloadDurationIndicatingRefresh);Na.closedWithDialogConfirmation=Ma.dialogPromptedOnUnload;
Na.wasOfflineDuringUnload=Ma.wasOfflineDuringUnload;Na.TimeFromLastConnectivityMs=Ma.timeFromLastConnectivity;Na.TimeFromLastDisconnectionStart=Ma.timeFromLastDisconnectionStart;Na.wasDataLostDuringUnload=Ma.wasDataLostDuringUnload;Na.DataLossInfo=Ma.dataLossInfo;Na.flushedOnUnload=Ma.wasUpdatedOnUnload;Na.flushedOnBeforeUnload=Ma.wasUpdatedOnBeforeUnload;Na.InactivityDurationBeforeUnload=Ma.inactivityDurationBeforeUnloadSeconds;Na.DisconnectionSource=Ma.disconnectionSource;Na.hadConnectivityIssuesDuringUnload=
Ma.hadConnectivityIssuesDuringUnload;Na.TimeFromLastStatusCode0=Ma.timeFromLastStatusCode0;Na.LastSilentReopenStartTime=Ma.lastSilentReopenStartTime;Na.LastSilentReopenEndTime=Ma.lastSilentReopenEndTime;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(Na.ApiBeforeCloseNotificationEnabledOnUnload=Ma.apiBeforeCloseNotificationEnabledOnUnload);return Ka.c(Na)}sWh(Ma,Na){const Qc=window.performance.timing.navigationStart-Ma.timestamp;(Ma=this.workbookHashedId===
Ma.workbookHashedId&&Qc<Na)&&J.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Ma}static Ba(Ma){Ma.ea.Ih.inWebPart||Ma.la.Hh(410,new mb(Ma))}}mb.HFj=10;Object(v.a)(mb,"AppUnloadTelemetryManager",null,[685,4]);var e=a(12),Ra=a(29),O=a(325);class qa{constructor(Ma){this.bof=!1;this.dof=null;this.Jj=()=>{this.Hvk();M.f(this.$).ha&&M.f(this.$).ha.uca(this.Jj)};this.wq=(Na,Qc)=>{Qc.ma&&!this.Hwe.has(Qc.ma.name)&&(this.Hwe.add(Qc.ma.name),M.f(this.$).ha&&
(M.f(this.$).ha.uca(this.Jj),M.f(this.$).ha.g$(this.Jj)))};this.$=Ma;this.W_g=new Set;this.Hwe=new Set;this.$.sa&&this.$.sa.ma&&this.Hwe.add(this.$.sa.ma.name);M.f(this.$).ha.g$(this.Jj);this.$.sa.pn(this.wq)}dispose(){this.$=null}Hvk(){this.dof||this.bSh();var Ma=M.f(this.$);const Na=[];for(var Qc of Ma.xaa()){Ma=Qc.domElement.getElementsByClassName(Ra.wb);for(let ve=Ma.length-1;0<=ve;ve--){var ce=Ma[ve].firstChild;(ce=ce?O.b(ce.currentStyle):"")&&!Na.includes(ce)&&Na.push(ce)}}this.bof||(Qc=e.a.instance.Ea(281).split(","),
Na.push(...Qc),this.bof=!0);for(const ve of Na)ve&&!this.W_g.has(ve)&&(this.gAj(ve),this.W_g.add(ve))}gAj(Ma){this.zTh(Ma)}bSh(){this.dof=qa.bKa("monospace");qa.bKa("sans-serif");qa.bKa("serif")}zTh(Ma){qa.bKa(`${Ma},${"monospace"}`);qa.bKa(`${Ma},${"sans-serif"}`);qa.bKa(`${Ma},${"serif"}`)}static Ba(Ma){if(L.EwaSettings.Ra(61)){const Na=new qa(Ma);Ma.la.Hh(210,Na)}}static bKa(Ma){const Na=document.createElement("div"),Qc=document.createElement("div");Na.style.cssText="position: absolute; overflow: auto; visibility: hidden;";
qa.iHk(Qc,Ma);document.body.appendChild(Na);Na.appendChild(Qc);Qc.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Ma=Qc.offsetWidth+"x"+Qc.offsetHeight;document.body.removeChild(Qc.parentNode);return Ma}static iHk(Ma,Na){Ma.style.cssText="display: inline; visibility: hidden;";Ma.style.fontSize="100px";Ma.style.fontWeight="normal";Ma.style.fontStyle="normal";Ma.style.letterSpacing="normal";Ma.style.lineHeight="normal";Ma.style.whiteSpace="nowrap";Ma.style.fontFamily=
Na}}Object(v.a)(qa,"FontTelemetryManager",null,[4]);var ob=a(261),R=a(168),Za;(function(Ma){Ma[Ma.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Ma[Ma.reactSingleLineRibbon=1]="reactSingleLineRibbon";Ma[Ma.reactMultiLineRibbon=2]="reactMultiLineRibbon";Ma[Ma.invalid=3]="invalid"})(Za||(Za={}));Object(v.b)("RibbonMode",Za);var Cb=a(133);class rc{constructor(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;
this.maxLongFrameDuration=-1}}Object(v.a)(rc,"FramePerformanceData",null,[]);class ma{constructor(Ma){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new rc;this.l2FramePerformanceData=new rc;this.l3FramePerformanceData=new rc;this.name=Ma}}Object(v.a)(ma,"FramePerformanceDataGroup",null,[]);class qb{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(v.a)(qb,"FramePerformanceSessionEndsReport",
null,[198]);class Xb{constructor(Ma){this.sbe={};this.mua=null;this.Hzb=(Na,Qc)=>{Na.longFramesOverThresholdOps++;Na.maxLongFrameDuration=Math.max(Na.maxLongFrameDuration,Qc)};this.Vk=new qb;this.i8h();Ma.la.fi(276,()=>{Mc.a(Ma).a4(this.Vk)})}i8h(){this.mua=new ma("AllGridOperationsData");this.Vk.operationsGroups.push(this.mua);this.AMb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.AMb("DragScroll",["DragScroll"]);this.AMb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.AMb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.AMb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}Xqk(Ma,Na,Qc,ce){const ve=this.IMi(Ma);ve&&(this.Vk.operationsGroups.some(Ve=>ha.a.equals(Ve.name,ve.name,!1))||this.Vk.operationsGroups.push(ve),ve.count++,this.Z3c(Na,ve),this.V3c(Qc,ve),this.mua.count++,
this.Z3c(Na,this.mua),this.V3c(Qc,this.mua),0<ce&&this.g9k(ce,ve),0<=Na&&this.q8k(Na,ve))}M9k(){for(const Ma of this.Vk.operationsGroups)Xb.y8k(Ma)}AMb(Ma,Na){Ma=new ma(Ma);for(const Qc of Na)this.sbe[Qc]=Ma}IMi(Ma){return Ma in this.sbe?this.sbe[Ma]:null}q8k(Ma,Na){30>Ma&&this.vze(Qc=>{Qc.l1FramePerformanceData.fpsUnderThresholdOps++},Na);15>Ma&&this.vze(Qc=>{Qc.l2FramePerformanceData.fpsUnderThresholdOps++},Na);5>Ma&&this.vze(Qc=>{Qc.l3FramePerformanceData.fpsUnderThresholdOps++},Na)}g9k(Ma,Na){100<=
Ma&&(this.Izb(Na.l1FramePerformanceData,Ma,this.Hzb),this.Izb(this.mua.l1FramePerformanceData,Ma,this.Hzb));300<=Ma&&(this.Izb(Na.l2FramePerformanceData,Ma,this.Hzb),this.Izb(this.mua.l2FramePerformanceData,Ma,this.Hzb));600<=Ma&&(this.Izb(Na.l3FramePerformanceData,Ma,this.Hzb),this.Izb(this.mua.l3FramePerformanceData,Ma,this.Hzb))}vze(Ma,Na){Na&&(Ma(Na),Ma(this.mua))}Izb(Ma,Na,Qc){Ma&&Qc(Ma,Na)}Z3c(Ma,Na){Na.minFPS=-1===Na.minFPS?Ma:Math.min(Na.minFPS,Ma)}V3c(Ma,Na){Na.maxFPS=Math.max(Na.maxFPS,
Ma)}static y8k(Ma){Xb.Zze(Ma.l1FramePerformanceData,Ma.count);Xb.Zze(Ma.l2FramePerformanceData,Ma.count);Xb.Zze(Ma.l3FramePerformanceData,Ma.count)}static Zze(Ma,Na){Ma.fpsUnderThresholdOpsPercentage=100*Ma.fpsUnderThresholdOps/Na;Ma.longFramesOverThresholdOpsPercentage=100*Ma.longFramesOverThresholdOps/Na}}Object(v.a)(Xb,"FramePerformanceSessionEndsReportManager",null,[]);class qc{constructor(){this.f=null}}Object(v.a)(qc,"FpsDataWrapper",null,[]);class Uc{constructor(Ma,Na){this.duration=this.startSecond=
0;this.startSecond=void 0===Ma?-1:Ma;this.duration=void 0===Na?-1:Na}}Object(v.a)(Uc,"LongFrameData",null,[]);var ld=a(395);class yd{constructor(Ma,Na,Qc,ce,ve,Ve,vf,Kf,ng,Bf){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===Ma?null:Ma;this.count=void 0===Na?0:Na;this.start=void 0===Qc?-1:Qc;this.end=void 0===ce?-1:ce;this.Avg=void 0===ve?0:ve;this.Max=void 0===Ve?-1:Ve;this.Min=
ld.a.fch;this.longFrameCount=void 0===vf?0:vf;this.coauth=(void 0===Kf?-1:Kf)||1;this.tfAppInt=void 0===ng?-1:ng;this.Props=void 0===Bf?null:Bf;this.LFrame=null}}Object(v.a)(yd,"OperationFPSData",null,[]);var fe=a(978);class De extends uc.a{constructor(Ma,Na){super();this.LIb=-1;this.f1d=0;this.vMa=new Date(0);this.y$=null;this.Fva={};this.IIa=new ac.a;this.Rle=this.gqb=!1;this.Okb=null;this.C1c=this.Lza=0;this.isSynthetic=!1;this.eCf=()=>{const Qc=new Date;var ce=Qc.getMinutes();const ve=Qc.getSeconds();
this.SYb&&Qc.getTime()-this.SYb.getTime()>this.lZk?(this.stop(),this.UHd(Qc)):(ce!==this.f1d&&(this.UHd(Qc),this.f1d=ce),this.gqb&&(this.tk.un?this.y$[ve]=De.pvc:(this.Npf(ve),this.gqb=!1,this.IIa.clear(),this.Fva={})),this.y$[ve]!==De.pvc&&(this.y$[ve]++,ce=Qc.getTime()-this.vMa.getTime(),ce>this.r$f&&this.EAj(this.vMa,ce)),this.LIb=window.requestAnimationFrame(this.eCf),this.vMa=Qc)};this.OP=()=>{this.gqb=!0};this.Xgg=()=>{this.pause()};this.Ygg=()=>{this.Rle&&this.resume()};this.vp=()=>{this.za.l6()&&
this.p9k()};this.zoom=Na;this.SYb=new Date;this.tk=new W;this.tk.f$(this.OP);U.AFrameworkApplication.Tod(this.Xgg);U.AFrameworkApplication.Uod(this.Ygg);this.$=Ma;this.r$f=Ma.ua.LongFrameThresholdMs;this.zCj="MoreThan_"+this.r$f.toString()+"_Ms";this.kZk=Ma.ua.ThresholdToEndOperationTrackingSeconds;this.lZk=Ma.ua.ThresholdToStopFPSTrackingMS;this.za=M.f(this.$).za;U.AFrameworkApplication.ii&&U.AFrameworkApplication.ii.IsSynthetic&&(this.isSynthetic=ha.a.compare(U.AFrameworkApplication.ii[ab.a.isSynthetic],
"True",!0)?!1:!0);this.za.ny(this.vp);this.kle()}get zoomManager(){return this.zoom.zoomManager}start(){this.Rle=!0;this.resume()}stop(){this.Rle=!1;this.pause()}dispose(){this.stop();this.tk.S6a(this.OP);U.AFrameworkApplication.MEg(this.Xgg);U.AFrameworkApplication.NEg(this.Ygg);k.a.dh(this.tk);this.za.ux(this.vp);super.dispose()}XUk(Ma,Na){const Qc=Ma in this.Fva?this.Fva[Ma]:null;this.SYb=new Date;this.start();const ce=this.SYb.getSeconds(),ve=ce+this.kZk;Qc&&ce<=Qc.end?(Qc.count++,Qc.end=ve):
(Qc&&ce>Qc.end&&this.IIa.add(Qc),this.Fva[Ma]=new yd(Ma,1,ce,ve,void 0,void 0,void 0,this.$.ea.Wt.length,Oa.a.instance.Gga(this.SYb),Na))}t6h(){this.Okb||(this.UHd(new Date),this.Okb=new Xb(this.$))}resume(){this.pZf()||!this.za.xZ||this.isSynthetic||(this.gqb=this.tk.un,this.vMa=new Date,this.f1d=this.vMa.getMinutes(),this.kle(),this.Npf(this.vMa.getSeconds()),this.LIb=window.requestAnimationFrame(this.eCf))}pZf(){return 0<=this.LIb}pause(){this.pZf()&&(this.gqb||(this.Opf((new Date).getSeconds()),
J.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.y$.toString()}`)),window.cancelAnimationFrame(this.LIb),this.LIb=-1)}UHd(Ma){if(Ma.getTime()-this.vMa.getTime()<De.BGj&&(this.gqb&&this.Opf(this.vMa.getSeconds()),this.$ki(),0<this.IIa.count&&(Ma={},Ma.NonEmptyCellsCount=this.Lza,Ma.TextCellsCount=this.C1c,Ma.xlfpsJson=Object(oa.a)(new qc,{f:this.IIa.toArray()}),Ma.memoryInfo=this.WFj(),Ma.zoom=this.zoomManager?this.zoomManager.zoom:1,Ma.RibbonMode=R.a(this.$)?Za[R.a(this.$).$S]:De.invalid,Ma.deviceMemory=
navigator.deviceMemory||0,Ma.hardwareConcurrency=navigator.hardwareConcurrency||0,Ma=JSON.stringify(Ma),J.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.y$.toString()}`),!this.isSynthetic))){if(ka.a.Jqa()){var Na={};Na.xlfpsJson=Ma;this.$.uBa(Ee.a.Hfl,Na,!1)}else J.ULS.sendTraceTag(388781010,0,50,`${Ma}`);for(const Qc of this.IIa){Na=1E3>=this.Lza?"0_1000":3E3>=this.Lza?"1000_3000":"3000_inf";const ce=new Map;ce.set("Operation",Qc.Op);ce.set("BucketOfRenderedCells",Na);ub.Health.instance.recordKpiUsage(Oe.a.longFrame,
Vb.b.FailureBased,Ie.a.canvas,ce);0<Qc.longFrameCount&&ub.Health.instance.recordKpiFailure(Oe.a.longFrame,"LongFrame",!1,!0,{extendedProperties:ce});3E4<Qc.tfAppInt&&(0<Qc.longFrameCount?Id.b().aHg(0,this.zCj,ce):Id.b().bHg(0,ce))}J.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${Ma.length}`)}this.reset()}WFj(){const Ma={};if(window.performance){const Na=window.performance.memory;Na&&(Ma.jsHeapSizeLimit=Na.jsHeapSizeLimit,Ma.usedJSHeapSize=Na.usedJSHeapSize,Ma.totalJSHeapSize=Na.totalJSHeapSize)}return Ma}reset(){this.IIa.clear();
this.Fva={};this.kle()}$ki(){var Ma=!0;Ma=void 0===Ma?!0:Ma;if(this.y$){for(const Na of fe.a(this.Fva)){const Qc=this.Fva[Na];Qc.end=Math.min(this.y$.length-1,Qc.end);this.IIa.add(Qc)}this.zSh(this.IIa,this.y$,Ma)}}zSh(Ma,Na,Qc){Qc=void 0===Qc?!0:Qc;for(const ce of Ma){let ve=Ma=0;if(ce.end<Na.length){for(let Ve=ce.start;Ve<=ce.end;Ve++){const vf=Na[Ve];0<=vf&&(ce.Max=Math.round(Math.max(ce.Max,vf)),ce.Min=Math.round(Math.min(ce.Min,vf)),Ma+=vf,ve++)}0<ve&&(ce.Avg=Math.round(Ma/ve));Qc&&this.Okb&&
this.Okb.Xqk(ce.Op,ce.Min,ce.Max,ce.LFrame?ce.LFrame.duration:-1);ce.Props&&(this.L3k(ce),ce.Props=null)}}Qc&&this.Okb&&this.Okb.M9k()}kle(){this.y$=Array(60).fill(0)}Npf(Ma){Ma++;for(let Na=0;Na<Ma;Na++)this.y$[Na]=De.pvc}Opf(Ma){for(;60>Ma;Ma++)this.y$[Ma]=De.pvc}EAj(Ma,Na){Ma=Ma.getSeconds();var Qc=fe.a(this.Fva);if(0<Qc.length)for(const ce of Qc)if(Qc=this.Fva[ce],Ma>=Qc.start&&Ma<Qc.end)Qc.LFrame?Qc.LFrame.duration<Na&&(Qc.LFrame.startSecond=Ma,Qc.LFrame.duration=Na,Qc.longFrameCount++):(Qc.LFrame=
new Uc(Ma,Na),Qc.longFrameCount++)}p9k(){this.C1c=this.Lza=0;for(const Ma of M.f(this.$).Wu){const Na=Ma.CRa;for(const Qc in Na){const ce=this.za.Wn(Na[Qc].hashCode);if(null===ce||void 0===ce?0:ce.kq)this.Lza+=ce.Pj.NonEmptyCellsCount,this.C1c+=ce.Pj.TextValueCellsCount}}}L3k(Ma){const Na=Ma.Props;if(ad.a.C8b in Na&&Na[ad.a.C8b]&&ad.a.G$b in Na){let Qc;(Qc=Object(gb.a)(ob.a,Na[ad.a.G$b]))&&Qc.continueWith(ce=>{Cb.TextEditorTelemetry.instance.Ayh(Ma.Op,Ma.Min,!!Ma.LFrame,Ma.LFrame?Ma.LFrame.duration:
0,ce.result)})}}}De.pvc=-1;De.BGj=6E4;De.invalid="Invalid";Object(v.a)(De,"FramePerformanceTracker",uc.a,[694,4]);class Tb extends Lb.a{constructor(Ma){super();this.$=Ma;this.gm()}create(){let Ma=this.$.la.kh(263);void F.a.resolve(K.ah).then(Na=>{Ma||(Ma=this.$.la.Hh(263,new De(this.$,Na)));this.Bk(Ma)})}static Ba(Ma){L.EwaSettings.isChangeGateEnabled("OfficeVSO:8759538_removeXLFPSTag")||Ma.la.Hh(264,new Tb(Ma))}}Object(v.a)(Tb,"FramePerformanceTrackerFactory",Lb.a,[]);var Yc=a(1066);class Ld{em(Ma,
Na){return new Yc.a(Ma,Na)}Li(Ma,Na){Ma=this.em(Ma,Na);Ma.start();return Ma}}Object(v.a)(Ld,"DefaultStopwatchBuilder",null,[217]);class he{constructor(){this.kEa=new Ld}em(Ma,Na){return this.kEa.em(Ma,Na)}Li(Ma,Na){return this.kEa.Li(Ma,Na)}}Object(v.a)(he,"StopwatchBuilder",null,[217]);var Ke=a(355),Me=a(1091),df=a(1220),xf;(function(Ma){Ma[Ma.actions=0]="actions";Ma[Ma.correlationStart=1]="correlationStart";Ma[Ma.reorderSheetOp=2]="reorderSheetOp";Ma[Ma.formatCellOp=3]="formatCellOp";Ma[Ma.copyOp=
4]="copyOp";Ma[Ma.pasteOp=5]="pasteOp";Ma[Ma.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Ma[Ma.instantaneousSetData=7]="instantaneousSetData";Ma[Ma.immediateSetData=8]="immediateSetData";Ma[Ma.dependentCellsCalc=9]="dependentCellsCalc";Ma[Ma.dependentCellsGraphStat=10]="dependentCellsGraphStat";Ma[Ma.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Ma[Ma.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Ma[Ma.gridBlockUpdates=13]="gridBlockUpdates";
Ma[Ma.browserAppStart=14]="browserAppStart";Ma[Ma.linkedObjects=15]="linkedObjects";Ma[Ma.longFrames=16]="longFrames";Ma[Ma.task=17]="task";Ma[Ma.conflictInEditing=18]="conflictInEditing";Ma[Ma.incomingPresenceData=19]="incomingPresenceData";Ma[Ma.editorTableDelay=20]="editorTableDelay";Ma[Ma.presenceStartup=21]="presenceStartup";Ma[Ma.presenceDelete=22]="presenceDelete";Ma[Ma.editorEvent=23]="editorEvent";Ma[Ma.editorTime=24]="editorTime";Ma[Ma.gridScreenReaderOps=25]="gridScreenReaderOps";Ma[Ma.sendPresenceToService=
26]="sendPresenceToService";Ma[Ma.IME=27]="IME";Ma[Ma.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Ma[Ma.customizeStatusBar=29]="customizeStatusBar";Ma[Ma.clientWebRequests=30]="clientWebRequests";Ma[Ma.showCommentTaskPane=31]="showCommentTaskPane";Ma[Ma.applyThreadedCommentChange=32]="applyThreadedCommentChange";Ma[Ma.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Ma[Ma.findNextOrPreviousComment=34]="findNextOrPreviousComment";Ma[Ma.goto=35]="goto";Ma[Ma.launchOfficeAddInDialog=
36]="launchOfficeAddInDialog";Ma[Ma.richApiInvocation=37]="richApiInvocation";Ma[Ma.fxLibrary=38]="fxLibrary";Ma[Ma.embeddedApiSession=39]="embeddedApiSession";Ma[Ma.numberFormattingCalculator=40]="numberFormattingCalculator";Ma[Ma.requestDataAfterSend=41]="requestDataAfterSend";Ma[Ma.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Ma[Ma.copy=43]="copy";Ma[Ma.paste=44]="paste";Ma[Ma.dragDrop=45]="dragDrop";Ma[Ma.clearCopyState=46]="clearCopyState";Ma[Ma.webWorkerRecalcStats=47]="webWorkerRecalcStats";
Ma[Ma.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";Ma[Ma.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Ma[Ma.customSort=50]="customSort";Ma[Ma.namedSheetViewUserAction=51]="namedSheetViewUserAction";Ma[Ma.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Ma[Ma.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Ma[Ma.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Ma[Ma.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";
Ma[Ma.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";Ma[Ma.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";Ma[Ma.raiseEventsAndGenerateBlockRequests=58]="raiseEventsAndGenerateBlockRequests";Ma[Ma.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(xf||(xf={}));Object(v.b)("UsageTable",xf);var fg=a(485),xg=a(546),lg=a(711),Vf=a(775),dg=a(311);class Gg extends Sys.EventArgs{constructor(){super();this.PJj=0;this.operation="DOMUpdate";this.sender=this.target=null}}
Object(v.a)(Gg,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Hg{constructor(Ma,Na){this.Kme=void 0===Na?1:Na;this.total=Ma}get average(){return this.total/this.Kme}AZh(Ma){return new Hg(this.total+Ma.total,this.Kme+Ma.Kme)}static kPh(Ma,Na){return`${Ma}_${Na}`}}Object(v.a)(Hg,"StopwatchAverage",null,[]);var Mg;(function(Ma){Ma[Ma.longFrame=0]="longFrame";Ma[Ma.longGetRange=1]="longGetRange";Ma[Ma.longJsTask=2]="longJsTask";Ma[Ma.viewportCalculationLoops=3]="viewportCalculationLoops"})(Mg||
(Mg={}));Object(v.b)("UtrKpiVeto",Mg);class Ff{static hmb(Ma){return Enum.toString(Mg,Ma)}}Ff.wRa="UTR";Object(v.a)(Ff,"KpiConstants",null,[]);class yf{}yf.w8g="UTRVetoName";yf.o8g="UTRErrorName";yf.s8g="UTROperationName";yf.J4c="UTRDuration";yf.u8g="UTREndedInPhase";yf.gBe="UTRMessage";yf.v8g="UtrUnavailabilityType";yf.operationName="OperationName";yf.duration="Duration";yf.message="Message";Object(v.a)(yf,"UtrAdditionalData",null,[]);class mg{}mg.Bdl="VetoLike";mg.$rf="E2EOperationPerf";mg.Hrk=
"RequestPerf";mg.K4k="UnavailabilityDurations";Object(v.a)(mg,"UtrTypes",null,[]);class jh{E5b(Ma,Na,Qc){Qc=void 0===Qc?null:Qc;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Qc=Qc?{extendedProperties:Qc}:null,Ma=Ff.hmb(Ma),ub.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Ma,Na,!1,!0,"",Qc))}l7b(Ma,Na,Qc,ce,ve,Ve){Ve[Ff.wRa]=mg.Bdl;Ve[yf.w8g]=Ff.hmb(ce);Ve[yf.o8g]=ve;J.ULS.sendTraceTag(Ma,Na,Qc,jf.a.Ci(Ve));delete Ve[Ff.wRa];delete Ve[yf.w8g];delete Ve[yf.o8g]}}Object(v.a)(jh,
"UtrKpiVetoReporter",null,[]);class bg{Ike(Ma,Na){Na=void 0===Na?null:Na;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||ub.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+Ff.hmb(Ma),Vb.b.FailureBased,"",Na)}E5b(Ma,Na,Qc){Qc=void 0===Qc?null:Qc;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ma=Ff.hmb(Ma),ub.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Ma,Na,!1,!0,this.Wyd(Qc)))}Kqk(Ma,Na){Na=void 0===Na?null:Na;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
ub.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Ff.hmb(Ma),"",this.Wyd(Na))}Jqk(Ma,Na,Qc){Qc=void 0===Qc?null:Qc;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ma=Ff.hmb(Ma),ub.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Ma,Na,!1,!0,"",this.Wyd(Qc)))}Wyd(Ma){return Ma?{extendedProperties:Ma}:null}}Object(v.a)(bg,"UtrKpiVetoUsageReporter",null,[]);class Og{KVc(Ma,Na,Qc){Qc=void 0===Qc?null:Qc;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
ub.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Ma,"",{extendedProperties:Qc,durationMs:Na})}TVc(Ma,Na,Qc){Qc=void 0===Qc?null:Qc;L.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Na?ub.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+Ma,"",{extendedProperties:Qc}):ub.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Ma,"",!1,!1,"",{extendedProperties:Qc}))}i7b(Ma,Na,Qc,ce,ve,Ve,vf,...Kf){vf=String.format(vf,...Kf);Kf={};Kf[Ff.wRa]=
mg.$rf;Kf[yf.s8g]=ce;Kf[yf.u8g]=ve;Kf[yf.J4c]=Ve;Kf[yf.gBe]=vf;J.ULS.sendTraceTag(Ma,Na,Qc,jf.a.Ci(Kf))}RXc(Ma,Na,Qc,ce,ve,Ve,vf){const Kf={};Kf[Ff.wRa]=mg.$rf;Kf[yf.s8g]=ce;Kf[yf.u8g]=ve;Kf[yf.J4c]=Ve;Kf[yf.gBe]=vf;J.ULS.sendTraceTag(Ma,Na,Qc,jf.a.Ci(Kf))}k7b(Ma,Na,Qc,ce,ve,Ve){this.jRg(Ve,ce,ve);J.ULS.sendTraceTag(Ma,Na,Qc,jf.a.Ci(Ve));this.ydi(Ve)}j7b(Ma,Na,Qc,ce,ve,Ve,...vf){Ve=String.format(Ve,...vf);vf={};this.jRg(vf,ce,ve,Ve);J.ULS.sendTraceTag(Ma,Na,Qc,jf.a.Ci(vf))}SXc(Ma,Na,Qc,ce){ce[Ff.wRa]=
mg.Hrk;J.ULS.sendTraceTag(Ma,Na,Qc,jf.a.Ci(ce));delete ce[Ff.wRa]}jRg(Ma,Na,Qc,ce){ce=void 0===ce?null:ce;Ma[Ff.wRa]=mg.K4k;Ma[yf.v8g]=Na;Ma[yf.J4c]=Qc;ce&&(Ma[yf.gBe]=ce)}ydi(Ma){delete Ma[Ff.wRa];delete Ma[yf.v8g];delete Ma[yf.J4c]}}Object(v.a)(Og,"UtrOperationPerfReporter",null,[]);class rg extends y.a{constructor(Ma,Na,Qc,ce,ve,Ve){Qc=void 0===Qc?null:Qc;ce=void 0===ce?null:ce;ve=void 0===ve?null:ve;Ve=void 0===Ve?!1:Ve;super();this.Psi=[ad.a.raf,ad.a.bvf,ad.a.cvf,ad.a.lFc,ad.a.RLc,ad.a.xyj,ad.a.renderCachedContent,
ad.a.renderServerContent,ad.a.ztc,ad.a.Owk,ad.a.vLg,ad.a.wLg,ad.a.ZAk];this.KFb=this.LSa=this.mbc=this.Xzb=this.PRe=this.w$e=this.Ncb=this.$Ye=null;this.yug=this.paf=!1;this.r8g=this.q8g=this.t8g=this.Xke=this.P9g=null;this.upg=(vf,Kf)=>{for(vf=0;vf<Kf.entries.length;vf++){const Qf=Kf.entries[vf];Qf.url=zb.a.removeParameter(Qf.url,U.AFrameworkApplication.XL);var ng=zb.a.sca(Qf.url);!L.EwaSettings.Ra(426)&&this.aqj(Qf.url,ng)&&(Qf.behavior=1);if("img"===Qf.Vz.initiatorType&&ng.endsWith(Me.a.pDd)){var Bf=
zb.a.Bga(Qf.url,Me.a.oDd),Uf=zb.a.Bga(Qf.url,Me.a.qDd);Qf.V4=`${Qf.V4}imageID=${Bf}, imgStateID=${Uf}`}"css"===Qf.Vz.initiatorType&&"responseStatus"in Qf.Vz&&(Bf=`responseStatus=${Qf.Vz.responseStatus}`,Qf.V4=Qf.V4?`${Qf.V4},${Bf}`:Bf);Bf=Qf.Vz.transferSize;let ug;Uf=Qf.Vz.decodedBodySize;void 0!==Bf&&null!==Bf&&void 0!==Uf&&null!==Uf?ug=0===Bf&&0<Uf:void 0!==Bf&&null!==Bf&&(ug=0===Bf);Oa.a.instance.Kzh(ng,Math.round(Qf.Vz.fetchStart),Math.round(Qf.Vz.responseEnd),ug,this.Lrj);ha.a.contains(ng,ad.a.richTextEditor,
!0)&&(ng=Cb.TextEditorTelemetry.instance,ng.kO(ad.a.otk,Math.round(Qf.Vz.fetchStart)),ng.kO(ad.a.qtk,Math.round(Qf.Vz.responseEnd)))}};this.OP=()=>{const vf=this.tja;for(const Kf in vf)vf[Kf].h=!0};this.userSessionId=Ma;this.Shb=Qc=Qc||new lg.a;this.Yp=ce||B.a.ih;this.QVk=ve||this;this.Lrj=Ve;this.Vnf=Qc.erb();L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void F.a.resolve(K.Cb).then(vf=>{this.tk=vf;this.tk.f$(this.OP)}):(this.tk=new W,this.tk.f$(this.OP),
Na.Hh(291,this.tk))}get tja(){return this.$Ye||(this.$Ye={})}get Wmf(){return this.Xzb||this.Vnf}get inf(){return this.LSa||rg.$eg}get lve(){return this.w$e=this.w$e||{}}get ORc(){return this.Ncb||"undefined"===typeof Stw?this.Ncb:this.Ncb=Stw.swpc}get l$f(){return this.PRe=this.PRe||{}}get jPa(){return this.KFb||(this.KFb=D.a.instance.fj("Common.NetworkTiming.IResourceTimingLogger"))}get p8g(){return this.q8g||(this.q8g=new jh)}get E$a(){return this.t8g||(this.t8g=new Og)}get K4c(){return this.r8g||
(this.r8g=new bg)}g0c(Ma,Na,Qc,ce,ve){ve=void 0===ve?null:ve;if(this.tja[Qc])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.tja[Qc]=this.umf(Ma,Na,Qc,ce,ve)}Fwc(Ma,Na){const Qc=this.tja[Ma];Qc&&(this.Thf(Qc,Na),this.K6k(Qc),delete this.tja[Ma])}zEg(Ma){delete this.tja[Ma]}hYg(Ma,Na){this.Xzb||this.XXg(Ma,Na)}QXg(){this.hYg(rg.fQd,this.Yp.$j)}Htf(Ma,Na){Na=void 0===Na?!1:Na;if(this.Xzb){if(this.LSa===rg.Kbe||this.LSa===rg.fQd){const Qc=kb.a.instance;Qc.userSessionId=
this.userSessionId;if(this.LSa===rg.Kbe){this.paf||(this.$oa(Ma.m,Object(jd.a)(Qc,Qc.Tfk,"recordContentFetchEnd")),this.paf=!0);if(Na){this.yug||(this.$oa(Ma.m,Object(jd.a)(Qc,Qc.hgk,"recordPerceivedContentDisplayed")),this.yug=!0);return}this.$oa(Ma.m,Object(jd.a)(Qc,Qc.Sfk,"recordContentDisplayed"))}else this.LSa===rg.fQd&&(Na=this.tja[this.mbc])&&this.$oa(dg.a(Ma,Na.s),Object(jd.a)(Qc,Qc.bgk,"recordInteractivityContentDisplayed"),!1)}this.Fwc(this.mbc,Ma);this.mbc=this.LSa=this.Xzb=null}}$oa(Ma,
Na,Qc){Qc=void 0===Qc?!0:Qc;kb.a.t4&&Object(Ke.a)(Vf.PerformanceClock,B.a.ih)&&Qc&&(Ma+=window.performance.timing.navigationStart);Na(Ma)}zp(Ma){return fg.a(Ma)}Ll(Ma,Na,Qc){Qc=void 0===Qc?!1:Qc;try{if(this.l$f[xf[Ma]]=!0,Qc){var ce=J.ULS,ve=ce.sendTraceTag;const Gd={};let qg=null;switch(Ma){case 0:qg="Actions";var Ve=Na.a;null!=Ve&&(Gd.Id=Ve);var vf=null==Na.b?null:Na.b;null!=vf&&(Gd.Operation=vf);var Kf=Na.c;null!=Kf&&(Gd.Target=Kf);var ng=null==Na.d?null:Na.d.toString();null!=ng&&(Gd.StartTime=
ng);var Bf=null==Na.e?null:Na.e.toString();null!=Bf&&(Gd.Duration=Bf);var Uf=Na.f;null!=Uf&&(Gd.CorrelationId=Uf);var Qf=Na.g;null!=Qf&&(Gd.ParentAction=Qf);var ug=null==Na.h?null:Na.h.toString();null!=ug&&(Gd.DocumentHidden=ug);break;case 1:qg="CorrelationStart";var ag=Na.a;null!=ag&&(Gd.CorrelationId=ag);var Dg=Na.b;null!=Dg&&(Gd.UserSessionId=Dg);var Tg=Na.c;null!=Tg&&(Gd.UserAction=Tg);break;case 2:qg="ReorderSheetOp";var ig=Na.a;null!=ig&&(Gd.UserSessionId=ig);var Yg=null==Na.b?null:Na.b.toString();
null!=Yg&&(Gd.IsDragReorder=Yg);var vh=null==Na.c?null:Na.c.toString();null!=vh&&(Gd.DocumentUp=vh);var Zg=null==Na.d?null:Na.d.toString();null!=Zg&&(Gd.OldIndex=Zg);var Qg=null==Na.e?null:Na.e.toString();null!=Qg&&(Gd.NewIndex=Qg);var Wg=null==Na.f?null:Na.f.toString();null!=Wg&&(Gd.TotalSheets=Wg);break;case 3:qg="FormatCellOp";var dh=Na.a;null!=dh&&(Gd.UserSessionId=dh);var gh=null==Na.b?null:Na.b.toString();null!=gh&&(Gd.TaskId=gh);var Gh=null==Na.c?null:Na.c.toString();null!=Gh&&(Gd.NumberOfRanges=
Gh);var Ch=Na.d;null!=Ch&&(Gd.Ranges=Ch);var Dh=Na.e;null!=Dh&&(Gd.ActiveCell=Dh);var Xg=null==Na.f?null:Na.f.toString();null!=Xg&&(Gd.ActionId=Xg);var og=Na.g;null!=og&&(Gd.CommandParameters=og);var Ug=Na.h;null!=Ug&&(Gd.UserActionStopwatchId=Ug);break;case 4:qg="CopyOp";var Rg=Na.a;null!=Rg&&(Gd.UserSessionId=Rg);var fi=null==Na.b?null:Na.b.toString();null!=fi&&(Gd.IsChrome=fi);var Sg=null==Na.c?null:Na.c.toString();null!=Sg&&(Gd.IsIE=Sg);var Bg=null==Na.d?null:Na.d.toString();null!=Bg&&(Gd.IsFromUI=
Bg);var zg=null==Na.e?null:Na.e.toString();null!=zg&&(Gd.IsCopyInLoadedRange=zg);var Ng=null==Na.f?null:Na.f.toString();null!=Ng&&(Gd.IsRepeatedCopy=Ng);var Ig=null==Na.g?null:Na.g.toString();null!=Ig&&(Gd.IsClipboarAccessSupported=Ig);var bh=null==Na.h?null:Na.h.toString();null!=bh&&(Gd.IsClipboarAccessInstallationSupported=bh);var wh=null==Na.i?null:Na.i.toString();null!=wh&&(Gd.RibbonCommand=wh);var Ga=null==Na.j?null:Na.j.toString();null!=Ga&&(Gd.CutCopyPasteFlags=Ga);var Qb=null==Na.k?null:Na.k.toString();
null!=Qb&&(Gd.IsDrag=Qb);var wc=null==Na.l?null:Na.l.toString();null!=wc&&(Gd.IsIeBeforeAlowDenyPopUp=wc);var S=Na.m;null!=S&&(Gd.IsPasteMatchCopy=S);var eb=Na.n;null!=eb&&(Gd.WaitMessageInClipboard=eb);var ec=null==Na.o?null:Na.o.toString();null!=ec&&(Gd.CallCount=ec);break;case 5:qg="PasteOp";var Lc=Na.a;null!=Lc&&(Gd.UserSessionId=Lc);var Ad=null==Na.b?null:Na.b.toString();null!=Ad&&(Gd.IsChrome=Ad);var pd=null==Na.c?null:Na.c.toString();null!=pd&&(Gd.IsIE=pd);var de=null==Na.d?null:Na.d.toString();
null!=de&&(Gd.IsCopyActive=de);var Ge=null==Na.e?null:Na.e.toString();null!=Ge&&(Gd.IsFromUI=Ge);var Re=null==Na.f?null:Na.f.toString();null!=Re&&(Gd.IsClipboarAccessSupported=Re);var kf=null==Na.g?null:Na.g.toString();null!=kf&&(Gd.IsClipboarAccessInstallationSupported=kf);var Xf=null==Na.h?null:Na.h.toString();null!=Xf&&(Gd.RibbonCommand=Xf);var kg=null==Na.i?null:Na.i.toString();null!=kg&&(Gd.CutCopyPasteFlags=kg);var Yf=Na.j;null!=Yf&&(Gd.WaitMessageInClipboard=Yf);var eh=Na.k;null!=eh&&(Gd.PopupDialog=
eh);var jg=Na.l;null!=jg&&(Gd.SimplePopupMessage=jg);var Se=Na.m;null!=Se&&(Gd.DialogCloseButton=Se);var P=Na.n;null!=P&&(Gd.UserPressedInstallLink=P);var Da=null==Na.o?null:Na.o.toString();null!=Da&&(Gd.CallCount=Da);break;case 6:qg="GetNumberViewModelDataOp";var ib=Na.a;null!=ib&&(Gd.UserSessionId=ib);var ic=Na.b;null!=ic&&(Gd.NumberFormatOptionsPreviousOutputJson=ic);var Rc=Na.c;null!=Rc&&(Gd.NumberFormatOptionsNewInputJson=Rc);break;case 7:qg="InstantaneousSetData";var kd=Na.a;null!=kd&&(Gd.Id=
kd);var td=null==Na.b?null:Na.b.toString();null!=td&&(Gd.WasEmpty=td);var Z=null==Na.c?null:Na.c.toString();null!=Z&&(Gd.ValueNotChanged=Z);var Ha=Na.d;null!=Ha&&(Gd.Source=Ha);var Mb=null==Na.e?null:Na.e.toString();null!=Mb&&(Gd.ProcessingCompleted=Mb);break;case 8:qg="ImmediateSetData";var Zb=Na.a;null!=Zb&&(Gd.ClientStopwatchId=Zb);var gd=Na.b;null!=gd&&(Gd.Operation=gd);var Nd=Na.c;null!=Nd&&(Gd.Parameters=Nd);var ae=null==Na.d?null:Na.d.toString();null!=ae&&(Gd.WasUpdatedByImmediate=ae);var qe=
null==Na.e?null:Na.e.toString();null!=qe&&(Gd.areHtmlElementsEqualClientComparison=qe);var Le=null==Na.f?null:Na.f.toString();null!=Le&&(Gd.WasDecisionMadeByHtmlComparison=Le);var Je=null==Na.g?null:Na.g.toString();null!=Je&&(Gd.IsNumeric=Je);var cf=null==Na.h?null:Na.h.toString();null!=cf&&(Gd.IsDateTime=cf);var If=null==Na.i?null:Na.i.toString();null!=If&&(Gd.HasCurrencySymbol=If);var Pf=null==Na.j?null:Na.j.toString();null!=Pf&&(Gd.HasPercentSymbol=Pf);var Zf=null==Na.k?null:Na.k.toString();null!=
Zf&&(Gd.IsFunc=Zf);var $e=null==Na.l?null:Na.l.toString();null!=$e&&(Gd.DiffInWrappingWhitespace=$e);var zf=Na.m;null!=zf&&(Gd.ImmediatePattern=zf);var Rf=null==Na.n?null:Na.n.toString();null!=Rf&&(Gd.TextAlignmentMatch=Rf);var Sf=null==Na.o?null:Na.o.toString();null!=Sf&&(Gd.FontColorMatch=Sf);var yg=null==Na.p?null:Na.p.toString();null!=yg&&(Gd.FormulaTextMatch=yg);var $g=null==Na.q?null:Na.q.toString();null!=$g&&(Gd.isFormula=$g);var rf=Na.r;null!=rf&&(Gd.FormulaText=rf);var xh=Na.s;null!=xh&&
(Gd.InstantaneousPattern=xh);var kh=null==Na.t?null:Na.t.toString();null!=kh&&(Gd.AreHtmlInnerTextElementsEqualClientComparison=kh);var Hh=Na.u;null!=Hh&&(Gd.HtmlComparisonDecision=Hh);break;case 9:qg="DependentCellsCalc";var oh=Na.a;null!=oh&&(Gd.CalcStatus=oh);var Zh=null==Na.b?null:Na.b.toString();null!=Zh&&(Gd.SuccessfullyCalculatedRanges=Zh);var Di=null==Na.c?null:Na.c.toString();null!=Di&&(Gd.RangesSkipped=Di);var Pi=null==Na.d?null:Na.d.toString();null!=Pi&&(Gd.TotalErrors=Pi);var $h=null==
Na.e?null:Na.e.toString();null!=$h&&(Gd.Partial=$h);var Ei=null==Na.f?null:Na.f.toString();null!=Ei&&(Gd.Canceled=Ei);var Fi=null==Na.g?null:Na.g.toString();null!=Fi&&(Gd.Aggregate=Fi);var rh=null==Na.h?null:Na.h.toString();null!=rh&&(Gd.Unknown=rh);var Gi=null==Na.i?null:Na.i.toString();null!=Gi&&(Gd.UnavailableData=Gi);var li=null==Na.j?null:Na.j.toString();null!=li&&(Gd.Cycle=li);var Si=null==Na.k?null:Na.k.toString();null!=Si&&(Gd.NotImplemented=Si);var qi=null==Na.l?null:Na.l.toString();null!=
qi&&(Gd.InvalidInput=qi);var gi=null==Na.m?null:Na.m.toString();null!=gi&&(Gd.AreDepCells=gi);break;case 10:qg="DependentCellsGraphStat";var lh=null==Na.a?null:Na.a.toString();null!=lh&&(Gd.ParsedFormulas=lh);var vi=null==Na.b?null:Na.b.toString();null!=vi&&(Gd.GraphNodes=vi);var wi=null==Na.c?null:Na.c.toString();null!=wi&&(Gd.GraphArcs=wi);var Hi=null==Na.d?null:Na.d.toString();null!=Hi&&(Gd.AnalyzedBlocks=Hi);var Oh=null==Na.e?null:Na.e.toString();null!=Oh&&(Gd.IterationId=Oh);var Wf=Na.f;null!=
Wf&&(Gd.UniqueId=Wf);var Kg=null==Na.g?null:Na.g.toString();null!=Kg&&(Gd.Aborted=Kg);break;case 11:qg="DependentCellsGraphSectionStat";var Ph=null==Na.a?null:Na.a.toString();null!=Ph&&(Gd.IterationId=Ph);var hh=Na.b;null!=hh&&(Gd.BlockHash=hh);var Ih=Na.c;null!=Ih&&(Gd.Functions=Ih);var Jh=Na.d;null!=Jh&&(Gd.Operators=Jh);var xi=null==Na.e?null:Na.e.toString();null!=xi&&(Gd.CrossDocRefs=xi);var mh=null==Na.f?null:Na.f.toString();null!=mh&&(Gd.CrossSheetRefs=mh);var Od=null==Na.g?null:Na.g.toString();
null!=Od&&(Gd.ErrRefs=Od);var pe=null==Na.h?null:Na.h.toString();null!=pe&&(Gd.LargeRanges=pe);var ph=null==Na.i?null:Na.i.toString();null!=ph&&(Gd.NameRefs=ph);var Eg=null==Na.j?null:Na.j.toString();null!=Eg&&(Gd.ParserErrors=Eg);var Ji=null==Na.k?null:Na.k.toString();null!=Ji&&(Gd.RowRefs=Ji);var yi=null==Na.l?null:Na.l.toString();null!=yi&&(Gd.ColumnRefs=yi);var Eh=null==Na.m?null:Na.m.toString();null!=Eh&&(Gd.TableRefs=Eh);var Ki=Na.n;null!=Ki&&(Gd.UniqueId=Ki);var Kh=null==Na.o?null:Na.o.toString();
null!=Kh&&(Gd.UnreachableReferences=Kh);break;case 12:qg="GetRangeContentPrefetchFailures";var Li=Na.a;null!=Li&&(Gd.UserSessionId=Li);var ai=Na.b;null!=ai&&(Gd.ClientStopwatchId=ai);var sh=null==Na.c?null:Na.c.toString();null!=sh&&(Gd.StateId=sh);break;case 13:qg="GridBlockUpdates";var kj=Na.a;null!=kj&&(Gd.UserSessionId=kj);var Qi=Na.b;null!=Qi&&(Gd.CorrelationId=Qi);var hi=Na.c;null!=hi&&(Gd.Operation=hi);var Jg=null==Na.d?null:Na.d.toString();null!=Jg&&(Gd.PerformanceType=Jg);var yh=Na.e;null!=
yh&&(Gd.BlockHash=yh);var Xi=null==Na.f?null:Na.f.toString();null!=Xi&&(Gd.DurationInMs=Xi);break;case 14:qg="BrowserAppStart";var zh=null==Na.a?null:df.a.PXa(Na.a.getTime());null!=zh&&(Gd.ScriptExecutionStart=zh);var zi=Na.b;null!=zi&&(Gd.UserSessionId=zi);var Fh=Na.c;null!=Fh&&(Gd.ClockMechanism=Fh);var Ah=null==Na.d?null:Na.d.toString();null!=Ah&&(Gd.ScreenDPI=Ah);var Wh=null==Na.e?null:Na.e.toString();null!=Wh&&(Gd.NavigationToScriptExecutionDelta=Wh);break;case 15:qg="LinkedObjects";var Sh=Na.a;
null!=Sh&&(Gd.ChildId=Sh);var lj=Na.b;null!=lj&&(Gd.ParentId=lj);var Mf=Na.c;null!=Mf&&(Gd.ChildTable=Mf);var ii=Na.d;null!=ii&&(Gd.ParentTable=ii);break;case 16:qg="LongFrames";var Vg=null==Na.a?null:df.a.PXa(Na.a.getTime());null!=Vg&&(Gd.StartTime=Vg);var ah=null==Na.b?null:Na.b.toString();null!=ah&&(Gd.DurationInMs=ah);break;case 17:qg="Task";var ih=Na.a;null!=ih&&(Gd.StopwatchId=ih);var mi=null==Na.b?null:Na.b.toString();null!=mi&&(Gd.Status=mi);var Xh=null==Na.c?null:Na.c.toString();null!=Xh&&
(Gd.CreateTime=Xh);var Ti=null==Na.d?null:Na.d.toString();null!=Ti&&(Gd.TaskId=Ti);break;case 18:qg="ConflictInEditing";var ji=Na.a;null!=ji&&(Gd.OtherUserState=ji);var Ui=Na.b;null!=Ui&&(Gd.UserSessionId=Ui);var Yi=null==Na.c?null:df.a.PXa(Na.c.getTime());null!=Yi&&(Gd.ConflictTime=Yi);break;case 19:qg="IncomingPresenceData";var ni=Na.a;null!=ni&&(Gd.UserSessionId=ni);var bi=Na.b;null!=bi&&(Gd.UserId=bi);var mj=null==Na.c?null:Na.c.toString();null!=mj&&(Gd.Disconnected=mj);var Zi=null==Na.d?null:
df.a.PXa(Na.d.getTime());null!=Zi&&(Gd.ReceivedTime=Zi);break;case 20:qg="EditorTableDelay";var Ai=Na.a;null!=Ai&&(Gd.UserSessionId=Ai);var ci=Na.b;null!=ci&&(Gd.UserId=ci);var $i=null==Na.c?null:Na.c.toString();null!=$i&&(Gd.Received=$i);var Vi=null==Na.d?null:Na.d.toString();null!=Vi&&(Gd.DurationInMs=Vi);var Xe=null==Na.e?null:Na.e.toString();null!=Xe&&(Gd.NotAloneAtLogTime=Xe);var th=null==Na.f?null:df.a.PXa(Na.f.getTime());null!=th&&(Gd.Time=th);break;case 21:qg="PresenceStartup";var aj=Na.a;
null!=aj&&(Gd.UserSessionId=aj);var nj=null==Na.b?null:Na.b.toString();null!=nj&&(Gd.EverReceived=nj);var Wi=null==Na.c?null:Na.c.toString();null!=Wi&&(Gd.NotAloneOnOpen=Wi);var ri=null==Na.d?null:Na.d.toString();null!=ri&&(Gd.NotAloneAtLogTime=ri);var hf=null==Na.e?null:Na.e.toString();null!=hf&&(Gd.EditorCount=hf);var bj=null==Na.f?null:Na.f.toString();null!=bj&&(Gd.WorkbookOpenToFirstReceivedInMs=bj);break;case 22:qg="PresenceDelete";var Bi=Na.a;null!=Bi&&(Gd.UserSessionId=Bi);var pj=Na.b;null!=
pj&&(Gd.UserId=pj);var vg=Na.c;null!=vg&&(Gd.Context=vg);var si=Na.d;null!=si&&(Gd.Reason=si);var cj=null==Na.e?null:df.a.PXa(Na.e.getTime());null!=cj&&(Gd.Time=cj);break;case 23:qg="EditorEvent";var Ag=Na.a;null!=Ag&&(Gd.UserSessionId=Ag);var uh=Na.b;null!=uh&&(Gd.UserId=uh);var Mi=Na.c;null!=Mi&&(Gd.Context=Mi);var Ci=null==Na.d?null:df.a.PXa(Na.d.getTime());null!=Ci&&(Gd.Time=Ci);break;case 24:qg="EditorTime";var Ni=Na.a;null!=Ni&&(Gd.UserSessionId=Ni);var Lh=Na.b;null!=Lh&&(Gd.UserId=Lh);var oi=
null==Na.c?null:Na.c.toString();null!=oi&&(Gd.DurationInMs=oi);break;case 25:qg="GridScreenReaderOps";var di=Na.a;null!=di&&(Gd.UserSessionId=di);var Mh=Na.b;null!=Mh&&(Gd.CommandTaskId=Mh);var Bh=null==Na.c?null:Na.c.toString();null!=Bh&&(Gd.CommandId=Bh);var pi=null==Na.d?null:Na.d.toString();null!=pi&&(Gd.ClientSideOnly=pi);var N=null==Na.e?null:Na.e.toString();null!=N&&(Gd.DurationInMS=N);var pa=null==Na.f?null:Na.f.toString();null!=pa&&(Gd.ReachedMaxReadoutCells=pa);var Xa=null==Na.g?null:Na.g.toString();
null!=Xa&&(Gd.RequstedCellCount=Xa);var Sb=null==Na.h?null:Na.h.toString();null!=Sb&&(Gd.NonEmptyCellCount=Sb);var fc=null==Na.i?null:Na.i.toString();null!=fc&&(Gd.Succeeded=fc);var Kc=null==Na.j?null:Na.j.toString();null!=Kc&&(Gd.Canceled=Kc);var ud=Na.k;null!=ud&&(Gd.ErrorType=ud);break;case 26:qg="SendPresenceToService";var Jd=Na.a;null!=Jd&&(Gd.UserSessionId=Jd);var ie=null==Na.b?null:Na.b.toString();null!=ie&&(Gd.TotalCount=ie);var we=null==Na.c?null:Na.c.toString();null!=we&&(Gd.SendCount=we);
break;case 27:qg="IME";var Qe=Na.a;null!=Qe&&(Gd.UserSessionId=Qe);break;case 28:qg="FreezePaneFloatingObjects";var ef=Na.a;null!=ef&&(Gd.UserSessionId=ef);var wf=null==Na.b?null:Na.b.toString();null!=wf&&(Gd.ObjectType=wf);var Tf=Na.c;null!=Tf&&(Gd.ObjectID=Tf);var gg=null==Na.d?null:Na.d.toString();null!=gg&&(Gd.SpannedPanesCount=gg);break;case 29:qg="CustomizeStatusBar";var wg=Na.a;null!=wg&&(Gd.UserSessionId=wg);var Lg=Na.b;null!=Lg&&(Gd.UIControlName=Lg);var G=null==Na.c?null:Na.c.toString();
null!=G&&(Gd.IsControlVisible=G);break;case 30:qg="ClientWebRequests";var ta=Na.a;null!=ta&&(Gd.Path=ta);var jb=Na.b;null!=jb&&(Gd.ProxyStopwatchId=jb);var sc=Na.c;null!=sc&&(Gd.RequestStatus=sc);var Vc=null==Na.d?null:Na.d.toString();null!=Vc&&(Gd.ResponseSizeInBytes=Vc);var nd=Na.e;null!=nd&&(Gd.ClientRequestId=nd);var xd=null==Na.f?null:Na.f.toString();null!=xd&&(Gd.StateId=xd);break;case 31:qg="ShowCommentTaskPane";var Hd=Na.a;null!=Hd&&(Gd.UserSessionId=Hd);var ke=null==Na.b?null:Na.b.toString();
null!=ke&&(Gd.IsFromKeyboardShortcut=ke);var V=null==Na.c?null:Na.c.toString();null!=V&&(Gd.IsShowPane=V);var Wa=null==Na.d?null:Na.d.toString();null!=Wa&&(Gd.ShowForDeepLink=Wa);var Eb=null==Na.e?null:Na.e.toString();null!=Eb&&(Gd.DeepLinkFound=Eb);break;case 32:qg="ApplyThreadedCommentChange";var Jc=Na.a;null!=Jc&&(Gd.UserSessionId=Jc);var od=null==Na.b?null:Na.b.toString();null!=od&&(Gd.Operation=od);var Pd=Na.c;null!=Pd&&(Gd.CommentId=Pd);var ge=null==Na.d?null:Na.d.toString();null!=ge&&(Gd.CommentsCount=
ge);break;case 33:qg="UpgradeLegacyCommentsChange";var Be=Na.a;null!=Be&&(Gd.UserSessionId=Be);var Ye=null==Na.b?null:Na.b.toString();null!=Ye&&(Gd.OperationSuccessful=Ye);break;case 34:qg="FindNextOrPreviousComment";var gf=Na.a;null!=gf&&(Gd.UserSessionId=gf);var Of=null==Na.b?null:Na.b.toString();null!=Of&&(Gd.Succeeded=Of);break;case 35:qg="Goto";var sg=Na.a;null!=sg&&(Gd.UserSessionId=sg);var Cg=null==Na.b?null:Na.b.toString();null!=Cg&&(Gd.IsSucceeded=Cg);var Pg=null==Na.c?null:Na.c.toString();
null!=Pg&&(Gd.IsNOVMode=Pg);break;case 36:qg="LaunchOfficeAddInDialog";var Qh=Na.a;null!=Qh&&(Gd.UserSessionId=Qh);var Vh=Na.b;null!=Vh&&(Gd.SourceId=Vh);var Rh=Na.c;null!=Rh&&(Gd.SourceLabel=Rh);var Ii=Na.d;null!=Ii&&(Gd.Flight=Ii);var zj=Na.e;null!=zj&&(Gd.Experiment=zj);var ej=Na.f;null!=ej&&(Gd.UICultureTag=ej);var ti=null==Na.g?null:Na.g.toString();null!=ti&&(Gd.UICultureTagLcid=ti);var dj=null==Na.h?null:Na.h.toString();null!=dj&&(Gd.WacHostId=dj);break;case 37:qg="RichApiInvocation";var ui=
Na.a;null!=ui&&(Gd.UserSessionId=ui);var Ij=null==Na.b?null:Na.b.toString();null!=Ij&&(Gd.Succeeded=Ij);var ik=Na.c;null!=ik&&(Gd.ErrorType=ik);var Wk=Na.d;null!=Wk&&(Gd.ResultInfo=Wk);var Jj=Na.e;null!=Jj&&(Gd.Source=Jj);break;case 38:qg="FxLibrary";var Cj=Na.a;null!=Cj&&(Gd.EntityName=Cj);var oj=null==Na.b?null:Na.b.toString();null!=oj&&(Gd.EntryPoint=oj);var Kj=null==Na.c?null:Na.c.toString();null!=Kj&&(Gd.Action=Kj);var jk=null==Na.d?null:Na.d.toString();null!=jk&&(Gd.InsertLocation=jk);break;
case 39:qg="EmbeddedApiSession";var Lj=Na.a;null!=Lj&&(Gd.UserSessionId=Lj);break;case 40:qg="NumberFormattingCalculator";var Xk=Na.a;null!=Xk&&(Gd.Id=Xk);var Ri=Na.b;null!=Ri&&(Gd.CounterName=Ri);var Yk=Na.c;null!=Yk&&(Gd.Values=Yk);break;case 41:qg="RequestDataAfterSend";var Rj=Na.a;null!=Rj&&(Gd.ClientStopwatchId=Rj);var qj=Na.b;null!=qj&&(Gd.RequestStatus=qj);var Sj=null==Na.c?null:Na.c.toString();null!=Sj&&(Gd.SendDuration=Sj);var tg=null==Na.d?null:Na.d.toString();null!=tg&&(Gd.RequestId=tg);
break;case 42:qg="FloatingObjectsStopwatchData";var Tj=Na.a;null!=Tj&&(Gd.StopMessage=Tj);var fh=null==Na.b?null:Na.b.toString();null!=fh&&(Gd.Type=fh);var Ak=Na.c;null!=Ak&&(Gd.GUID=Ak);var Bk=null==Na.d?null:Na.d.toString();null!=Bk&&(Gd.Pane=Bk);var rj=null==Na.e?null:Na.e.toString();null!=rj&&(Gd.IsAboveGrid=rj);var Zk=Na.f;null!=Zk&&(Gd.StartCorrelation=Zk);var $k=Na.g;null!=$k&&(Gd.LoadImageCorrelation=$k);var cg=null==Na.h?null:Na.h.toString();null!=cg&&(Gd.SkippedGetEffectsExtents=cg);var Mj=
null==Na.i?null:Na.i.toString();null!=Mj&&(Gd.Version=Mj);break;case 43:qg="Copy";var Uj=Na.a;null!=Uj&&(Gd.UserSessionId=Uj);var fj=Na.b;null!=fj&&(Gd.Trigger=fj);var al=Na.c;null!=al&&(Gd.RibbonCommandName=al);var Ck=Na.d;null!=Ck&&(Gd.SourceItem=Ck);var bl=null==Na.e?null:Na.e.toString();null!=bl&&(Gd.SourceRangeCellCount=bl);var Dj=Na.f;null!=Dj&&(Gd.ClientSideStopwatchId=Dj);var kk=Na.g;null!=kk&&(Gd.CopyOperationId=kk);var gj=null==Na.h?null:Na.h.toString();null!=gj&&(Gd.IsAsync=gj);var cl=
null==Na.i?null:Na.i.toString();null!=cl&&(Gd.IsFromCache=cl);var Dk=null==Na.j?null:Na.j.toString();null!=Dk&&(Gd.IsSuccessiveCopy=Dk);var Vj=null==Na.k?null:Na.k.toString();null!=Vj&&(Gd.IsSelectionAllowed=Vj);var dl=null==Na.l?null:Na.l.toString();null!=dl&&(Gd.IsSuccess=dl);var Th=null==Na.m?null:Na.m.toString();null!=Th&&(Gd.IsExpectedError=Th);var Nj=Na.n;null!=Nj&&(Gd.ExpectedErrorReason=Nj);var wl=Na.o;null!=wl&&(Gd.ErrorMessage=wl);var hj=null==Na.p?null:Na.p.toString();null!=hj&&(Gd.ClientSideCopyTimeInMs=
hj);var sj=null==Na.q?null:Na.q.toString();null!=sj&&(Gd.TotalTimeInMs=sj);var ei=null==Na.r?null:Na.r.toString();null!=ei&&(Gd.PlainTextPayloadSize=ei);var wj=Na.s;null!=wj&&(Gd.CopyPasteTargetType=wj);var Ek=null==Na.t?null:Na.t.toString();null!=Ek&&(Gd.ShadowWorkbookPayloadSize=Ek);var lk=null==Na.u?null:Na.u.toString();null!=lk&&(Gd.HtmlPayloadSize=lk);var Fk=null==Na.v?null:Na.v.toString();null!=Fk&&(Gd.HtmlSizeExceedsLimit=Fk);var xj=null==Na.w?null:Na.w.toString();null!=xj&&(Gd.CopyTotalSizeExceedsLimit=
xj);var Wj=null==Na.x?null:Na.x.toString();null!=Wj&&(Gd.ErrorReason=Wj);var Xj=Na.y;null!=Xj&&(Gd.ErrorName=Xj);var el=null==Na.z?null:Na.z.toString();null!=el&&(Gd.IsSucceededWithAlert=el);var Ej=null==Na.ba?null:Na.ba.toString();null!=Ej&&(Gd.EncounteredDeploymentErrors=Ej);var mk=null==Na.bb?null:Na.bb.toString();null!=mk&&(Gd.ShadowWorkbookSizeExceedsLimit=mk);var Gk=Na.bc;null!=Gk&&(Gd.CopyPasteTargetName=Gk);var tj=Na.bd;null!=tj&&(Gd.CCPSliceName=tj);var yj=Na.be;null!=yj&&(Gd.SyncClipboardItemsKeys=
yj);var nk=Na.bf;null!=nk&&(Gd.AsyncClipboardItemsKeys=nk);var Yj=Na.bg;null!=Yj&&(Gd.CopyPasteHandlerName=Yj);var Hk=Na.bh;null!=Hk&&(Gd.SucceededPopulatingSystemClipboardSync=Hk);var ok=Na.bi;null!=ok&&(Gd.SucceededPopulatingSystemClipboardAsync=ok);var Ik=Na.bj;null!=Ik&&(Gd.Location=Ik);var fl=Na.bk;null!=fl&&(Gd.CopyContextId=fl);var Jk=null==Na.bl?null:Na.bl.toString();null!=Jk&&(Gd.ServerRequestTimeInMs=Jk);var pk=null==Na.bm?null:Na.bm.toString();null!=pk&&(Gd.EcsOperationDuration=pk);var xl=
null==Na.bn?null:Na.bn.toString();null!=xl&&(Gd.EcsRequestDuration=xl);var gl=null==Na.bo?null:Na.bo.toString();null!=gl&&(Gd.WfeRequestDuration=gl);var Kk=null==Na.bp?null:Na.bp.toString();null!=Kk&&(Gd.OriginalSourceRangesCountExceedsLimit=Kk);var qk=null==Na.bq?null:Na.bq.toString();null!=qk&&(Gd.UploadToClipServiceAttempted=qk);var hl=null==Na.br?null:Na.br.toString();null!=hl&&(Gd.FloatingObjectType=hl);var il=null==Na.bs?null:Na.bs.toString();null!=il&&(Gd.IsCopyWithAsyncClipboardAPI=il);break;
case 44:qg="Paste";var jl=Na.a;null!=jl&&(Gd.UserSessionId=jl);var Yh=Na.b;null!=Yh&&(Gd.Trigger=Yh);var Lk=Na.c;null!=Lk&&(Gd.RibbonCommandName=Lk);var yl=null==Na.d?null:Na.d.toString();null!=yl&&(Gd.PasteTypeFlagValue=yl);var Mk=Na.e;null!=Mk&&(Gd.PasteOperationId=Mk);var kl=Na.f;null!=kl&&(Gd.CopyOperationId=kl);var Nk=Na.g;null!=Nk&&(Gd.ClientSideStopwatchId=Nk);var Ok=Na.h;null!=Ok&&(Gd.OriginalDestinationRange=Ok);var Uh=Na.i;null!=Uh&&(Gd.ExpandDestinationRange=Uh);var Aj=Na.j;null!=Aj&&(Gd.SourceItem=
Aj);var ll=null==Na.k?null:Na.k.toString();null!=ll&&(Gd.SourceRangeCellCount=ll);var ml=null==Na.l?null:Na.l.toString();null!=ml&&(Gd.IsSuccess=ml);var nl=null==Na.m?null:Na.m.toString();null!=nl&&(Gd.IsExpectedError=nl);var Zj=Na.n;null!=Zj&&(Gd.ClipboardFormatReadTimeInMs=Zj);var zl=Na.o;null!=zl&&(Gd.ClipboardFormatReadStatus=zl);var Oj=null==Na.p?null:Na.p.toString();null!=Oj&&(Gd.ClipboardReadPermissionPromptShown=Oj);var ol=null==Na.q?null:Na.q.toString();null!=ol&&(Gd.AsyncApiReadTimedOut=
ol);var ki=Na.r;null!=ki&&(Gd.ExpectedErrorReason=ki);var Pj=Na.s;null!=Pj&&(Gd.ErrorMessage=Pj);var ak=null==Na.t?null:Na.t.toString();null!=ak&&(Gd.TotalTimeInMs=ak);var Qj=null==Na.u?null:Na.u.toString();null!=Qj&&(Gd.PlainTextPayloadSize=Qj);var pl=null==Na.v?null:Na.v.toString();null!=pl&&(Gd.ShadowWorkbookPayloadSize=pl);var ql=null==Na.w?null:Na.w.toString();null!=ql&&(Gd.HtmlPayloadSize=ql);var bk=Na.x;null!=bk&&(Gd.CopyPasteTargetType=bk);var ck=null==Na.y?null:Na.y.toString();null!=ck&&
(Gd.IsLastCopyWasExternal=ck);var rl=null==Na.z?null:Na.z.toString();null!=rl&&(Gd.IsClipboardDataContainShadowWorkbook=rl);var Pk=null==Na.ba?null:Na.ba.toString();null!=Pk&&(Gd.IsShadowWorkbookParsedSuccessfully=Pk);var rk=Na.bb;null!=rk&&(Gd.ActiveSelectionType=rk);var sk=Na.bc;null!=sk&&(Gd.PasteResult=sk);var dk=null==Na.bd?null:Na.bd.toString();null!=dk&&(Gd.ErrorReason=dk);var tk=Na.be;null!=tk&&(Gd.ErrorName=tk);var uj=null==Na.bf?null:Na.bf.toString();null!=uj&&(Gd.IsSucceededWithAlert=uj);
var ij=null==Na.bg?null:Na.bg.toString();null!=ij&&(Gd.IsAfterCut=ij);var Oi=null==Na.bh?null:Na.bh.toString();null!=Oi&&(Gd.EncounteredDeploymentErrors=Oi);var uk=null==Na.bi?null:Na.bi.toString();null!=uk&&(Gd.IsCrossSession=uk);var vk=null==Na.bj?null:Na.bj.toString();null!=vk&&(Gd.ShadowWorkbookSizeExceedsLimit=vk);var Qk=null==Na.bk?null:Na.bk.toString();null!=Qk&&(Gd.ClipboardContainXLOPayload=Qk);var Fj=Na.bl;null!=Fj&&(Gd.CopyPasteTargetName=Fj);var Rk=Na.bm;null!=Rk&&(Gd.ChromeExtensionId=
Rk);var ek=Na.bn;null!=ek&&(Gd.PayloadOrigin=ek);var wk=Na.bo;null!=wk&&(Gd.PayloadType=wk);var Sk=Na.bp;null!=Sk&&(Gd.CCPSliceName=Sk);var sl=Na.bq;null!=sl&&(Gd.ClipboardItemsKeys=sl);var Gj=Na.br;null!=Gj&&(Gd.CopyPasteHandlerName=Gj);var nh=null==Na.bs?null:Na.bs.toString();null!=nh&&(Gd.IsSourceItemOriginSameSession=nh);var tl=Na.bt;null!=tl&&(Gd.Location=tl);var Bj=Na.bu;null!=Bj&&(Gd.ExternalAppSource=Bj);var Tk=Na.bv;null!=Tk&&(Gd.PasteContextId=Tk);var fk=null==Na.bw?null:Na.bw.toString();
null!=fk&&(Gd.ServerRequestTimeInMs=fk);var Uk=null==Na.bx?null:Na.bx.toString();null!=Uk&&(Gd.IndicationDisplayScheduled=Uk);var Vk=Na.by;null!=Vk&&(Gd.PasteIndicationDisplayStatus=Vk);var jj=null==Na.bz?null:Na.bz.toString();null!=jj&&(Gd.PasteRecoveryUIDisplayed=jj);var xk=null==Na.ca?null:Na.ca.toString();null!=xk&&(Gd.IsFromPasteRecoveryUI=xk);var Hj=null==Na.cb?null:Na.cb.toString();null!=Hj&&(Gd.EcsOperationDuration=Hj);var gk=null==Na.cc?null:Na.cc.toString();null!=gk&&(Gd.EcsRequestDuration=
gk);var ul=null==Na.cd?null:Na.cd.toString();null!=ul&&(Gd.WfeRequestDuration=ul);var yk=null==Na.ce?null:Na.ce.toString();null!=yk&&(Gd.OriginalSourceRangesCountExceedsLimit=yk);var vl=Na.cf;null!=vl&&(Gd.PasteRecoveryUndoStopwatchId=vl);var eg=null==Na.cg?null:Na.cg.toString();null!=eg&&(Gd.PasteRecoveryUndoTimeInMs=eg);var zk=null==Na.ch?null:Na.ch.toString();null!=zk&&(Gd.PasteCSEPerformed=zk);var hk=null==Na.ci?null:Na.ci.toString();null!=hk&&(Gd.CSEStatus=hk);var d=null==Na.cj?null:Na.cj.toString();
null!=d&&(Gd.IsFromEnterShortcut=d);var z=null==Na.ck?null:Na.ck.toString();null!=z&&(Gd.pasteDestinationHasMergedCells=z);var T=Na.cl;null!=T&&(Gd.ArtSourceItemType=T);var ya=null==Na.cm?null:Na.cm.toString();null!=ya&&(Gd.IsPasteWithAsyncClipboardAPI=ya);var sb=null==Na.cn?null:Na.cn.toString();null!=sb&&(Gd.IsPasteWithChromiumExtension=sb);break;case 45:qg="DragDrop";var cc=Na.a;null!=cc&&(Gd.UserSessionId=cc);var Fc=Na.b;null!=Fc&&(Gd.Trigger=Fc);var Wc=Na.c;null!=Wc&&(Gd.RibbonCommandName=Wc);
var id=Na.d;null!=id&&(Gd.OperationId=id);var Dd=Na.e;null!=Dd&&(Gd.ClientSideStopwatchId=Dd);var ee=Na.f;null!=ee&&(Gd.SourceRange=ee);var re=Na.g;null!=re&&(Gd.DestinationRange=re);var Ce=Na.h;null!=Ce&&(Gd.CutCopyType=Ce);var mf=null==Na.i?null:Na.i.toString();null!=mf&&(Gd.IsShiftKeyDown=mf);var tf=null==Na.j?null:Na.j.toString();null!=tf&&(Gd.IsDragInsert=tf);var Df=null==Na.k?null:Na.k.toString();null!=Df&&(Gd.IsSuccess=Df);var sf=null==Na.l?null:Na.l.toString();null!=sf&&(Gd.IsExpectedError=
sf);var $f=Na.m;null!=$f&&(Gd.ExpectedErrorReason=$f);var pg=Na.n;null!=pg&&(Gd.ErrorMessage=pg);var hg=null==Na.o?null:Na.o.toString();null!=hg&&(Gd.TotalTimeInMs=hg);var Fg=Na.p;null!=Fg&&(Gd.ErrorName=Fg);var Nh=null==Na.q?null:Na.q.toString();null!=Nh&&(Gd.IsSucceededWithAlert=Nh);var ch=Na.r;null!=ch&&(Gd.CopyPasteTargetType=ch);var vj=null==Na.s?null:Na.s.toString();null!=vj&&(Gd.EncounteredDeploymentErrors=vj);var Al=null==Na.t?null:Na.t.toString();null!=Al&&(Gd.IsHeaderDrag=Al);break;case 46:qg=
"ClearCopyState";var Cl=Na.a;null!=Cl&&(Gd.UserSessionId=Cl);var Dl=Na.b;null!=Dl&&(Gd.ClientSideStopwatchId=Dl);var El=Na.c;null!=El&&(Gd.Trigger=El);var Fl=null==Na.d?null:Na.d.toString();null!=Fl&&(Gd.IsClearClipboard=Fl);var Gl=null==Na.e?null:Na.e.toString();null!=Gl&&(Gd.IsExplicit=Gl);var Hl=null==Na.f?null:Na.f.toString();null!=Hl&&(Gd.IsSuccess=Hl);var Il=Na.g;null!=Il&&(Gd.ErrorMessage=Il);var Jl=Na.h;null!=Jl&&(Gd.ErrorName=Jl);var Kl=null==Na.i?null:Na.i.toString();null!=Kl&&(Gd.TotalTimeInMs=
Kl);var Ll=Na.j;null!=Ll&&(Gd.CopyPasteTargetType=Ll);break;case 47:qg="WebWorkerRecalcStats";var Ml=null==Na.a?null:Na.a.toString();null!=Ml&&(Gd.SuccessCount=Ml);var Nl=null==Na.b?null:Na.b.toString();null!=Nl&&(Gd.FailureCount=Nl);var Ol=null==Na.c?null:Na.c.toString();null!=Ol&&(Gd.ValueTypeMismatchCount=Ol);var Pl=null==Na.d?null:Na.d.toString();null!=Pl&&(Gd.CellValueMismatchCount=Pl);var Ql=null==Na.e?null:Na.e.toString();null!=Ql&&(Gd.IfmtMismatchCount=Ql);var Rl=null==Na.f?null:Na.f.toString();
null!=Rl&&(Gd.FormattedTextMismatchCount=Rl);var Sl=null==Na.g?null:Na.g.toString();null!=Sl&&(Gd.CellValueStringMismatchCount=Sl);var Tl=null==Na.h?null:Na.h.toString();null!=Tl&&(Gd.CellValueNumberMismatchCount=Tl);var Ul=null==Na.i?null:Na.i.toString();null!=Ul&&(Gd.CellValueBooleanMismatchCount=Ul);var Vl=null==Na.j?null:Na.j.toString();null!=Vl&&(Gd.CellValueBlankMismatchCount=Vl);var Wl=null==Na.k?null:Na.k.toString();null!=Wl&&(Gd.CellValueErrorMismatchCount=Wl);var Xl=null==Na.l?null:Na.l.toString();
null!=Xl&&(Gd.FormattedTextStringMismatchCount=Xl);var Yl=null==Na.m?null:Na.m.toString();null!=Yl&&(Gd.FormattedTextNumberMismatchCount=Yl);var Zl=null==Na.n?null:Na.n.toString();null!=Zl&&(Gd.FormattedTextBooleanMismatchCount=Zl);var $l=null==Na.o?null:Na.o.toString();null!=$l&&(Gd.FormattedTextBlankMismatchCount=$l);var am=null==Na.p?null:Na.p.toString();null!=am&&(Gd.FormattedTextErrorMismatchCount=am);var bm=null==Na.q?null:Na.q.toString();null!=bm&&(Gd.StringMismatchCount=bm);var cm=null==Na.r?
null:Na.r.toString();null!=cm&&(Gd.NumericMismatchCount=cm);var dm=null==Na.s?null:Na.s.toString();null!=dm&&(Gd.ErrorMismatchCount=dm);var em=null==Na.t?null:Na.t.toString();null!=em&&(Gd.StringValuesCount=em);var fm=null==Na.u?null:Na.u.toString();null!=fm&&(Gd.NumericValuesCount=fm);var gm=null==Na.v?null:Na.v.toString();null!=gm&&(Gd.BooleanValuesCount=gm);var hm=null==Na.w?null:Na.w.toString();null!=hm&&(Gd.BlankValuesCount=hm);var im=null==Na.x?null:Na.x.toString();null!=im&&(Gd.ErrorValuesCount=
im);var jm=null==Na.y?null:Na.y.toString();null!=jm&&(Gd.NumericValuesDiffAverage=jm);var km=Na.z;null!=km&&(Gd.NumericEvaluatedValuesMismatchSamples=km);var lm=Na.ba;null!=lm&&(Gd.NumericFormattedTextMismatchSamples=lm);var mm=Na.bb;null!=mm&&(Gd.NumericMismatchSamples=mm);var nm=Na.bc;null!=nm&&(Gd.CellValueTypeMismatchSamples=nm);var om=Na.bd;null!=om&&(Gd.IfmtMismatchSamples=om);var pm=Na.be;null!=pm&&(Gd.BlockHashCode=pm);break;case 48:qg="DataValidationEditOpenDialog";var qm=Na.a;null!=qm&&
(Gd.ServerCommand=qm);var rm=null==Na.b?null:Na.b.toString();null!=rm&&(Gd.SubDialogOpened=rm);var sm=Na.c;null!=sm&&(Gd.SubDialogButtonClicked=sm);var tm=null==Na.d?null:Na.d.toString();null!=tm&&(Gd.DialogOpened=tm);var um=Na.e;null!=um&&(Gd.RuleType=um);var vm=Na.f;null!=vm&&(Gd.ConditionType=vm);var wm=null==Na.g?null:Na.g.toString();null!=wm&&(Gd.LowerBoundaryFilled=wm);var xm=null==Na.h?null:Na.h.toString();null!=xm&&(Gd.UpperBoundaryFilled=xm);var ym=null==Na.i?null:Na.i.toString();null!=ym&&
(Gd.IgnoreBlank=ym);var zm=null==Na.j?null:Na.j.toString();null!=zm&&(Gd.InCellDropdown=zm);var Am=null==Na.k?null:Na.k.toString();null!=Am&&(Gd.ShowInputMessage=Am);var Bm=null==Na.l?null:Na.l.toString();null!=Bm&&(Gd.InputTitleFilled=Bm);var Cm=null==Na.m?null:Na.m.toString();null!=Cm&&(Gd.InputMessageFilled=Cm);var Dm=null==Na.n?null:Na.n.toString();null!=Dm&&(Gd.ShowErrorAlert=Dm);var Em=null==Na.o?null:Na.o.toString();null!=Em&&(Gd.AlertBlocking=Em);var Fm=null==Na.p?null:Na.p.toString();null!=
Fm&&(Gd.AlertTitleFilled=Fm);var Gm=null==Na.q?null:Na.q.toString();null!=Gm&&(Gd.AlertMessageFilled=Gm);var Hm=Na.r;null!=Hm&&(Gd.StopWatchId=Hm);break;case 49:qg="DataValidationEditSubmitRule";var Im=Na.a;null!=Im&&(Gd.RuleType=Im);var Jm=Na.b;null!=Jm&&(Gd.ConditionType=Jm);var Km=null==Na.c?null:Na.c.toString();null!=Km&&(Gd.LowerBoundaryFilled=Km);var Lm=null==Na.d?null:Na.d.toString();null!=Lm&&(Gd.UpperBoundaryFilled=Lm);var Mm=null==Na.e?null:Na.e.toString();null!=Mm&&(Gd.IgnoreBlank=Mm);
var Nm=null==Na.f?null:Na.f.toString();null!=Nm&&(Gd.InCellDropdown=Nm);var Om=null==Na.g?null:Na.g.toString();null!=Om&&(Gd.ShowInputMessage=Om);var Pm=null==Na.h?null:Na.h.toString();null!=Pm&&(Gd.InputTitleFilled=Pm);var Qm=null==Na.i?null:Na.i.toString();null!=Qm&&(Gd.InputMessageFilled=Qm);var Rm=null==Na.j?null:Na.j.toString();null!=Rm&&(Gd.ShowErrorAlert=Rm);var Sm=null==Na.k?null:Na.k.toString();null!=Sm&&(Gd.AlertBlocking=Sm);var Tm=null==Na.l?null:Na.l.toString();null!=Tm&&(Gd.AlertTitleFilled=
Tm);var Um=null==Na.m?null:Na.m.toString();null!=Um&&(Gd.AlertMessageFilled=Um);var Vm=null==Na.n?null:Na.n.toString();null!=Vm&&(Gd.ClearAllPressed=Vm);var Wm=Na.o;null!=Wm&&(Gd.ActionStatus=Wm);var Xm=Na.p;null!=Xm&&(Gd.Error=Xm);var Ym=Na.q;null!=Ym&&(Gd.StopWatchId=Ym);var Zm=null==Na.r?null:Na.r.toString();null!=Zm&&(Gd.InsertDropdownButton=Zm);break;case 50:qg="CustomSort";var $m=Na.a;null!=$m&&(Gd.RangeType=$m);var an=null==Na.b?null:Na.b.toString();null!=an&&(Gd.HasHeaders=an);var bn=null==
Na.c?null:Na.c.toString();null!=bn&&(Gd.SortTopToBottom=bn);var cn=null==Na.d?null:Na.d.toString();null!=cn&&(Gd.ColumnCount=cn);var dn=null==Na.e?null:Na.e.toString();null!=dn&&(Gd.RowCount=dn);var en=null==Na.f?null:Na.f.toString();null!=en&&(Gd.RangeLimitExceeded=en);var fn=null==Na.g?null:Na.g.toString();null!=fn&&(Gd.CaseSensitive=fn);var gn=null==Na.h?null:Na.h.toString();null!=gn&&(Gd.GetSortInfoDuration=gn);var hn=null==Na.i?null:Na.i.toString();null!=hn&&(Gd.LevelCount=hn);var jn=null==Na.j?
null:Na.j.toString();null!=jn&&(Gd.SortOnValuesCount=jn);var kn=null==Na.k?null:Na.k.toString();null!=kn&&(Gd.SortOnCellColorCount=kn);var ln=null==Na.l?null:Na.l.toString();null!=ln&&(Gd.SortOnFontColorCount=ln);var mn=null==Na.m?null:Na.m.toString();null!=mn&&(Gd.SortOnIconCount=mn);var nn=null==Na.n?null:Na.n.toString();null!=nn&&(Gd.CustomOrderCount=nn);var on=null==Na.o?null:Na.o.toString();null!=on&&(Gd.AvgCellColorCount=on);var pn=null==Na.p?null:Na.p.toString();null!=pn&&(Gd.MaxCellColorCount=
pn);var qn=null==Na.q?null:Na.q.toString();null!=qn&&(Gd.AvgFontColorCount=qn);var rn=null==Na.r?null:Na.r.toString();null!=rn&&(Gd.MaxFontColorCount=rn);var sn=null==Na.s?null:Na.s.toString();null!=sn&&(Gd.AvgIconsCount=sn);var tn=null==Na.t?null:Na.t.toString();null!=tn&&(Gd.MaxIconsCount=tn);var un=null==Na.u?null:Na.u.toString();null!=un&&(Gd.Executed=un);break;case 51:qg="NamedSheetViewUserAction";var vn=Na.a;null!=vn&&(Gd.UserSessionId=vn);var wn=Na.b;null!=wn&&(Gd.UserActionName=wn);var xn=
null==Na.c?null:Na.c.toString();null!=xn&&(Gd.UserActionSource=xn);var yn=Na.d;null!=yn&&(Gd.UserActionData=yn);var zn=Na.e;null!=zn&&(Gd.OtherData=zn);break;case 52:qg="NamedSheetViewTeachingCallout";var An=Na.a;null!=An&&(Gd.UserSessionId=An);var Bn=null==Na.b?null:Na.b.toString();null!=Bn&&(Gd.TeachingCalloutSequence=Bn);var Cn=null==Na.c?null:Na.c.toString();null!=Cn&&(Gd.TeachingCalloutIndex=Cn);var Dn=null==Na.d?null:Na.d.toString();null!=Dn&&(Gd.UserActionName=Dn);var En=Na.e;null!=En&&(Gd.UserActionData=
En);var Fn=null==Na.f?null:Na.f.toString();null!=Fn&&(Gd.DurationInMs=Fn);break;case 53:qg="NamedSheetViewTeachingDialog";var Gn=Na.a;null!=Gn&&(Gd.UserSessionId=Gn);var Hn=Na.b;null!=Hn&&(Gd.UserActionName=Hn);var In=Na.c;null!=In&&(Gd.ButtonClicked=In);var Jn=null==Na.d?null:Na.d.toString();null!=Jn&&(Gd.DurationInMs=Jn);var Kn=null==Na.e?null:Na.e.toString();null!=Kn&&(Gd.IsNewTeachingDialog=Kn);break;case 54:qg="NamedSheetViewOptionsDialog";var Ln=Na.a;null!=Ln&&(Gd.UserSessionId=Ln);var Mn=null==
Na.b?null:Na.b.toString();null!=Mn&&(Gd.OptionsAction=Mn);var Nn=Na.c;null!=Nn&&(Gd.OptionsActionData=Nn);var On=Na.d;null!=On&&(Gd.OptionsOtherData=On);var Pn=null==Na.e?null:Na.e.toString();null!=Pn&&(Gd.DurationInMs=Pn);break;case 55:qg="NamedSheetViewTempViewSaveDialog";var Qn=Na.a;null!=Qn&&(Gd.UserSessionId=Qn);var Rn=Na.b;null!=Rn&&(Gd.TriggeredFrom=Rn);var Sn=Na.c;null!=Sn&&(Gd.ButtonClicked=Sn);var Tn=null==Na.d?null:Na.d.toString();null!=Tn&&(Gd.NameUpdated=Tn);var Un=null==Na.e?null:Na.e.toString();
null!=Un&&(Gd.DurationInMs=Un);break;case 56:qg="TemporaryViewStartedDataRestore";var Vn=Na.a;null!=Vn&&(Gd.UserSessionId=Vn);var Wn=null==Na.b?null:Na.b.toString();null!=Wn&&(Gd.CountOfTempViews=Wn);break;case 57:qg="TemporaryViewFetchedVersion";var Xn=Na.a;null!=Xn&&(Gd.UserSessionId=Xn);var Yn=null==Na.b?null:Na.b.toString();null!=Yn&&(Gd.NumberOfBytes=Yn);break;case 58:qg="RaiseEventsAndGenerateBlockRequests";var Zn=null==Na.a?null:Na.a.toString();null!=Zn&&(Gd.ReturnContentStatus=Zn);var $n=
null==Na.b?null:Na.b.toString();null!=$n&&(Gd.CacheState=$n);var ao=null==Na.c?null:Na.c.toString();null!=ao&&(Gd.FromXhrCallback=ao);var bo=null==Na.d?null:Na.d.toString();null!=bo&&(Gd.AreGeneralErrorsPresent=bo);var co=Na.e;null!=co&&(Gd.BlockCacheItemHash=co);var eo=Na.f;null!=eo&&(Gd.StopwatchId=eo);var fo=Na.g;null!=fo&&(Gd.BlockCacheItemProcessingStopwatchId=fo);var go=null==Na.h?null:Na.h.toString();null!=go&&(Gd.StateId=go);var ho=null==Na.i?null:Na.i.toString();null!=ho&&(Gd.IsHighPriority=
ho);var io=null==Na.j?null:Na.j.toString();null!=io&&(Gd.CalcComplete=io);var jo=null==Na.k?null:Na.k.toString();null!=jo&&(Gd.EditedCellsUpdatedByCse=jo);var ko=null==Na.l?null:Na.l.toString();null!=ko&&(Gd.DependentCellsUpdatedByCse=ko);var lo=null==Na.m?null:Na.m.toString();null!=lo&&(Gd.Revision=lo);var mo=null==Na.n?null:Na.n.toString();null!=mo&&(Gd.SheetProcessedDataVersion=mo);var no=null==Na.o?null:Na.o.toString();null!=no&&(Gd.RefCount=no);var oo=null==Na.p?null:Na.p.toString();null!=oo&&
(Gd.ExistsInView=oo);var po=null==Na.q?null:Na.q.toString();null!=po&&(Gd.ContentSource=po);break;case 59:qg="LaunchMakerCodeEditor";var qo=Na.a;null!=qo&&(Gd.SessionId=qo);var ro=Na.b;null!=ro&&(Gd.Command=ro);var so=null==Na.c?null:Na.c.toString();null!=so&&(Gd.IsPreviewGallery=so);var to=Na.d;null!=to&&(Gd.MenuItemId=to);var uo=Na.e;null!=uo&&(Gd.ScriptId=uo);var vo=Na.f;null!=vo&&(Gd.ShareId=vo);var wo=null==Na.g?null:Na.g.toString();null!=wo&&(Gd.IsOwner=wo);var xo=null==Na.h?null:Na.h.toString();
null!=xo&&(Gd.PublishedScriptCount=xo);var yo=null==Na.i?null:Na.i.toString();null!=yo&&(Gd.RecentScriptCount=yo);var zo=null==Na.j?null:Na.j.toString();null!=zo&&(Gd.WorkbookScriptCount=zo)}Gd.Table=qg;var Bo=Sys.Serialization.JavaScriptSerializer.serialize(Gd);ve.call(ce,3704927,0,50,Bo)}}catch(Gd){J.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${Ma} exception: ${Gd}`)}}fEd(Ma,Na,Qc){if(this.ORc){const ce=this.Ncb[Ma+Na];ce&&(ce.e=Qc,this.$Gd(ce));delete this.Ncb[Ma+Na]}}P2d(Ma,
Na){xf[Ma]in this.l$f||this.Ll(Ma,Na)}d6j(){this.Yp.appStart&&this.XXg(rg.Kbe,this.Yp.appStart)}WBj(Ma){const Na={};Na.a=Ma.i;Na.b=Ma.o;Na.c=Ma.t;Na.d=dg.a(Ma.s,Ma.p||this.Yp.appStart);Na.e=dg.a(Ma.e,Ma.s);Na.f=Ma.c;Na.g=Ma.a;Na.h=Ma.h;this.Ll(0,Na,this.Coj(Na.b,Na.c))}Coj(Ma,Na){return["CommandTask","QueuedTask","Task"].includes(Ma)&&!this.Psi.includes(Na)?!1:!0}vI(Ma,Na,Qc,ce,ve){if(Ma&&Na){const Ve={};Ve.a=Ma;Ve.b=Na;Ve.c=Qc.toString();Ve.d=ce.toString();this.Ll(15,Ve,void 0===ve?!0:ve)}}U9f(Ma,
Na,Qc,ce){const ve={};Ma&&(ve.c=dg.a(Ma,this.Yp.appStart));ve.b=Na;ve.a=Qc;ve.d=ce;this.Ll(17,ve)}dispose(){this.jPa.execute(Ma=>{Ma.deactivate(!0);Ma.smk(this.upg)});this.tk&&this.tk.S6a(this.OP);super.dispose()}INf(){return this.P9g=this.P9g||new he}umf(Ma,Na,Qc,ce,ve){const Ve={};Ve.o=Ma;Ve.t=Na;Ve.p=void 0===ve?null:ve;Ve.s=(void 0===ce?null:ce)||this.Yp.$j;this.MTd(Ve,void 0===Qc?null:Qc);return Ve}Thf(Ma,Na){Ma&&(Ma.e=(void 0===Na?null:Na)||this.Yp.$j,Ma.i=Ma.i||this.Shb.erb(),Ma.c=Ma.c||this.Wmf,
Ma.a=Ma.a||this.inf,Ma.h=void 0!==Ma.h&&null!==Ma.h?Ma.h:this.tk?this.tk.un:!1,this.$Gd(Ma))}b$f(Ma){const Na=Ma.context;Ma.duration>rg.Gii&&(Na.methodName===ab.a.vSb||Na.methodName===ab.a.rKa)&&this.PVc(1,rg.gUi);if("GetSessionStatus"!==Na.methodName){const Qc={};Qc.a=Na.methodName;Qc.b=Na.stopwatch.id;Qc.c=Ma.bWc;Qc.d=Ma.responseSize;Qc.e=Na.lXa;Qc.f=Ma.pk?Ma.pk.StateId:ab.a.Tye;this.Ll(30,Qc,!0);this.vI(Qc.b,Ma.pk.ServerCorrelationId,"clientWebRequests","ServerActions")}}KYg(){if(this.ORc){const Ma=
this.Ncb.LoadingUIShownSplashScreen;Ma&&Oa.a.instance.eFk(Ma.s)}}PVc(Ma,Na){this.p8g.E5b(Ma,Na,null)}bHg(Ma,Na){this.K4c.Kqk(Ma,void 0===Na?null:Na)}aHg(Ma,Na,Qc){this.K4c.Jqk(Ma,Na,void 0===Qc?null:Qc)}cHg(Ma){this.K4c.Ike(Ma,null)}dHg(Ma,Na){this.K4c.E5b(Ma,Na,null)}KVc(Ma,Na,Qc){this.E$a.KVc(Ma,Na,void 0===Qc?null:Qc)}TVc(Ma,Na,Qc){this.E$a.TVc(Ma,Na,void 0===Qc?null:Qc)}i7b(Ma,Na,Qc,ce,ve,Ve,vf,...Kf){this.E$a.i7b(Ma,Na,Qc,ce,ve,Ve,vf,...Kf)}RXc(Ma,Na,Qc,ce,ve,Ve,vf){this.E$a.RXc(Ma,Na,Qc,ce,
ve,Ve,vf)}k7b(Ma,Na,Qc,ce,ve,Ve){this.E$a.k7b(Ma,Na,Qc,ce,ve,Ve)}j7b(Ma,Na,Qc,ce,ve,Ve,...vf){this.E$a.j7b(Ma,Na,Qc,ce,ve,Ve,...vf)}l7b(Ma,Na,Qc,ce,ve,Ve){this.p8g.l7b(Ma,Na,Qc,ce,ve,Ve)}SXc(Ma,Na,Qc,ce){this.E$a.SXc(Ma,Na,Qc,ce)}$Gd(Ma){this.QVk.WBj(Ma)}e6j(){if(this.ORc){Stw.swpc=null;const Ma=this.ORc;for(const Na in Ma)this.MTd(Ma[Na])}}hwi(){const Ma=window[xg.a.namespace];if(Ma){const Na=Ma[xg.a.Ugf];Na&&(delete Ma[xg.a.Ugf],Na.forEach(Qc=>{this.MTd(Qc);this.$Gd(Qc)}))}}aqj(Ma,Na){if("about:blank"===
Ma||"renamehandler.ashx"===Na&&"2"===zb.a.Fz(Ma,"u"))return!0;for(Ma=0;Ma<this.Xke.length;Ma++)if(Na.endsWith(this.Xke[Ma]))return!0;return!1}lzj(){this.jPa.execute(Ma=>{Ma.$n(rg.wLh,0);Ma.fCh(this.upg);Ma.activate()})}czj(){const Ma={};Ma.a=new Date(Hf.EcmaDateClock.instance.appStart.m);Ma.b=this.userSessionId;Ma.c=this.Yp.Q0g;Ma.d=rg.Xbi*Ib.devicePixelRatio;Ma.e=B.a.ih.appStart.m;this.Ll(14,Ma,!0);this.$oa(B.a.ih.appStart.m,Object(jd.a)(kb.a.instance,kb.a.instance.Jfk,"recordAppInitStart"))}XXg(Ma,
Na){this.Xzb=this.Shb.erb();this.mbc=this.Shb.erb();this.LSa=Ma;this.g0c("UserAction",Ma,this.mbc,Na);this.G8f(Ma,this.Xzb)}iYk(){const Ma=window[xg.a.namespace];Ma&&!rg.zkf&&(Ma[xg.a.RUk]=(Na,Qc)=>this.umf(Na,Qc),Ma[xg.a.bli]=Na=>{this.Thf(Na)},rg.zkf=!0)}K6k(Ma){const Na=Hg.kPh(Ma.o,Ma.t),Qc=new Hg(dg.a(Ma.e,Ma.s)),ce=Na in this.lve?this.lve[Na].AZh(Qc):Qc;this.lve[Na]=ce;if(Qc===ce||Qc.average!==ce.average)Ma=Object(oa.a)(new Gg,{operation:Ma.o,target:Ma.t,PJj:ce.average,sender:this}),this.raiseEvent(Na,
Ma)}G8f(Ma,Na){const Qc={};Qc.a=Na;Qc.b=this.userSessionId;Qc.c=Ma;this.Ll(1,Qc,!0)}bcj(){this.Xke=[ab.a.Jjk,ab.a.getSessionStatus,ab.a.rKa,ab.a.kZh,ab.a.YVh,ab.a.Nzb,ab.a.KBc,ab.a.getObjectMetadata,ab.a.BRi,ab.a.setRichTextCell,ab.a.yKa,ab.a.Cal,ab.a.pollSessionStatus,ab.a.DXi,ab.a.rVi,ab.a.lOi]}MTd(Ma,Na){Ma.i=(void 0===Na?null:Na)||this.Shb.erb();Ma.a=this.inf;Ma.c=this.Wmf;Ma.h=this.tk?this.tk.un:!1}static Ba(Ma){const Na=new rg(Ma.ua.UserSessionId,Ma.la,void 0,void 0,void 0,!0);Na.G8f(rg.$eg,
Na.Vnf);J.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Na.lzj();Na.iYk();Na.d6j();Na.czj();Na.hwi();Na.e6j();Na.bcj();rg.ECk(Ma);ff.a.Ux.Hh(41,Na)}static ECk(Ma){const Na=Ib.devicePixelRatio;1<Na&&Ma.Ih.cF(!0,2<=Na?8388608:4194304)}}rg.$eg="UnassignedUserAction";rg.Kbe="PageLoad";rg.fQd="GridUpdateOperation";rg.Gii=5E3;rg.gUi="MoreThan_5000_Ms";rg.Xbi=96;rg.wLh=30;rg.zkf=!1;Object(v.a)(rg,"TelemetryManager",y.a,[17,18,682,683]);Type.registerNamespace("_Ewa");
Type.registerNamespace("Common.App.BrowserInfoLogger");xc.main();Type.registerNamespace("CNT");ed.main();Type.registerNamespace("CACPU");be.main();Type.registerNamespace("Common.App.EventsCacheManager");Pe.main();(()=>{hc.a.gh(Ma=>{K.nd.Aa()||Ma.la.Hh(137,new kc(Ma))})})();(()=>{hc.a.gh(Ma=>{Ma.la.Hh(37,new te(Ma))})})();(()=>{hc.a.gh(Ma=>{Ma.la.Hh(40,new pc(Ma,new tc.a(()=>K.nd.Aa()?Object(Ic.d)(F.a.resolve(K.nd,{va:1})):ze.GetServiceTaskFactory.create(Ma.la,137,Ma.ya,1))))})})();(()=>{hc.a.gh(Ma=>
{Ma.la.Hh(276,new pf(Ma))})})();(()=>{hc.a.gh(Ma=>{ff.a.Ux.fi(135,()=>{rg.Ba(Ma);qa.Ba(Ma);L.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")||Nb.Ba(Ma);Tb.Ba(Ma);mb.Ba(Ma);L.EwaSettings.isChangeGateEnabled("OfficeVSO:8680491_MigrateRenderingFidelityTracker")||na.RenderingFidelityTracker.Ba(Ma)})})})();String(h);String(r);String(f);String(l);String(m);String(na);String(x);String(n);String(t);window.___1710758652318_closurehack=h;window.___1710758652318_closurehack=
r;window.___1710758652318_closurehack=f;window.___1710758652318_closurehack=l;window.___1710758652318_closurehack=m;window.___1710758652318_closurehack=na;window.___1710758652318_closurehack=x;window.___1710758652318_closurehack=n;window.___1710758652318_closurehack=t},916:function(A,u,a){function c(f,l){l=void 0===l?{}:l;return b.AFrameworkApplication.fa.ka("IsWebpack5RibbonEnabled")?h.a.resolve(r.vf,l).then(m=>m.loadChunk(f)):h.a.resolve(r.Gb,l).then(m=>m(f))}a.d(u,"a",function(){return c});var b=
a(6),h=a(95),r=a(5)},933:function(A,u,a){a.d(u,"a",function(){return w});A=a(0);var c=a(6),b=a(79),h=a(35),r=a(33),f=a(189);class l{constructor(v,k){this.message=v;this.QIa=k}}Object(A.a)(l,"CrossDocumentEventArgs",null,[]);var m=a(958),x=a(394),n=a(293),t=a(957);class w{constructor(v,k,y,C){this._name="";this.bC={};this.Xda=null;this.ackMessageHandler=B=>{B=B.CorrelationId;""!==B&&B in this.bC&&(t.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.bC[B],B),this.bC[B]=
"ACK_RECEIVED")};this.A_b=B=>{const E=this.gSb(B);if(!E)return!1;if(this.ds[E.MessageId])return this.VQ.oLa(this.ds[E.MessageId],E),!0;if(this.Bt[E.MessageId]){const K=this.Bt[E.MessageId];B=new l(E,B);this.VQ.iVb(K,B);return!0}return!1};this.$Q=[];this.OQ=[];this.PQ=[];this.YQ=[];this.JFa=v;this.HFa=k;this.ds={};this.Bt={};this.VQ=y;w._id++;C&&C();this.kv=this.enable()}get targetOrigin(){return this.HFa}get HQa(){return this.JFa}enable(){if(!n.a())return t.a.sendTraceTag(5018251,2,"Not supported for current browser."),
!1;this.bVb();t.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.kv}bVb(){t.a.debugAssertTag(5018253,!!this.VQ,null);this.Xda=this.A_b;this.VQ.hWa(this.Xda,null)}disable(){this.kv=!1;this.$Q=[];this.OQ=[];this.PQ=[];this.YQ=[];this.JFa=null;this.HFa="";this.VQ.CYa(this.Xda);this.ds={};this.Bt={}}dispose(){this.disable()}pha(v){return!!this.$Q&&Array.contains(this.$Q,v)||this.HLa(v)}HLa(v){return!!this.OQ&&Array.contains(this.OQ,v)}kr(v){t.a.debugAssertTag(5018259,!!this.$Q,null);
Array.add(this.$Q,v);t.a.sendTraceTag(5018260,2,"Allow receiving : {0}",v)}pVa(v){t.a.debugAssertTag(5018261,!!this.OQ,null);Array.add(this.OQ,v);t.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",v)}UWb(v){return!!this.PQ&&Array.contains(this.PQ,v)}rX(v){t.a.debugAssertTag(5018263,!!this.PQ,null);Array.add(this.PQ,v);t.a.sendTraceTag(5018264,2,"Allow free sending: {0}",v)}cXb(v){v=b.a.getOrigin(v);return!!v&&!!this.YQ&&Array.contains(this.YQ,v)}sX(v){t.a.debugAssertTag(5018265,!!this.YQ,null);
if(v===w.aM)return t.a.debugAssertTag(5018266,!1,null),!1;let k=b.a.getOrigin(v);if(!k)return t.a.sendTraceTag(5018267,4,"Get origin fail:{0}",v),!1;c.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(k=r.a.ys(k));Array.add(this.YQ,k);t.a.sendTraceTag(5018268,2,"Add origin:{0}",k);return!0}send(v,k){k=void 0===k?null:k;let y=this.targetOrigin;if(k){k=b.a.getOrigin(k);if(!k)return!1;y=k}return this.Zia(v,this.HQa,y)}sendMessage(v,
k,y){y=(y=void 0===y?"":y)&&""!==y?y:f.a.create().toString();return this.send(this.nia(v,k,y,c.AFrameworkApplication.userSessionId))}postMessage(v){const k=f.a.create().toString();if(!c.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!v.Uqa)return this.send(this.nia(v.messageId,v.values,k,v.userSessionId));this.ds[v.V9]||(this.kr(v.V9),this.aq(v.V9,this.ackMessageHandler));this.bC[k]="";return this.nOa(v,k,1)}nOa(v,k,y){if(""!==k&&k in this.bC&&"ACK_RECEIVED"===this.bC[k])return delete this.bC[k],
!0;if(y>v.HP)return t.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',v.V9,k),delete this.bC[k],!1;t.a.sendTraceTag(40716251,1<y?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',v.HP-y,v.messageId,k);y++;window.setTimeout(()=>{this.nOa(v,k,y)},v.$md);v.values[x.a.Ymd]=!0;return this.send(this.nia(v.messageId,v.values,k,v.userSessionId))}nia(v,k,y,C){v=new m.a(v);v.CorrelationId=y;k&&(v.Values=k);v.Values.wdUserSession=
C;return v}Zia(v,k,y){t.a.debugAssertTag(5018269,!!v,null);if(!this.kv)return!1;t.a.debugAssertTag(5018270,!!k,null);t.a.debugAssertTag(5018271,!!y,null);if(!k||!y)return t.a.debugAssertTag(5018272,!1,null),!1;if(y===w.aM&&!this.UWb(v.MessageId))return t.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:v.MessageId}),!1;v.SendTime=(new Date).getTime();let C="";try{C=Sys.Serialization.JavaScriptSerializer.serialize(v)}catch(B){return t.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:B.message}),
!1}k=w.sendMessage(k,C,y);t.a.sendTraceTag(5018275,2,"Send {0}. {1}",k?"succeeded":"failed",{["id"]:v.MessageId,["origin"]:y});return k}aq(v,k){t.a.debugAssertTag(5018304,!!k,null);t.a.debugAssertTag(5018305,!!this.ds&&!!this.Bt,null);if(!this.kv)return!1;if(!this.pha(v))return t.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:v}),!1;this.ds[v]!==k&&(t.a.debugAssertTag(5018307,!this.ds[v]&&!this.Bt[v],null),this.ds[v]=k,delete this.Bt[v]);return!0}registerEventCallback(v,k){t.a.debugAssertTag(40420062,
!!k,null);t.a.debugAssertTag(40420063,!!this.Bt&&!!this.ds,null);if(!this.kv)return!1;if(!this.pha(v))return t.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:v}),!1;this.Bt[v]!==k&&(t.a.debugAssertTag(40420065,!this.ds[v]&&!this.Bt[v],null),this.Bt[v]=k,delete this.ds[v]);return!0}DT(v){this.kv&&(this.ds[v]&&delete this.ds[v],this.Bt[v]&&delete this.Bt[v])}gSb(v){const k=new Date;this.DZb(v);if(!v.origin||!v.source||void 0===v.data||null===v.data)return t.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),
null;const y=this.xYb(v.data);if(!y)return null;if(!this.cXb(v.origin)){if(!this.HLa(y.MessageId))return t.a.sendTraceTag(5018309,1,"{0}",{["id"]:y.MessageId}),null;if(!h.a.w6&&v.source!==this.HQa)return t.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}t.a.debugAssertTag(5018311,!!y.Values,null);y.Values.m_Source=v.source;y.Values.m_Origin=v.origin;y.Values.m_ReceivedTime=k.getTime();return y}xYb(v){if(!v)return null;let k=null;try{k=Sys.Serialization.JavaScriptSerializer.deserialize(v,
!0)}catch(B){return 2>w.ZDa&&(t.a.sendTraceTag(5018312,2,"Deser failed"),w.ZDa++),null}if(!k)return t.a.debugAssertTag(5018313,!1,null),null;for(v=0;v<w.j0.length;v++)if(!k[w.j0[v]])return"MessageId"!==w.j0[v]&&t.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",w.j0[v]),null;if(k.Values)try{k.Values}catch(B){return t.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",B.message),null}else t.a.sendTraceTag(41502556,2,"No values in message");v=k.MessageId;if(!this.pha(v))return t.a.sendTraceTag(5018315,
1,"Ignore recvd {0}",{["id"]:v}),null;const y=k.SendTime,C=(new Date).getTime()-y;if(0>y)return t.a.sendTraceTag(520435660,2,"{0}",{["t"]:y,["id"]:v}),null;6E4<C&&t.a.sendTraceTag(520435659,2,"{0}",{["t"]:y,["delta"]:C,["id"]:v});-300>C&&t.a.sendTraceTag(520435658,2,"{0}",{["t"]:y,["delta"]:C,["id"]:v});v=new m.a;v.MessageId=k.MessageId;v.SendTime=k.SendTime;v.CorrelationId=k.CorrelationId;k.Values&&(v.Values=k.Values);t.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",
v.MessageId,v.SendTime,v.CorrelationId);return v}DZb(v){t.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:v.origin,["data"]:v.data,["source"]:v.source}))}static sendMessage(v,k,y){if(!n.a())return t.a.debugAssertTag(5018319,!1,null),!1;try{return v.postMessage(k,y),!0}catch(C){t.a.sendTraceTag(5018320,4,"{0}",{["exception"]:C.message})}return!1}}w.j0=["MessageId","SendTime"];w.aM="*";w._id=0;w.ZDa=0;Object(A.a)(w,"CrossDocumentMessenger",null,[4,439])},943:function(A,u,a){a.d(u,
"a",function(){return r});A=a(0);var c=a(1),b=a(95),h=a(5);class r{static LUf(f){r.$=f;c.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void b.a.resolve(h.Cb).then(l=>{r.tk=l}):r.$.la.fi(291,l=>{r.tk=l})}static bxa(f,l){return f[Math.round((f.length-1)*l/100)]}static UM(f){return r.tk?r.tk.UM(f):!1}}r.tk=null;r.$=null;Object(A.a)(r,"SessionStatisticsManagerHelper",null,[])},957:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{static h7b(){}static ANb(){}}
c.sendTraceTag=c.h7b;c.debugAssertTag=c.ANb;Object(A.a)(c,"BULS",null,[])},958:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{constructor(b){this.MessageId=b;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(A.a)(c,"CrossDocumentMessage",null,[])},978:function(A,u,a){a.d(u,"a",function(){return c});const c=b=>{if(Object.keys)b=Object.keys(b);else{const h=[];for(const r in b)h.push(r);b=h}return b}}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/854397fdd25fbf1df67f1edde37504c3/EwaTS.tm.js.map