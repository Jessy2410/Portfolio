'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1156:function(A,u,a){function c(){return"undefined"===typeof h.globalThis.P6c?r:h.globalThis.P6c()}function b(f,l){var m;return null!==(m=c()[f])&&void 0!==m?m:l}Object.defineProperty(u,"__esModule",{value:!0});u.setFeatureGateDictionaryGetter=u.getIntFeatureGate=u.EJf=u.getBooleanFeatureGate=u.getStringFeatureGate=u.DRb=void 0;var h=a(1361),r={};u.DRb=c;u.getStringFeatureGate=b;u.getBooleanFeatureGate=function(f,
l){var m;f=null===(m=b(f))||void 0===m?void 0:m.trim().toLowerCase();return"true"===f?!0:"false"===f?!1:l};u.EJf=function(f,l){var m;f=null===(m=b(f))||void 0===m?void 0:m.trim().toLowerCase();if(void 0===f)return l;if("infinity"===f||"+infinity"===f)return Infinity;if("-infinity"===f)return-Infinity;m=parseFloat(f);return isNaN(m)?l:m};u.getIntFeatureGate=function(f,l){var m;f=null===(m=b(f))||void 0===m?void 0:m.trim();if(void 0===f)return l;m=parseInt(f,10);return isNaN(m)?l:m};u.setFeatureGateDictionaryGetter=
function(f){var l=h.globalThis.P6c;h.globalThis.P6c=f;return l}},1157:function(A,u,a){function c(){return"undefined"===typeof b.globalThis.O6c?{}:b.globalThis.O6c()}Object.defineProperty(u,"__esModule",{value:!0});u.setChangeGateDictionaryGetter=u.isChangeGateEnabled=u.cAc=void 0;var b=a(1361);u.cAc=c;u.isChangeGateEnabled=function(h){var r;return null!==(r=c()[h])&&void 0!==r?r:!0};u.setChangeGateDictionaryGetter=function(h){var r=b.globalThis.O6c;b.globalThis.O6c=h;return r}},1361:function(A,u,
a){Object.defineProperty(u,"__esModule",{value:!0});u.globalThis=void 0;A=a(1498);u.globalThis=A},1497:function(A,u,a){Object.defineProperty(u,"__esModule",{value:!0});var c=a(135);c.__exportStar(a(1156),u);c.__exportStar(a(1501),u);c.__exportStar(a(1157),u);c.__exportStar(a(1502),u);c.__exportStar(a(1503),u);c.__exportStar(a(1504),u)},1498:function(A,u,a){A.exports=a(1499)()?globalThis:a(1500)},1499:function(A){A.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===
Array:!1}},1500:function(A){function u(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}A.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(a){return u()}try{return __global__?__global__:u()}finally{delete Object.prototype.Hkl}}()},1501:function(A,u,a){Object.defineProperty(u,"__esModule",{value:!0});u.LDj=
void 0;var c=a(1156);u.LDj=function(b){return function(h){var r=b[h];switch(typeof r){case "boolean":return(0,c.getBooleanFeatureGate)(h,r);case "number":return(0,c.EJf)(h,r);case "string":return(0,c.getStringFeatureGate)(h,r);default:throw Error("Wrong defaultValue type");}}}},1502:function(A,u,a){Object.defineProperty(u,"__esModule",{value:!0});u.SDj=void 0;var c=a(1157);u.SDj=function(){return function(b){return(0,c.isChangeGateEnabled)(b)}}},1503:function(A,u,a){function c(r){var f=(0,h.setChangeGateDictionaryGetter)(void 0);
(0,h.setChangeGateDictionaryGetter)(function(){var l=void 0!==f?f():{};return b.__assign(b.__assign({},l),r)});return f}Object.defineProperty(u,"__esModule",{value:!0});u.D3j=u.v3j=void 0;var b=a(135),h=a(1157);u.v3j=c;u.D3j=function(r,f){return c(f)}},1504:function(A,u,a){function c(r){function f(){return{}}for(var l,m,x={},n=0,t=Object.keys(r);n<t.length;n++){var w=t[n];x[w]=null===(l=r[w])||void 0===l?void 0:l.toString()}var v=null!==(m=(0,h.setFeatureGateDictionaryGetter)(void 0))&&void 0!==m?
m:f;(0,h.setFeatureGateDictionaryGetter)(function(){return b.__assign(b.__assign({},v()),x)});return v}Object.defineProperty(u,"__esModule",{value:!0});u.E3j=u.A3j=void 0;var b=a(135),h=a(1156);u.A3j=c;u.E3j=function(r,f){return c(f)}},213:function(A,u,a){function c(tb){if(window&&window.performance&&window.performance.mark)try{window.performance.mark(tb)}catch(lc){}}function b(){return{show:{count:0,repairCounts:[]},hideDurations:{escape:[],ignore:[],selection:[],edit:[],commit:[],scroll:[]}}}a.r(u);
var h={};a.r(h);a.d(h,"AutoSumCommandHandler",function(){return oa});var r={};a.r(r);a.d(r,"CellImageToFloatingObjectController",function(){return nb});var f={};a.r(f);a.d(f,"ClearCommandHandler",function(){return ac});var l={};a.r(l);a.d(l,"ClearContentNotifier",function(){return bd});var m={};a.r(m);a.d(m,"DefinedNameManager",function(){return Ba});var x={};a.r(x);a.d(x,"FileCollectionOperation",function(){return dc});var n={};a.r(n);a.d(n,"FloatingObjectToCellImageController",function(){return vd});
var t={};a.r(t);a.d(t,"FontDropdownHelper",function(){return Zc});var w={};a.r(w);a.d(w,"FormatCellsCommandHandler",function(){return Hb});var v={};a.r(v);a.d(v,"FormulaAnonymizer",function(){return uc});var k={};a.r(k);var y={};a.r(y);a.d(y,"FormulaRepairTelemetry",function(){return Bc});var C={};a.r(C);a.d(C,"FreezePanesDragDirection",function(){return of});a.d(C,"FreezePaneDragOrigin",function(){return lf});a.d(C,"FreezePaneDragAction",function(){return jf});var B={};a.r(B);a.d(B,"FreezePanesCommandHandler",
function(){return pc});var E={};a.r(E);a.d(E,"HeaderInsert",function(){return rd});var K={};a.r(K);a.d(K,"ImageInCellCommandHandler",function(){return Ac});var F={};a.r(F);a.d(F,"NameManagerCommandHandler",function(){return Ie});var W={};a.r(W);a.d(W,"OfficePyUXCommandHandler",function(){return fd});var J=a(135),L=a(0),M=a(15),Q=a(261),H=a(233),ba=a(64);const U=(tb,lc,Tc,md,sd,Zd)=>{if(lc){const Ae=tb.Wa;tb.isEditing||tb.startEdit(lc,!0);tb.FYd=!0;tb.text=Tc;Ae.caretPosition=sd;sd<Zd&&(md&&tb.uQa(),
Ae.selectRange(0,Zd+1),Ae.selectRange(sd,Zd))}};var D=a(65);class I{constructor(tb,lc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=tb;this.type=lc}$lb(){return this.sharedSheetRange}}Object(L.a)(I,"MacroRecorderAutoSumPayload",null,[60]);var X=a(46),Y=a(427),ja=a(216),Ua=a(77),ka=a(39),fb=a(359),ha=a(36),ea=a(1),aa=a(211),ca=a(264),xa=a(23),Oa=a(143),ua=a(665),Ia=a(67),Sa=a(5),Ya=a(95),da=a(91),Ea=a(27);let oa=class extends H.a{constructor(tb){super();this.J2j={[-134268171]:"+",[406756244]:"-",
[1405397228]:"*",[-264074569]:"/"};this.ONj=lc=>{const Tc=xa.f(this.$);if(lc=lc.Result){let md=X.H(lc.NewSelection),sd=X.H(lc.NewActiveCell);if(md&&sd)if(!lc.Committed&&lc.AutoSumFormula){const Zd=Tc.zh(sd);Zd&&(Tc.ha.updateSelection(md,sd,60),md=sd=X.H(lc.MarkedArea),Tc.CM=2,U(Tc.cellTextEditBox,Zd,lc.AutoSumFormula,!!md,lc.FormulaMarkStart,lc.FormulaMarkEnd),md&&sd&&Tc.ha.updateSelection(md,sd,0),ka.TaskExtensions.Xa(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)?Object(da.d)(Ya.a.resolve(Sa.l,{va:0})):Ua.GetServiceTaskFactory.Tj(this.$.la,211,212,0),Ae=>{Ae.result.mca(Tc.cellTextEditBox.text)},this.$.ya,3),Tc.cellTextEditBox.FYd=!1,void Ya.a.resolve(Sa.Wc,{va:0}).then(Ae=>{Ae.Gjb(null)}))}else Tc.ha.updateSelection(md,sd,60)}};this.$=tb}Ri(){return!1}executeCommand(tb,lc,Tc){tb=lc.command;switch(tb){case 1220954656:case 505713221:lc=this.Iqf(0,lc);break;case -1537138325:lc=this.Iqf(parseInt(Tc[D.a.Qi].toString(),10),lc);break;case -134268171:case 406756244:case 1405397228:case -264074569:lc=
this.K1i(lc);break;default:lc=aa.a(tb)}return lc}Gi(tb,lc){if(tb=1===tb)switch(lc.command){case 1220954656:case 505713221:case -1537138325:break;case -134268171:case 406756244:case 1405397228:case -264074569:tb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BasicArithmeticOperations",!1);break;default:tb=!1}return tb}dj(){return!1}f4h(tb,lc){const Tc=tb.ha.qa.activeCell;var md=3<=Tc.top?1:-1;const sd=Ee=>new Ea.Range(Tc.top-Ee,Tc.left,Tc.bottom-Ee,Tc.right,!0,!0),[Zd,Ae]=[sd(md),sd(2*
md)];lc=`=${Ae} ${lc} `;md=tb.Fh;tb.startEdit(!0,1);md.text=`${lc}`;md.Wa.Rwb(lc.length);md.Wa.caretPosition=lc.length;tb.ha.updateSelection(Zd,Tc,60)}K1i(tb){const lc=xa.f(this.$),Tc=this.J2j[tb.command];return Tc?Q.a.Ua(Ya.a.resolve(Sa.Ec,{va:0}).then(()=>{this.f4h(lc,Tc);return!0}).catch(md=>{M.ULS.sendTraceTag(507381573,0,10,`AutoSumCommandHandler.handleArithmeticOperator: Error occurred while resolving FormulaAssistanceManagerService: ${md}`);return!1})):(M.ULS.sendTraceTag(507388317,0,10,`AutoSumCommandHandler.handleArithmeticOperator: Unhandled command ${tb.command}`),
Q.a.Ua(!1))}Iqf(tb,lc){const Tc=xa.f(this.$);Tc.co.uU(!1);if(!xa.f(this.$).ha.qa.Bn)return lc=xa.f(this.$).ha.qa.GS,M.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${tb} due to discontinuous selection. Number of selected ranges is ${lc}`),this.mOa(),Ia.Task.Ua(!1);const md=Tc.BK();if(!md)return null;const sd=X.x(Tc.ha.qa.jj,this.$),Zd=X.q(Tc.ha.qa.activeCell,this.$),Ae=X.q(md,this.$),Ee=this.$.pa.ta.Vh(),Ze=()=>new I(sd,tb);return this.$.uy(Tc.ha.qa.selectedRanges,
!0)?Y.a(this.$.userOperationManager,(Te,We,qf)=>{var bf=this.$.pa.ta;Te=ca.c(Te,this.ONj);const af=bf.$a(9,Ee);af.selectedRange=sd;af.activeCell=Zd;af.autoSumType=tb;af.topLeftCell=Ae;return ba.h(bf,"AutoSum",af,Te,We,qf,tb,0)},Te=>new ja.a(502,0,Te,64,Ze),lc):Ia.Task.Ua(!1)}mOa(){ua.a(Oa.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);const tb=ha.a.nj(1,1,751,2192,0,371863010,"DiscontinuousSelectionBlocking");new fb.a(this.$,tb)}};oa=Object(J.__decorate)([Object(Ya.d)(Sa.t),Object(J.__param)(0,
Object(Sa.Nb)())],oa);Object(L.a)(oa,"AutoSumCommandHandler",H.a,[34]);var za=a(78),la=a(773),Ca=a(181),Va=a(35),ia=a(922),wa=a(12),Jb=a(83),$a=a(126),Ka=a(139);let nb=class extends za.a{constructor(tb,lc,Tc,md){super();this.vj=()=>{this.button.getButton(this.da.fh.Lo(this.da.ha.qa.activeCell)).Ntb();Ca.a.sendTelemetryEvent({name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:$a.a.Rm({["buttonType"]:"CellImageToFloatingObject"})});const sd=new Jb.a(2000316912,D.a.rh,this.$.hi,9,null);this.$.Ma.qh(sd,
null)};this.tm=()=>{this.Nca()};this.nq=()=>{this.Nca()};this.QE=()=>{this.Nca()};this.Uy=()=>{this.Nca()};this.Cn=()=>{this.qY()};this.Vu=()=>{this.qY()};this.FA=()=>{this.Nca()};this.$=tb;this.button=Tc.GMb(tb,lc,this.vj,null,null,wa.a.instance.ia(2318),"CellImageToFloatingObjectPointerDown");this.isVisible=!1;this.da=xa.f(this.$);this.da.ha.wX(this.tm);this.da.Fh.mO(this.Cn);this.da.dA(this.QE);this.$.xI(this.nq);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&
this.$.ea.cK(this.FA);this.da.view.oz(this.Uy);this.da.ha.$e.nO(this.Vu);this.ariaLiveNotifier=md}dispose(){this.da&&(this.da.ha.vZ(this.tm),this.da.view.dy(this.Uy),this.da.$E(this.QE),this.da.ha.$e.VV(this.Vu),this.da.Fh&&this.da.Fh.uN(this.Cn));this.$&&(this.$.gL(this.nq),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.WH(this.FA));this.button.dispose();this.ariaLiveNotifier=this.$=this.da=this.button=null;super.dispose()}Umd(){this.isVisible&&this.vj(null,
null)}Nca(){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&!this.$.isEditMode)this.qY();else{ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8478102_HideOOUIOnFloatingObjectSelected")&&this.da.ha.$e.isFloatingObjectSelected&&this.qY();var tb=this.da.ha.qa.activeCell;if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){var lc=new Ka.a(this.$.sa);if(lc&&lc.wn&&(lc.F2f(tb,this.da)||!lc.Wj(1))){this.qY();return}}lc=this.da.za.Rx(tb);
null!=lc&&lc.i0a?this.Yqa(tb):this.qY()}}Yqa(tb){const lc=this.da.fh.Lo(tb);tb=this.da.yl(tb,lc);const Tc=this.da.sl(lc).Vr;var md=this.da.ha.qa.activeCell;if(!(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8352188_DisableInCellOOUIForFormulaBasedImage")&&md&&this.da.oh.AVb(md)&&this.da.oh.mVd(md)||ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8352225_DisableInCellOOUIForPivotTable")&&this.da.oh.EY(md)))if(1===this.da.ha.Ck&&tb&&tb.Xi(Tc)&&Tc.width>tb.width){md=tb.bottomRight.x+this.IE;let sd=tb.topLeft.y-
this.IE-this.button.buttonWidth;md+this.button.buttonWidth>Tc.bottomRight.x&&(md=tb.topLeft.x-this.IE-this.button.buttonWidth);sd<Tc.topLeft.y+this.IE&&(sd=Tc.topLeft.y+this.IE);this.fv(md,sd,this.da.rtl,lc)}else this.qY()}fv(tb,lc,Tc,md){this.button.M3c(ia.a.Hej,wa.a.instance.ia(2318),md);this.button.l3c(wa.a.instance.ia(2318),md);this.button.fv(tb,lc,Tc,md,!1,!0);this.isVisible=!0;this.tHh()}qY(){this.button.hide();this.isVisible=!1}tHh(){let tb;tb=Va.a.isMac?wa.a.instance.ia(2321):wa.a.instance.ia(2320);
this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.mca(tb)}get IE(){return this.button.IE}};nb=Object(J.__decorate)([Object(Ya.d)(Sa.N),Object(J.__param)(0,Object(Sa.Nb)()),Object(J.__param)(1,Object(la.i)()),Object(J.__param)(2,Object(Sa.Qf)()),Object(J.__param)(3,Object(Sa.l)())],nb);Object(L.a)(nb,"CellImageToFloatingObjectController",za.a,[]);var sa=a(189),na=a(245),ab=a(40),Ja=a(1290),Pa=a(254),hb=a(66);let ac=class extends ab.a{constructor(tb,lc,Tc,md){super();this.$=tb;this.Qj=lc;this.yk=
Tc;this.clearContentNotifier=md;this.aPj=(sd,Zd)=>{if(!Pa.a(sd)&&Zd){const Ae=!!sd&&!!sd.RequestTelemetryData;xa.f(this.$).Hk.D1(Zd.toString(),sd.StateId,Ae?sd.RequestTelemetryData.EcsOperationDuration:0,Ae?sd.RequestTelemetryData.EcsRequestDuration:0,Ae?sd.RequestTelemetryData.WfeRequestDuration:0)}}}Ri(){return!1}executeCommand(tb,lc){tb=lc.command;switch(tb){case -730106152:lc=this.rQd(lc,3);break;case -1228228458:lc=this.rQd(lc,4);break;case -848953656:case 2045211913:if(this.ppj()){lc=Ia.Task.Ua(!0);
break}lc=this.rQd(lc,1);break;default:lc=aa.a(tb)}return lc}Gi(tb,lc){if(tb=1===tb)switch(lc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:tb=!1}return tb}dj(){return!1}rQd(tb,lc){const Tc=xa.f(this.$),md=Tc.ha.qa.selectedRanges,sd=tb.command,Zd=sa.a.create().toString();if(!this.$.uy(md,!0)&&-730106152!==sd)return Ia.Task.Ua(!0);const Ae=X.t(md,this.$);this.OPk(sd,Tc,md,Zd);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&
this.clearContentNotifier.rck();const Ee=this.$.pa.ta.Vh({yza:!0,gya:1}),Ze=()=>new Ja.a(lc,Ae);return Y.a(this.$.userOperationManager,(Te,We,qf)=>{this.$.ZC();return ba.d(this.$.pa.ta,lc,Ae,!1,ca.c(Te,this.aPj),We,qf,Zd,Ee)},Te=>new ja.a(508,0,Te,67,Ze),tb)}OPk(tb,lc,Tc,md){if(-848953656!==tb&&2045211913!==tb&&-730106152!==tb&&-1228228458!==tb)M.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${tb}.`);else if(!na.a.any(Tc,Zd=>0<lc.getRangeInformation(Zd).length)){var sd=
na.a.any(Tc,Zd=>this.Qj.d_d(Zd));if(-730106152!==tb&&-1228228458!==tb||!sd)this.pUk(lc,tb,md,Tc),-730106152!==tb&&-1228228458!==tb||this.yk.$qa(lc,-730106152,{}),-1228228458!==tb&&2045211913!==tb&&-848953656!==tb||this.yk.pwd(Tc,!0,md),lc.Hk.rT(md,hb.BasicTelemetryCalculator.bS)}}pUk(tb,lc,Tc,md){let sd="";switch(lc){case -1228228458:sd="ClearAll";break;case 2045211913:case -848953656:sd="ClearContent";break;case -730106152:sd="ClearFormat";break;default:M.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${lc}.`)}lc=
md.length;md=X.b(md);tb.Hk.lQ(15,Tc,sd+(", ranges to clear: "+lc+", cells to clear: "+md))}ppj(){if(xa.f(this.$).ZF){const tb=this.$.la.kh(296);return!!tb&&tb.i5.PK}return!1}};ac=Object(J.__decorate)([Object(Ya.d)(Sa.W),Object(J.__param)(0,Object(Sa.Nb)()),Object(J.__param)(1,Object(Sa.vg)()),Object(J.__param)(2,Object(Sa.xc)()),Object(J.__param)(3,Object(Sa.X)())],ac);Object(L.a)(ac,"ClearCommandHandler",ab.a,[34]);var Hc=a(365);let bd=class extends ab.a{Vod(tb){this.addHandler("ekcvc",tb)}RUc(tb){this.removeHandler("ekcvc",
tb)}rck(){this.raiseEvent("ekcvc",new Hc.a)}};bd=Object(J.__decorate)([Object(Ya.d)(Sa.X)],bd);Object(L.a)(bd,"ClearContentNotifier",ab.a,[527]);var zc=a(124),oc=a(74),Nb;(function(tb){tb[tb.NameManagerListView=0]="NameManagerListView";tb[tb.NameManagerItemView=1]="NameManagerItemView";tb[tb.NameManagerMultiSelectView=2]="NameManagerMultiSelectView";tb[tb.NameManagerClosedView=3]="NameManagerClosedView";tb[tb.NameManagerErrorView=4]="NameManagerErrorView"})(Nb||(Nb={}));var Aa;(function(tb){tb[tb.Workbook=
0]="Workbook";tb[tb.Sheet=1]="Sheet"})(Aa||(Aa={}));var Ub;(function(tb){tb[tb.NameInput=0]="NameInput";tb[tb.ReferenceInput=1]="ReferenceInput";tb[tb.CommentInput=2]="CommentInput"})(Ub||(Ub={}));var Db;(function(tb){tb[tb.NamedRange=0]="NamedRange";tb[tb.Table=1]="Table";tb[tb.NamedFormula=2]="NamedFormula";tb[tb.NamedConstant=3]="NamedConstant";tb[tb.Lambda=4]="Lambda";tb[tb.TableSlicer=5]="TableSlicer";tb[tb.PrintArea=6]="PrintArea";tb[tb.Others=7]="Others"})(Db||(Db={}));var Ib;(function(tb){tb[tb.ASC=
0]="ASC";tb[tb.DESC=1]="DESC"})(Ib||(Ib={}));var yc;(function(tb){tb[tb.Default=0]="Default";tb[tb.Name=1]="Name";tb[tb.Scope=2]="Scope"})(yc||(yc={}));var xc;(function(tb){tb[tb.Workbook=0]="Workbook";tb[tb.Worksheets=1]="Worksheets";tb[tb.withErrors=2]="withErrors";tb[tb.withoutErrors=3]="withoutErrors";tb[tb.DefinedNames=4]="DefinedNames";tb[tb.TableNames=5]="TableNames"})(xc||(xc={}));class zb{}zb.rbl="utf-8";zb.SRi="GetOperationTimer";zb.vdi="DeleteOperationTimer";zb.Hal="UpsertOperationTimer";
zb.dci=[Db.NamedRange,Db.Table,Db.PrintArea,Db.Others];zb.XIj=[0];zb.yxk=[0,1];Object(L.a)(zb,"ConstantsDefinedNameManager",null,[]);class vb extends Sys.EventArgs{constructor(tb,lc,Tc,md){md=void 0===md?!1:md;super();this.status=tb;this.operationType=lc;this.Jwb=Tc;this.bnj=md}}Object(L.a)(vb,"DefinedNameOperationEventArgs",Sys.EventArgs,[]);var bb=a(61);class La{static create(tb){const lc=new La;Object.assign(lc,tb);return bb.a.Ci(lc)}}Object(L.a)(La,"NameManagerTelemetryData",null,[]);class pb{static OE(tb,
lc){(tb||lc)&&M.ULS.sendTraceTag(507581128,0,tb,lc)}static Bna(tb){switch(tb){case "success":return 50;case "successWithServerException":case "failure":return 10}}}Object(L.a)(pb,"NameManagerTelemetry",null,[]);var fa=a(28);const kb={namedrange:Db.NamedRange,table:Db.Table,others:Db.Others,print_area:Db.PrintArea},db={global:0,local:1},gb=[1546370075,472177316,-1818810228,-201732986],Kb={[0]:tb=>0===tb.scope,[1]:tb=>1===tb.scope,[2]:tb=>tb.isInvalidReference,[3]:tb=>!tb.isInvalidReference,[4]:tb=>
tb.type===Db.NamedRange,[5]:tb=>tb.type===Db.Table},ub=(tb,lc,Tc,md,sd)=>{tb=Object.assign({},{method:`NameManagerUtils.${Tc}`,executionTime:lc-tb},md&&{input_length:md},sd&&{output_length:sd});M.ULS.sendTraceTag(507581578,0,50,bb.a.Ci(tb))};class lb{static S6i(tb,lc,Tc,md,sd){return void 0===md&&0!==(null===tb||void 0===tb?void 0:tb.length)&&0!==(null===lc||void 0===lc?void 0:lc.length)?!0:md&&tb&&lc&&sd?(sd=sd.find(Zd=>Zd.runtimeUid===md))?(null===sd||void 0===sd?void 0:sd.name)!==tb||(null===sd||
void 0===sd?void 0:sd.reference)!==lc||(null===sd||void 0===sd?void 0:sd.comment)!==Tc:!1:!1}static IQi(tb){return void 0!==tb?kb[tb.toLowerCase()]:null}static NVi(tb){return void 0!==tb?db[tb.toLowerCase()]:null}static search(tb,lc){if(!tb||0===tb.length||!lc)return tb;const Tc=performance.now(),md=tb.filter(Zd=>Zd.name.toLowerCase().includes(lc.toLowerCase().trim())),sd=performance.now();ub(Tc,sd,"search",tb.length,md.length);return md}static HJi(tb,lc){return null!==tb&&void 0!==tb&&tb.length&&
null!==lc&&void 0!==lc&&0!==lc.length?tb.find(Tc=>Tc.runtimeUid===lc):null}static YNi(tb,lc){return null!==tb&&void 0!==tb&&tb.length&&null!==lc&&void 0!==lc&&0!==lc.length?tb.findIndex(Tc=>Tc.metadata.runtimeUid===lc):-1}static CZc(tb){return tb?gb.includes(tb):!1}static dLi(tb){if(!tb||!tb.Jwb||tb.status)return null;const lc=[];let Tc;if(lb.CZc(tb.Jwb))switch(null===tb||void 0===tb?void 0:tb.Jwb){case 472177316:lc.push({target:1,errorMessage:wa.a.instance.Ea(912)});break;case 1546370075:lc.push({target:0,
errorMessage:wa.a.instance.Ea(911)});break;case -1818810228:Tc=wa.a.instance.Ea(1008);break;default:Tc=lb.UFf(tb.operationType)}return{Xdg:lc,U$b:Tc}}static UFf(tb){if(tb)switch(tb){case "add":return wa.a.instance.Ea(905);case "update":return wa.a.instance.Ea(906);case "delete":return wa.a.instance.Ea(907)}return null}static Xcl(tb,lc,Tc,md,sd){const Zd=[];let Ae;sd!==Db.Table&&(Ae=lb.nUh(Tc,tb));tb=lb.lUh(md);lc=lb.mUh(lc);Ae&&Zd.push(Ae);tb&&Zd.push(tb);lc&&Zd.push(lc);return Zd}static wOd(tb){return tb&&
1===tb.length?tb[0].MessageId:null}static mUh(tb){let lc;var Tc;if(!(Tc=!tb||0===(null===tb||void 0===tb?void 0:tb.length)||255<(null===tb||void 0===tb?void 0:tb.length))){a:{for(Tc=0;Tc<tb.length;Tc++){const md=tb.charAt(Tc),sd=tb.charCodeAt(Tc);if(!Tc){if("\\"!==md&&"_"!==md&&!fa.a.isLetter(sd)){Tc=!1;break a}}else if("_"!==md&&"."!==md&&!fa.a.c0f(sd)&&!fa.a.isNumeral(sd)){Tc=!1;break a}}Tc=!0}Tc=!Tc}if(Tc||fa.a.bI(tb,"_xl"))lc=wa.a.instance.Ea(910);return lc?{target:0,errorMessage:lc}:null}static lUh(tb){let lc;
255<(null===tb||void 0===tb?void 0:tb.length)&&(lc=wa.a.instance.Ea(914));return lc?{target:2,errorMessage:lc}:null}static nUh(tb,lc){if(tb&&0===tb.length)tb=wa.a.instance.Ea(912);else switch(lc(tb)){case "valid":return null;case "notFormulaString":tb=wa.a.instance.Ea(913);break;default:tb=wa.a.instance.Ea(912)}return{target:1,errorMessage:tb}}static filterBy(tb,lc){if(!tb||0===tb.length||void 0===lc)return tb;const Tc=performance.now();lc=tb.filter(Kb[lc]);const md=performance.now();ub(Tc,md,"filterBy",
tb.length,lc.length);return lc}static B3h(tb){const lc={[0]:0,[1]:0,[2]:0,[3]:0,[4]:0,[5]:0};if(!tb||0===tb.length)return lc;const Tc=performance.now();for(var md of tb)for(const sd in Kb)Kb[sd](md)&&lc[sd]++;md=performance.now();ub(Tc,md,"countByFilter",tb.length);return lc}static groupBy(tb,lc,Tc){const md={};lc.forEach(sd=>{md[sd]=[]});for(const sd of tb)tb=Tc(sd),md[tb].push(sd);return md}static kNi(tb){switch(tb){case 0:return{jQd:zb.dci,kQd:lc=>lc.type};case 1:return{jQd:zb.XIj,kQd:()=>0};case 2:return{jQd:zb.yxk,
kQd:lc=>lc.scope}}}static sort(tb,lc){switch(lc){case 0:return tb.sort((Tc,md)=>Tc.name.localeCompare(md.name));case 1:return tb.sort((Tc,md)=>md.name.localeCompare(Tc.name))}}static iQd(tb,lc,Tc){if(!tb||0===tb.length||void 0===lc||void 0===Tc)return tb;const md=performance.now(),{jQd:sd,kQd:Zd}=lb.kNi(lc),Ae=lb.groupBy(tb,sd,Zd),Ee=[];sd.forEach(Ze=>{Ee.push(...lb.sort(Ae[Ze],Tc))});lc=performance.now();ub(md,lc,"groupAndSortBy",tb.length,Ee.length);return Ee}static C3h(tb){if(!tb)return null;const lc=
{};tb.forEach(Tc=>{const md=Tc.scope;Tc=Tc.metadata.type;lc[md]||(lc[md]={});lc[md][Tc]||(lc[md][Tc]=0);lc[md][Tc]++});return lc}}Object(L.a)(lb,"NameManagerUtils",null,[]);let Ba=class{constructor(tb,lc){this.eh=new ab.a;this.stateId=0;this.$Dh=Tc=>{this.eh.addHandler("dnek",Tc)};this.N_d=Tc=>this.Sj.N_d(Tc);this.Dl=()=>{var Tc;const md=null===(Tc=this.$.ea.Qq)||void 0===Tc?void 0:Tc.NamedManagerResponseStateId;md>this.stateId&&(this.stateId=md,M.ULS.sendTraceTag(507639444,0,50,"DefinedNameManager.OnWorkbookMetadataChanged : Received a stateId change and Invoked GetDefinedNames API"),
this.vvg(!0))};this.vvg=Tc=>{this.mKa=this.$.Eh.Li("WebServiceCall",zb.SRi);const md=Zd=>{this.k2i(Zd,Tc)},sd=Zd=>{var Ae,Ee;null===(Ae=this.mKa)||void 0===Ae?void 0:Ae.stop();Zd=zc.a.gk(Zd.data);Zd=ha.a.Yh(Zd);Ae=La.create({operationType:"get",status:"failure",executionTime:null===(Ee=this.mKa)||void 0===Ee?void 0:Ee.zi,error:Zd});pb.OE(pb.Bna("failure"),Ae);this.xYa=null;this.raiseEvent("dnek",new vb(!1,"get",null,Tc))};Y.a(this.$.userOperationManager,(Zd,Ae,Ee)=>{var Ze=this.$.pa.ta;Zd=ca.c(Zd,
md);Ae=ca.b(Ae,sd);var Te=this.$;const We=Ze.$a(1,null);return ba.h(Ze,"GetDefinedNames",We,Zd,Ae,Ee,Te,0)},Zd=>new ja.a(1037,0,Zd,16),null)};this.raiseEvent=(Tc,md)=>{this.eh.raiseEvent(Tc,md)};this.upsertDefinedName=(Tc,md,sd,Zd,Ae)=>{var Ee;this.Vzb=this.$.Eh.Li("WebServiceCall",zb.Hal);const Ze=lb.YNi(null===(Ee=this.xYa)||void 0===Ee?void 0:Ee.nameManagerItems,Zd),Te=bf=>{this.K5i(bf,Ze,Ae)},We=bf=>{var af,Nf;null===(af=this.Vzb)||void 0===af?void 0:af.stop();bf=zc.a.gk(bf.data);bf=ha.a.Yh(bf);
af=La.create({operationType:-1!==Ze?"update":"add",status:"failure",executionTime:null===(Nf=this.Vzb)||void 0===Nf?void 0:Nf.zi,error:bf,type:Ae});pb.OE(pb.Bna("failure"),af);this.raiseEvent("dnuek",new vb(!1,-1!==Ze?"update":"add",null))},qf={Name:Tc,Reference:md,SheetName:"",Comment:sd,Type:Ae,RuntimeUid:Zd};Y.a(this.$.userOperationManager,(bf,af,Nf)=>{var uf=this.$.pa.ta;bf=ca.c(bf,Te);af=ca.b(af,We);var pf=this.$;const ff=uf.$a(9,null);ff.definedNameRequest=qf;return ba.h(uf,"UpsertDefinedName",
ff,bf,af,Nf,pf,0)},bf=>new ja.a(1035,0,bf),null)};this.$=tb;this.Sj=lc}aFh(tb){this.eh.addHandler("dnuek",tb)}YBh(tb){this.eh.addHandler("dndok",tb)}Vnk(tb){this.eh.removeHandler("dnek",tb)}Vok(tb){this.eh.removeHandler("dnuek",tb)}mmk(tb){this.eh.removeHandler("dndok",tb)}pz(){var tb;this.$.ea.pz(this.Dl);this.$.ea.Qq&&(this.stateId=null===(tb=this.$.ea.Qq)||void 0===tb?void 0:tb.NamedManagerResponseStateId)}LA(){this.$.ea.LA(this.Dl)}k2i(tb,lc){var Tc,md,sd,Zd,Ae,Ee,Ze,Te,We;let qf=!1,bf;try{if(tb&&
!Pa.a(tb)){const af=new Uint8Array(tb.Result),Nf=(new TextDecoder(zb.rbl)).decode(af.buffer);this.xYa=JSON.parse(Nf);null===(Tc=this.mKa)||void 0===Tc?void 0:Tc.stop();qf=!0;const uf=La.create({operationType:"get",status:"success",executionTime:null===(md=this.mKa)||void 0===md?void 0:md.zi,count:null===(Zd=null===(sd=this.xYa)||void 0===sd?void 0:sd.nameManagerItems)||void 0===Zd?void 0:Zd.length,metadata:lb.C3h(null===(Ae=this.xYa)||void 0===Ae?void 0:Ae.nameManagerItems)});pb.OE(pb.Bna("success"),
uf)}else{null===(Ee=this.mKa)||void 0===Ee?void 0:Ee.stop();bf=lb.wOd(null===tb||void 0===tb?void 0:tb.Errors);this.xYa=null;const af=La.create({operationType:"get",status:"successWithServerException",executionTime:null===(Ze=this.mKa)||void 0===Ze?void 0:Ze.zi,serverMessageId:bf.toString()});pb.OE(pb.Bna("successWithServerException"),af)}}catch(af){this.xYa=null,null===(Te=this.mKa)||void 0===Te?void 0:Te.stop(),tb=La.create({operationType:"get",status:"failure",executionTime:null===(We=this.mKa)||
void 0===We?void 0:We.zi,error:"JsonParsingError"}),pb.OE(pb.Bna("failure"),tb)}this.raiseEvent("dnek",new vb(qf,"get",bf,lc))}Kuc(tb){this.Jib=this.$.Eh.Li("WebServiceCall",zb.vdi);const lc=md=>{this.l2i(md,tb)},Tc=md=>{var sd,Zd;null===(sd=this.Jib)||void 0===sd?void 0:sd.stop();md=zc.a.gk(md.data);md=ha.a.Yh(md);sd=La.create({operationType:"delete",status:"failure",executionTime:null===(Zd=this.Jib)||void 0===Zd?void 0:Zd.zi,error:md});pb.OE(pb.Bna("failure"),sd);this.raiseEvent("dndok",new vb(!1,
"delete",null))};Y.a(this.$.userOperationManager,(md,sd,Zd)=>{var Ae=this.$.pa.ta;md=ca.c(md,lc);sd=ca.b(sd,Tc);var Ee=this.$;const Ze=Ae.$a(9,null);Ze.definedNameIds=tb;return ba.h(Ae,"DeleteDefinedNames",Ze,md,sd,Zd,Ee,0)},md=>new ja.a(1036,0,md),null)}l2i(tb,lc){var Tc,md,sd;let Zd=!1,Ae;if(tb&&!Pa.a(tb)&&lc){Zd=!0;null===(Tc=this.Jib)||void 0===Tc?void 0:Tc.stop();var Ee=La.create({operationType:"delete",status:"success",executionTime:null===(md=this.Jib)||void 0===md?void 0:md.zi,countOfNamesDeleted:lc.length});
pb.OE(pb.Bna("success"),Ee)}else Ae=lb.wOd(null===tb||void 0===tb?void 0:tb.Errors),null===(sd=this.Jib)||void 0===sd?void 0:sd.stop(),lb.CZc(Ae)&&oc.a(this.$).xj.YL(Ae),md=La.create({operationType:"delete",status:"successWithServerException",executionTime:null===(Ee=this.Jib)||void 0===Ee?void 0:Ee.zi,serverMessageId:Ae.toString(),countOfNamesDeleted:lc.length}),pb.OE(pb.Bna("successWithServerException"),md);this.raiseEvent("dndok",new vb(Zd,"delete",Ae))}K5i(tb,lc,Tc){var md,sd,Zd;let Ae=!1,Ee;
if(tb&&!Pa.a(tb)){Ae=!0;null===(md=this.Vzb)||void 0===md?void 0:md.stop();var Ze=La.create({operationType:-1!==lc?"update":"add",status:"success",executionTime:null===(sd=this.Vzb)||void 0===sd?void 0:sd.zi,type:Tc});pb.OE(pb.Bna("success"),Ze)}else null===(Zd=this.Vzb)||void 0===Zd?void 0:Zd.stop(),Ee=lb.wOd(null===tb||void 0===tb?void 0:tb.Errors),lb.CZc(Ee)&&oc.a(this.$).xj.YL(Ee),Tc=La.create({operationType:-1!==lc?"update":"add",status:"successWithServerException",type:Tc,executionTime:null===
(Ze=this.Vzb)||void 0===Ze?void 0:Ze.zi,serverMessageId:Ee.toString()}),pb.OE(pb.Bna("successWithServerException"),Tc);this.raiseEvent("dnuek",new vb(Ae,-1!==lc?"update":"add",Ee))}};Ba=Object(J.__decorate)([Object(Ya.d)(Sa.zb),Object(J.__param)(0,Object(Sa.Nb)()),Object(J.__param)(1,Object(Sa.E)())],Ba);Object(L.a)(Ba,"DefinedNameManager",null,[526]);var ra=a(6),wb=a(136),mc=a(53),xb=a(13),Ec=a(240);class ed{}ed.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(L.a)(ed,"FileUploadDialogHTML",null,[]);var jd=a(169),Xd=a(26),Td=a(22);class gc extends Ec.a{constructor(tb){super(!1,!1,gc.R2);this.r4d=!1;this.Yag=!0;this.bag=0;this.Hwj=(lc,Tc)=>{const md=Tc[gc.pud]||"";let sd=!0;void 0!==Tc[gc.Kpc]&&null!==Tc[gc.Kpc]&&(sd=Tc[gc.Kpc]);this.zD(lc,md,sd)};this.bge=(lc,Tc)=>{this.zD(lc,Tc.text||"",Tc.reportErrorChecked)};this.dYj=lc=>{ra.AFrameworkApplication.yh.ek(Xd.a.K3b,2,lc)};this.Ph=1;this.ti(1,Object(Td.a)("Send"));this.ti(0,Object(Td.a)("NoThanks"));
this.lp=ed.HTML;this.T$f=tb;this.kl=gc.kRh}Ip(tb,lc,Tc,md,sd){sd=void 0===sd?!0:sd;this.r4d=void 0===md?!1:md;this.WOk(lc);this.bag=tb;sd&&ra.AFrameworkApplication.YC(tb)}WOk(tb){if(gc.R2)this.SQk(tb);else{var lc={};lc[gc.gRh]=tb;lc[gc.mRh]=Object(Td.a)("SendFileErrorReportMessage");lc[gc.nRh]=Object(Td.a)("SendFileErrorReportTextCaption");lc[gc.pud]="";lc[gc.jRh]=Object(Td.a)("UserReportLinkText");lc[gc.Kpc]=!0;this.initializeAndShow(Object(Td.a)("DefaultDialogTitle"),this.Hwj,lc);this.eja(gc.tRh)}}SQk(tb){tb=
{["id"]:this.kl,["bodyControls"]:{["reportErrorCheckboxProps"]:this.r4d?{["label"]:Object(Td.a)("UserReportLinkText")}:null,["textAreaProps"]:this.Yag?{}:null,["privacyStatementLinkProps"]:{["text"]:Object(Td.a)("PrivacyStatement"),["handler"]:{["href"]:ra.AFrameworkApplication.privacyUrl,["target"]:"_blank"}}},["errorMessage"]:tb,["errorReportMessage"]:Object(Td.a)("SendFileErrorReportMessage"),["errorTextPrompt"]:Object(Td.a)("SendFileErrorReportTextCaption")};this.initializeAndShow(Object(Td.a)("DefaultDialogTitle"),
this.bge,tb)}yPc(){if(!gc.R2){var tb=document.getElementById(gc.pRh);tb&&(tb.className=gc.oRh,tb.appendChild(jd.a(32,32,gc.lRh,null,!0,Object(Td.a)("DialogError"))));if(tb=document.getElementById(gc.rRh))tb.innerText=Object(Td.a)("PrivacyStatement"),tb.href=ra.AFrameworkApplication.privacyUrl,mc.a.addHandler(tb,"click",this.dYj);this.Yag||(tb=document.getElementById(gc.pud))&&tb.parentNode&&tb.parentNode.removeChild(tb);this.r4d||(tb=document.getElementById(gc.iRh))&&tb.parentNode&&tb.parentNode.removeChild(tb)}}oT(){gc.R2||
(super.oT(),document.getElementById(this.ip("WACDialogPanel")).style.width=String.format("{0}px",400))}zD(tb,lc,Tc){this.T$f&&(Tc&&M.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.bag),this.T$f(tb,lc,Tc))}get afa(){return!1}static get R2(){return ra.AFrameworkApplication.ra.$g.$M&&ra.AFrameworkApplication.ra.$g.Qpj}}gc.gRh="WACDialogErrorMessage";gc.mRh="WACDialogErrorReportMessage";gc.nRh="WACDialogErrorTextPrompt";gc.pud="WACDialogInput";gc.rRh="WACDialogPrivacyText";
gc.pRh="WACDialogIconPanel";gc.lRh="CancelRequest_32x32x32";gc.oRh="WACDialogIcon";gc.tRh="WACDialogTextPanel";gc.Kpc="WACDialogSendFileCheckbox";gc.iRh="WACDialogSendFileCheckboxContainer";gc.jRh="WACDialogSendFileCheckboxText";gc.kRh="FileUploadErrorDialog";Object(L.a)(gc,"FileUploadErrorDialog",Ec.a,[]);var nc;let dc=nc=class extends ab.a{constructor(tb){super();this.$=tb;this.jxg=0;this.EM=null;this.tkk=lc=>{this.$lk(lc)};this.dZh=(lc,Tc)=>{if(1===lc&&this.EM.FileCollectionErrorStateId){lc=this.$.pa.ta;
var md=this.EM.MessageId,sd=this.EM.OriginalEcsServerId,Zd=this.EM.FileCollectionErrorStateId;const Ae=lc.$a(0);Ae.errorMessageId=md;Ae.ecsServerId=sd;Ae.fileCollectionErrorStateId=Zd;Ae.userComment=Tc;lc.Cud("CollectFile",Ae,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)}}KBh(tb){this.addHandler("fileCollectionComplete",tb)}$lk(tb){this.removeHandler("fileCollectionComplete",tb)}cZh(tb,lc,Tc){this.jxg=lc;this.EM=tb;this.KBh(Tc);ra.AFrameworkApplication.privacyUrl=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;
tb=new gc(this.dZh);ra.AFrameworkApplication.yh.Uh(Xd.a.K3b,wb.a.frame,nc.M$j);tb.Ip(0,"",null,!1,!1)}static M$j(tb,lc,Tc,md,sd){mc.a.jB(sd);ra.AFrameworkApplication.privacyUrl&&xb.HelperMethods.Cm(ra.AFrameworkApplication.privacyUrl,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}};dc=nc=Object(J.__decorate)([Object(Ya.d)(Sa.gc),Object(J.__param)(0,Object(Sa.Nb)()),Object(J.__param)(1,Object(Sa.cb)())],dc);Object(L.a)(dc,"FileCollectionOperation",ab.a,[529,4]);var Gc=a(71);let vd=class extends za.a{constructor(tb,
lc,Tc,md){super();this.vl=null;this.vj=()=>{this.button.getButton(this.vl.xm.paneType).Ntb();Ca.a.sendTelemetryEvent({name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:$a.a.Rm({["buttonType"]:"FloatingObjectToCellImage"})});const sd=new Jb.a(-700002548,D.a.rh,this.$.hi,9,null);this.$.Ma.qh(sd,null)};this.QE=()=>{this.Nca()};this.Fjg=()=>{this.Dyb()};this.rQc=()=>{this.Dyb()};this.wQc=()=>{this.Dyb()};this.Amg=()=>{this.Dyb()};this.p1b=()=>{this.Dyb()};this.Cmg=()=>{this.Dyb()};this.nq=
()=>{this.Nca()};this.Uy=()=>{this.Nca()};this.Vu=()=>{this.Nca()};this.FA=()=>{this.Nca()};this.$=tb;this.isVisible=!1;this.button=Tc.GMb(tb,lc,this.vj,null,null,wa.a.instance.ia(2319),"FloatingObjectToCellImagePointerDown");this.da=xa.f(this.$);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")&&this.da.dA(this.QE);this.$.xI(this.nq);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.cK(this.FA);this.da.view.oz(this.Uy);
this.da.ha.$e.nO(this.Vu);this.ariaLiveNotifier=md}dispose(){this.da&&(this.da.view.dy(this.Uy),this.da.ha.$e.VV(this.Vu));this.$&&(this.$.gL(this.nq),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.WH(this.FA));this.button.dispose();this.$=this.da=this.button=null;super.dispose()}Umd(){this.isVisible&&this.vj(null,null)}Nca(){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&!this.$.isEditMode)this.qY();else{var tb=
this.da.ha.$e;if(tb.isFloatingObjectSelected&&1===tb.Lh.floatingObject.type){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){const lc=new Ka.a(this.$.sa);if(lc&&lc.wn){this.qY();return}}null!==this.vl&&this.VDg(this.vl);this.vl=tb.Lh;this.Yqa()}else this.qY()}}Yqa(){const tb=this.vl.xm.Vr,lc=this.vl.floatingObject;this.byh(this.vl);let Tc=lc.D_+this.Fpc,md=lc.dB,sd=0;var Zd=0;switch(this.vl.xm.paneType){case 3:sd=this.da.fh.$z;Zd=this.da.fh.dB-this.da.Jw.y;
break;case 4:sd=this.da.fh.$z-this.da.Jw.x;Zd=this.da.fh.dB;break;case 1:sd=this.da.fh.$z;Zd=this.da.fh.dB;break;case 2:sd=this.da.fh.$z-this.da.Jw.x,Zd=this.da.fh.dB-this.da.Jw.y}Tc-=sd;md-=Zd;Zd=new Gc.a(lc.$z-sd,md,lc.width,lc.height);Tc+this.button.buttonWidth>tb.bottomRight.x&&(Tc=lc.$z-sd-this.Fpc-this.button.buttonWidth);md<tb.topLeft.y+this.Fpc&&(md=tb.topLeft.y+this.Fpc);4===this.da.ha.Ck&&tb.Xi(Zd)&&tb.width>lc.width?this.fv(Tc,md,this.da.rtl,this.vl.xm.paneType,!0):this.qY()}fv(tb,lc,Tc,
md,sd){ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")||this.da.dA(this.QE);this.button.M3c(ia.a.n6j,wa.a.instance.ia(2319),md);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8352230_UpdateDivTitleForSVGLaunchButtonOOUI")&&this.button.l3c(wa.a.instance.ia(2319),md);this.button.fv(tb,lc,Tc,md,!1,sd);this.isVisible=!0;this.sHh()}qY(){this.da.$E(this.QE);null!==this.vl&&(this.VDg(this.vl),this.vl=null);this.button.hide();this.isVisible=!1}Dyb(){this.button.hide();
this.isVisible=!1}sHh(){let tb;tb=Va.a.isMac?wa.a.instance.ia(2323):wa.a.instance.ia(2322);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.mca(tb)}get Fpc(){return this.button.MKb}byh(tb){var lc,Tc,md,sd,Zd,Ae;if(tb=tb.extension)null===(lc=tb.W$)||void 0===lc?void 0:lc.b4e(this.Fjg),null===(Tc=tb.Mvb)||void 0===Tc?void 0:Tc.Qpd(this.rQc),null===(md=tb.TJg)||void 0===md?void 0:md.uEh(this.wQc),null===(sd=tb.yP)||void 0===sd?void 0:sd.upd(this.p1b),null===(Zd=tb.yP)||void 0===Zd?void 0:Zd.YCh(this.Amg),
null===(Ae=tb.yP)||void 0===Ae?void 0:Ae.aDh(this.Cmg)}VDg(tb){var lc,Tc,md,sd,Zd,Ae;if(tb=tb.extension)null===(lc=tb.W$)||void 0===lc?void 0:lc.fFg(this.Fjg),null===(Tc=tb.Mvb)||void 0===Tc?void 0:Tc.LFg(this.rQc),null===(md=tb.TJg)||void 0===md?void 0:md.nok(this.wQc),null===(sd=tb.yP)||void 0===sd?void 0:sd.eje(this.p1b),null===(Zd=tb.yP)||void 0===Zd?void 0:Zd.enk(this.Amg),null===(Ae=tb.yP)||void 0===Ae?void 0:Ae.hnk(this.Cmg)}};vd=Object(J.__decorate)([Object(Ya.d)(Sa.tc),Object(J.__param)(0,
Object(Sa.Nb)()),Object(J.__param)(1,Object(la.i)()),Object(J.__param)(2,Object(Sa.Qf)()),Object(J.__param)(3,Object(Sa.l)())],vd);Object(L.a)(vd,"FloatingObjectToCellImageController",za.a,[]);var zd=a(488),Yb=a(432),Pb=a(33),$c=a(627),wd=a(592),Bd=a(1289);a(227);var tc=a(25);Object(Ya.b)(Sa.vc,{Fk:"singleton"})(tb=>Lo(function*(){const lc=yield Ya.a.resolve(Sa.Nb,tb),Tc=tc.a.el()?yield Ya.a.resolve(Sa.wc,tb):null;return new Zc(lc,Tc)}));class Zc{constructor(tb,lc){this.$=tb;this.oA=lc;this.menuId=
this.gud=this.Vca=this.Lwa=null;this.pId=0;this.QGj="+mn-lt";this.zDj="+mj-lt";this.lQc=Tc=>{this.kXb=!0;this.$.P5(md=>{md.Rtb("FontName_New")});M.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Tc}`)};this.Chj=!!String.fromCodePoint&&!Va.a.yA&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.kXb=!1;this.da=xa.f(this.$);this.el=tc.a.el();this.H0f=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1);this.el&&this.oA&&(this.oA.ilj?
this.MOg():this.oA.bBc(()=>{this.MOg()}))}get Ow(){this.MG||(this.MG=Ya.a.nh(Sa.Dg));return this.MG}MOg(){this.Vca=this.oA.FZg;this.Lwa=this.oA.azi;this.pId=2;this.kXb=this.oA.kXb}get FZg(){return this.Vca}UCf(tb,lc,Tc,md){md=void 0===md?null:md;const sd=Object.assign(new zd.a,{Id:"FontDropdownMenu"});sd.MenuSectionList=[];this.Ow&&(this.Ow.$Ia(md),md=Object.assign(new Yb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:wa.a.instance.ia(1337),ControlList:this.MYi(tb,lc,Tc)}),sd.MenuSectionList.push(md));
md=Object.assign(new Yb.a,{ControlsId:"FontsMenuSectionControl"});md.Title=wa.a.instance.ia(1338);md.ControlList=this.nMi(tb,lc,Tc);sd.MenuSectionList.push(md);return sd}MYi(tb,lc,Tc){var md;const sd=[];var Zd=this.da.ha.$e.Lh;Zd=5===(null===(md=null===Zd||void 0===Zd?void 0:Zd.floatingObject)||void 0===md?void 0:md.type);let Ae,Ee;this.Ow.dz?(Ae=this.Ow.dz.c6d,Ee=this.Ow.dz.N4d):M.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(md=this.Bmf(Ee,1,Zd,tb,lc,Tc))&&sd.push(md);(tb=this.Bmf(Ae,
2,Zd,tb,lc,Tc))&&sd.push(tb);return sd}Bmf(tb,lc,Tc,md,sd,Zd){var Ae=2===lc?this.QGj:this.zDj;let Ee;tb?(Tc=Tc?Ae:Pb.a.qm(tb),Ae=Pb.a.qm(xb.HelperMethods.KSb(tb,lc)),Ee=Pb.a.qm(tb)):(Tc=Tc?Ae:void 0,Ae=Pb.a.qm(String.fromCodePoint(0)),Ee="msofp");return Object.assign(new $c.a,{MenuItemId:2===lc?Bd.b:Bd.a,CommandValueId:Tc,LabelText:Ae,LabelCss:String.format("font-size:12pt;font-family:{0};",Ee),Styles:Zc.qSb(Ee),AriaLabel:Ae,Alt:Ae,Command:md.toString(),CommandPreviewId:sd.toString(),CommandRevertId:Zd.toString(),
Disabled:!tb})}nMi(tb,lc,Tc){if(this.gud)return this.gud.gBd;let md;const sd=xb.HelperMethods.jN(()=>{const Zd=this.Chj&&!this.kXb;let Ae=!1;this.Lwa||(this.iVf(),Ae=!0,M.ULS.sendTraceTag(509654348,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: fontCodepointMap is Null. Initialize with old Font Dictionary."));md=this.Wkf(tb,lc,Tc,this.Lwa,Zd,Ae);md.BZc&&!Ae&&(M.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),
this.iVf(),md=this.Wkf(tb,lc,Tc,this.Lwa,Zd,md.BZc));this.el&&!md.BZc&&(this.gud=md);Zd&&!this.el&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.lQc)});10<sd&&M.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${sd}`);return md.gBd}Wkf(tb,lc,Tc,md,sd,Zd){const Ae=[];let Ee;const Ze=this.el&&!Zd;Ee=Ze?"msofpNew":this.H0f?"msofp_v4_29":"msofp";for(const af in md){var Te=af,We=md[af],qf=Pb.a.qm(Te),bf=void 0;
if(Ze)if(bf=this.Vca?this.Vca[Te]:null)bf=Pb.a.qm(bf);else return M.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Te}`),{BZc:!0,gBd:[]};else bf=Pb.a.qm(xb.HelperMethods.Vca[Te]);Te=Pb.a.qm(Te);sd||(We=0);qf=Object.assign(new $c.a,{MenuItemId:qf,CommandValueId:qf,LabelText:sd&&0<We?Pb.a.qm(String.fromCodePoint(We)):bf,LabelCss:String.format("font-size:12pt;font-family:{0};",sd&&0<We?Ee:Te),Styles:Zc.qSb(sd&&
0<We?Ee:Te),AriaLabel:bf,Alt:bf,Command:tb.toString(),CommandPreviewId:lc.toString(),CommandRevertId:Tc.toString()});Ae.push(qf)}return{BZc:Zd,gBd:Ae}}mFk(tb){this.menuId=tb}klj(){return 2!==this.pId&&3!==this.pId?!1:!0}iVf(){this.H0f?(this.Lwa={["Angsana New"]:983051,["Aptos Display"]:983056,["Aptos Narrow"]:983060,["Arial Black"]:983065,["Arial"]:983064,["Batang"]:983087,["Book Antiqua"]:983104,["Browallia New"]:983109,["Calibri"]:983112,["Cambria"]:983116,["Candara"]:983118,["Century"]:983121,
["Comic Sans MS"]:983128,["Consolas"]:983134,["Constantia"]:983135,["Corbel"]:983139,["Cordia New"]:983140,["Courier New"]:983142,["DilleniaUPC"]:983153,["Dotum"]:983155,["FangSong"]:983175,["Garamond"]:983193,["Georgia"]:983195,["Gulim"]:983222,["GungSuh"]:983226,["KaiTi"]:983263,["JasmineUPC"]:983258,["Malgun Gothic"]:983302,["Mangal"]:983306,["Meiryo"]:983309,["Microsoft JhengHei"]:983317,["Microsoft YaHei"]:983329,["MingLiU"]:983337,["MingLiU_HKSCS"]:983341,["MS Gothic"]:983290,["MS Mincho"]:983292,
["MS PGothic"]:983294,["MS PMincho"]:983296,["PMingliU"]:983372,["PMingLiU-ExtB"]:983374,["SimHei"]:983441,["SimSun"]:983443,["SimSun-ExtB"]:983445,["Source Sans Pro"]:983464,["Tahoma"]:983472,["THSarabunPSK"]:983471,["Times New Roman"]:983484,["Trebuchet MS"]:983495,["Verdana"]:983519,["Yu Gothic"]:983540,["Yu Mincho"]:983550},wd.a.Bw('@font-face{font-family:"msofp_v4_29";font-style:normal;font-weight:normal;src:url("https://fs.microsoft.com/fs/4.35/flat_officeFontsPreview.ttf") format(\'truetype\')}')):
this.Lwa={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,
["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,
["Yu Mincho"]:983474}}static qSb(tb){const lc={};lc["font-family"]=tb;lc["font-size"]="12pt";tb={};tb.optionText=lc;return tb}}Object(L.a)(Zc,"FontDropdownHelper",null,[499]);var Ab=a(857),rb;(function(tb){tb[tb.FormatCellsListView=0]="FormatCellsListView";tb[tb.NumberFormatItemView=1]="NumberFormatItemView";tb[tb.AlignmentItemView=2]="AlignmentItemView";tb[tb.FontItemView=3]="FontItemView";tb[tb.BorderItemView=4]="BorderItemView"})(rb||(rb={}));var Fb;(function(tb){tb[tb.General=0]="General";tb[tb.Number=
1]="Number";tb[tb.Currency=2]="Currency";tb[tb.Accounting=3]="Accounting";tb[tb.Date=4]="Date";tb[tb.Time=5]="Time";tb[tb.Percentage=6]="Percentage";tb[tb.Fraction=7]="Fraction";tb[tb.Scientific=8]="Scientific";tb[tb.Text=9]="Text";tb[tb.Special=10]="Special";tb[tb.Custom=11]="Custom"})(Fb||(Fb={}));var jc=a(10),Oc=a(217),cd=a(1497);Object(cd.isChangeGateEnabled)("OfficeVSO:8756610_UserBrowserPerformanceAPI");class Ed{constructor(tb,lc,Tc){this.o$=!1;this.q1a=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");
this.KK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.TE=()=>{this.dispose()};this.i7=()=>{this.to()};this.onActiveCellChanged=(md,sd)=>{sd&&sd.description===rb[rb.AlignmentItemView]&&this.lQa()};this.Vu=(md,sd)=>{sd&&sd.GId===rb.AlignmentItemView&&(this.KK?0!==(sd.Ck&470)?this.np.u8(rb.AlignmentItemView,null):this.lQa():this.np.u8(rb.AlignmentItemView,null,!0))};this.GB=(md,sd)=>{sd&&sd.description===rb[rb.AlignmentItemView]&&this.lQa()};this.NOc=
(md,sd)=>{sd&&sd.description===rb[rb.AlignmentItemView]&&(this.reactRibbonRoot.Dn(),this.lQa())};this.$=tb;this.properties=lc;this.Nh=Tc;this.np=Ta.eBc(this.$,this.properties,this.Nh);this.alignmentModel={horizontalAlignmentType:0,verticalAlignmentType:0,readingOrderType:0,isJustifyDistributed:!1,indent:0,orientation:0,isWrapText:!1,isShrinkToFit:!1,isMergeCells:!1,isMergeCellsDisabled:!1,isFlipVertical:!1,disableAllControls:!1};this.HBf={};this.q1a&&(this.reactRibbonRoot=tb.la.kh(337,!0))}static getInstance(tb,
lc,Tc){return this.Va||(this.Va=new this(tb,lc,Tc))}lQa(){var tb;const lc=xa.f(this.$),Tc=null===(tb=lc.zh(lc.ha.qa.activeCell))||void 0===tb?void 0:tb.cell;Tc&&(c("AlignmentTab::Update::Start"),this.alignmentModel.horizontalAlignmentType=Tc.OH,this.alignmentModel.verticalAlignmentType=Tc.verticalAlignment,this.alignmentModel.isJustifyDistributed=8===Tc.OH?!0:!1,this.alignmentModel.indent=Tc.indentation||0,this.alignmentModel.isWrapText=Tc.oF,this.alignmentModel.isShrinkToFit=Tc.o9b,this.alignmentModel.isMergeCells=
Tc.$F,this.alignmentModel.isMergeCellsDisabled=Oc.c(lc),this.alignmentModel.readingOrderType=Tc.HTc,this.q1a&&(this.alignmentModel.disableAllControls=lc.Fh.isEditing),ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8475627_FixVerticalTextOrientation")?(this.alignmentModel.orientation=Tc.jKc?0:Tc.iF||0,this.alignmentModel.isFlipVertical=Tc.jKc):(this.alignmentModel.orientation=Tc.iF||0,this.alignmentModel.isFlipVertical=this.alignmentModel.orientation===jc.a.verticalText?!0:!1),this.l8k(this.alignmentModel))}l8k(tb){this.HBf.alignmentModel=
tb;this.np.u8(rb.AlignmentItemView,this.HBf);this.o$||this.Hp()}qh(tb,lc){c("AlignmentTab::CmdUpdate::Start");lc=Object.assign({},lc);lc[Ab.a.jja]=!1;this.$.si(tb,D.a.rh,12,lc);M.ULS.sendTraceTag(508389411,0,50,`Ribbon command called from Alignment Task Pane: ${tb}`)}Uze(tb){switch(tb){case 0:this.Uze(this.alignmentModel.horizontalAlignmentType);break;case 1:this.qh(-1150205178,null);break;case 2:this.qh(-1142465846,null);break;case 3:this.qh(-286432209,null);break;case 6:this.qh(2007171328,null)}}NJa(){return{onHorizontalAlignmentChange:tb=>
{this.alignmentModel.horizontalAlignmentType!==tb&&this.Uze(tb)},onVerticalAlignmentChange:tb=>{switch(tb){case 0:this.qh(-394785302,null);break;case 1:this.qh(1041132226,null);break;case 2:this.qh(-571165336,null)}},justifyDistributed:tb=>{tb&&this.Uze(8)},onTextDirectionChange:()=>{},onIndentationChange:tb=>{const lc=this.alignmentModel.indent;this.qh(tb>lc?-1942512156:-1920201820,{Indentation:tb-lc});this.lQa()},onOrientationChange:tb=>{this.qh(-1220714308,{Orientation:tb});this.lQa()},wrapText:()=>
{this.qh(-1116189897,null)},mergeCells:tb=>{this.qh(tb?1097660126:155820588,null)},flipVertical:()=>{this.qh(-1526602249,null)}}}dispose(){this.to();this.np.Tie(this.TE);Ed.Va=null}Hp(){this.np.jpd(this.i7);this.np.ipd(this.TE);this.np.add_activeCellChanged(this.onActiveCellChanged);this.np.nO(this.Vu);this.np.G4e(this.GB);this.q1a&&(this.np.yBh(this.NOc),this.np.xBh(this.NOc));this.o$=!0;M.ULS.sendTraceTag(508355650,0,50,"AlignmentViewModel events registered")}to(){this.np.Uie(this.i7);this.np.remove_activeCellChanged(this.onActiveCellChanged);
this.np.VV(this.Vu);this.np.EFg(this.GB);this.q1a&&(this.np.Qlk(this.NOc),this.np.Plk(this.NOc));this.o$=!1;M.ULS.sendTraceTag(508355649,0,50,"AlignmentViewModel events Unregistered")}}Object(L.a)(Ed,"AlignmentTaskPaneManager",null,[4]);var Sd=a(182),$d=a(1430);class be{constructor(tb,lc){this.KK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.$=lc;this.np=tb}showTaskPane(tb,lc,Tc){void Sd.a.cp().then(md=>{md.showTaskPane("FormatCellsTaskPane",this.Nt(tb,
lc,Tc));return null})}updateTaskPane(tb,lc,Tc){void Sd.a.cp().then(md=>{md.updateTaskPane("FormatCellsTaskPane",this.Nt(tb,lc,Tc));return null})}hideTaskPane(){void Sd.a.cp().then(tb=>{tb.hideTaskPane("FormatCellsTaskPane",2);return null})}close(){throw Error("Method not implemented.");}Nt(tb,lc,Tc){tb={type:"FormatCellsTaskPaneProps",activePage:tb,callbacks:this.np.NJa(),viewModelData:lc,isFloatingObjectSelected:Tc};return Object.assign(new $d.a,{contentProps:tb,actionButtonProps:tb.activePage!==
rb.FormatCellsListView&&(this.KK||!Tc)&&{label:wa.a.instance.ia(2351),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateTaskPane(rb.FormatCellsListView,null,this.KK?void 0:Tc);this.np.activePage=rb.FormatCellsListView}},title:tb.activePage===rb.FormatCellsListView?wa.a.instance.ia(2304):wa.a.instance.ia(2305),onShow:()=>{this.np.KXj()},onHide:()=>{this.np.i7()},onClose:()=>{this.np.TE()},width:320})}}Object(L.a)(be,"FormatCellsTaskPane",null,[550]);var Fe=a(1292);class Pe extends Sys.EventArgs{constructor(tb,
lc,Tc,md){super();this.Qo=tb;this.cellFormat=lc;this.GId=Tc;this.Ck=md}}Object(L.a)(Pe,"FormatCellsTaskPaneEventArgs",Sys.EventArgs,[]);class hc extends ab.a{constructor(tb,lc,Tc){super();this.oY=!1;this.q1a=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");this.KK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.activePage=rb.FormatCellsListView;this.isFloatingObjectSelected=this.ypb=!1;this.sRi=()=>this.activePage===rb.NumberFormatItemView?
Ta.qNd(this.$,this.properties,this.Nh).NJa():null;this.nEi=()=>this.activePage===rb.AlignmentItemView?Ta.bKd(this.$,this.properties,this.Nh).NJa():null;this.Whg=()=>{this.raiseEvent("CellEditingStarted",new Fe.a(rb[this.activePage],null))};this.Vhg=()=>{this.raiseEvent("CellEditingEnded",new Fe.a(rb[this.activePage],null))};this.onActiveCellChanged=()=>{this.raiseEvent("ActiveCellChanged",new Fe.a(rb[this.activePage],null));this.activePage===rb.FormatCellsListView&&this.isFloatingObjectSelected&&
this.u8(rb.FormatCellsListView,null,this.KK?void 0:!1);this.KK||(this.isFloatingObjectSelected=!1)};this.Vu=(md,sd)=>{this.isFloatingObjectSelected=this.KK?sd&&0!==(sd.Ck&470):!0;this.activePage===rb.FormatCellsListView?this.u8(rb.FormatCellsListView,null,this.KK?void 0:!0):this.raiseEvent("FloatingObjectSelectionChanged",new Pe(1461300262,null,this.activePage,sd.Ck))};this.aZb=()=>{this.$.ea.Ek!==jc.a.Dk&&this.$.ea.ki&&(this.oY=!0)};this.GB=()=>{this.$.ea.Ek!==jc.a.Dk&&this.oY&&(this.oY=!1,(new Ka.a(this.$.sa)).Wj(4)?
this.raiseEvent("OnGridConsistent",new Fe.a(rb[this.activePage],null)):this.Gkb.hideTaskPane())};this.ej=(md,sd)=>{!sd.dm&&this.ypb&&this.Gkb.hideTaskPane()};this.$=tb;this.properties=lc;this.Nh=Tc;this.Gkb=new be(this,tb);this.da=xa.f(this.$);this.v_d=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AsyncTaskPaneUITiming",!1);this.KK&&(this.isFloatingObjectSelected=this.da.ha.$e.isFloatingObjectSelected)}static getInstance(tb,lc,Tc){return this.Va||(this.Va=new this(tb,lc,Tc))}u8(tb,
lc,Tc){Tc=void 0===Tc?this.KK?this.VMk(tb)?this.isFloatingObjectSelected:!1:!1:Tc;this.ypb?this.Gkb.updateTaskPane(tb,lc,Tc):(this.v_d&&void this.o1k(),this.Gkb.showTaskPane(tb,lc,Tc),this.ypb=!0,this.Qz());this.activePage=tb}jpd(tb){this.addHandler("FCPaneCollapsed",tb)}Uie(tb){this.removeHandler("FCPaneCollapsed",tb)}ipd(tb){this.addHandler("FCPaneClosed",tb)}Tie(tb){this.removeHandler("FCPaneClosed",tb)}add_activeCellChanged(tb){this.addHandler("ActiveCellChanged",tb)}remove_activeCellChanged(tb){this.removeHandler("ActiveCellChanged",
tb)}nO(tb){this.addHandler("FloatingObjectSelectionChanged",tb)}VV(tb){this.removeHandler("FloatingObjectSelectionChanged",tb)}G4e(tb){this.addHandler("OnGridConsistent",tb)}EFg(tb){this.removeHandler("OnGridConsistent",tb)}yBh(tb){this.addHandler("CellEditingStarted",tb)}Qlk(tb){this.removeHandler("CellEditingStarted",tb)}xBh(tb){this.addHandler("CellEditingEnded",tb)}Plk(tb){this.removeHandler("CellEditingEnded",tb)}i7(){this.raiseEvent("FCPaneCollapsed");this.K2c();this.ypb=!1;M.ULS.sendTraceTag(508385100,
0,50,"TaskPane Collapsed")}TE(){this.raiseEvent("FCPaneClosed");this.K2c();window.setTimeout(()=>{this.dispose()},0);M.ULS.sendTraceTag(508385099,0,50,"TaskPane Closed")}KXj(){this.KK&&(this.isFloatingObjectSelected=this.da.ha.$e.isFloatingObjectSelected);if(!this.ypb)if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8593272_FormatCellSheetProtectionFix")&&!(new Ka.a(this.$.sa)).Wj(4))this.Gkb.hideTaskPane();else switch(this.activePage){case rb.NumberFormatItemView:Ta.qNd(this.$,this.properties,this.Nh).wVg(this.properties);
M.ULS.sendTraceTag(508389441,0,50,"NumberFormatTaskPane Opened");break;case rb.AlignmentItemView:Ta.bKd(this.$,this.properties,this.Nh).lQa();M.ULS.sendTraceTag(508389440,0,50,"Alignment TaskPane Opened");break;case rb.FontItemView:Ta.DCc(this.$,this.properties,this.Nh).i9b(rb.FontItemView);M.ULS.sendTraceTag(508078217,0,50,"Font tab opened");break;case rb.BorderItemView:Ta.DCc(this.$,this.properties,this.Nh).i9b(rb.BorderItemView),M.ULS.sendTraceTag(507896131,0,50,"Border tab opened")}}dispose(){this.Gkb=
this.$=null;this.ypb=!1;this.properties=null;hc.Va=null}o1k(){const tb=this;return Lo(function*(){var lc;if(null!==(lc=tb.properties)&&void 0!==lc&&lc.event){lc=tb.properties.event.rawEvent||tb.properties.event;var Tc=lc.type.includes("key")?"keyboard":"mouse";(yield Ya.a.resolve(Sa.Ed)).TA(lc,`task_pane_open_format_cell_${Tc}`,null,["task-pane"])}})}Qz(){this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.ha.$e.nO(this.Vu);this.$.ea&&(this.$.ea.dK(this.aZb),this.$.ea.nGa(this.GB));
this.$.gq(this.ej);this.q1a&&(this.da.Fh.mO(this.Vhg),this.da.Fh.uX(this.Whg))}K2c(){this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);this.da.ha.$e.VV(this.Vu);this.$.ea&&(this.$.ea.hL(this.aZb),this.$.ea.TAa(this.GB));this.$.Yu(this.ej);this.q1a&&(this.da.Fh.uN(this.Vhg),this.da.Fh.i2(this.Whg))}NJa(){return{onItemClick:tb=>{if(this.KK||!this.isFloatingObjectSelected){this.activePage===rb.FormatCellsListView&&M.ULS.sendTraceTag(507597594,0,50,`User switched from Format Cells List View to ${rb[tb]}`);
var lc={};lc[Ab.a.jja]=!1;switch(tb){case rb.NumberFormatItemView:this.$.si(-395879625,D.a.rh,12,lc);break;case rb.AlignmentItemView:this.$.si(-2019948858,D.a.rh,12,lc);break;case rb.FontItemView:this.$.si(456320978,D.a.rh,12,lc);break;case rb.BorderItemView:this.$.si(119664190,D.a.rh,12,lc)}}},numberFormatCallbacks:this.sRi(),alignmentCallbacks:this.nEi()}}VMk(tb){switch(tb){case rb.AlignmentItemView:case rb.NumberFormatItemView:return!0;default:return!1}}}Object(L.a)(hc,"FormatCellsTaskPaneManager",
ab.a,[]);var Lb=a(976),kc=a(2);class dd{constructor(tb,lc,Tc){this.o$=!1;this.DN=this.IBf=this.sw=null;this.v0b=-1;this.uZc=!0;this.hQ=!1;this.KK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.categoryDescriptionStrings=[wa.a.instance.ia(2306),wa.a.instance.ia(2307),wa.a.instance.ia(2308),wa.a.instance.ia(2309),wa.a.instance.ia(2310),wa.a.instance.ia(2311),wa.a.instance.ia(2312),wa.a.instance.ia(2313),wa.a.instance.ia(2314),wa.a.instance.ia(2315),
wa.a.instance.ia(2316),wa.a.instance.ia(2317)];this.logUserAction=md=>{this.DN[md]=this.DN[md]?this.DN[md]+1:1;this.DN.Total+=1};this.TE=()=>{this.dispose()};this.i7=()=>{this.E4g()};this.INa=()=>{const md=this.numberFormatViewModel.rIc(4,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded"),sd=this.numberFormatViewModel.rIc(3,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded");if(sd||md)this.np.u8(rb.NumberFormatItemView,this.bHf()),sd?(this.uZc?(this.numberFormatViewModel.formatCells(this.numberFormatViewModel.w_a(),
this.Nh),this.v0b=-1):this.uZc=!0,M.ULS.sendTraceTag(508355619,0,50,"NumberFormatViewModel Loaded by the TaskPane")):M.ULS.sendTraceTag(508355618,0,50,"NumberFormatViewModel Loaded by the Active Cell")};this.HNa=()=>{M.ULS.sendTraceTag(508889099,0,50,"NumberFormatTaskPaneManager.onNumberFormatViewModelFailedLoad - Webservice call failed")};this.onActiveCellChanged=(md,sd)=>{var Zd;if(sd&&sd.description===rb[rb.NumberFormatItemView]){this.logUserAction("ActiveCellChange");md=null===(Zd=xa.f(this.$).zh(null))||
void 0===Zd?void 0:Zd.cell;if(!this.KK&&this.np.isFloatingObjectSelected||this.V0f(md))this.KK||(this.np.isFloatingObjectSelected=!1),this.f6(!0,4);!ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&md&&(this.wnd=md)}};this.Vu=(md,sd)=>{sd&&sd.GId===rb.NumberFormatItemView&&(this.KK?0!==(sd.Ck&470)?this.np.u8(rb.NumberFormatItemView,null):this.f6(!0,4):this.np.u8(rb.NumberFormatItemView,null,!0))};this.GB=(md,sd)=>{var Zd,Ae;sd&&sd.description===rb[rb.NumberFormatItemView]&&
(md=null===(Zd=xa.f(this.$).zh(null))||void 0===Zd?void 0:Zd.cell,this.V0f(md)&&!this.hQ?(this.uZc=!1,this.f6(!0)):(this.hQ=!1,ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&(this.v0b=null!==(Ae=null===md||void 0===md?void 0:md.qo)&&void 0!==Ae?Ae:-1)))};this.$=tb;this.properties=lc;this.Nh=Tc;this.np=Ta.eBc(this.$,this.properties,this.Nh);this.DN={Total:0}}static getInstance(tb,lc,Tc){return this.Va||(this.Va=new this(tb,lc,Tc))}wVg(tb){this.np.u8(rb.NumberFormatItemView,
this.IBf);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8589523_AvoidApplyingFormatOnPaneOpen")&&(this.uZc=!1);this.f6(!0,3,tb)}dispose(){M.ULS.sendTraceTag(507875737,0,20,`Number format usage ${JSON.stringify(this.DN)}`);this.E4g();this.np.Tie(this.TE);dd.Va=null}NJa(){return{onCategoryTypeChange:tb=>{this.logUserAction("CategoryTypeChange");this.sw.NumberFormatCategory=tb;this.hQ=!0;switch(tb){case 0:case 9:this.Fla();break;default:this.f6()}M.ULS.sendTraceTag(508387598,0,50,`Number Format Category Changed ${tb}`)},
onThousandSeparatorChanged:tb=>{this.logUserAction("ThousandsSeparatorChange");this.sw.IsComma=tb;this.hQ=!0;this.f6();M.ULS.sendTraceTag(508368995,0,50,`Thousand Separator Changed ${tb}`)},onDecimalPlacesChanged:tb=>{this.logUserAction("DecimalPlacesChange");this.sw.DecimalPlaces=tb;this.hQ=!0;switch(this.sw.NumberFormatCategory){case 3:case 6:case 8:ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8507884_FixIncreaseDecreaseDecimalFlicker")?this.f6():this.Fla();break;default:this.f6()}M.ULS.sendTraceTag(508368994,
0,50,`Decimal Places Changed ${tb}`)},onLocaleChanged:tb=>{this.logUserAction("LocaleChange");this.sw.LocaleType=tb;this.hQ=!0;this.f6();M.ULS.sendTraceTag(508389409,0,50,`Locale Changed ${tb}`)},overrideLocale:()=>{this.logUserAction("overrideLocale");this.hQ=!0;this.$.si(151715844,D.a.rh,12,{selectedIndex:this.sw.LocaleType});M.ULS.sendTraceTag(508389408,0,50,`Override default Locale button clicked ${this.sw.LocaleType}`)},onInputCalendarChecked:tb=>{this.logUserAction("InputCalendarChecked");this.hQ=
!0;this.sw.IsInputCalendar=tb;this.f6();M.ULS.sendTraceTag(508387596,0,50,"Change in Input Calendar Type")},onGannenChecked:tb=>{this.logUserAction("GannenChecked");this.sw.IsGannen=tb;this.hQ=!0;this.f6();M.ULS.sendTraceTag(508389407,0,50,`Gannen changed ${this.sw.LocaleType} ${tb}`)},onCalendarTypeChanged:tb=>{this.logUserAction("CalendarTypeChange");this.sw.CalendarType=tb;this.hQ=!0;this.f6();M.ULS.sendTraceTag(508389406,0,50,`Calendar Type changed ${tb}`)},onSymbolChanged:tb=>{this.logUserAction("SymbolChange");
this.sw.CurrencyType=tb;this.hQ=!0;3===this.sw.NumberFormatCategory?this.Fla():this.f6();M.ULS.sendTraceTag(508387595,0,50,`Currency Symbol changed ${tb}`)},onNegativeNumberTypeChanged:tb=>{this.logUserAction("NegativeNumberTypeChange");this.hQ=!0;this.sw.NegativeNumberType=tb;this.Fla();M.ULS.sendTraceTag(508387594,0,50,`Negative Number Type changed ${tb}`)},onDateTypeChanged:tb=>{this.logUserAction("DateTypeChange");this.hQ=!0;this.sw.DateType=tb;this.Fla();M.ULS.sendTraceTag(508387593,0,50,`Date Type Changed ${tb}`)},
onTimeTypeChanged:tb=>{this.logUserAction("TimeTypeChange");this.hQ=!0;this.sw.TimeType=tb;this.Fla();M.ULS.sendTraceTag(508387592,0,50,`Time Type changed ${tb}`)},onFractionTypeChanged:tb=>{this.logUserAction("FractionTypeChange");this.hQ=!0;this.sw.FractionType=tb;this.Fla();M.ULS.sendTraceTag(508387591,0,50,`Fraction Type changed ${tb}`)},onSpecialTypeChanged:tb=>{this.logUserAction("SpecialTypeChange");this.hQ=!0;this.sw.SpecialType=tb;this.Fla();M.ULS.sendTraceTag(508387590,0,50,`Special Type changed ${tb}`)},
onCustomTypeChanged:tb=>{this.logUserAction("CustomTypeChange");this.hQ=!0;this.sw.CustomType=tb;this.Fla();M.ULS.sendTraceTag(508387589,0,50,`CustomType changed ${tb}`)},onNegativeCurrencyTypeChanged:tb=>{this.logUserAction("NegativeCurrencyTypeChange");this.hQ=!0;this.sw.NegativeCurrencyType=tb;this.Fla();M.ULS.sendTraceTag(508387588,0,50,`Negative Currency Type changed ${tb}`)}}}f6(tb,lc,Tc){lc=void 0===lc?3:lc;let md=null;if(this.activeCell=this.Fzc())c("NumberFormatTab::DelayedUpdate::Start"),
Tc&&(Tc.currencyType||D.a.Qi in Tc&&Tc[D.a.Qi])&&(md=parseInt(Tc[D.a.Qi].toString(),10)),this.numberFormatViewModel?(this.o$||this.iUc(),md||tb?this.D7f(md,lc,Tc):(this.sw.Caller=lc,this.numberFormatViewModel.bPb(this.activeCell,this.sw))):this.a8h(md)}a8h(tb){void Ya.a.resolve(Sa.ie,{va:0}).then(lc=>{this.numberFormatViewModel=lc;this.o$||this.iUc();this.numberFormatViewModel.xle();this.D7f(tb)})}iUc(){this.o$=!0;this.numberFormatViewModel.Leb(this.INa);this.numberFormatViewModel.xpd(this.HNa);this.np.jpd(this.i7);
this.np.ipd(this.TE);this.np.add_activeCellChanged(this.onActiveCellChanged);this.np.nO(this.Vu);this.np.G4e(this.GB);M.ULS.sendTraceTag(508355648,0,50,"NumberFormatViewModel events Registered")}D7f(tb,lc,Tc){lc=void 0===lc?3:lc;tb=Object(kc.a)(new Lb.a,{Caller:lc,NumberFormatCategory:null!==tb&&void 0!==tb?tb:-1});Tc&&Tc.currencyType&&(tb.CurrencyType=Tc.currencyType,tb.NumberFormatCategory=3);this.numberFormatViewModel.bPb(this.activeCell,tb)}bHf(tb){var lc=this.numberFormatViewModel.rp.NumberFormatElement.toString();
this.sw=tb=tb?this.eFf():this.numberFormatViewModel.w_a();return this.IBf=lc={numberFormatModel:{categories:this.numberFormatViewModel.rp.Categories,categoryDescriptionStrings:this.categoryDescriptionStrings,negativeNumberTypes:this.numberFormatViewModel.rp.NegativeNumberTypes,negativeCurrencyTypes:this.numberFormatViewModel.rp.NegativeCurrencyTypes,currencySymbols:this.numberFormatViewModel.rp.CurrencySymbols,dateTypes:this.numberFormatViewModel.rp.DateTypes,timeTypes:this.numberFormatViewModel.rp.TimeTypes,
fractionTypes:this.numberFormatViewModel.rp.FractionTypes,specialTypes:this.numberFormatViewModel.rp.SpecialTypes,customTypes:this.numberFormatViewModel.rp.CustomTypes,localeOptions:this.numberFormatViewModel.rp.Locales,calendarTypes:this.numberFormatViewModel.rp.Calendars,isInputCalendarCheckboxRequired:"57607"===lc||"319751"===lc?!0:!1,isGannenCheckboxRequired:"319751"===lc?!0:!1,currentCategory:tb.NumberFormatCategory,decimalPlaces:tb.DecimalPlaces,isComma:tb.IsComma,currencyType:tb.CurrencyType,
negativeNumberType:tb.NegativeNumberType,dateType:tb.DateType,timeType:tb.TimeType,fractionType:tb.FractionType,specialType:tb.SpecialType,customType:tb.CustomType,negativeCurrencyType:tb.NegativeCurrencyType,calendarType:tb.CalendarType,localeIndex:tb.LocaleType,isInputCalendarChecked:tb.IsInputCalendar,isGannenChecked:tb.IsGannen}}}Fzc(){var tb,lc;let Tc;const md=xa.f(this.$),sd=md.ha.qa.activeCell;if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")){var Zd=null===
(tb=md.zh(sd))||void 0===tb?void 0:tb.cell;this.v0b=null!==(lc=null===Zd||void 0===Zd?void 0:Zd.qo)&&void 0!==lc?lc:-1}else this.wnd=null===(Zd=md.zh(sd))||void 0===Zd?void 0:Zd.cell;sd&&(Tc=X.q(sd,this.$));return Tc}E4g(){this.o$=!1;this.numberFormatViewModel&&(this.numberFormatViewModel.ovb(this.INa),this.numberFormatViewModel.ije(this.HNa),this.np.Uie(this.i7),this.np.remove_activeCellChanged(this.onActiveCellChanged),this.np.VV(this.Vu),this.np.EFg(this.GB),M.ULS.sendTraceTag(508355617,0,50,"NumberFormatViewModel events Un-registered"))}eFf(){const tb=
this.numberFormatViewModel.w_a();tb.NumberFormatCategory=this.sw.NumberFormatCategory;tb.NegativeNumberType=this.sw.NegativeNumberType;tb.NegativeCurrencyType=this.sw.NegativeCurrencyType;tb.DateType=this.sw.DateType;tb.TimeType=this.sw.TimeType;tb.FractionType=this.sw.FractionType;tb.SpecialType=this.sw.SpecialType;tb.CustomType=this.sw.CustomType;tb.DecimalPlaces=this.sw.DecimalPlaces;tb.CurrencyType=this.sw.CurrencyType;return tb}Fla(){c("NumberFormatTab::InstantUpdate::Start");this.numberFormatViewModel.formatCells(this.eFf(),
this.Nh);this.v0b=-1;this.np.u8(rb.NumberFormatItemView,this.bHf(!0))}V0f(tb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")?tb&&tb.qo!==this.v0b:tb&&this.wnd&&tb.qo!==this.wnd.qo}}Object(L.a)(dd,"NumberFormatTaskPaneManager",null,[4]);class yb{constructor(tb,lc,Tc){this.o$=!1;this.activePage=rb.FormatCellsListView;this.isFloatingObjectSelected=!1;this.KK=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.TE=()=>
{this.dispose()};this.i7=()=>{this.to()};this.onActiveCellChanged=(md,sd)=>{this.isFloatingObjectSelected&&sd&&sd.description===rb[this.activePage]&&(this.i9b(this.activePage),this.isFloatingObjectSelected=!1)};this.Vu=(md,sd)=>{sd&&sd.GId===this.activePage&&(this.isFloatingObjectSelected=!0,this.np.u8(this.activePage,null,!0))};this.np=Ta.eBc(tb,lc,Tc);ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&(this.reactRibbonRoot=tb.la.kh(337,!0))}static getInstance(tb,
lc,Tc){return this.Va||(this.Va=new this(tb,lc,Tc))}i9b(tb){this.np.u8(tb,null);this.activePage=tb;this.o$||this.Hp();ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&requestAnimationFrame(()=>{this.reactRibbonRoot.Dn()})}dispose(){this.to();this.np.Tie(this.TE);yb.Va=null}Hp(){this.np.jpd(this.i7);this.np.ipd(this.TE);this.KK||(this.np.add_activeCellChanged(this.onActiveCellChanged),this.np.nO(this.Vu));this.o$=!0;M.ULS.sendTraceTag(508078168,0,50,"Events registered")}to(){this.np.Uie(this.i7);
this.KK||(this.np.remove_activeCellChanged(this.onActiveCellChanged),this.np.VV(this.Vu));this.o$=!1;M.ULS.sendTraceTag(508078167,0,50,"Events unregistered")}}Object(L.a)(yb,"StoreConnectedItemViewTaskPaneManager",null,[4]);class Ta{constructor(){}static eBc(tb,lc,Tc){return hc.getInstance(tb,lc,Tc)}static qNd(tb,lc,Tc){return dd.getInstance(tb,lc,Tc)}static bKd(tb,lc,Tc){return Ed.getInstance(tb,lc,Tc)}static DCc(tb,lc,Tc){return yb.getInstance(tb,lc,Tc)}}Object(L.a)(Ta,"FormatCellsTaskPaneHelper",
null,[]);let Hb=class{constructor(tb,lc){this.qK=lc;this.$=tb}Ri(){return!1}executeCommand(tb,lc,Tc){var md;tb=!1;const sd=lc.command;switch(sd){case 2055979337:Ta.eBc(this.$,Tc,lc).u8(rb.FormatCellsListView,null);tb=!0;M.ULS.sendTraceTag(508369024,0,50,"FormatCellsTaskPane opened using FormatCells Command");break;case -395879625:Ta.qNd(this.$,Tc,lc).wVg(Tc);tb=!0;M.ULS.sendTraceTag(508385094,0,50,"NumberFormat Tab in FormatCellsTaskPane opened using showNumberFormat");break;case -2019948858:Ta.bKd(this.$,
Tc,lc).lQa();tb=!0;M.ULS.sendTraceTag(508385093,0,50,"Alignment Tab in FormatCellsTaskPane opened using showAlignmentPane");break;case 456320978:Ta.DCc(this.$,Tc,lc).i9b(rb.FontItemView);tb=!0;M.ULS.sendTraceTag(508078218,0,50,"Font Tab in FormatCellsTaskPane opened.");break;case 119664190:Ta.DCc(this.$,Tc,lc).i9b(rb.BorderItemView),tb=!0,M.ULS.sendTraceTag(507896130,0,50,"Border Tab in FormatCellsTaskPane opened.")}ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8607151_FormatTaskpaneFloatieUI")&&
(lc=null!==(md=Tc[Ab.a.e$a])&&void 0!==md?md:0,tb&&9===lc&&this.qK.lWb()&&this.qK.OI());return tb?Ia.Task.Ua(!0):aa.a(sd)}Gi(tb,lc){switch(lc.command){case 2055979337:case -395879625:case -2019948858:case 456320978:case 119664190:return!0;default:return!1}}dj(){return!1}};Hb=Object(J.__decorate)([Object(Ya.d)(Sa.yc),Object(J.__param)(0,Object(Sa.Nb)()),Object(J.__param)(1,Object(Sa.eb)())],Hb);Object(L.a)(Hb,"FormatCellsCommandHandler",null,[34]);Object(Ya.b)(Sa.Bc)(tb=>Lo(function*(){const lc=yield Ya.a.resolve(Sa.Ic,
tb),Tc=yield Ya.a.resolve(Sa.E,tb);yield Tc.VUf;return new uc(lc.getFormulaAnonymizer(Tc.config))}));class uc{constructor(tb){this.uHh=tb}anonymize(tb,lc){return this.uHh.anonymize(tb,{row:lc.top-1,col:lc.left-1,rows:1,cols:1})}}Object(L.a)(uc,"FormulaAnonymizer",null,[]);class Sc{constructor(tb,lc,Tc,md){this.$=tb;this.formulaAssistanceUIControl=lc;this.fD=Tc;this.PF=md;this.k_b=tc.a.r0f();this.Dya=this.COe=!1;this.zba={repairs:[],cell:null};this.da=Object(xa.f)(this.$);this.container=document.createElement("div");
this.$.domElement.appendChild(this.container)}get sLa(){return this.COe}set sLa(tb){this.COe=tb;this.PF.Zo=tb}$Qk(tb,lc,Tc,md){md=void 0===md?"beside":md;this.Yrd("card");this.fD.oke("repair",lc.repairs.length);this.sLa=!0;const sd=this.svd(tb),Zd=Object.assign({},lc,{callbacks:Tc,Aul:md});this.zba={repairs:lc.repairs,cell:tb.AC};this.formulaAssistanceUIControl.renderFormulaRepair(this.container,sd,Zd);this.kAe=Ae=>{Ae=Object.assign({},Zd,{repairs:Ae});this.formulaAssistanceUIControl.renderFormulaRepair(this.container,
sd,Ae)}}tRk(tb,lc){this.Yrd("card");this.fD.oke("errorIndication");this.sLa=!0;tb=this.svd(tb);this.formulaAssistanceUIControl.renderSyntaxErrorIndication(this.container,tb,lc)}qPk(tb,lc){this.Yrd("icon");this.fD.oke("icon");this.Dya=!0;tb=this.svd(tb);this.formulaAssistanceUIControl.renderFormulaRepairIcon(this.container,tb,lc)}hide(tb){let lc=!1;this.Dya&&(lc=!0,this.Dya=!1);this.sLa&&(this.k_b&&"commit"!==tb&&this.zba.repairs&&0<this.zba.repairs.length&&this.zba.cell&&this.fD.jae(this.zba),lc=
!0,this.sLa=!1,this.kAe=null);lc&&(this.formulaAssistanceUIControl.dismiss(this.container),this.fD.Iqk(tb),this.zba={repairs:[],cell:null});return lc}Yrd(tb){M.ULS.shipAssertTag(508315279,0,!this.sLa&&!this.Dya,`FormulaRepairControl: Trying to show ${tb} while a ui is shown. Card: ${this.sLa}, icon:${this.Dya}.`)}svd(tb){tb=this.da.getCellBounds(tb,!0);return{top:tb.y,bottom:tb.y+tb.height,left:tb.x,right:tb.x+tb.width}}}Object(L.a)(Sc,"FormulaRepairControl",null,[]);var bc=a(307),vc=a(7),Xc=a(305),
ad=a(16);class Id{constructor(tb,lc,Tc){this.$=tb;this.Fne=lc;this.formulaAssistanceUIControl=Tc;this.SWa=!1}get Zo(){return this.SWa}set Zo(tb){this.SWa!==tb&&(tb?Xc.a(this.$).Tq(this):Xc.a(this.$).VH(this),this.SWa=tb)}get hl(){return this.Fne}get hj(){return this.ht}set hj(tb){this.ht=tb}Vp(tb,lc){tb=!1;lc||(tb=this.formulaAssistanceUIControl.focusElement(this.hj));return tb}tq(tb){return null!=this.hj?ad.DOMElementExtensions.eo(this.hj,tb):!1}Qs(){}nu(){}}Object(L.a)(Id,"FormulaRepairFocusManager",
null,[47]);var ue=a(283),Vd=a(649);class Kd{constructor(tb,lc,Tc,md,sd){this.$=tb;this.pluginScheduler=lc;this.F3g=Tc;this.fD=md;this.wBe=sd;this.z0d=tc.a.cIc();this.isValuePreviewEnabled=this.a1f=this.E_d=!1;this.WSc=this.Vtc=null;this.fs={id:0,active:!1,cell:null};this.onActiveCellChanged=(Zd,Ae)=>{var Ee,Ze;this.E_d=!1;this.fs.active&&Object(bc.b)(Ae.cell)&&Ae.cell.range.toString()===(null===(Ee=this.fs.cell)||void 0===Ee?void 0:Ee.AC.toString())||(Object(bc.b)(this.WSc)?(Zd=null===(Ze=this.da.zh(this.WSc))||
void 0===Ze?void 0:Ze.cell,void this.$Vc("editCommitted",Zd),this.WSc=null):(this.hide("selection"),void this.$Vc("selection")))};this.onScroll=()=>{this.hide("scroll")};this.d1j=(Zd,Ae)=>{const Ee=this.fs.cell;if(Object(bc.c)(Zd))this.control.tRk(Ee,this.NJa("SyntaxErrorIndication"));else{this.Vtc=Zd;var Ze;this.isValuePreviewEnabled&&(Ze=this.kni(this.Vtc.repairs));this.alj&&"editCommitted"!==Ae?this.Vxb("icon"):this.isValuePreviewEnabled?void this.Rel(Ze):this.Vxb("card")}};this.Vxb=Zd=>{this.a1f||
this.da.domElement.addEventListener("scroll",this.onScroll);"card"===Zd?this.control.$Qk(this.fs.cell,this.Vtc,this.NJa("FormulaRepairCard"),this.aTi()):"icon"===Zd&&this.control.qPk(this.fs.cell,this.gVj)};this.gVj=()=>{this.control.hide("commit");this.Vxb("card")};this.NJa=Zd=>({onCommit:this.onCommit,onFeedback:this.onFeedback(Zd),onDismiss:this.onDismiss,onIgnore:this.onIgnore,onRender:this.onRender,getItemHighlights:this.WUi});this.onCommit=Zd=>{const Ae=this.fs.cell.AC;this.da.setCell({Text:Zd.text,
Fonts:[],TextRuns:[]},Ae,0,127,null);this.z0d&&this.fD.A0d.frg({Bq:Ae,cellText:Zd.text,committed:!0});this.hide("commit")};this.onDismiss=()=>{this.Vtc=null};this.onIgnore=()=>{this.dsg("ignore")};this.onFeedback=Zd=>()=>{const Ae={};Ae[vc.a.cP]=Zd;this.$.si(802602464,0,19,Ae)};this.onRender=Zd=>{Zd&&(this.PF.hj=Zd)};this.xjk=Zd=>{const Ae=this.fs.id,Ee=()=>{this.fs.id===Ae&&void this.$Vc(Zd,this.fs.cell);this.da.za.ux(Ee)};this.da.za.ny(Ee)};this.WUi=Zd=>{this.ED||M.ULS.sendTraceTag(508347539,0,
15,"FormulaRepair.getRepairItemHighlights: formulaHighlightsControl is null");var Ae=this.ED.IYi(Zd.text,[Vd.HighlightKind.Parentheses]);if(!Ae)return null;const Ee=Ae.highlightRanges;var Ze=Ae.D1c;Ae=[];var Te=0;for(var We=0;We<Ze.length;We++){const qf=Ze[We];Ae.push({start:Te,end:Te+qf.text.length,color:qf.color});Te+=qf.text.length}Zd=Zd.repairedFormulaParts;Ze=[];for(We=Te=0;Te<Zd.length&&We<Ae.length;)Ze.push({location:{start:Math.max(Zd[Te].location.start,Ae[We].start),end:Math.min(Zd[Te].location.end,
Ae[We].end)},type:Zd[Te].type,color:Ae[We].color}),Zd[Te].location.end<Ae[We].end?Te++:(Zd[Te].location.end>Ae[We].end||Te++,We++);return{coloredParts:Ze,highlightRanges:Ee}};this.Cn=()=>{this.hide("edit")};this.Rl=(Zd,Ae)=>{Zd=Ae.committed;const Ee=Ae.rIa;Ae=Ae.Bq;const Ze="keydown"===(null===Ee||void 0===Ee?void 0:Ee.type);!Zd||!Ze||null!==Ee&&void 0!==Ee&&Ee.ctrlKey?Ze&&void this.$Vc(Zd?"editCommitted":"editDismissed"):this.WSc=Ae};this.da=Object(xa.f)(this.$);this.PF=new Id(this.$,ue.a.bCf,this.F3g);
this.control=new Sc(this.$,this.F3g,md,this.PF);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.Fh.mO(this.Cn);this.da.Fh.Jx(this.Rl);Sa.Ec.Aa()?void Ya.a.sj(Sa.Ec).then(Zd=>{this.ED=Zd.ED}):this.$.la.fi(464,Zd=>{this.ED=Zd.ED});this.isValuePreviewEnabled=tc.a.poa();this.alj=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRepairIcon",!1)&&"renderFormulaRepairIcon"in Tc}dsg(tb){this.hide(tb)&&(this.E_d=!0)}$Vc(tb,lc){lc=void 0===lc?null:lc;const Tc=this;return Lo(function*(){var md;
if(!Tc.da.isEditing&&!Tc.E_d){var sd=null!==lc&&void 0!==lc?lc:null===(md=Tc.da.zh(null))||void 0===md?void 0:md.cell;Tc.fs={active:!1,id:Tc.fs.id+1,cell:sd};Tc.da.za.l6()?!Object(bc.c)(sd)&&sd.hasError&&(Tc.fs.active=!0,Tc.fD.addressable.selected++,md=Tc.pluginScheduler.requester().formulaRepair({formula:Tc.fs.cell.text},Vd.PluginGroup.Excel,null),md=yield Tc.tCe(md),Object(bc.c)(md)||"Done"!==md.kind?Tc.fs.active=!1:Tc.d1j(md.payload,tb)):Tc.xjk(tb)}})}Rel(tb){const lc=this;return Lo(function*(){let Tc;
var md=new Promise(sd=>{Tc=setTimeout(()=>{sd(!0)},100)});md=Promise.race([md,tb]).finally(()=>clearTimeout(Tc));(yield lc.tCe(md))&&lc.Vxb("card")})}kni(tb){const lc=this;return Lo(function*(){const Tc=Array(tb.length);for(let sd=0;sd<tb.length;sd++){var md=lc.wBe.Wke({text:tb[sd].text,index:0,length:tb[sd].text.length},2E3,!1);if((md=yield lc.tCe(md))&&"Success"===md.kind)Tc[sd]=md.value;else return!1}tb.forEach((sd,Zd)=>sd.formulaValue=Tc[Zd]);lc.control.sLa&&Object(bc.b)(lc.control.kAe)&&lc.control.kAe(tb);
return!0})}tCe(tb){const lc=this;return Lo(function*(){const Tc=lc.fs.id,md=yield tb;return lc.fs.id===Tc&&lc.fs.active?md:null})}hide(tb){this.fs.active=!1;this.fs.cell=null;this.a1f&&this.da.domElement.removeEventListener("scroll",this.onScroll);return this.control.hide(tb)}aTi(){const tb=this.da.ha.qa.activeCell,lc=this.fs.cell.AC;if(tb&&lc&&tb.left!==lc.left)return"below"}}Object(L.a)(Kd,"FormulaRepair",null,[]);Object(Ya.b)(Sa.Rc,{Fk:"singleton"})(tb=>Lo(function*(){var lc;const Tc=yield Ya.a.resolve(Sa.Nb,
tb),md=Ya.a.resolve(la.g,tb),sd=Object(da.e)(Ua.GetServiceTaskFactory.Tj(Tc.la,448,449,null!==(lc=tb.va)&&void 0!==lc?lc:0));var Zd=Sa.Ec.Aa();lc=Zd?Promise.resolve(void 0):Ya.a.resolve(Sa.Wc,tb);Zd=Zd?Ya.a.resolve(Sa.Ec,tb):Promise.resolve(void 0);const Ae=Ya.a.resolve(Sa.Sc,tb),Ee=Ya.a.resolve(Sa.Hc,tb),[Ze,Te,We,qf,bf]=yield Promise.all([md,sd,lc,Ae,Ee,Zd]);return new Kd(Tc,Ze,Te,qf,bf,We)}));class Yd{constructor(tb){this.$=tb;this.zba=null;this.X4d=0;this.Rl=(lc,Tc)=>{this.to();this.nkj(Tc)&&
this.X4d++;this.zba=null};this.da=xa.f(this.$)}jae(tb){this.zba=tb;this.registerEvent()}registerEvent(){this.da.cellTextEditBox.uX(this.Rl)}to(){this.da.cellTextEditBox.i2(this.Rl)}nkj(tb){return tb.committed&&null!==this.zba&&tb.Bq.equals(this.zba.cell)&&this.zba.repairs.some(lc=>lc.text.toLowerCase().replace(/\s+/g,"")===tb.cellText.toLowerCase().replace(/\s+/g,""))}}Object(L.a)(Yd,"ManualFormulaRepairTelemetry",null,[]);let Bc=class{constructor(tb,lc){this.A0d=tb;this.$=lc;this.z0d=tc.a.cIc();
this.k_b=tc.a.r0f();this.id=0;this.hza=null;this.Vk={reportName:"FormulaRepair",addressable:{selected:0,committed:0},repairUsage:b(),indicationUsage:b(),iconUsage:b()};this.Vk.repairUsage.keptData=this.A0d.JMd();this.k_b&&(this.W4d=new Yd(this.$),this.Vk.repairUsage.manualRepair=this.W4d.X4d);this.repairUsage=this.Vk.repairUsage;this.indicationUsage=this.Vk.indicationUsage;this.iconUsage=this.Vk.iconUsage;this.addressable=this.Vk.addressable;this.sjk()}oke(tb,lc){switch(tb){case "repair":this.pHb=
this.repairUsage;this.pHb.show.repairCounts.push(lc);break;case "icon":this.pHb=this.iconUsage;break;case "errorIndication":this.pHb=this.indicationUsage}this.pHb.show.count++;this.hza=performance.now();this.XVf()}Iqk(tb){if(null!==this.hza){const lc=performance.now()-this.hza;this.pHb.hideDurations[tb].push(lc)}else M.ULS.sendTraceTag(508370960,1,10,"FormulaRepairTelemetry.reportHide: lastShowTime is null");this.XVf();this.hza=null}jae(tb){this.k_b&&this.W4d.jae(tb)}sjk(){this.$.la.fi(276,tb=>{tb.a4(this.Vk)})}XVf(){M.ULS.sendTraceTag(509137429,
1,50,`${JSON.stringify({id:this.id++,addressable:this.addressable,repairUsage:this.repairUsage,indicationUsage:this.indicationUsage,keptData:this.z0d?this.A0d.JMd():"",manualRepair:this.k_b?this.W4d.X4d:""})}`)}};Bc=Object(J.__decorate)([Object(Ya.d)(Sa.Sc),Object(J.__param)(0,Object(Sa.Hd)()),Object(J.__param)(1,Object(Sa.Nb)())],Bc);Object(L.a)(Bc,"FormulaRepairTelemetry",null,[]);var Mc=a(29),Fd=a(925),Md=a(116),oe=a(485);class ye{static getSelection(tb,lc,Tc){var md=tb.qa;tb=md.activeCell.clone();
md=md.activeRange;md.lk&&(M.ULS.sendTraceTag(507556643,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${tb.top}) and firstUnfreezeCell.Bottom (${tb.bottom}) to equal topLeftRange.Top (${lc.top})`),tb.top=tb.bottom=lc.top);md.isRow&&(M.ULS.sendTraceTag(507556642,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${tb.left}) and firstUnfreezeCell.Right (${tb.right}) to equal topLeftRange.Left (${lc.left})`),
tb.left=tb.right=lc.left);if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(Tc.command){case -73576432:case -1156879868:tb.top===tb.maxRows&&(tb.top=tb.bottom=tb.maxRows-1);break;case -1564089444:case -1929078919:tb.left===tb.maxColumns&&(tb.left=tb.right=tb.maxColumns-1)}return tb}static oXb(tb,lc){if(tb.bG(lc))return!0;for(const Tc of tb.Wu){if(!tb.fh.JD(Tc.paneType))continue;const md=tb.yl(lc,Tc.paneType),sd=Tc.Vr;if(md&&sd&&ye.CVb(md,sd))return!0}return!1}static CVb(tb,
lc){return!tb||lc.topLeft.y>tb.bottomRight.y||lc.topLeft.x>tb.bottomRight.x||lc.bottomRight.y<tb.bottomRight.y||lc.bottomRight.x<tb.bottomRight.x?!1:!0}static EP(tb,lc,Tc,md){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var sd="FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",Zd={};Zd.operationType=oe.a(lc.command);Zd.isSuccessful=Tc;Zd.preExistingPanes=tb.fh.Fy;Zd.message=md?md:"";sd+=bb.a.Ci(Zd);M.ULS.sendTraceTag(507556641,0,50,sd)}}static dMc(tb,
lc,Tc,md){M.ULS.sendTraceTag(507381773,0,50,JSON.stringify({preExistingPanes:tb.fh.Fy,message:"",dragOrigin:lc,dragDirection:Tc,eventName:md}))}static HRb(tb){var lc,Tc=null!==(lc=tb.emb())&&void 0!==lc?lc:tb.R5();if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix"))return lc=tb.kj,tb=Math.max(Tc.top,lc.Q0(Tc.top,!0,!0)),Tc=Math.max(Tc.left,lc.Q0(Tc.left,!1,!0)),{rowNumber:tb,columnNumber:Tc};lc=tb.maa(!0);tb=tb.maa(!1);return{rowNumber:lc>Tc.top?lc:Tc.top,columnNumber:tb>
Tc.left?tb:Tc.left}}}Object(L.a)(ye,"FreezePanesUtils",null,[]);var te=a(137),ze;(function(tb){tb[tb.HORIZONTAL=0]="HORIZONTAL";tb[tb.VERTICAL=1]="VERTICAL";tb[tb.BOTH=2]="BOTH"})(ze||(ze={}));Object(L.b)("FreezePanesPreviewDirection",ze);var He;(function(tb){tb[tb.TOPLEFT=0]="TOPLEFT";tb[tb.BOTTOMRIGHT=1]="BOTTOMRIGHT"})(He||(He={}));Object(L.b)("FreezePanesPreviewPosition",He);class ne{constructor(tb){this.da=tb}u6h(tb){ne.wEa||tb===ze.VERTICAL||(ne.wEa=document.createElement("div"),ne.wEa.classList.add(Mc.Gb),
ne.wEa.role="presentation",this.da.yn.appendChild(ne.wEa));ne.sea||tb===ze.HORIZONTAL||(ne.sea=document.createElement("div"),ne.sea.classList.add(Mc.Hb),ne.sea.role="presentation",this.da.yn.appendChild(ne.sea))}iHd(tb,lc){lc=void 0===lc?He.BOTTOMRIGHT:lc;var Tc=this.da.fh.IJ,md=this.da.fh.EL;var sd=this.da.fh.Gm;const Zd=this.da.fh.Ym,{EJ:Ae,FB:Ee}=this.da.Q5(),Ze=this.da.kj;if(Ze){var Te=this.L0(Ze,Ae.top,Ae.left);lc=this.L0(Ze,tb.top+lc,tb.left+lc);var We=this.L0(Ze,sd,Zd);var qf=Ee.x+Te.xk-We.xk,
bf=Ee.y+Te.nk-We.nk;Te=this.da.vs;var af=this.da.uC;We=af+lc.nk-bf;0<Tc&&(Tc=this.Vwa(Ze,0,0),We=tb.top<sd?af+lc.nk-Tc.nk:af+lc.nk-Tc.nk-bf);sd=Te+lc.xk-qf;0<md&&(md=this.Vwa(Ze,0,0),sd=Zd>tb.left?Te+lc.xk-md.xk:Te+lc.xk-md.xk-qf);return{Umb:sd,hAb:We}}}Sxb(tb,lc,Tc){Tc=void 0===Tc?He.BOTTOMRIGHT:Tc;tb=this.iHd(tb,Tc);void 0!==tb?this.vPk(tb.Umb,tb.hAb,lc):Ia.Task.Ua(!1)}vPk(tb,lc,Tc){this.u6h(Tc);Tc!==ze.BOTH&&Tc!==ze.HORIZONTAL||!this.LTh(lc)||(ne.wEa.style.top=xb.HelperMethods.Ki(Math.max(lc,this.da.uC)));
Tc!==ze.BOTH&&Tc!==ze.VERTICAL||!this.PTh(tb)||(this.da.rtl?(ne.sea.style.left="unset",ne.sea.style.right=xb.HelperMethods.Ki(Math.max(tb,this.da.vs))):(ne.sea.style.right="unset",ne.sea.style.left=xb.HelperMethods.Ki(Math.max(tb,this.da.vs))));Ia.Task.Ua(!0)}LTh(tb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?tb>=this.da.yn.clientHeight-te.a.ey?(this.XKa(ze.HORIZONTAL),!1):!0:!0}PTh(tb){return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?
tb>=this.da.yn.clientWidth-te.a.ey?(this.XKa(ze.VERTICAL),!1):!0:!0}XKa(tb){tb=void 0===tb?ze.BOTH:tb;tb!==ze.HORIZONTAL&&tb!==ze.BOTH||!ne.wEa||(this.da.yn.removeChild(ne.wEa),ne.wEa=null);tb!==ze.VERTICAL&&tb!==ze.BOTH||!ne.sea||(this.da.yn.removeChild(ne.sea),ne.sea=null);return Ia.Task.Ua(!0)}L0(tb,lc,Tc){return tb.RU(Md.a.vi(lc,Tc))}Vwa(tb,lc,Tc){const {rowNumber:md,columnNumber:sd}=ye.HRb(this.da);return this.L0(tb,md+lc,sd+Tc)}freezePanesRowAndColumnPreview(tb,lc){let Tc=!0,md=!0,sd=He.TOPLEFT;
var Zd=this.da.kj;if(!Zd)return ye.EP(this.da,tb,!1,"sheetProcessedData is not available."),Ia.Task.Ua(!1);lc=ye.getSelection(this.da.ha,lc,tb);if(!ye.oXb(this.da,lc))return ye.EP(this.da,tb,!0,"Preview not shown as selection is not in visible area"),Ia.Task.Ua(!0);switch(tb.command){case -1006176541:var Ae=this.da.fh.Gm;const Ze=this.da.fh.Ym,{EJ:Te,FB:We}=this.da.Q5(),qf=this.Vwa(Zd,0,0);var Ee=this.L0(Zd,Te.top,Te.left);const bf=this.L0(Zd,lc.top,lc.left);Zd=this.L0(Zd,Ae,Ze);Ae=We.x+Ee.xk-Zd.xk;
Ee=We.y+Ee.nk-Zd.nk;if(bf.nk===qf.nk&&bf.xk===qf.xk)return this.F2b(tb);if(bf.nk===qf.nk||bf.nk<=qf.nk||bf.sJ>=Zd.sJ&&bf.nk<Zd.nk+Ee)Tc=!1;if(bf.nk===qf.nk&&bf.xk===qf.xk||bf.xk<=qf.xk||bf.GI>=Zd.GI&&bf.xk<Zd.xk+Ae)md=!1;break;case -1156879868:sd=He.BOTTOMRIGHT;md=!1;break;case -1929078919:sd=He.BOTTOMRIGHT;Tc=!1;break;default:return ye.EP(this.da,tb,!1,"Unexpected preview Ribbon Command"),Ia.Task.Ua(!0)}md&&this.Sxb(lc,ze.VERTICAL,sd);Tc&&this.Sxb(lc,ze.HORIZONTAL,sd);ye.EP(this.da,tb,!0);return Ia.Task.Ua(!0)}F2b(tb){const {rowNumber:lc,
columnNumber:Tc}=ye.HRb(this.da),md=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?Ea.Range.vi(lc,Tc):this.da.R5();this.Sxb(md,ze.HORIZONTAL,He.BOTTOMRIGHT);ye.EP(this.da,tb,!0);return Ia.Task.Ua(!0)}Ybe(tb){const {rowNumber:lc,columnNumber:Tc}=ye.HRb(this.da),md=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?Ea.Range.vi(lc,Tc):this.da.R5();this.Sxb(md,ze.VERTICAL,He.BOTTOMRIGHT);ye.EP(this.da,tb,!0);return Ia.Task.Ua(!0)}}Object(L.a)(ne,
"FreezePanesPreviewManager",null,[]);var of;(function(tb){tb.HORIZONTAL="horizontal";tb.VERTICAL="vertical"})(of||(of={}));Object(L.b)("FreezePanesDragDirection",of);var lf;(function(tb){tb.HEADER="header";tb.FREEZEPANELINE="freezepaneline"})(lf||(lf={}));Object(L.b)("FreezePaneDragOrigin",lf);let jf=class{constructor(tb,lc){this.da=tb;this.uA=lc;this.Zdb=this.Ibb=null;this.uLe=!1;this.zbd=this.$db=this.Jbb=this.Y_e=this.tNe=null;this.vEa=this.SFa=lf.HEADER;this.Olg=Tc=>{Tc.preventDefault();this.tNe=
Tc.clientY;this.uA.startTrackAnimation(Tc,this.vEa===lf.HEADER?"freeze_pane_header_drag_horizontal":"freeze_pane_line_drag_horizontal");this.N5e(of.HORIZONTAL);this.TQ||(this.TQ=document.createElement("div"),this.TQ.classList.add(Mc.Db),this.da.yn.appendChild(this.TQ));this.zbd=this.da.yn.getBoundingClientRect();this.TQ.style.display="block";this.TQ.style.top=Tc.clientY/this.da.LW-this.zbd.top+"px";this.TQ.setPointerCapture(Tc.pointerId);this.TQ.style.cursor="grabbing";ye.dMc(this.da,this.vEa,of.HORIZONTAL,
"FreezePaneDragStarted");this.TQ.addEventListener("pointermove",this.Mlg);this.TQ.addEventListener("pointerup",this.Nlg);this.TQ.addEventListener("pointercancel",this.Llg)};this.msg=Tc=>{this.uA.startTrackAnimation(Tc,this.SFa===lf.HEADER?"freeze_pane_header_drag_vertical":"freeze_pane_line_drag_vertical");Tc.preventDefault();this.Y_e=Tc.clientX;this.N5e(of.VERTICAL);this.fR||(this.fR=document.createElement("div"),this.fR.classList.add(Mc.Ib),this.da.yn.appendChild(this.fR));this.fR.style.display=
"block";this.fR.style.left=Tc.clientX/this.da.LW+"px";this.fR.setPointerCapture(Tc.pointerId);this.fR.style.cursor="grabbing";ye.dMc(this.da,this.SFa,of.VERTICAL,"FreezePaneDragStarted");this.fR.addEventListener("pointermove",this.ksg);this.fR.addEventListener("pointerup",this.lsg);this.fR.addEventListener("pointercancel",this.jsg)};this.Mlg=Tc=>{const md=xb.HelperMethods.Ki(this.da.uC),sd=xb.HelperMethods.Ki(Tc.clientY/this.da.LW-this.zbd.top),Zd=`calc(100% - ${xb.HelperMethods.Ki(te.a.ey)} - 2px)`;
this.TQ.style.top=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?`clamp(${md}, ${sd}, ${Zd})`:sd;(this.Jbb=this.Awi(Tc))?this.rEa.Sxb(this.Jbb,0):this.rEa.XKa(0)};this.ksg=Tc=>{const md=this.da.rtl?xb.HelperMethods.Ki(te.a.ey):xb.HelperMethods.Ki(this.da.vs),sd=xb.HelperMethods.Ki(Tc.clientX/this.da.LW),Zd=`calc(100% - ${xb.HelperMethods.Ki(this.da.rtl?this.da.vs:te.a.ey)} - 2px)`;this.fR.style.left=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?
`clamp(${md}, ${sd}, ${Zd})`:sd;(this.$db=this.Wwi(Tc))?this.rEa.Sxb(this.$db,1):this.rEa.XKa(1)};this.Llg=Tc=>this.Klg(Tc,!0);this.jsg=Tc=>this.isg(Tc,!0);this.lsg=Tc=>this.isg(Tc,!1);this.Nlg=Tc=>this.Klg(Tc,!1);this.Klg=(Tc,md)=>{const sd=performance.now();ye.dMc(this.da,this.vEa,of.HORIZONTAL,md?"FreezePaneDragCancelled":"FreezePaneDragEnded");this.TQ.style.display="none";this.TQ.removeEventListener("pointermove",this.Mlg);this.TQ.removeEventListener("pointerup",this.Nlg);this.TQ.removeEventListener("pointercancel",
this.Llg);this.rEa.XKa(0);this.uA.stopTrackAnimation(this.vEa===lf.HEADER?"freeze_pane_header_drag_horizontal":"freeze_pane_line_drag_horizontal");if(this.tNe===Tc.clientY)return!0;this.Jbb?this.da.$.si(-73576432,2,30,{dragProperties:{dragDirection:of.HORIZONTAL,dragOrigin:this.vEa,target:this.bGh(this.Jbb),dragReleasedTime:sd}}):this.da.$.si(83934709,2,30,{dragProperties:{dragDirection:of.HORIZONTAL,dragOrigin:this.vEa,target:null,dragReleasedTime:sd,unfreeze:!0}});this.Jbb=null;return!0};this.isg=
(Tc,md)=>{const sd=performance.now();this.fR.style.display="none";ye.dMc(this.da,this.SFa,of.VERTICAL,md?"FreezePaneDragCancelled":"FreezePaneDragEnded");this.fR.removeEventListener("pointermove",this.ksg);this.fR.removeEventListener("pointerup",this.lsg);this.fR.removeEventListener("pointercancel",this.jsg);this.rEa.XKa(1);this.uA.stopTrackAnimation(this.SFa===lf.HEADER?"freeze_pane_header_drag_vertical":"freeze_pane_line_drag_vertical");if(this.Y_e===Tc.clientX)return!0;this.$db?this.da.$.si(-1564089444,
2,30,{dragProperties:{dragDirection:of.VERTICAL,dragOrigin:this.SFa,target:this.aGh(this.$db),dragReleasedTime:sd}}):this.da.$.si(83934709,2,30,{dragProperties:{dragDirection:of.VERTICAL,dragOrigin:this.SFa,target:null,dragReleasedTime:sd,unfreeze:!0}});this.$db=null;return!0};this.Awi=Tc=>{const {position:md,area:sd,wgf:Zd}=this.Nzf(Tc);if(!Zd)return null;if(md.y-sd.topLeft.y<sd.height/2){Tc=this.da.kj.RQb(Zd);Tc=Ea.Range.vi(Tc.top,Tc.left);if(Tc.equals(Zd))return null;const Ae=this.rEa.iHd(Tc);
return void 0!==Ae&&Ae.hAb<=this.da.uC?null:Tc}return Zd};this.Wwi=Tc=>{const {position:md,area:sd,wgf:Zd}=this.Nzf(Tc);if(null===Zd)return null;if(md.x-sd.topLeft.x<sd.width/2){Tc=this.da.kj.$Rb(Zd);Tc=Ea.Range.vi(Tc.top,Tc.left);if(Tc.equals(Zd))return null;const Ae=this.rEa.iHd(Tc);return void 0!==Ae&&Ae.Umb<=this.da.vs?null:Tc}return Zd};this.rEa=new ne(this.da)}tcj(){this.Ibb&&this.Zdb||(this.Ibb=ad.DOMElementExtensions.getElementById(this.da.yn,vc.a.iCf),this.Zdb=ad.DOMElementExtensions.getElementById(this.da.yn,
vc.a.jCf));this.uLe||(this.Ibb.addEventListener("pointerdown",this.Olg),this.Zdb.addEventListener("pointerdown",this.msg),this.uLe=!0)}a6g(tb,lc){tb?(this.Ibb.className=Mc.Eb,this.vEa=lf.FREEZEPANELINE):(this.Ibb.className=Mc.Jb,this.vEa=lf.HEADER);lc?(this.Zdb.className=Mc.Fb,this.SFa=lf.FREEZEPANELINE):(this.Zdb.className=Mc.Kb,this.SFa=lf.HEADER)}dispose(){this.Ibb.removeEventListener("pointerdown",this.Olg);this.Zdb.removeEventListener("pointerdown",this.msg);this.TQ&&this.da.yn.removeChild(this.TQ);
this.fR&&this.da.yn.removeChild(this.fR)}N5e(tb){const lc=this.da.fh;if(lc.Fy){var Tc=lc.IJ,md=lc.EL;tb===of.HORIZONTAL&&0<Tc?this.da.FC(Ea.Range.QU(lc.Gm,lc.Gm,!0),60,"FreezePaneDragAction.adjustScroll"):tb===of.VERTICAL&&0<md&&this.da.FC(Ea.Range.fY(lc.Ym,lc.Ym,!0),60,"FreezePaneDragAction.adjustScroll")}}Nzf(tb){var lc=new Sys.UI.DomEvent(tb);tb=new Sys.UI.Point(tb.clientX/this.da.LW,tb.clientY/this.da.LW);lc=this.da.ha.l4(tb,lc.target,-1,!0);const Tc=this.da.yl(lc,this.da.paneType,!0),md=this.da.sl(this.da.paneType);
return{position:Fd.a.fz(md.view.xn,this.da.domElement.parentNode,tb,this.da.rtl),area:Tc,wgf:lc}}bGh(tb){return tb&&tb.top===jc.a.Rk?Object(X.E)(this.da.kj.RQb(tb)):tb}aGh(tb){return tb&&tb.left===jc.a.Gk?Object(X.E)(this.da.kj.$Rb(tb)):tb}};jf=Object(J.__decorate)([Object(Ya.d)(Sa.Tc),Object(J.__param)(0,Object(Sa.id)()),Object(J.__param)(1,Object(Sa.Ed)())],jf);Object(L.a)(jf,"FreezePaneDragAction",null,[525,4]);var Cf=a(667),Gf=a(94);class Af{}Object(L.a)(Af,"FreezePanesCommandParameters",null,
[]);var Lf=a(407),Ef=a(32),Hf=a(311),$b=a(275);class Wb{constructor(tb){this.freezeOptions=null;this.freezeOptions=tb}getSheetName(){return this.freezeOptions.SheetName}}Object(L.a)(Wb,"MacroRecorderSheetPaneFrozenPayload",null,[60]);var Dc=a(44),Jf=a(308),Rb=a(19),Gb,Cc;(function(tb){tb[tb.horizontal=0]="horizontal";tb[tb.vertical=1]="vertical"})(Cc||(Cc={}));Object(L.b)("Direction",Cc);var cb;(function(tb){tb.DRAG_HANDLE="DRAG_HANDLE";tb.RIBBON="RIBBON"})(cb||(cb={}));Object(L.b)("FreezePanesRequestInitiator",
cb);let pc=Gb=class{constructor(tb,lc,Tc,md){this.$=tb;this.da=Tc;this.Qkb=this.Yee=null;this.OOb=this.ZDd=this.b9f=this.gtf=this.ujb=!1;this.Vja=Rb.a.CD;this.Qch=vc.a.kCf;this.sfh=vc.a.lCf;this.YId=this.KZa=this.T1a=!1;this.bba=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8683456_FreezePanePreviewRefactor");this.jNd=(sd,Zd,Ae,Ee)=>{const Ze=this.da.fh,Te=this.da.KR(),We=Ze.IJ,qf=Ze.EL;let bf=0,af=0,Nf=0,uf=0;const pf=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8528403_FixFreezePaneCalcWhenGridUnderPane");
switch(sd.command){case 1844679312:bf=Ae.top-1;af=Ae.left-1;Nf=bf-(Zd.top-1);uf=af-(Zd.left-1);pf&&Ze.Fy&&(We&&Te&&Nf>=Te.bottom-Te.top+1+We&&(Nf=We+(Ae.top-Te.top)+1),qf&&Te&&uf>=Te.right-Te.left+1+qf&&(uf=qf+(Ae.left-Te.left)+1));break;case -73576432:bf=Ae.top;Nf=bf-(Zd.top-1);pf&&Ze.Fy&&We&&Te&&Nf>=Te.bottom-Te.top+1+We&&(Nf=We+(Ae.top-Te.top)+1);Ee&&(af=Ze.Ym-1,uf=af-Zd.left+1,pf&&Ze.Fy&&qf&&Te&&uf>=Te.right-Te.left+1+qf&&(uf=qf+(Ze.Ym-Te.left)+1));break;case -1564089444:af=Ae.left,uf=af-(Zd.left-
1),pf&&Ze.Fy&&qf&&Te&&uf>=Te.right-Te.left+1+qf&&(uf=qf+(Ae.left-Te.left)+1),Ee&&(bf=Ze.Gm-1,Nf=bf-Zd.top+1,pf&&Ze.Fy&&We&&Te&&Nf>=Te.bottom-Te.top+1+We&&(Nf=We+(Ze.Gm-Te.top)+1))}return{Qbe:bf,Pbe:af,cJd:Nf,bJd:uf}};this.Nkg=()=>{ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8593029_RevertFPLinesIfExist")&&(this.bba?this.LZa.XKa():this.exg());ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1)&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8551192_HighlightSelectionPostFreezeOp")&&
(this.da.Gh.Pzb(),this.da.Gh.Oca());if(this.Qkb){const sd=Hf.a(Ef.a.ih.$j,this.Qkb);Gb.oJ.totalDuration=sd;const Zd=Gb.oJ;this.gtf?window.requestIdleCallback?window.requestIdleCallback(()=>{this.z2e(Zd);this.S9d(Zd)}):window.setTimeout(()=>{this.z2e(Zd);this.S9d(Zd)},100):this.S9d(Zd)}Gb.oJ={};this.Qkb=null;this.cRc()};this.NSj=(sd,Zd)=>{var Ae,Ee,Ze,Te;Gb.oJ.EcsOperationDuration=null===(Ae=sd.RequestTelemetryData)||void 0===Ae?void 0:Ae.EcsOperationDuration;Gb.oJ.WfeRequestDuration=null===(Ee=sd.RequestTelemetryData)||
void 0===Ee?void 0:Ee.WfeRequestDuration;Gb.oJ.EcsRequestDurations=null===(Ze=sd.RequestTelemetryData)||void 0===Ze?void 0:Ze.EcsRequestDuration;Gb.oJ.isSuccessful=!(0<(null===(Te=sd.Errors)||void 0===Te?void 0:Te.length));this.T1a&&(Ae=!!sd&&!!sd.RequestTelemetryData,!Pa.a(sd)&&Zd&&Zd.correlationId&&this.da.Hk.D1(Zd.correlationId,sd.StateId,Ae?sd.RequestTelemetryData.EcsOperationDuration:0,Ae?sd.RequestTelemetryData.EcsRequestDuration:0,Ae?sd.RequestTelemetryData.WfeRequestDuration:0))};this.y8f=
()=>{if(this.Qkb){const sd=Hf.a(Ef.a.ih.$j,this.Qkb);Gb.oJ.lastCacheUpdateDuration=sd}};this.$=tb;this.da=xa.f(tb);this.gridInstantaneousAction=md;this.fN=lc.RMb(this.$.domElement,500,null,null);this.ujb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8406295_AddFreezePanePropsTo8cadq");this.gtf=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8452940_AddGridContentPropsToFreezePaneTelemtry");this.b9f=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8606820_addHasPanesLogTo8cadq");this.OOb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8561471_EstimatePaneDataFix");
this.ZDd=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnablePaneEstimationForAllFpOps",!1);this.LZa=new ne(this.da);this.T1a=ea.EwaSettings.pob();ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&(this.Pna=document.getElementById(this.Qch),this.T2=document.getElementById(this.sfh));this.KZa=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",
!1);this.YId=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8797568_FreezePaneDragTelemetry")}Ri(tb,lc,Tc){let md=!1;switch(lc){case 1844679312:md=1!==tb&&!this.da.fh.Fy;break;case -73576432:case -1564089444:if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",!1)&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8764078_EnableFPCommandsForDrag")){Tc&&"dragProperties"in Tc&&(md=!1);break}ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8475425_DisableFreezeUpToCommandsWhenSelectionNotCell")&&
(md=1!==tb);break;case -1006176541:case 179232729:case -1156879868:case -247664224:case -1929078919:md=!(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1))}this.$.ea.isEditMode||this.$.ea.Ih.allowViewCollab||(md=!0);return md}executeCommand(tb,lc,Tc){var md;tb=this.da.fh;const sd=null!==(md=this.da.emb())&&void 0!==md?md:this.da.R5();this.E6(lc);md=this.bba?ye.getSelection(this.da.ha,
sd,lc):this.getSelection(sd,lc);switch(lc.command){case 1844679312:return this.setFreezePanes(lc,sd,tb.pp);case 83934709:return this.N3g(lc,sd,Tc);case -73576432:return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.iwg(md,lc.command,lc.jk)?this.npe(lc,sd,!1,Tc):Ia.Task.Ua(!1):this.npe(lc,sd,tb.pp,Tc);case -1564089444:return ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.iwg(md,lc.command,lc.jk)?
this.mpe(lc,sd,!1,Tc):Ia.Task.Ua(!1):this.mpe(lc,sd,tb.pp,Tc);case 340334732:return tb.Iyc?Ia.Task.Ua(!1):this.jEk(lc,sd);case -806625837:return tb.V9a?Ia.Task.Ua(!1):this.kEk(lc,sd);case -1006176541:return this.bba?this.LZa.freezePanesRowAndColumnPreview(lc,sd):this.freezePanesRowAndColumnPreview(lc,sd);case -342472547:case 1558501543:case -2036655906:case 1870830702:case -1588000013:return this.bba?this.LZa.XKa():this.exg();case 179232729:if(this.bba)return this.LZa.F2b(lc);this.da.BK();return this.F2b(lc);
case -1156879868:return this.bba?this.LZa.freezePanesRowAndColumnPreview(lc,sd):this.freezePanesRowAndColumnPreview(lc,sd);case -247664224:if(this.bba)return this.LZa.Ybe(lc);this.da.BK();return this.Ybe(lc);case -1929078919:return this.bba?this.LZa.freezePanesRowAndColumnPreview(lc,sd):this.freezePanesRowAndColumnPreview(lc,sd)}return Ia.Task.Ua(!1)}Gi(tb,lc){tb=!1;switch(lc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:case 83934709:tb=!0;break;case -73576432:case -1564089444:tb=
ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1);break;case -1006176541:case -342472547:case 179232729:case 1558501543:case -1156879868:case -2036655906:case -247664224:case 1870830702:case -1929078919:case -1588000013:tb=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)}return tb}dj(){return!1}E6(tb){ra.AFrameworkApplication.ra.$g.ZI&&this.$.E6&&
(1844679312===tb.command||340334732===tb.command||-806625837===tb.command)&&Cf.a.GX(1,2)}iwg(tb,lc,Tc){const md=this.da.fh;if(!md.pp||this.KZa&&30===Tc||md.IJ&&md.EL)return!0;switch(lc){case -73576432:return tb.top!==md.Gm-1;case -1564089444:return tb.left!==md.Ym-1}return!1}CVb(tb,lc){return!tb||lc.topLeft.y>tb.bottomRight.y||lc.topLeft.x>tb.bottomRight.x||lc.bottomRight.y<tb.bottomRight.y||lc.bottomRight.x<tb.bottomRight.x?!1:!0}oXb(tb){if(this.da.bG(tb))return!0;for(const lc of this.da.Wu){if(!this.da.fh.JD(lc.paneType))continue;
const Tc=this.da.yl(tb,lc.paneType),md=lc.Vr;if(Tc&&md&&this.CVb(Tc,md))return!0}return!1}nBe(tb,lc,Tc,md){const sd=this.da.yl(tb),Zd=this.da.view.visibleArea;return(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.bba?ye.oXb(this.da,tb):this.oXb(tb):this.bba?ye.CVb(sd,Zd):this.CVb(sd,Zd))?0>=lc&&0>=Tc?(M.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),tb=xa.f(this.$).rtl?
1493:1492,lc=xa.f(this.$).rtl?-2131054257:-1953454131,tb=ha.a.nj(1,0,26,tb,0,lc,"FreezePaneA1SelectedErr"),this.oqf(this.$,tb,md),!1):!0:(M.ULS.sendTraceTag(537159583,0,50,ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8802624_FreezePanesToastForDragOutsideVP")?`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${tb}, rangeViewportArea=${sd?sd.toString():"null"}, visibleArea=${Zd.toString()}, requestInitiator=${md}`:`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${tb}, rangeViewportArea=${sd?
sd.toString():"null"}, visibleArea=${Zd.toString()}`),tb=ha.a.nj(1,0,26,1491,0,2105967339,"FreezePaneSelectionNotInViewErr"),this.oqf(this.$,tb,md),!1)}getSelection(tb,lc){var Tc=this.da.ha.qa;const md=Tc.activeCell.clone();Tc=Tc.activeRange;Tc.lk&&(M.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${md.top}) and firstUnfreezeCell.Bottom (${md.bottom}) to equal topLeftRange.Top (${tb.top})`),md.top=md.bottom=tb.top);
Tc.isRow&&(M.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${md.left}) and firstUnfreezeCell.Right (${md.right}) to equal topLeftRange.Left (${tb.left})`),md.left=md.right=tb.left);if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(lc.command){case -73576432:case -1156879868:md.top===md.maxRows&&(md.top=md.bottom=md.maxRows-1);break;case -1564089444:case -1929078919:md.left===
md.maxColumns&&(md.left=md.right=md.maxColumns-1)}return md}N3g(tb,lc,Tc){if(this.KZa&&Tc&&"dragProperties"in Tc){const md=Tc.dragProperties,sd=md.dragDirection;if("horizontal"===sd&&this.da.fh.JD(4))return this.da.fh.JD(3)?this.mpe(new Jb.a(-1564089444,tb.method,tb.mode,tb.jk,tb.tabName),lc,!1,{dragProperties:{dragDirection:"vertical",dragOrigin:md.dragOrigin,target:Ea.Range.fY(this.da.fh.Ym-1,this.da.fh.Ym,!1),unfreeze:!0}}):Ia.Task.Ua(!0);if("vertical"===sd&&this.da.fh.JD(3))return this.da.fh.JD(4)?
this.npe(new Jb.a(-73576432,tb.method,tb.mode,tb.jk,tb.tabName),lc,!1,{dragProperties:{dragDirection:"horizontal",dragOrigin:md.dragOrigin,target:Ea.Range.QU(this.da.fh.Gm-1,this.da.fh.Gm,!1),unfreeze:!0}}):Ia.Task.Ua(!0)}this.Wud(Tc);return this.Cwb(tb,!1,0,0,0,0,lc,null)}setFreezePanes(tb,lc,Tc){if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)||!Tc){Tc=this.bba?ye.getSelection(this.da.ha,lc,tb):this.getSelection(lc,tb);Tc.top===lc.top&&Tc.left===lc.left&&(Tc=
Ea.Range.vi(Tc.top+1,Tc.left));const {Qbe:md,Pbe:sd,cJd:Zd,bJd:Ae}=this.jNd(tb,lc,Tc,!1);return this.nBe(Tc,Zd,Ae,cb.RIBBON)?this.Cwb(tb,!0,md,sd,Zd,Ae,lc,Tc):(this.$.Dm(),this.cRc(),Ia.Task.Ua(!0))}return this.N3g(tb,lc)}tJf(tb,lc){const Tc=this.da.kj;let md=null;lc===Cc.vertical?md=Tc.WZa(tb):lc===Cc.horizontal&&(md=Tc.G_a(tb));if(md&&md!==tb)return new Ea.Range(md.top,md.left,md.bottom,md.right,!1,!1);M.ULS.sendTraceTag(507790169,0,50,`Could Not get First Scrollable Cell for : ${lc===Cc.horizontal?
"horizontal":"vertical"}`);return tb}TEf(tb,lc,Tc){return this.KZa&&Tc&&"dragProperties"in Tc?(tb=Tc.dragProperties,lc=tb.dragDirection,{X0d:tb.target,IUd:tb.unfreeze?!1:this.da.fh.JD(3)&&"vertical"===lc||this.da.fh.JD(4)&&"horizontal"===lc}):{X0d:this.bba?ye.getSelection(this.da.ha,lc,tb):this.getSelection(lc,tb),IUd:!1}}npe(tb,lc,Tc,md){if(Tc)return Ia.Task.Ua(!1);const {X0d:sd,IUd:Zd}=this.TEf(tb,lc,md),{Qbe:Ae,Pbe:Ee,cJd:Ze,bJd:Te}=this.jNd(tb,lc,sd,Zd);if(!this.nBe(sd,Ze,Te,md&&"dragProperties"in
md?cb.DRAG_HANDLE:cb.RIBBON))return this.$.Dm(),this.cRc(),Ia.Task.Ua(!0);this.Wud(md);return this.Cwb(tb,!0,Ae,Ee,Ze,Te,lc,this.OOb?this.tJf(sd,Cc.vertical):sd)}Wud(tb){var lc;if(this.YId&&this.KZa&&tb&&"dragProperties"in tb){tb=tb.dragProperties;const Tc=tb.dragReleasedTime;Gb.oJ.isDrag=!0;Gb.oJ.dragDirection=tb.dragDirection;Gb.oJ.dragOrigin=tb.dragOrigin;Gb.oJ.isUnfreezeFromDrag=null!==(lc=tb.unfreeze)&&void 0!==lc?lc:!1;Tc&&(Gb.oJ.dragReleaseToFreezeApplied=performance.now()-Tc)}}mpe(tb,lc,Tc,
md){if(Tc)return Ia.Task.Ua(!1);const {X0d:sd,IUd:Zd}=this.TEf(tb,lc,md),{Qbe:Ae,Pbe:Ee,cJd:Ze,bJd:Te}=this.jNd(tb,lc,sd,Zd);if(!this.nBe(sd,Ze,Te,md&&"dragProperties"in md?cb.DRAG_HANDLE:cb.RIBBON))return this.$.Dm(),this.cRc(),Ia.Task.Ua(!0);this.Wud(md);return this.Cwb(tb,!0,Ae,Ee,Ze,Te,lc,this.OOb?this.tJf(sd,Cc.horizontal):sd)}jEk(tb,lc){let Tc=0;const md=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");md&&(Tc=ye.HRb(this.da).columnNumber);return this.Cwb(tb,
!0,0,md?Tc:lc.left,0,md?Tc-lc.left+1:1,lc,null)}kEk(tb,lc){let Tc=0;const md=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");md&&(Tc=ye.HRb(this.da).rowNumber);return this.Cwb(tb,!0,md?Tc:lc.top,0,md?Tc-lc.top+1:1,0,lc,null)}oqf(tb,lc,Tc){this.KZa&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8802624_FreezePanesToastForDragOutsideVP")&&Tc===cb.DRAG_HANDLE?this.LUg(wa.a.instance.ia(2560)):ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",
!1)?this.LUg(wa.a.instance.ia(2427)):this.Ip(tb,lc)}LUg(tb){tb=Jf.a.eB.VK.PX(tb,!1);tb.image=tc.a.Xob()?1:0;Jf.a.eB.VK.EF(tb)}Ip(tb,lc){new fb.a(this.$,lc)}Cwb(tb,lc,Tc,md,sd,Zd,Ae,Ee){var Ze;this.Yee=Dc.a(this.$).dua(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.ujb&&this.da.za.nz(this.y8f);this.da.d$(this.Nkg);this.fN.f9a();this.da.WUk(lc?"":"UnsetFreezePane");const Te=Object(kc.a)(new Af,{SheetName:null===(Ze=this.$.ma)||void 0===Ze?void 0:Ze.name,Freeze:lc,FrozenRows:sd,FrozenColumns:Zd,
FirstRow:Tc,FirstColumn:md});M.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${lc}, FrozenRows=${sd}, FrozenColumns=${Zd}, FirstRow=${Tc}, FirstColumn=${md} `);const We=()=>new Wb(Te),qf=sa.a.create().toString();this.ujb&&(Gb.oJ.isFreeze=lc,Gb.oJ.operationType=oe.a(tb.command),Gb.oJ.frozenRows=sd,Gb.oJ.frozenColumns=Zd,Gb.oJ.firstRow=Tc,Gb.oJ.firstColumn=md,Gb.oJ.referencedBlocksBefore=this.da.za.MBc(),this.b9f&&(Gb.oJ.hasPanes=this.da.fh.Fy));this.Qkb=
Ef.a.ih.$j;this.T1a&&this.g2k(tb,Te,Ae,Ee,qf);return Y.a(this.$.userOperationManager,(bf,af,Nf)=>{if(ea.EwaSettings.Ra(59)){var uf=window.performance;uf.clearMarks();uf.mark("FreezePanes request sent")}uf=this.da.kj;var pf=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth"),ff=this.da.fh.pp;pf=pf?ff||!lc:!0;uf&&(pf||this.ZDd)?this.OOb&&ff?this.$.ZC():(uf=this.Guf(Te,uf,Ae,Ee),this.a2k(uf)):this.$.ZC();ff=ca.c(bf,this.NSj);uf=this.$.pa.ta;bf=this.ujb?ff:bf;ff=this.T1a?{setPanes:lc,correlationId:qf}:
lc;pf=uf.$a(9,null);pf.freezeSettings=Te;return ba.h(uf,"FreezeOrUnfreezePanes",pf,bf,af,Nf,ff,0)},bf=>new ja.a(151,0,bf,void 0,We),tb)}g2k(tb,lc,Tc,md,sd){M.ULS.sendTraceTag(507577612,0,50,"FreezePanesCommandHandler.triggerFreezePaneCSE triggerFreezePaneCSE Initiated ");const Zd=this.da.kj;this.da.fh.pp?M.ULS.sendTraceTag(507574365,0,15,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${tb.command}, parameter = ActiveSheetProcessedData, value = null reason = No active sheet processed data`):
(this.gridInstantaneousAction.Oge(),window.setTimeout(()=>{this.da.Hk.zza();this.da.Hk.lQ(23,sd,oe.a(tb.command));const Ae={Oz:this.Guf(lc,Zd,Tc,md)};this.gridInstantaneousAction.msd(tb.command,void 0,Ae);M.ULS.sendTraceTag(507585429,0,50,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${tb.command}, parameter = FreezePaneCSEAttempted, value = Success reason = Initiated FreezePane CSE`)},10))}Guf(tb,lc,Tc,md){M.ULS.shipAssertTag(537159580,1,!!lc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");
if(!tb.Freeze)return null;const sd=$b.a();sd.State=1;sd.IsEstimated=!0;let Zd=!1,Ae=!1;const Ee=lc.RU(Ea.Range.vi(Tc.top,Tc.left));if(null===Ee)return M.ULS.sendTraceTag(507893269,1,50,"EstimatePaneViewDataOnPaneRequest.topLeftAllPanesOffsetData Null"),null;let Ze=tb.FrozenRows;var Te=tb.FrozenColumns;1!==tb.FrozenRows||tb.FrozenColumns?tb.FrozenRows||1!==tb.FrozenColumns?(Te=lc.RU(Ea.Range.vi(tb.FirstRow+1,tb.FirstColumn+1)),lc=lc.RU(Ea.Range.vi(Tc.top,Tc.left)),sd.Width=Te.xk-Ee.xk,sd.Height=Te.nk-
Ee.nk,this.OOb&&(0>sd.Width?sd.Width=0:sd.Width,0>sd.Height?sd.Height=0:sd.Height),0<tb.FrozenRows&&(sd.AbsoluteTop=Te.nk,Ae=!0),0<tb.FrozenColumns&&(sd.AbsoluteLeft=Te.xk,Zd=!0),Ze=Te.sJ-lc.sJ,Te=Te.GI-lc.GI):(sd.Width=lc.gCc(Md.a.vi(Tc.top,Tc.left)),md=Ea.Range.vi(Tc.top,Tc.left+1),sd.AbsoluteLeft=Ee.xk+sd.Width,Zd=!0):(sd.Height=lc.dCc(Md.a.vi(Tc.top,Tc.left)),md=Ea.Range.vi(Tc.top+1,Tc.left),sd.AbsoluteTop=Ee.nk+sd.Height,Ae=!0);Ae&&(sd.FirstFrozenRow=Tc.top,sd.FirstScrollableRow=md.top);Zd&&
(sd.FirstFrozenColumn=Tc.left,sd.FirstScrollableColumn=md.left);sd.VisibleRows=Ze;sd.VisibleColumns=Te;return sd}a2k(tb){Ia.Task.delay(this.$.ua.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.ma&&this.$.ea&&(this.$.ea.P8(jc.a.Dk,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Lf.b(this.$.ma,tb,-1,void 0,!0))})}cRc(){this.fN.l9a();Gf.a.dh(this.Yee);this.Yee=null;this.da.h2(this.Nkg);this.ujb&&this.da.za.Zy(this.y8f)}S9d(tb){let lc=`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${tb.totalDuration} `;
if(this.ujb){var Tc=this.pRb();Tc&&(Tc=this.da.oh.LBc(Array(Tc)),tb.activeCells=Tc);tb.referencedBlocksAfter=this.da.za.MBc();tb.enabledExperiments=[];this.ZDd&&tb.enabledExperiments.push("paneEstimation");this.T1a&&tb.enabledExperiments.push("cseEnabled");this.KZa&&this.YId&&tb.enabledExperiments.push("freezePanesDrag");ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")&&ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1)&&
tb.enabledExperiments.push("freezePanesNewEntries");ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&tb.enabledExperiments.push("previewFreezePanes");lc+=bb.a.Ci(tb)}M.ULS.sendTraceTag(570949840,0,50,lc)}z2e(tb){let lc=0,Tc=0,md=0,sd=0;const Zd=new Set,Ae=new Set,Ee=new Set,Ze=xb.HelperMethods.jN(()=>{var Te=this.da.za.JJa(this.da.KR(),this.$.ma.name);if(Te)for(var We of Te)if(0!==We.Vs){if(Te=Oc.b(this.da.$,We.yj,!0))for(var qf of Te){Te=qf.type;const bf=qf.Wq;
if(""!==bf||null!=bf)2===Te?Ae.add(bf):1===Te&&Ee.add(bf)}if(We.jKb)for(const bf of We.jKb)Zd.add(bf.Id);qf=We.Pi;We=We.tKa();if(We=null===We||void 0===We?void 0:We.Cells)for(const bf of We)if(We=this.da.za.cJf(qf,bf.Row,bf.Col))lc+=We.$F?1:0,md+=We.XR?1:0,sd+=We.g0a?1:0,Tc+=We.HC?1:0;break}});tb.mergedCells=lc;tb.formulaCells=Tc;tb.conditionalFormatting=md;tb.coloredCells=sd;tb.tables=Ae.size;tb.pivotTables=Ee.size;tb.floatingObjects=Zd.size;tb.gridContentLogTime=Ze}pRb(){const tb=this.da.R5(),lc=
this.da.Uzc();return null===tb||null===lc?null:new Ea.Range(tb.top,tb.left,lc.bottom,lc.right,!0,!0)}L0(tb,lc,Tc){return tb.RU(Md.a.vi(lc,Tc))}Ybe(tb){const lc=this.da.fh.EL;var {FB:Tc}=this.da.Q5(),md=this.da.kj;if(null===md)return this.EP(tb,!1,"sheetProcessedData is not available."),Ia.Task.Ua(!1);const sd=this.Vwa(md,0,0);md=this.Vwa(md,0,1);Tc=this.da.vs+md.xk-(Tc.x+sd.xk);0<lc&&(Tc=this.da.vs+md.xk-sd.xk);if(null!==this.T2)this.da.rtl?this.T2.style.right=xb.HelperMethods.Ki(Tc):this.T2.style.left=
xb.HelperMethods.Ki(Tc),this.T2.classList.remove(this.Vja);else return this.EP(tb,!1,"verticalPreviewBar is null"),Ia.Task.Ua(!0);this.EP(tb,!0);return Ia.Task.Ua(!0)}F2b(tb){const lc=this.da.fh.IJ;var Tc=this.da.kj;if(null===Tc)return this.EP(tb,!1,"sheetProcessedData is not available."),Ia.Task.Ua(!1);({FB:sd}=this.da.Q5());const md=this.Vwa(Tc,0,0);Tc=this.Vwa(Tc,1,0);var sd=this.da.uC+Tc.nk-(sd.y+md.nk);0<lc&&(sd=this.da.uC+Tc.nk-md.nk);if(null!==this.Pna)this.Pna.style.top=xb.HelperMethods.Ki(sd),
this.Pna.classList.remove(this.Vja);else return this.EP(tb,!1,"horizontalPreviewBar is null"),Ia.Task.Ua(!0);this.EP(tb,!0);return Ia.Task.Ua(!0)}freezePanesRowAndColumnPreview(tb,lc){let Tc,md;let sd=!0,Zd=!0;const Ae=this.da.fh.IJ,Ee=this.da.fh.EL,Ze=this.da.fh.Gm,Te=this.da.fh.Ym,{EJ:We,FB:qf}=this.da.Q5();var bf=this.da.kj;if(null===bf)return this.EP(tb,!1,"sheetProcessedData is not available."),Ia.Task.Ua(!1);const af=this.Vwa(bf,0,0);lc=this.getSelection(lc,tb);if(!this.oXb(lc))return this.EP(tb,
!0,"Preview not shown as selection is not in visible area"),Ia.Task.Ua(!0);var Nf=this.L0(bf,We.top,We.left);const uf=this.L0(bf,lc.top+0,lc.left+0);var pf=this.L0(bf,lc.top+1,lc.left);const ff=this.L0(bf,lc.top,lc.left+1);bf=this.L0(bf,Ze,Te);const Qa=qf.x+Nf.xk-bf.xk;Nf=qf.y+Nf.nk-bf.nk;if(-1006176541===tb.command){pf=uf;if(uf.nk===af.nk&&uf.xk===af.xk)return this.F2b(tb);if(uf.nk===af.nk||uf.nk<=af.nk||uf.sJ>=bf.sJ&&uf.nk<bf.nk+Nf)sd=!1}sd&&(md=this.da.uC+pf.nk-Nf,0<Ae&&(md=lc.top<Ze?this.da.uC+
pf.nk-af.nk:this.da.uC+pf.nk-af.nk-Nf));if(-1006176541===tb.command){if(pf=uf,uf.nk===af.nk&&uf.xk===af.xk||uf.xk<=af.xk||uf.GI>=bf.GI&&uf.xk<bf.xk+Qa)Zd=!1}else pf=ff;Zd&&(Tc=this.da.vs+pf.xk-Qa,0<Ee&&(Tc=Te>lc.left?this.da.vs+pf.xk-af.xk:this.da.vs+pf.xk-af.xk-Qa));if(null!==this.Pna&&sd)this.Pna.style.top=xb.HelperMethods.Ki(md),this.Pna.classList.remove(this.Vja);else if(sd)return this.EP(tb,!1,"horizontalPreviewBar is null"),Ia.Task.Ua(!0);if(null!==this.T2&&Zd)this.da.rtl?this.T2.style.right=
xb.HelperMethods.Ki(Tc):this.T2.style.left=xb.HelperMethods.Ki(Tc),this.T2.classList.remove(this.Vja);else if(Zd)return this.EP(tb,!1,"verticalPreviewBar is null"),Ia.Task.Ua(!0);-1156879868===tb.command&&this.T2.classList.add(this.Vja);-1929078919===tb.command&&this.Pna.classList.add(this.Vja);this.EP(tb,!0);return Ia.Task.Ua(!0)}exg(){this.T2&&(this.T2.style.left=null,this.T2.style.right=null,this.T2.classList.contains(this.Vja)||this.T2.classList.add(this.Vja));this.Pna&&(this.Pna.classList.contains(this.Vja)||
this.Pna.classList.add(this.Vja));return Ia.Task.Ua(!0)}EP(tb,lc,Tc){if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var md="FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",sd={};sd.operationType=oe.a(tb.command);sd.isSuccessful=lc;sd.preExistingPanes=this.da.fh.Fy;sd.message=Tc?Tc:"";md+=bb.a.Ci(sd);M.ULS.sendTraceTag(507655369,0,50,md)}}Vwa(tb,lc,Tc){var md;const sd=null!==(md=this.da.emb())&&void 0!==md?md:this.da.R5();md=this.da.maa(!0);const Zd=
this.da.maa(!1);return this.L0(tb,(md>sd.top?md:sd.top)+lc,(Zd>sd.left?Zd:sd.left)+Tc)}};pc.oJ={};pc=Gb=Object(J.__decorate)([Object(Ya.d)(Sa.Uc),Object(J.__param)(0,Object(Sa.Nb)()),Object(J.__param)(1,Object(Sa.Qf)()),Object(J.__param)(2,Object(Sa.id)()),Object(J.__param)(3,Object(Sa.gd)())],pc);Object(L.a)(pc,"FreezePanesCommandHandler",null,[34]);var Ic;let rd=Ic=class{constructor(tb,lc){this.da=tb;this.$=lc;this.selectedRanges=[];this.Qpf=this.h7a=this.Z5=this.CVf=this.o4b=this.voa=this.cXd=
!1;this.BPf=()=>{this.O3c(this.selectedRanges,!1);this.pSf();this.pt&&this.Mac(this.pt.uv,this.pt.YH,this.pt.isRow,!0,!0,!1);this.cXd=!0};this.APf=()=>{this.cXd=!1;this.O3c(this.selectedRanges,!0);this.pt&&this.FLa(this.pt.isRow)&&this.Mac(this.pt.uv,this.pt.YH,this.pt.isRow,!0,!0,!0)};this.voa=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8756282_HeaderInsertAllowedRefactor");this.o4b=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8797344_refactorGetAdjacentCellIndex");this.CVf=this.voa&&ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8797454_insertBasedOnAdjacentSelection");
this.Z5=ea.EwaSettings.eXd();this.h7a=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8805838_HeaderInsertRestrictOnFreezePane");this.Qpf=ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8819939_DisableHeaderInsertForSelectAll")}isHeaderInsertAllowed(tb,lc,Tc){return this.voa?this.St&&this.St.isRow===lc&&(this.St.YH===tb&&this.St.pya===Tc||this.St.sqd===tb&&this.St.pya===!Tc):this.FLa(lc)&&(!this.tLa(tb,lc)||!!this.Qnb(tb,lc,Tc))}JRf(tb,lc,Tc,md){md?(!this.pt||this.pt.YH===lc&&this.pt.isRow===Tc||this.JRf(this.pt.uv,
this.pt.YH,this.pt.isRow,!1),this.pt={isRow:Tc,YH:lc,uv:tb}):(this.pt&&this.pt.YH===lc&&this.pt.isRow===Tc||M.ULS.sendTraceTag(507581474,0,15,"HeaderInsert.headerCellHoveredCallback: Got unset hover event for a cell that was not previously hovered."),this.pt=void 0);this.FLa(Tc)&&!this.tLa(lc,Tc)&&this.Mac(tb,lc,Tc,!0,!0,!0)}headerInsertHitAreaHoveredCallback(tb,lc,Tc,md){md?(!this.St||this.St.YH===tb&&this.St.isRow===lc&&this.St.pya===Tc||this.headerInsertHitAreaHoveredCallback(this.St.YH,this.St.isRow,
this.St.pya,!1),this.voa?this.LPk(tb,lc,Tc):this.St={isRow:lc,YH:tb,sqd:void 0,pya:Tc}):(this.St&&this.St.YH===tb&&this.St.isRow===lc&&this.St.pya===Tc||M.ULS.sendTraceTag(507581473,0,15,"HeaderInsert.headerInsertHitAreaHoveredCallback: Got unset hover event for a hit region that was not previously hovered."),this.voa?this.pSf():this.St=void 0);!this.voa&&this.isHeaderInsertAllowed(tb,lc,Tc)&&(this.m6g(tb,lc,Tc),md?this.eVg(tb,lc,Tc):this.qSf(lc))}headerInsertButtonInvokedCallback(tb,lc,Tc){1!==this.da.ha.Ck&&
this.da.o8();if(this.CVf){var md=Tc;let Zd=this.Qnb(tb,lc,Tc);if(!Zd){var sd=-1;this.St.isRow===lc&&this.St.YH===tb?sd=this.St.sqd:M.ULS.sendTraceTag(507355294,0,15,"HeaderInsert.headerInsertButtonInvokedCallback: hoveredHitRegion should be set to the current cell at this point.");if(sd=this.Qnb(sd,lc,!Tc))md=!Tc,Zd=sd}null!==Zd&&void 0!==Zd?Zd:Zd=lc?Ea.Range.QU(tb,tb):Ea.Range.fY(tb,tb);this.da.$.si(md?lc?-1113896058:1415868706:lc?75170472:-612877076,2,32,{[vc.a.m7a]:[Zd]})}else tb=(md=this.tLa(tb,
lc))?[md]:[lc?Ea.Range.QU(tb,tb):Ea.Range.fY(tb,tb)],this.da.$.si(Tc?lc?-1113896058:1415868706:lc?75170472:-612877076,2,32,{[vc.a.m7a]:tb})}CDc(tb){var lc,Tc;tb=this.Qpf?tb.filter(md=>md.isRow!==md.lk):tb.filter(md=>md.isRow||md.lk);if(0!==this.selectedRanges.length||0!==tb.length)this.O3c(this.selectedRanges,!1),this.selectedRanges=tb,this.O3c(this.selectedRanges,!0),this.pt&&this.FLa(this.pt.isRow)&&this.Mac(this.pt.uv,this.pt.YH,this.pt.isRow,!0,!0,!0),this.voa||!this.St||this.St.isRow===(null===
(lc=this.pt)||void 0===lc?void 0:lc.isRow)&&this.St.YH===(null===(Tc=this.pt)||void 0===Tc?void 0:Tc.YH)||!this.FLa(this.St.isRow)||this.m6g(this.St.YH,this.St.isRow,this.St.pya)}Z2i(tb){tb?this.BPf():this.APf()}CPf(tb){tb?this.BPf():this.APf()}eVg(tb,lc,Tc){Tc||tb++;Tc=lc?Ea.Range.QU(tb,tb):Ea.Range.fY(tb,tb);lc=lc?Ic.MVf:Ic.EVf;this.da.Gh.tt(Tc,lc,!1);this.da.Gh.Nw(lc,void 0,void 0,ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8741722_HeaderInsertHighlightLag")?!0:void 0)}qSf(tb){this.da.Gh.Mq(tb?
Ic.MVf:Ic.EVf,ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8741722_HeaderInsertHighlightLag")?!0:void 0)}FLa(tb){var lc;if(ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8740942_DisableHeaderInsertEditing")){if(this.Z5&&this.cXd||!this.$.ea.isEditMode||this.da.isEditing)return!1;null!==(lc=this.bE)&&void 0!==lc?lc:this.bE=new Ka.a(this.$.sa);return!this.bE.Wj(tb?64:32)||this.$.vh.ME?!1:!0}this.bE||(this.bE=new Ka.a(this.$.sa));return this.bE.Wj(tb?64:32)&&this.$.ea.isEditMode&&!this.$.vh.ME}YHc(tb,
lc,Tc,md){if(!Tc&&tb===(lc?jc.a.Rk:jc.a.Gk))return!1;if(lc?this.da.fh.ETb:this.da.fh.VDc){const sd=lc?this.da.fh.Gm:this.da.fh.Ym;if(Tc&&sd===tb||!Tc&&(tb=null!==md&&void 0!==md?md:this.UQb(tb,lc,!0),Ic.eKc(tb,lc)&&sd===tb))return!1}return!0}O3c(tb,lc){tb.forEach(Tc=>{const md=Tc.isRow;if(this.FLa(md)){var sd=md?Tc.top:Tc.left,Zd=this.pkb(md,sd);this.h7a&&lc&&!this.YHc(sd,md,!0)||this.Ywb(Zd,sd,!0,lc?0:void 0);Tc=md?Tc.bottom:Tc.right;sd=Tc===sd?Zd:this.pkb(md,Tc);this.h7a&&lc&&!this.YHc(Tc,md,!1)||
this.Ywb(sd,Tc,!1,lc?0:void 0)}})}Mac(tb,lc,Tc,md,sd,Zd){md&&this.Ywb(tb,lc,!0,this.DMd(lc,Tc,!0,Zd));sd&&this.Ywb(tb,lc,!1,this.DMd(lc,Tc,!1,Zd))}cNk(tb,lc,Tc,md){if(!md)return!1;md=this.h7a?this.UQb(tb,lc,!Tc):void 0;if(this.h7a&&!this.YHc(tb,lc,Tc,md))return!1;const sd=!!this.tLa(tb,lc);return!sd&&this.pt&&this.pt.isRow===lc&&this.pt.YH===tb||this.Qnb(tb,lc,Tc)||!sd&&(this.h7a?(this.o4b?Ic.eKc(md,lc):md!==tb)&&this.tLa(md,lc):this.UWf(tb,lc,!Tc))?!0:!1}aNk(tb,lc,Tc,md){return this.FLa(lc)&&(!this.h7a||
this.YHc(tb,lc,Tc,md))&&(!this.tLa(tb,lc)||!!this.Qnb(tb,lc,Tc))}LPk(tb,lc,Tc){const md=this.UQb(tb,lc,!Tc);this.aNk(tb,lc,Tc,md)&&(this.Ywb(this.pkb(lc,tb),tb,Tc,1),this.eVg(tb,lc,Tc),this.St={isRow:lc,YH:tb,sqd:md,pya:Tc})}pSf(){if(this.St){var tb=this.St.isRow,lc=this.St.YH,Tc=this.St.pya;this.St=void 0;this.Ywb(this.pkb(tb,lc),lc,Tc,this.DMd(lc,tb,Tc,this.FLa(tb)));this.qSf(tb)}}m6g(tb,lc,Tc){var md,sd,Zd;const Ae=tb===(null===(md=this.pt)||void 0===md?void 0:md.YH)&&lc===(null===(sd=this.pt)||
void 0===sd?void 0:sd.isRow)?null===(Zd=this.pt)||void 0===Zd?void 0:Zd.uv:this.pkb(lc,tb);Ae&&this.Mac(Ae,tb,lc,Tc,!Tc,!0)}pkb(tb,lc){if(this.voa&&this.pt&&this.pt.isRow===tb&&this.pt.YH===lc)return this.pt.uv;tb=tb?this.da.Tbe:this.da.C2b;for(const Tc of tb)if(tb=Tc.ywi(lc))return tb}DMd(tb,lc,Tc,md){const sd=!!this.tLa(tb,lc),Zd=!!this.Qnb(tb,lc,Tc);if(this.St&&this.St.YH===tb&&this.St.isRow===lc&&this.St.pya===Tc&&(this.voa||!sd||Zd))return 1;if(this.voa){if(this.cNk(tb,lc,Tc,md))return 0}else if(this.pt&&
this.pt.isRow===lc&&this.pt.YH===tb&&!sd||Zd||!sd&&this.UWf(tb,lc,!Tc))return 0}Ywb(tb,lc,Tc,md){var sd;if(tb&&!tb.pQg(lc,Tc,md)){const Zd=this.UQb(lc,tb.isRow,!Tc);if(this.o4b?Ic.eKc(Zd,tb.isRow):Zd!==lc)null===(sd=this.pkb(tb.isRow,Zd))||void 0===sd?void 0:sd.pQg(Zd,!Tc,md)}}tLa(tb,lc){var Tc;return null===(Tc=this.selectedRanges)||void 0===Tc?void 0:Tc.find(md=>lc?md.isRow&&md.w2a(tb):md.lk&&md.v1a(tb))}Qnb(tb,lc,Tc){return this.selectedRanges.find(md=>lc?md.isRow&&(Tc?md.top===tb:md.bottom===
tb):md.lk&&(Tc?md.left===tb:md.right===tb))}UWf(tb,lc,Tc){Tc=this.UQb(tb,lc,Tc);return(this.o4b?Ic.eKc(Tc,lc):Tc!==tb)?!!this.tLa(Tc,lc):!1}UQb(tb,lc,Tc){const md=this.da.kj;if(this.o4b)return md.Q0(Tc?tb+1:tb-1,lc,Tc);if(lc)return tb=Md.a.vi(tb,1),Tc?md.WZa(tb).top:md.RQb(tb).top;tb=Md.a.vi(1,tb);return Tc?md.G_a(tb).left:md.$Rb(tb).left}static eKc(tb,lc){lc=lc?jc.a.Rk:jc.a.Gk;return 0<tb&&tb<=lc}};rd.MVf=[70,72];rd.EVf=[71,73];rd=Ic=Object(J.__decorate)([Object(Ya.d)(Sa.jd),Object(J.__param)(0,
Object(Sa.id)()),Object(J.__param)(1,Object(Sa.Nb)())],rd);Object(L.a)(rd,"HeaderInsert",null,[]);class Rd{constructor(tb,lc){this.selectedRanges=null;this.fRemoveOriginRef=!1;this.selectedRanges=tb;this.fRemoveOriginRef=lc}}Object(L.a)(Rd,"MacroRecorderImageInCellConvertToFloatingObjectPayload",null,[60]);var va=a(168),Bb=a(103);let Ac=class{constructor(tb,lc,Tc){this.bQj=md=>{let sd;!md||ha.a.jl(md.Errors)||fa.a.Im(sd=md.Result)?md&&ha.a.jl(md.Errors)&&M.ULS.sendTraceTag(509142304,0,50,`ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded with errors. Errors: ${ha.a.Yh(md.Errors)}`):
(M.ULS.sendTraceTag(509142305,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded"),va.a(this.$).c6a(3),Bb.a(this.$).yPa(1,sd))};this.aQj=()=>{M.ULS.sendTraceTag(509142303,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oFailed: operation failed")};this.$=tb;this.da=xa.f(this.$);this.SUh=lc;this.cyi=Tc;this.cYb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1);this.RVb=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateReferenceFloatingInCellImages",
!1);this.Yhj=ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CellImagesOnObjectUI",!1)}Ri(){return!1}executeCommand(tb,lc){ka.TaskExtensions.Gq();tb=X.t(this.da.ha.qa.selectedRanges,this.$);const Tc=lc.command;switch(Tc){case 2000316912:lc=this.hjf(tb,!0,lc);break;case 1983877126:lc=this.hjf(tb,!1,lc);break;case -1125542248:lc=this.popInCellImageToFloatingFromOnObjectUI();break;case 457756232:lc=this.ebk();break;default:return aa.a(Tc)}return lc||Ia.Task.Ua(!0)}Gi(tb,lc){tb=!1;switch(lc.command){case 457756232:case -1125542248:tb=
this.$.isEditMode&&this.cYb&&this.RVb&&this.Yhj;break;case 2000316912:case 1983877126:tb=this.$.isEditMode&&this.cYb&&this.RVb}return tb}dj(){return!1}popInCellImageToFloatingFromOnObjectUI(){if(!this.$.uy(null,!1))return Ia.Task.Ua(!0);this.SUh.Umd();return Ia.Task.Ua(!0)}ebk(){if(!(new Ka.a(this.$.sa)).Wj(1))return Ia.Task.Ua(!0);this.cyi.Umd();return Ia.Task.Ua(!0)}hjf(tb,lc,Tc){if(!this.$.uy(null,!1))return Ia.Task.Ua(!0);const md=()=>new Rd(tb,lc);return Y.a(this.$.userOperationManager,(sd,Zd,
Ae)=>{var Ee=this.$.pa.ta;sd=ca.c(sd,this.bQj);Zd=ca.b(Zd,this.aQj);const Ze=Ee.$a(41,null);Ze.selectedRanges=tb;Ze.fRemoveOriginRef=lc;return ba.h(Ee,"ConvertToFloatingE2o",Ze,sd,Zd,Ae,null,0)},sd=>new ja.a(268,0,sd,void 0,md),Tc)}};Ac=Object(J.__decorate)([Object(Ya.d)(Sa.sd),Object(J.__param)(0,Object(Sa.Nb)()),Object(J.__param)(1,Object(Sa.N)()),Object(J.__param)(2,Object(Sa.tc)())],Ac);Object(L.a)(Ac,"ImageInCellCommandHandler",null,[34]);var Nc=a(905),hd=a(906);class qd{constructor(tb,lc,Tc,
md){this.$=tb;this.Qz=lc;this.j$a=Tc;this.mhb=md}showTaskPane(tb,lc,Tc,md,sd,Zd,Ae,Ee){tc.a.Ut()?void Ya.a.resolve(Sa["if"],{va:0}).then(Ze=>Ze.PS("NameManagerTaskPane",this.Nt(tb,lc,Tc,md,sd,void 0,Zd,Ae,Ee))):Sd.a.cp().then(Ze=>{Ze.showTaskPane("NameManagerTaskPane",this.Nt(tb,lc,Tc,md,sd,void 0,Zd,Ae,Ee));return null}).catch(()=>{throw Error("showTaskPane: Error while opening task pane");})}updateTaskPane(tb,lc,Tc,md,sd,Zd,Ae,Ee,Ze){tc.a.Ut()?void Ya.a.resolve(Sa["if"],{va:0}).then(Te=>Te.updateTaskPane("NameManagerTaskPane",
this.Nt(tb,lc,Tc,md,sd,Zd,Ae,Ee,Ze))):Sd.a.cp().then(Te=>{Te.updateTaskPane("NameManagerTaskPane",this.Nt(tb,lc,Tc,md,sd,Zd,Ae,Ee,Ze));return null}).catch(()=>{throw Error("updateTaskPane: Error while opening task pane");})}hideTaskPane(){tc.a.Ut()?void Ya.a.resolve(Sa["if"],{va:0}).then(tb=>tb.hideTaskPane("NameManagerTaskPane")):Sd.a.cp().then(tb=>{tb.hideTaskPane("NameManagerTaskPane",2);return null}).catch(()=>{throw Error("hideTaskPane: Error while hiding task pane");})}LX(){this.A_g&&this.A_g()}getTitle(tb,
lc){switch(tb){case 1:return wa.a.instance.Ea(lc?1003:902);case 0:case 2:return wa.a.instance.Ea(901);default:return""}}Nt(tb,lc,Tc,md,sd,Zd,Ae,Ee,Ze){Tc={type:"NameManagerTaskPaneProps",activePage:tb,showLoader:Ae,rangePickerController:xa.f(this.$).co.A_a(),callbacks:Tc,items:lc,errors:Ee,updateView:md,toast:sd,filterCountMap:Ze};return Object.assign(new $d.a,{id:"NameManagerTaskPane",title:this.getTitle(tb,this.yob(lc)),actionButtonProps:Zd,contentProps:Tc,width:320,onOpen:()=>{this.Qz()},onClose:()=>
{this.j$a()},preventCloseCallback:Te=>{this.A_g=Te;ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8720866_XLONameManagerApplyChangesToast")?1===tb?this.mhb(lc):Te():Te()}})}yob(tb){return tb&&null===tb[0]?!0:!1}}Object(L.a)(qd,"NameManagerTaskPane",null,[544]);class je{constructor(tb,lc){this.Z0g=0;this.OWc=[];this.searchText="";this.Qz=()=>{this.RX.$Dh(this.yof);this.RX.aFh(this.E5g);this.RX.YBh(this.Kuc);this.RX.pz();this.$.gq(this.SNa)};this.callbacks={onItemClick:Tc=>{this.s3i(Tc)},onItemSave:(Tc,
md,sd,Zd,Ae)=>{this.LPf(Tc,md,sd,Zd,Ae)},onItemsDelete:Tc=>{Tc&&(this.OWc=Tc,this.RX.Kuc(Tc))},onSearch:(Tc,md)=>{this.searchText=Tc;this.$nc=md;if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)){M.ULS.sendTraceTag(507610080,Nc.a.e4a,hd.a.info,bb.a.Ci({isSearching:""!==Tc,sortBy:md.sortBy,sortOrder:md.sortOrder,filterBy:md.filterBy}));const sd=lb.filterBy(this.items,md.filterBy);Tc=lb.search(sd,Tc);md=lb.iQd(Tc,md.sortBy,md.sortOrder);this.Q8(0,void 0,md)}else M.ULS.sendTraceTag(507581340,
Nc.a.e4a,hd.a.info,"NameManagerTaskPaneController.callbacks Search functionality is used"),md=lb.search(this.items,Tc),this.Q8(0,void 0,md)},onCloseButtonClick:(Tc,md,sd,Zd,Ae)=>{lb.S6i(Tc,md,sd,Zd,this.getDefinedNames())?(this.M5b={name:Tc,reference:md,comment:sd,type:Ae,runtimeUid:Zd,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""},this.toast=this.KCc(wa.a.instance.Ea(915),wa.a.instance.Ea(916),()=>{this.LPf(Tc,md,sd,Zd,Ae)},!0,()=>{this.Erb.LX()}),this.Q8(1,this.Rfb(),
[this.M5b],null)):this.Erb.LX()}};this.updateView=(Tc,md)=>{switch(Tc){case 1:case 3:this.Q8(Tc,this.Rfb(),[md]);break;case 0:this.Q8(Tc,void 0);break;default:this.Q8(Tc,this.Rfb())}};this.Rfb=()=>({label:wa.a.instance.Ea(903),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateView(0)},onTabKeyDown:()=>{}});this.yof=(Tc,md)=>{this.W0h();(null===md||void 0===md?0:md.bnj)?this.p5i():this.updateView(this.items?0:4)};this.E5g=(Tc,md)=>{let sd;Tc=null===md||void 0===md?void 0:md.status;
!Tc&&(sd=lb.dLi(md),null===sd||void 0===sd?0:sd.U$b)&&(this.toast=this.KCc(sd.U$b,null,null));Tc?this.Q8(0,null,this.getDefinedNames(),null===sd||void 0===sd?void 0:sd.Xdg):this.Q8(1,this.Rfb(),[this.M5b],null===sd||void 0===sd?void 0:sd.Xdg)};this.Kuc=(Tc,md)=>{(null===md||void 0===md?0:md.status)&&this.items&&(this.items=this.items.filter(sd=>!this.OWc.includes(sd.runtimeUid)));this.toast=(null===md||void 0===md?0:md.status)?this.ZYi(md):this.YYi(md);this.Q8(0,null,this.items,null)};this.SNa=(Tc,
md)=>{!md.dm&&this.Erb&&this.Erb.hideTaskPane()};this.j$a=()=>{this.RX.Vnk(this.yof);this.RX.Vok(this.E5g);this.RX.mmk(this.Kuc);this.RX.LA();this.$.Yu(this.SNa)};this.mhb=Tc=>{this.Q8(3,this.Rfb(),Tc)};this.$=tb;this.RX=lc;this.da=xa.f(tb);this.Erb=new qd(tb,this.Qz,this.j$a,this.mhb)}eQk(){this.Z0g=0;this.toast={sequenceNumber:0,message:"",actionButtonText:"",onActionButtonClick:null,autoHide:!1,onCloseButtonClick:null,allowDismiss:!1};this.$nc={filterBy:void 0,sortOrder:0,sortBy:0};this.Erb.showTaskPane(0,
this.getDefinedNames(),this.callbacks,this.updateView,this.toast,!0,void 0,this.filterCountMap);this.RX.vvg(!1)}Q8(tb,lc,Tc,md){this.Fai=tb;this.Erb.updateTaskPane(tb,Tc||this.getDefinedNames(),this.callbacks,this.updateView,this.toast,lc,!1,md,this.filterCountMap);this.M5b=null}s3i(tb){if(tb=lb.HJi(this.items,tb)){tb=X.kb(tb.reference.slice(1),this.$.listSeparator,this.$.sa);const lc=xa.f(this.$).ha;this.da.V0(tb&&tb.H7&&tb.sheetName?tb.H7:[lc.qa.saa],ea.EwaSettings.isChangeGateEnabled("OfficeVSO:8756334_NameManagerSelectionUpdateAfterDiscontinuousSelection")?
0:lc.qa.Jy,tb.sheetName,null,null,null,null,3,"NameManager.SelectNamedRange",null,null,null,!0)}}p5i(){switch(this.Fai){case 0:if(this.items)if(ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)){var tb=lb.filterBy(this.items,this.$nc.filterBy);tb=lb.search(tb,this.searchText);tb=lb.iQd(tb,this.$nc.sortBy,this.$nc.sortOrder);this.Q8(0,void 0,tb)}else tb=lb.search(this.items,this.searchText),this.Q8(0,void 0,tb);else this.updateView(4);break;case 4:this.updateView(this.items?
0:4);break;case 2:this.updateView(this.items?2:4)}}W0h(){const tb=this.RX.xYa;tb?(this.items=[],0!==tb.nameManagerItems.length&&(tb.nameManagerItems.forEach(lc=>{lc&&lc.metadata&&lc.metadata.isVisibleToNameManager&&this.items.push({runtimeUid:lc.metadata.runtimeUid,name:lc.name,reference:"="+lc.reference,comment:lc.comment,type:lb.IQi(lc.metadata.type),scope:lb.NVi(lc.scope),referenceSheetName:lc.referenceSheetName,isInvalidReference:lc.isInvalidReference,topLeft:lc.topLeft,bottomRight:lc.bottomRight})}),
this.items=lb.iQd(this.items,0,0),ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)&&(this.filterCountMap=lb.B3h(this.items)))):this.items=null}YYi(tb){return tb&&!tb.status&&tb.Jwb?lb.CZc(tb.Jwb)?this.KCc(lb.UFf("delete"),null,null):null:null}ZYi(tb){var lc,Tc;if(!tb||!tb.status||tb.Jwb)return null;tb=1===(null===(lc=this.OWc)||void 0===lc?void 0:lc.length)?wa.a.instance.Ea(908):String.format(wa.a.instance.Ea(909),null===(Tc=this.OWc)||void 0===Tc?void 0:
Tc.length);return this.KCc(tb,wa.a.instance.Ea(904),()=>{this.$.si(-1502853784,D.a.rh,12,null)})}getDefinedNames(){return this.items}KCc(tb,lc,Tc,md,sd){return tb?{sequenceNumber:++this.Z0g,message:tb,actionButtonText:lc,onActionButtonClick:Tc,autoHide:void 0===md?!0:md,onCloseButtonClick:void 0===sd?null:sd,allowDismiss:!0}:null}LPf(tb,lc,Tc,md,sd){const Zd=lb.Xcl(this.RX.N_d,tb,lc,Tc,sd);this.M5b={name:tb,reference:lc,comment:Tc,type:sd,runtimeUid:md,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,
referenceSheetName:""};0!==Zd.length?this.Q8(1,this.Rfb(),[this.M5b],Zd):this.RX.upsertDefinedName(tb,lc,Tc,md,Db[sd])}}Object(L.a)(je,"NameManagerTaskPaneController",null,[]);let Ie=class{constructor(tb,lc){this.eea=null;this.$=tb;this.RX=lc}Ri(){return!1}get xRc(){this.eea||(this.eea=new je(this.$,this.RX));return this.eea}executeCommand(tb,lc){tb=!1;lc=lc.command;switch(lc){case 1910465940:this.xRc.eQk(),tb=!0}return tb?Ia.Task.Ua(!0):aa.a(lc)}Gi(tb,lc){switch(lc.command){case 1910465940:return!0;
default:return!1}}dj(){return!1}};Ie=Object(J.__decorate)([Object(Ya.d)(Sa.Wd),Object(J.__param)(0,Object(Sa.Nb)()),Object(J.__param)(1,Object(Sa.zb)())],Ie);Object(L.a)(Ie,"NameManagerCommandHandler",null,[34]);var Oe=a(188);class Vb extends Oe.a{constructor(){super();this.zD=()=>{this.hide()}}showDialog(tb,lc){try{this.kl="OfficePyBlockPythonEditDialog",this.Ph=0,this.show({["type"]:"StandardDialogProps",["id"]:this.kl,["headerText"]:tb,["resultHandler"]:this.zD,["titleText"]:lc})}catch(Tc){this.g6c(tb,
lc)}}g6c(tb){const lc=new Ec.a(!1,!1,!1);lc.Ph=0;lc.kl="OfficePyBlockPythonEditLegacyDialog";lc.initializeAndShow(tb,this.Ldh,null)}Ldh(){this.hide()}}Object(L.a)(Vb,"OfficePyBlockPythonEditDialog",Oe.a,[]);let fd=class{constructor(tb){this.$=tb}Ri(){return!1}executeCommand(tb,lc){tb=!1;lc=lc.command;switch(lc){case 883532127:(new Vb).showDialog("Python is not supported in Excel for the web","Excel for the web does not support calculating or interacting with Python formulas. To use Python formulas, open this file with the desktop app for Windows."),
tb=!0}return tb?Ia.Task.Ua(!0):aa.a(lc)}Gi(tb,lc){switch(lc.command){case 883532127:return ea.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficePyUX",!1);default:return!1}}dj(){return!1}};fd=Object(J.__decorate)([Object(Ya.d)(Sa.ne),Object(J.__param)(0,Object(Sa.Nb)())],fd);Object(L.a)(fd,"OfficePyUXCommandHandler",null,[34]);var Qd=a(9),me=a(914);class se extends me.a{constructor(tb){super(tb)}Kt(){const tb=Object(da.d)(Ya.a.resolve(Sa.Qf,{va:this.xh})),lc=Object(da.d)(Ya.a.resolve(Sa.gd,
{va:this.xh}));ka.TaskExtensions.Xa(tb,Tc=>{Tc=Tc.result;const md=xa.f(this.$);this.Qr([new pc(this.$,Tc,md,lc.result)])},this.$.ya)}static Ba(tb){tb.la.Hh(116,new se(tb))}}Object(L.a)(se,"FreezePanesCommandHandlerFactory",me.a,[]);var Ne=a(428),Ue=a(921);class nf extends Ne.a{constructor(tb){super();this.$=tb;this.gm()}create(){tc.a.el()?void Ya.a.sj(Sa.wc).then(tb=>{this.Bk(Object(Ue.a)(this.$.la,502,()=>new Zc(this.$,tb)))}):this.Bk(Object(Ue.a)(this.$.la,502,()=>new Zc(this.$,null)))}static Ba(tb){tb.la.Hh(503,
new nf(tb))}}Object(L.a)(nf,"FontDropdownHelperFactory",Ne.a,[]);(()=>{Qd.a.gh(tb=>{Sa.Uc.Aa()||se.Ba(tb)})})();(()=>{Qd.a.gh(tb=>{Sa.vc.Aa()||nf.Ba(tb)})})();String(h);String(r);String(f);String(l);String(m);String(x);String(n);String(t);String(w);String(v);String(k);String(y);String(C);String(B);String(E);String(K);String(F);String(W);window.___1710758652272_closurehack=h;window.___1710758652272_closurehack=r;window.___1710758652272_closurehack=f;window.___1710758652272_closurehack=l;window.___1710758652272_closurehack=
m;window.___1710758652272_closurehack=x;window.___1710758652272_closurehack=n;window.___1710758652272_closurehack=t;window.___1710758652272_closurehack=w;window.___1710758652272_closurehack=v;window.___1710758652272_closurehack=k;window.___1710758652272_closurehack=y;window.___1710758652272_closurehack=C;window.___1710758652272_closurehack=B;window.___1710758652272_closurehack=E;window.___1710758652272_closurehack=K;window.___1710758652272_closurehack=F;window.___1710758652272_closurehack=W}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kpae.js.map/8fcd1fb4db137ed41ae2f3ca6ac32d4a/EwaTS.kpae.js.map