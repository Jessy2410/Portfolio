'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[16],{401:function(A,u,a){a.r(u);var c={};a.r(c);a.d(c,"EwaNotificationFocusManager",function(){return F});var b={};a.r(b);a.d(b,"FileOptimizationManager",function(){return Ua});var h={};a.r(h);a.d(h,"FormulaRemediationManager",function(){return Oa});var r={};a.r(r);a.d(r,"LineageDiscoverabilityCallout",function(){return ac});var f={};a.r(f);a.d(f,"OptimizeWorkbookManager",function(){return Db});var l={};a.r(l);a.d(l,
"ShowCalloutCommandHandler",function(){return ad});var m={};a.r(m);a.d(m,"TableIntelligenceDarkActivationManager",function(){return Id});var x={};a.r(x);a.d(x,"TableIntelligenceManager",function(){return Rb});var n=a(135),t=a(0),w=a(2),v=a(15),k=a(305),y=a(283),C=a(117),B=a(1284),E=a(95),K=a(5);let F=class{constructor(Gb){this.xtd=this.gId=null;this.$8c=this.isFocused=!1;this.$=Gb}dispose(){}get hj(){return null}get Zo(){return this.$8c}get hl(){return y.a.K7d}Vp(Gb,Cc){Cc||this.isFocused||!this.gId||
this.gId();return!Cc}tq(Gb){return Gb===document.activeElement&&this.isFocused}Qs(){this.isFocused=!0}nu(){this.isFocused&&this.xtd&&(this.xtd(),this.isFocused=!1)}gVf(){v.ULS.shipAssertTag(537169939,0,C.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");const Gb=Object(w.a)(new B.a,{onFirstActionableAppear:()=>{k.a(this.$).Tq(this);this.$8c=!0},onLastActionableDisappear:()=>{k.a(this.$).VH(this);
this.$8c=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(Gb).then(Cc=>{this.gId=()=>{Cc.focus()};this.xtd=()=>{Cc.blur()};return null})}};F=Object(n.__decorate)([Object(E.d)(K.Ob),Object(n.__param)(0,Object(K.Nb)())],F);Object(t.a)(F,"EwaNotificationFocusManager",null,[234,4,47]);var W=a(78),J=a(429),L;(function(Gb){Gb[Gb.Consent=0]="Consent";Gb[Gb.IndeterminateProgress=1]="IndeterminateProgress";Gb[Gb.DeterminateProgress=2]="DeterminateProgress";
Gb[Gb.Error=3]="Error"})(L||(L={}));class M extends J.a{constructor(Gb,Cc){super(Gb);Cc.initializeCallbacks=this.initializeCallbacks.bind(this);Gb=Object.assign({},{[M.xy]:this.Di,["hideCloseButton"]:!0},Cc);this.Vl=Cc.initialDialogState;this.initializeAndShow("",this.RNb,Gb)}get Di(){return"UserConsentBasedProgressDialog"}hide(Gb){Gb&&super.hide()}dispose(){super.dispose()}Lbj(Gb,Cc){this.csg=Gb;this.bsg=Cc}C3c(Gb){this.Vl=Gb.dialogState;this.C7k(Gb)}initializeCallbacks(Gb){this.C7k=Gb}RNb(Gb){1===
Gb?(this.Vl===L.Consent&&this.csg&&this.csg(),this.Vl===L.Error&&this.hide(!0)):2!==Gb&&0!==Gb||this.Vl!==L.Consent||(this.hide(!0),this.bsg&&this.bsg(),this.dispose())}}Object(t.a)(M,"UserConsentBasedProgressDialog",J.a,[]);var Q=a(12),H=a(188);class ba extends W.a{constructor(Gb){super();this.$=Gb}dispose(){var Gb;this.$=null;null===(Gb=this.Fta)||void 0===Gb?void 0:Gb.dispose();super.dispose()}M$i(Gb,Cc,cb){switch(Gb){case "NotStarted":this.bIi(Cc,cb)}}qQk(){this.nOk()}l_c(Gb){switch(Gb){case "NotStarted":case "Skipped":case "Automatic":this.mOk()}}rQk(){this.oOk()}nOk(){this.Fta?
this.C3c(L.IndeterminateProgress):this.rVf(!1)}mOk(){var Gb,Cc;(null===(Cc=null===(Gb=this.Fta)||void 0===Gb?void 0:Gb.vh)||void 0===Cc?0:Cc.hba)&&this.C3c(L.Error)}oOk(){var Gb,Cc;(null===(Cc=null===(Gb=this.Fta)||void 0===Gb?void 0:Gb.vh)||void 0===Cc?0:Cc.hba)&&this.Fta.hide(!0)}bIi(Gb,Cc){this.rVf(!0);this.Fta.Lbj(Gb,()=>{this.Fta=null;this.MOk(Gb,Cc)})}rVf(Gb){this.Fta||(Gb=this.OJi(Gb),this.Fta=new M(this.$,Gb))}MOk(Gb,Cc){v.ULS.sendTraceTag(507363655,0,50,"FileOptimizationUIController.showConfirmationDialog: User denied consent in optmization dialog.");
var cb=Q.a.instance.ia(2458),pc=Q.a.instance.ia(2459),Ic=Q.a.instance.ia(2460),rd=Q.a.instance.ia(2461);const Rd=new H.a;Rd.Ph=1;Rd.ti(1,Ic);Rd.ti(0,rd);Rd.hp(cb,pc,0,va=>{1===va?Gb():Cc()})}OJi(Gb){return Gb?{initialDialogState:L.Consent,initialDialogTitle:Q.a.instance.ia(2447),initialDialogDescription:Q.a.instance.ia(2448),okButtonLabel:Q.a.instance.ia(2449),cancelButtonLabel:Q.a.instance.ia(2450),knowMoreLinkLabel:Q.a.instance.ia(2451)}:{initialDialogState:L.IndeterminateProgress,initialDialogTitle:Q.a.instance.ia(2454),
initialDialogDescription:Q.a.instance.ia(2455),progressDescription:Q.a.instance.ia(2456),knowMoreLinkLabel:Q.a.instance.ia(2451)}}C3c(Gb){let Cc;switch(Gb){case L.IndeterminateProgress:Cc={dialogState:L.IndeterminateProgress,dialogTitle:Q.a.instance.ia(2454),dialogDescription:Q.a.instance.ia(2455),progressDescription:Q.a.instance.ia(2456)};break;case L.DeterminateProgress:Cc={dialogState:L.DeterminateProgress,dialogTitle:Q.a.instance.ia(2452),dialogDescription:Q.a.instance.ia(2453),progress:void 0,
progressDescription:Q.a.instance.ia(2456)};break;case L.Error:Cc={dialogState:L.Error,okButtonLabel:Q.a.instance.ia(2464),progressDescription:Q.a.instance.ia(2465)}}this.Fta.C3c(Cc)}}Object(t.a)(ba,"FileOptimizationUIController",W.a,[]);const U={rDa:"NotStarted",u6c:["Formulas"]},D={rDa:"Automatic"};var I=a(124),X=a(36),Y=a(1),ja;(ja||(ja={})).Formulas="Formulas";Object(t.b)("RemediationArea",ja);let Ua=class extends W.a{constructor(Gb){super();this.$=Gb;this.Hia=new Map;this.XTj=Cc=>{(this.nAa=Cc.Result)?
this.Pcl(this.nAa.u6c)?(v.ULS.sendTraceTag(507363658,0,50,`FileOptimizationManager.onGetOptimizationMetadataSuccess: OptimizationStage: ${this.nAa.rDa}.
       RemediationArea: ${this.nAa.u6c}.`),this.eyg(this.nAa.rDa)):"OptimizationNotRequired"!==this.nAa.rDa&&"Completed"!==this.nAa.rDa&&this.Oac(this.nAa.rDa,"Completed"):v.ULS.sendTraceTag(507363660,0,10,"FileOptimizationManager.onGetOptimizationMetadataSuccess: optimizationMetadata is null. Exiting optimization flow.")};this.Oac=(Cc,cb)=>{Cc!==cb&&(D.rDa=cb,this.P7a(pc=>{var Ic;pc=null===(Ic=pc.Result)||void 0===Ic?void 0:Ic.rDa;Cc===pc?(v.ULS.sendTraceTag(507330767,0,10,"FileOptimizationManager.onUpdateOptimizationStageSuccess: optimizationStage not updated."),
this.uZa.l_c(Cc)):this.eyg(pc)},D,1E3,pc=>{pc=(null===pc||void 0===pc?0:pc.data)?I.a.gk(pc.data):null;v.ULS.sendTraceTag(507332164,0,10,`FileOptimizationManager.onUpdateOptimizationStageFailure: ${X.a.Yh(pc)}`);this.uZa.l_c(Cc)},Cc))};this.initialize()}dispose(){var Gb;this.$=null;null===(Gb=this.ofc)||void 0===Gb?void 0:Gb.dispose();this.Rzi=this.ofc=null;super.dispose()}get uZa(){this.ofc||(this.ofc=new ba(this.$));return this.ofc}initialize(){const Gb=!this.$.ea.K_,Cc=this.$.isEditMode;Gb||!Cc?
v.ULS.sendTraceTag(507363661,0,50,`FileOptimizationManager.initialize: Exiting optimization flow. areCoauthorsPresent: ${Gb}, isEditMode: ${Cc}`):this.TRi()}TRi(){this.P7a(this.XTj,U,1E3)}eyg(Gb){switch(Gb){case "NotStarted":case "Skipped":this.a_i(Gb);break;case "Automatic":void this.Wdj()}}a_i(Gb){this.uZa.M$i(Gb,()=>{v.ULS.sendTraceTag(507363656,0,50,"FileOptimizationManager.OnUserConsentGiven: User provided consent.");this.Oac(Gb,"Automatic")},()=>{v.ULS.sendTraceTag(507363657,0,50,"FileOptimizationManager.OnUserConsentDenied: User denied consent.");
switch(Gb){case "Skipped":this.Oac(Gb,"OptimizationNotRequired");break;default:this.Oac(Gb,"Skipped")}})}Wdj(){const Gb=this;return Lo(function*(){var Cc;try{Gb.uZa.qQk();for(const cb of Gb.nAa.u6c){if(1===(null===(Cc=Gb.Hia.get(cb))||void 0===Cc?void 0:Cc.status))continue;const pc=yield Gb.NUi(cb);if(pc)try{const Ic=yield pc.Ejk();Gb.Hia.set(cb,{status:1,summary:Ic})}catch(Ic){v.ULS.sendTraceTag(507332163,0,10,`FileOptimizationManager.initiateAutomaticOptimization: ${null===Ic||void 0===Ic?void 0:
Ic.message}`),Gb.Hia.set(cb,{status:2,summary:null})}}Gb.Pkj()?(Gb.OUi(),Gb.uZa.rQk(),Gb.Oac("Automatic","Completed")):Gb.uZa.l_c("Automatic")}catch(cb){v.ULS.sendTraceTag(507332162,0,10,`FileOptimizationManager.initiateAutomaticOptimization: ${null===cb||void 0===cb?void 0:cb.message}`),Gb.uZa.l_c("Automatic")}})}NUi(Gb){const Cc=this;return Lo(function*(){switch(Gb){case ja.Formulas:return Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRemediation",!1)?yield Cc.Rzi(0):null;default:return null}})}Pcl(Gb){if(!Gb||
0===Gb.length)return v.ULS.sendTraceTag(507360341,0,50,"FileOptimizationManager.validateRemediationArea: No remediation area."),!1;for(const Cc of Gb)if(void 0!==ja[Cc])return!0;return!1}Pkj(){return Array.from(this.Hia.values()).every(Gb=>1===Gb.status)}OUi(){Array.from(this.Hia.values()).map(Gb=>Gb.summary)}P7a(Gb,Cc,cb,pc,Ic){setTimeout(()=>{const rd={};rd.Result=null!==Cc&&void 0!==Cc?Cc:Ic;Gb?Gb(rd):pc&&pc(null)},cb)}};Object(n.__decorate)([Object(K.Qc)({v1:!0})],Ua.prototype,"formulaRemediationManagerLazy",
void 0);Ua=Object(n.__decorate)([Object(E.d)(K.ic),Object(n.__param)(0,Object(K.Nb)())],Ua);Object(t.a)(Ua,"FileOptimizationManager",W.a,[]);var ka=a(773),fb=a(64);const ha={Geh:{SheetId1:3,SheetId2:2}},ea={Jbh:0,nFe:["=COUNTUNIQUE(A1:A7)","=ISBETWEEN(A1,A2,A3)","=ADD(A1,A7)"]},aa={Jbh:0,nFe:["=AVERAGE.WEIGHTED(A1:A4,A6:A9)","=DIVIDE(A8,A11)"]},ca={title:"50 formulas converted",description:"2300 cells optimized"};var xa=a(649);let Oa=class{constructor(Gb,Cc){this.$=Gb;this.pluginScheduler=Cc;this.NBa=
{};this.a0h=0;this.Ahj=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BrokenFormulasTelemetry",!1);this.T1g=Y.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.FormulaRemediationTranspilationChunkSize",250);this.Ejk=()=>new Promise((cb,pc)=>{const Ic=this;return Lo(function*(){try{cb(yield Ic.Xdj())}catch(rd){pc(Error("FormulaRemediationManager.remediate: "+(null===rd||void 0===rd?void 0:rd.message)))}})});this.Xdj=()=>new Promise((cb,pc)=>{const Ic=this;return Lo(function*(){try{yield Ic.Gcj();
if(!Ic.NBa||0===Object.keys(Ic.NBa).length){const Rd=yield Ic.RWi();for(const va in Rd)Ic.NBa[va]={$ml:Rd[va],Hia:0}}yield Ic.Fjk();const rd=yield Ic.PUi();Ic.gJh()?cb(rd):pc(Error("Automatic remediation failed."))}catch(rd){(null===rd||void 0===rd?0:rd.message)&&v.ULS.sendTraceTag(507332165,0,10,`FormulaRemediationManager.initiateAutomaticRemediation: ${rd.message}`),pc(Error("Automatic remediation failed."))}})});this.Fjk=()=>new Promise((cb,pc)=>{for(const Ic in this.NBa)1!==this.NBa[Ic].Hia&&
this.Gjk(Ic).then(()=>{this.NBa[Ic].Hia=1;this.xrd()&&cb()}).catch(rd=>{this.NBa[Ic].Hia=2;this.xrd()&&pc(rd)});this.xrd()&&cb()});this.Gjk=cb=>new Promise((pc,Ic)=>{const rd=this;return Lo(function*(){try{const Rd=yield rd.EZi(cb),va=yield rd.S1k(Rd);yield rd.m_h(cb,va);pc()}catch(Rd){Ic(Rd)}})});this.RWi=()=>new Promise((cb,pc)=>{this.P7a(Ic=>{var rd;(Ic=null===(rd=Ic.Result)||void 0===rd?void 0:rd.Geh)||pc(Error("onGetSheetsWithIncompatibleFormulasSuccess: data is null."));cb(Ic)},ha,3E3,Ic=>{Ic=
(null===Ic||void 0===Ic?0:Ic.data)?I.a.gk(Ic.data):null;pc(Error(`onGetSheetsWithIncompatibleFormulasFailure: ${X.a.Yh(Ic)}`))})});this.EZi=cb=>new Promise((pc,Ic)=>{let rd=ea;"SheetId2"===cb&&(rd=aa);this.P7a(Rd=>{var va;(Rd=null===(va=Rd.Result)||void 0===va?void 0:va.nFe)||Ic(Error("onGetUniqueIncompatibleFormulasSuccess: data is null."));pc(null!==Rd&&void 0!==Rd?Rd:[])},rd,1E3,Rd=>{Rd=(null===Rd||void 0===Rd?0:Rd.data)?I.a.gk(Rd.data):null;Ic(Error(`onGetUniqueIncompatibleFormulasFailure: ${X.a.Yh(Rd)}`))})});
this.S1k=cb=>new Promise((pc,Ic)=>{let rd=[],Rd=Math.ceil(cb.length/this.T1g);for(;0<cb.length;){const va=cb.splice(0,this.T1g);this.R1k(va).then(Bb=>{rd=[...rd,...Bb];1>--Rd&&pc(rd)}).catch(Bb=>{Ic(Error(`transpileFormulas: ${null===Bb||void 0===Bb?void 0:Bb.message}`))})}});this.m_h=(cb,pc)=>new Promise((Ic,rd)=>{this.P7a(()=>{Ic()},{SheetId:cb,hjl:pc},1E3,Rd=>{Rd=(null===Rd||void 0===Rd?0:Rd.data)?I.a.gk(Rd.data):null;rd(Error(`FormulaRemediationManager.onCommitOptimizedFormulasFailure: ${X.a.Yh(Rd)}`))})});
this.PUi=()=>new Promise((cb,pc)=>{this.P7a(()=>Lo(function*(){cb(ca)}),null,1E3,Ic=>{Ic=(null===Ic||void 0===Ic?0:Ic.data)?I.a.gk(Ic.data):null;pc(Error(`FormulaRemediationManager.onGetRemediationSummariesFailure: ${X.a.Yh(Ic)}`))})});this.Gcj=()=>new Promise((cb,pc)=>{const Ic=this;return Lo(function*(){try{const rd={payload:{incompatibilityType:xa.IncompatibilityType.GMove}};yield Ic.pluginScheduler.eventEmitter().FormulaTranspilerInitEvent(rd).then(()=>{cb()})}catch(rd){pc(Error("FormulaRemediationManager.initializeIncompatibilityType: "+
(null===rd||void 0===rd?void 0:rd.message)))}})});this.P1j=cb=>{cb.Result&&v.ULS.sendTraceTag(507883930,0,50,"FormulaRemediationManager.onbrokenFormulasTelemetrySuccess: broken formula found")};this.Ahj&&this.kzj()}dispose(){this.pluginScheduler=this.$=null}gJh(){return Object.values(this.NBa).every(Gb=>1===Gb.Hia)}xrd(){return Object.values(this.NBa).every(Gb=>0!==Gb.Hia)}R1k(Gb){const Cc=this;return Lo(function*(){var cb={formulaBatch:[]};for(const pc of Gb)cb.formulaBatch.push({formula:pc,refStyle:"R1C1"});
cb=yield Cc.pluginScheduler.requester().getTranspiledFormulas(cb,xa.PluginGroup.Excel,(Cc.a0h++).toString());if("Done"!==cb.kind)throw Error("Some Exception occurred at the FormulaTranspilerPlugin");return cb.payload.transpiledFormulas})}kzj(){var Gb=this.$.pa.ta,Cc=this.P1j;const cb=Gb.$a(1,null);fb.h(Gb,"BrokenFormulasTelemetry",cb,Cc,null,null,null,4)}P7a(Gb,Cc,cb,pc,Ic){setTimeout(()=>{const rd={};rd.Result=null!==Cc&&void 0!==Cc?Cc:Ic;Gb?Gb(rd):pc(null)},cb)}};Oa=Object(n.__decorate)([Object(E.d)(K.Qc),
Object(n.__param)(0,Object(K.Nb)()),Object(n.__param)(1,Object(ka.g)())],Oa);Object(t.a)(Oa,"FormulaRemediationManager",null,[877]);var ua=a(1460),Ia=a(1111),Sa=a(1112),Ya=a(183),da=a(182);class Ea{constructor(Gb){this.MP=null;this.$=Gb}show(){const Gb=this.OJa();v.ULS.shipAssertTag(537169938,0,!!Gb,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");da.a.zK().then(Cc=>{const cb=Cc.callout(Gb);this.MP=Cc.addNotification(cb)},Cc=>{v.ULS.sendTraceTag(537169936,0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${Cc}`);
return null})}dismiss(){this.MP&&da.a.zK().then(Gb=>{Gb.removeNotification(this.MP);return this.MP=null})}r$a(Gb){da.a.zK().then(Cc=>{Cc.updateNotification(this.MP,Cc.callout(Object.assign(new Ia.a,Gb)))},Cc=>{v.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${Cc}`);return null})}}Object(t.a)(Ea,"EwaReactCallout",null,[896]);class oa{static apb(Gb){return!!(Gb&1)}static rJc(Gb){return!!(Gb&2)}static l8g(Gb){return!!(Gb&oa.G$i)}}oa.G$i=6;Object(t.a)(oa,
"EwaReactCalloutModeUtil",null,[]);class za{constructor(){this.QO=0;this.iMa=null;this.g$b=!0}}Object(t.a)(za,"EwaReactShowOrDismissCalloutMetadata",null,[]);var la=a(61),Ca=a(39),Va=a(131),ia=a(607);class wa{constructor(Gb,Cc,cb){this.indexedDB=null;this.$=Gb;this.vO=Cc;this.RWa=cb}v2d(){const Gb=new Ya.a,Cc=new za;Ca.TaskExtensions.Xa(this.YOb(),cb=>{cb.result?Ca.TaskExtensions.Xa(this.indexedDB.fxa(this.vO),pc=>{if(pc=pc.result){pc=la.a.Sp(pc);if(!pc){this.Uyf(Gb);return}if(oa.apb(this.RWa)){const Ic=
pc.NumberOfDisplays;Cc.QO=Ic?Number.parseLocale(Ic):0}oa.rJc(this.RWa)&&(pc=pc.LastDisplay,Cc.iMa=pc?new Date(Number.parseLocale(pc)):null)}Gb.setResult(Cc)},this.$.ya):this.Uyf(Gb)},this.$.ya,3);return Gb.task}Rme(Gb){const Cc=new Ya.a;Ca.TaskExtensions.Xa(this.YOb(),cb=>{cb.result||Cc.setResult(!1);cb={};oa.apb(this.RWa)&&(cb.NumberOfDisplays=Gb.QO.toString());oa.rJc(this.RWa)&&(cb.LastDisplay=Va.toTimestamp(Gb.iMa).m.toString());cb=la.a.Ci(cb);Ca.TaskExtensions.Xa(this.indexedDB.lBa(new ia.a(this.vO,
cb)),pc=>{Cc.setResult(pc.result)},this.$.ya,3)},this.$.ya,3)}YOb(){const Gb=new Ya.a;this.indexedDB?Gb.setResult(!0):void E.a.resolve(K.vd,{va:1}).then(Cc=>{Cc.zl()?(Cc.initialize("Callouts","EwaCallouts"),this.indexedDB=Cc,Gb.setResult(!0)):(v.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),Gb.setResult(!1))});return Gb.task}Uyf(Gb){const Cc=new za;Cc.g$b=!1;Gb.setResult(Cc)}}Object(t.a)(wa,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",
null,[900]);class Jb{constructor(Gb,Cc,cb,pc,Ic,rd){this.Dgb=Cc;this.Fgb=cb;this.RWa=pc;this.vO=Ic;this.localStorage=rd;this.$=Gb}v2d(){const Gb=new Ya.a,Cc=new za;if(oa.apb(this.RWa)){let cb=0;Cc.g$b=(()=>{let pc=this.u3k();({Qba:cb}=pc);return pc})().returnValue&&Cc.g$b;Cc.QO=cb}Gb.setResult(Cc);return Gb.task}Rme(Gb){const Cc=new Ya.a;var cb=!0;if(oa.apb(this.RWa)){const pc=this.FEf();pc&&(cb=Number.parseLocale(pc),cb=this.e4k((cb&~this.Fgb|Gb.QO<<this.Dgb).toString()))}Cc.setResult(cb)}u3k(){var Gb;
return(Gb=this.FEf())?(Gb=(Number.parseLocale(Gb)&this.Fgb)>>this.Dgb,v.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.vO} already appeared. Found the callout in storage.`),{returnValue:!0,Qba:Gb}):{returnValue:!1,Qba:0}}e4k(Gb){try{if(!this.localStorage.zl())return!1;try{return this.localStorage.setItem("CalloutIds",Gb),!0}catch(Cc){v.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${Cc.message||
"Unknown"}`)}}catch(Cc){v.ULS.sendTraceTag(537169930,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${Cc.message}`)}return!1}FEf(){try{if(!this.localStorage.zl())return v.ULS.sendTraceTag(537169929,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.vO}.`),null;const Gb=this.localStorage.getItem("CalloutIds");
return Gb?Gb:(v.ULS.sendTraceTag(537169928,0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(Gb){return v.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${Gb.message}`),null}}}Object(t.a)(Jb,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[900]);var $a=a(65),Ka=a(154),nb=a(200),sa=a(155),na=
a(673);class ab extends Ea{constructor(Gb,Cc,cb,pc,Ic,rd,Rd,va,Bb,Ac,Nc,hd,qd,je,Ie,Oe,Vb,fd,Qd){Ac=void 0===Ac?!1:Ac;Nc=void 0===Nc?!1:Nc;hd=void 0===hd?!1:hd;qd=void 0===qd?!1:qd;je=void 0===je?!1:je;Ie=void 0===Ie?!0:Ie;Oe=void 0===Oe?!1:Oe;Vb=void 0===Vb?null:Vb;fd=void 0===fd?!1:fd;Qd=void 0===Qd?!1:Qd;super(Gb);this.QO=0;this.mCd=this.Tse=this.o5c=this.S9g=!1;this.Mog=()=>{this.JFc()};this.Z8c=Cc;this.Pse=cb;this.Ofi=pc;this.iB=Ic;this.fA=rd;this.localStorage=Bb;this.Y8c=Rd;this.X8c=va;this.$wj=
Ac;this.YRd=Nc;this.Rfi=hd;this.setInitialFocus=qd;this.useCoachmark=je;this.bXc=!1;this.JEk=Ie;this.C_b=this.bNd();this.Egb=Vb;this.Tse=fd;this.hasDynamicSizing=Oe;this.mCd=Qd}get Zeb(){return{}}NDe(){}XJa(){return 1}zAc(){return 0}get Qba(){return 1}get $wg(){return!0}get vO(){return this.Z8c}get Fgb(){return this.Y8c}get Dgb(){return this.X8c}show(){Ca.TaskExtensions.Xa(this.Vqa(),Gb=>{Gb.result&&this.Zse()},this.$.ya)}J8f(){sa.b(this.$).Aj(Ka.a.Fvf,this.sNf("dismiss"),void 0,!0)}R9f(){sa.b(this.$).Aj(Ka.a.Fvf,
this.sNf("show"),void 0,!0)}OJa(){var Gb=Object(w.a)(new ua.a,{label:this.Ofi,onExecute:()=>{this.NDe();this.J8f();this.o5c=!0;this.JFc()}});let Cc=null;this.YRd||(Cc=Object(w.a)(new ua.a,{label:this.Pse,onExecute:()=>{this.o5c=!0;this.R9f();const pc=nb.c({["InputMethod"]:$a.a.rh},this.Zeb);this.$.Ma.qh(this.ribbonCommandInfo,pc);this.JFc()}}));const cb=this.mCd||this.YRd?Gb:Cc;Gb=this.YRd?null:this.mCd?Cc:Gb;return Object(w.a)(new Ia.a,{target:this.uxa(),content:this.fA,title:this.iB,primaryButtonProps:cb,
secondaryButtonProps:Gb,showCloseIcon:this.Tse,preventLightDismiss:!this.$wj,hasDynamicSizing:this.hasDynamicSizing,calloutProps:Object(w.a)(new Sa.a,{onDismiss:()=>{this.JFc()},directionalHint:this.Egb,preventDismissOnScroll:!0,preventDismissOnResize:!this.Rfi,isBeakVisible:this.JEk,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}JFc(){this.S9g=!0;const Gb=E.a.nh(K.Ze);Gb&&Gb.Ynk(this.Mog);(this.$wg&&this.o5c||this.Tse)&&this.p3g(!0);
this.o5c||v.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.vO} was dismissed without user interaction`);this.dismiss()}Vqa(){const Gb=new Ya.a;this.bha()?Ca.TaskExtensions.Xa(this.C_b.v2d(),Cc=>{var cb=this.XJa();Cc=Cc.result;if(Cc.g$b)if(this.QO=Cc.QO,oa.apb(cb)&&(this.bXc||Cc.QO>=this.Qba))v.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.vO} already appeared. Found the callout in storage.`),this.bXc=!0,Gb.setResult(!1);else{if(oa.rJc(cb)&&
Cc.iMa&&(cb=Va.getElapsedSeconds(Cc.iMa,new Date),(Cc=this.zAc())||v.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.vO} with mode RestrictedBycooldown`),cb<Cc)){Gb.setResult(!1);return}cb=!this.MP&&!!this.uxa()&&!na.a(this.$);Gb.setResult(cb)}else Gb.setResult(!1),v.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.vO}.`)},this.$.ya):Gb.setResult(!1);return Gb.task}bha(){return!0}uxa(){if(document.querySelector(this.NV))return this.NV;
if(document.querySelector(this.MV))return this.MV;if(document.querySelector(this.sV))return this.sV;v.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.vO}`);return null}p3g(Gb){Gb=void 0===Gb?!1:Gb;this.bXc=!0;const Cc=new za;Cc.QO=Gb?this.Qba:this.QO+1;Cc.iMa=new Date;this.C_b.Rme(Cc)}Zse(){this.bXc=!0;this.p3g();v.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.vO} callout, current number of displayes: ${this.QO}`);
void E.a.sj(K.Ze).then(Gb=>{this.S9g||Gb.eEh(this.Mog)});super.show()}bNd(){const Gb=this.XJa();return oa.l8g(Gb)?new wa(this.$,this.vO,Gb):new Jb(this.$,this.Dgb,this.Fgb,Gb,this.vO,this.localStorage)}sNf(Gb){return{["selection"]:Gb,["callout"]:this.vO,["Location"]:"floatie",["displayCount"]:this.QO}}}Object(t.a)(ab,"EwaReactShowOrDismissCallout",Ea,[]);var Ja=a(83),Pa=a(266),hb;let ac=hb=class extends ab{constructor(Gb){super(Gb,hb.fxj,Q.a.instance.Ea(650),Q.a.instance.Ea(652),Q.a.instance.Ea(648),
Q.a.instance.Ea(649),3072,10,new Pa.a)}FTg(){return this.Vqa()}get NV(){return"[data-unique-id=Review]"}get MV(){return"[data-unique-id=pivotOverflowButton]"}get sV(){return'[id="'+this.$.xi+'Ribbon.Review-title"]'}get $wg(){return!1}get ribbonCommandInfo(){return new Ja.a(1834994092,$a.a.rh,this.$.hi,9,null)}get Qba(){return 2}XJa(){return 3}zAc(){return 86400}bha(){return this.$.ea.zqb}};ac.fxj="LineageDiscoverabilityCallout";ac=hb=Object(n.__decorate)([Object(E.d)(K.Md),Object(n.__param)(0,Object(K.Nb)())],
ac);Object(t.a)(ac,"LineageDiscoverabilityCallout",ab,[874]);var Hc=a(42);const bd=(Gb,Cc,cb,pc,Ic,rd,Rd)=>{Rd=Gb.$a(1,void 0===Rd?null:Rd);Rd.sheetName=Cc;return fb.h(Gb,"EvaluateSheetOptimizableContent",Rd,cb,pc,Ic,rd,4)};var zc=a(23),oc=a(47),Nb=a(153);class Aa{constructor(Gb,Cc){this.sessionID=null;this.mtg=cb=>{if(cb){let pc=oc.d(cb.data);({zz:cb}=pc);if(pc.returnValue&&(cb=Object(Nb.a)(Object,cb))&&"OptimizeWorkbookTaskPane"===cb.Origin)if(this.sessionID!==cb.SessionId)v.ULS.sendTraceTag(509748062,
0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(cb.Event){case "CoauthorsDetected":this.L2j.JOk();v.ULS.sendTraceTag(508117312,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Coauth error dialog shown.");break;default:v.ULS.sendTraceTag(509748060,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};
this.L2j=Gb;this.sessionID=Cc}initialize(){window.addEventListener("message",this.mtg,!1)}dispose(){window.removeEventListener("message",this.mtg,!1)}}Object(t.a)(Aa,"OptimizeWorkbookTaskPaneListener",null,[]);var Ub=a(91);let Db=class extends W.a{constructor(Gb){super();this.businessBar=null;this.DCb=2;this.WEb=-1;this.cXc=!1;this.p2b=null;this.KDc=!1;this.CRj=Cc=>{this.$&&((Cc=Cc.Result)?Cc.HasSignificantOptimizableContent?(v.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),
Y.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.ea.Gea(this.VE),Cc.OptimizableRangesOrPercentage&&(this.WEb=Cc.OptimizableRangesOrPercentage),0>=this.WEb&&0!==this.DCb&&(v.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),this.DCb=0),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&!Cc.Completed?v.ULS.sendTraceTag(508170697,
0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation was marked as not complete"):this.y8a()):v.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):v.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};this.YYj=(Cc,cb,pc)=>{(Cc=Cc.Result)?Cc.HasSignificantOptimizableContent?(v.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),
this.cXc=!0,this.mRk(cb,pc)):v.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):v.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.VE=(Cc,cb)=>{Cc=1<cb.k8g;this.KDc||Cc?this.KDc&&Cc&&(this.businessBar&&this.businessBar.r6(62)&&(v.ULS.sendTraceTag(508170695,0,50,"OptimizeWorkbookManager.onUserListChanged: Hide the business bar"),this.Sga()),this.$.ea.R7(this.VE)):
(this.y8a(),this.KDc=!0,v.ULS.sendTraceTag(508170696,0,50,"OptimizeWorkbookManager.onUserListChanged: Show the business bar"))};this.$=Gb;this.EUk();this.cXc=!1;this.Fii=Y.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",2E3);this.p2b=new Aa(this,this.$.ea.sessionId)}dispose(){this.Sga();Y.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.ea.R7(this.VE);this.$=this.businessBar=null;this.Cqf();super.dispose()}Kdj(){this.p2b&&
this.p2b.initialize()}Cqf(){this.p2b&&this.p2b.dispose()}Sga(){this.businessBar&&this.businessBar.r6(62)&&this.businessBar.removeEntry(62)}EUk(){Hc.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Gb=>{Gb.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",!1).then(Cc=>{if(Cc){var cb=this.$.pa.ta,pc=this.DCb,Ic=this.CRj;const rd=cb.$a(1,null);rd.businessBarMessageType=pc;fb.h(cb,"EvaluateOptimizableContentV2",rd,Ic,null,null,null,4)}return Cc})})}y8a(){this.KDc=
!0;const Gb=Object(Ub.d)(E.a.resolve(K.C,{va:1}));Ca.TaskExtensions.Xa(Gb,()=>{const Cc=Gb.result;Cc&&(Cc.Om(62,null,null,this.aGi()),this.businessBar=Cc)},this.$.ya,3)}aGi(){switch(this.DCb){default:return Q.a.instance.ia(2239);case 1:return String.format(Q.a.instance.Ea(720),this.WEb);case 2:return String.format(Q.a.instance.Ea(721),this.WEb)}}Dja(Gb,Cc,cb){if(Cc&&Cc.RequestTelemetryData&&!(Cc.RequestTelemetryData.EcsOperationDuration<this.Fii)&&this.businessBar&&this.businessBar.r6(62)&&!this.cXc){var pc=
cb?cb:this.$.ma.sheetName;if(6===Gb||7===Gb||8===Gb||9===Gb)this.evaluateSheetOptimizableContent(pc,Gb,Cc.RequestTelemetryData.EcsOperationDuration);else{const Ic=()=>{zc.f(this.$).za.ux(Ic);this.evaluateSheetOptimizableContent(pc,Gb,Cc.RequestTelemetryData.EcsOperationDuration)};zc.f(this.$).za.ny(Ic)}}}evaluateSheetOptimizableContent(Gb,Cc,cb){bd(this.$.pa.ta,Gb,pc=>{this.YYj(pc,Cc,cb)},null,null,null)}mRk(Gb,Cc){const cb=new Ja.a(-847286761,$a.a.rh,this.$.hi,0,null),pc={CalloutName:18};pc.Target=
this.businessBar.rKd(62);pc.Operation=Gb;pc.Duration=Cc;this.$.Ma.qh(cb,pc)}JOk(){const Gb=new H.a;Gb.Ph=0;Gb.hp(Q.a.instance.Ea(874),Q.a.instance.Ea(875),0)}};Db=Object(n.__decorate)([Object(E.d)(K.te),Object(n.__param)(0,Object(K.Nb)())],Db);Object(t.a)(Db,"OptimizeWorkbookManager",W.a,[876]);var Ib=a(10);const yc='[id="'+Ib.a.oYg+'"]';class xc extends ab{constructor(Gb,Cc,cb,pc,Ic,rd,Rd,va,Bb,Ac){super(Gb,Cc,null,cb,pc,Ic,rd,Rd,new Pa.a,va,!0,!0,Bb,!1,!1,void 0,Ac)}get NV(){return yc}get MV(){return yc}get sV(){return yc}get ribbonCommandInfo(){return new Ja.a(-847286761,
$a.a.rh,this.$.hi,0,null)}bha(){return!(this.$.isMobileMode||this.$.ea.Ih.inEmbedView||this.$.ea.Ih.inWebPart)}}Object(t.a)(xc,"ZoomTeachingCallout",ab,[]);class zb extends xc{constructor(Gb){super(Gb,"AdjustZoomTeachingCallout",Q.a.instance.Ea(694),null,Q.a.instance.Ea(693),2,1,!1,!0,2)}}Object(t.a)(zb,"AdjustZoomTeachingCallout",xc,[]);class vb extends ab{constructor(Gb){super(Gb,"ConditionalFormattingManageRulesTeachingCallout",Q.a.instance.Ea(643),Q.a.instance.Ea(644),Q.a.instance.Ea(641),Q.a.instance.Ea(642),
2,1,new Pa.a)}get NV(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get MV(){return'[data-unique-id="RibbonOverflowMenu"]'}get sV(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new Ja.a(-20558303,$a.a.rh,this.$.hi,0,null)}}Object(t.a)(vb,"ConditionalFormattingManageRulesTeachingCallout",ab,[]);var bb;(function(Gb){Gb[Gb.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";Gb[Gb.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";
Gb[Gb.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";Gb[Gb.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";Gb[Gb.lineageDiscoverability=4]="lineageDiscoverability";Gb[Gb.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";Gb[Gb.adjustZoomTeachingCallout=7]="adjustZoomTeachingCallout";Gb[Gb.linkedEntityGallery=8]="linkedEntityGallery";Gb[Gb.fixedFreezePane=9]="fixedFreezePane";Gb[Gb.phoneticTeachingCallout=10]="phoneticTeachingCallout";Gb[Gb.powerQueryCallout=
11]="powerQueryCallout";Gb[Gb.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";Gb[Gb.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";Gb[Gb.tableInNewWorkbook=14]="tableInNewWorkbook";Gb[Gb.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";Gb[Gb.dataCleansing=16]="dataCleansing";Gb[Gb.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";Gb[Gb.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";
Gb[Gb.functionDialog=21]="functionDialog";Gb[Gb.fullScreen=22]="fullScreen";Gb[Gb.length=23]="length"})(bb||(bb={}));Object(t.b)("EwaCalloutName",bb);var La=a(41);class pb extends xc{constructor(Gb){super(Gb,"FixedFreezePaneTeachingCallout",Q.a.instance.Ea(647),Q.a.instance.Ea(645),Q.a.instance.Ea(646),65536,16,!0,!1,8)}XJa(){return 0}}Object(t.a)(pb,"FixedFreezePaneTeachingCallout",xc,[]);var fa=a(107),kb=a(7),db=a(60),gb=a(28),Kb=a(1134);class ub extends Kb.a{constructor(Gb){super("TextAboveImage");
this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Gb.paragraphs;this.image=Gb.image;this.imageWidth=Gb.imageWidth;this.imageHeight=Gb.imageHeight}}Object(t.a)(ub,"TextAboveImage",Kb.a,[]);class lb{constructor(Gb,Cc){this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Gb;this.image=Cc}}Object(t.a)(lb,"TextAboveImageCustomProps",null,[]);var Ba=a(1133),ra=a(357);class wb extends Ea{constructor(Gb){super(Gb);this.LNg=0;this.M8a=this.target=
null;this.x4c=!1;this.fA=this.iB=null;this.ftd=0}tY(Gb,Cc,cb,pc,Ic,rd){if(!this.Su()){switch(pc){case "DataTypes_PBI":this.ftd=1;break;default:this.ftd=0}this.target=Gb;this.iB=String.format(Q.a.instance.Ea(676),Cc);this.fA=String.format(Q.a.instance.Ea(677),cb);this.LNg=rd;this.JBk(pc,Ic)}}JBk(Gb,Cc){const cb=!!this.$.ua&&gb.a.equals(this.$.ua.UICultureTag,"en-us",!0);this.x4c=Cc&&cb;Cc&&!cb?this.M8a="BlankCell":Gb?this.M8a=Gb:(v.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),
this.M8a="BlankCell")}show(){v.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.fA&&!!this.iB,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Su()||(v.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}Su(){return!!this.MP}OJa(){const Gb=Object(w.a)(new ua.a,{label:Q.a.instance.Ea(682),ariaDescription:Q.a.instance.Ea(683),
onExecute:()=>{v.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),Cc=Object(w.a)(new ua.a,{label:this.x4c?Q.a.instance.Ea(680):Q.a.instance.Ea(678),ariaDescription:this.x4c?Q.a.instance.Ea(681):Q.a.instance.Ea(679),onExecute:()=>{v.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.x4c?"Try sample data":"Learn more")+'" button');var rd=new Map;rd.set("Domain",this.LNg.toString());
fa.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",ra.b.FailureBased,"ropari",rd);rd=new Ja.a(-859308420,$a.a.rh,this.$.hi,9,null);this.$.Ma.qh(rd,{[$a.a.Xk]:"HelpID="+this.M8a,["InputMethod"]:$a.a.rh,["ShouldCanvasTakeFocus"]:!0,[$a.a.Qi]:kb.a.FK});this.dismiss()}});var cb=!!this.$&&!!this.$.frame&&!!this.$.frame.OM&&this.$.frame.OM.BY;switch(this.ftd){case 1:var pc=cb?127:124;break;default:pc=cb?126:121}pc=Object(w.a)(new Ba.a(db.a.current.Pu(pc)),{alt:Q.a.instance.sh(184)});
const Ic=this.fA.split("\n\n");cb=Object(w.a)(new lb(Ic,pc),{imageWidth:280,imageHeight:cb?142:192});cb=new ub(cb);return Object(w.a)(new Ia.a,{target:this.target,content:cb,title:this.iB,primaryButtonProps:Cc,secondaryButtonProps:Gb,showCloseIcon:!0,calloutProps:Object(w.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(t.a)(wb,"LinkedEntityBlankCellConvertTeachingCallout",
Ea,[]);class mc extends ab{constructor(Gb){super(Gb,"LinkedEntityFirstOrganizationDataCallout",Q.a.instance.Ea(672),Q.a.instance.Ea(674),Q.a.instance.Ea(670),Q.a.instance.Ea(671),8192,13,new Pa.a,void 0,void 0,!0,!0);this.target=null;this.M8a="DataTypes_PBI"}get NV(){return this.target.toString()}get MV(){return this.target.toString()}get sV(){return'[id="'+this.$.xi+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new Ja.a(-859308420,$a.a.rh,this.$.hi,9,null)}get Zeb(){return{[$a.a.Xk]:"HelpID="+
this.M8a,["ShouldCanvasTakeFocus"]:!0,[$a.a.Qi]:kb.a.FK}}tY(Gb){this.Su()||(this.target=Gb,this.M8a="DataTypes_PBI")}Su(){return!!this.MP}bha(){v.ULS.shipAssertTag(537169921,0,!!this.target,"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Su()}}Object(t.a)(mc,"LinkedEntityFirstOrganizationDataTeachingCallout",ab,[]);class xb extends ab{constructor(Gb){super(Gb,
"LinkedEntityGalleryTeachingCallout","",Q.a.instance.Ea(682),Q.a.instance.Ea(684),Q.a.instance.Ea(685),49152,14,new Pa.a,void 0,!0,!0,!0,!0);this.target=null;this.Egb=5}get Qba(){return 2}get NV(){return this.target.toString()}get MV(){this.Egb=7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get sV(){return""}get ribbonCommandInfo(){return new Ja.a(-847286761,$a.a.rh,this.$.hi,0,kb.a.Lub)}show(){v.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Su()||(v.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),super.show())}tY(Gb){this.Su()||(this.target=Gb)}Su(){return!!this.MP}bha(){v.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Su()}}Object(t.a)(xb,"LinkedEntityGalleryTeachingCallout",
ab,[]);var Ec=a(13);class ed extends Ea{constructor(Gb){super(Gb);this.fA=this.iB=this.target=null}tY(Gb,Cc,cb){this.Su()||(this.target=Gb,this.iB=String.format(Q.a.instance.sh(186),Cc),this.fA=String.format(Q.a.instance.sh(188),cb))}show(){v.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.fA&&!!this.iB,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Su()||(v.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),
super.show())}Su(){return!!this.MP}OJa(){const Gb=Object(w.a)(new ua.a,{label:Q.a.instance.ia(1806),ariaDescription:Q.a.instance.ia(1807),onExecute:()=>{v.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');fa.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",ra.b.FailureBased,"ropari",null);Ec.HelperMethods.Cm("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});
var Cc=Object(w.a)(new Ba.a(db.a.current.Pu(this.$&&this.$.frame&&this.$.frame.OM&&this.$.frame.OM.BY?128:125)),{alt:Q.a.instance.sh(189)});Cc=Object(w.a)(new lb([this.fA],Cc),{imageWidth:280,imageHeight:142});Cc=new ub(Cc);return Object(w.a)(new Ia.a,{target:this.target,content:Cc,title:this.iB,primaryButtonProps:Gb,showCloseIcon:!0,calloutProps:Object(w.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,
isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(t.a)(ed,"LinkedEntityNoCuratedDataTeachingCallout",Ea,[]);var jd=a(181);class Xd extends Ea{constructor(Gb){super(Gb);this.fA=this.iB=null}tY(Gb){this.Su()||(this.target=Gb,this.lCk())}show(){v.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.fA&&!!this.iB,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Su()||(v.ULS.sendTraceTag(526234851,0,
50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),jd.a.sendTelemetryEvent({name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"}),super.show())}Su(){return!!this.MP}OJa(){return Object(w.a)(new Ia.a,{target:this.target,title:this.iB,content:this.fA,showCloseIcon:!0,calloutProps:Object(w.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,
isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}lCk(){let Gb=-1,Cc=0;const cb=E.a.nh(K.te);cb&&(Gb=cb.WEb,Cc=cb.DCb);switch(Cc){default:this.iB=Q.a.instance.Ea(722);this.fA=Q.a.instance.Ea(725);break;case 1:this.iB=String.format(Q.a.instance.Ea(723),Gb);this.fA=Q.a.instance.Ea(726);break;case 2:this.iB=String.format(Q.a.instance.Ea(724),Gb),this.fA=Q.a.instance.Ea(726)}}}Object(t.a)(Xd,"OptimizeWorkbookBusinessBarCallout",Ea,[]);var Td=a(149);class gc extends ab{constructor(Gb,Cc,
cb,pc,Ic,rd,Rd,va,Bb){va=void 0===va?!1:va;super(Gb,void 0===Bb?"OverrideBrowserShortcutsTeachingCallout":Bb,Cc,cb,pc,Ic,rd,Rd,new Pa.a,va)}get NV(){return"[data-unique-id=Help]"}get MV(){return"[data-unique-id=pivotOverflowButton]"}get sV(){return'[id="'+this.$.xi+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new Ja.a(-1018439626,$a.a.rh,this.$.hi,0,kb.a.K7)}bha(){return!Td.a.get(kb.a.s8b)}}Object(t.a)(gc,"OverrideBrowserShortcutsTeachingCallout",ab,[]);class nc extends gc{constructor(Gb,
Cc,cb,pc,Ic,rd,Rd,va){super(Gb,Cc,cb,pc,Ic,rd,Rd,void 0===va?!1:va,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new Ja.a(-901364793,$a.a.rh,this.$.hi,0,kb.a.K7)}get Zeb(){return{[kb.a.Fbe]:!1}}}Object(t.a)(nc,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",gc,[]);var dc=a(59);class Gc extends ab{constructor(Gb,Cc,cb,pc,Ic,rd,Rd,va,Bb,Ac,Nc,hd,qd,je,Ie,Oe,Vb,fd,Qd){super(Gb,Cc,cb,pc,Ic,rd,va,Bb,Ac,void 0===Nc?!1:Nc,void 0===hd?!1:hd,void 0===qd?!1:
qd,void 0===je?!1:je,void 0===Ie?!1:Ie,void 0===Oe?!0:Oe,void 0===Vb?!1:Vb,void 0===fd?null:fd,void 0===Qd?!1:Qd);this.learnMoreUrl=null;this.learnMoreUrl=Rd}r2j(){try{dc.a.H0(this.learnMoreUrl)}catch(Gb){}}NDe(){null!=this.learnMoreUrl&&this.r2j()}}Object(t.a)(Gc,"EwaReactShowOrLearnMoreCallout",ab,[]);const vd='[id="'+Ib.a.oYg+'"]';class zd extends Gc{constructor(Gb){super(Gb,"PhoneticTeachingCallout",Q.a.instance.Ea(695),Q.a.instance.Ea(698),Q.a.instance.Ea(697),Q.a.instance.Ea(696),"https://go.microsoft.com/fwlink/?linkid=2194045",
131072,17,new Pa.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get NV(){return vd}get MV(){return vd}get sV(){return vd}get ribbonCommandInfo(){return new Ja.a(1455037301,$a.a.rh,this.$.hi,0,null)}J8f(){v.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}R9f(){v.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(t.a)(zd,"PhoneticTeachingCallout",Gc,[]);var Yb=a(168);class Pb extends ab{constructor(Gb,Cc,cb,pc,Ic,rd){super(Gb,Cc,Q.a.instance.Ea(708),
Q.a.instance.Ea(707),Q.a.instance.Ea(703),cb,pc,Ic,new Pa.a,!0,!1,void 0,void 0,void 0,!0,!0);this.Egb=5;this.QWa=rd}get Qba(){return 2}get NV(){return 1===Yb.a(this.$).$S?"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get MV(){return"[data-unique-id=Connections_MLR"}bha(){return this.QWa}get sV(){return'[id="'+this.$.xi+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new Ja.a(-859308420,$a.a.rh,this.$.hi,9,null)}get Zeb(){return{[$a.a.Xk]:"HelpID=PowerQuery_Refresh",
["ShouldCanvasTakeFocus"]:!0,[$a.a.Qi]:kb.a.FK}}G8b(){return this.Vqa()}show(){this.uxa()?super.show():v.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}Object(t.a)(Pb,"PowerQueryRefreshTeachingCalloutBase",ab,[]);class $c extends Pb{constructor(Gb){super(Gb,"PowerQueryRefreshFromTableTeachingCallout",Q.a.instance.Ea(705),3145728,20,Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"))}}Object(t.a)($c,"PowerQueryRefreshFromTableTeachingCallout",
Pb,[]);class wd extends ab{constructor(Gb){super(Gb,"QueriesTaskPaneTeachingCallout",Q.a.instance.Ea(702),Q.a.instance.Ea(701),Q.a.instance.Ea(849),Q.a.instance.Ea(850),12582912,22,new Pa.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.Egb=5;this.QWa=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations")}get Qba(){return 2}get NV(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get MV(){return"[data-unique-id=Connections_MLR]"}get sV(){return'[id="'+this.$.xi+
'Ribbon.Data.Queries"]'}G8b(){return this.Vqa()}show(){this.uxa()?super.show():v.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}bha(){return this.QWa}get ribbonCommandInfo(){return new Ja.a(1156885807,$a.a.rh,this.$.hi,0,kb.a.Lub)}}Object(t.a)(wd,"QueriesTaskPaneTeachingCallout",ab,[]);var Bd=a(487),tc=a(216),Zc=a(674),Ab=a(254),rb=a(264);class Fb extends Pb{constructor(Gb){super(Gb,"PowerQueryAuthenticatedRefreshTeachingCallout",Q.a.instance.Ea(706),
805306368,28,Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1))}}Object(t.a)(Fb,"PowerQueryAuthenticatedRefreshTeachingCallout",Pb,[]);class jc extends ab{constructor(Gb){super(Gb,"PowerQueryClearAllPermissionsTeachingCallout",Q.a.instance.Ea(708),Q.a.instance.Ea(701),Q.a.instance.Ea(852),Q.a.instance.Ea(853),3,32,new Pa.a,!0,!1,void 0,void 0,void 0,!0,!0);this.Egb=5;this.QWa=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",
!1)}get Qba(){return 2}get NV(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get MV(){return"[data-unique-id=Connections_MLR]"}get sV(){return'[id="'+this.$.xi+'Ribbon.Data.Queries"]'}G8b(){return this.Vqa()}show(){this.uxa()?super.show():v.ULS.sendTraceTag(508687132,0,10,"PowerQueryClearAllPermissionsTeachingCallout.Show: Target object is null.")}bha(){return this.QWa}get ribbonCommandInfo(){return new Ja.a(-859308420,$a.a.rh,this.$.hi,9,null)}get Zeb(){return{[$a.a.Xk]:"HelpID=PowerQuery_Refresh",
["ShouldCanvasTakeFocus"]:!0,[$a.a.Qi]:kb.a.FK}}}Object(t.a)(jc,"PowerQueryClearAllPermissionsTeachingCallout",ab,[]);class Oc{constructor(Gb){this.NQf=this.oRf=!1;this.Vqa=!0;this.jUj=Cc=>{if(Cc&&!Ab.a(Cc))try{const cb=Cc.Result,pc=cb.QueryGroups;if(0<cb.Queries.length||0<pc.length)this.oRf=!0,this.NQf=cb.PowerQueryDataSources?cb.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||cb.PowerQueryDataSources.includes("OData.Feed"):!1,void this.KPk()}catch(cb){v.ULS.sendTraceTag(537168095,0,10,
`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${cb}.`)}};this.rPc=()=>{v.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=Gb;this.Hyg=new wd(Gb);this.powerQueryClearAllPermissionsCallout=new jc(Gb);this.vde=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new Fb(Gb):new $c(Gb)}show(){this.Vqa&&this.Szk()}Szk(){this.$.userOperationManager.enqueueOperation(new tc.a(587,0,(Gb,Cc,cb)=>
Zc.d(this.$.pa.ta,rb.c(Gb,this.jUj),rb.b(Cc,this.rPc),cb,null),80,()=>new Bd.a),null)}KPk(){const Gb=this;return Lo(function*(){(yield Ub.c(Gb.Hyg.G8b()))&&Gb.oRf?Gb.Hyg.show():(yield Ub.c(Gb.vde.G8b()))&&(Gb.vde instanceof Fb||Gb.NQf)?Gb.vde.show():(yield Ub.c(Gb.powerQueryClearAllPermissionsCallout.G8b()))&&Gb.powerQueryClearAllPermissionsCallout.show();Gb.Vqa=!1})}}Object(t.a)(Oc,"PowerQueryCallout",null,[896]);class cd extends Ea{constructor(Gb){super(Gb);this.y7d=this.yyd=this.fA=this.iB=this.target=
null}tY(Gb,Cc,cb){this.Su()||(this.target=Gb,this.yyd=Cc,this.y7d=cb,this.iB=Q.a.instance.Ea(710),this.fA=Q.a.instance.Ea(711))}show(){v.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.fA&&!!this.iB&&!!this.yyd&&!!this.y7d,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Su()||(v.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}Su(){return!!this.MP}OJa(){const Gb=
Object(w.a)(new ua.a,{label:Q.a.instance.Ea(712),ariaDescription:Q.a.instance.Ea(714),onExecute:()=>{v.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.yyd();this.dismiss()}}),Cc=Object(w.a)(new ua.a,{label:Q.a.instance.Ea(713),ariaDescription:Q.a.instance.Ea(715),onExecute:()=>{v.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.y7d();this.dismiss()}});return Object(w.a)(new Ia.a,{target:this.target,content:this.fA,
title:this.iB,primaryButtonProps:Gb,secondaryButtonProps:Cc,showCloseIcon:!0,calloutProps:Object(w.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(t.a)(cd,"TableAIConvertToTableCallout",Ea,[]);var Ed=a(192);class Sd{constructor(Gb){this.T1k=Gb}show(){Hc.a.instance.fj("Common.ISystemInitiatedFeedback").execute(Gb=>{Gb.logActivity(this.T1k,
null)})}}Object(t.a)(Sd,"EwaLppCallout",null,[896]);var $d=a(46);class be extends Sd{constructor(Gb){super("ExcelTableInNewWorkbook");this.QVd=this.Ioa=!1;this.createTable=()=>{const Cc=$d.x(new Ed.a(1,1,8,3,Ib.a.Rk,Ib.a.Gk),this.$),cb={};cb.TableRange=Cc;cb.HasHeader=!1;this.$.si(71074531,$a.a.rh,9,cb)};this.emf=()=>{this.createSampleTable("0")};this.fmf=()=>{this.createSampleTable("2")};this.gmf=()=>{this.createSampleTable("1")};this.$=Gb;(this.Ioa=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",
!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.QVd=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.emf,!0),window.addEventListener("ExcelCreateSampleTableContact",this.fmf,!0),window.addEventListener("ExcelCreateSampleTableToDo",this.gmf,!0)}dispose(){this.Ioa&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.QVd&&(window.removeEventListener("ExcelCreateSampleTableBlank",
this.emf,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.fmf,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.gmf,!0))}createSampleTable(Gb){const Cc={};Cc[$a.a.Qi]=Gb;this.$.si(1371713064,$a.a.rh,9,Cc)}}Object(t.a)(be,"TableInNewWorkbookCallout",Sd,[]);var Fe=a(1248);class Pe extends Ea{constructor(Gb){super(Gb);this.u_c=5E3;this.iB=Fe.a.Title;this.currentState=0}LIa(Gb,Cc){Fe.c.get(this.currentState).includes(Gb)&&(6===Gb?window.requestAnimationFrame(()=>this.Qwc(Gb,
Cc)):this.Qwc(Gb,Cc))}cbc(Gb){this.target=Gb}show(){super.dismiss();this.lIg();super.show()}dismiss(){this.LIa(0);window.clearTimeout(this.uDg);super.dismiss()}OJa(){return Object(w.a)(new Ia.a,{target:this.target,title:this.iB,content:this.fA,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,preventDismissOnResize:!0,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.lIg();super.r$a({message:this.fA})}Qwc(Gb,
Cc){const cb=Fe.b.get(Gb);this.R6k(this.Khi(Gb)?`${cb}${Cc}`:cb);this.currentState=Gb;0!=this.currentState?(this.update(),this.show()):this.dismiss()}Khi(Gb){switch(Gb){case 5:case 6:case 8:return!0;default:return!1}}lIg(){window.clearTimeout(this.uDg);this.uDg=window.setTimeout(()=>this.dismiss(),this.u_c)}R6k(Gb){this.fA=Gb}}Object(t.a)(Pe,"FormulaByExampleCurtainLifterCallout",Ea,[]);var hc=a(177),Lb=a(1082);class kc extends ab{constructor(Gb){super(Gb,"DataCleansingTeachingCallout",hc.a.ia(2477),
hc.a.ia(2478),hc.a.ia(2476),hc.a.ia(2479),16777216,24,new Pa.a,!0,!1,!1,!1,!0,!0,!0,5,!0,!0);this.Pqd="[data-unique-id=Data]";this.E6e="[data-unique-id=Ribbon-DataCleansingTaskPane]";this.I6e="[data-unique-id=pivotOverflowButton]";this.G6e="[data-unique-id=Ribbon-DataCalculationTools_MLR]"}get NV(){return document.querySelector(this.G6e)?this.G6e:document.querySelector(this.E6e)?this.E6e:document.querySelector(this.Pqd)?this.Pqd:this.I6e}get MV(){return this.I6e}get sV(){return this.Pqd}get Zeb(){return Lb.a}get ribbonCommandInfo(){return new Ja.a(-859308420,
$a.a.rh,this.$.hi,12,null)}}Object(t.a)(kc,"DataCleansingTeachingCallout",ab,[]);var dd=a(126);class yb extends Ea{constructor(Gb){super(Gb);this.fA=this.iB=this.target=null;this.duration=0}tY(Gb,Cc,cb){this.Su()||(this.target=Gb,this.iB=this.BGi(Cc),this.fA=Q.a.instance.Ea(737),this.operation=Cc,this.duration=cb)}show(){v.ULS.shipAssertTag(512304648,0,!!this.target&&!!this.fA&&!!this.iB,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Su()||(v.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout."),jd.a.sendTelemetryEvent({name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",dataFields:dd.a.Rm({["Operation"]:this.operation,["Duration"]:this.duration})}),super.show())}Su(){return!!this.MP}OJa(){return Object(w.a)(new Ia.a,{target:this.target,title:this.iB,content:this.fA,showCloseIcon:!0,calloutProps:Object(w.a)(new Sa.a,
{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}BGi(Gb){switch(Gb){case 0:return Q.a.instance.Ea(727);case 1:return Q.a.instance.Ea(728);case 2:return Q.a.instance.Ea(729);case 3:return Q.a.instance.Ea(730);case 4:return Q.a.instance.Ea(731);case 5:return Q.a.instance.Ea(732);case 6:return Q.a.instance.Ea(733);case 7:return Q.a.instance.Ea(734);case 8:return Q.a.instance.Ea(735);
case 9:return Q.a.instance.Ea(736);default:return""}}}Object(t.a)(yb,"OptimizeWorkbookSlowOperationsCallout",Ea,[]);class Ta extends ab{constructor(Gb){super(Gb,"FunctionDialogTeachingCallout",void 0,Q.a.instance.Ea(763),Q.a.instance.Ea(760),Q.a.instance.Ea(761),1073741824,30,new Pa.a,!0,!0,!1,!1,!0,!0,!0,5,!0)}tY(Gb){this.Qqd=`[id=${"CellEdit"===Gb?this.$.xi+kb.a.DQb:"InsertFunction"}]`}XJa(){return 1}get NV(){return this.Qqd}get MV(){return this.Qqd}get sV(){return this.Qqd}get ribbonCommandInfo(){return null}}
Object(t.a)(Ta,"FunctionDialogTeachingCallout",ab,[]);class Hb extends Sd{constructor(Gb){super("ExcelLiveWebEntryPointCallout");this.moa=!1;this.JXg=()=>{this.$.si(327119921,$a.a.rh,9,null)};this.$=Gb;(this.moa=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",!1))&&window.addEventListener("TryCoEditInTeams",this.JXg,!0)}dispose(){this.moa&&window.removeEventListener("TryCoEditInTeams",this.JXg,!0)}}Object(t.a)(Hb,"ExcelLiveWebEntryPointCallout",Sd,
[]);class uc extends Ea{constructor(Gb){super(Gb);this.Z8c="FullScreenTeachingCallout";this.Y8c=4;this.X8c=34;this.iB=Q.a.instance.Ea(1004);this.fA=Q.a.instance.Ea(1005);this.QWa=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1);this.localStorage=new Pa.a;this.C_b=this.bNd();this.QO=0}get vO(){return this.Z8c}get Fgb(){return this.Y8c}get Dgb(){return this.X8c}get MV(){return"[id=ToggleFullScreenButton]"}get NV(){return"[id=ToggleFullScreenButton]"}get sV(){return"[id=ToggleFullScreenButton]"}XJa(){return 3}zAc(){return 86400}get Qba(){return 3}OJa(){return Object(w.a)(new Ia.a,
{target:this.uxa(),content:this.fA,title:this.iB,showCloseIcon:!0,preventLightDismiss:!1,hasDynamicSizing:!1,calloutProps:Object(w.a)(new Sa.a,{onDismiss:()=>{this.dismiss()},directionalHint:6,preventDismissOnScroll:!1,preventDismissOnResize:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0,setInitialFocus:!1,gapSpace:0}),useTeachingStyles:!1,hasFocusableControls:!1,useCoachmark:!1})}Su(){return!!this.MP}bha(){return this.QWa&&!this.Su()}show(){this.uxa()&&Ca.TaskExtensions.Xa(this.Vqa(),Gb=>{Gb.result&&
this.Zse()},this.$.ya)}Vqa(){const Gb=new Ya.a;this.bha()?Ca.TaskExtensions.Xa(this.C_b.v2d(),Cc=>{var cb=this.XJa();Cc=Cc.result;Cc.g$b?(this.QO=Cc.QO,oa.apb(cb)&&Cc.QO>=this.Qba?Gb.setResult(!1):oa.rJc(cb)&&Cc.iMa&&Va.getElapsedSeconds(Cc.iMa,new Date)<this.zAc()?Gb.setResult(!1):(cb=!this.MP&&!!this.uxa(),Gb.setResult(cb))):Gb.setResult(!1)},this.$.ya):Gb.setResult(!1);return Gb.task}Zse(){const Gb=new za;Gb.QO=this.QO+1;Gb.iMa=new Date;this.C_b.Rme(Gb);super.show()}uxa(){return document.querySelector(this.NV)?
this.NV:document.querySelector(this.MV)?this.MV:document.querySelector(this.sV)?this.sV:null}bNd(){const Gb=this.XJa();return oa.l8g(Gb)?new wa(this.$,this.vO,Gb):new Jb(this.$,this.Dgb,this.Fgb,Gb,this.vO,this.localStorage)}}Object(t.a)(uc,"FullScreenTeachingCallout",Ea,[]);class Sc{constructor(Gb){this.$=Gb;this.QG=new La.a(!1)}VRi(Gb){if(!this.QG.lh(bb[Gb]))switch(Gb){case 0:this.X3h(Gb);break;case 2:this.QG.add(bb[Gb],new wb(this.$));break;case 3:this.QG.add(bb[Gb],new ed(this.$));break;case 6:this.QG.add(bb[Gb],
new mc(this.$));break;case 1:this.QG.add(bb[Gb],new vb(this.$));break;case 4:this.QG.add(bb[Gb],new ac(this.$));break;case 7:this.QG.add(bb[Gb],new zb(this.$));break;case 8:this.QG.add(bb[Gb],new xb(this.$));break;case 9:this.QG.add(bb[Gb],new pb(this.$));break;case 13:this.QG.add(bb[Gb],new Xd(this.$));break;case 10:this.QG.add(bb[Gb],new zd(this.$));break;case 11:this.QG.add(bb[Gb],new Oc(this.$));break;case 12:this.QG.add(bb[Gb],new cd(this.$));break;case 14:this.QG.add(bb[Gb],new be(this.$));
break;case 15:this.QG.add(bb[Gb],new Pe(this.$));break;case 16:this.QG.add(bb[Gb],new kc(this.$));break;case 18:this.QG.add(bb[Gb],new yb(this.$));break;case 20:this.QG.add(bb[Gb],new Hb(this.$));break;case 21:this.QG.add(bb[Gb],new Ta(this.$));break;case 22:this.QG.add(bb[Gb],new uc(this.$));break;default:return null}return this.QG.getItem(bb[Gb])}X3h(Gb){this.QG.add(bb[Gb],new nc(this.$,Q.a.instance.Ea(640),Q.a.instance.Ea(637),Q.a.instance.Ea(638),Q.a.instance.Ea(639),16,4,!0))}}Object(t.a)(Sc,
"EwaCalloutFactory",null,[]);var bc=a(63),vc=a(67),Xc=a(151);let ad=class{constructor(Gb){this.$=Gb;this.Wni=new Sc(this.$)}Ri(){return!1}dj(){return!1}Gi(Gb,Cc,cb){Gb=cb.CalloutName;this.CNk=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&Object(Xc.c)(this.$)&&!this.Phj(Gb);return!!Cc&&-847286761===Cc.command&&bc.a.Wl.GY&&!this.CNk}Phj(Gb){return this.$.LC&&9===Gb}executeCommand(Gb,Cc,cb){Gb=cb.CalloutName;if(Cc=this.Wni.VRi(Gb)){switch(Gb){case 2:Cc.tY(cb.Target,
cb.RibbonButtonLabel,cb.ExampleEntities,cb.BlankCellResourceId,cb.HasBlankCellWalkthrough,cb.ServiceDomain);break;case 3:Cc.tY(cb.Target,cb.RibbonButtonLabel,cb.ExampleEntities);break;case 6:Cc.tY(cb.Target);break;case 8:Cc.tY(cb.Target);break;case 13:Cc.tY(cb.Target);break;case 15:return Cc.cbc(cb.Target),Cc.LIa(cb.NewState,cb.Reason),vc.Task.Ua(!0);case 12:Cc.tY(cb.Target,cb.ConvertToTableCallback,cb.NoThanksCallback);break;case 18:Cc.tY(cb.Target,cb.Operation,cb.Duration);break;case 21:Cc.tY(cb.Trigger)}Cc.show();
return vc.Task.Ua(!0)}return vc.Task.Ua(!1)}};ad=Object(n.__decorate)([Object(E.d)(K.ag),Object(n.__param)(0,Object(K.Nb)())],ad);Object(t.a)(ad,"ShowCalloutCommandHandler",null,[34]);let Id=class{constructor(Gb){this.R6e=!1;this.cI=Gb;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",!1)&&void E.a.resolve(K.kf,{va:1});this.cI.yeb("Valid",()=>{this.R6e||(v.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.R6e=!0)})}};Id=Object(n.__decorate)([Object(E.d)(K.tg),
Object(n.__param)(0,Object(K.ug)()),Object(n.__param)(1,Object(K.Nb)())],Id);Object(t.a)(Id,"TableIntelligenceDarkActivationManager",null,[871]);var ue=a(189),Vd=a(938),Kd=a(913);class Yd extends Vd.a{constructor(){super();this.range=null;this.H_=Object.assign(new Kd.a,{T_:Yd.getTypeName(),B_:Yd.getBaseTypes()})}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(t.a)(Yd,"ExcelRangeWrapperAnnotation",Vd.a,[]);class Bc extends Yd{constructor(){super();
this.primaryTable=this.sheetName=this.boundaryConfidence=this.hasMergedcells=this.tableName=this.interpretations=null;this.H_=Object.assign(new Kd.a,{T_:Bc.getTypeName(),B_:Bc.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}}Object(t.a)(Bc,"ExcelRecognizedTableNew",Yd,[]);class Mc extends Bc{constructor(){super();this.requestId=null;this.H_=Object.assign(new Kd.a,
{T_:Mc.getTypeName(),B_:Mc.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Core_Annotation"]}}Object(t.a)(Mc,"ExcelRangeMetadata",Bc,[]);var Fd=a(1412);class Md extends Fd.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new Kd.a,{T_:Md.getTypeName(),B_:Md.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell",
"AugLoop_Core_GridCell"]}}Object(t.a)(Md,"ExtendedExcelCell",Fd.a,[]);var oe=a(1035);class ye extends oe.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=null;this.H_=Object.assign(new Kd.a,{T_:ye.getTypeName(),B_:ye.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(t.a)(ye,"RangeDataSignal",oe.a,[]);var te=a(1221),ze=a(106),He=a(40);class ne extends Sys.EventArgs{constructor(Gb){super();
this.PTc=Gb}}Object(t.a)(ne,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var of=a(210),lf=a(27),jf=a(392);class Cf{constructor(Gb,Cc,cb,pc,Ic){this.analyzedRange=Gb;this.interpretations=Cc;this.tableName=cb;this.id=pc;this.hRf=Ic}}Object(t.a)(Cf,"RecognizedTable",null,[]);class Gf{constructor(Gb,Cc,cb){this.classification=Gb;this.aggregations=Cc;this.headerReferences=cb}}Object(t.a)(Gf,"TableField",null,[]);var Af=a(1222);const Lf=Gb=>{var Cc=new jf.a(Ef(Gb.range),Gb.range.worksheetId);var cb=
Gb.interpretations;var pc=new of.a;if(cb&&cb.length)for(const Oe of cb){b:switch(Oe.orientation.toLowerCase()){case "columnmajor":cb=2;break b;case "rowmajor":cb=1;break b;default:v.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),cb=0}const Vb=cb;if(0===Vb)v.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{cb=Af.a;var Ic=Ef(Oe.location),rd=Oe.confidence,Rd=Oe.headerRowCount,va=Oe.headerColumnCount;var Bb=Oe.fields;
var Ac=new of.a;if(Bb)for(const fd of Bb){Bb=Ac;var Nc=Bb.add;c:switch(fd.classification.toLowerCase()){case "dimension":var hd=1;break c;case "measure":hd=2;break c;default:v.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),hd=0}var qd=fd.aggregations;var je=new of.a;if(qd)for(const Qd of qd)switch(Qd.toLowerCase()){case "sum":je.add(0);break;case "count":je.add(1);break;case "average":je.add(2);break;case "min":je.add(3);break;case "max":je.add(4);break;case "distinctcount":je.add(5);
break;case "stddev":je.add(6);break;case "variance":je.add(7);break;default:v.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}qd=je;var Ie=fd.headerReferences;je=new of.a;if(Ie)for(const Qd of Ie)Ie=new lf.Range(Qd.top,Qd.left,Qd.top,Qd.left,!1,!1),je.add(Ie);Nc.call(Bb,new Gf(hd,qd,je))}cb=new cb(Ic,rd,Rd,va,Vb,Ac);pc.add(cb)}}return new Cf(Cc,pc,Gb.tableName,Gb.id,Gb.hasMergedcells)},Ef=Gb=>new lf.Range(Gb.top,Gb.left,Gb.bottom,Gb.right,!1,!1);var Hf=a(1066);class $b{constructor(Gb,
Cc){this.U4c=0;this.UH=new Map;this.qUd=!1;this.cI=Gb;this.Yo=Cc;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.kwc=new Hf.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),this.kwc.start(),this.x0c=!0);this.cI.yeb("Valid",this.e1j.bind(this));this.cI.yeb("Invalid",this.DVj.bind(this));Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.Yo.txh(this.tPj.bind(this))}sKa(Gb,Cc,cb){if(!this.UH)return v.ULS.sendTraceTag(521025344,
306,10,"Recognized table is null"),[];let pc=Cc;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&void 0!==cb&&this.U4c>cb&&(v.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${cb}, versionChanges: ${this.U4c}`),pc=Cc^4);return this.UH.has(Gb.sheetId)?(Cc=this.UH.get(Gb.sheetId).filter(Ic=>Ic.table.analyzedRange.range.Xi(Gb.range)&&(pc&Ic.metadataState)==Ic.metadataState),v.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${Cc.length}`),
Cc):[]}e1j(Gb,Cc){if(this.UH){if(!this.qUd){Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.x0c&&(this.kwc.stop(),v.ULS.sendTraceTag(509089223,0,15,"Elapsed time since annotation invalidation: {0}",this.kwc.zi),this.x0c=!1);for(const cb of this.UH){const [pc,Ic]=cb;Ic.every(rd=>4===rd.metadataState)?this.UH.delete(pc):this.UH.set(pc,Ic.filter(rd=>4!==rd.metadataState))}this.qUd=!0}Gb=Cc.PTc;this.UH.has(Gb.analyzedRange.sheetId)||this.UH.set(Gb.analyzedRange.sheetId,[]);
this.UH.get(Gb.analyzedRange.sheetId).push({table:Gb,metadataState:2});this.U4c=0}else v.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}DVj(Gb,Cc){this.qUd=!1;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.x0c&&(this.kwc.start(),this.x0c=!0);Gb=Cc.PTc;if(!this.UH)v.ULS.sendTraceTag(521025314,306,10,"Recognized table is null");else if(this.UH.has(Gb.analyzedRange.sheetId))for(const cb of this.UH.get(Gb.analyzedRange.sheetId))cb.table.id===Cc.PTc.id&&(cb.metadataState=
4)}tPj(){this.U4c++}}Object(t.a)($b,"TableIntelligenceQueryManager",null,[914]);class Wb{}Object(t.a)(Wb,"RecognizedTableLog",null,[]);class Dc{}Object(t.a)(Dc,"Interpretation",null,[]);class Jf{constructor(Gb){this.UH=new Map;this.Knc=void 0;this.MIb=new Set;this.O0b=void 0;this.cI=Gb}pdh(){this.O0b?v.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.O0b=this.dsb.bind(this),this.cI.yeb("Valid",this.O0b))}vBj(Gb){Gb=this.sanitize(Gb);v.ULS.sendTraceTag(521233111,
306,15,`${JSON.stringify(Gb)}`)}dsb(Gb,Cc){Gb=Cc.PTc;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.MIb&&this.UH?(this.MIb.has(Gb.id)||(this.CAh(Gb),this.MIb.add(Gb.id)),this.Knc||(this.Knc=window.setTimeout(this.iAa.bind(this),2E3))):v.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.MIb}, recognizedTableStore = ${!!this.UH}`))}iAa(){for(const Gb of this.UH){const [,Cc]=Gb;v.ULS.sendTraceTag(521233110,
306,15,JSON.stringify(Cc))}window.clearTimeout(this.Knc);this.MIb=this.Knc=void 0;this.UH.clear();this.UH=void 0;this.cI.$kk(this.O0b);this.O0b=void 0}CAh(Gb){const Cc=Gb.analyzedRange.sheetId;this.UH.has(Cc)||this.UH.set(Cc,[]);this.UH.get(Cc).push(this.sanitize(Gb))}sanitize(Gb){const Cc=[];for(const cb of Gb.interpretations){let pc=0,Ic=0;for(const rd of cb.fields)1===rd.classification?pc++:2===rd.classification&&Ic++;Cc.push({confidence:cb.confidence,headerRowCount:cb.headerRowCount,headerColumnCount:cb.headerColumnCount,
orientation:cb.orientation,measureCount:Ic,dimensionCount:pc})}return{interpretations:Cc,range:{top:Gb.analyzedRange.range.top,bottom:Gb.analyzedRange.range.bottom,left:Gb.analyzedRange.range.left,right:Gb.analyzedRange.range.right},isTable:!!Gb.tableName,annotationId:Gb.id}}}Object(t.a)(Jf,"RecognizedTableLogger",null,[]);let Rb=class extends He.a{constructor(Gb,Cc){super();this.kZf=this.jZf=!1;this.instantaneousSupportInformationManager=null;this.Fge=void 0;this.m$f=!1;this.Ksi=(cb,pc)=>{var Ic;
if(1===pc.operationType){const Rd=pc.annotation;if(Rd){v.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${Rd.requestId}`);cb=Lf(Rd);Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Ic=this.Fge)||void 0===Ic?void 0:Ic.vBj(cb));var rd=null;(()=>{let va=this.Mte.wj(Rd.requestId);({value:rd}=va);return va})().returnValue?(this.Mte.remove(Rd.requestId),rd(cb)):v.ULS.sendTraceTag(537151250,
306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${Rd.requestId}`)}else v.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")}};this.Yo=Gb;this.$=Cc;this.Mte=new ze.a;Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Fge=new Jf(this));this.Yo.register(this.Yo.J5().n8("TableIntelligence").m8(()=>{}).build())}Caa(){this.A9a||(this.A9a=new $b(this,
this.Yo));return this.A9a}aQi(Gb,Cc){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<Gb.range.uz)return v.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${Gb.range.uz} exceeds limit of ${1E4}`),4;this.rwh();if(this.Hpj(Gb.range))return this.fUi(Gb,Cc);v.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}mzd(Gb){return(Cc,cb)=>{this.R$j(this.S4d(Gb),cb)}}yeb(Gb,Cc){var cb,pc;(null===(pc=null===(cb=this.$)||
void 0===cb?void 0:cb.sa)||void 0===pc?0:pc.count)&&100<this.$.sa.count?v.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.sa.count}`):(this.kZf||(this.Yo.kqa("TableIntelligence",{Ny:!0,annotationType:Bc.getTypeName(),BV:this.mzd("New"),eDa:this.mzd("Valid"),OFc:this.mzd("Invalid")}),this.kZf=!0),this.Czh(Gb,Cc),this.odj())}$kk(Gb){this.removeHandler(this.S4d("Valid"),Gb)}Czh(Gb,Cc){this.addHandler(this.S4d(Gb),
Cc)}Ihk(){this.Yo.kqa("TableIntelligence",{annotationType:Mc.getTypeName(),Ny:!1,BV:this.Ksi})}rwh(){this.jZf||(this.jZf=!0,this.Ihk())}R$j(Gb,Cc){1===Cc.operationType&&((Cc=Cc.annotation)?(Cc=Lf(Cc),this.raiseEvent(Gb,new ne(Cc))):v.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}S4d(Gb){return`${"RecognizedTableUpdate"}_${Gb}`}fUi(Gb,Cc){v.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");
const cb=Gb.range,pc=zc.f(this.$).ot("TableIntelligence",cb,1),Ic=[],rd=[];let Rd=0;const va=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1);for(this.instantaneousSupportInformationManager||void E.a.sj(K.Cd).then(Bb=>this.instantaneousSupportInformationManager=Bb);pc.$$mn();){const Bb=pc.$$cu();if(!Bb)continue;if(0===Bb.Ln.type&&gb.a.Kz(Bb.Ln.value))continue;Bb.AH&&Bb.range&&rd.push(Object(w.a)(new te.a,{worksheetId:Gb.sheetId,left:Bb.range.left-1,top:Bb.range.top-
1,right:Bb.range.right-1,bottom:Bb.range.bottom-1}));const Ac=Bb.range.top-1,Nc=Bb.range.left-1;let hd=null,qd=null;({category:qd}=this.instantaneousSupportInformationManager.zra(Bb.cell.qo,!0));Bb.text!=Bb.Ln.value&&(hd=Bb.text,va&&Rd++);Ic.push(Object.assign(new Md,{row:Ac,column:Nc,value:Bb.Ln.value,type:Bb.Ln.type,displayText:hd,Etl:qd}))}va&&v.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${Rd}, number of values: ${Ic.length}, range size: ${cb.height} rows by ${cb.width} columns`);
if(0<Ic.length)return this.c9h(Ic,Gb,rd,Cc),rd.length?5:0;v.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}c9h(Gb,Cc,cb,pc){var Ic=Cc.range;Ic=Object(w.a)(new te.a,{top:Ic.top,left:Ic.left,bottom:Ic.bottom,right:Ic.right,worksheetId:Cc.sheetId});Cc=ue.a.create().toString();Gb=Object(w.a)(new ye,{cells:Gb,range:Ic,mergeCellAddresses:cb,requestId:Cc});this.Yo.oyb(Gb);this.Mte.add(Cc,pc)}Hpj(Gb){const Cc=zc.f(this.$);if(Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1)){const cb=Cc.KR();v.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${cb.width}, viewportHeight: ${cb.height}`)}return Cc.za.pba(4,this.$.ma)&&!!Cc.zh(Gb.topLeft)&&!!Cc.zh(Gb.bottomLeft)&&!!Cc.zh(Gb.topRight)&&!!Cc.zh(Gb.bottomRight)}odj(){var Gb;!this.m$f&&Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.m$f=!0,null===(Gb=this.Fge)||void 0===Gb?void 0:Gb.pdh())}};Rb=Object(n.__decorate)([Object(E.d)(K.ug),Object(n.__param)(0,Object(K.p)()),Object(n.__param)(1,
Object(K.Nb)())],Rb);Object(t.a)(Rb,"TableIntelligenceManager",He.a,[4,870]);String(c);String(b);String(h);String(r);String(f);String(l);String(m);String(x);window.___1710758652292_closurehack=c;window.___1710758652292_closurehack=b;window.___1710758652292_closurehack=h;window.___1710758652292_closurehack=r;window.___1710758652292_closurehack=f;window.___1710758652292_closurehack=l;window.___1710758652292_closurehack=m;window.___1710758652292_closurehack=x}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pid.js.map/58ed4de0b28e68ffc9d93413a44322ee/EwaTS.pid.js.map