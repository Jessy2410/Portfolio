'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1270:function(A,u,a){a.d(u,"a",function(){return h});A=a(0);u=a(246);var c=a(16),b=a(13);class h extends u.a{constructor(r,f,l,m){super(r,l,2,void 0===m?null:m);this.ocd=null;this.onResize=()=>{const x=this.ONi();this.z0a.setAttribute("width",x.x.toString());this.z0a.setAttribute("height",x.y.toString());this.D7k(x);this.jmg()};this.pof=f;this.$.xI(this.onResize);this.MRd()}get z0a(){return this.ocd}initialize(){const r=
this.$.xi+"iframeDialog_frame",f=this.$.xi+"iframeDialog";this.tj.style.margin=b.HelperMethods.Ki(0);this.tj.style.marginBottom=b.HelperMethods.Ki(-2);const l=document.createElement("iframe");l.id=r;l.frameBorder="0";l.scrolling="auto";l.src=this.jHf(f);this.tj.appendChild(l);this.ocd=document.getElementById(r);this.domElement.id=f;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.gL(this.onResize);super.dispose()}setFocus(){c.DOMElementExtensions.setFocus(this.z0a)}onHide(){this.z0a.contentWindow.close();
c.DOMElementExtensions.an(this.z0a);this.ocd=null;super.onHide()}D7k(r){const f=this.domElement.style;f.width=b.HelperMethods.Ki(r.x);f.marginLeft=b.HelperMethods.Ki(-r.x/2)}ONi(){const r=c.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*r.width),this.pof.x),Math.min(Math.floor(.9*r.height),this.pof.y))}}Object(A.a)(h,"IFrameDialog",u.a,[])},1271:function(A,u,a){a.d(u,"a",function(){return f});A=a(0);u=a(982);var c=a(148),b=a(19),h=a(60),r=a(12);class f extends u.a{constructor(l,
m,x,n,t,w,v){w=void 0===w?0:w;super(l,r.a.instance.ia(m),!1);this.Bi=null;this.message=x;this.x8d=n;this.kCe=t;this.operationFlags=w;this.Bi=v}get Di(){return"WebMethodConfirmationDialog"}get GJ(){return 1005}get Bhb(){return this.operationFlags}initialize(){let l="<div class='"+c.e+"'>\r\n\t<div class='"+c.v+"'>\r\n\t\t<div class='"+b.a.dgf+"'>\r\n\t\t\t<img src='{0}' class='"+b.a.lxf+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+c.A+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";l=
String.format(l,h.a.An(13),r.a.instance.ia(25),r.a.instance.ia(this.message));this.Bi.hr(this.tj,l);this.addButton(0,this.x8d);this.addButton(1);super.initialize()}tO(){return this.kCe}}Object(A.a)(f,"WebMethodConfirmationDialog",u.a,[])},1272:function(A,u,a){a.d(u,"b",function(){return b});a.d(u,"c",function(){return h});a.d(u,"a",function(){return r});var c=a(64);const b=(f,l,m,x,n,t)=>{t=f.$a(1,t);return c.h(f,"ShareForm",t,l,m,x,n,0)},h=(f,l,m,x,n,t)=>{t=f.$a(1,t);return c.h(f,"UnshareForm",t,
l,m,x,n,0)},r=(f,l,m,x,n,t)=>{t=f.$a(9,t);t.surveyId=null;return c.h(f,"DeleteSurvey",t,l,m,x,n,0)}},1461:function(A,u,a){a.r(u);(function(c){a.d(u,"SocialSharingCommandHandler",function(){return $a});var b=a(135),h=a(0),r=a(15),f=a(6),l=a(394),m=a(144),x=a(189),n=a(35),t=a(261),w=a(233),v=a(267),k=a(93),y=a(73),C=a(63),B=a(39),E=a(242),K=a(695),F=a(83),W=a(36),J=a(1),L=a(13),M=a(211),Q=a(28),H=a(23),ba=a(44),U=a(286),D=a(1463),I=a(1518),X=a(1465),Y=a(1464),ja=a(1272),Ua=a(1271),ka=a(279),fb=a(8),
ha=a(90),ea=a(291),aa=a(74),ca=a(745),xa=a(166),Oa=a(612),ua=a(101),Ia=a(293),Sa=a(26),Ya=a(18),da=a(1462),Ea=a(91),oa=a(95),za=a(5),la=a(168),Ca=a(7),Va=a(217),ia=a(284),wa;const Jb=J.EwaSettings.isChangeGateEnabled("OfficeVSO:8560736_shouldEnableBase64EncodingForContextualLocation");let $a=wa=class extends w.a{constructor(Ka,nb,sa){super();this.Gcf=this.Hcf=!1;this.fkb=0;this.swa=!1;this.pOj=()=>{this.Hcf=!0;this.vUg()};this.$=Ka;this.Za=nb;this.rV=sa;aa.a(this.$).lhe(new xa.a(fb.a.U4g,fb.a.idle,
wa.kVh),new ka.a(fb.a.pgf,fb.a.Nba,null,fb.a.EW,fb.a.idle))}get B5c(){return k.b(this.$.Zk)}get Qme(){return this.$.isEditMode&&(this.$.ea.cji||this.$.f1)}Ri(Ka,nb){switch(nb){case 353606613:case -1099009678:case 192430811:return!J.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.Gre();case 783415632:return!J.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||this.Gre();case 709515373:return!J.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")||
this.Gre();case 869186573:return this.NSg();case -1570751769:case 1986648902:return 131072!==(this.$.YX&131072);case 330035228:return!(this.Kkb(!0)&&this.B5c);case -509039657:return!(this.Kkb()&&this.B5c);case 1334518759:return!(this.Kkb()&&this.B5c&&this.Tcf())}return!1}Gre(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.NSg()}NSg(){const Ka=this.$.workbookContext.FullDocumentInfo,nb=Ia.a()&&this.$.ea.Vn.get(5);return!Ka.FileSharingUrl&&!nb}executeCommand(Ka,nb,sa){Ka=this.$.workbookContext.FullDocumentInfo;
const na=Sa.a.workflow;var ab=B.TaskExtensions.Gq();const Ja=nb.command;if(Ja===na||-266099===Ja)return this.P5i(nb,na,Ka);switch(Ja){case 1986648902:this.kRg();break;case -1570751769:this.v2i(nb);break;case 869186573:var Pa=Sa.a.bJk;nb=f.AFrameworkApplication.fa.ka("ShareMenuIsEnabled");ab=null;(J.EwaSettings.Ra(478)||nb)&&sa&&"CopyLink"===sa.SourceControlId?(ab={},ab[l.a.kxb]="copy",Pa=Sa.a.Dqe):nb&&sa&&"ManageAccess"===sa.SourceControlId?(ab={},ab[l.a.kxb]="manageAccess",Pa=Sa.a.dJk):sa&&"LinkToComment"===
sa.SourceControlId?(ab={},ab[l.a.kxb]="copy",ab[l.a.Eqe]=sa.navId,J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareContextualInfo",!1)&&(ab[l.a.URg]=8),Pa=Sa.a.Dqe):!sa||"SaveAsCopyLink"!==sa.SourceControlId&&"ShareCopyLink"!==sa.SourceControlId&&"ShareTabCopyLink"!==sa.SourceControlId?"SharePointOnlineConsumer"===f.AFrameworkApplication.fa.Ya("FileSource")&&(ab={},ia.a.DA("WACsimplifiedshare-t;WACsimplifiedshare-c"),sa=f.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsInOfficeSimplifiedShareTreatment",
!1),ab.isInOfficeSimplifiedShareTreatment=sa):(ab={},ab[l.a.kxb]="copy",Pa=Sa.a.Dqe);ab=this.XVg(Ka,ab);ua.c(Pa);break;case -1099009678:ab=this.i8b(12,Ka);break;case 192430811:ab=this.i8b(13,Ka);break;case 353606613:ab=this.i8b(14,Ka);break;case -1592351768:ab=t.a.Ua(!0);J.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&(sa=this.$.sa.ma,(null===(Pa=null===sa||void 0===sa?void 0:sa.dk)||void 0===Pa?0:Pa.cN)?(r.ULS.sendTraceTag(508164248,0,50,"SocialSharingCommandHandler.ExecuteCommand: Auto save named sheet view invoked, on sharing temporary named sheet view"),
this.$.si(621685370,-1,0,{[Ca.a.Xqf]:!0})):(sa=Ca.a.h6a,ab=this.i8b(16,Ka),sa!==la.a(this.$).us.OA&&la.a(this.$).us.activateRibbonTab(sa)));break;case 783415632:sa&&"LinkToThisSheet"===sa.SourceControlId&&r.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");ab=this.i8b(15,Ka);break;case -59906385:case 1197060601:this.L4i(nb,Ka);break;case 1305810481:this.wPf(!1,nb);break;case 330035228:this.wPf(!0,nb);break;case -509039657:Ka=Object(Ea.d)(oa.a.resolve(za.pd,
{va:0}));B.TaskExtensions.Xa(Ka,hb=>{this.deleteForm(hb.result)},this.$.ya,3);break;case 1334518759:nb.dWb=!0;Ka=Object(Ea.d)(oa.a.resolve(za.pd,{va:0}));B.TaskExtensions.Xa(Ka,hb=>{this.shareForm(hb.result)},this.$.ya,3);break;case 710925581:C.a.Wl.xZc("710925581")&&(ab=B.TaskExtensions.Xa(Object(Ea.d)(this.rV(0)),hb=>{hb.result.sendMessage(m.a.conversation,{})},this.ya,3));break;case 327119921:this.d2i();break;default:ab=M.a(Ja)}return ab}Gi(Ka,nb){Ka=!1;nb=nb.command;if(nb===Sa.a.workflow)return!0;
switch(nb){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Ka=!0;break;case 353606613:case -1099009678:case 192430811:Ka=J.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&!this.$.ea.isNamedObjectViewMode;break;case -1592351768:Ka=J.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&!this.$.ea.isNamedObjectViewMode;
break;case 783415632:Ka=J.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")&&!this.$.ea.isNamedObjectViewMode;break;case 709515373:Ka=J.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")&&!this.$.ea.isNamedObjectViewMode}return Ka}dj(Ka,nb,sa){if("PopulateFormMenu"===nb){nb=this.B5c?this.Tcf()?wa.sti:wa.tti:wa.$Jj;Ka=this.Za.ji();for(let na=0;na<nb.length;na++)Ka.buttons.push(this.Za.jh(nb[na]));nb=this.Za.qw("Forms.Flyout");nb.Mh.push(Ka);sa.MenuItems=nb.fM();
return!0}return!1}P5i(Ka,nb,sa){return this.Qme&&Ka.command===nb?(this.Ome(Ka,-266099),B.TaskExtensions.Daa()):B.TaskExtensions.Xa(Object(Ea.d)(this.rV(0)),na=>{K.a(na.result,m.a.workflow,null,sa.WorkflowPostMessage)||L.HelperMethods.Cm(sa.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ya,3)}Tcf(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Vn.get(26)}d2i(){const Ka=x.a.create().toString();r.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${Ka}`);
this.$.frame.$_b(Object(da.a)(Ka,this.$),!0)}v2i(Ka){this.Qme?this.Ome(Ka,1986648902):this.kRg()}wPf(Ka,nb){!Ka&&this.$.ua.SurveyRedirectUrl?this.Pak():(Ka=new I.a(this.$,Ka,nb),Ka.initialize(),Ka.Xs())}L4i(Ka,nb){this.Qme&&1197060601===Ka.command?this.Ome(Ka,-59906385):B.TaskExtensions.Xa(Object(Ea.d)(this.rV(0)),sa=>{sa=sa.result;sa&&K.a(sa,m.a.replyWithChanges,null,this.$.ea.Vn.get(8))||(sa=new Sys.StringBuilder(nb.ReplyWithChangesUrl),E.a.nr(sa,Oa.e,Oa.d),v.a.ntw(sa.toString(),this.$))},this.ya,
3)}Ome(Ka,nb){const sa=aa.a(this.$).xj.activityState,na=new F.a(nb,Ka.method,Ka.mode,Ka.jk,Ka.tabName);ba.a(this.$).Xy(new U.a(fb.a.DD,5,()=>{sa[ea.a.Yw]=fb.a.WKg;sa[ca.a.Qnd]=na;this.$.Ws.wI("SocialSharingSaveBeforeCommand");this.$.Ws.Y2e(na.command)}))}kRg(){const Ka=this.$.ua.DocumentHostInfo;Ka.HostEmbeddedViewUrl||this.Hcf?this.vUg():this.$.uk.get(53)&&B.TaskExtensions.Xa(Object(Ea.d)(this.rV(0)),nb=>{this.h4k(nb.result)||v.a.ntw(Ka.FileEmbedCommandUrl,this.$)},this.ya,3)}h4k(Ka){return Ka.isEnabled()&&
(this.Gcf||(this.Gcf=Ka.aq(m.a.Fcf,this.pOj)))?Ka.sendMessage(m.a.$ui,null):!1}vUg(){if(n.a.Zx)v.a.ntw(this.$.ua.EmbedConfiguratorUrl,this.$);else{const Ka=new D.a(this.$);Ka.initialize();Ka.Xs()}}deleteForm(Ka){const nb=this.$;Ka=new Ua.a(nb,1277,1278,1270,(sa,na,ab)=>{const Ja=nb.pa.ta.Vh();return ja.a(nb.pa.ta,sa,na,ab,null,Ja)},0,Ka);Ka.initialize();Ka.Xs()}shareForm(Ka){const nb=this.$.workbookContext.FullDocumentInfo;this.$.ea.Vn.get(26)?(Ka=new Y.a(this.$,Ka),Ka.initialize(),Ka.Xs()):B.TaskExtensions.Xa(Object(Ea.d)(this.rV(0)),
sa=>{K.a(sa.result,m.a.shareForm,{[l.a.nXk]:this.$.workbookContext.SurveyTitle},this.$.ea.Vn.get(10))||v.a.ntw(nb.ShareFormCommandUrl,this.$)},this.ya,3)}Pak(){const Ka=this.$;Ka.ua.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const nb=new Sys.StringBuilder(Ka.ua.SurveyRedirectUrl);E.a.nr(nb,"startupDialog","FormEdit");const sa=aa.a(this.$),na=sa.xj.activityState;na[ha.a.xea]=nb.toString();na[ha.a.qX]=ha.a.N6d;this.$.Ws.wI("SocialSharingEnvironmentChange");ba.a(Ka).Xy(new U.a(fb.a.DD,
5,()=>{const ab=W.a.nj(3,2,1322,1323,1324,554412057,"FossEnvironmentUnsupported");sa.xj.lz([ab]);na[ea.a.Yw]=fb.a.U4g}))}Kkb(Ka){return(this.$.ea.isEditMode||(void 0===Ka?!1:Ka))&&this.$.ea.Vn.get(25)&&Ia.a()}HWi(Ka){var nb=void 0===nb?null:nb;var sa=H.f(this.$).ha;let na=!1;const ab=this.$.sa.ma?y.d(this.$.sa.ma):null;if(!ab)return r.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${X.a[Ka]}.`),null;var Ja=nb;let Pa=nb=null;
const hb=J.EwaSettings.isChangeGateEnabled("OfficeVSO:8683552_ShareContextualInfo");switch(Ka){case 15:hb&&(Pa=this.$.activeItemName,nb=5);break;case 14:Ja=this.fWi(sa);hb&&(Pa=this.eWi(sa),nb=6);break;case 12:Ja=sa.Hva;Ja=Q.a.contains(Ja,"!",!0)?Ja.split("!")[1]:Ja;H.f(this.$).ha.qa.XI()&&(na=!0);hb&&(nb=3,Pa=Ja);break;case 13:var ac=sa.qa.selectedRanges;ac[0]&&(sa=ac[0],J.EwaSettings.isChangeGateEnabled("OfficeVSO:8116498_FShareTableContainingActiveCell")&&(sa=H.f(this.$).ha.qa.activeCell),sa=H.f(this.$).oh.Kl(sa),
J.EwaSettings.isChangeGateEnabled("OfficeVSO:8627979_CopyLinkToTableFix")&&!sa&&(sa=Va.a(this.$,ac[0])),sa&&(sa.activate({scenario:"namedObject"}),Ja=sa.Wq,hb&&(nb=4,Pa=sa.name)));break;case 16:J.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&(Ja=this.$.sa.ma,Ja=null===(ac=null===Ja||void 0===Ja?void 0:Ja.dk)||void 0===ac?void 0:ac.E_,hb&&(nb=7,Pa=Ja))}if(!Ja&&15!==Ka)return r.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${X.a[Ka]}`),
null;ac={};ac[l.a.kxb]="copy";ac[l.a.Eqe]=this.RKi(Ka,Ja,ab);ac[l.a.eJk]="deepLinkShare";hb&&(ac[l.a.URg]=nb,Pa?(nb=Jb?this.base64Encoding("'"+Pa+"'"):btoa("'"+Pa+"'"),ac[l.a.aJk]=nb):r.ULS.sendTraceTag(508036745,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find contextual sharing location for navType: ${X.a[Ka]}`));r.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${X.a[Ka]} and sectionNameOrId: ${Ja} and SheetId: ${ab} and isPartialTable: ${na}`);
return ac}fWi(Ka){if(Ka.$e.isFloatingObjectSelected&&(Ka=Ka.$e.Lh.floatingObject)&&0===Ka.type){const nb=Ka.id.split(".");if(1<nb.length)return nb[1];r.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${Ka.id}`)}return null}eWi(Ka){var nb;return(Ka=null===Ka||void 0===Ka?void 0:Ka.$e)&&Ka.isFloatingObjectSelected&&(Ka=null===(nb=Ka.Lh)||void 0===nb?void 0:nb.floatingObject)&&0===Ka.type?Ka.name:null}RKi(Ka,nb,sa){let na=Ka+
"_";na=15===Ka?na+sa:na+(nb+"_"+sa);Jb?na=this.base64Encoding(na):(na=btoa(na),na=na.replace(RegExp("\\+","g"),"-"),na=na.replace(RegExp("\\/","g"),"_"),na=na.replace(RegExp("\\=+$","g"),""));(null==na||1024<na.length)&&r.ULS.sendTraceTag(507785753,0,10,`SocialSharingCommandHandler.GetEncodedValue: Either encoded navid is null or the length of encoded navid : ${na} exceeds 1024 characters.`);return na}base64Encoding(Ka){try{let nb=c.from(Ka).toString("base64");nb=nb.replace(RegExp("\\+","g"),"-");
nb=nb.replace(RegExp("\\/","g"),"_");return nb=nb.replace(RegExp("\\=+$","g"),"")}catch(nb){r.ULS.sendTraceTag(507785752,0,10,`SocialSharingCommandHandler.Base64Encoding: Error while base64 encoding the content: ${Ka}. The exception is: ${nb}`)}return null}XVg(Ka,nb,sa){sa=void 0===sa?!1:sa;return B.TaskExtensions.Xa(Object(Ea.d)(this.rV(0)),na=>{K.a(na.result,m.a.sharing,nb,this.$.ea.Vn.get(5))?(r.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${nb?
nb[l.a.kxb]:""}`),sa&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&!this.swa&&(this.fkb=window.setInterval(()=>{this.$1k()},6E4),this.swa=!0)):L.HelperMethods.Cm(Ka.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ya,3)}i8b(Ka,nb){if(15===Ka&&!J.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||15!==Ka&&!J.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.$.isMobileMode)return null;const sa=
this.HWi(Ka);if(sa)return r.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${sa[l.a.Eqe]}`),this.XVg(nb,sa,!0);r.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${X.a[Ka]}`);return null}$1k(){this.swa&&window.clearInterval(this.fkb);this.$.si(638984051,0,0,null);r.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered.")}};
$a.$Jj=[103];$a.sti=[107,104,105,106];$a.tti=[104,105];$a.kVh=[new Ya.a(fb.a.pgf,554412057,0,0,1325),new Ya.a(fb.a.idle,554412057,0,1)];$a=wa=Object(b.__decorate)([Object(oa.d)(za.lg),Object(b.__param)(0,Object(za.Nb)()),Object(b.__param)(1,Object(za.uf)()),Object(b.__param)(2,Object(za.nd)({v1:!0}))],$a);Object(h.a)($a,"SocialSharingCommandHandler",w.a,[34])}).call(this,a(774).Buffer)},1462:function(A,u,a){function c(x,n){const t=new h.QueryStringBuilder(b.AFrameworkApplication.fa.Ya("TeamsMeetingShareEndpoint"));
t.fq("deeplinkId",x);t.fq("lm","deeplink");x=t.fq;var w={};const v=new h.QueryStringBuilder(b.AFrameworkApplication.fa.Ya("TeamsAppSharingUrl"));v.fq("auth","2");v.fq("flight","officeunihost");v.fq("source","deepLink_online");var k={};k.fileType=r.a.vaa(n.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);k.objectUrl=m.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(n.workbookContext.FullDocumentInfo.WorkbookPath):n.workbookContext.FullDocumentInfo.WorkbookPath;
k.baseUrl=m.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(n.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl):n.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{n=n.workbookContext.WorkbookFileVersionId;let y=decodeURIComponent(n);for(;n!=y;)n=y,y=decodeURIComponent(n);0>n.indexOf("{")||0>n.indexOf("}")?(l.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${n}`),n=""):n=n.substring(n.indexOf("{")+1,n.indexOf("}")).toLowerCase()}k.fileId=
n;k=f.c(f.c(k));v.fq("subEntityId",k.substring(1,k.length-1));w.appSharingUrl=v.toString();w.appId=b.AFrameworkApplication.fa.Ya("TeamsAppId");w.useMeetNow=!0;w=JSON.stringify(w);x.call(t,"appContext",w);return t.toString()}a.d(u,"a",function(){return c});var b=a(6),h=a(288),r=a(33),f=a(47),l=a(15),m=a(1)},1463:function(A,u,a){a.d(u,"a",function(){return f});A=a(0);var c=a(15);u=a(1270);var b=a(7),h=a(242),r=a(12);class f extends u.a{constructor(l){super(l,new Sys.UI.Point(960,680),r.a.instance.ia(1264));
this.name=b.a.Vsf}get Di(){return"EmbeddingDialog"}jHf(l){const m=new Sys.StringBuilder(this.$.ua.EmbedConfiguratorUrl);h.a.nr(m,b.a.Zni,l);this.$.ua.AlternateEwaBasePrefix&&h.a.nr(m,b.a.gvf,this.$.ua.AlternateEwaBasePrefix);this.$.ua.AlternateEwaBaseFolder&&h.a.nr(m,b.a.fvf,this.$.ua.AlternateEwaBaseFolder);return m.toString()}onShow(){c.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(A.a)(f,"EmbeddingDialog",u.a,[])},1464:function(A,u,
a){a.d(u,"a",function(){return v});A=a(0);var c=a(94),b=a(35);u=a(1225);var h=a(148),r=a(19),f=a(656),l=a(1172),m=a(16),x=a(12),n=a(328),t=a(1272),w=a(1271);class v extends u.a{constructor(k,y){super(k,x.a.instance.ia(1271));this.Bi=this.k$a=this.J7a=this.Wa=null;this.Srg=()=>{const C=this.$;this.nK();const B=new w.a(C,1274,1275,1276,(E,K,F)=>{const W=C.pa.ta.Vh();return t.c(C.pa.ta,E,K,F,null,W)},16,this.Bi);B.initialize();B.Xs()};this.Bi=y}get Di(){return"ShareFormDialog"}dispose(){this.k$a&&this.k$a.Iia(this.Srg);
c.a.gj([this.Wa,this.J7a,this.k$a]);this.k$a=this.J7a=this.Wa=null;super.dispose()}initialize(){let k="<div class='"+h.e+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+h.d+"'>\r\n\t<input type='text' id='{1}' class='"+h.c+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";k=String.format(k,x.a.instance.ia(1272),"sfd_input","sfd_unshare",r.a.CD,x.a.instance.ia(1273));this.Bi.hr(this.tj,k);this.Wa=new n.a(this.getElementById("sfd_input"));
this.J7a=new l.a(this.Wa.domElement);this.k$a=f.a.create(this.getElementById("sfd_unshare"));this.k$a.e$(this.Srg);this.Wa.text=x.a.instance.ia(736);this.Wa.enabled=!1;this.Wa.readOnly=!b.a.oo;this.addButton(1,10);super.initialize()}rgb(){return(k,y,C)=>{const B=this.$.pa.ta.Vh();return t.b(this.$.pa.ta,this.nlb(k),this.b_a(y),C,null,B)}}Tba(k,y,C){this.Wa.text=k.Result;this.Wa.enabled=!0;m.DOMElementExtensions.setVisible(this.k$a.domElement,!0);super.Tba(k,y,C)}setFocus(){if(this.Wa&&this.Wa.enabled)try{this.Wa.focus();
return}catch(k){}super.setFocus()}}Object(A.a)(v,"ShareFormDialog",u.a,[])},1465:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);var c;(function(b){b[b.comment=10]="comment";b[b.range=12]="range";b[b.table=13]="table";b[b.chart=14]="chart";b[b.sheet=15]="sheet";b[b.namedSheetView=16]="namedSheetView"})(c||(c={}));Object(A.b)("NavigationType",c)},1518:function(A,u,a){a.d(u,"a",function(){return B});A=a(0);var c=a(1067),b=a(94),h=a(79),r=a(958);u=a(1270);class f{}f.VRg="FrameDialog_ShareFromEdit";
f.view="FrameDialog_View";f.lgf="FrameDialog_CloseAndRefresh";f.cJk="FrameDialog_ShareFromView";f.edit="FrameDialog_Edit";f.Zgk="FrameDialog_RefreshGrid";f.CYh="FrameDialog_CloseMe";f.qgf="FrameDialog_CloseMeError";f.ready="FrameDialog_Ready";f.R6j="FrameDialog_PleaseClose";f.$U="GotoRange";Object(A.a)(f,"PostMessageConstants",null,[]);var l=a(7),m=a(216),x=a(358),n=a(242),t=a(124),w=a(254),v=a(12),k=a(264),y=a(23);class C{constructor(){this.$U=null;this.qde=1461300262}}Object(A.a)(C,"SessionUpdateContext",
null,[]);class B extends u.a{constructor(E,K,F){super(E,new Sys.UI.Point(B.Kci,B.fci),v.a.instance.ia(K?1269:1268));this.jib=null;this.Kdd=!1;this.RQc=W=>{const J=this.$,L=new C;L.$U=W.Values[f.$U];let M=!1;switch(W.MessageId){case f.VRg:this.nK();M=!0;L.qde=1334518759;break;case f.view:this.SQa=v.a.instance.ia(1269);this.j7g(!0);break;case f.lgf:this.nK(),M=!0}W=new m.a(140,0,(Q,H,ba)=>x.r(J.pa.ta,k.c(Q,this.SZj),H,ba,L));W.flags=M?16:80;J.userOperationManager.enqueueOperation(W,this.Nh)};this.pRj=
()=>{const W=this.$;W.ua.SurveyRedirectUrl?(this.nK(),W.si(1305810481,0,8,null)):(this.SQa=v.a.instance.ia(1268),this.j7g(!1))};this.e_j=()=>{const W=this.$;this.nK();W.si(1334518759,0,8,null)};this.SOc=W=>{const J=this.$;this.nK();W.MessageId===f.qgf&&J.ea.DId()};this.xYj=()=>{this.Kdd=!0;this.raiseEvent(B.h2d)};this.SZj=(W,J)=>{if(!w.a(W)){W=this.$;if(J.$U){const L=W.ea.sa;if(L.contains(J.$U.SheetName))this.CPc(J);else{let M=null;M=()=>{L.UAa(M);this.CPc(J)};L.fua(M)}}1461300262!==J.qde&&W.si(J.qde,
0,8,null)}};this.dX=K;this.Nh=F}eDh(E){this.addHandler(B.h2d,E)}mnk(E){this.removeHandler(B.h2d,E)}get Di(){return"FormDialog"}get e0f(){return this.Kdd}get ZIc(){return this.dX}dispose(){b.a.dh(this.jib);this.jib=null;super.dispose()}initialize(){super.initialize();const E=h.a.getOrigin(this.$.ua.FormLightBoxUrl),K=this.jib=new c.a(this.z0a.contentWindow,E);K.isEnabled()&&K.sX(E)&&(this.NAa(f.VRg,this.RQc),this.NAa(f.view,this.RQc),this.NAa(f.lgf,this.RQc),this.NAa(f.cJk,this.e_j),this.NAa(f.edit,
this.pRj),this.NAa(f.Zgk,this.RQc),this.NAa(f.ready,this.xYj),this.NAa(f.CYh,this.SOc),this.NAa(f.qgf,this.SOc))}close(E){E===this.b0&&this.e0f&&this.jib.send(new r.a(f.R6j))||super.close(E)}jHf(){return this.Xkf(this.ZIc)}Xkf(E){const K=this.$.ua,F=new Sys.StringBuilder(K.FormLightBoxUrl);n.a.nr(F,l.a.Azi,this.$.ea.sessionId);n.a.nr(F,l.a.yzi,E?l.a.zzi:l.a.xzi);t.a.TIb(F,K);return F.toString()}j7g(E){this.Kdd=!1;this.z0a.src=this.Xkf(E);this.dX=E}NAa(E,K){this.jib.kr(E);this.jib.aq(E,K)}CPc(E){const K=
this.$.ea.sa.getItemByName(E.$U.SheetName);K&&0===K.zJ&&y.f(this.$).ep(E.$U,null,null,null,20,"FormDialog.OnItemInserted")}}B.Kci=900;B.fci=1200;B.h2d="lightBoxReady";Object(A.a)(B,"FormDialog",u.a,[545])},331:function(A,u,a){a.r(u);var c={};a.r(c);a.d(c,"CreateNewCommandHandler",function(){return F});var b={};a.r(b);a.d(b,"MsFormCommandHandler",function(){return ea});var h={};a.r(h);a.d(h,"NamedSheetViewPublic",function(){return Ca});var r={};a.r(r);a.d(r,"NamedSheetViewTeachingCallout",function(){return ab});
var f={};a.r(f);var l={};a.r(l);a.d(l,"OpenFromMruCommandHandler",function(){return Pb});var m={};a.r(m);a.d(m,"SheetOptionsToggleCommandHandler",function(){return cd});var x={};a.r(x);a.d(x,"SortFilterManager",function(){return Lb});var n={};a.r(n);a.d(n,"TryOfficeThroughTellMeCommandHandler",function(){return kc});var t=a(135),w=a(0),v=a(6),k=a(211),y=a(26),C=a(67),B=a(5),E=a(95),K=a(25);let F=class{constructor(bc){this.Qn=bc}Ri(){return!1}executeCommand(bc,vc,Xc){bc=2;switch(vc.command){case 1056925771:bc=
this.Qn.ek(y.a.newDocument,2,Xc);break;case y.a.Nua:bc=this.Qn.ek(y.a.Nua,2,Xc);break;case y.a.Lba:bc=this.Qn.ek(y.a.Lba,2,Xc)}return 2!==bc?C.Task.Ua(!0):k.a(vc.command)}Gi(bc,vc){bc=!1;switch(vc.command){case 1056925771:bc=!0;break;case y.a.Nua:case y.a.Lba:bc=K.a.B6()}return bc}dj(bc,vc,Xc){bc=!0;switch(vc){case "PopulateNewMenu":this.Qn&&(v.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(v.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",v.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage=
"23"),this.Qn.ek(K.a.B6()?y.a.Ivg:y.a.Stb,2,Xc));break;default:bc=!1}return bc}};F=Object(t.__decorate)([Object(E.d)(B.kb),Object(t.__param)(0,Object(B.f)()),Object(t.__param)(1,Object(B.cb)()),Object(t.__param)(2,Object(B.ee)())],F);Object(w.a)(F,"CreateNewCommandHandler",null,[34]);var W=a(33),J=a(93),L=a(216),M=a(39),Q=a(13),H=a(28),ba=a(264),U=a(529);class D{}D.create="Create";D.activate="Activate";D.close="Close";D.remove="Delete";D.duplicate="Duplicate";Object(w.a)(D,"Actions",null,[]);var I=
a(36),X=a(44);class Y extends C.Task{constructor(bc){super();this.VCe=null;this.XCe=0;this.mdc=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.Fcb=this.Fcb()}catch(vc){this.dispose(),this.ZPa(vc),this._state=3}};this.lD=bc;this.Fcb=this.M5c;this.moveNext()}M5c(){this.VCe=I.a.nj(3,2,0,1667,0,-1244327602,"MsFormDeleteConfirmation");this.mdc=X.a(this.lD.$).Ip(this.VCe).G();this.mdc.isCompleted||(this._state=2,this.mdc.jsb(this.moveNext));return this.kah}kah(){this.XCe=
this.mdc.TR();0===this.XCe&&(this.lD.$.workbookContext.Options=Q.HelperMethods.NZ(!1,this.lD.$.workbookContext.Options,2048),this.lD.deleteMsFormMetaDataSheet());this._state=3;this.X7a(!0)}dispose(){}}Object(w.a)(Y,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",C.Task,[4]);class ja{}ja.action="Action";ja.Ixi="FlexPane";ja.dzc="formId";ja.id="id";ja.title="Title";ja.hcc="XlWorkbookId";ja.Yzi="Fragment";ja.host="Host";ja.y1g="TopView";ja.accountType="auth_pvr";ja.yve=
"subpage";Object(w.a)(ja,"Parameters",null,[]);var Ua=a(64);const ka=(bc,vc,Xc,ad,Id,ue,Vd)=>{Vd=bc.$a(9,void 0===Vd?null:Vd);Vd.sheetName=vc;Vd.confirmationChoice=!0;return Ua.h(bc,"DeleteSheet",Vd,Xc,ad,Id,ue,0)};var fb=a(1),ha=a(773);let ea=class{constructor(bc){this.ku="Excel";this.$=bc;this.D5=U.a.current;this.lbc=fb.EwaSettings.isChangeGateEnabled("OfficeVSO:8570812_UseFormsDesignPageV2")}get hasMsForm(){return J.c(this.$.Zk)||this.lbc&&this.$.workbookContext.HasMsFormsExcelDataSync}get c4a(){return this.$.workbookContext.MsFormId}get ccc(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return H.a.contains(this.$.BI.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}Ri(bc,vc){switch(vc){case -105284469:return!J.j(this.$.Zk)||this.hasMsForm||fb.EwaSettings.isChangeGateEnabled("OfficeVSO:8155542_MsFormsRibbonAndDisconnectionSupport")&&this.$.workbookContext.HasMsFormsExcelDataSync;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(bc,vc){bc=M.TaskExtensions.Gq();vc=vc.command;switch(vc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;
case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:bc=this.deleteMsForm();break;default:bc=k.a(vc)}return bc}Gi(bc,vc){if(!this.$.ea.Vn.get(61))return!1;bc=!1;switch(vc.command){case -105284469:bc=J.j(this.$.Zk)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:bc=this.hasMsForm}return bc}dj(){return!1}insertMsForm(){const bc=W.a.Dz(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),vc={},Xc={};vc[ja.action]=
D.create;vc[ja.accountType]=this.accountType;Xc[ja.action]=D.create;Xc[ja.hcc]=encodeURIComponent(this.ccc);Xc[ja.host]=this.ku;Xc[ja.title]=encodeURIComponent(bc);this.i_b(vc,Xc);this.$.workbookContext.Options=Q.HelperMethods.NZ(!1,this.$.workbookContext.Options,2048)}editMsForm(){const bc={},vc={};this.lbc&&this.$.workbookContext.HasMsFormsExcelDataSync?(vc[ja.host]=this.ku,vc[ja.yve]="design",vc[ja.id]=this.c4a,vc[ja.accountType]=this.accountType):(bc[ja.accountType]=this.accountType,vc[ja.dzc]=
this.c4a,vc[ja.hcc]=encodeURIComponent(this.ccc),vc[ja.host]=this.ku);this.i_b(bc,vc)}previewMsForm(){const bc={},vc={};this.lbc&&this.$.workbookContext.HasMsFormsExcelDataSync?(vc[ja.host]=this.ku,vc[ja.yve]="design",vc[ja.id]=this.c4a,vc[ja.accountType]=this.accountType):(bc[ja.accountType]=this.accountType,vc[ja.dzc]=this.c4a,vc[ja.hcc]=encodeURIComponent(this.ccc),vc[ja.host]=this.ku);vc[ja.y1g]="Preview";this.i_b(bc,vc)}sendMsForm(){const bc={},vc={};this.lbc&&this.$.workbookContext.HasMsFormsExcelDataSync?
(vc[ja.host]=this.ku,vc[ja.yve]="design",vc[ja.id]=this.c4a,vc[ja.accountType]=this.accountType,vc[ja.y1g]="Send"):(bc[ja.accountType]=this.accountType,vc[ja.dzc]=this.c4a,vc[ja.Ixi]="SendForm",vc[ja.hcc]=encodeURIComponent(this.ccc),vc[ja.host]=this.ku);this.i_b(bc,vc)}deleteMsForm(){return new Y(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.$O(new L.a(158,0,(bc,vc,Xc)=>ka(this.$.pa.J1,this.D5.zQb,ba.c(bc,()=>{this.qdi()}),vc,Xc,null)))}qdi(){const bc={},vc={};bc[ja.action]=D.remove;
bc[ja.accountType]=this.accountType;vc[ja.action]=D.remove;vc[ja.host]=this.ku;vc[ja.dzc]=encodeURIComponent(this.c4a);vc[ja.hcc]=encodeURIComponent(this.ccc);this.i_b(bc,vc)}i_b(bc,vc){var Xc=void 0===Xc?!0:Xc;if(this.lbc&&this.$.workbookContext.HasMsFormsExcelDataSync){Xc=this.$.ua.MsFormBaseUrl+"/Pages/DesignPageV2.aspx";var ad="";if(vc)for(var Id in vc){bc=Id;var ue=vc[Id];ad+=ad.length?"&":"?";ad+=bc+"="+ue}window.open(Xc+ad,"_blank")}else{Id=this.$.ua.MsFormBaseUrl+"/Pages/"+(Xc?"DesignPage":
"ResponsePage")+".aspx";let Yd=Xc="";if(vc){for(ad in vc){var Vd=ad,Kd=vc[ad];Yd+=Yd.length?"&":"";Yd+=Vd+"="+Kd}bc||(bc={});bc[ja.Yzi]=encodeURIComponent(Yd)}if(bc)for(ue in bc)vc=ue,ad=bc[ue],Xc+=Xc.length?"&":"?",Xc+=vc+"="+ad;window.open(Id+Xc,"_blank")}}};ea=Object(t.__decorate)([Object(E.d)(B.Ud),Object(t.__param)(0,Object(B.Nb)()),Object(t.__param)(1,Object(ha.b)())],ea);Object(w.a)(ea,"MsFormCommandHandler",null,[34]);var aa=a(183),ca=a(430),xa=a(240),Oa=a(177);class ua{static L5(){return xa.a.rB(ua.uw,
Oa.a.Ea(444))}}ua.uw="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(w.a)(ua,"NamedSheetViewTeachingDialogHtml",null,[]);var Ia=a(65),Sa=a(198),Ya=a(83),da=a(12),Ea=a(62),oa=a(7);class za extends ca.a{constructor(bc){super(bc);
this.stopwatch=this.yC=null;this.jJj=vc=>{if(1===vc){var Xc={[oa.a.G6d]:!1};this.$.Ma.qh(new Ya.a(-2050946363,Ia.a.rh,2,8,null),Xc).continueWith(ad=>{this.yC.setResult(!Sa.a(ad)&&ad.result)});vc="Yes"}else Xc=2===vc,this.yC.setResult(Xc),vc=2===vc?"No":"Close",Xc&&this.d$j();this.MAj(vc);this.hide()}}get Di(){return"ShowNamedSheetViewTeachingDialog"}Zm(){this.Ph=4;this.stopwatch=this.$.Eh.Li("UserAction",this.Di);const bc=da.a.instance.ia(1913);this.lp=ua.L5();this.yC=new aa.a;this.initializeAndShow(bc,
this.jJj,{});return this.yC.task}qL(bc){super.qL(bc);this.ti(1,da.a.instance.ia(1915));this.ti(2,da.a.instance.Ea(457))}d$j(){this.$.ea.H6d=!1}MAj(bc){const vc={};vc.a=this.$.ua.UserSessionId;vc.b="NamedSheetViewTeachingDialogClose";vc.c=bc;vc.e=!0;this.stopwatch&&(this.stopwatch.stop(),vc.d=this.stopwatch.zi);Ea.b().Ll(53,vc,!0)}}Object(w.a)(za,"NamedSheetViewTeachingDialog",ca.a,[]);var la=a(151);let Ca=class{constructor(bc){this.$=bc;this.XXd=fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableSortFilterNSVEntryInSelfCoauthor",
!1)}D8a(){return this.TMk()?(new za(this.$)).Zm():C.Task.Ua(!0)}TMk(){const bc=this.$.sa.ma;return this.$.ea.Pba&&this.$.ea.H6d&&!bc.dk.jx&&(this.XXd?this.$.ea.xVd()||!this.$.ea.K_&&this.$.ea.$3f():this.$.ea.IU)&&!Object(la.e)(this.$)&&!this.$.ea.Ih.allowViewCollab}};Ca=Object(t.__decorate)([Object(E.d)(B.Zd),Object(t.__param)(0,Object(B.Nb)())],Ca);Object(w.a)(Ca,"NamedSheetViewPublic",null,[542]);var Va=a(2),ia=a(210),wa=a(1460),Jb=a(1111),$a=a(533);class Ka{constructor(bc,vc,Xc,ad,Id,ue,Vd){this.title=
bc;this.body=vc;this.t$j=Xc;this.primaryButtonAction=ad;this.secondaryButtonAction=ue;this.CMg=Id;this.targetObject=Vd}}Object(w.a)(Ka,"NamedSheetViewTeachingCalloutContent",null,[]);class nb{constructor(bc){this.GZe=0;this.F_g=bc}get D_g(){return this.GZe}get abk(){return this.D_g<this.F_g.count?this.F_g.na(this.GZe++):null}}Object(w.a)(nb,"NamedSheetViewTeachingCalloutList",null,[]);var sa=a(1269),na;let ab=na=class{constructor(bc){this.$=bc;this.stopwatch=this.Mnc=this.t1c=this.xwe=null;this.E_g=
0}ebj(bc){this.E_g=bc;const vc=Object(Va.a)(new ia.a,{});na.Ukj(bc)?(vc.add(new Ka(da.a.instance.Ea(446),da.a.instance.Ea(447),da.a.instance.ia(1943),()=>{this.Iha(2,"Continue");this.Qma(!0)},da.a.instance.ia(1944),()=>{this.Qma();this.Iha(1,"ExitGuide")},sa.a())),1===bc&&vc.add(new Ka(da.a.instance.ia(1945),da.a.instance.Ea(449),da.a.instance.ia(1943),()=>{this.Iha(2,"FirstEnterTempViewContinueSecond");this.Qma(!0)},da.a.instance.ia(1944),()=>{this.Qma();this.Iha(1,"FirstEnterTempViewExitGuideSecond")},
sa.a())),vc.add(new Ka(da.a.instance.Ea(450),da.a.instance.Ea(451),da.a.instance.ia(1943),()=>{this.Iha(2,"FirstEnterExitCalloutContinue");this.Qma(!0)},da.a.instance.ia(1944),()=>{this.Qma();this.Iha(1,"FirstEnterExitCalloutGuide")},na.PQi())),vc.add(new Ka(da.a.instance.ia(1946),da.a.instance.Ea(448),da.a.instance.ia(1947),()=>{this.gQk();this.Qma();this.Iha(1,"LearnMore")},da.a.instance.ia(1948),()=>{this.Qma();this.Iha(1,"Done")},na.OQi()))):2===bc&&vc.add(new Ka(da.a.instance.ia(1945),da.a.instance.Ea(449),
da.a.instance.ia(1942),()=>{this.Qma();this.Iha(1,"EnterTempViewAfterPersistedView")},null,null,sa.a()));this.xwe=new nb(vc)}gQk(){const bc=new Ya.a(-859308420,Ia.a.rh,this.$.hi,9,null);this.$.Ma.qh(bc,{[Ia.a.Xk]:"HelpID=SheetViews",["InputMethod"]:Ia.a.rh,[Ia.a.Qi]:oa.a.FK,["ShouldCanvasTakeFocus"]:!0})}show(bc){this.ebj(bc);this.showInternal()}uFk(bc){this.Mnc=bc}showInternal(){var bc=this.xwe.abk;if(bc){var vc=Object(Va.a)(new wa.a,{label:bc.t$j,onExecute:bc.primaryButtonAction}),Xc=null;bc.CMg&&
(Xc=Object(Va.a)(new wa.a,{label:bc.CMg,onExecute:bc.secondaryButtonAction}));bc=Object(Va.a)(new Jb.a,{target:bc.targetObject,content:bc.body,title:bc.title,showCloseIcon:!0,primaryButtonProps:vc,secondaryButtonProps:Xc,useTeachingStyles:!0});bc=this.Mnc.callout(bc);vc=Object(Va.a)(new $a.a,{onShow:()=>{this.Iha(0)}});this.t1c=this.Mnc.addNotification(bc,vc)}}dismiss(){this.Qma();this.Iha(1,"DismissedByOthers")}Qma(bc){bc=void 0===bc?!1:bc;this.t1c&&(this.Mnc.removeNotification(this.t1c),this.t1c=
null);bc&&this.showInternal()}Iha(bc,vc){const Xc={};Xc.a=this.$.ua.UserSessionId;Xc.b=this.E_g;Xc.c=this.xwe.D_g;Xc.d=bc;Xc.e=void 0===vc?null:vc;0===bc?this.stopwatch=this.$.Eh.Li("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Xc.f=this.stopwatch.zi,this.stopwatch=null),2===bc&&(this.stopwatch=this.$.Eh.Li("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Ea.b().Ll(52,Xc,!0)}static OQi(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static PQi(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static Ukj(bc){return 0===
bc||1===bc}};ab=na=Object(t.__decorate)([Object(E.d)(B.ae),Object(t.__param)(0,Object(B.Nb)())],ab);Object(w.a)(ab,"NamedSheetViewTeachingCallout",null,[541]);var Ja=a(1267),Pa=a(42),hb=a(1266),ac=a(598),Hc=a(15),bd=a(142),zc=a(1026),oc=a(160),Nb=a(22);class Aa{static Vki(bc){return Aa.pbf("New",bc)}static Wki(bc){return Aa.pbf("Open",bc)}static bbf(bc,vc){return Aa.Qua("LoadingMenuSection",Aa.Cyj,bc,Aa.XJb("lblLoading",vc))}static YJb(bc,vc,Xc,ad){return Aa.Qua("MessageMenuSection",Aa.Cdg,vc,Aa.XJb("lblMessage",
bc,void 0===Xc?null:Xc,void 0===ad?null:ad))}static wPh(bc){return Aa.bbf(bc,Object(Nb.a)("VoicedLoadingText"))}static xPh(bc,vc){return Aa.YJb(Object(Nb.a)("NewCreationLocationMessage"),bc.yo,vc.oZ,vc.fCa)}static vPh(bc,vc){return Aa.YJb(String.format(Object(Nb.a)("NewProvisioningStorageMessage"),vc.fCa,"\n\n"),bc.yo)}static dbf(bc){return Aa.YJb(Object(Nb.a)("NewGenericErrorMessage"),bc.yo)}static tPh(bc,vc,Xc){return Aa.Qua("menuNewBlank",Aa.h7i,Xc?bc.yo:null,Aa.RJb(bc.GRf,bc.HRf,bc.IRf,null,bc.c6,
bc.lUb,vc,"blank"))}static tQh(){return Aa.XJb("lblTemplatesLoading",Object(Nb.a)("VoicedLoadingText"))}static nbf(){return Aa.XJb("lblTemplatesError",Object(Nb.a)("NewTemplateErrorMessage"))}static uQh(bc,vc){return Aa.Qua("menuNewTemplates",bc,null,vc)}static rPh(bc,vc){return Aa.Qua("menuNewMoreTemplates",Aa.zBf,null,Aa.RJb("menuNewMoreTemplatesButton",Object(Nb.a)("NewMoreTemplates"),Object(Nb.a)("NewMoreTemplates"),null,null,null,bc,vc))}static vOh(bc,vc,Xc){let ad="";Xc&&vc&&(ad=Aa.Qua("BrowseMoreMenuSection",
Aa.zBf,null,Aa.RJb("btnBrowseMore",vc,vc,null,null,null,bc||"1959943459",Xc)));return ad}static XJb(bc,vc,Xc,ad){Xc=void 0===Xc?null:Xc;let Id=ad=void 0===ad?null:ad;vc&&0<vc.length&&(Id=Aa.Keg.TRc(vc).trimEnd(),Id=0<=Id.indexOf("{0}")?String.format(Id,ad):String.format("{0} {1}",Id,ad));Xc=Xc&&ad?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',W.a.qm(Xc),W.a.qm(ad),W.a.qm(Id)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
W.a.qm(bc||""),Aa.Keg.TRc(W.a.qm(vc||"")),Xc)}static RJb(bc,vc,Xc,ad,Id,ue,Vd,Kd){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',W.a.qm(bc||""),W.a.qm(vc||""),W.a.qm(Xc||""),ad||"32by32",W.a.qm(Id||""),W.a.qm(ue||""),Vd,W.a.qm(Kd||""))}static pbf(bc,vc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
bc,vc)}static Qua(bc,vc,Xc,ad){Xc=Xc?String.format('Title="{0}"',W.a.qm(Xc)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',W.a.qm(bc||""),W.a.qm(vc||""),Xc,ad)}}Aa.Cdg="MenuMru";Aa.Cyj="MenuLoading";Aa.h7i="MenuHeader";Aa.zBf="MenuFooter";Aa.Keg=oc.a.aH("\n","&#10;");Object(w.a)(Aa,"NewAndOpenXmlUtilities",
null,[]);var Ub=a(107),Db=a(101),Ib=a(117),yc=a(47);class xc{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(w.a)(xc,"HostInformation",null,[]);var zb=a(125),vb=a(59),bb=a(394),La=a(144),pb=a(771),fa=a(672),kb=a(136),db=a(660),gb=a(357),Kb=a(284),ub=a(299),lb=a(35),Ba=a(309),ra=a(488),wb=a(432),mc=a(289),xb=a(970),Ec=a(241);const ed={d2c:"CreateNewDocument_FileMenu",featureName:"New",Ama:"wwbootperf",iAb:"Boot",Afb:"Boot",Qqf:!1};class jd{get I1(){this.eFa||(this.eFa=
Pa.a.instance.Ho("Common.App.SaveToCloudStorage.ODCXStackOperationManager"));return this.eFa}constructor(bc,vc,Xc,ad,Id,ue){this.CGb=this.hw=this.Ddc=null;this.$jc=this.Bkd=!1;this.qSe=0;this.$dd=!1;this.qfe=()=>32;this.Nua=(Vd,Kd,Yd,Bc,Mc)=>{if(1===Yd)return 32;Mc.MenuItemId=this.sQi();return this.Ty.gNa.ek(y.a.openUrlInNewTab,Yd,Mc,Bc)};this.WJj=Vd=>{if(Vd&&Vd.data&&Vd.data.responseData){var Kd;let Yd=yc.d(Vd.data.responseData);({zz:Kd}=Yd);Yd.returnValue?(Vd=Kd,Vd.NewDocumentUrl?(Hc.ULS.sendTraceTag(507565458,
202,50,"Got NewDocumentUrl with server StatusCode: {0}",Vd.StatusCode),vb.a.Cm(Vd.NewDocumentUrl,"_blank",void 0,"CreateNewDocument"+(Vd.StatusCode!==Ec.a.HL&&Vd.StatusCode!==Ec.a.bYa?"ErrorRedirect":""))):(Hc.ULS.sendTraceTag(507565459,202,10,"NewDocumentUrl not available"),this.TTc())):(Hc.ULS.sendTraceTag(507565461,202,10,"Failed to deserialize: {0}",{["ResponseData"]:xb.a.Z9a(Vd.data.responseData)}),this.TTc())}else Hc.ULS.sendTraceTag(507565462,202,10,"Response data not available"),this.TTc()};
this.VJj=Vd=>{Vd&&Vd.data&&Hc.ULS.sendTraceTag(507565457,202,10,"Request failed with status: {0}",Vd.data.status);this.TTc()};this.w7j=(Vd,Kd,Yd,Bc,Mc)=>{if(1===Yd)return 32;this.Ty.supportsGetMoreInfoForPersonalStorage&&!this.hw&&this.Leg.TR("Opened New menu",!0);Mc.MenuItems=Object.assign(new ra.a,{Id:"NewSection",MenuSectionList:[],UpdateDynamically:!0});Vd=this.d6h();Mc.MenuItems.MenuSectionList.push(Vd);return 32};this.Stb=(Vd,Kd,Yd,Bc,Mc)=>{if(1===Yd)return 32;2!==Yd||this.$dd||(this.qSe=(new Date).getTime(),
this.Hgc&&this.hfc.Dba({Gw:"CreateNewDocument_FileMenuRender",Ypb:gb.b.FailureBased}),Hc.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.TZc,["CachedNewMenuXmlExists"]:!!this.Ddc,["ShouldCallGetMoreInfo"]:this.Ty.supportsGetMoreInfoForPersonalStorage}));return this.Fnh&&ub.a.instance.aN(v.AFrameworkApplication.accessTokenTtl)?(Hc.ULS.sendTraceTag(507863243,202,15,"CreateNewActor: session is expired"),this.tvc(),32):this.J7j(Mc)};this.bea=bc;
this.HCb=vc;this.pTa=new ac.a(()=>new zc.a(Xc.value,Object(bd.a)(this,this.hSb,"getMoreInfoEventReceived")));this.Bph=ad;this.cFa=Id;this.Tsh=ue;this.eGb=this.TZc;this.Qgc=!!v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("GateTemplateRenderingByGetMoreInfoResponse");this.eoh=!!v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("PremiumTemplateEnabled");this.Fnh=3===this.Ty.gJ&&!!v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("CreateNewButtonGrayOutForExpiredSessionEnabled");
this.Hgc=3===this.Ty.gJ&&!!v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("NewKpiForCreateNewActor");this.hfc=db.a.getInstance(ed)}get pO(){switch(this.Ty.gJ){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}ho(){var bc,vc;const Xc=this.Ty.gNa;Xc.Uh(y.a.qfe,kb.a.frame,this.qfe);Xc.Uh(y.a.newDocument,kb.a.frame,Object(bd.a)(this,this.newDocument,"newDocument"));Xc.Uh(y.a.Stb,kb.a.frame,this.Stb);if(null===(bc=v.AFrameworkApplication.fa)||
void 0===bc?0:bc.ka("FileMenuTemplateErrorFixIsEnabled"))null===(vc=Ba.AFrameworkApplication_ActionManager.yh)||void 0===vc?void 0:vc.I5i(y.a.Stb);Xc.Uh(y.a.Ivg,kb.a.frame,this.w7j);Xc.Uh(y.a.Nua,kb.a.frame,this.Nua)}newDocument(bc,vc,Xc,ad,Id){var ue;if(1===Xc)return(null===(ue=v.AFrameworkApplication.fa)||void 0===ue?0:ue.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileMenuRedesignIsEnabled",!1))&&!this.RYd()?2:32;if(2===Xc&&Id){this.Hgc&&this.hfc.Dba({Gw:"CreateNewDocument_FileMenuExec",
Ypb:gb.b.FailureBased});if(v.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&Id.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.yh.gl(y.a.e9j,2);if(Id.MenuItemId&&Id.SourceControlId)return"NewDocumentHome"===Id.SourceControlId&&Db.a("NewDocumentFromHomeTab"),this.cib(Id.MenuItemId,Id.SourceControlId)}return 8}sQi(){switch(this.Ty.gJ){case 3:return"https://www.office.com/template/Word";case 1:return"https://www.office.com/template/Excel";
case 2:return"https://www.office.com/template/PowerPoint"}return null}iNd(){switch(this.Ty.gJ){case 3:return Object(Nb.a)("BlankDocumentLabel");case 1:return Object(Nb.a)("BlankWorkbookLabel");case 2:return Object(Nb.a)("BlankPresentationLabel")}return""}TQi(){switch(this.Ty.gJ){case 3:return"DocumentAddColorFluent_20";case 1:return"TableAddColorFluent_20";case 2:return"SlideAddColorFluent_20"}return""}cib(bc,vc){var Xc=this.XNc.Kzd;if(null===Xc)return this.AZb("RelativePathIsNull",!0),8;var ad=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),
Id=v.AFrameworkApplication.pV;"blank"===bc&&this.joj()&&(Hc.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.pO),bc="blankNew");if(Id&&ad){Hc.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const ue={};ue[bb.a.T_g]=bc;ue[bb.a.pO]=this.pO;ue[bb.a.lcid]=v.AFrameworkApplication.lcid.toString();ue[bb.a.reason]=pb.a.createNew;ue[bb.a.uiCulture]=v.AFrameworkApplication.uiCulture;ue[bb.a.dataCulture]=
v.AFrameworkApplication.dataCulture;v.AFrameworkApplication.UF().execute(Vd=>{Vd.sendMessage(La.a.cib,ue)})}else ad=(new Date).getTime(),vc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Xc,W.a.Al(this.lN),W.a.Al(bc),W.a.Al(this.pO),W.a.Al(v.AFrameworkApplication.lcid.toString()),W.a.Al(ad.toString()),W.a.Al(vc),W.a.Al(v.AFrameworkApplication.rU),v.AFrameworkApplication.Jo),(Xc=v.AFrameworkApplication.fa.Ya("ScenarioId"))&&
""!==Xc&&(vc+="&wdscenarioid="+W.a.Al(Xc)),vc+="&"+v.AFrameworkApplication.tCc(),Xc=this.hw?this.hw.oZ:null,this.I1&&this.I1.AAb&&(Xc=this.I1.PersonalFileStorageUrl),Xc?vc+="&DestinationUrl="+W.a.Al(Xc):3===this.Ty.gJ&&this.Ty.supportsGetMoreInfoForPersonalStorage&&(this.AZb("GetMoreInfoOrPersonalFileStorageUrlIsEmpty",!0),Hc.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty")),"SharePoint"===this.lN?Kb.a.DA("6f63j813;9a66f561"):"OneDriveWopi"===
this.lN&&Kb.a.DA("b8jd0489;3228j491"),(ad=lb.a.j1||lb.a.g1||lb.a.nKc)&&Hc.ULS.sendTraceTag(507569058,202,15,"CreateNewDocument: Opening window via form POST is blocked, isMobileBrowser: {0}, isElectron: {1}, isWebview2: {2}",lb.a.j1,lb.a.g1,lb.a.nKc),Xc=v.AFrameworkApplication.rj.rda,Id=!!Xc,("SharePoint"===this.lN?v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1):"OneDriveWopi"===this.lN&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",
!1))&&Id?ad?this.Ty.Mrb.ov(vc,2,null,{"X-UseGraphFileUploader":"1","X-DoNotRedirect":"1"},!1,2,this.WJj,this.VJj,null):(ad={ugfu:"1"},ad.wacAadToken=Xc,vb.a.l3b("_blank",vc,ad)):vb.a.Cm(vc,"_blank",void 0,"CreateNewDocument");2!==this.Ty.gJ&&3!==this.Ty.gJ||Hc.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:fa.a[this.Ty.gJ],["Template"]:bc});v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&
1===this.Ty.gJ&&("blank"===bc||"blankNew"===bc?Db.b("ConsumerTemplateNewBlank"):Db.b("ConsumerTemplateNew",null,0,!0,0,[{name:"TemplateId",string:bc}]));this.i9f(!0);return 32}joj(){let bc=!1;switch(this.Ty.gJ){case 3:bc=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:bc=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:bc=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",
!1)}return bc}TTc(){this.pO||Hc.ULS.sendTraceTag(507565456,202,10,"CreateNewDocument app ID not available");const bc="https://office.live.com/start/"+(this.pO?this.pO.replace("WAC",".aspx"):"")+"?ec=1&auth=0&originalauth="+("SharePoint"===this.lN?"2":"1")+"&wdPreviousSession="+v.AFrameworkApplication.userSessionId;vb.a.Cm(bc,"_blank",void 0,"CreateNewDocumentErrorRedirect")}cCj(bc){let vc=Number.MAX_VALUE,Xc=Number.MIN_VALUE;const ad=window.performance;if(ad&&"undefined"!==typeof ad.getEntriesByName){for(let ue=
0;ue<bc.length;ue++){var Id=ad.getEntriesByName(bc[ue]);Id&&0<Id.length&&(Id=Id[0],vc=Math.min(parseInt(String(Id.fetchStart)),vc),Xc=Math.max(parseInt(String(Id.responseEnd)),Xc))}Xc>vc&&Hc.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Xc-vc,["MinFetchStart"]:vc,["MaxResponseEnd"]:Xc})}}d6h(){const bc=Object.assign(new wb.a,{Title:"",Id:"FileMenuNewSection",DisplayMode:"Menu",ShowMenuSectionSeparator:!0,ControlList:[]});bc.ControlList.push(Object.assign(new mc.a,
{ExternalId:"btnBlankDocument",Command:y.a.newDocument.toString(),CommandValueId:y.a.newDocument.toString(),LabelText:this.iNd(),Alt:this.iNd(),AriaDescription:this.iNd(),ExternalImageId:this.TQi(),MenuItemId:"blank"}));bc.ControlList.push(Object.assign(new mc.a,{ExternalId:"btnBrowseTemplates",Command:y.a.Nua.toString(),CommandValueId:y.a.Nua.toString(),LabelText:Object(Nb.a)("BrowseTemplatesLabel"),Alt:Object(Nb.a)("BrowseTemplatesLabel"),AriaDescription:Object(Nb.a)("BrowseTemplatesLabel"),ExternalImageId:"TemplateBrowseColorFluent_20"}));
return bc}J7j(bc){bc&&(this.Ddc?bc.PopulationXML=this.Ddc:(this.Ty.supportsGetMoreInfoForPersonalStorage&&!this.hw&&this.Leg.TR("Opened New menu",!0),bc.PopulationXML=this.vDi(this.FYi())));return 32}RYd(){return!this.Ty.supportsGetMoreInfoForPersonalStorage||!!this.hw&&3===this.hw.state&&!!this.hw.fCa&&!!this.hw.oZ||this.I1&&this.I1.AAb&&!!this.I1.PersonalFileStorageUrl}SYd(){return v.AFrameworkApplication.ra&&v.AFrameworkApplication.ra.$g.oba&&!this.Qgc?!0:this.RYd()}FYi(){if(!this.TZc&&!this.Qgc&&
!this.SYd())return null;if(this.eGb&&!this.$jc){let vc=!1;var bc="9";const Xc=v.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in Xc&&(bc=Xc.NumberOfTemplatesInBackstage);let ad=this.pO;"TemplateCollectionId"in Xc&&(ad=Xc.TemplateCollectionId);this.eoh&&"PowerPointWAC"===ad&&(vc=!0);bc=String.format(this.Ty.H1+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",W.a.Al(v.AFrameworkApplication.lcid.toString()),W.a.Al(ad),bc);Boolean.parse(Xc.AppendOriginQueryParam||"false")&&
(bc+="&org=backstage");Boolean.parse(Xc.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in Xc&&(bc+="&templateTier="+Xc.TemplateTier);bc=vc?bc+"&p=1":bc+"&p=0";bc+="&"+v.AFrameworkApplication.tCc();this.Ty.Mrb.ov(bc,1,null,null,!1,2,Id=>{this.Ty.apa("CreateNewActor.GetTemplateListJson",Id.data);this.GYk(Id.data.responseData)},Id=>{this.Ty.apa("CreateNewActor.GetTemplateListJson",Id.data);this.FYk()},null,void 0,void 0,void 0,void 0,"5");this.eGb=!1}return this.CGb}GYk(bc){this.CGb=
bc;this.eGb=!1;this.s4b();this.Qgc?this.SYd()?this.zCd():this.hw&&(Hc.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.AZb("GetMoreInfoReceivedButInfoIsMissing",!1),this.tvc()):this.zCd()}zCd(){if(v.AFrameworkApplication.ra&&v.AFrameworkApplication.ra.$g.oba&&Ib.c()){const bc=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),vc=v.AFrameworkApplication.pV;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.CGb,
!0,bc&&vc));this.i9f(!1);3===this.Ty.gJ&&Hc.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}FYk(){this.$jc=this.eGb=!0;this.s4b();this.AZb("TemplateServiceFailed",!1);this.tvc();Ub.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}tvc(){v.AFrameworkApplication.ra&&v.AFrameworkApplication.ra.$g.oba&&Ib.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.Ty.gJ&&Hc.ULS.sendTraceTag(508867408,
202,15,"DispatchFailureTemplateListJson"))}i9f(bc){this.Hgc&&this.hfc.FMa({Gw:bc?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender"})}AZb(bc,vc){this.Hgc&&this.hfc.Zoa({Gw:vc?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender",errorName:bc})}TYi(bc){var vc=0;for(var Xc=0;Xc<bc.length;Xc++)if("ST"===bc[Xc].ImageType){vc=Xc;break}const ad=bc.length?bc[vc]:null;bc=ad?ad.Url||"":"";var Id;let ue=Xc=vc=!1;if(ad&&(Id=ad.AspectRatio))Id=parseFloat(Id),1>Id?vc=!0:1.5<Id?Xc=
!0:1===Id&&(ue=!0);else switch(Hc.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:bc}),this.Ty.gJ){case 3:vc=!0;break;case 2:Xc=!0;break;case 5:ue=!0}return{returnValue:bc,N9i:vc?"95by123":Xc?"123by69":ue?"100by100":"123by95"}}vDi(bc){let vc;const Xc=this.XNc.DWa||"1056925771",ad=(()=>{let Id=this.uPh(bc,this.XNc,Xc);({vZc:vc}=Id);return Id})().returnValue;if(vc){this.Ddc=ad;const Id=(new Date).getTime()-this.qSe;Hc.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:Id})}return ad}hSb(bc,vc){Hc.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.hw||3!==bc.state?2===bc.state&&(Hc.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.Bkd=!0,this.s4b()):(this.hw=bc,vc||this.s4b(),v.AFrameworkApplication.ra&&v.AFrameworkApplication.ra.$g.oba&&Ib.c()&&Ib.d("setFileMenuHostInformation")&&(bc=Object.assign(new xc,{hostUrl:this.hw.oZ,hostName:this.hw.fCa,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,
folderName:v.AFrameworkApplication.breadcrumbFolderName}),this.I1&&this.I1.AAb&&(bc.hostUrl=this.I1.PersonalFileStorageUrl),Hc.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(bc)),this.Qgc&&this.CGb&&this.CGb.length&&(this.SYd()?this.zCd():(this.AZb("PersonalFileStorageInfoIsMissing",!1),this.tvc()),Hc.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}uPh(bc,vc,Xc){let ad;ad=!1;const Id=
this.RYd();let ue="";this.Ty.supportsGetMoreInfoForPersonalStorage&&(this.Bkd?(ue=Aa.dbf(vc),this.Bkd=!1,Hc.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.hw?Id?ue=Aa.xPh(vc,this.hw):this.hw.afj?(ad=!0,this.eGb=!1,ue=Aa.vPh(vc,this.hw),Hc.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(ad=!0,ue=Aa.dbf(vc),Hc.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.hw.oZ,["StorageServiceDisplayNameIsSet"]:!!this.hw.fCa})):(ue=Aa.wPh(vc.yo),Hc.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Id&&(ue+=Aa.tPh(vc,Xc,!ue)+(()=>{let Vd=this.sQh(bc,Xc);({vZc:ad}=Vd);return Vd})().returnValue);return{returnValue:Aa.Vki(ue),vZc:ad}}sQh(bc,vc){let Xc;Xc=!1;if(!this.TZc)return Xc=!0,Hc.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",vZc:Xc};let ad=
"",Id="",ue="MenuTemplate";if(this.$jc)ad=Aa.nbf(),this.$jc=!1,Hc.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(bc){try{const Vd=Sys.Serialization.JavaScriptSerializer.deserialize(bc,!0);ad=this.rQh(Vd,vc);Hc.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.Meg&&"OneDrive"===this.lN&&(Id=Aa.rPh(this.aKj,v.AFrameworkApplication.Meg))}catch(Vd){Hc.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
{["JsonToConvert"]:bc}),ad=Aa.nbf()}Xc=!0}else ue="MenuLoading",ad=Aa.tQh(),Hc.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:Aa.uQh(ue,ad)+Id,vZc:Xc}}rQh(bc,vc){let Xc="";const ad=[];for(let ue=0;ue<bc.length;ue++){var Id=bc[ue];let Vd="";if(Id){const Kd=Id.Title,Yd=Id.AssetId;Id=Id.Thumbnails;Yd&&Kd&&Id&&({N9i:Id,returnValue:Vd}=this.TYi(Id),Xc+=Aa.RJb("jbtnNewTemplate"+ue,Kd,null,Id,null,Vd,vc,Yd))}ad[ue]=Vd}bc=new zb.a(4,1,5E3,()=>{this.cCj(ad)},
106);this.Ty.UNc.jm(bc);return Xc}s4b(){this.$dd=!0;this.Ty.Eeg.VA(this.XNc.oQb);this.$dd=!1}get Ty(){return this.bea.value}get XNc(){return this.HCb.value}get Leg(){return this.pTa.value}get aKj(){return this.Bph.value}get lN(){return this.I1&&this.I1.AAb?this.I1.NewDocumentDestinationHost:this.cFa.value}get TZc(){return this.Tsh.value}}Object(w.a)(jd,"CreateNewActor",null,[]);var Xd=a(1459);class Td extends Xd.a{constructor(){super()}o3e(){this.b4(0,Object(Nb.a)("OpenMenuEmptyMruMessage"));this.b4(1,
Object(Nb.a)("OpenMenuServerErrorMessage"));this.b4(2,Object(Nb.a)("Open"));this.b4(3,Object(Nb.a)("OpenMenuRecentDocuments"));this.b4(4,Object(Nb.a)("OpenMenuMoreOnHost"));this.b4(5,Object(Nb.a)("VoicedLoadingText"))}static get instance(){return Td.Va||(Td.Va=new Td)}static v2j(bc){return Td.instance.ia(bc)}}Td.Va=null;Object(w.a)(Td,"MruActorIntlHelper",Xd.a,[]);var gc;(function(bc){bc[bc.success=0]="success";bc[bc.failure=1]="failure";bc[bc.spinner=2]="spinner";bc[bc.none=3]="none"})(gc||(gc={}));
Object(w.b)("DisplayState",gc);var nc=a(1391);class dc{constructor(bc,vc,Xc,ad,Id,ue,Vd,Kd){this.R8c=null;this.Dmd=!0;this.Cdc="";this.Guh=0;this.lcb=null;this.Ted=3;this.Mhc=new Map;this.Rdd=null;this.v$g="SaveAsWordDocx_32";this.I8j="SaveAsPowerPointPptx_32";this.Esi="SaveAsExcelXlsx_32";this.Jdl="LayerDiagonalColorFluent_20";this.zal="DesktopArrowUpColorFluent_20";this.Ddg="MruNoDataSection";this.RHj="MruSection";this.gF="SourceControlId";this.menuItemId="MenuItemId";this.Bdg="Mru";this.c2j=(Yd,
Bc,Mc,Fd,Md)=>{if(1==Mc)return 32;if(!Md[this.gF]||!this.Mhc.has(Md[this.gF]))return Hc.ULS.sendTraceTag(507605730,324,15,"Unable to get the url for the document"),2;Md[this.menuItemId]=this.Mhc.get(Md[this.gF])[1];Md[this.gF]="";return this.RC.gNa.ek(y.a.VNa,Mc,Md,Fd)};this.nSc=(Yd,Bc,Mc,Fd,Md)=>{if(!this.ZWb)return 2;if(1===Mc)return 32;Md.MenuItems=Object.assign(new ra.a,{Id:"MruList",MenuSectionList:[],UpdateDynamically:!0});return this.E7j(Md,nc.a.instance.LSe)};this.oSc=(Yd,Bc,Mc,Fd,Md)=>1!==
Mc&&Md?this.F7j(Md):32;this.Ga=Kd;this.bea=bc;this.JG=vc;this.qlh=Xc;this.qih=ad;this.pih=Id;this.pTa=new ac.a(()=>new zc.a(ue.value,null));this.emh=new ac.a(()=>new zc.a(Vd.value,Object(bd.a)(this,this.QHj,"mruEventResultReceived")));this.Ga.ka("WacInTabOpenMRUIsEnabledForUiHost");this.Ga.ka("UiHostSupportsDocRebootFeatures")}QHj(bc,vc){this.lcb=bc;vc||this.kCg()}Oik(){const bc=this.RC.gNa;bc.dl(y.a.oSc,kb.a.frame,this.oSc,96);bc.Uh(y.a.UNa,kb.a.frame,this.c2j);bc.Uh(y.a.nSc,kb.a.frame,this.nSc)}E7j(bc,
vc){(vc=this.G7h(vc))?(Hc.ULS.sendTraceTag(507605729,324,50,"Mru flyout data loaded successfully in file menu"),bc.MenuItems.MenuSectionList.push(vc)):this.u7j(bc);vc=this.Z$h();bc.MenuItems.MenuSectionList.push(vc);return 32}G7h(bc){if(bc){var vc=this.ozd(this.RHj,!0);bc=JSON.parse(bc);this.Mhc.clear();bc.forEach((Xc,ad)=>{this.Mhc.set(this.Bdg+ad.toString(),[Xc.FileName,Xc.DocumentUrl]);const Id=this.BQi(Xc.FileName);vc.ControlList.push(Object.assign(new mc.a,{ExternalId:this.Bdg+ad.toString(),
Command:y.a.UNa.toString(),CommandValueId:y.a.UNa.toString(),LabelText:Id,Alt:Xc.FileName,AriaDescription:Xc.FileName,ExternalImageId:this.PNi(this.RC.gJ),KeyTip:Xc.FileName}))});return vc}}Z$h(){const bc=this.ozd("ViewAllFilesAndUploadSection",!1);if(!this.mcd){let Xc=this.Eaf;var vc=this.Daf;Xc&&vc||!this.RC.supportsGetMoreInfoForPersonalStorage||(vc=this.iSb.TR("File Open",!1),3===vc.state&&(Xc=vc.oZ));this.mcd=Xc}this.mcd&&bc.ControlList.push(Object.assign(new mc.a,{ExternalId:"btnViewMoreFiles",
Command:y.a.openUrlInNewTab.toString(),CommandValueId:y.a.openUrlInNewTab.toString(),LabelText:Object(Nb.a)("ViewMoreFilesLabel"),Alt:Object(Nb.a)("ViewMoreFilesLabel"),AriaDescription:Object(Nb.a)("ViewMoreFilesLabel"),ExternalImageId:this.Jdl,MenuItemId:this.mcd}));bc.ControlList.push(Object.assign(new mc.a,{ExternalId:"btnUploadDocument",Command:y.a.hbc.toString(),CommandValueId:y.a.hbc.toString(),LabelText:Object(Nb.a)("UploadFilesLabel"),Alt:Object(Nb.a)("UploadFilesLabel"),AriaDescription:Object(Nb.a)("UploadFilesLabel"),
ExternalImageId:this.zal}));return bc}ozd(bc,vc){vc=void 0===vc?!1:vc;return Object.assign(new wb.a,{Title:vc?Object(Nb.a)("MruTitle"):"",Id:bc,DisplayMode:"Menu",ShowMenuSectionSeparator:!0,ControlsId:"Ctrl_"+bc,ControlList:[]})}u7j(bc){Hc.ULS.sendTraceTag(507605728,324,50,"Mru data could not load in file menu flyout");bc.MenuItems.MenuSectionList.push(this.H7h())}H7h(){const bc=this.ozd(this.Ddg,!1);bc.ControlList.push(Object.assign(new mc.a,{ExternalId:this.Ddg,LabelText:Object(Nb.a)("MruNoDataLabel")}));
return bc}BQi(bc){return bc&&bc.length<=dc.NSe?bc:bc.substring(0,dc.NSe-3)+"..."}PNi(bc){let vc=this.v$g;switch(bc){case 3:vc=this.v$g;break;case 2:vc=this.I8j;break;case 1:vc=this.Esi}return vc}F7j(bc){this.Mli();this.Lli();bc.PopulationXML=Aa.Wki(this.Cdc+this.R8c);return 32}Mli(){let bc=3,vc=!1;if(this.Cdc&&this.Guh===this.lcb.t_k)Hc.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),bc=this.Ted;else{Hc.ULS.sendTraceTag(5849628,
202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var Xc=this.RC.SF();this.lcb=this.PHj.TR("File Open opened",!0);if(this.Cdc&&2!==this.Ted&&3!==this.lcb.state)vc=!0;else{const ad=this.oWi(this.lcb);v.AFrameworkApplication.ra&&v.AFrameworkApplication.ra.$g.oba&&Ib.c()&&ad&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(ad,!0));this.Cdc=(()=>{let Id=this.wDi(this.lcb);({RJj:bc}=Id);return Id})().returnValue}Xc=this.RC.SF()-Xc;Hc.ULS.sendTraceTag(5849629,
202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Xc})}2!==bc&&(Xc={["DisplayState"]:gc[bc]},1!==bc&&(Xc.IsStale=vc),Hc.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Xc));this.Ted=bc}oWi(bc){let vc;try{vc=yc.c(bc.v6d)}catch(Xc){vc=null,Hc.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Xc)}return vc}Lli(){this.Dmd?(Hc.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),
this.R8c=(()=>{let bc=this.BDj();({xel:this.Dmd}=bc);return bc})().returnValue):Hc.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");Hc.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.Dmd,["NotDisplayingLink"]:!this.R8c})}wDi(bc){let vc;1===bc.state||0===bc.state?(Hc.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),bc=2,vc=Aa.bbf(this.wxa(2),this.wxa(5))):3===bc.state&&bc.v6d?(vc=
this.sPh(bc.v6d),bc=0):(Hc.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),vc=Aa.YJb(this.wxa(1),this.wxa(2)),bc=1);return{returnValue:vc,RJj:bc}}sPh(bc){let vc;const Xc=this.v_b.DWa||"2155708348";if(bc.length){vc=Aa.XJb("lblRecentDocuments",this.wxa(3));let ad=0;for(let Id=0;Id<bc.length;Id++){const ue=bc[Id];"FileName"in ue&&"DocumentUrl"in ue&&"Path"in ue&&(vc+=Aa.RJb("MruButton"+Id,ue.FileName.toString(),ue.Path.toString(),null,this.v_b.c6,this.v_b.lUb,
Xc,ue.DocumentUrl.toString()),ue.IsPinned&&ad++)}vc=Aa.Qua("RecentDocumentsMenuSection",Aa.Cdg,this.wxa(2),vc);Hc.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:bc.length,["NumPinnedDocuments"]:ad})}else vc=Aa.YJb(this.wxa(0),this.wxa(2)),Hc.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return vc}BDj(){let bc;bc=!0;let vc=this.Eaf;var Xc=this.Daf;if(vc&&Xc||!this.RC.supportsGetMoreInfoForPersonalStorage)bc=
!1;else{const ad=this.iSb.TR("File Open",!1);3===ad.state&&(vc=ad.oZ,Xc=ad.fCa,bc=!1)}Xc=Xc?String.format(this.wxa(4),Xc):null;return{returnValue:Aa.vOh(this.v_b.DWa,Xc,vc),xel:bc}}kCg(){this.RC.Eeg.VA(this.v_b.oQb)}get RC(){return this.bea.value}get wxa(){return this.JG.value}get v_b(){return this.qlh.value}get Eaf(){return this.qih.value}get Daf(){return this.pih.value}get iSb(){return this.pTa.value}get PHj(){return this.emh.value}get ZWb(){this.Rdd||(this.Rdd=this.Ga?this.Ga.ka("IsO365CommercialHost")||
this.Ga.ka("IsO365ConsumerHost"):!1);return this.Rdd}}dc.NSe=35;Object(w.a)(dc,"MruRenderer",null,[]);class Gc{constructor(bc,vc,Xc,ad,Id,ue,Vd){this.hw=null;this.vXe=!1;this.nEa=this.hIe=0;this.hSb=Kd=>{if(!this.hw&&3===Kd.state)this.hw=Kd;else if(2===Kd.state){this.vXe?Hc.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.iSb.TR("NewDocumentFromStream",!0),this.vXe=!0);return}this.Clf()};this.UJj=Kd=>{if(Kd&&Kd.data&&Kd.data.responseData){let Bc=yc.d(Kd.data.responseData);
({zz:Yd}=Bc);if(Bc.returnValue)if(Kd=Yd,Kd.StatusCode!==Ec.a.HL&&Kd.StatusCode!==Ec.a.bYa)Hc.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.pO,this.nEa,Kd.StatusCode),this.Ecb(null);else if(Kd.NewDocumentUrl&&""!==Kd.NewDocumentUrl){var Yd=(new Date).getTime()-this.hIe;Hc.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.pO,this.nEa,Yd);this.Iph(Kd.NewDocumentUrl)}else Hc.ULS.sendTraceTag(24904476,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.pO,this.nEa),this.Ecb(null);else Hc.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.pO,this.nEa,{["ResponseData"]:xb.a.Z9a(Kd.data.responseData)}),this.Ecb(null)}else Hc.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.pO,this.nEa),this.Ecb(null)};this.TJj=Kd=>{Kd&&Kd.data&&Hc.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.pO,this.nEa,Kd.data.status);this.Ecb(null)};this.Iph=bc;this.Ecb=vc;this.Ohc=Xc;this.HCb=ad;this.cFa=Id;this.bea=ue;this.pTa=new ac.a(()=>new zc.a(Vd.value,this.hSb))}cib(){!this.hw&&this.c7d.supportsGetMoreInfoForPersonalStorage?this.iSb.TR("NewDocumentFromStream",!0):this.Clf()}Clf(){this.hIe=(new Date).getTime();
var bc=this.kvi.Kzd;if(null===bc)this.Ecb(null);else{var vc=this.Ohc.menuItemId,Xc=this.Ohc.gF,ad=this.Ohc.cWk,Id=this.Ohc.pvi;this.nEa="streamBase64"===ad?Id.length/1024:0;Hc.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.pO,this.nEa);var ue=(new Date).getTime();bc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",bc,W.a.Al(this.lN),W.a.Al(vc),W.a.Al(this.pO),W.a.Al(v.AFrameworkApplication.lcid.toString()),W.a.Al(ue.toString()),
W.a.Al(Xc),W.a.Al(v.AFrameworkApplication.rU),v.AFrameworkApplication.Jo,W.a.Al(ad));bc+="&"+v.AFrameworkApplication.tCc();(vc=this.hw?this.hw.oZ:null)&&(bc+="&DestinationUrl="+W.a.Al(vc));"SharePoint"===this.lN?Kb.a.DA("6f63j813;9a66f561"):"OneDriveWopi"===this.lN&&Kb.a.DA("b8jd0489;3228j491");vc={"Content-Type":"application/json; charset=utf-8"};if("SharePoint"===this.lN?v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1):"OneDriveWopi"===
this.lN&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",!1))vc["X-UseGraphFileUploader"]="1";this.c7d.Mrb.ov(bc,2,Id,vc,!0,2,this.UJj,this.TJj,null,void 0,void 0,void 0,void 0,"31")}}get pO(){switch(this.c7d.gJ){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get kvi(){return this.HCb.value}get lN(){return this.cFa.value}get c7d(){return this.bea.value}get iSb(){return this.pTa.value}}
Object(w.a)(Gc,"NewDocumentFromStreamOperation",null,[]);class vd{constructor(bc,vc,Xc,ad){this.HCb=bc;this.cFa=vc;this.bea=Xc;this.dmh=ad}create(bc,vc,Xc){return new Gc(bc,vc,Xc,this.HCb,this.cFa,this.bea,this.dmh)}}Object(w.a)(vd,"NewDocumentFromStreamOperationFactory",null,[549]);var zd=a(605);class Yb{get name(){return"Common.App.NewAndOpen.UX"}$n(bc){bc.register(vd,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").yi().Ei(()=>
new vd(new ac.a(()=>v.AFrameworkApplication.ra.$g.FLd()),new ac.a(()=>v.AFrameworkApplication.lN),new ac.a(()=>Pa.a.instance.Ho("Common.INewAndOpenCommonHelpers")),new ac.a(()=>Object(hb.b)())))}init(){v.AFrameworkApplication.fa.Yx(()=>{this.FUb()})}FUb(){const bc=zd.a.gw(Pa.a.instance.fj("Common.INewAndOpenCommonHelpers")),vc=zd.a.gw(Object(hb.a)());v.AFrameworkApplication.lN&&C.Task.WAA.call(null,bc,vc).continueWith(()=>{const Xc=new jd(new ac.a(()=>bc.result),new ac.a(()=>v.AFrameworkApplication.ra.$g.FLd()),
new ac.a(()=>vc.result),new ac.a(()=>v.AFrameworkApplication.ra.$g.GLd().DWa||"1959943459"),new ac.a(()=>v.AFrameworkApplication.lN),new ac.a(()=>v.AFrameworkApplication.koj));Xc.ho();Xc.s4b()});if(v.AFrameworkApplication.bBg){const Xc=zd.a.gw(Object(Ja.a)());C.Task.WAA.call(null,bc,vc,Xc).continueWith(()=>{const ad=new dc(new ac.a(()=>bc.result),new ac.a(()=>Td.v2j),new ac.a(()=>v.AFrameworkApplication.ra.$g.GLd()),new ac.a(()=>v.AFrameworkApplication.u2j),new ac.a(()=>v.AFrameworkApplication.t2j),
new ac.a(()=>vc.result),new ac.a(()=>Xc.result),v.AFrameworkApplication.fa);ad.Oik();ad.kCg()})}}dispose(){}}Object(w.a)(Yb,"UXPackageManager",null,[11,12,4]);Object(E.b)(B.ee,{Fk:"transient"})(bc=>Lo(function*(){yield E.a.resolve(B.de,bc);return new Yb}));let Pb=class{constructor(bc,vc){this.Qn=vc;this.$=bc}executeCommand(bc,vc,Xc){bc=2;switch(vc.command){case y.a.openUrlInNewTab:bc=this.Qn.ek(y.a.openUrlInNewTab,2,Xc);break;case y.a.VNa:bc=this.Qn.ek(y.a.VNa,2,Xc);break;case y.a.UNa:bc=this.Qn.ek(y.a.UNa,
2,Xc)}return 2!==bc?C.Task.Ua(!0):k.a(vc.command)}Gi(bc,vc){bc=!1;switch(vc.command){case y.a.openUrlInNewTab:case y.a.VNa:bc=!0;break;case y.a.UNa:bc=K.a.B6()}return bc}dj(bc,vc,Xc){return"PopulateMruMenu"===vc?(this.Qn.ek(K.a.B6()?y.a.nSc:y.a.oSc,2,Xc),!0):!1}Ri(){return!1}};Pb=Object(t.__decorate)([Object(E.d)(B.qe),Object(t.__param)(0,Object(B.Nb)()),Object(t.__param)(1,Object(B.f)()),Object(t.__param)(2,Object(B.cb)()),Object(t.__param)(3,Object(B.ee)())],Pb);Object(w.a)(Pb,"OpenFromMruCommandHandler",
null,[34]);var $c=a(153),wd=a(427),Bd=a(118),tc=a(23),Zc=a(431);class Ab{constructor(bc,vc){this.sheetName=null;this.value=!1;this.sheetName=bc;this.value=vc}getSheetName(){return this.sheetName}CK(){return this.value}}Object(w.a)(Ab,"MacroRecorderSheetOptionToggledPayload",null,[60]);const rb=(bc,vc,Xc,ad,Id,ue,Vd,Kd)=>{Kd=bc.$a(9,void 0===Kd?null:Kd);Kd.sheetName=vc;Kd.show=Xc;return Ua.h(bc,"ShowGridlines",Kd,ad,Id,ue,Vd,0)},Fb=(bc,vc,Xc,ad,Id,ue,Vd,Kd)=>{Kd=bc.$a(9,void 0===Kd?null:Kd);Kd.sheetName=
vc;Kd.show=Xc;return Ua.h(bc,"ShowHeadings",Kd,ad,Id,ue,Vd,0)},jc=(bc,vc,Xc,ad,Id,ue,Vd,Kd)=>{Kd=bc.$a(9,void 0===Kd?null:Kd);Kd.sheetName=vc;Kd.directionRtl=Xc;return Ua.h(bc,"ChangeSheetDirection",Kd,ad,Id,ue,Vd,0)};var Oc;let cd=Oc=class{constructor(bc){this.$=bc}Ri(){return!1}executeCommand(bc,vc){const Xc={};this.$.dr(Xc);bc=vc.command;const ad=Object($c.a)(Bd.a,this.$.sa.getItemByName(Xc.SheetName));if(!ad)return k.a(bc);let Id,ue,Vd,Kd,Yd;switch(bc){case 705559150:case -1411193626:Id=16;ue=
!ad.hideGridLines;Vd=rb;Yd=183;Kd=ad.hideGridLines;break;case -2052321504:case 515737500:Id=4;ue=!ad.headersVisible;Vd=Fb;Yd=184;Kd=!ad.headersVisible;break;case -1478455630:Id=2;ue=!ad.displayRtl;Vd=jc;Yd=185;Kd=!ad.displayRtl;tc.f(this.$).za.Q6k(ue);break;default:return k.a(bc)}ad.KKb(Id,ue);const Bc=()=>new Ab(Xc.SheetName,Kd),Mc=this.$.pa.ta;return wd.a(this.$.userOperationManager,(Fd,Md,oe)=>Vd(Mc,Xc.SheetName,Kd,ba.c(Fd,ye=>{Oc.W1b(ye,ad,Id,ue)}),ba.b(Md,()=>{Oc.d1b(ad,Id,ue)}),oe,null),Fd=>
new L.a(Yd,0,Fd,void 0,Bc),vc)}Gi(bc,vc){bc=!1;switch(vc.command){case -1411193626:case 515737500:case -1478455630:bc=!0;break;case 705559150:case -2052321504:bc=Zc.a(this.$)}return bc}dj(){return!1}static W1b(bc,vc,Xc,ad){I.a.Lx(bc.Errors)&&vc.KKb(Xc,!ad)}static d1b(bc,vc,Xc){bc.KKb(vc,!Xc)}};cd=Oc=Object(t.__decorate)([Object(E.d)(B.Vf),Object(t.__param)(0,Object(B.Nb)())],cd);Object(w.a)(cd,"SheetOptionsToggleCommandHandler",null,[34]);var Ed=a(1461),Sd=a(16),$d=a(905),be=a(906),Fe=a(283),Pe=a(305);
class hc{constructor(bc){this.$=bc;this.Ccf="SheetViewEntryCallout";this.tGc=!1;this.Nia=vc=>{tc.f(this.$).focus();this.tGc=!vc;vc&&this.$of()};this.FLj=document.createElement("div");this.py=document.getElementById(this.$.xi+oa.a.MId);Pe.a(this.$).Tq(this);this.Iua()}dispose(){var bc;this.$=null;null===(bc=Pe.a(this.$))||void 0===bc?void 0:bc.VH(this)}fQk(){var bc;!this.$.sa||(null===(bc=this.$.sa.ma)||void 0===bc?0:bc.dk.cN)?this.$.ea.nGa(this.showCallout):this.$.sa.rpd(this.showCallout);this.$.ea.cIb(this.ONb)}Iua(){this.showCallout=
this.showCallout.bind(this);this.Xib=this.Xib.bind(this);this.ONb=this.ONb.bind(this)}showCallout(){var bc;this.ONb();null!==(bc=this.$.sa.ma)&&void 0!==bc&&bc.dk.cN?(this.zVg(!0),this.tGc=!0,this.$.ea.cIb(this.Xib),this.$.sa.pn(this.Xib)):Hc.ULS.sendTraceTag(508048723,$d.a.e4a,be.a.warning,"SheetViewEntryCallout.showCallout: skipped as current sheet is not in temporary sheet view mode.")}Xib(){this.tGc&&(this.zVg(!1),this.tGc=!1);this.$of()}ONb(bc,vc){var Xc;vc&&Hc.ULS.sendTraceTag(507839433,$d.a.e4a,
be.a.warning,"SheetViewEntryCallout.detachShowCalloutListeners: detaching without showing callout.");this.$.ea.dVc(this.ONb);null===(Xc=this.$.sa)||void 0===Xc?void 0:Xc.bje(this.showCallout);this.$.ea.TAa(this.showCallout)}$of(){this.$.ea.dVc(this.Xib);this.$.sa.Gn(this.Xib)}zVg(bc){appChrome.showOrHideSheetViewEntryCallout(this.FLj,{showCallout:bc,calloutId:this.Ccf,anchor:this.py,restoreFocus:this.Nia})}get hj(){return document.getElementById(this.Ccf)}get Zo(){return Sd.DOMElementExtensions.isVisible(this.hj)}get hl(){return Fe.a.tSg}Vp(bc,
vc){if(vc)return!1;bc=this.hj.querySelectorAll(Sd.DOMElementExtensions.RI);let Xc;for(vc=0;vc<bc.length;vc++){const ad=bc[vc];Sd.DOMElementExtensions.Zo(ad)&&(Xc=ad)}if(!Xc)return Hc.ULS.sendTraceTag(508117186,$d.a.e4a,be.a.error,"SheetViewEntryCallout.SetFocusOnSection: Could not find focusable element in SheetViewEntryCallout"),!1;Xc.focus();return!0}tq(bc){return Sd.DOMElementExtensions.eo(this.hj,bc)}Qs(){}nu(){}}Object(w.a)(hc,"SheetViewEntryCallout",null,[47,4]);let Lb=class{constructor(bc){this.$=
bc;this.ydb=!1;this.lre=null;this.qVb=fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",!1);this.XXd=fb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableSortFilterNSVEntryInSelfCoauthor",!1);this.ZPc=(vc,Xc)=>{var ad;vc=null===(ad=Xc.Ul)||void 0===ad?void 0:ad.operation;0===Xc.tx&&vc&&vc.operationName===this.u1d&&(this.XYb=vc,this.$.userOperationManager.uu(this.ZPc))};this.lre=new hc(this.$);this.ZPc=this.ZPc.bind(this)}dispose(){this.lre=
this.$=this.u1d=this.XYb=this.iLc=null}Ri(){return!1}Gi(bc,vc){switch(vc.command){case -1062729243:return!0;default:return!1}}executeCommand(bc,vc){bc=vc.command;switch(bc){case -1062729243:return this.applyLastSortFilterInDefaultView(vc.jk)}return k.a(bc)}dj(){return!1}iKd(){return{isVisible:this.eXf(),isChecked:this.ydb}}j0k(){this.ydb=!this.ydb;Hc.ULS.sendTraceTag(508180431,0,50,`SortFilterManager::toggleShouldApplySortFilterForEveryone: Apply for everyone value updated to ${this.ydb}`)}fOa(bc,
vc,Xc,ad,Id){Hc.ULS.sendTraceTag(508180430,0,50,`SortFilterManager::performAction: Performing sort filter action. Caller: ${Xc}`);this.zwk(bc,ad,Id);return this.tKk?(bc(),C.Task.Ua(!0)):this.Hmi(bc,vc)}get tKk(){if(this.eXf())return this.ydb;const bc=this.$.sa.ma;return!fb.EwaSettings.isChangeGateEnabled("OfficeVSO:8421225_NamedSheetViewUpdateDisableCommandsBasedOnRealTimeView")||!this.$.ea.Ih.allowViewCollab||null!==bc&&void 0!==bc&&bc.dk.jx?!0:!1}eXf(){const bc=this.$.sa.ma;return this.qVb&&this.$.ea.Pba&&
!(null===bc||void 0===bc?0:bc.dk.jx)&&(this.XXd?this.$.ea.xVd()||!this.$.ea.K_&&this.$.ea.$3f():this.$.ea.IU)&&!Object(la.e)(this.$)&&!this.$.ea.Ih.allowViewCollab}Hmi(bc,vc){const Xc={[oa.a.G6d]:!1},ad=fb.EwaSettings.isChangeGateEnabled("OfficeVSO:8336194_FUseNewNsvCreateCommand")?2052531625:-2050946363;vc=this.$.Ma.qh(new Ya.a(ad,Ia.a.rh,2,vc,null),Xc);vc.continueWith(Id=>{!Sa.a(Id)&&Id.result&&(bc(),(fb.EwaSettings.isChangeGateEnabled("OfficeVSO:8421225_NamedSheetViewUpdateDisableCommandsBasedOnRealTimeView")?
!this.$.ea.Ih.allowViewCollab:1)?this.lre.fQk():Hc.ULS.sendTraceTag(508044257,0,50,"SortFilterManager::enterNamedSheetViewAndPerformAction: showNamedSheetViewEntryCallout skipped in view collab mode."))});return vc}applyLastSortFilterInDefaultView(bc){this.ydb=!0;var vc=C.Task.Ua(!0);const Xc=this.$.sa.ma;(null===Xc||void 0===Xc?0:Xc.dk.jx)?(vc={[oa.a.Ydg]:!0},vc=this.$.Ma.qh(new Ya.a(1690118309,Ia.a.rh,2,bc,null),vc),vc.continueWith(ad=>{ad.isCompleted&&this.oBg()})):this.oBg();return vc}zwk(bc,
vc,Xc){this.u1d=this.XYb=this.iLc=null;this.iLc=vc?vc:Xc?this.wUi(Xc):bc}wUi(bc){this.u1d=bc;this.$.userOperationManager.mw(this.ZPc);return()=>{this.XYb?this.$.userOperationManager.enqueueOperation(this.XYb,this.XYb.Nh):Hc.ULS.sendTraceTag(507901280,0,10,"SortFilterManager::getReapplyActionFromOperationName: lastSortFilterOperation is null.")}}oBg(){this.iLc?this.iLc():Hc.ULS.sendTraceTag(507901279,0,10,"SortFilterManager::reapplyLastSortFilterAction: lastSortFilterReapplyAction is null.")}};Lb=
Object(t.__decorate)([Object(E.d)(B.ng),Object(t.__param)(0,Object(B.Nb)())],Lb);Object(w.a)(Lb,"SortFilterManager",null,[530,34,4]);let kc=class{constructor(bc){this.Qn=bc}executeCommand(bc,vc,Xc){return 2!==this.Qn.ek(y.a.tryOfficeThroughTellMe,2,Xc)?C.Task.Ua(!0):k.a(vc.command)}Gi(bc,vc){return 215809929===vc.command}dj(){return!1}Ri(){return!1}};kc=Object(t.__decorate)([Object(E.d)(B.Hg),Object(t.__param)(0,Object(B.f)())],kc);Object(w.a)(kc,"TryOfficeThroughTellMeCommandHandler",null,[34]);
var dd=a(282),yb=a(592),Ta=a(9),Hb=a(914),uc=a(77);class Sc extends Hb.a{constructor(bc){super(bc)}Kt(){const bc=uc.GetServiceTaskFactory.create(this.$.la,203,this.ya,this.xh);M.TaskExtensions.Xa(M.TaskExtensions.Vo([bc],this.ya),()=>{this.Qr([new ea(this.$)])},this.ya,3)}static Ba(bc){bc.ea.Vn.get(61)&&Hb.a.qy(215,new Sc(bc))}}Object(w.a)(Sc,"MsFormCommandHandlerFactory",Hb.a,[]);Type.registerNamespace("Common.App.NewAndOpen.UX");dd.a.instance.Do(new Yb);yb.a.Bw(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");
(()=>{Ta.a.gh(bc=>{B.Ud.Aa()||Sc.Ba(bc)})})();String(c);String(b);String(h);String(r);String(f);String(l);String(m);String(Ed);String(x);String(n);window.___1710758652270_closurehack=c;window.___1710758652270_closurehack=b;window.___1710758652270_closurehack=h;window.___1710758652270_closurehack=r;window.___1710758652270_closurehack=f;window.___1710758652270_closurehack=l;window.___1710758652270_closurehack=m;window.___1710758652270_closurehack=Ed;window.___1710758652270_closurehack=x;window.___1710758652270_closurehack=
n}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kmhv.js.map/d100a10eac096f61a2cfdbd68d43b582/EwaTS.kmhv.js.map