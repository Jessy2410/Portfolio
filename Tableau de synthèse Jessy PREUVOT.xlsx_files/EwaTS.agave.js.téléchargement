'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1027:function(A,u,a){a.d(u,"a",function(){return b});A=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(A.a)(c,"AddInDataTransferObject",null,[]);class b{constructor(h,r,f){this.Tcc=h;this.Sgh=r;this.Tgh=f}get jC(){return this.Tcc}get xyh(){return this.Sgh}get yyh(){return this.Tgh}static KQb(h){return(h=h.m7)?Object.assign(new c,{tabs:h.jC.toArray(),id:h.xyh,title:h.yyh}):null}}Object(A.a)(b,
"OneLineRibbonExtensibility",null,[])},1046:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);var c;(function(b){b[b.OK=0]="OK";b[b.Btl=1]="notReady";b[b.ivl=2]="storeDisabled";b[b.gnl=3]="invokeFailure";b[b.Qul=4]="serviceDisabled";b[b.pll=5]="builtinAddinDetails"})(c||(c={}));Object(A.b)("AddinDetailsQueryError",c)},1048:function(A,u,a){a.d(u,"a",function(){return c});a.d(u,"b",function(){return b});const c=h=>{let r=null;switch(h){case 0:r="omex";break;case 1:r="spcatalog";break;case 2:r=
"spapp";break;case 3:r="filesystem";break;case 4:r="exchange";break;case 6:r="registry";break;case 7:r="inmemory";break;case 8:r="uploadfiledevcatalog";break;case 9:r="hardcodedpreinstall";break;case 10:r="excatalog";break;case 16:r="wopicatalog"}return r},b=h=>{let r=-1;switch(h.toLowerCase()){case "omex":r=0;break;case "spcatalog":r=1;break;case "spapp":r=2;break;case "filesystem":r=3;break;case "exchange":r=4;break;case "registry":r=6;break;case "inmemory":r=7;break;case "uploadfiledevcatalog":r=
8;break;case "hardcodedpreinstall":r=9;break;case "excatalog":r=10;break;case "wopicatalog":r=16}return r}},1049:function(A,u,a){a.d(u,"a",function(){return h});var c=a(6),b=a(60);const h=(r,f)=>b.a.z2d(66,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,c.AFrameworkApplication.fa.Lj("MaxRetriesForLoadingScript",0),r,f)},1110:function(A,u,a){u=a(483);a=a(1451);a=a.Qw?a.default:a;"string"===typeof a&&(a=[[A.i,a,""]]);u(a,{insert:"head",eD:!1});A.exports=a.EH||{}},1113:function(A,u,a){a.d(u,
"a",function(){return c});A=a(0);var c;(function(b){b[b.UIj=0]="myAddins";b[b.hGh=1]="adminManaged";b[b.hul=2]="popular"})(c||(c={}));Object(A.b)("AddinCollectionType",c)},1114:function(A,u,a){a.d(u,"a",function(){return b});A=a(0);var c=a(12);class b{constructor(){this.Pxf={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.Mxf={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ia(1633),c.a.instance.ia(1637)],
["tabformulas"]:["Ribbon.Formulas",c.a.instance.ia(1634),c.a.instance.ia(1638)],["tabdeveloper"]:["Ribbon.Developer",c.a.instance.ia(1635),c.a.instance.ia(1639)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ia(1636),c.a.instance.ia(1640)]};this.zxc=null}get sva(){return"SourceControlId"}get rY(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}YPi(){if(!this.zxc){this.zxc={};for(const h of Object.keys(this.Pxf))this.zxc[h]=this.Pxf[h];for(const h of Object.keys(this.Mxf))this.zxc[h]=this.Mxf[h][0]}}}
Object(A.a)(b,"AddinCommandsStringProvider",null,[369])},1116:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{constructor(){this.J0a=0;this.Sua=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.rEc=!1;this.MTf=this.Tva=null}}Object(A.a)(c,"AddInCommandsNotificationParameters",null,[])},1118:function(A,u,a){a.d(u,"a",function(){return c});const c=b=>b.la.kh(34)},1162:function(A,u,a){a.d(u,"a",function(){return Q});A=a(0);var c=a(42),b=a(15),h=a(142),r=a(169),
f=a(17),l=a(482),m=a(22);class x extends Sys.UI.Control{constructor(H,ba,U,D){super(document.createElement("div"));this.f3=this.d3=this.sF=this.ESa=this.SQ=this.EDa=this.hFa=null;this.cDb=this.sEa=!1;this.content=this.ly=null;this.tda=0;this.E$e=null;this.q4=0;this.Kqg=null;this.LX=()=>{this.dismiss();return!0};this.BZe=H;this.AUe=ba;this.s_=U;this.mK=D;this.fn=ba.ownerDocument;this.TDc=this.GC=this.xDb=!1}get p7(){this.hFa||(this.hFa=this.fn.createElement("div"),this.hFa.id=this.ip("WACCalloutOuter"),
this.hFa.className="WACCalloutOuter",this.hFa.setAttribute(l.a.ik,l.a.cWa),this.hFa.style.width=this.tda+"px");return this.hFa}get BJb(){if(!this.EDa){this.EDa=this.fn.createElement("div");this.EDa.id=this.ip("WACCalloutBeakContainer");this.EDa.className="WACCalloutBeakContainer";var H="CalloutBeakTopFilled_32x16x32";if(5===this.q4||6===this.q4||4===this.q4)H="CalloutBeakBottomFilled_32x16x32";H=r.a(32,16,H,"WACCalloutBeak",!0,"");this.EDa.appendChild(H)}return this.EDa}set BJb(H){this.EDa=H}get E1a(){return this.xDb}get title(){return this.ly}set title(H){this.ly!==
H&&(this.ly=H,this.d3&&(this.d3.innerText=this.ly))}get GC(){return this.sEa}set GC(H){this.sEa!==H&&(this.sEa=H,this.SQ&&(this.SQ.contains(this.sF)&&!this.sEa?this.SQ.removeChild(this.sF):!this.SQ.contains(this.sF)&&this.sEa&&this.Z1e()))}get TDc(){return this.cDb}set TDc(H){this.cDb!==H&&(this.cDb=H,this.SQ&&(this.SQ.contains(this.d3)&&!this.cDb?this.SQ.removeChild(this.d3):!this.SQ.contains(this.d3)&&this.cDb&&this.t3e()))}show(){this.xDb||(this.P5h(),this.Fu(),this.AUe.appendChild(this.p7),this.p7.style.display=
"Block",this.ZGk(),this.xDb=!0,this.Kqg&&this.Kqg())}dismiss(){this.xDb&&(this.Ifa(),this.AUe.removeChild(this.p7),this.xDb=!1,this.mK&&this.mK())}dispose(){this.dismiss();this.d3=this.sF=this.ESa=this.EDa=this.SQ=this.hFa=null;Sys.Component.prototype.dispose.call(this)}ip(H){return this.get_element().id+H}P5h(){this.SQ=this.fn.createElement("div");this.SQ.id=this.ip("WACCalloutHeader");this.SQ.className="WACCalloutHeader";this.GC&&this.Z1e();this.TDc&&this.t3e();this.ESa=this.fn.createElement("div");
this.ESa.id=this.ip("WACCalloutContent");this.ESa.className="WACCalloutContent";this.ESa.style.width=190<this.tda?this.tda-26+"px":"164px";this.ESa.appendChild(this.content);this.p7.appendChild(this.BJb);this.p7.appendChild(this.SQ);this.p7.appendChild(this.ESa)}Z1e(){this.sF=this.fn.createElement("a");this.sF.className="WACCalloutCloseAnchor";this.sF.id=this.ip("WACCalloutCloseAnchor");this.sF.href="#";this.SQ.appendChild(this.sF);const H=r.a(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,Object(m.a)("DialogClose"));this.sF.appendChild(H)}t3e(){this.d3=this.fn.createElement("div");this.d3.className="WACCalloutTitle UIFontBold";this.d3.style.width=190<this.tda?this.tda-30+"px":"160px";this.d3.id=this.ip("WACCalloutTitle");this.d3.innerText=this.title;this.SQ.contains(this.sF)?this.SQ.insertBefore(this.d3,this.sF):this.SQ.appendChild(this.d3)}ZGk(){var H=this.BZe;let ba;if(1===this.q4){var U=this.E$e.y+16;ba=-16}else 2===this.q4||3===this.q4||0===this.q4?(U=H.y+H.height+15,ba=-15):
(U=H.y-this.p7.clientHeight-15-2,ba=this.p7.clientHeight-1);this.p7.style.top=U+"px";this.BJb.style.top=ba+"px";1===this.q4?(H=this.E$e.x-16,this.p7.style.left="50%",this.p7.style.marginLeft=-this.tda/2+"px",U=Sys.UI.DomElement.getBounds(this.p7),this.BJb.style.left=H-U.x+"px"):(U=H.x+this.BZe.width/2,2===this.q4||5===this.q4?(H=20,U-=36):0===this.q4||4===this.q4?(H=this.tda/2-16,U-=this.tda/2):(H=this.tda-20-32,U=U-this.tda+36),this.p7.style.left=U+"px",this.BJb.style.left=H+"px")}Fu(){this.GC&&
!this.f3&&(this.f3=this.LX,this.s_.xa(f.a.click,this.sF,this.f3,null))}Ifa(){this.GC&&this.f3&&(this.s_.Qa(f.a.click,this.sF,this.f3),this.f3=null)}}Object(A.a)(x,"Callout",Sys.UI.Control,[364]);class n extends x{constructor(H,ba,U,D,I,X){super(H,U,I.H8,void 0===X?null:X);this.DSe=0;this.vj=()=>{this.dismiss();return!0};this.tda=this.fQi(D);this.Rdb=ba;this.Mm=I;this.r_k=7;this.Ft=this.Rdb.ownerDocument.createElement("div");this.Ft.className="ModalCalloutControlOverlay";this.Ft.tabIndex=0;this.Rdb.insertBefore(this.Ft,
this.Rdb.firstChild)}show(){this.E1a||(this.Mm.ASc(),this.Mm.S_(!1),this.Ft.style.zIndex=String(this.Mm.vea),super.show(),this.Hp(),this.DSe=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.r_k))}dismiss(){this.E1a&&(this.Mm.WX(!1),this.to(),this.Rdb&&this.Rdb.contains(this.Ft)&&this.Rdb.removeChild(this.Ft),super.dismiss(),window.clearTimeout(this.DSe))}Hp(){this.Mm.pGa(Object(h.a)(this,this.dismiss,"dismiss"));this.Mm.CJ.xa(f.a.click,this.Ft,this.vj)}to(){this.Mm.pvb(Object(h.a)(this,
this.dismiss,"dismiss"));this.Mm.CJ.Qa(f.a.click,this.Ft,this.vj)}fQi(H){let ba=0;switch(H){case 0:ba=190;break;case 1:ba=250;break;case 2:ba=300;break;case 3:ba=360}return ba}}Object(A.a)(n,"ModalCallout",x,[]);var t=a(533),w=a(182);class v extends n{constructor(H,ba,U,D,I,X){super(H,ba,U,D,I,void 0===X?null:X);this.Qhc=null}show(){if(!this.E1a){const H=Object.assign(new t.a,{onShow:()=>{n.prototype.show.call(this)}});w.a.zK().then(ba=>{const U=ba.externalNotification();this.Qhc=ba.addNotification(U,
H);return null},ba=>{b.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",ba);return null})}}dismiss(){this.E1a&&this.Qhc&&(w.a.zK().then(H=>{H.removeNotification(this.Qhc);return this.Qhc=null},H=>{b.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),super.dismiss())}}Object(A.a)(v,"ReactManagedModalCallout",n,[]);var k=a(6);class y{static C7h(H,ba,U){var D=void 0===D?null:D;return k.AFrameworkApplication.ra.$g.GY?new v(H,ba,U,3,
k.AFrameworkApplication.ra,D):new n(H,ba,U,3,k.AFrameworkApplication.ra,D)}}Object(A.a)(y,"ModalCalloutControlFactory",null,[]);var C=a(84),B=a(1111),E=a(676),K=a(1112),F=a(188),W=a(68),J=a(59),L=a(1027),M=a(910);class Q{static get Cfb(){return Q.g9||(Q.g9=c.a.instance.Ho("Common.Utils.IAriaNotifier"))}static gkf(H,ba,U,D){Q.XT&&Q.XT.E1a&&Q.XT.dismiss();Q.XT=y.C7h(ba,H,H);Q.XT.content=U;M.b(D)||(Q.XT.title=D,Q.XT.TDc=!0);H=new Sys.UI.Bounds(0,0,W.a.OSb(),W.a.NSb());Q.XT.q4=Q.AGi(H,ba,Q.XT.tda);Q.XT.show();
Q.Cfb&&Q.Cfb.vBa(U.innerText,!0)}static Zyd(H,ba,U,D){D=void 0===D?null:D;w.a.zK().then(I=>{let X=null;Q.xFb&&(I.removeNotification(Q.xFb),Q.xFb=null);const Y=I.callout(Object.assign(new B.a,{target:H,title:ba,content:U,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new K.a,{onDismiss:()=>{I.removeNotification(X)},directionalHint:null!=D?D:null})})),ja=Object.assign(new t.a,{expirationOptions:Object.assign(new E.a,{displayTimeoutSeconds:7,onExpire:()=>
{I.removeNotification(Q.xFb)}})});X=Q.xFb=I.addNotification(Y,ja);return null},I=>{b.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null})}static Lse(H,ba){ba=void 0===ba?null:ba;Q.XT&&Q.XT.E1a&&Q.XT.dismiss();const U=new F.a;U.qQa=!1;U.Ph=0;U.tL(C.a.Bvj,Object(m.a)("DialogError"),M.b(H)?Q.$Ff():H,ba)}static Mse(H){Q.XT&&Q.XT.E1a&&Q.XT.dismiss();b.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",H.errorCode));const ba=
M.b(H.description)?Q.$Ff():H.description,U=new F.a;let D=null;H.Sua?(U.Ph=1,U.ti(1,H.buttonText),U.dja(1)):U.Ph=0;D=I=>{1===I?H.Sua():H.Tva&&H.Tva()};U.qQa=!1;0===H.J0a?U.tL(H.errorCode,H.title?H.title:Object(m.a)("DialogError"),ba,D):1===H.J0a?U.pW(H.title?H.title:Object(m.a)("DialogWarning"),ba,D):U.WBa(H.title?H.title:Object(m.a)("DialogInfo"),ba,D)}static AGi(H,ba,U){let D=4;const I=H.x+H.width-ba.x-ba.width;ba.x-H.x+ba.width/2<=U/2?D=5:I+ba.width/2<=U/2&&(D=6);return D}static wOk(H,ba,U,D){D=
void 0===D?!1:D;(ba=L.a.KQb(ba))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ba,I=>{I&&(D||Q.Zyd(I,U,H,5))})}static xOk(H,ba,U){U=void 0===U?!1:U;Q.wOk(ba.startedNode?ba.startedNode.description:String.format(Object(m.a)("NewAddInLoadedContent"),H),ba,ba.startedNode?ba.startedNode.title:String.format(Object(m.a)("NewAddInLoadedTitle"),H),U)}static vOk(H,ba,U,D){if(Q.W7g)H=String.format(Object(m.a)("ErrorLoadingAddInsContentOuterString"),
String.format(Object(m.a)("ErrorLoadingAddInsContentInnerString"),U,D,Object(m.a)("InsertionDialogRefresh"))),Q.Zyd(ba,Object(m.a)("ErrorLoadingAddInsTitle"),H,1);else{ba=J.a.Tv(ba);var I=Object(m.a)("ErrorLoadingAddInsContentOuterString").split("{0}"),X=document.createElement("span");X.innerText=I[0];var Y=document.createElement("span");Y.innerText=String.format(Object(m.a)("ErrorLoadingAddInsContentInnerString"),U,D,Object(m.a)("InsertionDialogRefresh"));Y.className="UIFontBold";U=document.createElement("span");
U.innerText=I[1];D=document.createElement("div");Sys.UI.DomElement.addCssClass(D,"ModalCalloutControl");D.appendChild(X);D.appendChild(Y);D.appendChild(U);Q.gkf(H,ba,D,Object(m.a)("ErrorLoadingAddInsTitle"))}}static cQk(H,ba,U,D){Q.W7g?Q.Zyd(ba,U,D):(ba=J.a.Tv(ba),Q.gkf(H,ba,Q.xQh(D),U))}static xQh(H){const ba=document.createElement("div");Sys.UI.DomElement.addCssClass(ba,"ModalCalloutControl");ba.innerText=H;return ba}static $Ff(){return Object(m.a)("InternalError")+" "+Object(m.a)("InternalError_Directive")}static get W7g(){return k.AFrameworkApplication.ra.$g.Oq&&
k.AFrameworkApplication.ra.$g.GY}}Q.XT=null;Q.xFb=null;Q.g9=null;Object(A.a)(Q,"AddInCommandsNotificationFactory",null,[])},1164:function(A,u,a){a.r(u);a.d(u,"DynamicRibbon",function(){return k});A=a(0);var c=a(15),b=a(181),h=a(126),r=a(928),f=a(949);class l{constructor(){this.dataFields=this.samplingPolicy=this.name=null}}Object(A.a)(l,"TelemetryEvent",null,[]);class m{constructor(y,C,B,E){this.kv=!1;this._id=y;this.IG=C;this.Hda=B;this.Kj=E}get enabled(){return this.kv}set enabled(y){const {DynamicRibbon:C}=
a(1164);var B=this.Kj.OwnerAddinStoreType?this.Kj.OwnerAddinStoreType:this.Kj.PrimaryMarketplace.MarketplaceType;const E=this.Kj.PrimaryMarketplace.MarketplaceRef,K=this.Kj.AssetMarketplace?this.Kj.AssetMarketplace.SolutionId:null,F=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.IG,B,null,null,null,E);B={["addinSolutionId"]:F,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Kj.OwnerAddinSolutionId,B,K,null,null,E),["ownerAddinStoreType"]:B,["ribbonControlType"]:"Button",
["toggle"]:y};b.a.sendTelemetryEvent(Object.assign(new l,{name:C.u1c+"ControlUpdate",dataFields:h.a.Rm(B)}));this.kv=y;this.Hda.aV(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.IG,["PrivacyCompliantSolutionId"]:F,["SourceControlId"]:this.id,["MethodData"]:this.kv})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(y){switch(y){case 3:return this.enabled;case 2:return this.id;
case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokePropertyGetAsync(y){y=this.invokePropertyGet(y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}invokePropertySet(y,C){switch(y){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(C,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokePropertySetAsync(y,C){this.invokePropertySet(y,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(y,
C){switch(y){case 5:return this.yDk(C);case 1:return this.WRa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokeMethodAsync(y,C){y=this.invokeMethod(y,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}yDk(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"boolean");this.setEnabled(y);return null}WRa(){this._OnAccess();return null}}Object(A.a)(m,"RibbonButton",null,[]);class x{constructor(y,C,B,E){this._id=y;this.IG=C;this.Hda=B;
this.Kj=E}get id(){return this._id}setVisibility(y){const {DynamicRibbon:C}=a(1164),B=this.Kj.OwnerAddinStoreType?this.Kj.OwnerAddinStoreType:this.Kj.PrimaryMarketplace.MarketplaceType;var E=this.Kj.PrimaryMarketplace.MarketplaceRef;const K=this.Kj.AssetMarketplace?this.Kj.AssetMarketplace.SolutionId:null,F=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.IG,B,K,null,null,E);E={["addinSolutionId"]:F,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Kj.OwnerAddinSolutionId,
B,K,null,null,E),["ownerAddinStoreType"]:B,["ribbonControlType"]:"Tab",["toggle"]:y};b.a.sendTelemetryEvent(Object.assign(new l,{name:C.u1c+"ControlUpdate",dataFields:h.a.Rm(E)}));this.Hda.aV(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.IG,["PrivacyCompliantSolutionId"]:F,["StoreType"]:B,["SourceControlId"]:this.id,["MethodData"]:y})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(y){switch(y){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);
}invokePropertyGetAsync(y){y=this.invokePropertyGet(y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}invokePropertySet(y){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokePropertySetAsync(y,C){this.invokePropertySet(y,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(y,C){switch(y){case 3:return this.IHk(C);case 1:return this.WRa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokeMethodAsync(y,
C){y=this.invokeMethod(y,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}IHk(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"boolean");this.setVisibility(y);return null}WRa(){this._OnAccess();return null}}Object(A.a)(x,"RibbonTab",null,[]);var n=a(1261),t=a(177),w=a(1575),v;(function(y){y[y.static=0]="static";y[y.dynamic=1]="dynamic"})(v||(v={}));Object(A.b)("RibbonExtensionGenerateType",v);class k{constructor(y,C,B,E,K){this.IG=y;this.Dx=B;this.Hda=E;this.Kj=
K;this.FBb=this.Dx.Cl;this.nI=this.FBb.getOsfControl(C);this.oph=this.nI.getManifest()}get buttons(){return null}executeRequestCreate(y){try{var C=this.Kj.OwnerAddinStoreType?this.Kj.OwnerAddinStoreType:this.Kj.PrimaryMarketplace.MarketplaceType;const E=this.Kj.PrimaryMarketplace.MarketplaceRef,K=this.Kj.AssetMarketplace?this.Kj.AssetMarketplace.SolutionId:null;var B=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.IG,C,K,null,null,E);const F={["addinSolutionId"]:B,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Kj.OwnerAddinSolutionId,
C,K,null,null,E),["ownerAddinStoreType"]:this.Kj.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};b.a.sendTelemetryEvent(Object.assign(new l,{name:k.u1c+"ExecuteRequestCreate",dataFields:h.a.Rm(F)}));const W=t.a.Sp(y);y={};C={};C[r.a.NYa]=this.nI;C[r.a.OYa]=W;C[r.a.nDd]=this.Kj;y[r.a.COb]=3;y[r.a.Qfa]=this.IG;y[r.a.hwc]=B;y[r.a.Pfa]=C;this.Hda.aV(-1014260128,y);let J=k.Bzc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,J)}catch(E){B=k.Bzc("ExecuteRequestCreate",!1,E.toString()),
c.ULS.sendTraceTag(538572825,0,50,B)}return null}executeRequestUpdate(y){try{var C=this.Kj.OwnerAddinStoreType?this.Kj.OwnerAddinStoreType:this.Kj.PrimaryMarketplace.MarketplaceType;const E=this.Kj.PrimaryMarketplace.MarketplaceRef,K=this.Kj.AssetMarketplace?this.Kj.AssetMarketplace.SolutionId:null;var B=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.IG,C,K,null,null,E);const F={["addinSolutionId"]:B,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Kj.OwnerAddinSolutionId,
C,K,null,null,E),["ownerAddinStoreType"]:this.Kj.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};b.a.sendTelemetryEvent(Object.assign(new l,{name:k.u1c+"ExecuteRequestUpdate",dataFields:h.a.Rm(F)}));const W=t.a.Sp(y);y={};C={};C[r.a.NYa]=this.nI;C[r.a.OYa]=W;C[r.a.nDd]=this.Kj;y[r.a.COb]=3;y[r.a.Qfa]=this.IG;y[r.a.hwc]=B;y[r.a.Pfa]=C;this.Hda.aV(-1014260128,y);let J=k.Bzc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,J)}catch(E){B=k.Bzc("ExecuteRequestUpdate",!1,E.toString()),
c.ULS.sendTraceTag(538572823,0,50,B)}return null}getButton(y){let C=null;if(!this.OYf())return this.jkf();if(y&&0<y.length){if(!this.$ef(y))return this.Bkf(y);C=new m(y,this.IG,this.Hda,this.Kj)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(C)}getTab(y){let C=null;if(!this.OYf())return this.jkf();if(this.nI.getOwnerAddinControlRecreated())return this.N6h();if(y&&0<y.length){if(!this.$ef(y))return this.Bkf(y);C=new x(y,this.IG,this.Hda,this.Kj)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(C)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(y){switch(y){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);
}invokePropertyGetAsync(y){y=this.invokePropertyGet(y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}invokePropertySet(y){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokePropertySetAsync(y,C){this.invokePropertySet(y,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(y){switch(y){case 1:return this.WRa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(y);}invokeMethodAsync(y,C){switch(y){case 7:return this.kti(C);
case 6:return this.lti(C);case 3:return this.cGi(C);case 5:return this.fYi(C)}y=this.invokeMethod(y,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}kti(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"string");return this.executeRequestCreate(y)}lti(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"string");return this.executeRequestUpdate(y)}cGi(y){y=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"string");return this.getButton(y)}fYi(y){y=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"string");return this.getTab(y)}WRa(){this._OnAccess();return null}Bkf(y){return n.a(f.a.b2h,t.a.ia(1771)+y)}jkf(){return n.a(f.a.quk,t.a.ia(1767))}N6h(){return n.a(f.a.hostRestartNeeded,t.a.ia(1772))}OYf(){var y=this.nI.getSharedRuntimeId();y=!!y&&0<y.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",y));return y}$ef(y){const C=this.oph.getRibbonExtensionControlMap();return y in
C||this.aWh(y)}aWh(y){var C=this.Pwi();if(C){C=C.Yrf;for(const B of C.tabs){if(B.id===y)return!0;for(const E of B.groups)for(const K of E.controls){if(K.id===y)return!0;if("Menu"===K.type){C=K;for(const F of C.items)if(F.id===y)return!0}}}}return!1}Pwi(){return w.a.getInstance().ywa(this.Kj.PrimaryMarketplace.MarketplaceType,this.Kj.PrimaryMarketplace.SolutionId,v.dynamic)}static Bzc(y,C,B){const E={};E.methodName="DynamicRibbon."+y;E.result=C?"Succeeded":"Failed";E.message=B;return t.a.Ci(E)}}k.u1c=
"Office.Online.Extensibility.Ribbon.";Object(A.a)(k,"DynamicRibbon",null,[])},1251:function(A,u,a){a.d(u,"a",function(){return c});const c=(b,h)=>{let r=!1;b&&(b=h.osfControl,(h=b.getManifest())&&h.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(r=!0));return r}},1257:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Aua=this.TQa=this.tMd=this.LSb=this.AKa=this.zwe=null}}Object(A.a)(c,"AppsForOfficeOauthResult",
null,[])},1258:function(A,u,a){a.r(u);a.d(u,"WebExtensionView",function(){return E});A=a(0);var c=a(94),b=a(153);u=a(376);var h=a(29),r=a(19),f=a(274),l=a(55),m=a(287),x=a(1118),n=a(461),t=a(73),w=a(63),v=a(16),k=a(69),y=a(95),C=a(5),B=a(1110);a.n(B);Object(y.b)(C.Ug,{Fk:"singleton"})(K=>Lo(function*(){const F=yield y.a.resolve(C.Nb,K);return new E(F,new n.FloatingObjectBlockManager(F,F.ea,F.pa.$G,3,0),F.Bl.appendChild(F.Bl.ownerDocument.createElement("div")))}));class E extends u.a{constructor(K,
F,W){super(W,K);this.DKa=this.hashCode=null;this.usc=!1;this.qx=(J,L)=>{L.mj.hash===this.hashCode&&this.DKa&&(C.xb.Aa()?y.a.nh(C.xb):Object(b.a)(a(940).DdaFacade,this.$.la.kh(35))).APk(this.DKa.InstanceId)};this.onBlockCacheItemChanged=(J,L)=>{switch(L.mj.block.state){case 1:case 3:case 5:this.GBa(L)}};this.vp=()=>{this.qTc(!0)};this.onActiveItemChanging=(J,L)=>{this.isVisible&&this.l$a(L.LB);this.clearCache()};this.onActiveItemChanged=(J,L)=>{this.iYg(L.ma,!!L.LB)};this.mJ=()=>{this.$.ea.TNa()};
this.S$a=F;this.domElement.classList.add(h.yb);this.domElement.classList.add(r.a.oH);W.tabIndex=0;this.iYg(this.$.ma,!1);this.oj.Ba("mousedown",this.mJ);this.oj.Ba("contextmenu",J=>{k.g(J)});this.$.sa.tX(this.onActiveItemChanging);this.$.$h.tX(this.onActiveItemChanging);this.$.$h.pn(this.onActiveItemChanged);this.$.sa.pn(this.onActiveItemChanged);this.za.nz(this.onBlockCacheItemChanged);this.za.lU(this.qx);this.za.ny(this.vp);this.dA(this.ksb)}get za(){return this.S$a}dispose(){this.$&&(this.$.sa.g2(this.onActiveItemChanging),
this.$.$h.g2(this.onActiveItemChanging),this.$.$h.Gn(this.onActiveItemChanged),this.$.sa.Gn(this.onActiveItemChanged));this.S$a&&(this.S$a.Zy(this.onBlockCacheItemChanged),this.S$a.UV(this.qx),this.S$a.ux(this.vp));this.$E(this.ksb);this.clearCache();c.a.dh(this.S$a);this.S$a=null;v.DOMElementExtensions.an(this.domElement);super.dispose()}FOg(K){v.DOMElementExtensions.an(v.DOMElementExtensions.getElementById(this.domElement,K.id));this.domElement.appendChild(K)}QUb(){if(this.DKa&&!this.usc){var K=
(C.xb.Aa()?y.a.nh(C.xb):Object(b.a)(a(940).DdaFacade,m.a(this.$))).gs(this.DKa.InstanceId);K&&(K.resize(this.DKa.Width,this.DKa.Height),K.Ba(this.domElement),K.showHide(!0),this.usc=!0)}}iYb(){return!0}GBa(K){this.DKa=K.mj.block.Pj;this.usc=!1;this.QUb()}l$a(K){this.$.ea.n6&&K&&(K.WA||(K.WA=new f.a),K.WA.xn=new l.a(this.domElement.scrollLeft,this.domElement.scrollTop),K.WA.f3b=20)}clearCache(){this.za.fvb(this.hashCode,"ClearCacheWebExtensionView");this.DKa=this.hashCode=null;this.usc=!1}iYg(K,F){if(this.isVisible=
!!K&&t.n(K))this.hashCode=this.za.hGa(K,w.a.pBd,this.hashCode,!1),this.dZc(F)}static sJb(K){if(!x.a(K)){const F=K.Bl;K.la.Hh(34,new E(K,new n.FloatingObjectBlockManager(K,K.ea,K.pa.$G,3,0),F.appendChild(F.ownerDocument.createElement("div"))))}}}Object(A.a)(E,"WebExtensionView",u.a,[253,3,4]);String(B);window.___1710758601219_closurehack=B},1261:function(A,u,a){a.d(u,"a",function(){return c});const c=(b,h)=>OfficeExtension.WacRuntime.Utility.createPromise((r,f)=>{f(OfficeExtension.WacRuntime.Utility.createRichApiException(b,
h))})},1376:function(A,u,a){a.r(u);a.d(u,"CustomFunctionsInstaller",function(){return Ya});A=a(0);var c=a(2),b=a(15),h=a(6),r=a(183),f=a(210),l=a(153),m=a(216),x=a(64),n=a(39),t=a(256),w=a(124),v=a(622);class k{constructor(da){da=da.split("|");this.IG=da[1];this.Nkd=da[2];this.uve=da[3]}get solutionId(){return this.IG}get solutionVersion(){return this.Nkd}get needToRestoreManifest(){return this.uve===OSF.StoreTypeEnum.Registry.toString()}}Object(A.a)(k,"AddinStoreInfo",null,[]);class y{}Object(A.a)(y,
"CustomFunctionRegistrationInfos",null,[]);var C=a(224),B=a(76);const E=(da,Ea,oa)=>K(da,Ea,C.a.none,B.a.current,oa),K=(da,Ea,oa,za,la)=>{oa=da.continueWith(()=>{Ea(da)},3,oa,za);oa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,la)},4);return oa},F=(da,Ea,oa)=>W(da,Ea,C.a.none,B.a.current,oa),W=(da,Ea,oa,za,la)=>{oa=da.lB(()=>Ea(da),3,oa,za);oa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,la)},4);return n.TaskExtensions.d3c(oa)},J=(da,Ea,oa)=>L(da,Ea,C.a.none,B.a.current,oa),L=(da,Ea,
oa,za,la)=>{oa=da.lB(()=>Ea(da),3,oa,za);oa.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,la)},4);return oa},M=(da,Ea,oa)=>Q(da,Ea,C.a.none,B.a.current,oa),Q=(da,Ea,oa,za,la)=>{oa=da.lB(()=>Ea(da),3,oa,za);oa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,la)},4);return n.TaskExtensions.d3c(oa)},H=(da,Ea,oa)=>ba(da,Ea,C.a.none,B.a.current,oa),ba=(da,Ea,oa,za,la)=>{oa=da.continueWith(()=>{Ea(da)},3,oa,za);oa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,la)},4);return oa},U=(da,Ea)=>
{J(a(1376).CustomFunctionsInstaller.HIf("CustomFunctionsRuntimeLogging"),oa=>{if(oa.result&&window.console)switch(oa=D(da.severity)+" "+da.message+Ea,da.severity){case 2:window.console.log&&window.console.log(oa);break;case 0:window.console.info&&window.console.info(oa);break;case 1:window.console.error&&window.console.error(oa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},D=da=>{switch(da){case 0:return"Medium";case 1:return"Unexpected";
case 2:return"Verbose";default:return""}};var I=a(1251);class X{}Object(A.a)(X,"InstallationInfo",null,[]);class Y{}Object(A.a)(Y,"UninstallationInfo",null,[]);var ja=a(32),Ua=a(83),ka=a(41),fb=a(36),ha=a(1),ea=a(28),aa=a(264),ca=a(607),xa=a(67);class Oa{constructor(da,Ea){this.ekd=da;this._message=Ea}get severity(){return this.ekd}get message(){return this._message}}Object(A.a)(Oa,"CustomFunctionLog",null,[]);var ua=a(5),Ia=a(91),Sa=a(95);class Ya{constructor(da,Ea,oa){this.uoa=!1;this.sP={};this.$=
da;this.xt=Ea;this.gUd().jBa();this.indexedDB=oa;this.indexedDB.zl()&&(this.uoa=!0,this.indexedDB.initialize(Ya.pnb,Ya.qnb))}get i6(){return this.xt.i6}QVf(da,Ea,oa,za){if(za.invariantNamespace)for(let la=0;la<za.invariantNamespace.length;++la){const Ca=za.invariantNamespace.charAt(la);if("."!==Ca&&"_"!==Ca&&"a">Ca&&"z"<Ca&&"A">Ca&&"Z"<Ca&&"0">Ca&&"9"<Ca)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${Ca}', Position=${la}.`),
Error.create("InvariantNamespace validation failed");}return F(this.JRh(oa,za.manifest),()=>F(this.oge(da),la=>{let Ca=la.result;return(null===Ca||void 0===Ca?0:Ca.isDynamicMetadata)?this.vhe(da,Ea,Ca,!1,!1,!1):F(this.Dfl(da,Ea,za),Va=>{Ca=new X;Ca.addinId=oa;Ca.locale=za.locale;Ca.addinInvariantNamespace=za.invariantNamespace;Ca.addinNamespace=za.namespace;Ca.addinTitle=za.title;Ca.isXllCompatible=za.isXllCompatible;Ca.metadataContent=JSON.stringify(JSON.parse(Va.result));return this.vhe(da,Ea,Ca,
!1,Ya.lui(za.osfControl.getStoreType()),I.a(this.$,za))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}RVf(da,Ea,oa,za){if(!Ya.J_d(oa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");
return F(this.oge(da),la=>{la=la.result;if(!la&&(la=ka.a.wj(this.i6,da),!la))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,Ea,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");la.metadataContent=JSON.stringify(JSON.parse(oa));la.isDynamicMetadata=!0;return this.vhe(da,Ea,la,!0,!0,za)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}c4g(da,
Ea){this.xt.iwa();const oa=Object(c.a)(new Y,{solutionId:da}),za=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,Ea,null)}.`;return F(this.iie(da),()=>F(this.rie(da),()=>this.fze(this.xt,da,Ea,oa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),za)}Dfl(da,Ea,oa){const za=new r.a;OSF.OUtil.xhrGet(oa.metadataUrl,la=>{la?za.setResult(la):za.setException(Error.create("Invalid manifest"))},
la=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,Ea,null)}. ErrorCode: ${la}.`);za.$C()});return za.task}gUd(){return F(this.GTc(),da=>{const Ea=da.result;if(!Ea.length)return xa.Task.Ua(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");da=new f.a;const oa=[];for(let za=
0;za<Ea.length;za++){const la=Object(l.a)(String,Ea[za]);da.add(J(this.oge(la),Ca=>{if(Ca=Ca.result){const Va=ka.a.wj(this.sP,Ca.addinId);Va&&Va===Ca.metadataContent||(this.sP[Ca.addinId]=Ca.metadataContent,this.i6[la]=Ca,oa.push(Ca))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return M(xa.Task.WhenAllEnumerable(da),()=>{if(oa.length){const za=new y;za.registrationInfos=oa;return this.Uoc(this.xt,Ea,za)}b.ULS.sendTraceTag(537163546,
0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return xa.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}SVf(){var da=new r.a;const Ea=[],oa=[];Object.keys(this.i6).forEach(za=>{za=Object(l.a)(String,za);const la=ka.a.wj(this.i6,za);Ea.push(la);oa.push(za)});if(!oa.length)return da.setResult(!0),da.task;da=Object(c.a)(new y,
{registrationInfos:Ea});return this.Uoc(this.xt,oa,da)}GTc(){return J(this.PMd(v.a.Teb),da=>{da=da.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(da||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(da||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}M$g(da){return this.ype(v.a.Teb,Sys.Serialization.JavaScriptSerializer.serialize(da))}oge(da){return F(this.PMd(v.a.Mlb(da)),Ea=>{Ea=Ea.result||
"";return 0<Ea.length?xa.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(Ea,!0)):xa.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}tfl(da,Ea){return F(this.Rtf(da),()=>F(this.ype(v.a.Mlb(da),Sys.Serialization.JavaScriptSerializer.serialize(Ea)),()=>Ya.zpe(v.a.gRd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}iie(da){return F(this.HDg(da),
()=>F(this.eEg(v.a.Mlb(da)),()=>F(this.GTc(),Ea=>Ea.result.length?xa.Task.Ua(!0):Ya.zpe(v.a.gRd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}dBg(da){return this.PMd(v.a.Llb(da))}J$g(da,Ea){return F(this.Rtf(da),
()=>this.ype(v.a.Llb(da),Ea),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}rie(da){return F(this.HDg(da),()=>this.eEg(v.a.Llb(da)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}Rtf(da){return F(this.GTc(),Ea=>{Ea=Ea.result;const oa=da.toLowerCase();if(Ea.includes(oa))return xa.Task.Ua(!0);Ea.push(oa);return this.M$g(Ea)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}HDg(da){return F(this.GTc(),
Ea=>{Ea=Ea.result;const oa=da.toLowerCase();return Ea.includes(oa)?(Ea.splice(Array.indexOf(Ea,oa),1),this.M$g(Ea)):xa.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}JRh(da,Ea){if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return da=new OSF.AddinIdInfo(da),da.needToRestoreManifest()?this.J$g(da.getSolutionId(),Ea):xa.Task.Ua(!0);da=new k(da);return da.needToRestoreManifest?this.J$g(da.solutionId,
Ea):xa.Task.Ua(!0)}Ntk(da){if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const oa=new OSF.AddinIdInfo(da);return oa.needToRestoreManifest()?J(this.dBg(oa.getSolutionId()),za=>{(za=za.result)&&OSF.OsfManifestManager.cacheManifestFromXml(oa.getSolutionId(),oa.getSolutionVersion(),za,this.$.ua.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):xa.Task.Ua(!0)}const Ea=new k(da);return Ea.needToRestoreManifest?
J(this.dBg(Ea.solutionId),oa=>{(oa=oa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ea.solutionId,Ea.solutionVersion,oa,this.$.ua.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):xa.Task.Ua(!0)}eEg(da){return this.uoa?this.indexedDB.IBd(da):Ya.Kkk(da)}ype(da,Ea){return this.uoa?this.indexedDB.lBa(new ca.a(da,Ea)):Ya.zpe(da,Ea)}PMd(da){return this.uoa?this.indexedDB.fxa(da):Ya.HIf(da)}vhe(da,Ea,oa,za,la,Ca){const Va=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,
Ea,null)}.`;return n.TaskExtensions.d3c(J(this.whe(this.xt,da,Ea,oa,!1,za,Ca),()=>la?this.tfl(da,oa):xa.Task.Ua(!0),Va))}whe(da,Ea,oa,za,la,Ca,Va){if(!Ca&&(Ca=ka.a.wj(this.sP,za.addinId))&&Ca===za.metadataContent)return xa.Task.Ua(!0);this.sP[za.addinId]=za.metadataContent;this.i6[Ea]=za;Va||da.N4b(Ea);da.iwa();return F(this.Nhk(Ea,oa,za),()=>this.Qee(za.addinId,la),"Failed to register functions for customfunction addin")}Nhk(da,Ea,oa){const za=new r.a,la=this.BWa(oa);return this.cga(Ca=>{U(Ya.nNb,
da);(Ca=Ca.Result)&&204===Ca.ResponseStatusCode?za.setResult(!0):(delete this.sP[oa.addinId],delete this.i6[da],E(this.iie(da),()=>{E(this.rie(da),()=>{this.CUg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${da}. Received status code ${Ca?Ca.ResponseStatusCode.toString():"Unknown"}.`),za.setResult(!1))},Ca=>{Ca=w.a.gk(Ca.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(da,
Ea,null)}. Errors: ${fb.a.Yh(Ca)}.`);U(Ya.mNb,da);delete this.sP[oa.addinId];delete this.i6[da];za.setResult(!1)},la,za,!0)}Uoc(da,Ea,oa){const za=new r.a,la=ja.a.ih.$j.m;Ea.forEach(Va=>{Va=Object(l.a)(String,Va);da.Eef(Va)});da.iwa();const Ca=this.Mtd(oa);return this.cga(Va=>{U(Ya.nNb,Sys.Serialization.JavaScriptSerializer.serialize(Ea));Va=Va.Result;let ia=!0,wa=[];if(null===Va||void 0===Va?0:Va.ResponseBody){var Jb=Sys.Serialization.JavaScriptSerializer.deserialize(Va.ResponseBody.toString());
Array.isArray(Jb.value)&&(wa=Jb.value)}Jb=new f.a;for(let $a=0;$a<wa.length;$a++)if(!wa[$a]){ia=!1;const Ka=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${Va.ResponseStatusCode}.`;Jb.add(F(this.iie(Ea[$a]),()=>{delete this.sP[oa.registrationInfos[$a].addinId];delete this.i6[Ea[$a]];return this.rie(Ea[$a])},Ka))}H(xa.Task.WhenAllEnumerable(Jb),()=>{E(this.Qee("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${ja.a.ih.$j.m-
la} Millisecond.`);ia?za.setResult(ia):H(this.CUg(),()=>{za.setResult(ia)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},Va=>{Va=w.a.gk(Va.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${fb.a.Yh(Va)}.`);
U(Ya.mNb,Sys.Serialization.JavaScriptSerializer.serialize(Ea));for(Va=0;Va<oa.registrationInfos.length;Va++)delete this.sP[oa.registrationInfos[Va].addinId],delete this.i6[Ea[Va]];za.setResult(!1)},Ca,za,!0)}fze(da,Ea,oa,za){return F(this.C5k(da,Ea,oa,za),()=>this.Qee(za.solutionId,!1),"Failed to unregister functions for customfunction addin")}C5k(da,Ea,oa,za){const la=new r.a;da.N4b(Ea);(da=ka.a.wj(this.i6,Ea))&&delete this.sP[da.addinId];delete this.i6[Ea];za=this.bud(za);return this.cga(()=>{U(Ya.JAd,
Ea);la.setResult(!0)},Ca=>{Ca=w.a.gk(Ca.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,oa,null)}. Errors: ${fb.a.Yh(Ca)}.`);U(Ya.IAd,Ea);la.setResult(!1)},za,la,!1)}cga(da,Ea,oa,za,la){const Ca=this.$.userOperationManager,Va=this.$.pa;let ia=null,wa=null,Jb=null;const $a=()=>{if(Ca.HXa()||0<Va.ta.dga||0<Va.$G.dga)return!1;ia&&Ca.uu(ia);wa&&Va.iL(wa);
Jb&&Va.wZ(Jb);const Ka=oa.request;Ca.$O(new m.a(507,0,(nb,sa,na)=>{U(la?Ya.HAd:Ya.KAd,Ka.RequestBody);return x.h(Va.ta,"ExecuteRichApiRequest",oa,aa.c(nb,da),aa.b(sa,Ea),na,null,0)},Ka.RequestFlags&1&&256!==(Ka.RequestFlags&256)?64:80));return!0};$a()||(ia=()=>{$a()},wa=()=>{$a()},Jb=()=>{$a()},Ca.mw(ia),Va.yI(wa),Va.xX(Jb));return za.task}BWa(da){const Ea={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ea.RequestBody=JSON.stringify(da);Ea.RequestFlags=1;Ea.RequestFlags|=
256;da=this.$.pa.ta.$a(1);da.request=Ea;return da}Mtd(da){const Ea={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Ea.RequestBody=JSON.stringify(da);Ea.RequestFlags=1;Ea.RequestFlags|=256;da=this.$.pa.ta.$a(1);da.request=Ea;return da}bud(da){const Ea={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ea.RequestBody=JSON.stringify(da);Ea.RequestFlags=1;Ea.RequestFlags|=256;da=this.$.pa.ta.$a(1);da.request=Ea;return da}Qee(da,Ea){const oa=
Object(Ia.d)(Sa.a.resolve(ua.Wc,{va:1}));return W(oa,()=>{oa.result.ble();return da&&Ea?this.Ntk(da):xa.Task.Ua(!0)},this.$.ya,t.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}CUg(){const da=new Ua.a(1949669462,0,this.$.hi,0,null);return this.$.Ma.qh(da)}static HIf(da){try{return xa.Task.Ua(localStorage.getItem(da))}catch(Ea){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${Ea.message||
"Unknown"}`),xa.Task.Ua(null)}}static zpe(da,Ea){try{return localStorage.setItem(da,Ea),xa.Task.Ua(!0)}catch(oa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${oa.message||"Unknown"}`),xa.Task.Ua(!1)}}static Kkk(da){try{return localStorage.removeItem(da),xa.Task.Ua(!0)}catch(Ea){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${Ea.message||
"Unknown"}`),xa.Task.Ua(!1)}}static lui(da){return ea.a.equals(da,"registry",!0)||ea.a.equals(da,"uploadfiledevcatalog",!0)||h.AFrameworkApplication.userNameUnknown||h.AFrameworkApplication.limitedEdit}static J_d(da){if(!da)return!1;try{JSON.parse(da)}catch(Ea){return!1}return!0}}Ya.pnb="CustomFunctionCache";Ya.qnb="CustomFunction";Ya.HAd=new Oa(2,"CustomFunctions [Registration] [Begin] SolutionId=");Ya.nNb=new Oa(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Ya.mNb=new Oa(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Ya.KAd=new Oa(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Ya.JAd=new Oa(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Ya.IAd=new Oa(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(A.a)(Ya,"CustomFunctionsInstaller",null,[289])},1377:function(A,u,a){a.r(u);a.d(u,"CustomFunctionsLegacyInstaller",function(){return X});A=a(0);var c=a(2),b=a(15),h=a(1162),r=a(183),f=a(153),l=a(216),m=a(64),x=a(77),n=a(39),t=a(124),w=a(622),v=a(1251);class k{constructor(Y){Y=
Y.split("|");this.IG=Y[1];this.Nkd=Y[2];this.uve=Y[3]}get solutionId(){return this.IG}get solutionVersion(){return this.Nkd}get needToRestoreManifest(){return this.uve===OSF.StoreTypeEnum.Registry.toString()}}Object(A.a)(k,"AddinStoreInfo",null,[]);class y{}Object(A.a)(y,"CustomFunctionRegistrationInfos",null,[]);const C=(Y,ja)=>{if(a(1377).CustomFunctionsLegacyInstaller.bSb("CustomFunctionsRuntimeLogging")&&window.console)switch(ja=B(Y.severity)+" "+Y.message+ja,Y.severity){case 2:window.console.log&&
window.console.log(ja);break;case 0:window.console.info&&window.console.info(ja);break;case 1:window.console.error&&window.console.error(ja)}},B=Y=>{switch(Y){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class E{}Object(A.a)(E,"InstallationInfo",null,[]);class K{}Object(A.a)(K,"UninstallationInfo",null,[]);var F=a(198),W=a(41),J=a(36),L=a(12),M=a(264),Q=a(1116),H=a(67);class ba{constructor(Y,ja){this.ekd=Y;this._message=ja}get severity(){return this.ekd}get message(){return this._message}}
Object(A.a)(ba,"CustomFunctionLog",null,[]);var U=a(5),D=a(91),I=a(95);class X{constructor(Y){this.sP={};this.$=Y;this.gUd().jBa()}QVf(Y,ja,Ua,ka){const fb=new r.a;if(ka.invariantNamespace)for(ja=0;ja<ka.invariantNamespace.length;++ja){const ea=ka.invariantNamespace.charAt(ja);if("."!==ea&&"_"!==ea&&"a">ea&&"z"<ea&&"A">ea&&"Z"<ea&&"0">ea&&"9"<ea)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${ea}', Position=${ja}.`),
fb.setResult(!1),fb.task}X.cacheManifest(Ua,ka.manifest);let ha=X.pge(Y);(null===ha||void 0===ha?0:ha.isDynamicMetadata)?this.uhe(Y,ha,fb,!1,!1):OSF.OUtil.xhrGet(ka.metadataUrl,ea=>{ha=Object(c.a)(new E,{addinId:Ua,locale:ka.locale,addinInvariantNamespace:ka.invariantNamespace,addinNamespace:ka.namespace,addinTitle:ka.title,isXllCompatible:ka.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(ea))});this.uhe(Y,ha,fb,!1,v.a(this.$,ka))},ea=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${Y}. ErrorCode: ${ea}.`);
fb.setResult(!1)});return fb.task}RVf(Y,ja,Ua,ka){ja=new r.a;if(!X.J_d(Ua))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),ja.setResult(!1),ja.task;const fb=X.pge(Y);if(!fb)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),ja.setResult(!1),ja.task;fb.metadataContent=JSON.stringify(JSON.parse(Ua));fb.isDynamicMetadata=
!0;this.uhe(Y,fb,ja,!0,ka);return ja.task}c4g(Y){const ja=new r.a,Ua=U.xb.Aa()?Object(D.d)(I.a.resolve(U.xb,{va:1})):x.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,1);n.TaskExtensions.Xa(Ua,()=>{const ka=Ua.result;ka.iwa();const fb=Object(c.a)(new K,{solutionId:Y});X.jie(Y);X.sie(Y);n.TaskExtensions.Xa(this.fze(ka,Y,fb),ha=>{F.b(ha)?ja.setResult(ha.result):(ha.Hm?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Y}.`):
ha.mo&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${Y}.`),ja.setResult(!1))},this.$.ya,0)},this.$.ya,3);return ja.task}gUd(){const Y=new r.a,ja=X.tge();0<ja.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Ua=[];ja.forEach(fb=>{fb=Object(f.a)(String,fb);if(fb=X.pge(fb)){const ha=W.a.wj(this.sP,fb.addinId);
ha&&ha===fb.metadataContent||(this.sP[fb.addinId]=fb.metadataContent,Ua.push(fb))}});if(!Ua.length)return Y.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),Y.task;const ka=U.xb.Aa()?Object(D.d)(I.a.resolve(U.xb,{va:1})):x.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,1);n.TaskExtensions.Xa(ka,()=>{const fb=ka.result,ha=Object(c.a)(new y,{registrationInfos:Ua});n.TaskExtensions.Xa(this.Uoc(fb,
ja,ha),ea=>{F.b(ea)?Y.setResult(ea.result):(ea.Hm?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):ea.mo&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),Y.setResult(!1))},this.$.ya,0)},this.$.ya,3);return Y.task}Mtk(Y){Y=new k(Y);if(Y.needToRestoreManifest){const ja=X.Oek(Y.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(Y.solutionId,
Y.solutionVersion,ja,this.$.ua.UICultureTag)}}uhe(Y,ja,Ua,ka,fb){const ha=U.xb.Aa()?Object(D.d)(I.a.resolve(U.xb,{va:1})):x.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,1);n.TaskExtensions.Xa(ha,()=>{n.TaskExtensions.Xa(this.whe(ha.result,Y,ja,!1,ka,fb),ea=>{F.b(ea)?((ea=ea.result)&&X.ufl(Y,ja),Ua.setResult(ea)):(ea.Hm?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${Y}.`):ea.mo&&b.ULS.sendTraceTag(537163487,
0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${Y}.`),Ua.setResult(!1))},this.$.ya,0)},this.$.ya,3)}whe(Y,ja,Ua,ka,fb,ha){if(!fb&&(fb=W.a.wj(this.sP,Ua.addinId))&&fb===Ua.metadataContent)return H.Task.Ua(!0);this.sP[Ua.addinId]=Ua.metadataContent;const ea=new r.a;ha||Y.N4b(ja);Y.iwa();Y=this.BWa(Ua);return this.cga(aa=>{C(X.nNb,ja);const ca=aa.Result;204===ca.ResponseStatusCode?n.TaskExtensions.Xa(this.Pee(ea,Ua.addinId,ka),xa=>{xa.Hm?ja?
b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${ja}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Ua.addinId}.`):xa.mo&&(ja?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${ja}.`):b.ULS.sendTraceTag(537163482,
0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Ua.addinId}.`));ea.setResult(!1)},this.$.ya,4):(aa=()=>{delete this.sP[Ua.addinId];X.jie(ja);X.sie(ja);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${ja}. Received status code ${ca.ResponseStatusCode}.`);ea.setResult(!1)},aa=Object(c.a)(new Q.a,{J0a:OSF.InfoType.Error,title:Ua.addinTitle,description:String.format(L.a.instance.sh(153),
L.a.instance.ia(1892)),buttonText:L.a.instance.ia(4),Sua:aa,rEc:!1,Tva:aa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),h.a.Mse(aa))},aa=>{aa=t.a.gk(aa.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${ja}. Errors: ${J.a.Yh(aa)}.`);C(X.mNb,ja);delete this.sP[Ua.addinId];ea.setResult(!1)},Y,ea,!0)}Uoc(Y,ja,Ua){const ka=new r.a;ja.forEach(ha=>{ha=Object(f.a)(String,ha);Y.Eef(ha)});
Y.iwa();const fb=this.Mtd(Ua);return this.cga(ha=>{C(X.nNb,Sys.Serialization.JavaScriptSerializer.serialize(ja));ha=ha.Result;let ea=!0;var aa=[];aa=Sys.Serialization.JavaScriptSerializer.deserialize(ha.ResponseBody.toString()),aa=Array.isArray(aa.value)?aa.value:null;for(let ca=0;ca<aa.length;ca++)aa[ca]||(ea=!1,delete this.sP[Ua.registrationInfos[ca].addinId],X.jie(ja[ca]),X.sie(ja[ca]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${ja[ca]}. Received status code ${ha.ResponseStatusCode}.`));
n.TaskExtensions.Xa(this.Pee(ka,"",!1),ca=>{ca.Hm?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ca.mo&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");ka.setResult(!1)},this.$.ya,4);ka.setResult(ea)},ha=>{ha=t.a.gk(ha.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(ja)}. Errors: ${J.a.Yh(ha)}.`);
C(X.mNb,Sys.Serialization.JavaScriptSerializer.serialize(ja));for(const ea of Ua.registrationInfos)delete this.sP[ea.addinId];ka.setResult(!1)},fb,ka,!0)}fze(Y,ja,Ua){const ka=new r.a;Y.N4b(ja);Y=this.bud(Ua);return this.cga(()=>{C(X.JAd,ja);n.TaskExtensions.Xa(this.Pee(ka,Ua.solutionId,!1),fb=>{fb.Hm?ja&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${ja}.`):fb.mo&&ja&&b.ULS.sendTraceTag(537163472,
0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${ja}.`);ka.setResult(!1)},this.$.ya,4)},fb=>{fb=t.a.gk(fb.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${ja}. Errors: ${J.a.Yh(fb)}.`);C(X.IAd,ja);ka.setResult(!1)},Y,ka,!1)}cga(Y,ja,Ua,ka,fb){const ha=this.$.userOperationManager,ea=this.$.pa;let aa=null,ca=null,
xa=null;const Oa=()=>{if(ha.HXa()||0<ea.ta.dga||0<ea.$G.dga)return!1;aa&&ha.uu(aa);ca&&ea.iL(ca);xa&&ea.wZ(xa);const ua=Ua.request;ha.$O(new l.a(507,0,(Ia,Sa,Ya)=>{C(fb?X.HAd:X.KAd,ua.RequestBody);return m.h(ea.ta,"ExecuteRichApiRequest",Ua,M.c(Ia,Y),M.b(Sa,ja),Ya,null,0)},(ua.RequestFlags&1?0:16)|64));return!0};Oa()||(aa=()=>{Oa()},ca=()=>{Oa()},xa=()=>{Oa()},ha.mw(aa),ea.yI(ca),ea.xX(xa));return ka.task}BWa(Y){const ja={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};
ja.RequestBody=JSON.stringify(Y);ja.RequestFlags=1;Y=this.$.pa.ta.$a(1);Y.request=ja;return Y}Mtd(Y){const ja={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ja.RequestBody=JSON.stringify(Y);ja.RequestFlags=1;Y=this.$.pa.ta.$a(1);Y.request=ja;return Y}bud(Y){const ja={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ja.RequestBody=JSON.stringify(Y);ja.RequestFlags=1;Y=this.$.pa.ta.$a(1);Y.request=ja;return Y}Pee(Y,ja,Ua){const ka=
Object(D.d)(I.a.resolve(U.Wc,{va:1}));n.TaskExtensions.Xa(ka,()=>{ka.result.ble();ja&&Ua&&this.Mtk(ja);Y.setResult(!0)},this.$.ya,3);return ka}SVf(){return H.Task.Ua(!0)}static tge(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(X.bSb(w.a.Teb)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(X.bSb(w.a.Teb)||"[]"):null)||[]}static N$g(Y){X.Ape(w.a.Teb,Sys.Serialization.JavaScriptSerializer.serialize(Y))}static pge(Y){Y=X.bSb(w.a.Mlb(Y))||"";return 0<Y.length?Sys.Serialization.JavaScriptSerializer.deserialize(Y,
!0):null}static ufl(Y,ja){X.Qtf(Y);X.Ape(w.a.Mlb(Y),Sys.Serialization.JavaScriptSerializer.serialize(ja))}static jie(Y){X.GDg(Y);X.fEg(w.a.Mlb(Y))}static Oek(Y){return X.bSb(w.a.Llb(Y))}static vfl(Y,ja){X.Qtf(Y);X.Ape(w.a.Llb(Y),ja)}static sie(Y){X.GDg(Y);X.fEg(w.a.Llb(Y))}static Qtf(Y){const ja=X.tge();Y=Y.toLowerCase();ja.includes(Y)||(ja.push(Y),X.N$g(ja))}static GDg(Y){const ja=X.tge();Y=Y.toLowerCase();ja.includes(Y)&&(ja.splice(Array.indexOf(ja,Y),1),X.N$g(ja))}static cacheManifest(Y,ja){Y=
new k(Y);Y.needToRestoreManifest&&X.vfl(Y.solutionId,ja)}static bSb(Y){try{return localStorage.getItem(Y)}catch(ja){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${ja.message||"Unknown"}`),null}}static Ape(Y,ja){try{localStorage.setItem(Y,ja)}catch(Ua){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Ua.message||
"Unknown"}`)}}static fEg(Y){try{localStorage.removeItem(Y)}catch(ja){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${ja.message||"Unknown"}`)}}static J_d(Y){if(!Y)return!1;try{JSON.parse(Y)}catch(ja){return!1}return!0}}X.HAd=new ba(2,"CustomFunctions [Registration] [Begin] SolutionId=");X.nNb=new ba(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");X.mNb=new ba(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
X.KAd=new ba(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");X.JAd=new ba(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");X.IAd=new ba(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(A.a)(X,"CustomFunctionsLegacyInstaller",null,[289])},1388:function(A,u,a){a.d(u,"a",function(){return E});A=a(0);var c=a(224),b=a(15);class h{}Object(A.a)(h,"AddinCommandsHost",null,[]);var r=a(1452),f=a(1558),l=a(1114),m=a(64);const x=(K,F,W,J,L,M)=>{const Q=K.$a(9);
Q.sharedInfo=F;return m.h(K,"InsertAgaveTaskpane",Q,W,J,L,M,0)};var n=a(427),t=a(216),w=a(39),v=a(1),k=a(264);u=a(240);class y extends u.a{constructor(K){super();this.kl=this.OSa="AddInCommandsDialog";this.Ph=5;this.dialogWidth=695;this.dialogHeight=438;this.k1h="100%";this.h1h="408px";this.i1h="15px";this.j1h="0";this.$ph=K}get containerDiv(){return this.Wo}oG(){super.oG();this.Wo.style.width=this.k1h;this.Wo.style.height=this.h1h;this.Wo.style.marginTop=this.i1h;this.Wo.style.padding=this.j1h}oT(){super.oT();
this.ph.style.width=String.format("{0}px",this.dialogWidth);this.ph.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.$ph()}}Object(A.a)(y,"AddInCommandsDialog",u.a,[]);var C=a(67),B=a(76);a=a(106);class E extends h{constructor(K,F,W,J,L){J=void 0===J?null:J;L=void 0===L?null:L;super();this.$=K;this.Ai=F;this.ownerAddinInfo=W;this.Nh=L;this.Wvb=J||C.Task.Ua(!0)}e1h(){const K=this.Wvb;this.Wvb=C.Task.Ua(!0);return K}disposeHost(K){this.Ai.L6a(K)}setOwnerAddinEToken(K){this.ownerAddinInfo.eToken=
K}showTaskpane(K,F,W){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let J=null,L=!1;const M=(new r.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new l.a,!0)).unf(K.solutionId.substr(this.ownerAddinInfo.solutionId.length));J=F.getSharedRuntimeForTaskpane("Workbook",M);L=!!J&&1===J.LifeTime;this.Ai.Hef(L?this.ownerAddinInfo.solutionId:K.solutionId,L?J:null,null)||(this.Q9f(L,!0),this.Wvb=this.eUd(K,J,(Q,H)=>{Q?(L&&(Q.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,
Q.SharedRuntime=J),Q.WebExtensionOsfControlType=3,this.Ai.YXa(Q),W(Q.InstanceId,H),this.Q9f(L,!1),v.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),W(null,H))}))}getSettings(K,F){const W=this.Ai.x5(K.solutionId);W?F(this.Ai.aY(W).OsfPropertyBag):this.Wvb=this.eUd(K,null,J=>{J?F(J.OsfPropertyBag):b.ULS.sendTraceTag(537170641,
220,10,"GetSettings: insertData is null.")})}showDialog(K,F,W){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const J=this.$.pa.ta,L=Q=>{const H=Q.Result,ba=H?H.AgaveData:null;ba?(this.Ai.hmf(ba,()=>{const U=new y(()=>{this.disposeHost(ba.InstanceId)});U.initializeAndShow("",null,null);return U.containerDiv}),W(ba.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),W(null,Q.Errors?Q.Errors[0].ErrorCause:5001))},M=E.wfa(K,this.ownerAddinInfo);this.Wvb=
n.a(this.$.userOperationManager,(Q,H,ba)=>x(J,M,k.c(Q,L),H,ba,null),Q=>new t.a(500,0,Q,64),this.Nh)}createUILessSandbox(K,F,W){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const J=F.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),L=!!J&&1===J.LifeTime;(F=this.Ai.Twi(L?this.ownerAddinInfo.solutionId:K.solutionId,L?J:null))?W(F,0):this.Wvb=this.eUd(K,J,(M,Q)=>{M?(L?(M.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,M.SharedRuntime=J,M.TaskpaneVisible=!1,M.WebExtensionOsfControlType=
3,this.Ai.YXa(M)):(M.WebExtensionOsfControlType=4,this.Ai.hmf(M,()=>{E.rzb.ga(M.InstanceId,new f.a);return E.rzb.na(M.InstanceId).Lma})),W(M.InstanceId,Q)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),W(null,Q))})}eUd(K,F,W){let J=null;const L=this.$.pa.ta,M=D=>{const I=D.Result;(J=I?I.AgaveData:null)||W(null,D.Errors?D.Errors[0].ErrorCause:5001)},Q=E.wfa(K,this.ownerAddinInfo);F&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),Q.SharedRuntimeId=F.Resid);
let H=500;var ba=(D,I,X)=>x(L,Q,k.c(D,M),I,X,null);let U=0;void 0===Q.IsToBePersisted||null===Q.IsToBePersisted||Q.IsToBePersisted||(H=538,ba=(D,I,X)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));D=k.c(D,M);const Y=L.$a(9,null);Y.sharedInfo=Q;return m.h(L,
"ShowAgaveTaskpane",Y,D,I,X,null,0)},U=16);U|=64;ba=n.a(this.$.userOperationManager,ba,D=>new t.a(H,0,D,U),this.Nh);return w.TaskExtensions.ts(ba,()=>J?this.A2d(L,J.InstanceId,(D,I)=>{if(D){F||(J.PrimaryMarketplace.MarketplaceType=K.storeType);K.assetId?K.assetId.toLowerCase().startsWith("wa")?J.AssetMarketplace={SolutionId:K.assetId,SolutionVersion:K.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:K.assetStoreId}:(J.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):
J.AssetMarketplace=null;J.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;J.OwnerAddinStoreType=this.ownerAddinInfo.storeType;J.OsfPropertyBag=[];for(I=0;I<D.Settings.length;I++){const X=[];X[0]=D.Settings[I].Name;X[1]=D.Settings[I].Value;J.OsfPropertyBag[I]=X}W(J,0)}else W(null,I.Errors?I.Errors[0].ErrorCause:5001)}):C.Task.Ua(!1),c.a.none,3,B.a.current)}A2d(K,F,W){const J=L=>{W(L.Result,L)};return n.a(this.$.userOperationManager,(L,M,Q)=>{L=k.c(L,J);const H=K.$a(1);H.controlId=F;return m.h(K,
"DdaLoadSettings",H,L,M,Q,null,0)},L=>new t.a(501,0,L,80),this.Nh)}Q9f(K,F){var W;K&&(null===(W=window.performance)||void 0===W?0:W.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${F}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(K){E.rzb.lh(K)&&E.rzb.na(K).initializeAndShowWithTitle()}static hideUILessDialog(K){E.rzb.lh(K)&&
E.rzb.na(K).hide()}static wfa(K,F){var W,J;const L={};L.SolutionId=K.solutionId;L.Version=K.version;L.StoreType=F.storeType;L.StoreId=K.storeId;L.AssetId=null!==(W=K.assetId)&&void 0!==W?W:K.solutionId;L.AssetStoreId=null!==(J=K.assetStoreId)&&void 0!==J?J:"omex";L.TargetType=1;L.Width=350;L.OwnerAddinSolutionId=F.solutionId;L.OwnerAddinStoreType=F.storeType;L.SharedRuntimeId=null;L.Preload=!1;return L}}E.rzb=new a.a;Object(A.a)(E,"WACExcelAddinCommandsHost",h,[])},1404:function(A,u,a){a.d(u,"a",
function(){return n});A=a(0);var c=a(210),b=a(379),h=a(15);class r{}r.getUserId="getUserId";r.getLastStoreUpdate="laststoreupdate";r.getEntitlement="getEntitlements";r.getEToken="getEToken";r.getManifest="getManifest";r.getAppState="getAppState";r.getKilledApps="getRemovedAddins";r.getAppDetails="getAppDetails";r.removeApps="removeAddin";r.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";r.getPrivateCatalogAddIns="getAddIns";r.getPrivateCatalogManifests="getAppManifests";r.isStoreDisabled=
"isStoreDisabled";Object(A.a)(r,"S2SWebRequestActions",null,[]);var f=a(6),l=a(288),m=a(33),x=a(672);class n{getUserId(t,w){const v=new c.a;v.add(new b.a("corr",t));this.j8(r.getUserId,v,1,w)}getLastStoreUpdate(t,w,v){const k=new c.a;k.add(new b.a("lc",t));k.add(new b.a("corr",w));this.j8(r.getLastStoreUpdate,k,1,v)}getEntitlement(t,w,v,k){t=new c.a;t.add(new b.a("av",w));t.add(new b.a("corr",v));this.j8(r.getEntitlement,t,1,k)}getEToken(t,w,v,k,y,C){const B=new c.a;B.add(new b.a("cmu",t));B.add(new b.a("cmf",
w));B.add(new b.a("assetid",v));B.add(new b.a("expver",k));B.add(new b.a("corr",y));this.j8(r.getEToken,B,1,C)}getManifest(t,w,v,k){const y=new c.a;y.add(new b.a("cmu",t));y.add(new b.a("assetid",w));y.add(new b.a("corr",v));this.j8(r.getManifest,y,1,k)}getAppState(t,w,v){const k=new c.a;k.add(new b.a("ma",t));k.add(new b.a("corr",w));this.j8(r.getAppState,k,1,v)}getKilledApps(t,w){const v=new c.a;v.add(new b.a("corr",t));this.j8(r.getKilledApps,v,1,w)}getAppDetails(t,w,v,k){const y=new c.a;y.add(new b.a("cmo",
t));y.add(new b.a("corr",v));this.sendWithBody(r.getAppDetails,y,w,2,k,!1)}removeApps(t,w,v){const k=new c.a;k.add(new b.a("corr",w));this.sendWithBody(r.removeApps,k,t,2,v,!1)}getLastPrivateCatalogUpdate(t,w,v,k,y,C){const B=new c.a;B.add(new b.a("catalog","privatecatalog"));B.add(new b.a("clientCode",t));B.add(new b.a("clientVersion",w));B.add(new b.a("corr",y));t=String.format("authorizationCode={0}&refreshToken={1}",v?m.a.Al(v):"",k?m.a.Al(k):"");this.sendWithBody(r.getLastPrivateCatalogUpdate,
B,t,2,C,!0)}getPrivateCatalogAddIns(t,w,v,k,y,C){const B=new c.a;B.add(new b.a("catalog","privatecatalog"));B.add(new b.a("clientCode",t));B.add(new b.a("clientVersion",w));B.add(new b.a("corr",y));t=String.format("authorizationCode={0}&refreshToken={1}",v?m.a.Al(v):"",k?m.a.Al(k):"");this.sendWithBody(r.getPrivateCatalogAddIns,B,t,2,C,!0)}getPrivateCatalogManifests(t,w,v,k,y){const C=new c.a;C.add(new b.a("catalog","privatecatalog"));C.add(new b.a("corr",k));t=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",
m.a.Al(t),w?m.a.Al(w):"",v?m.a.Al(v):"");this.sendWithBody(r.getPrivateCatalogManifests,C,t,2,y,!0)}isStoreDisabled(t,w){const v=new c.a;v.add(new b.a("corr",t));this.j8(r.isStoreDisabled,v,2,w)}j8(t,w,v,k){this.sendWithBody(t,w,null,v,k,!1)}sendWithBody(t,w,v,k,y,C){const B=new l.QueryStringBuilder("AddinServiceHandler.ashx");B.fq("action",t);B.fq("app",x.a[f.AFrameworkApplication.ra.$g.kn]);for(const E of w)B.fq(E.key,E.value);w=String.format("{0}{1}&{2}",f.AFrameworkApplication.ra.$g.H1,B.toString(),
f.AFrameworkApplication.Jo);f.AFrameworkApplication.rj.ov(w,k,v,null,!1,2,E=>{let K=null,F=null;E&&E.data&&(E.data.responseHeaders["X-BlockedForMinor"]&&"1"===E.data.responseHeaders["X-BlockedForMinor"].toString()&&(E.data.httpStatus=451),K=E.data.responseData,F=E.data.responseHeaders);y(E.data.httpStatus,K,F)},E=>{var K=null;let F=null;C&&E&&E.data&&E.data.responseData&&(K=E.data.responseData,F=E.data.responseHeaders);y(E.data.httpStatus,K,F);if(f.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){K={message:"AddinServiceHandler request failed"};K.code=E.data.httpStatus;K.action=t;if(E.data.request||E.data.request.get_headers())K["X-UserSessionId"]=E.data.request.get_headers()["X-UserSessionId"];408===E.data.httpStatus||503===E.data.httpStatus?h.ULS.sendTraceTag(538784582,220,50,JSON.stringify(K)):h.ULS.sendTraceTag(18392345,220,50,JSON.stringify(K))}else h.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",E.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+
t,void 0,void 0,void 0,["X-UserKey"])}}Object(A.a)(n,"S2SWebRequestManager",null,[])},1405:function(A,u,a){a.d(u,"a",function(){return m});A=a(0);var c=a(648),b=a(15),h=a(241);class r{constructor(x,n,t){this.dQf=w=>{try{if(w&&w.rawEvent&&w.rawEvent.origin&&this.iframe&&this.iframe.id){var v=this.Wtg(w.rawEvent.origin);const k=this.Wtg(document.domain);if(c.a.zm().equals(k,v))if(w.rawEvent.source&&w.rawEvent.source.frameElement&&w.rawEvent.source.frameElement.id&&c.a.zm().equals(w.rawEvent.source.frameElement.id,
this.iframe.id)){v=null;try{v=JSON.parse(w.rawEvent.data)}catch(y){b.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",y.message)}v?(v.statusCode!==h.a.HL||void 0!==v.error&&v.error?(b.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",v.statusCode,v.error),this.onError()):(b.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.S1(v.authorizationCode?v.authorizationCode:v.signInUrl)),$removeHandler(window,"message",this.dQf),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):b.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):b.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):b.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else b.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else b.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else b.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(k){b.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",k.message)}};this.iframe=x;this.S1=n;this.onError=t;$addHandler(window,"message",this.dQf)}Wtg(x){let n="";try{x&&(n=-1<x.indexOf("//")?x.split("/")[2]:
x.split("/")[0])&&(n=n.split(":")[0],n=n.split("?")[0])}catch(t){b.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",t.message)}return n}static Ba(x,n,t){new r(x,n,t)}}Object(A.a)(r,"ResponseHandler",null,[]);var f=a(6),l=a(288);class m{constructor(x){this.eVa=x}tryAuthenticate(x,n){this.Ftb(m.Umh,()=>{x()},n)}tryAuthorize(x,n){this.Ftb(m.Rhh,x,n)}getSignInUrl(x,n){this.Ftb(m.yYe,x,n)}signOut(x,n){this.Ftb(m.hth,x,n)}Ftb(x,n,t){var w=new l.QueryStringBuilder("AuthenticationProxyHandler.aspx");
w.fq("responseType",x);f.AFrameworkApplication.ueb(w);w=String.format("{0}{1}&{2}",this.eVa,w.toString(),f.AFrameworkApplication.Jo);const v=document.createElement("iframe");v.setAttribute("id","privateCatalogIframe");v.setAttribute("name","privateCatalogIframe");v.setAttribute("style","display: none");c.a.zm().equals(x,m.yYe)||v.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");r.Ba(v,n,t);v.setAttribute("src",w);document.body.appendChild(v)}}m.Rhh=
"authcode";m.Umh="identitytoken";m.yYe="signinurl";m.hth="signout";Object(A.a)(m,"AuthenticationProxy",null,[])},1451:function(A,u,a){u=a(484)(!1);u.push([A.i,".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}",""]);A.exports=u},1452:function(A,u,a){a.d(u,"a",function(){return b});A=a(0);a(15);var c=a(6);class b{constructor(h,r,f,l){this.JEb=h;c.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&
f.YPi();this.IG=r;this.Psh=l}get X_b(){return this.JEb}get solutionId(){return this.IG}get ase(){return this.Psh}h_a(h){h=this.X_b+this.solutionId+h;return this.ase?(h in b.lnc||(b.lnc[h]="AddinControl"+b.oFh++),b.lnc[h]):h}unf(h){if(this.ase){const f=b.lnc;for(const l in f){var r=l;if(h===f[l])return r.substr(this.X_b.length+this.solutionId.length)}}return h}AMf(h){h=this.X_b+this.solutionId+h;return this.ase?(h in b.pqd||(b.pqd[h]="AddinTab"+b.EFh++),b.pqd[h]):h}}b.lnc={};b.pqd={};b.EFh=0;b.oFh=
0;Object(A.a)(b,"DefaultRibbonNamingProvider",null,[336])},1513:function(A,u,a){a.d(u,"a",function(){return W});A=a(0);var c=a(210),b=a(15),h=a(106);class r{constructor(){this.startTime=0;this.callback=null}}Object(A.a)(r,"SSOCallbackInfo",null,[]);class f{constructor(){this.accessToken=null}}Object(A.a)(f,"AccessTokenInformation",null,[323]);var l=a(1257);class m{constructor(){this.token=null;this.expiresOn=0;this.Aua=this.authChallenge=null}}Object(A.a)(m,"CachedTokenInfo",null,[]);class x{constructor(){this.Fdc=
new c.a;this.Dla=this.Cla=!1;this.ACa=this.authChallenge=null;this.startTime=this.retryCount=0;this.v5e=null}get callbacks(){return this.Fdc}}Object(A.a)(x,"SSORequestInfo",null,[]);class n extends x{constructor(){super();this.errorCode=0}}Object(A.a)(n,"SSOFailedRequestInfo",x,[]);var t=a(6),w=a(126),v=a(181);class k{static Fha(J,L,M,Q){var H=J.startTime;let ba=0;0<H&&(ba=k.SF()-H);H={["callInstanceId"]:H.toString(),["callDuration"]:ba.toString(),["errorCode"]:L.toString()};if(Q)for(const U in Q)H[U]=
Q[U];b.ULS.sendTraceTag(51401116,344,50,"{0}",H);v.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:w.a.Rm(H)});J.callback(L,M)}static SF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(J){}return Date.now()}}Object(A.a)(k,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class y{constructor(J,L,M,Q){this.H3=new c.a;this.NQ=new c.a;this.KDa=null;this.Wcb=new c.a;this.YQe=Promise.resolve(null);this.wYe=!1;this.djc=
L;this.QT=J;this.dZe=M;this.Ygh=Q}static ntf(){return t.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ReduceAddinSSOThrottleErrors")}vMk(J){if(this.KDa&&this.KDa.authChallenge===J.authChallenge){if(Date.now()/1E3+y.eFj>this.KDa.expiresOn)return this.KDa=null,!1;J=new l.a;J.token=this.KDa.token;J.expiresOn=this.KDa.expiresOn;J.Aua=this.KDa.Aua;J.TQa=!0;J.AKa=0;this.mTb(J);return!0}return!1}QKk(J){for(let L=0;L<this.NQ.count;L++)if(this.NQ.na(L).authChallenge===
J.authChallenge&&this.NQ.na(L).ACa===J.ACa){let M;(M=this.NQ.na(L)).retryCount=M.retryCount+1;J.retryCount=this.NQ.na(L).retryCount;if(this.NQ.na(L).retryCount<y.EFj||!this.NQ.na(L).Cla&&J.Cla||!this.NQ.na(L).Dla&&J.Dla){if(!this.NQ.na(L).Cla&&J.Cla||!this.NQ.na(L).Dla&&J.Dla)J.retryCount=0;this.NQ.removeAt(L);break}J=new l.a;J.errorCode=this.NQ.na(L).errorCode;this.mTb(J);return!0}return!1}wAh(J,L){for(let M=0;M<this.NQ.count;M++)if(this.NQ.na(M).ACa===J.ACa&&this.NQ.na(M).authChallenge===J.authChallenge)return;
this.NQ.add(Object.assign(new n,{Cla:J.Cla,Dla:J.Dla,authChallenge:J.authChallenge,ACa:J.ACa,errorCode:L,retryCount:J.retryCount}))}get resource(){return this.djc}NJd(J,L,M,Q,H,ba){""===M&&(M=null);if(this.wYe)k.Fha(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var U=null;for(const D of this.H3)if(D.Cla===J&&D.Dla===L&&D.authChallenge===M&&D.ACa===H){U=D;break}U||(U=Object.assign(new x,{Cla:J,Dla:L,authChallenge:M,v5e:Q,ACa:H,retryCount:0,startTime:k.SF()}),this.H3.add(U));
U.retryCount=0;U.callbacks.add(ba);this.YQe=this.YQe.then(()=>{if(0<this.H3.count){var D=this.H3.na(0);if(this.vMk(D)||this.QKk(D))return null;for(var I=0;I<this.Wcb.count;)this.Wcb.na(I)+y.nZk<k.SF()?this.Wcb.removeAt(I):I++;I=y.ntf()?y.zFj:y.AFj;if(this.Wcb.count>=I||this.H3.count>=y.ZEj)return D=new l.a,D.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.mTb(D),null;let X=null;t.AFrameworkApplication.ra&&(I=t.AFrameworkApplication.ra.yL)&&(X=I.Li("ComponentAttach",this.QT+
y.Eth));return D.ACa.fwh(this.resource,D.Cla,D.Dla,D.authChallenge,this.Ygh,D.v5e).then(Y=>{X&&X.stop();this.mTb(Y)},()=>{X&&X.stop();const Y=new l.a;Y.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.mTb(Y)})}return null})}}mTb(J){try{if(this.H3.count){var L=this.H3.na(0);this.H3.removeAt(0);var M=null;J.errorCode||(M=new f,M.accessToken=J.token);J.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&J.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&
J.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&J.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.wAh(L,J.errorCode);var Q={};null!=J.AKa&&(Q.getTokenSilentTime=J.AKa.toString());null!=J.LSb&&(Q.getTokenPopupTime=J.LSb.toString());null!=J.tMd&&(Q.getIDTokenTime=J.tMd.toString());null!=J.TQa&&(Q.tokenCached=J.TQa.toString());J.zwe&&(Q.detailedError=J.zwe);J.Aua&&(Q.authLibrary=J.Aua);L.retryCount&&(Q.retryCount=L.retryCount);for(var H of L.callbacks)k.Fha(H,
J.errorCode,M,Q);if(y.ntf()){const ba=Number.isFinite(J.AKa)&&0<=J.AKa&&J.AKa<y.Aui;(0<J.LSb||!ba&&!J.TQa)&&this.Wcb.add(L.startTime)}else null!=J.TQa&&J.TQa||this.Wcb.add(L.startTime);if(!J.errorCode)for(null!=J.expiresOn&&(this.KDa=Object.assign(new m,{token:J.token,expiresOn:J.expiresOn,authChallenge:L.authChallenge,Aua:J.Aua})),this.NQ.clear(),H=0;H<this.H3.count;)if(this.H3.na(H).authChallenge===L.authChallenge){for(const ba of this.H3.na(H).callbacks)k.Fha(ba,J.errorCode,M,Q);this.H3.removeAt(H)}else H++}}catch(ba){b.ULS.sendTraceTag(21628945,
344,10,"ReceivedAccessTokenHandler: exception message: {0}",ba.message)}}shutdown(){this.wYe=!0;this.H3.clear()}}y.nZk=6E4;y.AFj=6;y.zFj=8;y.ZEj=6;y.EFj=3;y.eFj=300;y.Aui=100;y.Eth="GetAccessToken";Object(A.a)(y,"SSOCallbackManager",null,[]);var C=a(928),B=a(602),E=a(79),K=a(35),F=a(33);class W{constructor(J,L,M){M=void 0===M?null:M;this.q7c=new h.a;const Q=new c.a;L&&Q.add(L.rDj);M&&Q.addRange(M);this.Dr=J;this.Juh=Q}OJd(J,L,M,Q,H,ba,U,D,I,X){X=Object.assign(new r,{startTime:k.SF(),callback:X});
try{const Ua=!!M&&""!==M;var Y=X.startTime;const ka=this.getOsfControl(J);let fb=ka.getStoreType()||"",ha=ka.getOwnerAddinStoreType()||"",ea=ka.getSolutionId()||"";const aa=ka.getVersion()||"";fb=fb.toLowerCase();ha=ha.toLowerCase();ea=ea.toLowerCase();var ja=E.a.rMd(L)||"";const ca=E.a.rMd(ka.getIframeUrl())||"",xa=ja.toLowerCase()===ca.toLowerCase();ja=fb;"inmemory"===fb&&(ja=ha);const Oa=Telemetry.PrivacyRules.GetPrivacyCompliantId(ea,ja,ka.getAssetId(),null,null,ka.getStoreId()),ua={["callInstanceId"]:Y.toString(),
["controlSolutionId"]:Oa,["controlVersion"]:aa,["storeType"]:fb,["ownerStoreType"]:ha,["allowConsentPrompt"]:Q.toString(),["forMSGraphAccess"]:H.toString(),["allowSignInPrompt"]:ba.toString(),["hasAddinAuthChallenge"]:Ua.toString(),["securityOriginEqualsSourceLocation"]:xa.toString(),["singleSignOnEnabled"]:U.toString(),["accountTypeFilter"]:D||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",ua);v.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:w.a.Rm(ua)});
Y=!0;const Ia=t.AFrameworkApplication.fa.Ya("HostAuthType");switch(D){case "aad":Y="aad"===Ia;break;case "msa":Y="msa"===Ia;break;default:Y=!D||"noFilter"===D}if(Y){D=null;if(U)for(const Sa of this.Juh)if(Sa.ikj(ea)){D=Sa;break}D?this.isSSOAddin(J)?(U=!0,"omex"===ja&&(U=!1),"spapp"===ja||"spcatalog"===ja?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),k.Fha(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):H&&!U?(b.ULS.sendTraceTag(51234570,
344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),k.Fha(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(H&&"exchange"===ja&&(Q=!1),this.NJd(J,L,M,ja,Q,ba,I,D,X))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),k.Fha(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):k.Fha(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else k.Fha(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,
null,null)}catch(Ua){this.YLc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Ua.message),k.Fha(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(J,L,M,Q){this.OJd(J,M[C.a.nqd]||null,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||
!1,L,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,M[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,Q)}NJd(J,L,M,Q,H,ba,U,D,I){this.q7c.lh(J)?Q=this.q7c.na(J):(Q=new y(J,this.getWebApplicationResource(J).split(",")[0],Q,this.getDefaultDisplayName(J)),this.q7c.add(J,Q));const X=Q.resource;J=W.hVi(X,this.getWebApplicationId(J));const Y=OfficeExt.WACUtils.getHostSecure(L);J&&Y?J.toLowerCase()===Y.toLowerCase()?Q.NJd(H,ba,M,U,D,I):(W.B3a('SSO Resource "'+
X+'" cannot be used from "'+L+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),k.Fha(I,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(J||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Y||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),k.Fha(I,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}YLc(){b.ULS.sendTraceTag(39068820,
344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(J){return this.Dr.getOsfControl(J)}isSSOAddin(J){return this.getOsfControl(J).getManifest().isSSOAddin()}getWebApplicationId(J){return this.getOsfControl(J).getManifest().getWebApplicationId()}getWebApplicationResource(J){return this.getOsfControl(J).getManifest().getWebApplicationResource()}getDefaultDisplayName(J){return this.getOsfControl(J).getManifest().getDefaultDisplayName()}static cXi(){try{const J=
{};K.a.ZLa&&B.a.cUb&&(J.UiHostSupportsAuthTokenAddinList=W.oAf);J.UiHostSupportsAuthToken=B.a.cUb;return J}catch(J){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",J.message)}return null}static getInstance(J,L,M){W.Va||(W.Va=new W(J,void 0===M?null:M));return W.Va}static B3a(J){window.console.warn&&window.console.warn(J)}static hVi(J,L){if(!J)return"";L||(L="");let M=J.toLowerCase();var Q=L.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(Q)||
(W.B3a('SSO App Id "'+L+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));M.endsWith(Q)||(W.B3a('SSO Resource "'+J+'" does not end with App Id "'+L+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!M.startsWith("https://")&&!M.startsWith("api://"))return W.B3a('SSO Resource "'+J+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(L=0;L<J.length;L++){Q=J.charAt(L);const H=F.a.charCodeAt(J,L);if(33>H||126<H||"&"===Q||"?"===Q||"#"===Q||"%"===Q||"\\"===Q)return W.B3a('SSO Resource "'+J+'" contains an invalid character "'+Q+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+Q+"' in resource URI."),""}if(0<=J.indexOf("::"))return W.B3a('SSO Resource "'+J+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
J.length)return W.B3a('SSO Resource "'+J+'" is '+J.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+J.length+"."),"";M.startsWith("api://")&&(M="https://"+M.substring(6,M.length));return 8===M.length?"":OfficeExt.WACUtils.getHostSecure(M)||""}}W.oAf="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");
W.Va=null;Object(A.a)(W,"AppsForOfficeSingleSignOnManager",null,[292])},1522:function(A,u,a){a.r(u);a.d(u,"DdaEventDispatch",function(){return k});A=a(0);var c=a(15),b=a(153),h;(function(y){y[y.none=0]="none";y[y.testEvent=1]="testEvent";y[y.test1Event=2]="test1Event";y[y.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";y[y.worksheetActivatedEvent=11]="worksheetActivatedEvent";y[y.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";y[y.worksheetAddedEvent=13]="worksheetAddedEvent";
y[y.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";y[y.worksheetDeletedEvent=15]="worksheetDeletedEvent";y[y.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";y[y.worksheetFilteredEvent=17]="worksheetFilteredEvent";y[y.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";y[y.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";y[y.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";y[y.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";y[y.worksheetRowHiddenChangedEvent=
22]="worksheetRowHiddenChangedEvent";y[y.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";y[y.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";y[y.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";y[y.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";y[y.worksheetMovedEvent=27]="worksheetMovedEvent";y[y.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";y[y.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";
y[y.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";y[y.chartAddedEvent=50]="chartAddedEvent";y[y.chartActivatedEvent=51]="chartActivatedEvent";y[y.chartDeactivatedEvent=52]="chartDeactivatedEvent";y[y.chartDeletedEvent=53]="chartDeletedEvent";y[y.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";y[y.tableDataChangedEvent=101]="tableDataChangedEvent";y[y.tableAddedEvent=102]="tableAddedEvent";y[y.tableDeletedEvent=103]="tableDeletedEvent";y[y.tableFilteredEvent=
104]="tableFilteredEvent";y[y.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";y[y.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";y[y.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";y[y.commentAddedEvent=250]="commentAddedEvent";y[y.commentDeletedEvent=251]="commentDeletedEvent";y[y.commentChangedEvent=252]="commentChangedEvent";y[y.invocationMessage=1E3]="invocationMessage";y[y.cancellationMessage=1001]="cancellationMessage";y[y.metadataMessage=
1002]="metadataMessage";y[y.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";y[y.visualChangeEvent=2001]="visualChangeEvent";y[y.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";y[y.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";y[y.shapeActivatedEvent=2101]="shapeActivatedEvent";y[y.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";y[y.shapeAddedEvent=2103]="shapeAddedEvent";y[y.shapeDeletedEvent=2104]="shapeDeletedEvent";y[y.workbookAutoSaveSettingChangedEvent=
2200]="workbookAutoSaveSettingChangedEvent";y[y.wacOperationEvent=2201]="wacOperationEvent";y[y.recordingStateChangedEvent=2202]="recordingStateChangedEvent";y[y.workbookActivatedEvent=2203]="workbookActivatedEvent";y[y.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";y[y.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";y[y.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";y[y.linkedDataTypeRefreshModeChangedEvent=
2501]="linkedDataTypeRefreshModeChangedEvent";y[y.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";y[y.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";y[y.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";y[y.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";y[y.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";y[y.lineageActivityUpdateAvailableEvent=2800]=
"lineageActivityUpdateAvailableEvent";y[y.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";y[y.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";y[y.pivotTableAddedEvent=2900]="pivotTableAddedEvent";y[y.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";y[y.namedItemAddedEvent=3E3]="namedItemAddedEvent";y[y.namedItemDeletedEvent=3001]="namedItemDeletedEvent";y[y.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";
y[y.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";y[y.vbaRecorderRecordingChanged2Event=3202]="vbaRecorderRecordingChanged2Event";y[y.workbookActionRecordedEvent=3201]="workbookActionRecordedEvent";y[y.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";y[y.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";y[y.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";
y[y.applicationUndoChangedEvent=3500]="applicationUndoChangedEvent";y[y.linkedEntityDataDomainLinkedEntityDataDomainAddedEvent=3600]="linkedEntityDataDomainLinkedEntityDataDomainAddedEvent";y[y.linkedEntityDataDomainRefreshCompletedEvent=3601]="linkedEntityDataDomainRefreshCompletedEvent";y[y.linkedEntityDataDomainRefreshModeChangedEvent=3602]="linkedEntityDataDomainRefreshModeChangedEvent";y[y.externalCodeServiceInitializationSettingsOnEnvironmentDefinitionInitializationResponseReceivedEvent=3603]=
"externalCodeServiceInitializationSettingsOnEnvironmentDefinitionInitializationResponseReceivedEvent";y[y.tableApplyPowerQueryTableUpdatePlanCompletedEvent=3604]="tableApplyPowerQueryTableUpdatePlanCompletedEvent";y[y.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";y[y.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent";y[y.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent";y[y.premiumLicenseChangedEvent=65542]=
"premiumLicenseChangedEvent"})(h||(h={}));Object(A.b)("MessageType",h);var r=a(985),f=a(287),l=a(940),m=a(61),x=a(39),n=a(198),t=a(1),w=a(773),v=a(5);class k{constructor(y,C){this.uK=null;this.C1g={};this.E1g={};this.sHd={};this.H7d={};this.RQd=(B,E)=>{B=this.$.Eh.Li("Task","DdaEventDispatch.HandleServerEvent");E=E.GNg;for(let J=0;J<E.length;J++)switch(E[J].EventType){case 2:var K=E[J],F={};F.Name=K.Name;F.BindingType=K.BindingType;F.ColCount=K.ColCount;F.RowCount=K.RowCount;this.IKa(K.InstanceId,
OSF.DDA.EventDispId.dispidBindingDataChangedEvent,F,null);break;case 4:this.IKa(E[J].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(K=E[J],K.InstanceId){F=Array(K.Entries.length);for(var W=0;W<K.Entries.length;W++)F[W]=k.oCc(K.Entries[W],K.IsRemoteOverride);0<K.Entries.length&&1===K.Entries[0].Category?this.aak(K.InstanceId,F):K.InstanceId&&this.IKa(K.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,F)}else{this.sHd={};this.H7d={};for(F=0;F<K.Entries.length;F++)this.mqf(K.Entries[F],
K.IsRemoteOverride);K=JSON.stringify(this.sHd);F=JSON.stringify(this.H7d);W=JSON.stringify(this.C1g);const L=JSON.stringify(this.E1g);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${K}, Number of Not Fired event: ${F}, Total Number of Fired event: ${W}, Total Number of Not Fired event: ${L}`)}}B.stop()};this.Z6b=(B,E)=>{this.IKa(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,E)};this.$=y;this.ddaFacade=C;this.XXc=this.RQd}Rmc(y){y&&(this.iwa(),this.uK.push(y))}fVc(y){this.uK&&(Array.remove(this.uK,
y),this.uK.length||(this.$.wantServerEvents=!1,this.$.yok(this.XXc),this.uK=null))}aak(y,C){const B=w.d.Aa()?this.ddaFacade:Object(b.a)(l.DdaFacade,f.a(this.$));x.TaskExtensions.Xa(B.XRi(y),E=>{if(n.b(E)){var K=E.result;E=B.gs(K);if(K)if(E.JIc)this.IKa(K,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,C);else if(E.fuc)for(K=0;K<C.length;K++)E.fuc.push(C[K]);else E.fuc=C}else E.Hm?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):
E.mo&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ya,0)}vak(y,C){const B=v.xb.Aa()?this.ddaFacade:Object(b.a)(l.DdaFacade,f.a(this.$)),E=B.XDi(y);E?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(E,C,this.Z6b):B.R3h(y,C)}mqf(y,C){let B=!1;const E=parseInt(y.Type,10);var K=y.Target;const F=v.xb.Aa()?this.ddaFacade:Object(b.a)(l.DdaFacade,f.a(this.$));if((K=F.Xn.gSi(E,K))&&0<Object.keys(K).length){B=
!0;for(const J in K)if(K=J,F.Xn.ooc(K)){const L=Array(1);L[0]=k.oCc(y,C);if(t.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var W=L[0][3];if(void 0!==W&&null!==W&&(W=Object(b.a)(Object,m.a.Sp(W)))&&void 0!==W.triggerControlId&&null!==W.triggerControlId&&void 0!==W.triggerSource&&null!==W.triggerSource){let M=!1;C?(W.triggerSource="Unknown",M=!0):F.ahi(W.triggerControlId,K)&&(W.triggerSource="ThisLocalAddin",M=!0);M&&(L[0][3]=m.a.Ci(W))}}this.IKa(K,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,L)}}B?(this.bFc(h[E],this.sHd),this.bFc(h[E],this.C1g)):(this.bFc(h[E],this.H7d),this.bFc(h[E],this.E1g))}iwa(){this.uK||(this.uK=[],this.$.V4e(this.XXc),this.$.wantServerEvents=!0)}bFc(y,C){y in C||(C[y]=0);C[y]+=1}HM(y,C,B){const E={};E.Target=C;E.Category=65536;E.Type=y;E.Message=B;E.Id=-1;this.mqf(E,!1)}jxi(y,C){const B={Target:"",Category:2,Type:1E3};B.Message=C;B.Id=0;C=Array(1);C[0]=k.oCc(B,!1);this.vak(y,C)}Gyc(y,C,B,E){const K={};K.Target=B;K.Category=65536;K.Type=C;K.Message=E;K.Id=
-1;C=Array(1);C[0]=k.oCc(K,!1);this.IKa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,C)}ixi(y,C){this.IKa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,C)}IKa(y,C,B,E){if(this.uK){var K=v.xb.Aa()?this.ddaFacade:Object(b.a)(l.DdaFacade,f.a(this.$));if(!K||C!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&C!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||K.Xn.ooc(y)){y=new r.a(C,y,B,E);for(let F=0,W=this.uK.length;F<W;F++)(C=this.uK[F])&&C(y)}}}static oCc(y,C){const B=Array(6);
B[0]=y.Category;B[1]=y.Type;B[2]=y.Target;B[3]=y.Message;B[4]=y.Id;B[5]=C;return B}}Object(A.a)(k,"DdaEventDispatch",null,[])},1558:function(A,u,a){a.d(u,"a",function(){return h});A=a(0);u=a(240);var c=a(482),b=a(22);class h extends u.a{constructor(){super(void 0,void 0,void 0,!0);this.OSa="AddinCommandsUILessDialog";this.Qld="WACDialogTitleText";this.l9="0";this.UN=380;this.ML=190;this.kl=this.OSa;this.Ph=5;this.xjh=String.format("{0}px",this.UN);this.k9=String.format("{0}px",this.ML);this.DQf=this.GC=
!1;this.oG()}oG(){super.oG();this.Wo.style.width=this.xjh;this.Wo.style.height=this.k9;this.Wo.style.padding=this.l9}qL(r){this.oT();document.getElementById(this.ip(this.Qld)).innerText=r}oT(){super.oT();this.ph.style.width=String.format("{0}px",this.UN);this.ph.style.height=String.format("{0}px",this.ML);this.ph.removeAttribute(c.a.ik);this.ph.removeAttribute(c.a.pU)}hide(){this.Omb()}get Lma(){return this.Wo}initializeAndShowWithTitle(){this.initializeAndShow(Object(b.a)("NotificationUITitle"),
null,null)}}Object(A.a)(h,"AddinCommandsUILessDialog",u.a,[342])},1575:function(A,u,a){a.d(u,"a",function(){return f});A=a(0);var c=a(210),b=a(113);class h{constructor(){this.Yrf=this.displayName=this.bMb=this.Mw=this.ZK=null;this.isUpgraded=!1}w2f(l,m){return this.ZK.getStoreType().toLowerCase()===l.toLowerCase()&&this.ZK.getSolutionId().toLowerCase()===m.toLowerCase()}}Object(A.a)(h,"AddinCommandsResourceItem",null,[]);var r=a(22);class f{constructor(){this.s7c=null;this.Ibd=0;this.wdd=!1;this.hh=
new b.a;this.lnh=new c.a}aBh(l){this.hh.addHandler("AddinCommandsLoadingMessageChanged",l)}ylk(l){this.hh.removeHandler("AddinCommandsLoadingMessageChanged",l)}get sGa(){return this.s7c}gxb(l){l!==this.s7c&&(this.s7c=l,this.hh.raiseEvent("AddinCommandsLoadingMessageChanged"))}eCk(){this.Ibd++;this.sGa||this.gxb(Object(r.a)("LoadingAddInsTitle"))}epe(){this.Ibd--;this.SLc()&&(this.wdd?this.sGa!==Object(r.a)("ErrorLoadingAddInsTitle")&&this.gxb(Object(r.a)("ErrorLoadingAddInsTitle")):this.gxb(null))}bPg(l){this.wdd=
!0;this.gxb((void 0===l?0:l)?Object(r.a)("InstallingCustomFunctionsErrorStatusBarMsg"):Object(r.a)("ErrorLoadingAddInsTitle"))}pff(){this.wdd=!1;this.SLc()?this.gxb(null):this.gxb(Object(r.a)("LoadingAddInsTitle"))}SLc(){return 0>=this.Ibd}get wnb(){return this.lnh}ywa(l,m,x){x=void 0===x?0:x;for(const n of this.wnb)if(n.w2f(l,m)&&(!n.Mw||n.Mw.sDi===x))return n;return null}M2e(l,m,x,n){const t=new h;t.ZK=l;t.Mw=m;t.bMb=x;t.displayName=n;this.wnb.add(t)}Tyh(l,m,x,n){const t=new h;t.ZK=l;t.Mw=m;t.bMb=
null;t.Yrf=x;t.displayName=n;this.wnb.add(t)}Ljk(l,m){let x=0;for(const n of this.wnb)n.ZK.getStoreType()===l&&n.ZK.getSolutionId()===m?this.wnb.removeAt(x):x++}static getInstance(){f.Va||(f.Va=new f);return f.Va}}f.Va=null;Object(A.a)(f,"AddinCommandsResourceManager",null,[])},361:function(A,u,a){function c(d,z){var T=document.getElementById(d);T?z?T.innerHTML=z:T.remove():z&&(T=document.createElement("style"),T.id=d,T.type="text/css",T.innerHTML=z,document.head.appendChild(T))}function b(d,z){d=
d.map(T=>{var ya;T="AddinFlyoutControl"+T;return`[data-icon-name=${T}]::after {
      content: "";
      position: absolute;
      top: 9px;
      right: 18px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: ${null!==(ya=null===z||void 0===z?void 0:z.palette.red)&&void 0!==ya?ya:"#CC4A31"};
      }
      @media screen and (-ms-high-contrast: active) {
        [data-icon-name=${T}]::after {
          border: WindowText 1px solid;
        }
      }
      `}).join("");c("RedDotNotification",d)}function h(d,z){d=d.map(T=>{var ya,sb,cc;T="AddinFlyoutControl"+T;return`[data-icon-name=${T}]::after {
        content: "New";
        position: absolute;
        top: 6px;
        right: 10px;
        width: 30px;
        height: 16px;
        border-radius: 50%/100%;
        border: 1px solid;
        border-color: ${null!==(ya=null===z||void 0===z?void 0:z.palette.LRa)&&void 0!==ya?ya:"white"};
        background-color: ${null!==(sb=null===z||void 0===z?void 0:z.palette.xvl)&&void 0!==sb?sb:"#0078D4"};
        color: ${null!==(cc=null===z||void 0===z?void 0:z.palette.LRa)&&void 0!==cc?cc:"white"};
        font-size: 10px;
        font-style: normal;
    }
      @media screen and (-ms-high-contrast: active) {
        [data-icon-name=${T}]::after {
          border-color: WindowText;
          color: WindowText;
        }
      }`}).join("");c("NewStringNotification",d)}function r(d){c("ButtonGroupHighlight",`#${d}[type="button"] { font-weight: 600; background-color: var(--legacy_themeDark); color: white; }`)}function f(d){return Lo(function*(){let z;for(let Dd=0;10>Dd;++Dd)(z=document.getElementById("fluent-default-layer-host"))||(yield new Promise(ee=>setTimeout(ee,1E3)));if(!z)throw Error("Cannot find the flyout container.");let T=!1,ya=performance.now(),sb;const cc=Dd=>{const ee=performance.now();Dd?(T=!0,d(!0,
0),ya=ee):T&&(T=!1,d(!1,ee-ya))},Fc=Dd=>{sb&&sb.disconnect();const ee=Dd.querySelector('[id="InsertAddInFlyoutMenuId"]');ee?(sb=new MutationObserver(re=>{for(const Ce of re)"attributes"===Ce.type&&Ce.target instanceof HTMLElement&&("InsertAddInFlyoutMenuId"!==Ce.target.id?cc(!1):cc(!0))}),sb.observe(ee,{attributes:!0,attributeFilter:["id"]}),cc(!0)):(sb=new MutationObserver(re=>{for(const Ce of re)"attributes"===Ce.type&&Ce.target instanceof HTMLElement&&("hidden"===Ce.target.style.visibility?cc(!1):
cc(!0))}),sb.observe(Dd,{attributes:!0,attributeFilter:["style"]}),"hidden"!==Dd.style.visibility&&cc(!0))},Wc=new WeakSet,id=new MutationObserver(Dd=>{for(const re of Dd){for(Dd=0;Dd<re.addedNodes.length;++Dd){var ee=re.addedNodes.item(Dd);ee instanceof HTMLElement&&(ee.querySelector('[id="Ribbon-InsertAddInFlyoutDropdown"]')||ee.querySelector('[id="InsertAddInFlyoutMenuId"]'))&&(Fc(ee.querySelector(".ms-Callout-container")),Wc.add(ee))}for(Dd=0;Dd<re.removedNodes.length;++Dd)ee=re.removedNodes.item(Dd),
Wc.has(ee)&&(Wc.delete(ee),cc(!1))}});id.observe(z,{attributes:!1,childList:!0});return{dispose:()=>{id.disconnect();null===sb||void 0===sb?void 0:sb.disconnect()}}})}function l(d,z){const T=[];z=new Eb(z);for(var ya=0;30>ya;ya++)Array.add(T,z.next(d.count));z=0;for(const sb of d){ya=!1;for(const cc of T)if(z===cc){ya=!0;break}z++;if(ya){let cc;(cc=sb.addinInfo).AUP=20*cc.AUP}else if(1===sb.addinInfo.priority){let cc;(cc=sb.addinInfo).AUP=4*cc.AUP}else if(2===sb.addinInfo.priority){let cc;(cc=sb.addinInfo).AUP=
2*cc.AUP}}d.Sc((sb,cc)=>sb.addinInfo.AUP<cc.addinInfo.AUP?1:-1);return d}function m(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}function x(d,z){return Object.assign(new d,z)}function n(d,z,T){return`<a href="${z}" target="${void 0===T?"_blank":T}" >${d}</a>`}function t(){const d=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");d&&(d.style.border="transparent",d.addEventListener("focus",()=>{const z=document.getElementById("AddinDialogControlSearchBox");
z&&z.focus()},{once:!0}))}function w(d,z,T){c(d,z?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${T}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        margin-bottom: 14px;

        [id$="ErrorView"] {
          width: 100%;
          height: 102px;
          display: flex;
          flex-direction: row;

          >i {
            width: 100%;
            height: 102px;
            margin-left: 20px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin-top: 0;

            >label {
              font-weight: 600;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button {
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${T}) {
          button {
          }
        }
      }
    }
  }

  .addin-flyout-highlight {
    transition: all 0.5s;
    background-color: var(--legacy_themeLighter);
  }

  .addin-flyout-highlighted {
    background-color: rgba(0, 0, 0, 0);
  }

  button[id^=FRECarouselSwitchIcon_LEFT], button[id^=FRECarouselSwitchIcon_RIGHT] {
    width: 16px;
    height: 18px;
    font-size: 8px;
    background-color: transparent;

    >span >i {
      font-weight: 600;
      color: var(--legacy_white);
    }

    cursor: pointer;
  }

  button[id^=FRECarouselSwitchIcon_MIDDLE] {
    width: 34px;
    height: 14px;
    font-size: 10px;
    background-color: transparent;

    >span >div {
      font-weight: 600;
      color: var(--legacy_white);
      margin: 0px;
      overflow-x: visible;
    }
  }

  [id=FRECarouselDescriptionIconView] {
    padding-left: 0;
    margin-left: 0;
  }

  [id=FRECarouselDescriptionIconView]>span {
    height: unset;
    background-color: var(--colorNeutralBackground1);
    padding: 6px 4px;
    box-sizing: border-box;
    border: 1px solid var(--border-color);
    display: inline-block;
    text-decoration: none;
    text-align: center;
    cursor: pointer;
    vertical-align: top;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 700;
    position: relative;
    word-break: keep-all;
    user-select: none;
    white-space: nowrap;
  }

  [id^=FRECarouselDescriptionIcon] {
    cursor: pointer;
  }
  `:"")}function v(){return Object(Nb.a)("AddinsFlyoutSeeAllButtonText")}function k(d){const z=Wa().Word[d];return z?z:"IPWAI"===d?Object(Nb.a)("AddinsFREDescriptionWordAI"):"WF"===d?Object(Nb.a)("AddinsFREDescriptionWordWriting"):"APID"===d?Object(Nb.a)("AddinsFREDescriptionWordInsertGraphics"):"FlyoutBannerCommon"}function y(d,z,T){const ya=Fc=>{switch(Fc){case Yh.LEFT:return Object(Nb.a)("AddinsFRECarouselPreviousButton");case Yh.RIGHT:return Object(Nb.a)("AddinsFRECarouselNextButton");case Yh.Wja:return`${T+
1} of ${z}`;default:return""}},sb=[Yh.LEFT,Yh.Wja,Yh.RIGHT],cc=x(Ej.a,{Id:"AddInFlyoutFREBanner",ExternalId:"AddInFlyoutFREBanner",IconName:"IPWAI"===d?"FREWordBannerAI":"WF"===d?"FREWordBannerWriting":"APID"===d?"FREWordBannerInsertGraphics":"FREWordBannerGPTForExcelWord"});return x(N.a,{ControlList:[...sb.map(Fc=>{var Wc=yj.a,id=cg.a.Z0c.toString();a:switch(Fc){case Yh.LEFT:var Dd="ChevronLeft";break a;case Yh.RIGHT:Dd="ChevronRight";break a;default:Dd=null}Wc=x(Wc,{Id:`FRECarouselSwitchIcon_${Fc}_${z}`,
ExternalId:`FRECarouselSwitchIcon_${Fc}_${z}`,Command:id,Icon:Dd,FullIconStyle:{["root"]:{position:"absolute",width:"100%",height:"100%"}},Role:"button",Alt:ya(Fc),LabelText:Fc===Yh.Wja?`${T+1} of ${z}`:null});Wc=x(tj,{SectionId:"FRECarouselSwitchIconSection_"+Fc,GalleryButtons:[Wc]});return x(mk.a,{Id:"FRECarouselSwitchButton_"+Fc,ExternalId:"FRECarouselSwitchButton_"+Fc,GalleryStyle:{["galleryStack"]:{["root"]:{position:"absolute",maxWidth:"unset",width:Fc===Yh.Wja?"35px":"16px",height:"18px",padding:"0px",
zIndex:Fc===Yh.Wja?"2":"3",top:"79px",left:Fc===Yh.LEFT?"267px":Fc===Yh.Wja?"279px":"309px",borderRadius:Fc===Yh.LEFT?"18px 0px 0px 18px":Fc===Yh.Wja?"none":"0px 18px 18px 0px",backgroundColor:"var(--legacy_themeDarker)"},["inner"]:{margin:"0px",width:Fc===Yh.Wja?"34px":"18px",height:"18px"}}},Type:4,GallerySections:[Wc],DismissHostingSurfaceOnExecute:!1})}),cc,x(mk.a,{Id:"FRECarouselDescription",ExternalId:"FRECarouselDescription",GalleryStyle:{["galleryStack"]:{["root"]:{["maxWidth"]:"100%",["padding"]:"0px",
["cursor"]:"pointer"},["inner"]:{["padding"]:"2px",["flex-wrap"]:"nowrap"}},["galleryButtonInExpanded"]:{["root"]:{"white-space":"normal",backgroundColor:"transparent",textAlign:"left",width:"unset",height:"unset",fontWeight:500,fontSize:13,padding:"4px 6px 8px"},["flexContainer"]:{},["label"]:{}}},Type:4,GallerySections:[x(tj,{SectionId:"FRECarouselDescriptionSection",GalleryButtons:[x(yj.a,{Id:"FRECarouselDescriptionIcon",Command:cg.a.Y0c.toString(),ExternalId:"FRECarouselDescriptionIcon",FullIconStyle:{["root"]:{["display"]:"none"}},
Alt:k(d),Role:"button",LabelText:k(d)}),x(yj.a,{Id:"FRECarouselDescriptionIconView",Command:cg.a.Y0c.toString(),ExternalId:"FRECarouselDescriptionIconView",FullIconStyle:{["root"]:{["display"]:"none"}},Alt:v(),Role:"button",LabelText:v()})]})],DismissHostingSurfaceOnExecute:!1})]})}function C(d,z,T){c(d,z?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${T}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        margin-bottom: 5px;

        [id$="ErrorView"] {
          width: 100%;
          height: 102px;
          display: flex;
          flex-direction: row;

          >i {
            width: 100%;
            height: 102px;
            margin-left: 20px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin-top: 0;

            >label {
              font-weight: 600;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button[role="menuitem"] {
          margin-left: 0px;
          width: 100%;
          padding: 15px 13px;
          box-sizing: border-box;

          >i {
            border: none;
            min-width: 36px;
            height: 36px;
            padding: 3px;
            background-color: #fff;
          }

          >div>div>span {
            white-space: normal;
            text-align: left;
            margin-bottom: 5px;
          }

          &:hover {
            background-color: transparent;
            border-color: transparent;
          }

          &:focus {
            background-color: transparent;
          }
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${T}) {
          button[role="menuitem"] {
            &:hover {
              background-color: highlight;
            }
          }
        }
      }
    }
  }
  `:"")}function B(d,z,T){c(d,z?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${T}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        padding-bottom: 5px;

        [id$="ErrorView"] {
          width: 100%;
          height: 100%;
          display: flex;
          flex-direction: column;

          >i {
            width: 100%;
            height: 102px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin: 0;
            padding: 0;
            width: 100%;

            [id="AddInFlyoutPopularBannerGroupMessage"] {
              min-width: 100%;
              padding: 8px 12px 4px 12px;
              font-weight: 600;
              font-size: 12px;
              line-height: 16px;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button[role="menuitem"] {
          width: 306px;
          padding: 4px 8px;
          margin: 6px 12px 8px 12px;
          box-sizing: border-box;
          background-color: var(--colorNeutralBackground1);

          >div>div {
            font-size: 12px;

            >span {
              white-space: normal;
              text-align: left;
              font-size: 12px;
              font-weight: 600;
              line-height: 16px;
            }
          }
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${T}) {
          button[role="menuitem"] {
            background-color: transparent;

            &:hover {
              background-color: highlight;
            }
          }
        }
      }
    }
  }
  `:"")}function E(d,z){if(!d)switch(z){case "Word":return["wa200005502","wa200001011","wa200000368"];case "Excel":return["wa200005502"];case "PowerPoint":return["wa200005566"];default:return[]}return d.split("|")}function K(d,z){var T;return(null===(T=Wa()[d])||void 0===T?void 0:T[z])||Wa().jJk[z]||""}function F(d,z){a:{var T=z.solutionId;switch(null===T||void 0===T?void 0:T.toLowerCase()){case "wa200005502":if("Word"===d){T="FREWordBannerGPTForExcelWord";break a}if("Excel"===d){T="FREBannerGPTForExcelWord";
break a}}T="FlyoutBannerCommon"}a:{var ya;switch(d){case "Excel":d="Boost your productivity in Excel with this ChatGPT add-in.";break a;case "PowerPoint":d=null!==(ya=Object(Nb.a)("AddinsFlyoutFREDescriptionPPT"))&&void 0!==ya?ya:"Elevate your slides! Add-ins for flawless presentations.";break a;default:d="Boost your productivity in Word with this ChatGPT add-in."}}z=x(Yj.a,{Id:"AddInFlyoutPopularBannerAction",iconSet:null,ExternalId:"AddInFlyoutPopularBannerAction",CommandId:"AddInFlyoutPopularBannerAction",
CommandIdMapped:cg.a.h3a.toString(),SecondaryLabel:null,Label:d,ActionText:Object(Nb.a)("AddinListAdd"),Links:[x(nk,{text:Object(Nb.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+z.solutionId})],ActionId:cg.a.fya.toString(),ActionIdMapped:cg.a.fya.toString(),ActionCommandValueId:z.solutionId,CommandValueId:z.solutionId});z=[x(Ej.a,{Id:"AddInFlyoutPopularBanner",ExternalId:"AddInFlyoutPopularBanner",IconName:T}),z];return x(N.a,{ControlList:z})}function W(d){d.MenuSectionList.some(z=>
z.ControlList.some(T=>"AddInFlyoutPopularBanner"===T.Id))||C("PopularBanner",!1,-1)}function J(d){d.MenuSectionList.some(z=>z.ControlList.some(T=>"AddInFlyoutPopularBannerGroup"===T.Id))||B("PopularBannerGroup",!1,-1)}function L(d,z,T,ya,sb,cc,Fc){ya.concat(sb).find(Wc=>Wc.solutionId.toLowerCase()===d.solutionId.toLowerCase())?z.MenuSectionList.push(T):(ya=F(Fc,d))?(sb=z.MenuSectionList.some(Wc=>"MRUAddinsSection"===Wc.Id),cc=cc&&sb?2:3,z.MenuSectionList.push(x(N.a,Object.assign({},T,{ControlList:T.ControlList.slice(0,
cc)}))),z.MenuSectionList.push(ya),C("PopularBanner",!0,z.MenuSectionList.length),z.MenuSectionList.push(x(N.a,Object.assign({},T,{ControlList:T.ControlList.slice(cc),Title:null})))):z.MenuSectionList.push(T)}function M(d,z){z=z.filter(ya=>!!ya&&!!ya.solutionId).map(ya=>{const sb=`${"AddInFlyoutPopularBannerGroup"}_${ya.solutionId}`;return x(Yj.a,{Id:sb,ExternalId:sb,CommandId:sb,CommandIdMapped:cg.a.h3a.toString(),iconSet:{default:"AddinFlyoutControl"+ya.solutionId},SecondaryLabel:null,Label:ya.displayName,
Description:ya.description,ActionText:Object(Nb.a)("AddinListAdd"),Links:[x(nk,{text:Object(Nb.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+ya.solutionId})],ActionId:cg.a.fya.toString(),ActionIdMapped:cg.a.fya.toString(),ActionCommandValueId:ya.solutionId,CommandValueId:ya.solutionId})});var T="Word"===d?"FREWordBannerAI":"FlyoutBannerCommon";d=K(d,"IPWAI");d=[x(Ej.a,{Id:"AddInFlyoutPopularBannerGroup",ExternalId:"AddInFlyoutPopularBannerGroup",IconName:T,Label:d,
AriaDescription:d}),...z];return x(N.a,{ControlList:d})}function Q(d,z,T,ya,sb,cc,Fc){d=null===d||void 0===d?void 0:d.filter(Wc=>!!Wc&&!!Wc.solutionId);if(0!==(null===d||void 0===d?void 0:d.length)){ya=ya.concat(sb);if(0<(null===ya||void 0===ya?void 0:ya.length)){const Wc=ya.filter(id=>!!id&&!!id.solutionId).map(id=>id.solutionId.toLowerCase());d=d.filter(id=>!Wc.includes(id.solutionId.toLowerCase()))}0<(null===d||void 0===d?void 0:d.length)?(Fc=M(Fc,d))?(ya=z.MenuSectionList.some(Wc=>"MRUAddinsSection"===
Wc.Id),cc=cc&&ya?2:3,z.MenuSectionList.push(x(N.a,Object.assign({},T,{ControlList:T.ControlList.slice(0,cc)}))),z.MenuSectionList.push(Fc),B("PopularBannerGroup",!0,z.MenuSectionList.length),z.MenuSectionList.push(x(N.a,Object.assign({},T,{ControlList:T.ControlList.slice(cc),Title:null}))),Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutShowBannerGroupInPopular",dataFields:rd.a.NOa({["addins"]:null===d||void 0===d?void 0:d.map(Wc=>Wc.solutionId)})})):z.MenuSectionList.push(T):
z.MenuSectionList.push(T)}}function H(d){const z=document.createElement("div");z.innerHTML=`
  ${'<svg style="animation: addin-flyout-bounce 1.5s infinite;" width="16" height="10" viewBox="0 0 9 6" xmlns="http://www.w3.org/2000/svg">\n  <path class=\'OfficeIconColors_HighContrast\' d="M7.89612 4.86822C8.09952 5.07162 8.42929 5.07162 8.63269 4.86822C8.83609 4.66482 8.83609 4.33505 8.63269 4.13165L4.86926 0.36822C4.76734 0.266293 4.63367 0.215444 4.50008 0.215672C4.36676 0.215652 4.23343 0.266502 4.13171 0.368221L0.368285 4.13165C0.164887 4.33505 0.164887 4.66482 0.368285 4.86822C0.571683 5.07162 0.901456 5.07162 1.10485 4.86822L4.50049 1.47259L7.89612 4.86822Z"/>\n  <path style="fill: var(--colorNeutralForeground1)" d="M7.89612 4.86822C8.09952 5.07162 8.42929 5.07162 8.63269 4.86822C8.83609 4.66482 8.83609 4.33505 8.63269 4.13165L4.86926 0.36822C4.76734 0.266293 4.63367 0.215444 4.50008 0.215672C4.36676 0.215652 4.23343 0.266502 4.13171 0.368221L0.368285 4.13165C0.164887 4.33505 0.164887 4.66482 0.368285 4.86822C0.571683 5.07162 0.901456 5.07162 1.10485 4.86822L4.50049 1.47259L7.89612 4.86822Z"/>\n  </svg>'}
  <div style="font-weight: 600; font-size: 18px; font-family: "Segoe UI Semibold", "Segoe UI Semibold_EmbeddedFont", "Segoe UI Semibold_MSFontService", sans-serif;">${d}</div>`;return z}function ba(){const d=[];document.body.querySelectorAll('\n  [id="Ribbon-InsertAddInFlyoutDropdown"] [class^="container-"], [id="InsertAddInFlyoutMenuId"] [class^="container-"]').forEach(z=>{d.push(z)});return d}function U(){c("AppsFlyoutScrollIndicator","\n  @keyframes addin-flyout-bounce {\n    0% {\n      transform: translateY(0);\n    }\n    50% {\n      transform: translateY(-5px);\n    }\n    100% {\n      transform: translateY(0);\n    }\n  }\n  ");
f(d=>{var z;if(d&&!("MRUAddinsGalleryControl"in appChrome.selectors.getFlyoutAnchorMenuItems("InsertAddInFlyout"))){var T=ba();if(0!==T.length){d=ya=>{if(!(0>=ya.deltaY)){ya=ya.currentTarget;var sb=ya.querySelector("#apps-flyout-scroll-indicator");!sb||10>ya.scrollTop||(sb.style.opacity="0",Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutFREScrolled"}))}};for(const ya of T)ya.style.position="relative",ya.removeEventListener("wheel",d),ya.addEventListener("wheel",d),null===(z=ya.querySelector("#apps-flyout-scroll-indicator"))||
void 0===z?void 0:z.remove(),T=H(Object(Nb.a)("AddinsFlyoutScrollDownHintText")||"Scroll up to explore more!"),T.setAttribute("style","pointer-events: none; transition: all 0.5s ease-out; padding: 30px 0 5px 0; width: 100%; position: fixed; left: 0; bottom: 69px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: linear-gradient(rgb(from var(--colorNeutralBackground1) r g b / 0%) 5px, rgb(from var(--colorNeutralBackground1) r g b / 80%), rgb(from var(--colorNeutralBackground1) r g b / 90%));"),
T.id="apps-flyout-scroll-indicator",ya.appendChild(T)}}})}a.r(u);var D={};a.r(D);a.d(D,"AgaveCommandHandler",function(){return za});var I={};a.r(I);a.d(I,"AgaveListenerHandler",function(){return Ca});var X={};a.r(X);a.d(X,"AgaveOnSelectedReadoutHandler",function(){return Ka});var Y={};a.r(Y);a.d(Y,"DdaMethodHandler",function(){return ff});var ja={};a.r(ja);a.d(ja,"MacroRecorderEventHandler",function(){return bj});var Ua={};a.r(Ua);var ka={};a.r(ka);a.d(ka,"SmartLookupCommandHandler",function(){return Bh});
var fb=a(135),ha=a(0),ea=a(6),aa=a(942),ca=a(23),xa=a(25),Oa=a(39),ua=a(1),Ia=a(211),Sa=a(36),Ya=a(359),da=a(5),Ea=a(773),oa=a(95);let za=class{constructor(d,z){this.$=d;this.agaveCommandManager=z;this.ha=ca.f(this.$).ha;this.qa=this.ha.qa}dj(){return!1}Ri(){return!1}Gi(d,z,T,ya){let sb=!1;switch(z.command){case -684355545:sb=!0;break;case -741808261:sb=!!T;break;case -859308420:sb=!!ya&&1===ya.AO;break;case 418618014:sb=1===d&&!!ya&&1===ya.AO;break;case -167264441:sb=xa.a.iWb(this.$)&&1===d&&!!ya&&
1===ya.AO;break;case -515602470:sb=1===d&&!!ya&&1===ya.AO;break;case -1444574190:case -336193495:sb=1===d&&!!ya&&1===ya.AO;break;case 1296389134:sb=1===d&&!!ya&&1===ya.AO;break;case 1221897806:sb=ua.EwaSettings.Ra(155)&&2===d;break;case 1172793074:case 1930653487:sb=ua.EwaSettings.Ra(155)&&2===d;break;case -1753056834:sb=!0;break;case 932597253:sb=!0;break;case 301511274:sb=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:sb=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!0)&&this.$.isEditMode;break;case 1723441034:sb=this.$.isEditMode&&this.$.ea.n8b;break;case -1997160483:sb=xa.a.hV()&&this.$.isEditMode&&this.qa.XI();break;case 1485761473:sb=xa.a.hV()&&this.$.isEditMode;break;case 762629271:sb=xa.a.hV()&&ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")}return sb}executeCommand(d,z,T){d=Oa.TaskExtensions.Gq();const ya=z.command;switch(z.command){case 1296389134:ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",
!1)&&aa.a.instance.getItem("removeFlyoutTaskTimeoutId")&&(window.clearTimeout(Number(aa.a.instance.getItem("removeFlyoutTaskTimeoutId"))),aa.a.instance.removeItem("removeFlyoutTaskTimeoutId"));this.agaveCommandManager.LUk(T.SourceControlId,T.LabelText);break;case -684355545:this.agaveCommandManager.Lud();break;case -741808261:d=this.agaveCommandManager.insertAgave(T,z);break;case 1172793074:ua.EwaSettings.Ra(155)&&(d=this.agaveCommandManager.AQd(T,z));break;case -1997160483:case 1485761473:if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")&&
this.Fhi()){this.t5h();break}xa.a.MVd()&&void oa.a.resolve(da.ib,{va:0}).then(sb=>{sb.y3c(!0)});d=this.agaveCommandManager.AQd(T,z);break;case -859308420:case -515602470:case -167264441:case -336193495:case -1444574190:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:case 762629271:d=this.agaveCommandManager.AQd(T,z);ua.EwaSettings.hS()&&this.$.JCa();break;default:d=Ia.a(ya)}return d}Fhi(){var d=this.$.uk;const z=d.get(1),
T=d.get(4);d=d.get(117);return(z||T)&&!d}t5h(){const d=Sa.a.nj(1,1,751,2407,0,0,"CopilotNoExtractPermissionsErrorDialog");new Ya.a(this.$,d)}};za=Object(fb.__decorate)([Object(oa.d)(da.h),Object(fb.__param)(0,Object(da.Nb)()),Object(fb.__param)(1,Object(Ea.a)())],za);Object(ha.a)(za,"AgaveCommandHandler",null,[34]);var la=a(15);let Ca=class{constructor(d){this.$=d;this.RPf=z=>{if(null!==z&&void 0!==z&&z.data&&(z=z.data)&&"OfficeCopilotExcelTaskPane"===z.Origin)switch(z.Event){case "Office.Excel.Copilot.AnalyzeReceived":this.dda(-168711560);
break;case "Office.Excel.Copilot.GenerateReceived":this.dda(-1805433217);break;case "Office.Excel.Copilot.CommandReceived":this.dda(-112212005);break;case "Office.Excel.Copilot.AnalyzeApplied":this.dda(347349230);break;case "Office.Excel.Copilot.GenerateApplied":this.dda(-2005275355);break;case "Office.Excel.Copilot.CommandApplied":this.dda(306959157);break;default:la.ULS.sendTraceTag(508044939,0,10,"AgaveListenerHandler.handleMessageReceived - Unhandled Event.")}}}addListener(){window.addEventListener("message",
this.RPf,!1)}removeListener(){window.removeEventListener("message",this.RPf,!1)}dda(d){this.$.si(d,-1,0,null)}};Ca=Object(fb.__decorate)([Object(oa.d)(da.i),Object(fb.__param)(0,Object(da.Nb)())],Ca);Object(ha.a)(Ca,"AgaveListenerHandler",null,[]);var Va=a(94),ia=a(355),wa=a(153),Jb=a(58),$a=a(54);let Ka=class{constructor(d,z){this.i6a=this.j6a=null;this.k2g=(T,ya)=>{let sb=null,cc=null,Fc=null;ya?(Object(ia.a)(270,ya)?(sb=ya.AIb,Fc=ya.instanceId):Object(ia.a)(406,ya)&&(sb=ya.get_element(),Fc=ya.instanceId),
sb)?(cc=Object(wa.a)(273,T),cc)?this.lBg(Fc,sb,cc)||Fc in this.i6a||(this.j6a[Fc]=0,this.i6a[Fc]=Jb.a.instance.LO(()=>{10<=this.j6a[Fc]||this.lBg(Fc,sb,cc)?(delete this.j6a[Fc],this.i6a[Fc].dispose(),delete this.i6a[Fc]):this.j6a[Fc]+=1},500,$a.a.qGh,!0,!1)):la.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):la.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):la.ULS.sendTraceTag(537170626,0,10,
"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=d;this.$=z;this.jsd=!1}Ba(d){this.jsd?la.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.jsd=!0,this.i6a={},this.j6a={},d?d.QBh(this.k2g):la.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(d){if(d){d.gmk(this.k2g);d=this.i6a;for(const z in d)Va.a.dh(d[z]);this.j6a=this.i6a=null;this.jsd=!1}else la.ULS.sendTraceTag(537170627,
0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}lBg(d,z,T){if(this.Pgj(T,d))return!1;d=z.querySelector("iframe");if(!d)return la.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;d=d.title;if(!d||!d.length)return la.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(d);return!0}Pgj(d,z){return(d=d.Cl.getOsfControl(z))?
d.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};Ka=Object(fb.__decorate)([Object(oa.d)(da.j),Object(fb.__param)(0,Object(da.l)()),Object(fb.__param)(1,Object(da.Nb)())],Ka);Object(ha.a)(Ka,"AgaveOnSelectedReadoutHandler",null,[407]);var nb=a(940),sa=a(1513);class na{constructor(){this.context=null;this.errorCode=0}}Object(ha.a)(na,"NestedAppAuthContextResult",null,[]);class ab{static hNd(d,z){const T=new na;(d=d.getOsfControl(z))&&d.isFirstParty()?(T.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
d={},z=ea.AFrameworkApplication.fa.Ya("AADUserObjectId"),d.userObjectId=z?z:ea.AFrameworkApplication.fa.Ya("LoggableUserId"),d.userPrincipalName=ea.AFrameworkApplication.fa.Ya("UserPrincipalName"),d.tenantId=ea.AFrameworkApplication.fa.Ya("TenantId"),d.puid=ea.AFrameworkApplication.fa.Ya("Puid"),d.authorityBaseUrl=ea.AFrameworkApplication.fa.Ya("HostAuthAuthority"),z=(ea.AFrameworkApplication.fa.Ya("HostAuthType")||"").toLowerCase(),d.authorityType="aad"===z?"aad":"msa"===z?"msa":"other",T.context=
d):T.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return T}}Object(ha.a)(ab,"NestedAppAuthUtil",null,[]);var Ja=a(1122),Pa=a(1257),hb=a(1174);class ac{}ac.generalException="generalException";ac.invalidArgument="invalidArgument";ac.kfg="notAllowed";ac.Nnc="apiNotAvailable";ac.Z5k="unresolvedPendingRequest";ac.timeout="timeout";ac.cod="adalTimeout";ac.cBe="userNotSignedIn";ac.Wzb="userAborted";ac.GWg="silentSignInFailed";ac.ynb="invalidResourceUrl";ac.QFc="invalidGrant";ac.tif="connectionLost";
ac.qrc="clientError";ac.serverError="serverError";Object(ha.a)(ac,"WopiHostErrorCodes",null,[]);var Hc=a(928),bd=a(602);class zc{}Object(ha.a)(zc,"OAuthCallerMetadata",null,[]);var oc=a(35),Nb=a(22);class Aa{constructor(d){this.vza=d;this.Qkh=ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}fwh(d,z,T,ya,sb,cc){if(!this.vza)return ya=new Pa.a,ya.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(ya);const Fc=new zc;
Fc.AddinName=sb;Fc.AddinTrustId=cc;let Wc=-1,id=-1;cc=null;const Dd=ea.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.EnableAddinPopupTimerTelemetry"),ee=(re,Ce,mf,tf,Df)=>{const sf=Date.now();return this.vza.y2c(re,Ce,mf,tf,Df).then($f=>{id=Date.now()-sf;return $f})};if(ya&&this.R_f())cc=Dd?ee(Hc.a.Jyb,d,ya,Aa.aCc(sb),Fc):this.vza.y2c(Hc.a.Jyb,d,ya,Aa.aCc(sb),Fc);else{const re=Date.now();cc=this.vza.gE(Hc.a.Jyb,d,Fc).then(Ce=>{Wc=Date.now()-re;const mf=(z||
T)&&("login_required"===Ce.ErrorCode||"Cookies Disabled"===Ce.ErrorCode);return(z&&("interaction_required"===Ce.ErrorCode||"consent_required"===Ce.ErrorCode||"invalid_grant"===Ce.ErrorCode||"UserInteractionRequired"===Ce.ErrorCode)||mf)&&this.R_f()?Dd?ee(Hc.a.Jyb,d,null,Aa.aCc(sb),Fc):this.vza.y2c(Hc.a.Jyb,d,null,Aa.aCc(sb),Fc):Promise.resolve(Ce)})}return cc.then(re=>{const Ce=new Pa.a;re.IsSuccess?(Ce.token=re.Token,re.Telemetry&&(Ce.TQa=re.Telemetry.fromCache,Ce.expiresOn=re.Telemetry.expiresOn)):
(Ce.errorCode=this.pEj(re),Ce.zwe=this.v4j(re));return Ce}).catch(()=>{const re=new Pa.a;re.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(re)}).then(re=>{re.Aua="OauthManager";0<=Wc&&(re.AKa=Wc);0<=id&&(re.LSb=id);return re})}ikj(d){const z=(ea.AFrameworkApplication.fa.Ya(ea.AFrameworkApplication.a_)||"").toLowerCase();return(ea.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.Enable3rdPartySsoApiForTeams")||!(oc.a.ZLa||
"teams"===z&&bd.a.cUb)||Aa.Pjj(d))&&this.vza&&this.vza.f1a()?!0:!1}R_f(){return this.Qkh||1!==hb.a.Pzc()}pEj(d){switch(d.ErrorCode){case "UserCancelled":case "interaction_required":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "UserInteractionRequired":case "consent_required":case "invalid_grant":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":d=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":d=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:d=d.ErrorCode===ac.Wzb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:d.ErrorCode===ac.GWg?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:d.ErrorCode===ac.ynb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:d.ErrorCode===
ac.QFc?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:d.ErrorCode===ac.tif?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return d}v4j(d){let z="";(d=RegExp("AADSTS(\\d+)").exec(d.ErrorMessage))&&1<d.length&&(z=d[1]);return z}static aCc(d){return String.format(Object(Nb.a)("SSOSignInNeededNotification_Description_Text_Addins"),d)}static Pjj(d){if(!d)return!1;d=d.toLowerCase();for(const z of sa.a.oAf)if(z===d)return!0;return!1}}
Object(ha.a)(Aa,"AppsforOfficeTokenFromOauthManager",null,[299]);class Ub{constructor(d){this.rDj=d}static NCa(){if(ea.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var d=null;try{d=Object(Ja.a)()}catch(z){la.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+z)}d=new Aa(d);Ub.Va=new Ub(d)}}static getInstance(){Ub.VNe||(Ub.NCa(),Ub.VNe=!0);return Ub.Va}}Ub.Va=null;Ub.VNe=!1;Object(ha.a)(Ub,"AppsForOfficeOauthManagerFactory",null,[290]);var Db=a(42),Ib=a(189),yc=a(1433),
xc=a(188);class zb{constructor(d,z,T,ya){this.menuItemId=d;this.gF=z;this.cWk=T;this.pvi=ya}}Object(ha.a)(zb,"NewDocumentParameters",null,[]);var vb=a(10);const bb=d=>{var z=d.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var T=z.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);T.addParameter("shortcuts","String[]",1,null,0);z.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);T=z.addMethod("ReplaceShortcuts",
2,"Void",0,0,"ReplaceShortcuts",0);T.addParameter("shortcuts","Object",1,null,0);z=d.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);T=z.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);T.addParameter("pickerCustomizationJsonString","String",1,null,0);z=d.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);T=z.addMethod("GetAccessTokenFirstPartyOAuth",
1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);T.addParameter("appName","String",1,null,0);T.addParameter("target","String",1,null,0);z=d.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);z.addProperty("Data",4,"String",1,!1,null,0);z=d.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);T=z.addMethod("SendMessage",1,
"Void",0,1,"SendMessage",4);T.addParameter("data","String",1,null,0);z.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);z.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);z=d.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);z.addProperty("BatchId",6,"String",1,!1,null,0);z=d.addType("Microsoft.Office.UndoService",
"{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);T=z.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);T.addParameter("batchId","String",1,null,0);T=z.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);T.addParameter("batchId","String",1,null,0);z.addMethod("Undo",1,"Boolean",1,0,"Undo",4);z.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);z.addMethod("_UnregisterUndoStackChangedEvent",
3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);z=d.addEnumType("Microsoft.Office.UserFeedbackType");z.addEnumField("Like",0);z.addEnumField("Dislike",1);z.addEnumField("Idea",2);z.addEnumField("Unclassified",3);z=d.addEnumType("Microsoft.Office.UserFeedbackUIType");z.addEnumField("ModalDialog",0);z.addEnumField("Taskpane",1);z=d.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);z.addMethod("CanCollectUserFeedback",
27,"Boolean",1,1,"CanCollectUserFeedback",4);T=z.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);T.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);T.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);T.addParameter("featureArea","String",1,null,0);T.addParameter("options","Object",1,null,0);z.addMethod("_RegisterUserFeedbackResponseEvent",28,"Void",0,1,"_RegisterUserFeedbackResponseEvent",4);z.addMethod("_RegisterUserFeedbackUIDismissedEvent",
18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);z.addMethod("_UnregisterUserFeedbackResponseEvent",29,"Void",0,1,"_UnregisterUserFeedbackResponseEvent",4);z.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);z=d.addType("Microsoft.Office.NotificationService","{d9d9f329-4dbd-46fd-937d-8534fca075f2}","{f665e4ed-18e6-496d-9693-4622a232c1bc}",3,2);T=z.addMethod("AddNotification",1,"String",1,0,"AddNotification",4);T.addParameter("props",
"String",1,null,0);T.addParameter("options","String",1,null,0);T=z.addMethod("RemoveNotification",3,"Void",0,0,"RemoveNotification",4);T.addParameter("id","String",1,null,0);T=z.addMethod("UpdateNotification",2,"Void",0,0,"UpdateNotification",4);T.addParameter("id","String",1,null,0);T.addParameter("props","String",1,null,0);z=d.addType("Microsoft.Office.SensitivityLabelInfo","{9c48b796-11fa-4374-9910-4495541ed32f}","{57df5dd1-1d5c-49c2-954e-54cdce9d6082}",2,0);z.addProperty("Color",15,"String",1,
!1,null,0);z.addProperty("Description",13,"String",1,!1,null,0);z.addProperty("DisplayName",12,"String",1,!1,null,0);z.addProperty("EncryptionType",8,"Microsoft.Office.EncryptionType",1,!1,null,0);z.addProperty("HasExtractForUser",10,"Boolean",1,!1,null,0);z.addProperty("IsDke",9,"Boolean",1,!1,null,0);z.addProperty("IsEnabled",7,"Boolean",1,!1,null,0);z.addProperty("LabelId",5,"String",1,!1,null,0);z.addProperty("Order",11,"Int32",1,!1,null,0);z.addProperty("ParentName",14,"String",1,!1,null,0);
z.addProperty("TenantId",6,"String",1,!1,null,0);z.addProperty("Version",4,"Int32",1,!1,null,0);z=d.addType("Microsoft.Office.SensitivityLabelChangedEventArgs","{ca0930bd-14ec-4274-baf8-b0d81b2cd6af}","{afcf1725-5270-469f-91c8-ad4f0268a459}",2,0);z.addProperty("Context",20,"String",1,!1,null,0);z.addProperty("Error",21,"Microsoft.Office.TryUpgradeLabelError",1,!1,null,0);z.addProperty("NewLabel",19,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);z.addProperty("PreviousLabel",18,"Microsoft.Office.SensitivityLabelInfo",
2,!1,null,0);z=d.addType("Microsoft.Office.SensitivityService","{c7d4ae5b-a48c-4bfd-bf0b-1532a604d330}","{774bff62-b736-4038-a7a8-7bc1eeef213e}",3,2);T=z.addMethod("GetHighestSensitivityLabel",3,"Microsoft.Office.SensitivityLabelInfo",2,0,"HighestSensitivityLabel",4);T.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo[]",2,null,0);z.addMethod("GetLabel",1,"Microsoft.Office.SensitivityLabelInfo",2,0,"Label",4);T=z.addMethod("TryUpgradeLabel",2,"Void",0,0,"TryUpgradeLabel",
4);T.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo",2,null,0);T.addParameter("context","String",1,null,0);z.addMethod("_RegisterSensitivityLabelChangedEvent",16,"Void",0,1,"_RegisterSensitivityLabelChangedEvent",4);z.addMethod("_UnregisterSensitivityLabelChangedEvent",17,"Void",0,1,"_UnregisterSensitivityLabelChangedEvent",4);z=d.addType("Microsoft.Office.CopilotService","{d81cdd7f-f828-45a1-89fd-b1f6d0af7f76}","{c86a3d8f-7782-4ef9-8ded-2b569327f30c}",3,2);T=z.addMethod("LaunchHelpPaneByArticleId",
2,"Void",0,0,"LaunchHelpPaneByArticleId",4);T.addParameter("articleId","Int32",1,null,0);T=z.addMethod("LaunchHelpPaneByArticleIdString",3,"Void",0,0,"LaunchHelpPaneByArticleIdString",4);T.addParameter("articleId","String",1,null,0);T=z.addMethod("LaunchHelpPaneByQuery",1,"Void",0,0,"LaunchHelpPaneByQuery",4);T.addParameter("query","String",1,null,0);z=d.addEnumType("Microsoft.Office.BusinessBarType");z.addEnumField("Info",0);z.addEnumField("Error",1);z.addEnumField("Blocked",2);z.addEnumField("SevereWarning",
3);z.addEnumField("Success",4);z.addEnumField("Warning",5);z=d.addType("Microsoft.Office.BusinessBarShowArgs","{9cd04f48-f89b-4720-affd-b69cda192318}","{fb97b13e-bd55-46f2-a1bc-92cf8525546f}",2,0);z.addProperty("HideCloseButton",6,"Boolean",1,!1,null,0);z.addProperty("Message",4,"String",1,!1,null,0);z.addProperty("MessageType",5,"Microsoft.Office.BusinessBarType",1,!1,null,0);z.addProperty("Title",3,"String",1,!1,null,0);z=d.addType("Microsoft.Office.BusinessBarService","{0234fef7-ca58-4b3e-9ae8-6972ccf29564}",
"{8787e4f8-8270-480c-8721-5854ecbc8227}",3,2);T=z.addMethod("Hide",2,"Void",0,0,"Hide",4);T.addParameter("caller","String",1,null,0);T=z.addMethod("Show",1,"Void",0,0,"Show",4);T.addParameter("caller","String",1,null,0);T.addParameter("options","Microsoft.Office.BusinessBarShowArgs",2,null,0);z=d.addEnumType("Microsoft.Office.SimpleDialogCategory");z.addEnumField("information",0);z.addEnumField("error",1);z.addEnumField("warning",2);z.addEnumField("question",3);z.addEnumField("other",4);z=d.addType("Microsoft.Office.ShowSimpleDialog",
"{55fc9dc0-9f07-4859-8ba1-f33c353972da}","{f55bd118-7884-4f60-9e0e-e3a7972b7ecb}",3,2);T=z.addMethod("LaunchSimpleDialog",1,"Microsoft.Office.SimpleDialogState",1,0,"LaunchSimpleDialog",4);T.addParameter("title","String",1,null,0);T.addParameter("description","String",1,null,0);T.addParameter("telemetryid","String",1,null,0);T.addParameter("Category","Microsoft.Office.SimpleDialogCategory",1,null,0);T.addParameter("hasButton","Boolean",1,null,0);T.addParameter("buttonLabel","String",1,null,0);T.addParameter("hasCheckbox",
"Boolean",1,null,0);T.addParameter("checkboxLabel","String",1,null,0);z=d.addType("Microsoft.Office.DispatchApiService","{1e3afc74-fb27-4b5d-a37b-fda697c46f78}","{82297de7-ac3a-4ee2-853d-26598d2e90e2}",3,2);T=z.addMethod("Execute",1,"String",1,1,"Execute",4);T.addParameter("apiName","String",1,null,0);T.addParameter("paramsData","String",1,null,0);z=d.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);T=z.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",
0);T.addParameter("base64File","String",1,null,0);z=d.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);z.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);T=z.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);T.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);z=d.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}",
"{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);z.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);T=z.addMethod("Register",1,"Void",0,0,"Register",0);T.addParameter("metadata","String",1,null,0);T.addParameter("javascript","String",1,null,0);z=d.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);z.addProperty("Enabled",1,"Boolean",1,!1,null,0);z.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);z.addProperty("StreamingEnabled",
2,"Boolean",1,!1,null,0);z=d.addEnumType("Microsoft.Authentication.IdentityType");z.addEnumField("OrganizationAccount",0);z.addEnumField("MicrosoftAccount",1);z=d.addEnumType("Microsoft.Authentication.AuthorityType");z.addEnumField("External",0);z.addEnumField("Msa",1);z.addEnumField("Aad",2);z=d.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);z.addProperty("DisplayName",4,"String",1,!1,null,0);z.addProperty("Email",
3,"String",1,!1,null,0);z.addProperty("FederationProvider",2,"String",1,!1,null,0);z.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);z=d.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);z.addProperty("AppId",4,"String",1,!1,null,0);z.addProperty("Authority",2,"String",1,!1,null,0);z.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);z.addProperty("IsAnonymous",
5,"Boolean",1,!1,null,0);z.addProperty("TenantId",6,"String",1,!1,null,0);z.addProperty("Upn",1,"String",1,!1,null,0);z=d.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);z.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);T=z.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);T.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",
2,null,0);z.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);z.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);z=d.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);z.addProperty("AuthChallenge",3,"String",1,!1,null,0);z.addProperty("CorrelationId",7,"String",1,!1,null,0);z.addProperty("Policy",4,"String",1,
!1,null,0);z.addProperty("Resource",2,"String",1,!1,null,0);z.addProperty("Scope",5,"String",1,!1,null,0);z.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);z=d.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);z.addProperty("AccessToken",2,"String",1,!1,null,0);z.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);z=d.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}",
"",3,0);z.addProperty("Id",1,"String",1,!0,null,0);z.addProperty("Value",2,"Object",1,!1,null,0);z=d.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);T=z.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);T.addParameter("id","String",1,null,0);T=z.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);T.addParameter("id","String",1,null,0);z=d.addType("Microsoft.AppRuntime.AppRuntimeService",
"{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);z.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);T=z.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);T.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);z=d.addEnumType("Microsoft.AppRuntime.AppRuntimeState");z.addEnumField("Inactive",0);z.addEnumField("Background",1);z.addEnumField("Visible",2);z=d.addEnumType("Microsoft.AppRuntime.Visibility");
z.addEnumField("Hidden",1);z.addEnumField("Visible",2);z=d.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);z.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);T=z.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);T.addParameter("jsonCreate","String",1,null,0);T=z.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);T.addParameter("jsonUpdate",
"String",1,null,0);T=z.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);T.addParameter("id","String",1,null,0);T=z.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);T.addParameter("id","String",1,null,0);z.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);z=d.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);z.addProperty("Id",2,"String",1,!0,null,0);T=z.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);T.addParameter("visibility","Boolean",1,null,0);z.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);z=d.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);z.addProperty("Enabled",3,"Boolean",1,!1,null,0);z.addProperty("Id",2,"String",1,!0,null,0);z.addProperty("Label",4,"String",1,!0,null,0);T=z.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);T.addParameter("enabled","Boolean",1,null,0);z.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);z=d.addType("Microsoft.DynamicRibbon.RibbonButtonCollection",
"{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);z.addMethod("GetCount",3,"Int32",1,1,"Count",0);T=z.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);T.addParameter("key","String",1,null,0);z.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);z.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);z=d.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");z.addEnumField("Unknown",0);z.addEnumField("Basic",1);z.addEnumField("Premium",2);z=d.addType("Microsoft.Office.Licensing.License",
"{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);T=z.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);T.addParameter("feature","String",1,null,0);T.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);T=z.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);T.addParameter("feature","String",1,null,0);T=z.addMethod("IsFeatureEnabled",
1,"Boolean",1,1,"IsFeatureEnabled",0);T.addParameter("feature","String",1,null,0);T.addParameter("fallbackValue","Boolean",1,null,0);z.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);T=z.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);T.addParameter("experienceId","String",1,null,0);T=z.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);T.addParameter("feature","String",1,null,0);z=d.addType("Microsoft.Office.Licensing.LicenseFeature",
"{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);z.addProperty("Id",5,"String",1,!0,null,0);z.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);z.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);z=d.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);z.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);z=d.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);z.addMethod("Disable",3,"Void",0,1,"Disable",0);z.addMethod("Enable",2,"Void",0,1,"Enable",0);z.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var La=a(949),pb=a(177);class fa{constructor(d,z){this.pph=d;this.Jph=z}createAndOpenWorkbook(d){if(d&&d.length>this.pph)throw la.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",d.length),OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.invalidArgument,
pb.a.ia(1769));const z=new zb("blank","agave",d?"streamBase64":"streamEmpty",d);let T=null;return OfficeExtension.WacRuntime.Utility.createPromise((ya,sb)=>{const cc=new xc.a,Fc=pb.a.tAc("GeneralAddInMessageDialogTitle"),Wc=pb.a.tAc("NewFileAPIConsentMessage");cc.Ph=4;cc.hp(Fc,Wc,1,id=>{2===id||0===id?sb("Cancelled"):(T=window.open(""),this.Jph.create(ya,sb,z).cib())})}).then(ya=>{if(!ya)throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,pb.a.ia(1765));try{T.top.location.href=
ya}catch(sb){la.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",oc.a.Xv,sb),la.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),T.location.replace(ya)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},ya=>{if("Cancelled"===ya)throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.obe,pb.a.ia(1768));
T.close();this.uZk();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,z){switch(d){case 1:return this.g4h(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}g4h(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.createAndOpenWorkbook(d)}uZk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,pb.a.ia(1765));}}Object(ha.a)(fa,"WacWorkbook",null,[]);const kb=(d,z)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+
typeof d+", objectId="+d+", value="+z);return null},db=d=>{d.add("InternalTest","PreviewExecutionMethod",kb)};var gb=a(287),Kb=a(947),ub=a(948);class lb{constructor(d){this.th=d}get $(){return this.th}}Object(ha.a)(lb,"RichApiPreviewExecutionContext",null,[]);var Ba=a(27),ra=a(73),wb=a(65),mc=a(61),xb=a(46),Ec=a(1260),ed=a(77),jd=a(532),Xd=a(242),Td=a(33),gc=a(246),nc=a(148),dc=a(19),Gc=a(16),vd=a(13),zd=a(28);class Yb extends gc.a{constructor(d,z,T,ya,sb){super(d,"Select Data");this.GJb=null;this.Jnf=
z;this.hBd=T;this.Bi=sb;this.callback=ya}get Di(){return"DdaBindingPrompt"}start(d,z){let T="<div class='"+nc.l+" "+dc.a.oH+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+nc.c+"' /></div>";T=String.format(T,Td.a.Or(this.hBd.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Bi.hr(this.tj,T);this.GJb=Gc.DOMElementExtensions.getElementById(this.tj,"bindingText");d=z?d.nkb(z,this.hBd.DdaBindingsMethod.BindingId):null;(null===d||void 0===
d?0:d.IsValidRef)?(z=new Ba.Range(d.Reference.FirstRow+1,d.Reference.FirstColumn+1,d.Reference.LastRow+1,d.Reference.LastColumn+1,!1,!1),this.GJb.value=d.Reference.SheetName+"!"+z):(d=ca.f(this.$).ha,this.GJb.value=ra.f(this.$.ma)||!d.qa.Bn?"":d.Hva);this.initialize();this.Xs()}dF(){this.dwd();this.addButton(0);this.addButton(1);super.dF()}setFocus(){Gc.DOMElementExtensions.setFocus(this.GJb)}validate(){return!0}commit(){let d=this.GJb.value.trim();const z=d.indexOf("!");-1!==z&&(d=this.OWi(d.substring(0,
z))+d.substr(z));this.Jnf.addBinding(this.hBd,d,0,this.callback);return!0}xKb(){this.Jnf.u0.lo(Kb.a.internalError,this.callback);super.xKb()}OWi(d){d=zd.a.trimStart(d.trim(),"=");return d.length?d.startsWith("'")&&d.endsWith("'")?d:vd.HelperMethods.Uwc(d):""}}Object(ha.a)(Yb,"DdaBindingPrompt",gc.a,[]);class Pb{constructor(d){this.ea=d}lo(d,z){if(z){const T={};T.Error=d;T.Version=this.ea.Ek;z(T)}}PZa(d,z){this.lo(d,z)}GR(d,z){this.lo(Kb.a.nCf(d.Errors[0].MessageId),z)}zE(d){d&&d(this.tR())}tR(){const d=
{Error:0};d.Version=this.ea.Ek;return d}}Object(ha.a)(Pb,"DdaErrorGenerator",null,[]);var $c=a(254);class wd{constructor(d,z,T){this.$=d;this.u0=z;this.JJ=T}L6d(d,z){const T=d.DdaGoToByIdMethod.GoToType,ya=d.DdaGoToByIdMethod.SelectionMode,sb=d.DdaGoToByIdMethod.Id.toString().trim(),cc=Fc=>{const Wc=this.$.sa.getItemByName(Fc.SheetName);(null===Wc||void 0===Wc?0:Wc.visible)?(ca.f(this.$).ep(Fc,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.u0.zE(z)):this.u0.lo(Kb.a.hUh,
z)};0===T?this.uJj(sb,ya,d.DdaMethod.ControlId,cc,z):1===T?this.xJj(sb,ya,cc,z):this.u0.lo(Kb.a.q6k,z)}uJj(d,z,T,ya,sb){this.JJ.ddaGetBinding(T,d,cc=>{if(!$c.a(cc)&&cc.Result&&cc.Result.Reference){cc=cc.Result;var Fc={};Fc.SheetName=cc.Reference.SheetName;Fc.FirstRow=cc.Reference.FirstRow;Fc.FirstColumn=cc.Reference.FirstColumn;Fc.LastRow=cc.Reference.LastRow;Fc.LastColumn=cc.Reference.LastColumn;wd.yqd(Fc,z);1!==cc.BindingType?ya(Fc):this.JJ.ddaGetBindingData(T,d,1,0,2,0,0,-1,-1,Wc=>{$c.a(Wc)||!Wc.Result?
this.u0.GR(Wc,sb):(Wc=Wc.Result,2!==z&&(Fc.FirstRow-=Wc.Headers.length,0>Fc.FirstRow&&(Fc.FirstRow=0)),ya(Fc))},sb)}else this.u0.PZa(Kb.a.yXg,sb)},sb)}xJj(d,z,T,ya){var sb=xb.D(d);sb?(sb=xb.x(sb,this.$),wd.yqd(sb,z),T(sb)):this.$.ea.isNamedObjectViewMode&&this.$.$h.Lq(d)?this.$.$h.Mqa(this.$.$h.getItemByName(d),"dda"):(sb=cc=>{$c.a(cc)||!cc.Result?this.$.sa.contains(d)?(cc={},cc.SheetName=d,cc.FirstRow=0,cc.FirstColumn=0,cc.LastRow=0,cc.LastColumn=0,T(cc)):this.u0.PZa(Kb.a.yXg,ya):(cc=cc.Result,wd.yqd(cc,
z),T(cc))},this.$.sa.ma?this.JJ.parseRangeForGoto(d,this.$.sa.ma.name,sb,ya):this.JJ.parseRange(d,sb,ya))}static yqd(d,z){d.LastRow=2===z?d.FirstRow:d.LastRow;d.LastColumn=2===z?d.FirstColumn:d.LastColumn}}Object(ha.a)(wd,"DdaNavigator",null,[]);var Bd=a(216),tc=a(64);const Zc=(d,z,T,ya,sb,cc)=>{const Fc=d.$a(1);Fc.request=z;return tc.h(d,"ExecuteRichApiRequest",Fc,T,ya,sb,cc,0)};var Ab=a(337),rb=a(92),Fb=a(768),jc=a(648),Oc;(function(d){d[d.unsupported=0]="unsupported";d[d.surface=1]="surface";d[d.combo=
2]="combo";d[d.column=3]="column";d[d.column3D=4]="column3D";d[d.bar=5]="bar";d[d.bar3D=6]="bar3D";d[d.line=7]="line";d[d.line3D=8]="line3D";d[d.pie=9]="pie";d[d.pie3D=10]="pie3D";d[d.scatter=11]="scatter";d[d.bubble=12]="bubble";d[d.area=13]="area";d[d.area3D=14]="area3D";d[d.doughnut=15]="doughnut";d[d.radar=16]="radar";d[d.stock=17]="stock";d[d.waterfall=18]="waterfall";d[d.funnel=19]="funnel";d[d.treemap=20]="treemap";d[d.sunburst=21]="sunburst";d[d.boxWhisker=22]="boxWhisker";d[d.histogram=23]=
"histogram";d[d.pareto=24]="pareto";d[d.regionMap=25]="regionMap";d[d.noVisibleSeries=26]="noVisibleSeries";d[d.complexDataSource=27]="complexDataSource";d[d.pivotChart=28]="pivotChart"})(Oc||(Oc={}));Object(ha.b)("ChartCategory",Oc);class cd{constructor(d,z){this.source=d;this.eventId=z}}Object(ha.a)(cd,"MacroRecorderEventData",null,[]);class Ed{constructor(d,z,T){this.response=this.request=this.eventId=this.source=null;d&&(this.source=d.source,this.eventId=d.eventId,this.request=z,this.response=
T)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(ha.a)(Ed,"MacroRecorderRichApiRequestExecutedPayload",null,[60]);class Sd{constructor(d,z,T){this.parentName=d;this.$=z;this.request=T}ZUi(d){var z;if(void 0===d||null===d||void 0===d.RequestBody||null===d.RequestBody)return null;const T=JSON.parse(d.RequestBody);if(void 0!==d.ActiveFloatingObjectId&&null!==d.ActiveFloatingObjectId){T.ActiveFloatingObjectId=d.ActiveFloatingObjectId;
const ya=ca.f(this.$).ha.$e.Lh;if(null===(z=null===ya||void 0===ya?void 0:ya.floatingObject)||void 0===z?0:z.Ti)T.ActiveChartType=Oc[ya.floatingObject.Ti.ChartCategory]}void 0!==d.SheetMultiRange&&null!==d.SheetMultiRange&&(T.SheetName=d.SheetMultiRange.SheetName);return T}jVi(d){if(void 0===d||null===d||void 0===d.Result||null===d.Result)return null;d=d.Result;return void 0===d.ResponseBody||null===d.ResponseBody||d.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(d.ResponseBody.join(""))}Vpj(d){return!!d&&
!(void 0===d.eventId||null===d.eventId)&&0<d.eventId.length}Jt(d){return()=>{if(this.$.nha){const z=this.MPh(this.request);if(this.Vpj(z)){const T=this.ZUi(this.request),ya=this.jVi(d);if(T&&!rb.a.isEmpty(T)&&ya&&!rb.a.isEmpty(ya))return la.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Ed(z,T,ya);la.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${T?"(not null)":"(null)"}; responseInfo: ${ya?
"(not null)":"(null)"}`}`)}}return new Ed(null,null,null)}}MPh(d){const z=this.Wpj(d.SolutionId),T=Sd.CUi(d);if(T&&z)return la.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:T,["request.SolutionId"]:d.SolutionId})}`),new cd(d.SolutionId,T);d=JSON.stringify({["recorderEventId"]:T,["isRecorderAwareAddin"]:z,["request.SolutionId"]:d.SolutionId});la.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${d}`);return null}Wpj(d){if(!d)return!1;
d=d.toLowerCase();return Sd.t0i().contains(d)}static t0i(){Sd.OOa||(Sd.OOa=new Fb.a(jc.a.zm()),Sd.OOa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Sd.OOa.add("fa000000005"),Sd.OOa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Sd.OOa.add("fa000000014"),Sd.OOa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Sd.OOa}static CUi(d){let z=null;var T=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(T.test(d.RequestBody))z=T.exec(d.RequestBody)[1];else{d=d.RequestHeaders;
if(!d)return z;T=vb.a.BMj.toLowerCase();for(let ya=0;ya<d.length;ya++)if(d[ya].Name.toLowerCase()===T){z=d[ya].Value;break}}return z}}Sd.OOa=null;Object(ha.a)(Sd,"DdaRichApiRequestRecorder",null,[]);var $d=a(264);class be extends Ab.a{constructor(d,z,T,ya,sb,cc,Fc,Wc){super(10,0,z,Wc);this.xGb=T;this.CCb=ya;this.Gfa=sb;this.$Ua=cc;this.request=Fc;this.lme=new Sd("10",d,Fc)}get B4c(){return this.$Ua}get oQ(){return this.xGb}get uwa(){return this.CCb}Xea(d){return super.Xea(d)||this.TSh(d)}Jt(){return this.lme.Jt(this.pk)}Ryb(){const d=
{OperationType:3};d.RichApiRequest=this.request;return d}TSh(d){return(z,T,ya)=>Zc(d,this.request,$d.c(z,this.xGb),$d.b(T,this.CCb),ya,this.Gfa)}}Object(ha.a)(be,"DdaRichApiRequestBatchOperation",Ab.a,[]);class Fe extends Bd.a{constructor(d,z,T,ya){super(576,0,T,ya);this.lme=new Sd("576",d,z)}Jt(){return this.lme.Jt(this.pk)}}Object(ha.a)(Fe,"DdaRichApiRequestOperation",Bd.a,[]);class Pe{constructor(d,z){this.NS=(T,ya)=>{this.u0.PZa(Kb.a.internalError,ya)};this.$=d;this.u0=z}ddaAddBinding(d,z,T,ya,
sb,cc,Fc){this.KU((Wc,id,Dd)=>{var ee=this.$.pa.ta,re=this.Zwa();Wc=$d.c(Wc,cc);id=$d.b(id,this.NS);const Ce=ee.$a(9);Ce.controlId=d;Ce.bindingId=z;Ce.bindingType=T;Ce.currentSheetName=re;Ce.formula=ya;Ce.options=sb;return tc.h(ee,"DdaAddBinding",Ce,Wc,id,Dd,Fc,0)},Fc,563)}ddaReleaseBinding(d,z,T,ya){this.KU((sb,cc,Fc)=>{var Wc=this.$.pa.ta;sb=$d.c(sb,T);cc=$d.b(cc,this.NS);const id=Wc.$a(9);id.controlId=d;id.bindingId=z;return tc.h(Wc,"DdaReleaseBinding",id,sb,cc,Fc,ya,0)},ya,564)}ddaGetBinding(d,
z,T,ya){this.KU((sb,cc,Fc)=>{var Wc=this.$.pa.ta;sb=$d.c(sb,T);cc=$d.b(cc,this.NS);const id=Wc.$a(1);id.controlId=d;id.bindingId=z;return tc.h(Wc,"DdaGetBinding",id,sb,cc,Fc,ya,0)},ya,565,16)}ddaGetAllBindings(d,z,T){this.KU((ya,sb,cc)=>{var Fc=this.$.pa.ta;ya=$d.c(ya,z);sb=$d.b(sb,this.NS);const Wc=Fc.$a(1);Wc.controlId=d;return tc.h(Fc,"DdaGetAllBindings",Wc,ya,sb,cc,T,0)},T,566,16)}ddaGetBindingData(d,z,T,ya,sb,cc,Fc,Wc,id,Dd,ee){this.KU((re,Ce,mf)=>{var tf=this.$.pa.ta,Df=this.Zwa();re=$d.c(re,
Dd);Ce=$d.b(Ce,this.NS);const sf=tf.$a(1);sf.controlId=d;sf.bindingId=z;sf.coerceType=T;sf.valueFormat=ya;sf.filterType=sb;sf.startRow=cc;sf.startCol=Fc;sf.rowCount=Wc;sf.colCount=id;sf.currentSheetName=Df;return tc.h(tf,"DdaGetBindingData",sf,re,Ce,mf,ee,0)},ee,567,16)}ddaSetBindingData(d,z,T,ya,sb,cc,Fc){this.KU((Wc,id,Dd)=>{var ee=this.$.pa.ta,re=this.Zwa();Wc=$d.c(Wc,cc);id=$d.b(id,this.NS);const Ce=ee.$a(9);Ce.controlId=d;Ce.bindingId=z;Ce.startRow=T;Ce.startCol=ya;Ce.currentSheetName=re;Ce.bindingData=
sb;return tc.h(ee,"DdaSetBindingData",Ce,Wc,id,Dd,Fc,0)},Fc,568)}ddaGetSelectedData(d,z,T,ya,sb,cc,Fc){this.KU((Wc,id,Dd)=>{var ee=this.$.pa.ta,re=this.Zwa();Wc=$d.c(Wc,cc);id=$d.b(id,this.NS);const Ce=ee.$a(1);Ce.controlId=d;Ce.coerceType=z;Ce.valueFormat=T;Ce.filterType=ya;Ce.currentSheetName=re;Ce.formula=sb;return tc.h(ee,"DdaGetSelectedData",Ce,Wc,id,Dd,Fc,0)},Fc,569,16)}ddaSetSelectedData(d,z,T,ya,sb){this.KU((cc,Fc,Wc)=>{var id=this.$.pa.ta,Dd=this.Zwa();cc=$d.c(cc,ya);Fc=$d.b(Fc,this.NS);
const ee=id.$a(9);ee.controlId=d;ee.currentSheetName=Dd;ee.formula=z;ee.bindingData=T;return tc.h(id,"DdaSetSelectedData",ee,cc,Fc,Wc,sb,0)},sb,570)}ddaLoadSettings(d,z,T){this.KU((ya,sb,cc)=>{var Fc=this.$.pa.ta;ya=$d.c(ya,z);sb=$d.b(sb,this.NS);const Wc=Fc.$a(1);Wc.controlId=d;return tc.h(Fc,"DdaLoadSettings",Wc,ya,sb,cc,T,0)},T,501,16)}ddaSaveSettings(d,z,T,ya,sb){this.KU((cc,Fc,Wc)=>{var id=this.$.pa.ta;cc=$d.c(cc,ya);Fc=$d.b(Fc,this.NS);const Dd=id.$a(9);Dd.controlId=d;Dd.settings=z;Dd.overwriteIfStale=
T;return tc.h(id,"DdaSaveSettings",Dd,cc,Fc,Wc,sb,0)},sb,571)}ddaAddRowsColumns(d,z,T,ya,sb,cc){this.KU((Fc,Wc,id)=>{var Dd=this.$.pa.ta,ee=this.Zwa();Fc=$d.c(Fc,sb);Wc=$d.b(Wc,this.NS);const re=Dd.$a(9);re.controlId=d;re.bindingId=z;re.isRow=T;re.currentSheetName=ee;re.bindingData=ya;return tc.h(Dd,"DdaAddRowsColumns",re,Fc,Wc,id,cc,0)},cc,572)}ddaDeleteAllDataValues(d,z,T,ya){this.KU((sb,cc,Fc)=>{var Wc=this.$.pa.ta,id=this.Zwa();sb=$d.c(sb,T);cc=$d.b(cc,this.NS);const Dd=Wc.$a(9);Dd.controlId=
d;Dd.bindingId=z;Dd.currentSheetName=id;return tc.h(Wc,"DdaDeleteAllDataValues",Dd,sb,cc,Fc,ya,0)},ya,573)}ddaClearBindingFormats(d,z,T,ya){this.KU((sb,cc,Fc)=>{var Wc=this.$.pa.ta,id=this.Zwa();sb=$d.c(sb,T);cc=$d.b(cc,this.NS);const Dd=Wc.$a(9);Dd.controlId=d;Dd.bindingId=z;Dd.currentSheetName=id;return tc.h(Wc,"DdaClearBindingFormats",Dd,sb,cc,Fc,ya,0)},ya,574)}ddaSetBindingFormats(d,z,T,ya,sb,cc){this.KU((Fc,Wc,id)=>{var Dd=this.$.pa.ta,ee=this.Zwa();Fc=$d.c(Fc,sb);Wc=$d.b(Wc,this.NS);const re=
Dd.$a(9);re.controlId=d;re.bindingId=z;re.currentSheetName=ee;re.bindingData=T;re.isSetFormats=ya;return tc.h(Dd,"DdaSetBindingFormats",re,Fc,Wc,id,cc,0)},cc,575)}parseRange(d,z,T){this.KU((ya,sb,cc)=>{const Fc=this.$.pa.ta.Vh();return tc.w(this.$.pa.ta,d,-1,$d.c(ya,z),$d.b(sb,this.NS),cc,T,Fc)},T,162,16)}parseRangeForGoto(d,z,T,ya){this.KU((sb,cc,Fc)=>{const Wc=this.$.pa.ta.Vh();return tc.x(this.$.pa.ta,d,z,$d.c(sb,T),$d.b(cc,this.NS),Fc,ya,Wc)},ya,562,16)}executeRichApiRequest(d,z,T){d.RequestFlags&=
12287;if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7867662_RichApiUndoThirdPartyFlight")){var ya=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichApiUndoThirdParty",!1);const sb=0!==(d.RequestFlags&128);ya||"sdxcatalog"===d.MarketplaceType||sb||(d.RequestFlags&=-17)}ua.EwaSettings.Ra(233)?this.qti(this.$.pa.ta.Vh(),z,()=>{this.u0.PZa(Kb.a.internalError,T)},T,d):(ya=nb.DdaFacade.xNd(d),!this.$.vh.ME||ya&16?(ya|=64,this.$.userOperationManager.$O(new Fe(this.$,d,(sb,cc,Fc)=>Zc(this.$.pa.ta,
d,$d.c(sb,z),$d.b(cc,this.NS),Fc,T),ya))):(this.u0.PZa(Kb.a.E5c,T),la.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed")))}Zwa(){return this.$.ea.isNamedObjectViewMode?this.$.ma.sheetName:this.$.activeItemName}KU(d,z,T,ya){ya=void 0===ya?0:ya;!this.$.vh.ME||ya&16?this.$.userOperationManager.$O(new Bd.a(T,0,d,ya|64)):(this.u0.PZa(Kb.a.E5c,z),la.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}qti(d,z,T,ya,sb){let cc=nb.DdaFacade.xNd(sb);if(!this.$.vh.ME||cc&16){var Fc=
this.$.Eh.Li("UserAction","Rich Api request");this.$.userOperationManager.enqueueOperation(new be(this.$,d,z,T,ya,Fc,sb,cc|64),null)}else this.u0.PZa(Kb.a.E5c,ya),la.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(ha.a)(Pe,"DdaWebServiceHelper",null,[]);class hc{constructor(d,z,T,ya){this.evi=d;this.fileSize=z;this.FSk=ya}}Object(ha.a)(hc,"DocumentFile",null,[]);class Lb{}Lb.generalException="GeneralException";Lb.zHh="ApiNotFound";Lb.obe="OperationCancelled";Lb.invalidArgument=
"InvalidArgument";Object(ha.a)(Lb,"ErrorCodes",null,[]);class kc{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}Object(ha.a)(kc,"WacApiDelegates",null,[]);var dd=a(731);class yb extends kc{constructor(d,z){super();this.X2f=(T,ya)=>{T=yb.t2h(T,ya);if(!dd.a(this.$,T))return!0;T=this.$.shortcutKeyManager.GOd(T);
return!!T&&0<T.length};this.addinId=d;this.$=z}replaceShortcuts(d){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,d,this.X2f)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(d){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(d,this.X2f)}static d7h(d,z){const T=document.createEvent("KeyboardEvent");if(oc.a.aJ)T.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(d&8),!!(d&32),!!(d&4),!!(d&256));
else{const ya=[];d&4&&ya.push("Shift");d&8&&ya.push("Control");d&32&&ya.push("Alt");T.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,ya.join(" "),!1,"en-US")}d=new Sys.UI.DomEvent(T);d.keyCode=z;return d}static t2h(d,z){if(oc.a.Am)switch(z){case 189:z=173;break;case 187:z=61;break;case 186:z=59}return yb.d7h(d,z)}}Object(ha.a)(yb,"ExcelWacApiDelegates",kc,[]);class Ta{constructor(d){this.HYa={};this.mFj=d}Uxh(d,z){this.LDc(d)||(this.HYa[d]={});if(this.Ojj(d))return la.ULS.sendTraceTag(537163157,
344,50,`App ${d} has reach the limit of number of cached files.`),Kb.a.aGj;this.HYa[d][z.evi.toString()]=z;return Kb.a.success}nKi(d,z){let T=null;this.LDc(d)&&(T=this.HYa[d][z.toString()]);T||la.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${d}, fileHandler:${z}] doesn't exist`);return T}LDc(d){return d in this.HYa}zjk(d,z){if(this.LDc(d)){const T=this.HYa[d];delete T[z.toString()];1>Object.keys(T).length&&delete this.HYa[d];return z.toString()in T?Kb.a.internalError:Kb.a.success}return Kb.a.internalError}Ojj(d){return this.LDc(d)?
Object.keys(this.HYa[d]).length>=this.mFj:!1}static getInstance(d){return d.la.kh(200)||d.la.Hh(200,new Ta(Ta.nFj))}static kKj(){return++Ta.ORh}}Ta.PEj=4194304;Ta.nFj=1;Ta.ORh=0;Object(ha.a)(Ta,"GetFileApiHelper",null,[]);class Hb{constructor(d){this.Bs=d}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.Bs)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1:return this.VKj()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){d=this.invokeMethod(d,
z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}VKj(){this.notifyActionHandlerReady();return null}}Object(ha.a)(Hb,"AddinInternalService",null,[]);class uc{constructor(d,z){this.Dx=z;this.Bs=d}getAppRuntimeState(){let d=this.Bs;pb.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Dx.RZ&&(d=this.Dx.zaa(this.Bs));return this.Dx.getAppRuntimeState(d)?2:1}setAppRuntimeState(d){switch(d){case 2:d=!0;break;case 1:d=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.invalidArgument,
pb.a.ia(1769));}let z=this.Bs;pb.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Dx.RZ&&(z=this.Dx.zaa(this.Bs));this.Dx.setAppRuntimeState(z,d)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,z){switch(d){case 2:return this.MEi();case 1:return this.VBk(z)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}MEi(){return this.getAppRuntimeState()}VBk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
0,"int");this.setAppRuntimeState(d);return null}}Object(ha.a)(uc,"AppRuntimeService",null,[]);var Sc=a(1261);class bc{constructor(d,z,T,ya){this.IG=d;this.Hda=T;this.nI=ya.Cl.getOsfControl(z)}disable(){try{if(!pb.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.kkf();if(!this.v2f())return this.lkf();this.Hda.t5k(this.IG)}catch(d){return la.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",d.message||"Unknown"),
this.ikf()}return null}enable(){try{if(!pb.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.kkf();if(!this.v2f())return this.lkf();this.Hda.qhk(this.IG)}catch(d){return la.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",d.message||"Unknown"),this.ikf()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 1:return this.WRa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 3:return this.yfi();
case 2:return this.Oki()}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}yfi(){return this.disable()}Oki(){return this.enable()}WRa(){this._OnAccess();return null}kkf(){return Sc.a(La.a.notImplemented,pb.a.ia(1770))}lkf(){return Sc.a(La.a.sharedRuntimeNotAvailable,pb.a.ia(1774))}ikf(){return Sc.a(La.a.generalException,pb.a.ia(1765))}v2f(){const d=this.nI.getSharedRuntimeId();return!!d&&0<d.length}}Object(ha.a)(bc,"BeforeDocumentCloseNotification",null,
[]);class vc{constructor(){this.eZe=this.XSe=this.kv=!1}get enabled(){return this.kv}set enabled(d){this.kv=d}get nativeRuntime(){return this.XSe}set nativeRuntime(d){this.XSe=d}get streamingEnabled(){return this.eZe}set streamingEnabled(d){this.eZe=d}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(d){switch(d){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,z){switch(d){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(ha.a)(vc,"CustomFunctionEngineStatus",null,[]);class Xc{constructor(d,z,T){this.snh=d;this.tnh=z;this.wrh=T}get status(){const d=new vc;d.enabled=this.snh;d.streamingEnabled=
this.tnh;d.nativeRuntime=!1;return d}register(d){return OfficeExtension.WacRuntime.Utility.createPromise(this.wrh(d))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(d){switch(d){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 1:return this.jik(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}jik(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"string");return this.register(z,d)}}Object(ha.a)(Xc,"CustomFunctionManager",null,[]);var ad=a(1164);class Id{constructor(d,z,T,ya){this.iIe="";this.kfc=0;this.i_=d;this._id=z;this.Bs=T;this.Dx=ya}get id(){return this._id}_RegisterStateChange(){this.kfc||this.i_.execute(d=>{this.iIe=d.v6a(this._id,z=>{this.Dx.hxi(this.Bs,this._id,JSON.stringify(z))})});this.kfc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.kfc--;this.kfc||this.i_.execute(d=>
{d.eie(this._id,this.iIe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(d){switch(d){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 6:return this.ygh();case 7:return this.Egh()}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}ygh(){return this._RegisterStateChange()}Egh(){return this._UnregisterStateChange()}}Object(ha.a)(Id,"LicenseFeature",
null,[]);class ue{constructor(d,z){this.i_=Db.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.Bs=d;this.Dx=z;this.mqh=this.Dx.Cl.getOsfControl(this.Bs)}getFeatureTier(d,z){return OfficeExtension.WacRuntime.Utility.createPromise(T=>{const ya=1===z?1:2===z?2:0;this.i_.execute(sb=>{sb.getFeatureTier(d,ya).then(cc=>{T(this.nPi(cc))},()=>{T(z)})})})}getLicenseFeature(d){d=new Id(this.i_,d,this.Bs,this.Dx);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}isFeatureEnabled(d,
z){return OfficeExtension.WacRuntime.Utility.createPromise(T=>{this.i_.execute(ya=>{ya.isFeatureEnabled(d,z).then(sb=>{T(sb)},()=>{T(z)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(d=>{this.i_.execute(z=>{z=z.isFreemiumUpsellEnabled();d(z)})})}launchUpsellExperience(d){if(this.mqh.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.i_.execute(z=>{z.launchUpsellExperience(d)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.Xmd,
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,
z){switch(d){case 6:return this.Bgh(z)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 2:return this.tLi(z);case 5:return this.mPi(z);case 1:return this.Kkj(z);case 3:return this.Dlj();case 4:return this.uwj(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}tLi(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"int");return this.getFeatureTier(z,d)}mPi(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getLicenseFeature(d)}Kkj(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"boolean");return this.isFeatureEnabled(z,d)}Dlj(){return this.isFreemiumUpsellEnabled()}uwj(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.launchUpsellExperience(d)}Bgh(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this._TestFireStateChangedEvent(d);return null}nPi(d){switch(d){case 1:return 1;case 2:return 2;default:return 0}}}Object(ha.a)(ue,"License",null,[]);class Vd{constructor(){this.tHe=null;this.mXe=this.djc=this.QN="";this.AYe=!0;this.options=null}get authChallenge(){return this.tHe}set authChallenge(d){this.tHe=d}get correlationId(){return this.QN}set correlationId(d){this.QN=d}get policy(){return null}set policy(d){}get resource(){return this.djc}set resource(d){this.djc=
d}get scope(){return this.mXe}set scope(d){this.mXe=d}get silentLogin(){return this.AYe}set silentLogin(d){this.AYe=d}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(d){switch(d){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,z){switch(d){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");
return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(ha.a)(Vd,"TokenParameters",null,[297]);var Kd=a(198),Yd=a(12);const Bc=(d,z,T)=>ya=>(sb,cc)=>{Oa.TaskExtensions.Xa(ed.GetServiceTaskFactory.create(z.la,279,z.ya,1),Fc=>{Fc=Fc.result;let Wc=!1;var id=T.Cl.getOsfControl(d);let Dd=null;id&&(Dd=id.getStoreType(),(id=id.getManifest())&&id.getSharedRuntimeForCustomFunctions("Workbook")&&(Wc=!0));Oa.TaskExtensions.Xa(Fc.RVf(d,Dd,ya,Wc),ee=>{Kd.b(ee)?
ee.result?sb(null):cc(OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.invalidArgument,Yd.a.instance.ia(1769))):cc(OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,Yd.a.instance.ia(1765)))},z.ya,3)},z.ya,3)};class Mc{constructor(d){if(!d)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.K4d=d}areShortcutsInUse(d){return OfficeExtension.WacRuntime.Utility.createPromise((z,T)=>{this.K4d.checkShortcutsInUse(d).then(ya=>
{z(ya)}).catch(ya=>{T(ya)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((d,z)=>{this.K4d.getShortcuts().then(T=>{d(T)}).catch(T=>{z(T)})})}replaceShortcuts(d){return OfficeExtension.WacRuntime.Utility.createPromise((z,T)=>{this.K4d.replaceShortcuts(d).then(()=>{z(null)}).catch(ya=>{T(ya)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 3:return this.xJh(z);case 1:return this.UWi();case 2:return this.$pk(z)}d=this.invokeMethod(d,
z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}xJh(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<string>");return this.areShortcutsInUse(d)}UWi(){return this.getShortcuts()}$pk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"any");return this.replaceShortcuts(d)}}Object(ha.a)(Mc,"ActionService",null,[]);class Fd{constructor(){this.data=null}}Object(ha.a)(Fd,"AugLoopHostMessageReceivedEventArgs",null,[]);var Md=a(1262);class oe{constructor(d,
z,T){this.QT=d;this.dX=void 0===z?!1:z;this.YW=(void 0===T?null:T)||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(d){this.dX||Md.a.rAk(d)}_RegisterHostMessageReceivedEvent(){this.dX||(oe.cDg||(Md.a.aik(d=>{this.YW.fireEvent("",65542,Object.assign(new Fd,{data:d}))}),oe.cDg=!0),this.YW.register(this.QT,"",65542))}_UnregisterHostMessageReceivedEvent(){this.dX||this.YW.unregister(this.QT,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,z){switch(d){case 1:return this.bAk(z);case 2:return this.wgh();case 3:return this.Cgh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}bAk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");this.sendMessage(d);return null}wgh(){this._RegisterHostMessageReceivedEvent();return null}Cgh(){this._UnregisterHostMessageReceivedEvent();return null}}oe.cDg=!1;Object(ha.a)(oe,"AugLoopEventService",null,[]);var ye=a(1030),te=a(969),ze=a(122),He=a(605);class ne{constructor(d,z,T){this.Sgd=this.CMe=null;
this.QT=d;this.lUe=z;if(this.Ga=T)this.CMe=this.Ga.Ya("GetAccessTokenOAuthFirstPartyAllowList")}zRi(){this.Sgd||(this.Sgd=He.a.gw(Object(ye.a)()));return this.Sgd}Tlj(d,z){if(!this.lUe||""===this.QT||!this.Ga)return!1;const T=this.lUe.getOsfControl(this.QT);if(!T)return!1;let ya=!1;this.CMe.split(";").forEach(sb=>{z===sb&&(ya=!0)});return 1===ea.AFrameworkApplication.ra.$g.kn&&T.isFirstParty()&&d===ne.XGh&&ya&&ze.d(T.getSolutionId())===ne.YGh}getAccessTokenFirstPartyOAuth(d,z){let T;T=this.Tlj(d,
z)?ya=>{const sb=this.zRi();sb.continueWith(()=>{sb.result.gE(d,z).then(cc=>{ya(cc);return cc})})}:ya=>{ya(Object.assign(new te.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(T)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 1:return this.FDi(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}FDi(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"string");return this.getAccessTokenFirstPartyOAuth(z,d)}}ne.XGh="Maker";ne.YGh="fa000000043";Object(ha.a)(ne,"Auth",null,[]);var of=a(1121),lf=a(47),jf=a(67);class Cf{constructor(){this.BFa=null}FWi(){this.BFa||(this.BFa=He.a.gw(Object(of.a)()));return this.BFa}getSharedFilePickerResponse(d){return OfficeExtension.WacRuntime.Utility.createPromise((z,T)=>{try{const ya=this.FWi();jf.Task.WAA.call(null,ya).continueWith(()=>{const sb=ya.result;if(sb){let cc={};(()=>{let Fc=lf.d(d);({zz:cc}=Fc);return Fc})().returnValue?
sb.WAc(cc).then(Fc=>{Fc&&0<Fc.length?z(Fc):T(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Fc=>{T(Fc)}):T(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else T(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(ya){T(ya)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 1:return this.EWi(z)}d=this.invokeMethod(d,
z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}EWi(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.getSharedFilePickerResponse(d)}}Object(ha.a)(Cf,"SharedFilePicker",null,[]);var Gf=a(182);class Af{vjf(d){return'[data-unique-id="Ribbon-'+d+'"]'}Ytg(d,z){z=JSON.parse(z);if("callout"===z.type)return z.params.target=this.vjf(z.params.target),d.callout(z.params);z.props.target=this.vjf(z.props.target);return z.props}M4j(d){return JSON.parse(d)}addNotification(d,
z){if(!this.dX)return Gf.a.zK().then(T=>T.addNotification(this.Ytg(T,d),this.M4j(z)))}removeNotification(d){if(!this.dX)return Gf.a.zK().then(z=>z.removeNotification(d))}updateNotification(d,z){if(!this.dX)return Gf.a.zK().then(T=>T.updateNotification(d,this.Ytg(T,z)))}getTypeName(){return"Microsoft.Office.NotificationService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 1:return this.Wyh(z);case 3:return this.Okk(z);case 2:return this.q9k(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Wyh(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");
d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");return this.addNotification(z,d)}Okk(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.removeNotification(d)}q9k(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"string");return this.updateNotification(z,d)}}Object(ha.a)(Af,"NotificationService",null,[]);class Lf{constructor(d){this.Uag=d}execute(d,
z){if(this.Uag){const T=this.Uag.lookupApi(d);if(T)return T.doExecutionAsync(z)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}getTypeName(){return"Microsoft.Office.DispatchApiService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 1:return this.dti(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}dti(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"string");return this.execute(z,d)}}Object(ha.a)(Lf,"DispatchApiService",null,[]);class Ef{createInstance(d,z,T,ya,sb,cc){T=void 0===T?"":T;ya=void 0===ya?null:ya;sb=void 0===sb?null:sb;cc=void 0===cc?null:cc;switch(d){case "Microsoft.Office.ActionService":return new Mc(z);case "Microsoft.Office.SharedFilePicker":return new Cf;case "Microsoft.Office.Auth":return new ne(T,ya,sb);case "Microsoft.Office.AugLoopEventService":return new oe(T);case "Microsoft.Office.NotificationService":return new Af;
case "Microsoft.Office.DispatchApiService":return new Lf(cc)}return null}}Object(ha.a)(Ef,"WacApiHost",null,[]);var Hf=a(142);class $b{constructor(){this.responseData=null}}Object(ha.a)($b,"UserFeedbackResponseEventArgs",null,[]);class Wb{constructor(){this.isFeedbackSent=!1}}Object(ha.a)(Wb,"UserFeedbackUIDismissedEventArgs",null,[]);var Dc=a(245);class Jf{constructor(d,z,T,ya){this.QT=d;this.Vjh=z;this.dX=void 0===T?!1:T;this.YW=(void 0===ya?null:ya)||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(d){this.YW.fireEvent("",
65546,Object.assign(new Wb,{isFeedbackSent:d}))}onError(){}$ti(d){this.YW.fireEvent("",65550,Object.assign(new $b,{responseData:JSON.stringify(d)}))}DRi(d){switch(d){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}ERi(d){switch(d){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}CRi(d){const z={};z.isScenarioEnabled=d.isScenarioEnabled;z.scenarioType=d.scenarioType;if(d=d.question){const T={};T.questionUiType=
d.questionUIType;T.questionUiBehavior=d.questionUiBehavior;T.questionUiBehaviour=d.questionUiBehaviour;T.questionInstruction=d.questionInstruction;T.questionOptions=d.questionOptions;z.questionDetails=T}return z}yVa(d,z,T){"True"===T?d[z]=!0:"False"===T&&(d[z]=!1)}canCollectUserFeedback(){return ea.AFrameworkApplication.dD}collectUserFeedback(d,z,T,ya){if(!this.dX){const sb={};ea.AFrameworkApplication.fa.ood(sb);const cc=this.Vjh.getContext(sb);cc.initialFeedbackType=this.DRi(d);cc.uiType=this.ERi(z);
cc.telemetryGroup.featureArea=T;ya.v2Config.contextDataFiles&&(cc.isShareContextDataEnabled=!0,cc.getContextData=()=>Promise.all(Dc.a.map(ya.v2Config.contextDataFiles,Fc=>window.fetch("data:application/octet-stream;base64,"+Fc.base64Data).then(Wc=>Wc.blob()).then(Wc=>new File([Wc],Fc.fileName,{type:Fc.fileType})))));(d=ya.v2Config.scenarioConfig)&&(cc.scenarioConfig=this.CRi(d));this.yVa(cc,"showEmailAddress",ya.v2Config.isEmailCollectionEnabled);this.yVa(cc,"isFileUploadEnabled",ya.v2Config.isFileUploadEnabled);
this.yVa(cc,"screenshot",ya.v2Config.isScreenshotEnabled);this.yVa(cc,"isScreenRecordingEnabled",ya.v2Config.isScreenRecordingEnabled);this.yVa(cc,"isThankYouPageDisabled",ya.v2Config.isThankYouPageDisabled);this.yVa(cc,"isHostManagedContextDataEnabled",ya.v2Config.isHostManagedContextDataEnabled);this.yVa(cc,"isRetrieveFormDataEnabled",ya.v2Config.isRetrieveFormDataEnabled);cc.hostManagedContextDataExplanationUrl=ya.v2Config.hostManagedContextDataExplanationUrl;Gf.a.LJf().then(Fc=>{Fc.initializeFeedbackModal(cc,
Object(Hf.a)(this,this.onDismiss,"onDismiss"),Object(Hf.a)(this,this.onError,"onError"),Object(Hf.a)(this,this.$ti,"extractFeedbackDataForHost"));return Fc})}}_RegisterUserFeedbackResponseEvent(){this.dX||this.YW.register(this.QT,"",65550)}_RegisterUserFeedbackUIDismissedEvent(){this.dX||this.YW.register(this.QT,"",65546)}_UnregisterUserFeedbackResponseEvent(){this.dX||this.YW.unregister(this.QT,"",65550)}_UnregisterUserFeedbackUIDismissedEvent(){this.dX||this.YW.unregister(this.QT,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d,z){switch(d){case 27:return this.qTh();case 1:return this.iZh(z);case 28:return this.zgh();case 18:return this.Agh();case 29:return this.Fgh();
case 19:return this.Ggh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}qTh(){return this.canCollectUserFeedback()}iZh(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int"),T=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"int"),ya=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
3,"object");this.collectUserFeedback(z,T,ya,d);return null}zgh(){this._RegisterUserFeedbackResponseEvent();return null}Agh(){this._RegisterUserFeedbackUIDismissedEvent();return null}Fgh(){this._UnregisterUserFeedbackResponseEvent();return null}Ggh(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(ha.a)(Jf,"UserFeedbackService",null,[]);class Rb{constructor(){this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;
this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0;this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0}getTypeName(){return"Microsoft.Office.SensitivityLabelInfo"}invokePropertyGet(d){switch(d){case 15:return this.color;case 13:return this.description;case 12:return this.displayName;case 8:return this.encryptionType;case 10:return this.hasExtractForUser;
case 9:return this.isDke;case 7:return this.isEnabled;case 5:return this.labelId;case 11:return this.order;case 14:return this.parentName;case 6:return this.tenantId;case 4:return this.version}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,z){switch(d){case 15:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,
"string");return;case 13:this.description=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 12:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 8:this.encryptionType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"int");return;case 10:this.hasExtractForUser=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return;case 9:this.isDke=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,
0,"boolean");return;case 7:this.isEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return;case 5:this.labelId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 11:this.order=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"int");return;case 14:this.parentName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,
"string");return;case 4:this.version=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}
Object(ha.a)(Rb,"SensitivityLabelInfo",null,[]);var Gb;(function(d){d[d.xDi=0]="generic";d[d.coherencyFailure=1]="coherencyFailure";d[d.Xpf=2]="disabledByPolicy";d[d.yml=3]="fileCheckedOut";d[d.zml=4]="fileEncrypted";d[d.Aml=5]="fileLocked";d[d.Cml=6]="fileNotSupported";d[d.fileTooLarge=7]="fileTooLarge";d[d.fnl=8]="invalidOperationOnZeroByteFile";d[d.gvj=9]="labelDisabled";d[d.ynl=10]="labelErrorRetryLater";d[d.hvj=11]="labelIdNotFound";d[d.znl=12]="labelIrmDisabledByTenant";d[d.Anl=13]="labelNotSupported";
d[d.Pnl=14]="mandatoryConflict";d[d.Tnl=15]="minorVersionLimitExceeded"})(Gb||(Gb={}));Object(ha.b)("SetPolicyLabelErrorType",Gb);var Cc=a(1263),cb;(function(d){d[d.Kjl=0]="S_APPLYLABEL_OK";d[d.shl=2147467259]="E_APPLYLABEL_FAIL";d[d.zhl=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT";d[d.rhl=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY";d[d.thl=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION";d[d.uhl=2147205117]="E_APPLYLABEL_LABELDISABLED";d[d.Bhl=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP";d[d.vhl=
2147205115]="E_APPLYLABEL_LABELING_DISABLED";d[d.yhl=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE";d[d.Ahl=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE";d[d.whl=2147205112]="E_APPLYLABEL_LABELNOTFOUND";d[d.xhl=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"})(cb||(cb={}));Object(ha.b)("TryUpgradeLabelError",cb);class pc{constructor(){this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null;this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null}getTypeName(){return"Microsoft.Office.SensitivityLabelChangedEventArgs"}invokePropertyGet(d){switch(d){case 20:return this.context;
case 21:return this.error;case 19:return this.newLabel;case 18:return this.previousLabel}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,z){switch(d){case 20:this.context=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 21:this.error=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"int");
return;case 19:this.newLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"SensitivityLabelInfo");return;case 18:this.previousLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"SensitivityLabelInfo");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(ha.a)(pc,"SensitivityLabelChangedEventArgs",null,[]);var Ic=a(181),rd=a(126);class Rd{constructor(d,z){this.YW=OfficeExtension.WacRuntime.RichApi.getEventManager();this.QT=d;this.Hfc=z}C6(){var d;return null===(d=ea.AFrameworkApplication.fa)||void 0===d?void 0:d.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}sXb(){var d;return null===
(d=ea.AFrameworkApplication.fa)||void 0===d?void 0:d.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorCasesInOfficeJS",!1)}TYd(){var d;return null===(d=ea.AFrameworkApplication.fa)||void 0===d?void 0:d.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorEventInOfficeJS",!1)}oHd(d,z,T){const ya=new pc;ya.context=d;ya.error=z;ya.newLabel=T;this.YW.fireEvent("",65549,ya)}gN(d,z){Ic.a.sendTelemetryEvent({name:"Office.Online.Extensibility.ContextualTabsRichApi.Diagnostics",
dataFields:rd.a.Rm({["Class"]:"SensitivityService",["ControlId"]:this.QT,["Api"]:d,["Hr"]:z.toString()})})}N_i(d){return d.HasUserDefinedPermissions?2:d.IsEndpointProtectionEnabled?1:0}bCe(d){var z;const T=new Rb;T.color=d.Color;T.description=d.Tooltip;T.displayName=d.ParentName?d.ParentName+"\\"+d.DisplayName:d.DisplayName;T.encryptionType=this.N_i(d);T.hasExtractForUser=d.HasExtractForUser;T.isDke=!1;T.isEnabled=d.Enabled;T.labelId=d.Id;T.order=d.Order;T.parentName=d.ParentName;T.tenantId=null===
(z=ea.AFrameworkApplication.fa)||void 0===z?void 0:z.Ya("TenantId");T.version=0;return T}zMj(d){const z=new Cc.a;z.Id=d.labelId;z.Enabled=d.isEnabled;z.DisplayName=d.displayName;z.Order=d.order;z.Tooltip=d.description;z.IsEndpointProtectionEnabled=1==d.encryptionType||2==d.encryptionType;z.Color=d.color;z.HasUserDefinedPermissions=2==d.encryptionType;z.ParentName=d.parentName;return z}UFk(d){switch(d){case Gb.xDi:return 2147467259;case Gb.Xpf:return 2147205115;case Gb.hvj:return 2147205112;case Gb.gvj:return 2147205117;
default:return 2147467259}}XZf(d){var z;return d.tenantId===(null===(z=ea.AFrameworkApplication.fa)||void 0===z?void 0:z.Ya("TenantId"))}getHighestSensitivityLabel(d){return OfficeExtension.WacRuntime.Utility.createPromise((z,T)=>{var ya,sb;if(this.C6())if(!this.sXb()||null!==(ya=ea.AFrameworkApplication.fa)&&void 0!==ya&&ya.ka("SupportsPolicies"))if(d&&0!=d.length){if(this.sXb())for(const Fc of d)if(!this.XZf(Fc)){this.gN("getHighestSensitivityLabel",2147647531);T(2147647531);return}if(ya=null===
(sb=this.Hfc)||void 0===sb?void 0:sb.instance){sb=[];for(cc of d)sb=sb.concat(cc.labelId);var cc=ya.getHighestSensitivityLabel(sb);null==cc?(this.gN("getHighestSensitivityLabel",2147205112),T(2147205112)):z(this.bCe(cc))}else this.gN("getHighestSensitivityLabel",2147942488),T(2147942488)}else this.gN("getHighestSensitivityLabel",2147942487),T(2147942487);else this.gN("getHighestSensitivityLabel",2147205115),T(2147205115);else this.gN("getHighestSensitivityLabel",2147500033),T(2147500033)})}getLabel(){return OfficeExtension.WacRuntime.Utility.createPromise((d,
z)=>{var T;if(this.C6()){var ya=null===(T=this.Hfc)||void 0===T?void 0:T.instance;if(ya){var [sb,cc]=ya.NEi();sb?d(this.bCe(cc)):(this.gN("getLabel",cc),z(cc))}else this.gN("getLabel",2147942488),z(2147942488)}else this.gN("getLabel",2147500033),z(2147500033)})}tryUpgradeLabel(d,z){return OfficeExtension.WacRuntime.Utility.createPromise((T,ya)=>{var sb,cc;if(this.C6())if(!this.sXb()||null!==(sb=ea.AFrameworkApplication.fa)&&void 0!==sb&&sb.ka("SupportsPolicies"))if(d)if(this.sXb()&&!this.XZf(d))this.gN("tryUpgradeLabel",
2147205120),this.TYd()&&this.oHd(z,2147205120,d),ya(2147205120);else if(sb=null===(cc=this.Hfc)||void 0===cc?void 0:cc.instance)if(z="OFFICEJS_SENSITIVITY_CONTEXT_"+z,cc=sb.tryUpgradeLabel(this.zMj(d),z),0==cc)T(cc);else{this.gN("tryUpgradeLabel",cc);if(this.TYd()&&(Object.values(cb).includes(cc)&&this.oHd(z.substring(29),cc,d),2147205105===cc)){T(0);return}ya(cc)}else this.gN("tryUpgradeLabel",2147942488),ya(2147942488);else this.gN("tryUpgradeLabel",2147942487),ya(2147942487);else this.gN("tryUpgradeLabel",
2147205115),this.TYd()&&this.oHd(z,2147205115,d),ya(2147205115);else this.gN("tryUpgradeLabel",2147500033),ya(2147500033)})}_RegisterSensitivityLabelChangedEvent(){var d,z;this.C6()?!this.sXb()||null!==(d=ea.AFrameworkApplication.fa)&&void 0!==d&&d.ka("SupportsPolicies")?(d=null===(z=this.Hfc)||void 0===z?void 0:z.instance)?(d.bIb((T,ya)=>{var sb;T=new pc;T.context=(null===(sb=ya.context)||void 0===sb?0:sb.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"))?ya.context.substring(29):ya.context;T.error=ya.S1?
0:this.UFk(ya.BQg);T.newLabel=this.bCe(ya.aoc);this.YW.fireEvent("",65549,T)}),this.YW.register(this.QT,"",65549)):this.gN("registerSensitivityLabelChangedEvent",2147942488):this.gN("getHighestSensitivityLabel",2147205115):this.gN("registerSensitivityLabelChangedEvent",2147500033)}_UnregisterSensitivityLabelChangedEvent(){this.C6()?this.YW.unregister(this.QT,"",65549):this.gN("unregisterSensitivityLabelChangedEvent",2147500033)}getTypeName(){return"Microsoft.Office.SensitivityService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){switch(d){case 16:return this.xgh();case 17:return this.Dgh()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,
z){switch(d){case 3:return this.FNi(z);case 1:return this.UOi();case 2:return this.r4k(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}FNi(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"Array<Common.App.AppsForOffice.SensitivityLabelInfo>");return this.getHighestSensitivityLabel(d)}UOi(){return this.getLabel()}r4k(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"SensitivityLabelInfo");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"string");return this.tryUpgradeLabel(z,d)}xgh(){this._RegisterSensitivityLabelChangedEvent();return null}Dgh(){this._UnregisterSensitivityLabelChangedEvent();return null}}Object(ha.a)(Rd,"SensitivityService",null,[]);class va{launchSimpleDialog(){return null}getTypeName(){return"Microsoft.Office.ShowSimpleDialog"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 1:return this.owj(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}owj(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string"),T=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,
1,"string"),ya=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,2,"string"),sb=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,3,"int"),cc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,4,"boolean"),Fc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,5,"string"),Wc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,6,"boolean");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,7,"string");return this.launchSimpleDialog(z,T,ya,sb,
cc,Fc,Wc,d)}}Object(ha.a)(va,"ShowSimpleDialog",null,[]);var Bb=a(1E3),Ac=a(1573),Nc=a(1254),hd=a(1256),qd=a(1252),je=a(1255);class Ie{GQd(d){const z=new Nc.a("FA000000012","sdxcatalog","sdxcatalog","0.0.0.0"),T=new je.a(Bb.a.FRi(),"Web","en-Us"),ya=new hd.a;ya.ex=d;Ac.a.instance.kza(z,qd.a.taskpane,"CopilotHelpTaskpane",T,ya)}launchHelpPaneByArticleId(d){this.GQd({SourceControlId:"SearchHelp",query:"AssetID="+d});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByArticleIdString(d){this.GQd({SourceControlId:"SearchHelp",
query:"AssetID="+d});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByQuery(d){this.GQd({SourceControlId:"SearchHelp",query:d});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.CopilotService"}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 2:return this.Wvj(z);case 3:return this.Xvj(z);case 1:return this.Yvj(z)}d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}Wvj(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"int");return this.launchHelpPaneByArticleId(d)}Xvj(d){d=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.launchHelpPaneByArticleIdString(d)}Yvj(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.launchHelpPaneByQuery(d)}}Object(ha.a)(Ie,"CopilotService",null,[]);class Oe{constructor(d,z){this.hideInternal=d;this.showInternal=z}hide(d){this.checkInvalidArgument(d,"caller");return OfficeExtension.WacRuntime.Utility.createPromise((z,T)=>{this.hideInternal(d).then(z).catch(T)})}show(d,
z){this.checkInvalidArgument(d,"caller");this.checkInvalidArgument(z,"options");return OfficeExtension.WacRuntime.Utility.createPromise((T,ya)=>{this.showInternal(d,z).then(T).catch(ya)})}getTypeName(){return"Microsoft.Office.BusinessBarService"}checkInvalidArgument(d,z){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(d))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(z);}invokePropertyGet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=
this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 2:return this.V7i(z);case 1:return this.QPk(z)}d=this.invokeMethod(d,
z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}V7i(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");return this.hide(d)}QPk(d){const z=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,"string");d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,1,"BusinessBarShowArgs");return this.show(z,d)}}Object(ha.a)(Oe,"BusinessBarService",null,[]);class Vb{constructor(){this.m_hideCloseButton=!1;this.m_message="";this.m_messageType=
0;this.m_title=""}get hideCloseButton(){return this.m_hideCloseButton}set hideCloseButton(d){this.m_hideCloseButton=d}get message(){return this.m_message}set message(d){this.m_message=d}get messageType(){return this.m_messageType}set messageType(d){this.m_messageType=d}get title(){return this.m_title}set title(d){this.m_title=d}getTypeName(){return"Microsoft.Office.BusinessBarShowArgs"}invokePropertyGet(d){switch(d){case 6:return this.hideCloseButton;case 4:return this.message;case 5:return this.messageType;
case 3:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,z){switch(d){case 6:this.hideCloseButton=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return;case 4:this.message=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 5:this.messageType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,
0,"int");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}
Object(ha.a)(Vb,"BusinessBarShowArgs",null,[]);var fd;(function(d){d[d.info=0]="info";d[d.error=1]="error";d[d.aNh=2]="blocked";d[d.Sul=3]="severeWarning";d[d.success=4]="success";d[d.warning=5]="warning"})(fd||(fd={}));Object(ha.b)("BusinessBarType",fd);var Qd=a(662);class me{doExecutionAsync(d){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(ha.a)(me,"DoEchoRichApi",null,[288]);class se{constructor(d,z,T,ya,sb){this.ojc=this.beb=null;this.hdc=d;this.Bs=z;this.Dx=T;this.th=
ya;this.h0e=sb;this.ojc=new Map;this.ojc.set("Sample.doEcho",new me)}hostName(){return"ExcelOnline"}appId(){return this.hdc}createInstance(d){switch(d){case "Microsoft.Authentication.AuthenticationService":d=Db.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory");var z=this.Dx.Cl,T=this.Bs;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(T=this.Dx.zaa(this.Bs));return d.create(T,z);case "Microsoft.Authentication.TokenParameters":return new Vd;
case "Microsoft.ExcelServices.CustomFunctionManager":return d=ua.EwaSettings.Ra(114),z=ua.EwaSettings.Ra(115),new Xc(d,z,Bc(this.hdc,this.th,this.Dx));case "Microsoft.AppRuntime.AppRuntimeService":return new uc(this.Bs,this.Dx);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return d=Ea.d.Aa()?this.Dx:gb.a(this.th),new bc(this.hdc,this.Bs,d,this.Dx);case "Microsoft.DynamicRibbon.DynamicRibbon":return d=Ea.d.Aa()?this.Dx:gb.a(this.th),z=null,z=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",
!1)?d.zZa(this.Bs).io:d.gs(this.Bs).io,new ad.DynamicRibbon(this.hdc,this.Bs,this.Dx,d,z);case "Microsoft.Office.Licensing.License":return new ue(this.Bs,this.Dx);case "Microsoft.InternalService.AddinInternalService":return new Hb(this.Bs);case "Microsoft.Office.AugLoopEventService":const ya=Ea.d.Aa()?this.Dx:gb.a(this.th);let sb=null;sb=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?ya.zZa(this.Bs).io:ya.gs(this.Bs).io;z=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===
sb.PrimaryMarketplace.SolutionId&&ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===this.th.ua.DocumentHostInfo.HostTier||"Dogfood"===ea.AFrameworkApplication.ii.AudienceGroup);if(Qd.a(sb)||z())return d=Wc=>(id,Dd,ee)=>{ya.Xn.yQd({actionType:Wc,controlId:id,messageType:ee,targetId:Dd,message:""})},d={register:d(1),unregister:d(2),fireEvent:(Wc,id,Dd)=>{ya.Xn.eS(id,Wc)&&ya.HM(id,Wc,JSON.stringify(Dd))}},new oe(this.Bs,!1,d);break;
case "Microsoft.Office.UserFeedbackService":const cc=Ea.d.Aa()?this.Dx:gb.a(this.th);let Fc=null;Fc=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?cc.zZa(this.Bs).io:cc.gs(this.Bs).io;z=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===Fc.PrimaryMarketplace.SolutionId&&ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.UserFeedbackServiceDevBypass",!1)&&("TestHost"===this.th.ua.DocumentHostInfo.HostTier||"Dogfood"===ea.AFrameworkApplication.ii.AudienceGroup);
if(Qd.a(Fc)||z())return d=Wc=>(id,Dd,ee)=>{cc.Xn.yQd({actionType:Wc,controlId:id,messageType:ee,targetId:Dd,message:""})},d={register:d(1),unregister:d(2),fireEvent:(Wc,id,Dd)=>{cc.Xn.eS(id,Wc)&&cc.HM(id,Wc,JSON.stringify(Dd))}},new Jf(this.Bs,Db.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),!1,d);break;case "Microsoft.Office.SensitivityLabelInfo":return new Rb;case "Microsoft.Office.SensitivityService":z=Ea.d.Aa()?this.Dx:gb.a(this.th);T=null;T=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",
!1)?z.zZa(this.Bs).io:z.gs(this.Bs).io;if(Qd.a(T))return new Rd(this.Bs,Db.a.instance.fj("Common.App.Policy.Contracts.IPolicyManager"));break;case "Microsoft.Office.CopilotService":z=Ea.d.Aa()?this.Dx:gb.a(this.th);T=null;T=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?z.zZa(this.Bs).io:z.gs(this.Bs).io;if("9202c06a-b7d3-466f-9adb-acad75789dbc"===T.PrimaryMarketplace.SolutionId)return new Ie;break;case "Microsoft.Office.BusinessBarShowArgs":return new Vb;
case "Microsoft.Office.BusinessBarService":z=(Ea.d.Aa()?this.Dx:gb.a(this.th)).gs(this.Bs).io;if(Qd.a(z)){const Wc={officeScriptsRunningStatus:64,msFormsDataSyncRunningStatus:69},id=oa.a.resolve(da.C,{va:1}).catch(Dd=>{throw Dd;});return new Oe(Dd=>Lo(function*(){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(Wc[Dd]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");(yield id).removeEntry(Wc[Dd])}),(Dd,ee)=>Lo(function*(){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(Wc[Dd]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");
ee.businessBarType=fd[ee.messageType];(yield id).jmc(Wc[Dd],ee)}))}break;case "Microsoft.Office.ShowSimpleDialog":z=(Ea.d.Aa()?this.Dx:gb.a(this.th)).gs(this.Bs).io;if(Qd.a(z))return new va;break;case "Microsoft.Office.DispatchApiService":if(z=this.Dx.Cl)if(T=z.getOsfControl(this.Bs),null===T||void 0===T?0:T.isFirstParty())return this.beb||(this.beb=new Ef),this.beb.createInstance(d,this.h0e,this.Bs,z,ea.AFrameworkApplication.fa,this);break;default:if(this.beb||(this.beb=new Ef),z=this.beb.createInstance(d,
this.h0e,this.Bs,this.Dx.Cl,ea.AFrameworkApplication.fa))return z}la.ULS.sendTraceTag(537163155,0,10,`Typename: ${d} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,La.a.generalException);}lookupApi(d){if(this.ojc)return this.ojc.get(d)}}Object(ha.a)(se,"RichApiHost",null,[]);var Ne=a(442),Ue=a(32),nf=a(146),tb=a(83),lc=a(41),Tc=a(118),md=a(328),sd=a(103),Zd=a(44),Ae=a(286),Ee=a(62),Ze=a(8),
Te=a(74),We=a(1049),qf=a(1434);class bf{constructor(){this.LLe=this.gLe=this.jsa=null;this.lDb=0}get displayName(){return this.jsa}set displayName(d){this.jsa=d}get email(){return this.gLe}set email(d){this.gLe=d}get federationProvider(){return this.LLe}set federationProvider(d){this.LLe=d}get identityType(){return this.lDb}set identityType(d){this.lDb=d}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(d){switch(d){case 4:return this.displayName;case 3:return this.email;
case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,z){switch(d){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 2:this.federationProvider=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){d=this.invokeMethod(d,
z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}static w6h(d){const z=new bf;z.displayName=d.displayName;z.email=d.email;if(pb.a.isChangeGateEnabled("OfficeVSO:8577366_FixIdentityType"))switch(d.authority){case "MicrosoftAccount":z.identityType=1;break;default:z.identityType=0}else switch(d.authority){case qf.a.Lsg:z.identityType=1;break;default:z.identityType=0}z.federationProvider="";return z}}Object(ha.a)(bf,"OfficeIdentityInfo",null,[]);class af{static get wuf(){return af.Zkh}static ylb(d){return d in
af.wuf?af.wuf[d].toString():d}}af.Zkh={["GeneralException"]:La.a.generalException,["AccessDenied"]:La.a.Xmd,["ApiNotAvailable"]:La.a.Nnc,["UserNotSignedIn"]:La.a.cBe,["UserAborted"]:La.a.Wzb,["UnsupportedUserIdentity"]:La.a.t6k,["InvalidResourceUrl"]:La.a.ynb,["InvalidGrant"]:La.a.QFc,["AddinIsAlreadyRequestingToken"]:La.a.yFh,["ResourceNotAllowed"]:La.a.ptk,["ClientError"]:La.a.qrc,["ServerError"]:La.a.serverError};af.map=null;Object(ha.a)(af,"SingleSignOnErrorCodeMap",null,[]);class Nf{constructor(d,
z){this.Kcc=d;this.lDb=z}get accessToken(){return this.Kcc}set accessToken(d){this.Kcc=d}get tokenIdenityType(){return this.lDb}set tokenIdenityType(d){this.lDb=d}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(d){switch(d){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d,
z){switch(d){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);
}invokeMethodAsync(d,z){d=this.invokeMethod(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}}Object(ha.a)(Nf,"SingleSignOnToken",null,[]);class uf{constructor(d,z){this.FBb=z;this.Bs=d}get roamingSettings(){return null}getAccessToken(d){const z=this.FBb.getOsfControl(this.Bs),T=z.getManifest(),ya=T.getMarketplaceID();this.vV(d,ya);return OfficeExtension.WacRuntime.Utility.createPromise((sb,cc)=>{z.isFirstParty()&&this.FBb._enableFirstPartySSO?this.jhj(T,d)?Db.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(d,
ya).then(Fc=>{sb(Fc)},Fc=>{cc(Fc)}):cc(La.a.Xmd):cc(La.a.Nnc)}).then(sb=>{let cc;switch(sb.authority){case qf.a.Lsg:cc=1;break;default:cc=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Nf(sb.accessToken,cc))},sb=>{this.logErrorResponse(d,ya,sb);return sb?OfficeExtension.WacRuntime.Utility.createPromise((cc,Fc)=>{Fc(OfficeExtension.WacRuntime.Utility.createRichApiException(sb,af.ylb(sb)))}):OfficeExtension.WacRuntime.Utility.createPromise((cc,Fc)=>{Fc(OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,
af.ylb(La.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const d=this.FBb.getOsfControl(this.Bs);d.getManifest();const z=d.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((T,ya)=>{Db.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(z).then(sb=>{T(sb)},sb=>{ya(sb.toString())})}).then(T=>{T=bf.w6h(T);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(T)},T=>T?OfficeExtension.WacRuntime.Utility.createPromise((ya,
sb)=>{sb(OfficeExtension.WacRuntime.Utility.createRichApiException(T,af.ylb(T)))}):OfficeExtension.WacRuntime.Utility.createPromise((ya,sb)=>{sb(OfficeExtension.WacRuntime.Utility.createRichApiException(La.a.generalException,af.ylb(La.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(d){switch(d){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertyGetAsync(d){d=this.invokePropertyGet(d);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}invokePropertySet(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokePropertySetAsync(d,z){this.invokePropertySet(d,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(d){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(d);}invokeMethodAsync(d,z){switch(d){case 1:return this.GDi(z);case 3:return this.cFi();case 2:return this.vTi()}d=this.invokeMethod(d,
z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)}GDi(d){d=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(d,0,Vd);return this.getAccessToken(d)}cFi(){return this.getAuthContext()}vTi(){return this.getPrimaryIdentityInfo()}jhj(d,z){let T=!1;const ya=d.getWebApplicationAuthorizations();d=null;for(const sb of ya)if(sb.getResource().toLowerCase()===z.resource.toLowerCase()){d=sb;T=!0;break}if(!T)return!1;z=z.scope.split(" ,+");for(const sb of z)if(sb&&sb.length){z=!1;
for(const cc of d.getScopes())sb.toLowerCase()===cc.toLowerCase()&&(z=!0);if(!z)return!1}return!0}vV(d,z){d=this.dgg(d.resource);la.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:z,["resource"]:d})}logErrorResponse(d,z,T){d=this.dgg(d.resource);la.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:z,["resource"]:d,["error"]:T})}dgg(d){return d.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(ha.a)(uf,"AuthenticationService",null,[]);class pf{create(d,
z){return new uf(d,z)}}Object(ha.a)(pf,"AuthenticationServiceFactory",null,[]);Object(oa.b)(da.yb,{Fk:"singleton"})(d=>Lo(function*(){var z;const T=yield oa.a.resolve(da.Nb,d),ya=yield oa.a.resolve(da.xb,d),sb=yield oa.a.resolve(da.pd,d),cc=yield oa.a.resolve(da.Wb,d),Fc=yield oa.a.resolve(da.fe,d);yield We.a(T.ya,null!==(z=d.va)&&void 0!==z?z:0);yield oa.a.resolve(da.nd,d);Db.a.instance.register(pf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").yi().Ei(()=>new pf);
return new ff(T,ya,Fc,sb,cc)}));class ff{constructor(d,z,T,ya,sb){this.Bi=this.rangePicker=this.externalLinksManager=null;this.$=d;this.Ai=z;this.Bi=ya;this.$k=new Pb(d.ea);this.JJ=new Pe(d,this.$k);this.Ieg=T;this.Txc=new Map;this.externalLinksManager=sb}get u0(){return this.$k}dispose(){this.$=this.Txc=null}Ri(){return!1}dj(){return!1}executeCommand(d,z,T){d=z.command;switch(d){case 451041795:this.$k.lo(T[wb.a.Xk],T[wb.a.Gfa]);break;case 974713501:this.I3i(T[wb.a.Xk],T[wb.a.Gfa]);break;case 1237877382:this.$k.zE(T[wb.a.Gfa]);
break;default:return Ia.a(d)}return jf.Task.Ua(!0)}Gi(d,z,T){if(d=!!T)switch(z.command){case 974713501:case 1237877382:case 451041795:break;default:d=!1}return d}I3i(d,z){var T;const ya=d.DdaMethod;"undefined"===typeof ya.DispatchId?this.$k.lo(Kb.a.internalError,z):ff.Ajj(d)||this.$.Ij&1?(ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Yb(this.$,this,d,z,this.Bi)).start(this.Ai,d.DdaMethod.ControlId):ya.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.cWi(d,
z):ya.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.RGk(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(d,this.$Kd(d.DdaMethod.ControlId),0,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.vFi(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.fCk(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.uFi(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?
this.yjk(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.pEi(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.A2d(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(d.DdaAddRowsColumns.IsRow=!0,this.d3e(d,z)):ya.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(d.DdaAddRowsColumns.IsRow=!1,this.d3e(d,z)):ya.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?
this.cdi(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.eXh(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(d.DdaSetBindingFormats.IsSetFormats=!0,this.iOg(d,z)):ya.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(d.DdaSetBindingFormats.IsSetFormats=!1,this.iOg(d,z)):ya.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(d,d.DdaBindingsMethod.ItemName,d.DdaBindingsMethod.FailOnCollision?2:1,z):ya.DispatchId===
OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.ALi(z):ya.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.L6d(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.kKi(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.lKi(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Ajk(d,z):ya.DispatchId===
OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(d.DdaMethod.ControlId,d),this.$k.zE(z)):ya.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.vGj(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?this.sGj(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(d,z):ya.DispatchId===
OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod?this.hNd(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidExecuteFeature?this.executeFeature(d,z):ya.DispatchId===OSF.DDA.MethodDispId.dispidQueryFeature?this.queryFeature(d,z):this.$k.lo(Kb.a.tbe,z),ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&ya.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(z=d.DdaMethod.ControlId,ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&(z=this.Ai.zaa(d.DdaMethod.ControlId)),d=this.Ai.aY(z),z="",d&&(z=nb.DdaFacade.getSolutionId(d,this.$),z=Telemetry.PrivacyRules.GetPrivacyCompliantId(z,d.OwnerAddinStoreType||d.PrimaryMarketplace.MarketplaceType,null===(T=d.AssetMarketplace)||void 0===T?void 0:T.SolutionId,null,null,d.PrimaryMarketplace.MarketplaceRef)),la.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${ya.DispatchId}, AppID: ${z}`))):this.$k.lo(Kb.a.brf,z)}vFi(d,z){d.DdaGetBindingData.CoerceType=ff.Erc(d.DdaGetBindingData.CoerceType);
d.DdaGetBindingData.FilterType=ff.Fzf(d.DdaGetBindingData.FilterType);d.DdaGetBindingData.ValueFormat=ff.P8g(d.DdaGetBindingData.ValueFormat);if(this.fKc(d.DdaGetBindingData.CoerceType,z)){if(d.DdaGetBindingData){var T=d.DdaGetBindingData;0===T.FilterType&&(T.FilterType=2);T.StartCol|=0;T.StartRow|=0;T.ColCount=void 0===T.ColCount?-1:T.ColCount;T.RowCount=void 0===T.RowCount?-1:T.RowCount}T=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&
this.Ai.RZ&&(T=this.Ai.mxa(d.DdaMethod.ControlId));this.JJ.ddaGetBindingData(T,d.DdaGetBindingData.BindingId,d.DdaGetBindingData.CoerceType,d.DdaGetBindingData.ValueFormat,d.DdaGetBindingData.FilterType,d.DdaGetBindingData.StartRow,d.DdaGetBindingData.StartCol,d.DdaGetBindingData.RowCount,d.DdaGetBindingData.ColCount,ya=>{if($c.a(ya)||!ya.Result)this.$k.GR(ya,z);else{const sb=this.$k.tR();sb.Data=ff.Uaf(ya.Result);z(sb)}},z)}}fCk(d,z){d.DdaSetBindingData.CoerceType=ff.Erc(d.DdaSetBindingData.CoerceType);
if(this.fKc(d.DdaSetBindingData.CoerceType,z)){var T=ff.Ntd(d.DdaSetBindingData.CoerceType,d.DdaSetBindingData.Data);if(ff.lGc(T))this.$k.lo(Kb.a.a3c,z);else{1===T.CoerceType&&(T.CellFormat||(T.CellFormat=d.DdaSetBindingData.CellFormat),T.TableOptions||(T.TableOptions=d.DdaSetBindingData.TableOptions));d.DdaSetBindingData&&(d.DdaSetBindingData.StartCol|=0,d.DdaSetBindingData.StartRow|=0);var ya=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&this.Ai.RZ&&(ya=this.Ai.mxa(d.DdaMethod.ControlId));this.JJ.ddaSetBindingData(ya,d.DdaSetBindingData.BindingId,d.DdaSetBindingData.StartRow,d.DdaSetBindingData.StartCol,T,sb=>{$c.a(sb)?this.$k.GR(sb,z):this.$k.zE(z)},z)}}}cWi(d,z){d.DdaGetBindingData.CoerceType=ff.Erc(d.DdaGetBindingData.CoerceType);d.DdaGetBindingData.ValueFormat=ff.P8g(d.DdaGetBindingData.ValueFormat);d.DdaGetBindingData.FilterType=ff.Fzf(d.DdaGetBindingData.FilterType);if(this.fKc(d.DdaGetBindingData.CoerceType,z)){var T=
this.$Kd(d.DdaMethod.ControlId);T?this.JJ.ddaGetSelectedData(d.DdaMethod.ControlId,d.DdaGetBindingData.CoerceType,d.DdaGetBindingData.ValueFormat,d.DdaGetBindingData.FilterType,T,ya=>{if($c.a(ya))this.$k.GR(ya,z);else{const sb=this.$k.tR();sb.Data=ff.Uaf(ya.Result);z(sb)}},z):this.$k.lo(Kb.a.HLf,z)}}kKi(d,z){const T=d[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],ya=d[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],sb=d.DdaMethod.ControlId,cc=Ta.getInstance(this.$);if(0>=
ya)la.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.$k.lo(Kb.a.zfj,z);else if(ya>Ta.PEj)la.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.$k.lo(Kb.a.TFf,z);else{var Fc=null;switch(T){case 1:Fc="Compressed";break;case 0:Fc="Text";break;case 2:Fc="Pdf";break;default:la.ULS.sendTraceTag(537163219,344,15,`Requested file type ${T} is not supported.`);this.$k.lo(Kb.a.tzf,z);return}if("Text"===Fc)la.ULS.sendTraceTag(537163218,
344,15,`Requested file type ${Fc} is not supported.`),this.$k.lo(Kb.a.tzf,z);else{ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(d=new Sys.StringBuilder,d.append(Ec.a(this.$,Fc)),"Pdf"===Fc&&Xd.a.nr(d,vb.a.Wyg,"WholeWorkbook"),d=d.toString()):d=Ec.a(this.$,Fc);var Wc=null,id=new XMLHttpRequest;id.onreadystatechange=()=>{if(4===id.readyState)if(200===id.status){var Dd=id.response;if(Dd){Wc=new Uint8Array(Dd);Dd=this.$k.tR();var ee=Wc.length,re=Ta.kKj(),
Ce={},mf=0;for(let tf=0;tf<ee;tf+=ya){const Df=[],sf=tf+ya<ee?tf+ya:ee;for(let $f=0,pg=tf;pg<sf;$f++,pg++)Df[$f]=Wc[pg];Ce[(mf++).toString()]=Df}Ce=new hc(re,ee,ya,Ce);Ce=cc.Uxh(sb,Ce);Ce!==Kb.a.success?this.$k.lo(Ce,z):(Dd[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=re,Dd[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=ee,la.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${Fc}, the file size is ${ee}`),z(Dd))}else la.ULS.sendTraceTag(537163217,
344,15,`Request is successful, but respone have no data for file type ${Fc}.`),this.$k.lo(Kb.a.internalError,z)}else 500===id.status?this.$k.lo(Kb.a.nCf(parseInt(id.statusText,10)),z):(la.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${Fc}.`),this.$k.lo(Kb.a.OJj,z))};id.open("GET",d,!0);id.responseType="arraybuffer";id.setRequestHeader("If-Modified-Since","0");id.send(null)}}}lKi(d,z){var T=d[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],ya=d[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];
d=d.DdaMethod.ControlId;(T=Ta.getInstance(this.$).nKi(d,T))?(T=T.FSk,0>ya||ya>=Object.keys(T).length?this.$k.lo(Kb.a.E$i,z):(ya=T[ya.toString()],T=this.$k.tR(),T[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=ya,T[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=ya.length,z(T))):this.$k.lo(Kb.a.internalError,z)}Ajk(d,z){var T=d[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];d=d.DdaMethod.ControlId;T=Ta.getInstance(this.$).zjk(d,T);T===Kb.a.success?this.$k.zE(z):
this.$k.lo(T,z)}RGk(d,z){d.DdaSetBindingData.CoerceType=ff.Erc(d.DdaSetBindingData.CoerceType);if(this.fKc(d.DdaSetBindingData.CoerceType,z)){var T=this.$Kd(d.DdaMethod.ControlId);if(T){var ya=ff.Ntd(d.DdaSetBindingData.CoerceType,d.DdaSetBindingData.Data),sb=ca.f(this.$).ha;1===ya.CoerceType&&(!ya.Data&&sb.qa.G6&&(ya.Headers||(ya.Headers=[]),ya.Headers.length||ya.Headers.push([]),ya.Headers[0].length||ya.Headers[0].push("")),ff.lGc(ya)||(ya.CellFormat||(ya.CellFormat=d.DdaSetBindingData.CellFormat),
ya.TableOptions||(ya.TableOptions=d.DdaSetBindingData.TableOptions)));if(ff.lGc(ya))this.$k.lo(Kb.a.a3c,z);else{var cc=sb.qa.jj.clone(),Fc=sb.qa.activeCell.clone();this.JJ.ddaSetSelectedData(d.DdaMethod.ControlId,T,ya,Wc=>{var id;if($c.a(Wc))this.$k.GR(Wc,z);else{Wc=cc.clone();const Dd=ya.Headers?ya.Headers[0].length:ya.Data[0].length;1!==ya.CoerceType||ya.Data?1===ya.CoerceType&&(null===(id=ya.TableOptions)||void 0===id?0:id.length)&&0==ya.TableOptions[0]?(Wc.top+=1,Wc.bottom=Wc.top+ya.Data.length-
1):Wc.bottom=Wc.top+ya.Data.length-(1===ya.CoerceType?0:1):Wc.bottom=Wc.top+1;Wc.right=Wc.left+Dd-1;id=Wc.contains(Fc)?Fc:Wc.topLeft;sb.updateSelection(Wc,id,0);this.$k.zE(z)}},z)}}else this.$k.lo(Kb.a.Bdf,z)}}addBinding(d,z,T,ya){if(z){var sb=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.RZ&&(sb=this.Ai.mxa(d.DdaMethod.ControlId));this.JJ.ddaAddBinding(sb,d.DdaBindingsMethod.BindingId,d.DdaBindingsMethod.BindingType,z,T,cc=>
{if($c.a(cc))this.$k.GR(cc,ya);else{const Fc=this.$k.tR();Fc.Bindings=Array(1);Fc.Bindings[0]=this.Ai.Yoc(cc.Result);ya(Fc)}},ya)}else this.$k.lo(Kb.a.hzk,ya)}uFi(d,z){let T=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.RZ&&(T=this.Ai.mxa(d.DdaMethod.ControlId));this.JJ.ddaGetBinding(T,d.DdaBindingsMethod.BindingId,ya=>{if($c.a(ya)||!ya.Result)this.$k.GR(ya,z);else{const sb=this.$k.tR();sb.Bindings=Array(1);sb.Bindings[0]=this.Ai.Yoc(ya.Result);
z(sb)}},z)}ALi(d){const z=this.$k.tR(),T={};T[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;z[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=T;d(z)}yjk(d,z){let T=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.RZ&&(T=this.Ai.mxa(d.DdaMethod.ControlId));this.JJ.ddaReleaseBinding(T,d.DdaBindingsMethod.BindingId,ya=>{$c.a(ya)?this.$k.GR(ya,z):this.$k.zE(z)},z)}pEi(d,z){let T=
d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.RZ&&(T=this.Ai.mxa(d.DdaMethod.ControlId));this.JJ.ddaGetAllBindings(T,ya=>{if($c.a(ya))this.$k.GR(ya,z);else{const sb=this.$k.tR();if(ya.Result){ya=ya.Result;sb.Bindings=Array(ya.length);for(let cc=0;cc<ya.length;cc++)sb.Bindings[cc]=this.Ai.Yoc(ya[cc])}else sb.Bindings=null;z(sb)}},z)}A2d(d,z){this.JJ.ddaLoadSettings(d.DdaMethod.ControlId,T=>{if($c.a(T))this.$k.GR(T,z);else{const ya=
this.$k.tR();ya.Properties=T.Result;z(ya)}},z)}saveSettings(d,z){const T={Settings:[]};for(let ya=0;ya<d.DdaSettingsMethod.Properties.length;ya++){const sb={};sb.Name=d.DdaSettingsMethod.Properties[ya][0];sb.Value=d.DdaSettingsMethod.Properties[ya][1];T.Settings[ya]=sb}this.JJ.ddaSaveSettings(d.DdaMethod.ControlId,T,d.DdaSettingsMethod.OverwriteIfStale,ya=>{$c.a(ya)?this.$k.GR(ya,z):this.$k.zE(z)},z)}d3e(d,z){const T=ff.Ntd(1,d.DdaAddRowsColumns.Data);ff.lGc(T)?this.$k.lo(Kb.a.a3c,z):this.JJ.ddaAddRowsColumns(d.DdaMethod.ControlId,
d.DdaAddRowsColumns.BindingId,d.DdaAddRowsColumns.IsRow,T,ya=>{$c.a(ya)?this.$k.GR(ya,z):this.$k.zE(z)},z)}cdi(d,z){this.JJ.ddaDeleteAllDataValues(d.DdaMethod.ControlId,d.DdaBindingsMethod.BindingId,T=>{$c.a(T)?this.$k.GR(T,z):this.$k.zE(z)},z)}eXh(d,z){this.JJ.ddaClearBindingFormats(d.DdaMethod.ControlId,d.DdaClearBindingFormats.BindingId,T=>{$c.a(T)?this.$k.GR(T,z):this.$k.zE(z)},z)}iOg(d,z){const T={},ya=d.DdaSetBindingFormats.IsSetFormats;ya?T.CellFormat=d.DdaSetBindingFormats.CellFormat:T.TableOptions=
d.DdaSetBindingFormats.TableOptions;this.JJ.ddaSetBindingFormats(d.DdaMethod.ControlId,d.DdaSetBindingFormats.BindingId,T,ya,sb=>{$c.a(sb)?this.$k.GR(sb,z):this.$k.zE(z)},z)}executeRichApiRequest(d,z){var T;const ya=d.ArrayData,sb={},cc=ca.f(this.$).ha;if(ya){if("WacPartition"===ya[0]){this.Tsi(d,z);return}const re=da.xb.Aa()?this.Ai:Object(wa.a)(nb.DdaFacade,gb.a(this.$));var Fc=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ai.RZ&&
(Fc=this.Ai.zaa(d.DdaMethod.ControlId));"SetOsfControlContainerReadyForCustomFunctions"===ya[0]&&(Fc=re.gs(Fc))&&(Fc.JIc=!0,Fc.fyg());sb.HttpMethod=ya[1];sb.PathAndQuery=ya[2];sb.RequestHeaders=ff.BHf(ya[3]);sb.RequestBody=ya[4];sb.AppPermission=ya[5];Fc=ya[6];sb.RequestFlags=Fc;var Wc=0;if(ra.i(this.$.ma))switch(cc.Ck){case 1:Wc=2;break;case 2:Wc=3;break;case 64:Wc=16;break;case 128:Wc=4;break;default:Wc=1}var id=null;cc.$e.sK&&(id=cc.$e.sK.Wq);sb.SheetMultiRange=xb.t(cc.qa.selectedRanges,this.$);
sb.ActiveCell=xb.x(cc.qa.activeCell,this.$);sb.ActiveFloatingObjectId=id;sb.SelectionState=Wc;Wc=null;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)?this.Ai.RZ?(id=this.Ai.mxa(d.DdaMethod.ControlId),Wc=this.Ai.zaa(d.DdaMethod.ControlId),Wc=this.Ai.aY(Wc),sb.InstanceId=id):(Wc=this.Ai.aY(d.DdaMethod.ControlId),sb.InstanceId=Wc?Wc.InstanceId:""):(Wc=this.Ai.aY(d.DdaMethod.ControlId),sb.InstanceId=Wc?Wc.InstanceId:"");if(Wc&&Wc.PrimaryMarketplace){let Ce;if(Wc.PrimaryMarketplace.MarketplaceType!==
OSF.StoreType.InMemory)Ce=Wc.PrimaryMarketplace.SolutionId,id=Wc.PrimaryMarketplace.MarketplaceType;else{if(!Wc.OwnerAddinSolutionId){la.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.$k.lo(Kb.a.fVb,z);return}if(!Wc.OwnerAddinStoreType){la.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.$k.lo(Kb.a.fVb,z);return}Ce=Wc.OwnerAddinSolutionId;id=Wc.OwnerAddinStoreType}const mf=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ce,
id,null===(T=Wc.AssetMarketplace)||void 0===T?void 0:T.SolutionId,null,null,Wc.PrimaryMarketplace.MarketplaceRef);sb.CompliantSolutionId=mf;sb.SolutionId=Ce;sb.MarketplaceType=id;sb.SolutionVersion=Wc.PrimaryMarketplace.SolutionVersion;sb.StoreLocation=Wc.PrimaryMarketplace.MarketplaceRef}else sb.SolutionId=sb.MarketplaceType="",sb.CompliantSolutionId="";sb.IsEventsEnabled=void 0===re||null===re||re.Xn.ooc(sb.InstanceId);sb.RequestGuid=Ib.a.create().toString();T=sb.RequestBody.length;if(T>this.$.ua.ExcelRichApiMaxAllowedRequestPayloadSize){this.$k.lo(Kb.a.Frk,
z);la.ULS.sendTraceTag(537163213,0,50,`Request payload size:${T} exceeded the limit`);return}ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Fc&4096&&(T=new lb(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(T,db,ya),sb.RequestBody=ya[4])}const Dd=ff.hLf(sb.RequestHeaders);ff.oce++;const ee=Ue.a.ih.ri;ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&sb&&sb.RequestBody&&la.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${sb.RequestBody.length}`);
this.JJ.executeRichApiRequest(sb,re=>{var Ce;this.qNg(ee,!0,re.ServerCorrelationId);let mf=null,tf=null;var Df=re.ServerCorrelationId;if(null===(Ce=null===re||void 0===re?void 0:re.Errors)||void 0===Ce?0:Ce[0])mf=re.Errors[0].MessageIdName,tf=re.Errors[0].Description,Te.a(this.$).xj.YL(re.Errors[0].MessageId);if($c.a(re)||!re.Result)this.Rqb(Df,Dd,"Server error",mf,tf),this.$k.GR(re,z);else{let $f=null;if(ua.EwaSettings.Ra(233))if((Ce=re.Result)&&Ce.length){for(let Fg=0;Fg<Ce.length;Fg++)if(Ce[Fg].RequestGuid===
sb.RequestGuid){$f=Ce[Fg];break}$f||this.$k.GR(re,z)}else $f=re.Result;else $f=re.Result;if(!mf&&$f&&$f.ResponseBody&&$f.ResponseBody[0])if(re=$f.ResponseBody[0],re.startsWith('{"Error":')){1<$f.ResponseBody.length&&(re=re.substring(0,re.indexOf("}")+1),re+="}");try{var sf=mc.a.Sp(re);sf.Error&&this.Rqb(Df,Dd,"Pipeline error",sf.Error.Code,sf.Error.Message)}catch(Fg){this.Rqb(Df,Dd,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.Rqb(Df,Dd);else this.Rqb(Df,Dd,"Server error",
mf,tf);const pg=(Df=$f.SheetMultiRange)?Df.SheetName:null;sf=$f.ActiveFloatingObjectId;const hg=$f.SelectionState;re=5===hg&&!!Df||6===hg||7===hg||17===hg||8===hg;if(this.$.vh.ME&&re)this.$k.lo(Kb.a.E5c,z),la.ULS.sendTraceTag(537163211,0,50,`${hg.toString()} is not allowed`);else if(5===hg&&Df){if(this.$.sa&&pg)if(this.$.sa.Lq(pg))this.Ind(pg);else{let Fg=null;Fg=()=>{this.$.sa.Lq(pg)&&(la.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.Ind(pg),this.$.sa.bVc(Fg))};this.$.sa.Mmc(Fg);
if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Nh=null;Nh=()=>{this.$.sa.Lq(pg)&&(this.Ind(pg),this.$.sa.UAa(Nh))};this.$.sa.fua(Nh)}}}else if(6===hg||7===hg||17===hg||8===hg||9===hg){if(Df){const Fg=xb.h(Df.Ranges);if(pg&&xb.mb(Fg,!0))if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.sa.Lq(pg)){let Nh=null;Nh=()=>{this.Z6g(cc,Fg,pg,hg);this.$.sa.UAa(Nh)};this.$.sa.fua(Nh)}else this.Z6g(cc,
Fg,pg,hg)}if(7===hg||17===hg||8===hg)sf="{"+ze.e(sf)+"}",sd.a(this.$).Tyk(sf);9===hg&&(this.$.ua.ApiCallToSetPageLayout=!0)}$f.PostProcessActions?(Df=mc.a.Sp($f.PostProcessActions),this.y8j(Df).then(()=>{this.Awb($f,z);this.qHd(d.DdaMethod.ControlId,sb);return Promise.resolve(null)},Fg=>{this.Awb($f,z,Fg);return Promise.reject(Fg)})):this.Awb($f,z)}},re=>{this.qNg(ee,!1,null);this.Rqb(null,Dd,"Web service error");z(re)})}qHd(d,z){const T=da.xb.Aa()?this.Ai:Object(wa.a)(nb.DdaFacade,gb.a(this.$));
(null===T||void 0===T?0:T.kme)&&T.gs(d)&&ff.uLk(z.RequestHeaders)&&(la.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${d}; SolutionId: ${z.SolutionId}.`),T.kme.jmi(d))}Tsi(d,z){var T=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.Ai.RZ&&(T=this.Ai.zaa(d.DdaMethod.ControlId));const ya=this.Ai.aY(T),sb=nb.DdaFacade.getSolutionId(ya,this.$);var cc=null;cc=nb.DdaFacade.DJa(ya,
this.$);cc=new yb(cc,this.$);ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.Ai.RZ&&(T=this.Ai.mxa(d.DdaMethod.ControlId));cc=new se(sb,T,this.Ai,this.$,cc);const Fc={ResponseHeaders:[]};Fc.ResponseBody=Array(1);T=ff.BHf(d.ArrayData[3]);const Wc=ff.hLf(T);T=new fa(this.$.ua.CreateWorkbookMaxAllowedBase64Size,this.Ieg);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(cc,bb,T,d.ArrayData).then(id=>{if(!id)return this.r3d(!1,"The rich api executor call failed",
Wc),la.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Fc.ResponseStatusCode=500,this.Awb(Fc,z),null;this.r3d(!0,"The rich api executor call succeeded",Wc);Fc.ResponseStatusCode=id[0];Fc.ResponseBody[0]=id[2];this.Awb(Fc,z);return null},id=>{Fc.ResponseStatusCode=400;Fc.ResponseBody[0]=id.toString();this.r3d(!1,"The rich api executor call failed",Wc);la.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${sb}`);this.Awb(Fc,z);return null})}qNg(d,
z,T){ff.oce--;d=nf.a(Ue.a.ih,d);la.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${d}, requests pending:${ff.oce}, request result:${z?"success":"false"}, server correlationid: ${T}.`)}Awb(d,z,T){T=void 0===T?null:T;const ya=Array(3);ya[0]=d.ResponseStatusCode;ya[1]=ff.KXi(d.ResponseHeaders);const sb=[];var cc=!1;if(T&&d.ResponseBody){const Fc=mc.a.Sp(d.ResponseBody.join(""));Fc.Error||(cc={},cc.Error=T,cc.TraceIds=Fc.TraceIds,cc.ProcessedResults={},cc.ProcessedResults.Results=
Fc.Results,sb[0]=mc.a.Ci(cc),cc=!0)}ya[2]=cc?sb:d.ResponseBody;d=this.$k.tR();d.Data=ya;z(d)}L6d(d,z){(new wd(this.$,this.$k,this.JJ)).L6d(d,z)}vGj(d,z){la.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const T=d[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],ya=d[Hc.a.nqd],sb=d[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];d=this.$.la.kh(232).Oib.wGj(d.DdaMethod.ControlId,T,ya,sb);d===Kb.a.success?this.$k.zE(z):(la.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),
this.$k.lo(d,z))}sGj(d,z){la.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const T=d[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],ya=d[Hc.a.nqd],sb=d[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin],cc=this.$.la.kh(232);let Fc=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(Fc=this.Ai.zaa(d.DdaMethod.ControlId));cc.Oib.cAk(Fc,T,ya,sb);this.$k.zE(z)}getAccessToken(d,z){la.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");
let T=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(T=this.Ai.zaa(d.DdaMethod.ControlId));const ya=(sb,cc)=>{var Fc;if(sb===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)sb=this.$k.tR(),sb[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=cc.accessToken,z(sb);else{cc=this.Ai.aY(T);const Wc=null!==cc.OwnerAddinStoreType?cc.OwnerAddinStoreType:cc.PrimaryMarketplace.MarketplaceType;la.ULS.sendTraceTag(537163202,0,10,
`${({["errorCode"]:sb.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(nb.DdaFacade.getSolutionId(cc,this.$),Wc,null===(Fc=cc.AssetMarketplace)||void 0===Fc?void 0:Fc.SolutionId,null,null,cc.PrimaryMarketplace.MarketplaceRef),["storeType"]:Wc})}.`);this.$k.lo(sb,z)}};da.nd.Aa()?void oa.a.resolve(da.nd,{va:1}).then(sb=>{const cc=this.Ai.Cl,Fc=Ub.getInstance();sa.a.getInstance(cc,sb,Fc).getAccessToken(T,!0,d,ya)}):Oa.TaskExtensions.Xa(ed.GetServiceTaskFactory.create(this.$.la,137,this.$.ya,
1),sb=>{const cc=this.Ai.Cl,Fc=Ub.getInstance();sa.a.getInstance(cc,sb.result,Fc).getAccessToken(T,!0,d,ya)},this.$.ya)}getAuthContext(d,z){const T=()=>{var ya=this.Ai.Cl,sb=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(sb=this.Ai.zaa(d.DdaMethod.ControlId));ya=ya.getOsfControl(sb);if(ya.isFirstParty()){ya=ya.getManifest();sb=ya.getMarketplaceID();var cc=ya.getWebApplicationId(),Fc=ya.getWebApplicationMsaId();Db.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(sb).then(Wc=>
{const id=this.$k.tR(),Dd={};Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=cc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Fc||cc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Wc.upn;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Wc.userId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Wc.authority;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=yc.a.eFi(Wc.authorityType);Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Wc.isAnonymous;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Wc.tenantId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Wc.supportsAuthToken;id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Dd;z(id)},Wc=>{const id=this.$k.tR(),Dd={},ee=new yc.a;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=cc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Fc||cc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
ee.upn;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ee.userId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=ee.authority;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=ee.authorityType;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ee.isAnonymous;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=ee.tenantId;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Wc;Dd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=
ee.supportsAuthToken;id[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Dd;id.Error=1;z(id)})}};da.nd.Aa()?void oa.a.resolve(da.nd,{va:1}).then(()=>{T()}):Oa.TaskExtensions.Xa(ed.GetServiceTaskFactory.create(this.$.la,137,this.$.ya,1),()=>{T()},this.$.ya)}hNd(d,z){let T=d.DdaMethod.ControlId;ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(T=this.Ai.zaa(d.DdaMethod.ControlId));d=ab.hNd(this.Ai.Cl,T);d.errorCode===Kb.a.success?(d=Object.assign({},
this.$k.tR(),d.context),z(d)):this.$k.lo(d.errorCode,z)}executeFeature(d,z){32===ea.AFrameworkApplication.yh.gl(d[0],2)?z(this.$k.tR()):this.$k.lo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,z)}queryFeature(d,z){d=[32===ea.AFrameworkApplication.yh.gl(d[0],1),!0];d=Object.assign({},this.$k.tR(),d);z(d)}ljj(d){const z=ca.f(this.$).ha;return 16===z.Ck&&!!z.$e.Lh&&!!z.$e.Lh.floatingObject&&zd.a.equals(z.$e.Lh.floatingObject.id,d,!0)}$Kd(d){const z=ca.f(this.$).ha;return z.qa.Bn?1===z.Ck||this.ljj(d)?
z.Hva:null:null}fKc(d,z){return 1!==d&&2!==d&&3!==d?(this.$k.lo(Kb.a.Rgf,z),!1):!0}r3d(d,z,T){const ya={};ya.a=this.$.ua.UserSessionId;ya.b=d;ya.c=z;ya.d=null;ya.e=T;Ee.b().Ll(37,ya)}Rqb(d,z,T,ya,sb){T=void 0===T?null:T;ya=void 0===ya?null:ya;sb=void 0===sb?null:sb;const cc={};d&&(cc.ServerCorrelationId=d);void 0!==z&&null!==z&&(cc.Source=z);T&&(cc.ErrorType=T);ya&&(cc.MessageId=ya);sb&&(cc.StatusDescription=sb);ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&ya&&"ExternalDataRefreshFailed"===
ya&&(cc.StatusDescription="");la.ULS.sendTraceTag(50688452,0,50,mc.a.Ci(cc))}y8j(d){let z=new Promise(T=>{T(null)});for(let T=0;T<d.length;T++)z=this.x8j(z,d[T]);return z}x8j(d,z){const T=this;return Lo(function*(){if(!z)return la.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),d.then(()=>Promise.reject(ff.alb(Lb.generalException,Yd.a.instance.ia(1765),null)));switch(z.actionType){case 1:case 2:d=d.then(()=>{const cc=da.xb.Aa()?T.Ai:Object(wa.a)(nb.DdaFacade,gb.a(T.$));if(cc.gs(z.controlId))switch(cc.Xn.yQd(z),
z.messageType){case 14:case 100:cc.jme.Joc(z);break;case 11:case 12:cc.Ruk.rJb(z);break;case 51:case 52:cc.Puk.rJb(z);break;case 2101:case 2102:cc.Quk.rJb(z);break;case 2E3:cc.Suk.Joc(z);break;case 2201:T.$.Kya&&cc.kme.uKh(z);break;case 2203:cc.Tuk.vKh(z);break;case 2700:ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&cc.ime.Joc(z);break;case 65541:cc.hme.tKh(z)}else la.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${z.controlId}] doesn't exist.`);return Promise.resolve(null)});
break;case 3:d=d.then(()=>{T.i2i(z);return Promise.resolve(null)});break;case 15:ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(d=d.then(()=>{T.y4i(z);return Promise.resolve(null)}));break;case 4:d=d.then(()=>{var cc=ca.f(T.$).ha.qa.activeCell;cc.top!==z.row+1&&cc.left!==z.column+1&&(cc=xb.x(Ba.Range.vi(z.row+1,z.column+1),T.$),ca.f(T.$).ep(cc,null,null,null,3,"DdaMethodHandler.ShowCard"));da.H.Aa()?void oa.a.resolve(da.H,{va:0}).then(Fc=>{Fc.z8a(z.row+1,z.column+1,1,!1,!1)}):
jd.a(T.$,243,242,0,Fc=>{Fc.z8a(z.row+1,z.column+1,1,!1,!1)});return Promise.resolve(null)});break;case 7:d=d.then(()=>{(da.xb.Aa()?T.Ai:Object(wa.a)(nb.DdaFacade,gb.a(T.$))).Xn.jtf(z.controlId,z.isEnableEvents);return Promise.resolve(null)});break;case 5:d=d.then(()=>T.hai(z));break;case 6:d=d.then(()=>T.A2j(z));break;case 8:d=d.then(()=>{ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&(da.xb.Aa()?T.Ai:Object(wa.a)(nb.DdaFacade,gb.a(T.$))).dXh();
const cc=new Ae.a(Ze.a.hq,5,null);Zd.a(T.$).Xy(cc);return Promise.resolve(null)});break;case 9:d=d.then(()=>T.jCk(z));break;case 10:d=d.then(()=>T.kfl(z));break;case 11:d=d.then(()=>T.jfl());break;case 12:d=d.then(()=>T.gfl());break;case 13:d=d.then(()=>T.hfl(z));break;case 14:d=d.then(()=>T.ifl(z));break;case 16:d=d.then(()=>Promise.resolve(z));break;case 17:d=d.then(()=>T.eyk(z,Object(wa.a)(nb.DdaFacade,da.xb.Aa()?T.Ai:gb.a(T.$))));break;case 18:ca.f(T.$).focus();break;case 19:T.OOf(z.entryType,
!1,z.options);break;case 20:T.OOf(z.entryType,!0,z.options);break;case 21:const ya=da.xb.Aa()?T.Ai:gb.a(T.$);d=d.then(()=>ya.hme.L1i(z));break;case 22:const sb=da.xb.Aa()?T.Ai:gb.a(T.$);d=d.then(()=>sb.hme.M1i(z));break;case 23:(xa.a.iWb(T.$)||xa.a.hV())&&T.Ai.FJg.n5i(z.worksheetId,z.anchorCell,z.values,z.options);break;case 24:(xa.a.iWb(T.$)||xa.a.hV())&&T.Ai.FJg.a3i(z.worksheetId);break;default:d=d.then(()=>Promise.reject(ff.alb(Lb.zHh,Yd.a.instance.ia(1766),null)))}return d})}y4i(d){var z=(da.xb.Aa()?
this.Ai:Object(wa.a)(nb.DdaFacade,gb.a(this.$))).gs(d.controlId);if(z&&!(0===d.operationType^!z.xqa)){ca.f(this.$).yUb=!0;switch(d.operationType){case 0:var T=new md.a(document.createElement("input"));T.text=d.range;z.sdj(ca.f(this.$).co.C9h(T,new Ne.a(this.$)));z.xqa.startEdit(!0);break;case 1:z.wEg();this.rangePicker=null;break;case 2:z.xqa.o7g(d.range);break;case 3:z.xqa.o7g(d.startingRange);z=d.expandSelection;T=d.getNextDataRegionCell;let ya=0;switch(d.keyboardDirectionValue){case 2:ya=38;d=
z&&T?105288353:z?-31900117:T?542791952:137938150;break;case 3:ya=40;d=z&&T?-1297307319:z?-1603798598:T?1713663844:-798660877;break;case 0:ya=37;d=z&&T?-403586027:z?2039316657:T?-2012742350:-1470715894;break;case 1:ya=39;d=z&&T?784916030:z?589730764:T?1324884057:-1231471547;break;default:d=1461300262}z=this.ptc("keydown",ya,z,T);ca.f(this.$).p6b(z,new tb.a(d,1,0,8,null))}ca.f(this.$).yUb=!1}}ptc(d,z,T,ya){const sb=document.createEvent("KeyboardEvent");if(oc.a.aJ)sb.initKeyboardEvent(d,!1,!1,window.self,
"A",0,ya,!1,T,!1);else{let cc="";T&&(cc+="Shift");ya&&(cc+=0<cc.length?" Control":"Control");sb.initKeyboardEvent(d,!1,!1,window.self,"A",0,cc,!1,"en-US")}d=new Sys.UI.DomEvent(sb);d.keyCode=z;return d}i2i(d){switch(d.operationType){case 1:void oa.a.resolve(da.Wc,{va:0}).then(z=>{z.ble()});break;case 2:if(d=(da.xb.Aa()?this.Ai:Object(wa.a)(nb.DdaFacade,gb.a(this.$))).gs(d.controlId))d.JIc=!0,d.fyg()}}hai(d){const z=d.fileBase64;return z&&z.length>this.$.ua.CreateWorkbookMaxAllowedBase64Size?Promise.reject(ff.alb(Lb.invalidArgument,
Yd.a.instance.ia(1769),"Application.CreateWorkbook")):(new Promise((T,ya)=>{const sb=new xc.a;sb.Ph=4;sb.hp(ea.AFrameworkApplication.fa.ka("IsNewStringEnabled")?CommonUiStrings.GeneralAddInMessageDialogTitle:CommonUIStrings.l_GeneralAddInMessageDialogTitle,ea.AFrameworkApplication.fa.ka("IsNewStringEnabled")?CommonUiStrings.NewFileAPIConsentMessage:CommonUIStrings.l_NewFileAPIConsentMessage,1,cc=>{2!==cc&&0!==cc||ya(ff.alb(Lb.obe,Yd.a.instance.ia(1768),"Application.CreateWorkbook"));cc=new zb("blank",
"agave",z?"streamBase64":"streamEmpty",z);this.Ieg.create(T,ya,cc).cib()})})).then(T=>{this.Txc.set(d.fakeFileId,T);return Promise.resolve(null)},T=>T?Promise.reject(T):Promise.reject(ff.alb(Lb.generalException,Yd.a.instance.ia(1765),"Application.CreateWorkbook")))}A2j(d){return new Promise((z,T)=>{if(this.Txc.has(d.fakeFileId)){const ya=this.Txc.get(d.fakeFileId);T=new xc.a;T.Ph=4;ea.AFrameworkApplication.fa.ka("IsNewStringEnabled")?T.hp(CommonUiStrings.GeneralAddInMessageDialogTitle,CommonUiStrings.OpenWindowConsentMessage,
1,sb=>{1===sb&&vd.HelperMethods.Cm(ya,void 0,void 0,"DdaMethodHandler.fileUrl");z(null)}):T.hp(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,sb=>{1===sb&&vd.HelperMethods.Cm(ya,void 0,void 0,"DdaMethodHandler.fileUrl");z(null)})}else T(ff.alb(Lb.generalException,Yd.a.instance.ia(1765),"Document.Open"))})}jCk(d){return new Promise(z=>{(da.xb.Aa()?this.Ai:Object(wa.a)(nb.DdaFacade,gb.a(this.$))).GJg=d.runtimeCalculationMode;const T=oa.a.nh(da.Cd);T&&T.L7d(3===
d.runtimeCalculationMode);z(null)})}kfl(d){xa.a.kYb(this.$)&&(da.Wb.Aa()?this.externalLinksManager:this.$.la.kh(331)).Bwb(0,d.urlStr,!0,!0,null);return Promise.resolve(null)}jfl(){xa.a.kYb(this.$)&&(da.Wb.Aa()?this.externalLinksManager:this.$.la.kh(331)).Bwb(1,null,!0,!0,null);return Promise.resolve(null)}gfl(){xa.a.kYb(this.$)&&(da.Wb.Aa()?this.externalLinksManager:this.$.la.kh(331)).ywc();return Promise.resolve(null)}hfl(d){xa.a.kYb(this.$)&&(da.Wb.Aa()?this.externalLinksManager:this.$.la.kh(331)).Bwb(5,
d.urlStr,!0,!0,null);return Promise.resolve(null)}ifl(d){if(xa.a.kYb(this.$)){const z=da.Wb.Aa()?this.externalLinksManager:this.$.la.kh(331);for(const T of z.bna)T.IsActive&&T.HostEditUrl&&T.UrlStr===d.hostEditUrlStr&&vd.HelperMethods.Cm(T.HostEditUrl,"_blank")}return Promise.resolve(null)}eyk(d,z){const T=ub.a.bW;d=mc.a.Sp(d.payload);const ya={};"eventId"in d&&"payload"in d&&(ya.eventId=d.eventId,ya.payload=d.payload);z.HM(2201,T,mc.a.Ci(ya));return Promise.resolve(null)}OOf(d,z,T){const ya=oa.a.nh(da.C);
ya&&(d=this.$Fi(d))&&(z?ya.removeEntry(d):ya.jmc(d,T))}$Fi(d){switch(d){case 0:return 64;case 1:if(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}Ind(d){d=Object(wa.a)(Tc.a,this.$.sa.getItemByName(d));(null===d||void 0===d?0:d.visible)&&d.activate({disableAutoFocusOnGrid:!0,scenario:"dda"})}Z6g(d,z,T,ya){var sb=d.qa.Jy;const cc=sb<z.length&&z[sb].contains(d.qa.activeCell);d=cc?d.qa.activeCell:z[0].topLeft;sb=cc?sb:0;ca.f(this.$).V0(z,sb,T,null,d,null,null,
3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===ya)}static get zbi(){ff.YDa||(ff.YDa={},ff.YDa[Microsoft.Office.WebExtension.CoercionType.Table]=1,ff.YDa[Microsoft.Office.WebExtension.CoercionType.Text]=2,ff.YDa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,ff.YDa[Microsoft.Office.WebExtension.CoercionType.Html]=4,ff.YDa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return ff.YDa}static get Cbi(){ff.SBb||(ff.SBb={},ff.SBb[Microsoft.Office.WebExtension.FilterType.All]=1,
ff.SBb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return ff.SBb}static get Dbi(){ff.TBb||(ff.TBb={},ff.TBb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,ff.TBb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return ff.TBb}static BHf(d){if(!d||!d.length)return null;const z=Array(d.length/2);for(let T=0;T<d.length/2;T++)z[T]={},z[T].Name=d[2*T],z[T].Value=d[2*T+1];return z}static KXi(d){if(!d||!d.length)return null;const z=Array(2*d.length);for(let T=0;T<d.length;T++)z[2*
T]=d[T].Name,z[2*T+1]=d[T].Value;return z}static JHd(d){if(!d||!d.length)return null;const z=Array(d.length);for(let T=0,ya=d.length;T<ya;T++){const sb=d[T].length;if(sb){z[T]=Array(sb);for(let cc=0;cc<sb;cc++)z[T][cc]=null==d[T][cc]?null:d[T][cc].toString()}else return null}return z}static Erc(d){return"string"===typeof d?lc.a.Pw(ff.zbi,d,0):d}static Fzf(d){return"string"===typeof d?lc.a.Pw(ff.Cbi,d,0):d}static P8g(d){return"string"===typeof d?lc.a.Pw(ff.Dbi,d,0):d}static Ajj(d){switch(d.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static Ntd(d,
z){const T={};T.CoerceType=d;1===T.CoerceType?(T.Data=ff.JHd(z.Rows),T.Headers=ff.JHd(z.Headers)):T.Data=ff.JHd(z);return T}static Uaf(d){return 1===d.CoerceType?{["Headers"]:d.Headers,["Rows"]:d.Data}:d.Data}static lGc(d){return 1===d.CoerceType?!d.Data&&!d.Headers:!d.Data}static hLf(d){let z="Unknown";if(!d)return z;for(let T=0;T<d.length;T++)if(d[T].Name.toLowerCase()===vb.a.Uuk){z=d[T].Value;break}return z}static uLk(d){if(!d)return!1;const z=vb.a.CMj.toLowerCase();for(let T=0;T<d.length;T++)if(d[T].Name.toLowerCase()===
z)return!0;return!1}static alb(d,z,T){const ya={};ya.Code=d;ya.Message=z;ya.Location=T;ya.ActionIndex=0;return ya}}ff.YDa=null;ff.SBb=null;ff.TBb=null;ff.oce=0;Object(ha.a)(ff,"DdaMethodHandler",null,[34,4]);var Qa=a(210);class Ob{constructor(){this.zad=this.Aad=this.ghd=this.smd=null}get operations(){this.ghd||(this.ghd=new Qa.a,this.ni());return this.ghd}get R4c(){this.smd||(this.smd=new Qa.a,this.Sm());return this.smd}get Zyf(){this.zad||(this.zad=new Qa.a);return this.zad}get featureGates(){this.Aad||
(this.Aad=new Qa.a,this.initializeFeatureGates());return this.Aad}Sm(){}initializeFeatureGates(){}Gj(d){this.R4c.add(d)}di(d){this.operations.contains(d)||this.operations.add(d)}p2e(d){this.Zyf.add(d)}}Object(ha.a)(Ob,"MacroRecorderEventBase",null,[]);class Pc extends Ob{constructor(){super()}get eventId(){return 130}ni(){this.di(100)}}Object(ha.a)(Pc,"AccessibilityCheckRunEvent",Ob,[]);class Cd extends Ob{constructor(){super()}get eventId(){return 160}ni(){this.di(241)}Sm(){this.Gj(d=>d.addToPrintArea)}}
Object(ha.a)(Cd,"AddedToPrintAreaEvent",Ob,[]);class Ud extends Ob{constructor(){super()}get eventId(){return 65}ni(){this.di(516)}}Object(ha.a)(Ud,"AutoFilterToggledEvent",Ob,[]);class Wd extends Ob{constructor(){super()}get eventId(){return 118}ni(){this.di(502)}Sm(){this.Gj(d=>!(d.$lb().FirstColumn===d.$lb().LastColumn&&d.$lb().FirstRow===d.$lb().LastRow))}}Object(ha.a)(Wd,"AutoSumEvent",Ob,[]);class le extends Ob{constructor(){super()}get eventId(){return 223}ni(){this.di(1032)}}Object(ha.a)(le,
"CellImageAltTextAppliedEvent",Ob,[]);class Fa extends Ob{constructor(d,z){super();this.qsa=d;this.lcl=z}get eventId(){return this.qsa}ni(){this.di(529);this.di(594)}Sm(){this.Gj(d=>this.lcl.includes(d.yNd()))}}Object(ha.a)(Fa,"ChartPropertyAppliedEventBase",Ob,[]);class mb extends Fa{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(ha.a)(mb,"ChartAxisChangedEvent",Fa,[]);class e extends Fa{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,
308,309,310,311])}}Object(ha.a)(e,"ChartAxisTitleChangedEvent",Fa,[]);class Ra extends Fa{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(ha.a)(Ra,"ChartDataLabelsChangedEvent",Fa,[]);class O extends Fa{constructor(){super(76,[-100])}}Object(ha.a)(O,"ChartDataSelectedEvent",Fa,[]);class qa extends Fa{constructor(){super(83,[500,501,502])}}Object(ha.a)(qa,"ChartDataTableChangedEvent",Fa,[]);class ob extends Ob{constructor(){super()}}Object(ha.a)(ob,"RichApiRequestExecutedEventBase",
Ob,[]);class R extends ob{constructor(){super()}get eventId(){return 117}RK(d){R.Gia||(R.Gia=new Fb.a(jc.a.zm()),R.Gia.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),R.Gia.add("fa000000014"));return!!d&&R.Gia.contains(d.toLowerCase())}ni(){this.di(507);this.di(10);this.di(576)}Sm(){this.Gj(d=>Object(ia.a)(Ed,d)&&(d=Object(wa.a)(Ed,d),d.isValid&&this.RK(d.source))?(la.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${d.eventId}`),!0):!1)}}
R.Gia=null;Object(ha.a)(R,"ChartFormatRichApiRequestExecutedEvent",ob,[]);class Za extends Fa{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(ha.a)(Za,"ChartGridlinesChangedEvent",Fa,[]);class Cb extends Ob{constructor(){super()}get eventId(){return 66}ni(){this.di(528)}}Object(ha.a)(Cb,"ChartInsertedEvent",Ob,[]);class rc extends Fa{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(ha.a)(rc,"ChartLegendChangedEvent",Fa,[]);class ma extends Fa{constructor(){super(75,
[-101])}}Object(ha.a)(ma,"ChartRowColumnSwitchedEvent",Fa,[]);class qb extends Fa{constructor(){super(79,[0,1,2,-102])}}Object(ha.a)(qb,"ChartTitleChangedEvent",Fa,[]);class Xb extends Fa{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(ha.a)(Xb,"ChartTypeChangedEvent",Fa,[]);class qc extends Ob{constructor(){super()}get eventId(){return 131}ni(){this.di(521)}}
Object(ha.a)(qc,"ConnectorFloatingObjectResizedEvent",Ob,[]);class Uc extends Ob{constructor(){super()}get eventId(){return 129}ni(){this.di(109)}}Object(ha.a)(Uc,"EntitySelectedEvent",Ob,[]);class ld extends Ob{constructor(){super()}get eventId(){return 49}ni(){this.di(149);this.di(147)}}Object(ha.a)(ld,"FindCellEvent",Ob,[]);class yd extends Ob{constructor(){super()}get eventId(){return 96}ni(){this.di(122)}}Object(ha.a)(yd,"FloatingObjectAltTextAppliedEvent",Ob,[]);class fe extends Ob{constructor(){super()}get eventId(){return 93}ni(){this.di(522)}}
Object(ha.a)(fe,"FloatingObjectDeletedEvent",Ob,[]);class De extends Ob{constructor(){super()}get eventId(){return 94}ni(){this.di(524)}}Object(ha.a)(De,"FloatingObjectMovedAndResizedEvent",Ob,[]);class Tb extends Ob{constructor(){super()}get eventId(){return 95}ni(){this.di(523)}}Object(ha.a)(Tb,"FloatingObjectRotatedEvent",Ob,[]);class Yc extends Ob{constructor(){super()}get eventId(){return 100}ni(){this.di(543)}}Object(ha.a)(Yc,"GroupDetailsShownOrHiddenEvent",Ob,[]);class Ld extends Ob{constructor(){super()}get eventId(){return 154}ni(){this.di(125)}}
Object(ha.a)(Ld,"HyperlinksRemovedFromRangeEvent",Ob,[]);class he extends ob{constructor(){super()}get eventId(){return 125}RK(d){he.Gia||(he.Gia=new Fb.a(jc.a.zm()),he.Gia.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),he.Gia.add("fa000000005"));return!!d&&he.Gia.contains(d.toLowerCase())}ni(){this.di(507);this.di(10);this.di(576)}Sm(){this.Gj(d=>Object(ia.a)(Ed,d)?(d=Object(wa.a)(Ed,d),d.isValid&&this.RK(d.source)):!1)}}he.Gia=null;Object(ha.a)(he,"IdeasRichApiRequestExecutedEvent",ob,[]);class Ke extends Ob{constructor(){super()}get eventId(){return 136}ni(){this.di(115)}}
Object(ha.a)(Ke,"LinkedEntityConvertedEvent",Ob,[]);class Me extends Ob{constructor(){super()}get eventId(){return 148}ni(){this.di(114)}}Object(ha.a)(Me,"LinkedEntityDisambiguationPaneToggledEvent",Ob,[]);class df extends Ob{constructor(){super()}get eventId(){return 127}ni(){this.di(119)}}Object(ha.a)(df,"MovedToEdgeEvent",Ob,[]);class xf extends Ob{constructor(){super()}get eventId(){return 135}ni(){this.di(191)}}Object(ha.a)(xf,"NamedSheetViewCreatedEvent",Ob,[]);class fg extends Ob{constructor(){super()}get eventId(){return 166}ni(){this.di(200)}}
Object(ha.a)(fg,"NamedSheetViewDeletedEvent",Ob,[]);class xg extends Ob{constructor(){super()}get eventId(){return 133}ni(){this.di(192)}}Object(ha.a)(xg,"NamedSheetViewExitedEvent",Ob,[]);class lg extends Ob{constructor(){super()}get eventId(){return 162}ni(){this.di(199)}}Object(ha.a)(lg,"NamedSheetViewRenamedEvent",Ob,[]);class Vf extends Ob{constructor(){super()}get eventId(){return 167}ni(){this.di(195)}}Object(ha.a)(Vf,"NamedSheetViewSwitchedEvent",Ob,[]);class dg extends Ob{constructor(){super()}get eventId(){return 99}ni(){this.di(174)}}
Object(ha.a)(dg,"OutlineLevelSetEvent",Ob,[]);class Gg extends Ob{constructor(){super()}get eventId(){return 156}ni(){this.di(244)}}Object(ha.a)(Gg,"PageBreakInsertedEvent",Ob,[]);class Hg extends Ob{constructor(){super()}get eventId(){return 157}ni(){this.di(245)}}Object(ha.a)(Hg,"PageBreakRemovedEvent",Ob,[]);class Mg extends Ob{constructor(){super()}get eventId(){return 158}ni(){this.di(246)}}Object(ha.a)(Mg,"PageBreaksAllResetEvent",Ob,[]);class Ff extends Ob{constructor(){super()}get eventId(){return 112}ni(){this.di(503)}Sm(){this.Gj(d=>
!!d.pasteParameters.ClientEstimationFloatingObjectId&&2===d.pasteParameters.CopyPasteTargetType&&!d.isFromCurrentSession)}}Object(ha.a)(Ff,"PasteArtOtherWorkbookEvent",Ob,[]);class yf extends Ob{constructor(){super()}get eventId(){return 52}ni(){this.di(503)}Sm(){this.Gj(d=>!!d.pasteParameters.ClientEstimationFloatingObjectId&&2===d.pasteParameters.CopyPasteTargetType&&d.isFromCurrentSession)}}Object(ha.a)(yf,"PasteArtSameWorkbookEvent",Ob,[]);class mg extends Ob{constructor(){super()}get eventId(){return 110}ni(){this.di(204)}}
Object(ha.a)(mg,"PasteHtmlEvent",Ob,[]);class jh extends Ob{constructor(){super()}get eventId(){return 35}ni(){this.di(506)}}Object(ha.a)(jh,"PasteRangeEvent",Ob,[]);class bg extends Ob{constructor(){super()}get eventId(){return 111}ni(){this.di(503)}Sm(){this.Gj(d=>1===d.pasteParameters.CopyPasteTargetType)}}Object(ha.a)(bg,"PasteShadowWorkbookRangeEvent",Ob,[]);class Og extends Ob{constructor(){super()}get eventId(){return 42}ni(){this.di(180)}}Object(ha.a)(Og,"PasteStringEvent",Ob,[]);class rg extends Ob{constructor(){super()}get eventId(){return 134}ni(){this.di(220)}}
Object(ha.a)(rg,"PendingMergeEvent",Ob,[]);class Ma extends Ob{constructor(){super()}get eventId(){return 122}ni(){this.di(510)}}Object(ha.a)(Ma,"PictureInsertedEvent",Ob,[]);class Na extends Ob{constructor(){super()}get eventId(){return 153}ni(){this.di(161)}}Object(ha.a)(Na,"PivotDrillToggledEvent",Ob,[]);class Qc extends Ob{constructor(d,z){super();this.qsa=d;this.opType=z}get eventId(){return this.qsa}ni(){this.di(225)}Sm(){this.Gj(d=>d.opType===this.opType)}}Object(ha.a)(Qc,"PivotTableSettingsChangedEventBase",
Ob,[]);class ce extends Qc{constructor(){super(171,4)}}Object(ha.a)(ce,"PivotTableAllItemLabelsRepeatedEvent",Qc,[]);class ve extends Qc{constructor(){super(184,17)}}Object(ha.a)(ve,"PivotTableAltTextDescriptionChangedEvent",Qc,[]);class Ve extends Qc{constructor(){super(183,16)}}Object(ha.a)(Ve,"PivotTableAltTextTitleChangedEvent",Qc,[]);class vf extends Qc{constructor(){super(173,6)}}Object(ha.a)(vf,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Qc,[]);class Kf extends Qc{constructor(){super(172,
5)}}Object(ha.a)(Kf,"PivotTableBlankLineAfterEachItemToggledEvent",Qc,[]);class ng extends Qc{constructor(){super(170,3)}}Object(ha.a)(ng,"PivotTableColumnGrandTotalShownEvent",Qc,[]);class Bf extends Ob{constructor(){super()}get eventId(){return 98}ni(){this.di(132)}}Object(ha.a)(Bf,"PivotTableCreatedEvent",Ob,[]);class Uf extends Qc{constructor(){super(177,10)}}Object(ha.a)(Uf,"PivotTableDisplayErrorStringToggledEvent",Qc,[]);class Qf extends Qc{constructor(){super(178,11)}}Object(ha.a)(Qf,"PivotTableDisplayNullStringToggledEvent",
Qc,[]);class ug extends Qc{constructor(){super(179,12)}}Object(ha.a)(ug,"PivotTableErrorStringChangedEvent",Qc,[]);class ag extends Qc{constructor(){super(174,7)}}Object(ha.a)(ag,"PivotTableExpandCollapseButtonsShownEvent",Qc,[]);class Dg extends Qc{constructor(){super(187,20)}}Object(ha.a)(Dg,"PivotTableIndentChangedEvent",Qc,[]);class Tg extends Qc{constructor(){super(176,9)}}Object(ha.a)(Tg,"PivotTableItemsWithNoDataOnColumnsShownEvent",Qc,[]);class ig extends Qc{constructor(){super(175,8)}}Object(ha.a)(ig,
"PivotTableItemsWithNoDataOnRowsShownEvent",Qc,[]);class Yg extends Qc{constructor(){super(186,19)}}Object(ha.a)(Yg,"PivotTableLayoutTypeSetEvent",Qc,[]);class vh extends Qc{constructor(){super(180,13)}}Object(ha.a)(vh,"PivotTableNullStringChangedEvent",Qc,[]);class Zg extends Ob{constructor(){super()}get eventId(){return 149}ni(){this.di(219)}}Object(ha.a)(Zg,"PivotTablePivotLocationChangedEvent",Ob,[]);class Qg extends Ob{constructor(){super()}get eventId(){return 102}ni(){this.di(145)}}Object(ha.a)(Qg,
"PivotTablePivotedEvent",Ob,[]);class Wg extends Qc{constructor(){super(182,15)}}Object(ha.a)(Wg,"PivotTableRefreshDataOnLoadToggledEvent",Qc,[]);class dh extends Ob{constructor(){super()}get eventId(){return 104}ni(){this.di(50)}Sm(){this.Gj(d=>!!d.pivotTableId&&!!d.pivotTableName)}}Object(ha.a)(dh,"PivotTableRefreshedEvent",Ob,[]);class gh extends Qc{constructor(){super(168,1)}}Object(ha.a)(gh,"PivotTableRenamedEvent",Qc,[]);class Gh extends Qc{constructor(){super(169,2)}}Object(ha.a)(Gh,"PivotTableRowGrandTotalShownEvent",
Qc,[]);class Ch extends Qc{constructor(){super(181,14)}}Object(ha.a)(Ch,"PivotTableSaveSourceDataWithFileToggledEvent",Qc,[]);var Dh=a(741);class Xg extends Ob{constructor(){super()}get eventId(){return 155}ni(){this.di(131)}Sm(){this.Gj(d=>{d=Object(wa.a)(Dh.a,d);return!!d&&!!d.getFieldName()&&!!d.hierarchyName})}}Object(ha.a)(Xg,"PivotTableSortedEvent",Ob,[]);class og extends Qc{constructor(){super(185,18)}}Object(ha.a)(og,"PivotTableSubTotalsVisibilitySettingSetEvent",Qc,[]);class Ug extends Ob{constructor(){super()}get eventId(){return 206}ni(){this.di(560)}}
Object(ha.a)(Ug,"PivotValueFieldSettingAppliedEvent",Ob,[]);class Rg extends Ob{constructor(){super()}get eventId(){return 161}ni(){this.di(243)}}Object(ha.a)(Rg,"PrintAreaClearedEvent",Ob,[]);class fi extends Ob{constructor(){super()}get eventId(){return 159}ni(){this.di(241)}Sm(){this.Gj(d=>!d.addToPrintArea)}}Object(ha.a)(fi,"PrintAreaSetEvent",Ob,[]);class Sg extends Ob{constructor(){super()}get eventId(){return 57}ni(){this.di(517)}}Object(ha.a)(Sg,"RangeAutoFilterClearedEvent",Ob,[]);class Bg extends Ob{constructor(d,
z){super();this.qsa=d;this.jBe=z}get eventId(){return this.qsa}ni(){this.di(11)}Sm(){this.Gj(d=>16===d.M0().ValidMembers);this.Gj(d=>d.M0().Font.ValidMembers===this.jBe)}}Object(ha.a)(Bg,"RangeFontFormattedEventBase",Ob,[]);class zg extends Bg{constructor(){super(3,4)}}Object(ha.a)(zg,"RangeBoldedEvent",Bg,[]);class Ng extends Ob{constructor(){super()}get eventId(){return 2}ni(){this.di(11)}Sm(){this.Gj(d=>128===d.M0().ValidMembers)}}Object(ha.a)(Ng,"RangeBorderedEvent",Ob,[]);class Ig{}Ig.Ysb="Table";
Ig.eRc="Sheet";Object(ha.a)(Ig,"MacroRecorderEventConstants",null,[]);class bh extends Ob{constructor(){super()}get eventId(){return 113}ni(){this.di(208)}Sm(){this.Gj(d=>d.getParameters().FilterType===Ig.eRc)}}Object(ha.a)(bh,"RangeCheckedItemsFilteredEvent",Ob,[]);class wh extends Ob{constructor(){super()}get eventId(){return 109}ni(){this.di(105)}}Object(ha.a)(wh,"RangeConditionalFormattingCreatedEvent",Ob,[]);class Ga extends Ob{constructor(){super()}get eventId(){return 124}ni(){this.di(221)}}
Object(ha.a)(Ga,"RangeConditionalFormattingRuleDeletedEvent",Ob,[]);class Qb extends Ob{constructor(){super()}get eventId(){return 29}ni(){this.di(508)}Sm(){this.Gj(d=>3===d.FD()||1===d.FD()||4===d.FD())}}Object(ha.a)(Qb,"RangeContentClearedEvent",Ob,[]);class wc extends Ob{constructor(){super()}get eventId(){return 40}ni(){this.di(104)}}Object(ha.a)(wc,"RangeCopiedCutCellsInsertedEvent",Ob,[]);class S extends Ob{constructor(){super()}get eventId(){return 114}ni(){this.di(209)}Sm(){this.Gj(d=>d.getParameters().FilterType===
Ig.eRc)}}Object(ha.a)(S,"RangeCustomFilteredEvent",Ob,[]);class eb extends Ob{constructor(){super()}get eventId(){return 106}ni(){this.di(121)}}Object(ha.a)(eb,"RangeDataValidationChangedEvent",Ob,[]);class ec extends Bg{constructor(){super(4,64)}}Object(ha.a)(ec,"RangeDoubleUnderlinedEvent",Bg,[]);class Lc extends Ob{constructor(){super()}get eventId(){return 69}ni(){this.di(190)}}Object(ha.a)(Lc,"RangeDuplicatesRemovedEvent",Ob,[]);class Ad extends Ob{constructor(){super()}get eventId(){return 1}ni(){this.di(527);
this.di(12)}}Object(ha.a)(Ad,"RangeEditedEvent",Ob,[]);class pd extends Ob{constructor(){super()}get eventId(){return 164}ni(){this.di(255)}Sm(){this.Gj(d=>4===d.actionType)}}Object(ha.a)(pd,"RangeExternalLinksBrokeAllLinksEvent",Ob,[]);class de extends Ob{constructor(){super()}get eventId(){return 119}ni(){this.di(255)}Sm(){this.Gj(d=>3===d.actionType)}}Object(ha.a)(de,"RangeExternalLinksBrokeLinkEvent",Ob,[]);class Ge extends Ob{constructor(){super()}get eventId(){return 205}ni(){this.di(256)}initializeFeatureGates(){this.p2e("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}
Object(ha.a)(Ge,"RangeExternalLinksChangeSourceEvent",Ob,[]);class Re extends Ob{constructor(){super()}get eventId(){return 163}ni(){this.di(553)}Sm(){this.Gj(d=>1===d.actionType)}}Object(ha.a)(Re,"RangeExternalLinksRefreshedAllEvent",Ob,[]);class kf extends Ob{constructor(){super()}get eventId(){return 77}ni(){this.di(553)}Sm(){this.Gj(d=>0===d.actionType)}}Object(ha.a)(kf,"RangeExternalLinksRefreshedEvent",Ob,[]);class Xf extends Ob{constructor(){super()}get eventId(){return 165}ni(){this.di(224)}}
Object(ha.a)(Xf,"RangeExternalLinksSetAutoRefreshEvent",Ob,[]);class kg extends Ob{constructor(){super()}get eventId(){return 5}ni(){this.di(11)}Sm(){this.Gj(d=>64===d.M0().ValidMembers)}}Object(ha.a)(kg,"RangeFillColoredEvent",Ob,[]);class Yf extends Ob{constructor(){super()}get eventId(){return 59}ni(){this.di(155)}}Object(ha.a)(Yf,"RangeFilledEvent",Ob,[]);class eh extends Ob{constructor(){super()}get eventId(){return 115}ni(){this.di(176)}Sm(){this.Gj(d=>d.autoFilterOptions.AutoFilterType===Ig.eRc&&
!!d.autoFilterOptions.CriteriaType)}}Object(ha.a)(eh,"RangeFilterAppliedEvent",Ob,[]);class jg extends Ob{constructor(){super()}get eventId(){return 58}ni(){this.di(176)}Sm(){this.Gj(d=>d.autoFilterOptions.AutoFilterType===Ig.eRc&&!d.autoFilterOptions.CriteriaType)}}Object(ha.a)(jg,"RangeFilterClearedEvent",Ob,[]);class Se extends Ob{constructor(){super()}get eventId(){return 41}ni(){this.di(518)}}Object(ha.a)(Se,"RangeFilterReappliedEvent",Ob,[]);class P extends Ob{constructor(){super()}get eventId(){return 86}ni(){this.di(150)}}
Object(ha.a)(P,"RangeFlashFilledEvent",Ob,[]);class Da extends Bg{constructor(){super(6,32)}}Object(ha.a)(Da,"RangeFontColoredEvent",Bg,[]);class ib extends Bg{constructor(){super(7,8)}}Object(ha.a)(ib,"RangeFontItalicizedEvent",Bg,[]);class ic extends Bg{constructor(){super(8,1)}Sm(){this.Gj(d=>16===d.M0().ValidMembers);this.Gj(d=>1===(d.M0().Font.ValidMembers&1))}}Object(ha.a)(ic,"RangeFontNamedEvent",Bg,[]);class Rc extends Bg{constructor(){super(9,2)}}Object(ha.a)(Rc,"RangeFontSizedEvent",Bg,
[]);class kd extends Ob{constructor(){super()}get eventId(){return 74}ni(){this.di(215)}}Object(ha.a)(kd,"RangeFormattedAsTableEvent",Ob,[]);class td extends Ob{constructor(){super()}get eventId(){return 97}ni(){this.di(188)}}Object(ha.a)(td,"RangeGroupedOrUngroupedEvent",Ob,[]);class Z extends Ob{constructor(){super()}get eventId(){return 60}ni(){this.di(11)}Sm(){this.Gj(d=>2===d.M0().ValidMembers)}}Object(ha.a)(Z,"RangeHorizontallyAlignedEvent",Ob,[]);class Ha extends Ob{constructor(){super()}get eventId(){return 43}ni(){this.di(526)}}
Object(ha.a)(Ha,"RangeHyperlinkAppliedEvent",Ob,[]);class Mb extends Ob{constructor(){super()}get eventId(){return 63}ni(){this.di(11)}Sm(){this.Gj(d=>256===d.M0().ValidMembers)}}Object(ha.a)(Mb,"RangeIndentChangedEvent",Ob,[]);class Zb extends Ob{constructor(){super()}get eventId(){return 53}ni(){this.di(156)}Sm(){this.Gj(d=>2===d.FD()||5===d.FD()||6===d.FD()||7===d.FD())}}Object(ha.a)(Zb,"RangeMergedEvent",Ob,[]);class gd extends Ob{constructor(){super()}get eventId(){return 107}ni(){this.di(216)}}
Object(ha.a)(gd,"RangeNamedCellStyleAppliedEvent",Ob,[]);class Nd extends Ob{constructor(){super()}get eventId(){return 12}ni(){this.di(11)}Sm(){this.Gj(d=>32===d.M0().ValidMembers)}}Object(ha.a)(Nd,"RangeNumberFormattedEvent",Ob,[]);var ae=a(1215);class qe extends Ob{constructor(){super()}get eventId(){return 108}ni(){this.di(141)}Sm(){this.Gj(d=>Object(ia.a)(ae.a,d))}}Object(ha.a)(qe,"RangeSortedEvent",Ob,[]);class Le extends Bg{constructor(){super(10,128)}}Object(ha.a)(Le,"RangeStrikedThroughEvent",
Bg,[]);class Je extends Bg{constructor(){super(11,16)}}Object(ha.a)(Je,"RangeUnderlinedEvent",Bg,[]);class cf extends Ob{constructor(){super()}get eventId(){return 61}ni(){this.di(11)}Sm(){this.Gj(d=>1===d.M0().ValidMembers)}}Object(ha.a)(cf,"RangeVerticallyAlignedEvent",Ob,[]);class If extends Ob{constructor(){super()}get eventId(){return 62}ni(){this.di(11)}Sm(){this.Gj(d=>8===d.M0().ValidMembers)}}Object(ha.a)(If,"RangeWrapTextToggledEvent",Ob,[]);class Pf extends Ob{constructor(){super()}get eventId(){return 103}ni(){this.di(51)}}
Object(ha.a)(Pf,"RefreshedAllEvent",Ob,[]);class Zf extends Ob{constructor(){super()}get eventId(){return 47}ni(){this.di(148)}}Object(ha.a)(Zf,"ReplaceAllEvent",Ob,[]);class $e extends Ob{constructor(){super()}get eventId(){return 226}ni(){this.di(1025)}}Object(ha.a)($e,"SampleTableCreatedEvent",Ob,[]);class zf extends Ob{constructor(){super()}get eventId(){return 91}ni(){this.di(532)}Sm(){this.Gj(d=>95!==d.getShapeType()&&96!==d.getShapeType()&&97!==d.getShapeType()&&98!==d.getShapeType()&&100!==
d.getShapeType()&&102!==d.getShapeType()&&103!==d.getShapeType())}}Object(ha.a)(zf,"ShapeInsertedEvent",Ob,[]);class Rf extends Ob{constructor(){super()}get eventId(){return 92}ni(){this.di(531)}}Object(ha.a)(Rf,"ShapeStyleSetEvent",Ob,[]);var Sf=a(1043);class yg extends Ob{constructor(d,z){super();this.qsa=d;this.jBe=z}get eventId(){return this.qsa}ni(){this.di(581)}Sm(){this.Gj(d=>Object(ia.a)(Sf.a,d)&&4===d.getShapeTextFormat().ValidMembers);this.Gj(d=>Object(ia.a)(Sf.a,d)&&d.getShapeTextFormat().Font.ValidMembers===
this.jBe)}}Object(ha.a)(yg,"ShapeTextFontFormattedEventBase",Ob,[]);class $g extends yg{constructor(){super(193,4)}}Object(ha.a)($g,"ShapeTextBoldedEvent",yg,[]);var rf=a(1236);class xh extends Ob{constructor(){super()}get eventId(){return 191}ni(){this.di(581)}Sm(){this.Gj(d=>Object(ia.a)(rf.a,d))}}Object(ha.a)(xh,"ShapeTextChangedEvent",Ob,[]);class kh extends yg{constructor(){super(196,32)}}Object(ha.a)(kh,"ShapeTextFontColorChangedEvent",yg,[]);class Hh extends yg{constructor(){super(197,1)}}
Object(ha.a)(Hh,"ShapeTextFontNameChangedEvent",yg,[]);class oh extends yg{constructor(){super(198,2)}}Object(ha.a)(oh,"ShapeTextFontSizeChangedEvent",yg,[]);class Zh extends Ob{constructor(){super()}get eventId(){return 199}ni(){this.di(581)}Sm(){this.Gj(d=>Object(ia.a)(Sf.a,d)&&2===d.getShapeTextFormat().ValidMembers)}}Object(ha.a)(Zh,"ShapeTextHorizontallyAlignedEvent",Ob,[]);class Di extends yg{constructor(){super(194,8)}}Object(ha.a)(Di,"ShapeTextItalicizedEvent",yg,[]);class Pi extends yg{constructor(){super(195,
16)}}Object(ha.a)(Pi,"ShapeTextUnderlinedEvent",yg,[]);class $h extends Ob{constructor(){super()}get eventId(){return 200}ni(){this.di(581)}Sm(){this.Gj(d=>Object(ia.a)(Sf.a,d)&&1===d.getShapeTextFormat().ValidMembers)}}Object(ha.a)($h,"ShapeTextVerticallyAlignedEvent",Ob,[]);class Ei extends Ob{constructor(){super()}get eventId(){return 13}ni(){this.di(138)}}Object(ha.a)(Ei,"SheetAddedEvent",Ob,[]);class Fi extends Ob{constructor(){super()}get eventId(){return 142}ni(){this.di(237)}Sm(){this.Gj(d=>
!!d.insertDeleteMultiRangeParameters);this.Gj(d=>!d.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(d=>{d=d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>d.DeltaColumn&&!d.DeltaRow&&(!!d.InsertDeleteRange.FirstRow||d.InsertDeleteRange.LastRow!==vb.a.eG)||!d.DeltaColumn&&0>d.DeltaRow&&(!!d.InsertDeleteRange.FirstColumn||d.InsertDeleteRange.LastColumn!==vb.a.PE)})}}Object(ha.a)(Fi,"SheetCellsDeletedEvent",Ob,[]);class rh extends Ob{constructor(){super()}get eventId(){return 143}ni(){this.di(237)}Sm(){this.Gj(d=>
!!d.insertDeleteMultiRangeParameters);this.Gj(d=>!d.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(d=>{d=d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<d.DeltaColumn&&!d.DeltaRow&&(!!d.InsertDeleteRange.FirstRow||d.InsertDeleteRange.LastRow!==vb.a.eG)||!d.DeltaColumn&&0<d.DeltaRow&&(!!d.InsertDeleteRange.FirstColumn||d.InsertDeleteRange.LastColumn!==vb.a.PE)})}}Object(ha.a)(rh,"SheetCellsInsertedEvent",Ob,[]);class Gi extends Ob{constructor(){super()}get eventId(){return 139}ni(){this.di(237)}Sm(){this.Gj(d=>
!!d.insertDeleteMultiRangeParameters);this.Gj(d=>!d.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(d=>0>d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Gj(d=>d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===vb.a.eG)}}Object(ha.a)(Gi,"SheetColumnDeletedEvent",
Ob,[]);class li extends Ob{constructor(){super()}get eventId(){return 138}ni(){this.di(237)}Sm(){this.Gj(d=>!!d.insertDeleteMultiRangeParameters);this.Gj(d=>!d.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(d=>0<d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Gj(d=>d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
vb.a.eG)}}Object(ha.a)(li,"SheetColumnInsertedEvent",Ob,[]);class Si extends Ob{constructor(){super()}get eventId(){return 14}ni(){this.di(137)}}Object(ha.a)(Si,"SheetDeletedEvent",Ob,[]);class qi extends Ob{constructor(){super()}get eventId(){return 137}ni(){this.di(185)}}Object(ha.a)(qi,"SheetDirectionChangedEvent",Ob,[]);class gi extends Ob{constructor(){super()}get eventId(){return 54}ni(){this.di(139)}}Object(ha.a)(gi,"SheetDuplicatedEvent",Ob,[]);class lh extends Ob{constructor(){super()}get eventId(){return 15}ni(){this.di(207)}}
Object(ha.a)(lh,"SheetNameEditedEvent",Ob,[]);class vi extends Ob{constructor(){super()}get eventId(){return 90}ni(){this.di(151)}}Object(ha.a)(vi,"SheetPaneFrozenEvent",Ob,[]);class wi extends Ob{constructor(){super()}get eventId(){return 120}ni(){this.di(226)}}Object(ha.a)(wi,"SheetPrintSettingsSavedEvent",Ob,[]);var Hi=a(1123);class Oh extends Ob{constructor(){super()}get eventId(){return 215}ni(){this.di(507)}initializeFeatureGates(){this.p2e("Microsoft.Office.Excel.SheetProtectionMacroRecording")}Sm(){this.Gj(d=>
Object.getType(d)===Hi.a)}}Object(ha.a)(Oh,"SheetProtectionPausedResumedEvent",Ob,[]);class Wf extends Ob{constructor(){super()}get eventId(){return 64}ni(){this.di(557)}}Object(ha.a)(Wf,"SheetReorderedEvent",Ob,[]);class Kg extends Ob{constructor(){super()}get eventId(){return 141}ni(){this.di(237)}Sm(){this.Gj(d=>!!d.insertDeleteMultiRangeParameters);this.Gj(d=>!d.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Gj(d=>0>d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Gj(d=>d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===vb.a.PE)}}Object(ha.a)(Kg,"SheetRowDeletedEvent",Ob,[]);class Ph extends Ob{constructor(){super()}get eventId(){return 140}ni(){this.di(237)}Sm(){this.Gj(d=>!!d.insertDeleteMultiRangeParameters);this.Gj(d=>!d.insertDeleteMultiRangeParameters.IsTableCommand);
this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(d=>0<d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Gj(d=>d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===vb.a.PE)}}Object(ha.a)(Ph,"SheetRowInsertedEvent",Ob,[]);class hh extends Ob{constructor(){super()}get eventId(){return 39}ni(){this.di(135)}}
Object(ha.a)(hh,"SheetRowsColumnsAutoFitEvent",Ob,[]);class Ih extends Ob{constructor(){super()}get eventId(){return 36}ni(){this.di(136)}}Object(ha.a)(Ih,"SheetRowsColumnsResizedEvent",Ob,[]);class Jh extends Ob{constructor(){super()}get eventId(){return 68}ni(){this.di(183)}}Object(ha.a)(Jh,"SheetShowGridlinesToggledEvent",Ob,[]);class xi extends Ob{constructor(){super()}get eventId(){return 67}ni(){this.di(184)}}Object(ha.a)(xi,"SheetShowHeadingsToggledEvent",Ob,[]);class mh extends Ob{constructor(){super()}get eventId(){return 89}ni(){this.di(213)}}
Object(ha.a)(mh,"SheetSpellCheckedEvent",Ob,[]);class Od extends Ob{constructor(){super()}get eventId(){return 70}ni(){this.di(515)}}Object(ha.a)(Od,"SheetTabColoredEvent",Ob,[]);class pe extends Ob{constructor(){super()}get eventId(){return 71}ni(){this.di(157)}}Object(ha.a)(pe,"SheetVisibilityChangedEvent",Ob,[]);class ph extends Ob{constructor(){super()}get eventId(){return 126}ni(){this.di(239)}}Object(ha.a)(ph,"SheetsVisibilityChangedEvent",Ob,[]);class Eg extends Ob{constructor(){super()}get eventId(){return 188}ni(){this.di(203)}}
Object(ha.a)(Eg,"SlicerInsertedEvent",Ob,[]);class Ji extends Ob{constructor(){super()}get eventId(){return 189}ni(){this.di(173)}Sm(){this.Gj(d=>!d.clearFilter)}}Object(ha.a)(Ji,"SlicerSelectionAppliedEvent",Ob,[]);class yi extends Ob{constructor(){super()}get eventId(){return 190}ni(){this.di(173)}Sm(){this.Gj(d=>d.clearFilter)}}Object(ha.a)(yi,"SlicerSelectionClearedEvent",Ob,[]);class Eh extends Ob{constructor(){super()}get eventId(){return 27}ni(){this.di(208)}Sm(){this.Gj(d=>d.getParameters().FilterType===
Ig.Ysb)}}Object(ha.a)(Eh,"TableCheckedItemsFilteredEvent",Ob,[]);class Ki extends Ob{constructor(){super()}get eventId(){return 144}ni(){this.di(237)}Sm(){this.Gj(d=>!!d.insertDeleteMultiRangeParameters);this.Gj(d=>d.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(d=>0>d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ha.a)(Ki,"TableColumnDeletedEvent",Ob,[]);class Kh extends Ob{constructor(){super()}get eventId(){return 145}ni(){this.di(237)}Sm(){this.Gj(d=>
!!d.insertDeleteMultiRangeParameters);this.Gj(d=>d.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(d=>0<d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ha.a)(Kh,"TableColumnInsertedEvent",Ob,[]);var Li=a(1214);class ai extends Ob{constructor(){super()}get eventId(){return 121}ni(){this.di(141)}Sm(){this.Gj(d=>Object(ia.a)(Li.a,d))}}Object(ha.a)(ai,"TableColumnSortedEvent",
Ob,[]);class sh extends Ob{constructor(){super()}get eventId(){return 105}ni(){this.di(193)}}Object(ha.a)(sh,"TableConvertedToRangeEvent",Ob,[]);class kj extends Ob{constructor(){super()}get eventId(){return 16}ni(){this.di(206)}}Object(ha.a)(kj,"TableCreatedEvent",Ob,[]);class Qi extends Ob{constructor(){super()}get eventId(){return 30}ni(){this.di(209)}Sm(){this.Gj(d=>d.getParameters().FilterType===Ig.Ysb)}}Object(ha.a)(Qi,"TableCustomFilteredEvent",Ob,[]);var hi=a(1555);class Jg extends Ob{constructor(){super()}get eventId(){return 25}ni(){this.di(187)}Sm(){this.Gj(d=>
d.options.OperationType===hi.d.CustomSort)}}Object(ha.a)(Jg,"TableCustomSortedEvent",Ob,[]);class yh extends Ob{constructor(){super()}get eventId(){return 28}ni(){this.di(176)}Sm(){this.Gj(d=>d.autoFilterOptions.AutoFilterType===Ig.Ysb);this.Gj(d=>0===d.autoFilterOptions.CriteriaType)}}Object(ha.a)(yh,"TableFilterClearedEvent",Ob,[]);class Xi extends Ob{constructor(){super()}get eventId(){return 32}ni(){this.di(176)}Sm(){this.Gj(d=>d.autoFilterOptions.AutoFilterType===Ig.Ysb);this.Gj(d=>{const z=
new Qa.a;z.add(1);z.add(2);z.add(8);z.add(9);z.add(10);z.add(11);z.add(12);z.add(13);z.add(14);z.add(15);z.add(16);z.add(17);z.add(18);z.add(19);z.add(20);z.add(21);z.add(22);z.add(23);z.add(24);z.add(25);z.add(26);z.add(27);z.add(28);z.add(29);z.add(30);z.add(31);z.add(32);z.add(33);z.add(34);z.add(35);z.add(36);z.add(37);z.add(38);z.add(39);return z.contains(d.autoFilterOptions.CriteriaType)})}}Object(ha.a)(Xi,"TableItemFilteredEvent",Ob,[]);class zh extends Ob{constructor(){super()}get eventId(){return 101}ni(){this.di(217)}}
Object(ha.a)(zh,"TableRenamedEvent",Ob,[]);class zi extends Ob{constructor(){super()}get eventId(){return 73}ni(){this.di(211)}}Object(ha.a)(zi,"TableResizedEvent",Ob,[]);class Fh extends Ob{constructor(){super()}get eventId(){return 44}ni(){this.di(514)}}Object(ha.a)(Fh,"TableRowColumnRearrangedEvent",Ob,[]);class Ah extends Ob{constructor(){super()}get eventId(){return 146}ni(){this.di(237)}Sm(){this.Gj(d=>!!d.insertDeleteMultiRangeParameters);this.Gj(d=>d.insertDeleteMultiRangeParameters.IsTableCommand);
this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Gj(d=>0>d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ha.a)(Ah,"TableRowDeletedEvent",Ob,[]);class Wh extends Ob{constructor(){super()}get eventId(){return 147}ni(){this.di(237)}Sm(){this.Gj(d=>!!d.insertDeleteMultiRangeParameters);this.Gj(d=>d.insertDeleteMultiRangeParameters.IsTableCommand);this.Gj(d=>!d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Gj(d=>0<d.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(ha.a)(Wh,"TableRowInsertedEvent",Ob,[]);class Sh extends Ob{constructor(){super()}get eventId(){return 26}ni(){this.di(177)}Sm(){this.Gj(d=>d.autoFilterOptions.AutoFilterType===Ig.Ysb)}}Object(ha.a)(Sh,"TableSortedEvent",Ob,[]);class lj extends Ob{constructor(){super()}get eventId(){return 87}ni(){this.di(212)}}Object(ha.a)(lj,"TableStyleAppliedEvent",Ob,[]);class Mf extends Ob{constructor(){super()}get eventId(){return 88}ni(){this.di(196)}}
Object(ha.a)(Mf,"TableStyleOptionToggledEvent",Ob,[]);class ii extends Ob{constructor(){super()}get eventId(){return 31}ni(){this.di(210)}Sm(){this.Gj(d=>d.getParameters().FilterType===Ig.Ysb)}}Object(ha.a)(ii,"TableTop10FilteredEvent",Ob,[]);class Vg extends Ob{constructor(){super()}get eventId(){return 207}ni(){this.di(238)}}Object(ha.a)(Vg,"TextToColumnsEvent",Ob,[]);class ah extends Ob{constructor(){super()}get eventId(){return 128}ni(){this.di(559)}}Object(ha.a)(ah,"ValuesSortedEvent",Ob,[]);
class ih extends Ob{constructor(){super()}get eventId(){return 55}ni(){this.di(197)}}Object(ha.a)(ih,"WorkbookCalculationModeSetEvent",Ob,[]);class mi extends Ob{constructor(){super()}get eventId(){return 34}ni(){this.di(181)}Sm(){this.Gj(d=>!!d.parentCommentId)}}Object(ha.a)(mi,"WorkbookCommentRepliedEvent",Ob,[]);class Xh extends Ob{constructor(){super()}get eventId(){return 33}ni(){this.di(181)}Sm(){this.Gj(d=>!d.parentCommentId)}}Object(ha.a)(Xh,"WorkbookCommentedEvent",Ob,[]);class Ti extends Ob{constructor(){super()}get eventId(){return 56}ni(){this.di(128)}}
Object(ha.a)(Ti,"WorkbookRecalculatedEvent",Ob,[]);class ji extends Ob{constructor(){super()}get eventId(){return 46}ni(){this.di(171)}}Object(ha.a)(ji,"WorkbookRedoEvent",Ob,[]);class Ui extends Ob{constructor(){super()}get eventId(){return 45}ni(){this.di(170);this.di(1033)}}Object(ha.a)(Ui,"WorkbookUndoEvent",Ob,[]);class Yi extends Ob{constructor(){super()}get eventId(){return 116}ni(){this.di(507);this.di(576);this.di(10)}Sm(){this.Gj(d=>{if(Object(ia.a)(Ed,d)&&(d=Object(wa.a)(Ed,d),void 0!==
d.source&&null!==d.source&&void 0!==d.eventId&&null!==d.eventId))return la.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${d.source}; eventId: ${d.eventId}.`),!0;la.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(ha.a)(Yi,"DefaultRichApiRequestExecutedEvent",Ob,[]);class ni extends Ob{constructor(){super()}get eventId(){return 216}ni(){this.di(1022)}}Object(ha.a)(ni,"TablelAltTextEditedEvent",
Ob,[]);class bi extends Ob{constructor(){super()}get eventId(){return 217}ni(){this.di(263)}}Object(ha.a)(bi,"FloatingObjectZOrderChangedEvent",Ob,[]);var mj=a(1235);class Zi extends Ob{constructor(){super()}get eventId(){return 192}ni(){this.di(507)}Sm(){this.Gj(d=>Object(ia.a)(mj.a,d)?!0:!1)}}Object(ha.a)(Zi,"VisualPropertySetEvent",Ob,[]);class Ai extends Fa{constructor(){super(219,[510])}}Object(ha.a)(Ai,"ChartSeriesDeletedEvent",Fa,[]);class ci extends Ob{get eventId(){return 220}ni(){this.di(1027)}}
Object(ha.a)(ci,"ChartDataChangedEvent",Ob,[]);class $i extends Fa{constructor(){super(221,[512])}}Object(ha.a)($i,"ChartSeriesDataChangedEvent",Fa,[]);class Vi extends Ob{constructor(){super()}get eventId(){return 225}ni(){this.di(269)}}Object(ha.a)(Vi,"FloatingObjectPutFloatingImageInCellEvent",Ob,[]);class Xe extends Ob{constructor(){super()}get eventId(){return 224}ni(){this.di(268)}}Object(ha.a)(Xe,"ImageInCellConvertToFloatingObjectEvent",Ob,[]);class th{constructor(d){this.Bh=null;this.$=d}get macroRecorderEvents(){this.Bh||
(this.Bh=new Qa.a,this.Bh.add(new Ad),this.Bh.add(new Ng),this.Bh.add(new zg),this.Bh.add(new ec),this.Bh.add(new kg),this.Bh.add(new Da),this.Bh.add(new ib),this.Bh.add(new ic),this.Bh.add(new Rc),this.Bh.add(new Le),this.Bh.add(new Je),this.Bh.add(new Nd),this.Bh.add(new Ei),this.Bh.add(new Si),this.Bh.add(new lh),this.Bh.add(new kj),this.Bh.add(new Ki),this.Bh.add(new Kh),this.Bh.add(new Ah),this.Bh.add(new Wh),this.Bh.add(new li),this.Bh.add(new Gi),this.Bh.add(new Ph),this.Bh.add(new Kg),this.Bh.add(new Jg),
this.Bh.add(new Sh),this.Bh.add(new Eh),this.Bh.add(new yh),this.Bh.add(new Qb),this.Bh.add(new Qi),this.Bh.add(new ii),this.Bh.add(new Xi),this.Bh.add(new Xh),this.Bh.add(new mi),this.Bh.add(new jh),this.Bh.add(new Ih),this.Bh.add(new Fi),this.Bh.add(new rh),this.Bh.add(new hh),this.Bh.add(new wc),this.Bh.add(new Se),this.Bh.add(new Ha),this.Bh.add(new Og),this.Bh.add(new Fh),this.Bh.add(new ji),this.Bh.add(new Ui),this.Bh.add(new Zf),this.Bh.add(new ld),this.Bh.add(new yf),this.Bh.add(new Zb),this.Bh.add(new gi),
this.Bh.add(new ih),this.Bh.add(new Ti),this.Bh.add(new Sg),this.Bh.add(new jg),this.Bh.add(new Yf),this.Bh.add(new Z),this.Bh.add(new cf),this.Bh.add(new If),this.Bh.add(new Mb),this.Bh.add(new Wf),this.Bh.add(new Ud),this.Bh.add(new Cb),this.Bh.add(new xi),this.Bh.add(new Jh),this.Bh.add(new Lc),this.Bh.add(new pe),this.Bh.add(new Od),this.Bh.add(new zi),this.Bh.add(new kd),this.Bh.add(new ma),this.Bh.add(new O),this.Bh.add(new kf),this.Bh.add(new le),this.Bh.add(new Xb),this.Bh.add(new qb),this.Bh.add(new e),
this.Bh.add(new rc),this.Bh.add(new Ra),this.Bh.add(new qa),this.Bh.add(new mb),this.Bh.add(new Za),this.Bh.add(new P),this.Bh.add(new lj),this.Bh.add(new Mf),this.Bh.add(new mh),this.Bh.add(new vi),this.Bh.add(new zf),this.Bh.add(new Rf),this.Bh.add(new fe),this.Bh.add(new De),this.Bh.add(new Tb),this.Bh.add(new yd),this.Bh.add(new td),this.Bh.add(new Bf),this.Bh.add(new dg),this.Bh.add(new Yc),this.Bh.add(new zh),this.Bh.add(new Qg),this.Bh.add(new Pf),this.Bh.add(new dh),this.Bh.add(new sh),this.Bh.add(new eb),
this.Bh.add(new gd),this.Bh.add(new qe),this.Bh.add(new wh),this.Bh.add(new mg),this.Bh.add(new bg),this.Bh.add(new Ff),this.Bh.add(new bh),this.Bh.add(new S),this.Bh.add(new eh),this.Bh.add(new Wd),this.Bh.add(new Ma),this.Bh.add(new de),this.Bh.add(new wi),this.Bh.add(new ai),this.Bh.add(new Ga),this.Bh.add(new ph),this.Bh.add(new df),this.Bh.add(new ah),this.Bh.add(new Uc),this.Bh.add(new Pc),this.Bh.add(new qc),this.Bh.add(new xg),this.Bh.add(new rg),this.Bh.add(new xf),this.Bh.add(new Ke),this.Bh.add(new qi),
this.Bh.add(new Me),this.Bh.add(new Zg),this.Bh.add(new Na),this.Bh.add(new Ld),this.Bh.add(new Xg),this.Bh.add(new Gg),this.Bh.add(new Hg),this.Bh.add(new Mg),this.Bh.add(new fi),this.Bh.add(new Cd),this.Bh.add(new Rg),this.Bh.add(new lg),this.Bh.add(new Re),this.Bh.add(new pd),this.Bh.add(new Xf),this.Bh.add(new fg),this.Bh.add(new Vf),this.Bh.add(new gh),this.Bh.add(new Gh),this.Bh.add(new ng),this.Bh.add(new ce),this.Bh.add(new Kf),this.Bh.add(new vf),this.Bh.add(new ag),this.Bh.add(new ig),this.Bh.add(new Tg),
this.Bh.add(new Uf),this.Bh.add(new Qf),this.Bh.add(new ug),this.Bh.add(new vh),this.Bh.add(new Ch),this.Bh.add(new Wg),this.Bh.add(new Ve),this.Bh.add(new ve),this.Bh.add(new og),this.Bh.add(new Yg),this.Bh.add(new Dg),this.Bh.add(new Eg),this.Bh.add(new Ji),this.Bh.add(new yi),this.Bh.add(new xh),this.Bh.add(new $g),this.Bh.add(new Di),this.Bh.add(new Pi),this.Bh.add(new kh),this.Bh.add(new Hh),this.Bh.add(new oh),this.Bh.add(new Zh),this.Bh.add(new $h),this.Bh.add(new Ge),this.Bh.add(new Ug),this.Bh.add(new Vg),
this.Bh.add(new Oh),this.Bh.add(new ni),this.Bh.add(new bi),this.Bh.add(new Zi),this.Bh.add(new Ai),this.Bh.add(new $i),this.Bh.add(new ci),this.Bh.add(new Xe),this.Bh.add(new Vi),this.Bh.add(new $e),ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.ikk());return this.Bh}SIf(d,z){let T=this.TIf(d,this.macroRecorderEvents,z);T||(T=this.TIf(d,th.q0i(),z),!T&&this.s0f(d,th.mof,z)&&(T=th.mof));return T}TIf(d,z,T){const ya=new Qa.a;for(const sb of z)this.s0f(d,sb,T)&&ya.add(sb);
return 1===ya.count?ya.na(0):1<ya.count?th.tFi(ya):null}s0f(d,z,T){const ya=th.I2j(d,z);return T?ya&&th.ddl(d,z):ya}ikk(){const d=new Qa.a;for(const z of this.Bh){let T=!1;for(const ya of z.featureGates)if(!ua.EwaSettings.Ra(ya)){d.add(z);T=!0;break}if(!T)for(const ya of z.Zyf)if(!ua.EwaSettings.getBooleanFeatureGate(ya,!1)){d.add(z);break}}for(const z of d)this.Bh.remove(z)}static q0i(){th.h_b||(th.h_b=new Qa.a,th.h_b.add(new R),th.h_b.add(new he));return th.h_b}static I2j(d,z){return z.operations.contains(d.operation)}static ddl(d,
z){z=z.R4c;if(!z.count)return!0;let T=!0;for(const ya of z)if(!ya(d.payload)){T=!1;break}return T}static tFi(d){let z=d.na(0);for(const T of d)T.R4c.count>z.R4c.count&&(z=T);return z}}th.h_b=null;th.mof=new Yi;Object(ha.a)(th,"MacroRecorderEventList",null,[]);var aj=a(694);class nj{constructor(){this.RAb=null}get cMh(){this.RAb||(this.RAb=new Qa.a,this.RAb.add(12),this.RAb.add(11));return this.RAb}nhj(d){return this.cMh.contains(d.operation)}M4k(d){const z=[],T=d.payload;for(const ya of T.batchedOperations)z.push(new aj.a(d.operation,
ya));return z}}Object(ha.a)(nj,"MacroRecorderBatchedEventList",null,[]);var Wi=a(119);class ri{equals(d,z){return d===z}getHashCode(d){return d}cxa(d){return d}}Object(ha.a)(ri,"UserOperationNameComparer",null,[112,113]);class hf{static w0i(){hf.Yi||(hf.Yi=new Fb.a(new ri),hf.Yi.add(507),hf.Yi.add(10),hf.Yi.add(576),hf.Yi.add(563),hf.Yi.add(564),hf.Yi.add(565),hf.Yi.add(566),hf.Yi.add(567),hf.Yi.add(568),hf.Yi.add(569),hf.Yi.add(570),hf.Yi.add(571),hf.Yi.add(572),hf.Yi.add(573),hf.Yi.add(574),hf.Yi.add(575),
hf.Yi.add(501),hf.Yi.add(520),hf.Yi.add(1),hf.Yi.add(1002),hf.Yi.add(129),hf.Yi.add(198),hf.Yi.add(500),hf.Yi.add(519),hf.Yi.add(538),hf.Yi.add(1E3),hf.Yi.add(1003),hf.Yi.add(144),hf.Yi.add(502),hf.Yi.add(505),hf.Yi.add(179),hf.Yi.add(205),hf.Yi.add(134),hf.Yi.add(230),hf.Yi.add(103),hf.Yi.add(110),hf.Yi.add(112),hf.Yi.add(113),hf.Yi.add(124),hf.Yi.add(133),hf.Yi.add(154),hf.Yi.add(162),hf.Yi.add(168),hf.Yi.add(172),hf.Yi.add(201),hf.Yi.add(222),hf.Yi.add(227),hf.Yi.add(513),hf.Yi.add(534),hf.Yi.add(539),
hf.Yi.add(545),hf.Yi.add(600),hf.Yi.add(547),hf.Yi.add(555),hf.Yi.add(558),hf.Yi.add(562),hf.Yi.add(585),hf.Yi.add(1001),hf.Yi.add(1005),hf.Yi.add(1008),hf.Yi.add(1010),hf.Yi.add(1011),hf.Yi.add(1012),hf.Yi.add(1018),hf.Yi.add(252),hf.Yi.add(253),hf.Yi.add(258),hf.Yi.add(101),hf.Yi.add(102),hf.Yi.add(108),hf.Yi.add(257),hf.Yi.add(119),hf.Yi.add(120),hf.Yi.add(123),hf.Yi.add(126),hf.Yi.add(127),hf.Yi.add(130),hf.Yi.add(140),hf.Yi.add(159),hf.Yi.add(160),hf.Yi.add(165),hf.Yi.add(166),hf.Yi.add(167),
hf.Yi.add(169),hf.Yi.add(189),hf.Yi.add(223),hf.Yi.add(214),hf.Yi.add(228),hf.Yi.add(233),hf.Yi.add(247),hf.Yi.add(504),hf.Yi.add(511),hf.Yi.add(512),hf.Yi.add(525),hf.Yi.add(533),hf.Yi.add(537),hf.Yi.add(542),hf.Yi.add(544),hf.Yi.add(548),hf.Yi.add(550),hf.Yi.add(551),hf.Yi.add(552),hf.Yi.add(554),hf.Yi.add(577),hf.Yi.add(584),hf.Yi.add(586),hf.Yi.add(587),hf.Yi.add(588),hf.Yi.add(592),hf.Yi.add(1009),hf.Yi.add(1016),hf.Yi.add(1017),hf.Yi.add(1024),hf.Yi.add(260),hf.Yi.add(597),hf.Yi.add(264),hf.Yi.add(596),
hf.Yi.add(254),hf.Yi.add(262),hf.Yi.add(1030),hf.Yi.add(1031),hf.Yi.add(606));return hf.Yi}}hf.Yi=null;Object(ha.a)(hf,"MacroRecorderUnrecognizedEventList",null,[]);let bj=class{constructor(d,z,T){z=void 0===z?new th(d):z;T=void 0===T?new nj:T;this.XPb=null;this.uDj=(ya,sb)=>{this.oTg()&&this.pHd(sb)};this.kbg=z;this.jbg=T;this.$=d;this.$.x6&&this.$.HDh(this.uDj)}init(d){this.$.x6&&(d?this.XPb=d:la.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}pHd(d){if(this.oTg())try{if(this.jbg.nhj(d)){var z=
this.jbg.M4k(d);for(const T of z)this.iAf(T)}else this.iAf(d)}catch(T){z=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${Wi.a(d.operation)}, Exception: ${T.stack}`;la.ULS.sendTraceTag(537155423,0,10,z);try{this.gxi(d)}catch(ya){}}}iAf(d){var z=this.kbg.SIf(d,!0);z?(this.XPb(z.eventId,mc.a.Ci(d.payload)),la.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${z.eventId}`)):(z=this.kbg.SIf(d,!1))?la.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${z.eventId}, but failed to match filters`):
hf.w0i().contains(d.operation)||(this.XPb(0,mc.a.Ci(d.operation)),d=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${Wi.a(d.operation)}`,la.ULS.sendTraceTag(537155420,0,50,d))}gxi(d){this.XPb(222,mc.a.Ci(d.operation))}oTg(){return this.$.Kya&&this.XPb&&this.$.nha?!0:!1}};bj=Object(fb.__decorate)([Object(oa.d)(da.Sd),Object(fb.__param)(0,Object(da.Nb)())],bj);Object(ha.a)(bj,"MacroRecorderEventHandler",null,[254]);Object(oa.b)(da.fe,{Fk:"singleton"})(d=>Lo(function*(){yield oa.a.resolve(da.ee,
d);return Db.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory")}));var Bi=a(2);class pj{}Object(ha.a)(pj,"Selection",null,[]);var vg=a(1253),si=a(40);class cj{}Object(ha.a)(cj,"SmartLookupApplicationInterface",null,[]);class Ag{}Object(ha.a)(Ag,"ApplicationProperties",null,[]);class uh{}Object(ha.a)(uh,"EnterpriseUserInfo",null,[]);class Mi{}Object(ha.a)(Mi,"FeatureGates",null,[]);class Ci{constructor(d,z,T){this.n0k=9E5;this.p0k=3E5;this.k4d=null;this.S$f="";this.h4d=
0;this.vNb=Date.now;this.vza=d;this.brb=z;(void 0===T||T)&&this.fKd()}YWi(){var d=void 0===d?!0:d;const z=this.vNb();if(z<this.h4d+this.n0k)return z>this.h4d+this.p0k&&this.fKd(),this.S$f;d&&this.fKd();return""}fKd(){this.k4d=this.k4d||new Promise(d=>{this.ZWi().then(z=>{this.S$f=z;this.h4d=this.vNb();this.k4d=null;d(z)})})}ZWi(){return this.brb&&this.brb.length?new Promise(d=>{this.vza.gE("SmartLookup",this.brb).then(z=>{z.IsSuccess?z.Token||(d(""),la.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):
(la.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+z.ErrorCode+": "+z.ErrorMessage),d(""));d(z.Token)}).catch(z=>{z=lf.c(z);la.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+z);d("")})}):(la.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(ha.a)(Ci,"SmartLookupAuthenticationManager",null,[287]);class Ni{static TKi(){switch(Object(wa.a)(String,
ea.AFrameworkApplication.ii.AudienceGroup)||""){case "Dogfood":if(ea.AFrameworkApplication.fa){let d=ea.AFrameworkApplication.fa.Ya("UserPrincipalName");d=Td.a.ys(d);const z=ea.AFrameworkApplication.fa.Nv("SmartLookupINTEnabledForSKITeam")?ea.AFrameworkApplication.fa.Ez("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(z,d)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static sWi(){switch(ea.AFrameworkApplication.fa.ka("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":ea.AFrameworkApplication.fa.ka("IntentSvcEnableProdSourceLocationOverride")?
"PROD":ea.AFrameworkApplication.fa.ka("IntentSvcEnableIntSourceLocationOverride")?"INT":Ni.TKi()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(ha.a)(Ni,"Utils",null,[]);var Lh=a(79),oi=a(653);class di{constructor(d){la.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");
this.Cag=ea.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");this.KCj=ea.AFrameworkApplication.fa.Ya("SmartLookupApprovedOriginPattern");this.brb=ea.AFrameworkApplication.fa.Ya("SmartLookupShredderServiceEndpoint");this.pDj=Lh.a.WU(ea.AFrameworkApplication.fa.Ya("AppCatalogUrl")||"");this.arb=new Mi;this.arb.EnableAllTabV2=!0;this.arb.EnableIntentService=!0;this.arb.EnableInDocumentSearch=ea.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch");this.arb.EnableLocalSearch=
ea.AFrameworkApplication.fa.ka("SmartLookupEnableLocalSearch");this.arb.IntentServiceEndpoint=Ni.sWi();this.kDj=new Ci(d,this.brb)}get approvedOriginPattern(){return this.KCj}KEi(){return Promise.resolve(this.LEi())}LEi(){const d=new Ag;d.anid="";d.applicationVersion=ea.AFrameworkApplication.buildVersion;d.appCorrelationId=Ib.a.create().toString();d.themePlatform=di.jel;d.lcid=ea.AFrameworkApplication.lcid;d.launchUtcTime=(new Date).toUTCString();d.featureGates=this.arb;var z=oi.a.UU(ea.AFrameworkApplication.lcid);
z=z?z.name:null;d.market=this.AAc(z);d.uiLanguage=z;d.sessionId=ea.AFrameworkApplication.userSessionId;d.themeId=0;d.parentalControl=di.t4j;const T=new uh;T.CountryCode=this.AAc(z);T.ServiceEndpoint=this.brb;T.IsGoLocal=!1;T.IsEnabled=this.Cag;T.IsEnterpriseEnabled=this.Cag;T.TenantRoot=this.pDj;d.enterpriseUserInfo=T;d.accessToken=this.kDj.YWi();return d}AAc(d){d=d.split("-");return d[d.length-1]}}di.jel="web";di.t4j="yes";Object(ha.a)(di,"SmartLookupManager",null,[276]);var Mh;let Bh=Mh=class extends si.a{constructor(d){super();
this.$=d;this.isFirstLaunch=!1}dj(){return!1}Ri(){return!1}Gi(d,z){d=ua.EwaSettings.Ra(127);return-983891024===z.command&&d}executeCommand(d,z){d=Oa.TaskExtensions.Gq();-983891024===z.command&&this.Pvj();return d}Pvj(){var d=new di(null);const z={};var T=ca.f(this.$).zh(null).originalText;T=Object(Bi.a)(new pj,{neighborhood:T,mentionStart:0,mentionLength:T?T.length:0});const ya=Object(Bi.a)(new cj,{selection:T,entryPoint:0});d.KEi().then(cc=>{cc.applicationName=Mh.appName;cc.isFirstLaunch=this.isFirstLaunch;
cc.themeId=5;z[Mh.hTk]=JSON.stringify(ya);z[Mh.LHh]=JSON.stringify(cc);this.isFirstLaunch=!1});d=new je.a("ExcelOnline","Web","en-Us");T=new Nc.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const sb=new hd.a;sb.Ak[vg.a.Ys]=Yd.a.instance.ia(1810);sb.Ak[vg.a.taskPaneWidth]=350;sb.Ak[vg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";sb.ex=z;Ac.a.instance.kza(T,"Taskpane","SmartLookupSDXTaskpane",d,sb)}};Bh.LHh="AppProperties";Bh.appName="Excel";Bh.hTk="SmartLookupApplicationInterface";
Bh=Mh=Object(fb.__decorate)([Object(oa.d)(da.jg),Object(fb.__param)(0,Object(da.Nb)()),Object(fb.__param)(1,Object(Ea.a)())],Bh);Object(ha.a)(Bh,"SmartLookupCommandHandler",si.a,[34]);var pi=a(1258),N=a(432);class pa{constructor(){this.Eih=new Qa.a}get Ppc(){return this.Eih}GRi(d){la.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",d);const z=new Qa.a;for(const T of this.Ppc)for(const ya of T.D0b)ya.id===d&&z.add(ya);return z}d2e(d){this.Ppc.add(d)}bkk(d){for(const z of this.Ppc)if(z.V5e===
d.V5e){this.Ppc.remove(z);break}}static ufi(d,z,T){T=void 0===T?null:T;d=pa.pIi(d);0<d.length&&(pa.zYc(d,!1),T&&T(z,d))}static pIi(d){const z=[];if(d&&d.D0b&&0<d.D0b.count)for(const T of d.D0b)if(T.controls&&0<T.controls.count)for(const ya of T.controls)if(ya.menuItems&&0<ya.menuItems.count)for(const sb of ya.menuItems)Array.add(z,sb.id);return z}static zYc(d,z){if(d.length){var T=[];for(const ya of d)T.push(appChrome.actions.updateControlEnabledDisabledState(ya,z));appChrome.api.dispatch(T)}}}Object(ha.a)(pa,
"ContextMenuExtensibilityCache",null,[339,340]);var Xa=a(1575),Sb=a(1116),fc=a(1027);class Kc{Aeb(d,z){z=void 0===z?null:z;if(d=fc.a.KQb(d)){appChrome.addInApi.dispatchActionsToInstallAddIn(d,z);for(const T of d.tabs)if(T.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(d,()=>{});break}}}Cie(d){(d=fc.a.KQb(d))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(d)}SPg(){}static Dfi(d,z,T){T=void 0===T?null:T;d=Kc.mVi(d);0<d.length&&(Kc.zYc(d,!1),T&&T(z,d))}static mVi(d){const z=[];
if(d&&(d=d.m7,d.jC&&0<d.jC.count))for(const T of d.jC)if(T.groups&&0<T.groups.length)for(const ya of T.groups)if(ya.controls&&0<ya.controls.length)for(const sb of ya.controls)Array.add(z,sb.id);return z}static zYc(d){if(d.length){var z=[];for(const T of d)z.push(appChrome.actions.updateControlEnabledDisabledState(T,!0));appChrome.api.dispatch(z)}}}Object(ha.a)(Kc,"OneLineRibbonExtensibilityManager",null,[359]);var ud=a(1162);class Jd{constructor(){this.wHe=this.Y6c=null;this.NUf=(d,z)=>{let T=null;
T=()=>{d.getIsUpgrading()?window.setTimeout(T,1E3):d.getUpgradingFailed()?Kc.zYc(z,!0):ea.AFrameworkApplication.ra.XB()};window.setTimeout(T,1E3)}}get dnd(){return this.Y6c||(this.Y6c=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set dnd(d){this.Y6c=d}get BLh(){return this.wHe||(this.wHe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(d,z){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(d,
z)}nQd(d,z,T,ya,sb,cc,Fc){cc=void 0===cc?null:cc;Fc=void 0===Fc?null:Fc;var Wc;la.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",d);ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8642303_FixedTelemetryForAddinCommandsActionEnabled")&&(d={["solutionId"]:null===(Wc=globalThis.Telemetry)||void 0===Wc?void 0:Wc.PrivacyRules.GetPrivacyCompliantId(sb.ownerAddinInfo.solutionId,sb.ownerAddinInfo.storeType,sb.ownerAddinInfo.assetId,null,null,sb.ownerAddinInfo.storeId)},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.HandleAddinCommandsAction",
dataFields:rd.a.Rm(d)}));if((z=z.ywa(sb.ownerAddinInfo.storeType,sb.ownerAddinInfo.solutionId))&&z.ZK&&!z.ZK.getIsUpgrading())if(Wc=null,0<z.ZK.getNotificationParams().length&&(Wc=this.ebf(z.ZK.getNotificationParams()[0]))&&2147758681===Wc.errorCode&&(z.isUpgraded=!0),2!==z.ZK.getStatus()&&(1!==z.ZK.getStatus()||Wc&&2147758681===Wc.errorCode))Wc&&this.iUg(z,Wc,Fc);else try{T.setOwnerAddinEToken(z.ZK.getEToken()),sb.action(T,ya.Gpa),cc&&cc()}catch(id){la.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",
ea.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?id.stack:id.message)),ud.a.Lse(Object(Nb.a)("InternalError")+" "+Object(Nb.a)("InternalError_Directive"))}}iUg(d,z,T){T=void 0===T?null:T;const ya=d.ZK;if(1===ya.getNotificationParams().length||z.rEc){const sb=z.Sua,cc=z.Tva;z.Sua=()=>{ya.removeFirstNotification();if(0<ya.getNotificationParams().length){const Fc=this.ebf(ya.getNotificationParams()[0]);this.iUg(d,Fc)}2147758681===z.errorCode&&(Kc.Dfi(d.Mw,
ya,this.NUf),pa.ufi(d.bMb,ya,this.NUf));sb&&sb()};z.Tva=()=>{cc&&cc();T&&T()};ud.a.Mse(z)}}ebf(d){const z=new Sb.a;z.J0a=d.infoType;z.id=d.id;z.title=d.title;z.description=d.description;z.buttonText=d.buttonTxt;z.Sua=d.buttonCallback;z.rEc=d.highPriority;z.Tva=d.dismissCallback;z.errorCode=d.errorCode;z.MTf=d.iframeNotificationUrl;return z}}Object(ha.a)(Jd,"AddinCommandsActionHandler",null,[344]);var ie=a(183),we=a(914),Qe=a(7),ef=a(961),wf=a(910);class Tf{constructor(d,z){this.Za=d;this.C1h=z}rCi(d){if(void 0!==
d&&null!==d&&d===Qe.a.Rif)d="ContextMenuCell";else return null;const z=this.Za.ji();this.DBi(z,d);return z}DBi(d,z){z=this.C1h.GRi(z);for(const T of z){z=T.controls;for(const ya of z)this.nBi(d,ya)}}nBi(d,z){var T=z.H4[ef.a.id];const ya=z.H4[ef.a.X$a],sb=z.H4[ef.a.aab];let cc="Image16by16",Fc=z.H4[ef.a.Y$a];wf.c(sb)&&(cc="None");0<z.menuItems.count?(T=this.Za.xz(T,T,ya,798637440),T.F7b(cc,sb,null),this.pCi(T.menu,z),d.buttons.push(T)):d.buttons.push(this.Za.UXa(T,ya,Fc,sb,cc,null,!1))}pCi(d,z){const T=
this.Za.ji();for(const ya of z.menuItems){z=ya.Bza[ef.a.id];const sb=ya.Bza[ef.a.X$a],cc=ya.Bza[ef.a.aab];let Fc="Image16by16";const Wc=ya.Bza[ef.a.Y$a];wf.c(cc)&&(Fc="None");z=this.Za.UXa(z,sb,Wc,cc,Fc,null,!1);T.buttons.push(z)}d.Mh.push(T)}}Object(ha.a)(Tf,"AddInCommandsContextMenuExtensibilityHandler",null,[365]);var gg=a(1034);class wg{constructor(){this.yo=null;this.visible=!1}}Object(ha.a)(wg,"AddinStatusCommandValues",null,[]);class Lg{static tbk(d){const z=new wg;z.yo=d.sGa;z.visible=z.yo?
!0:!1;return z}static k_c(d,z,T,ya,sb){const cc=document.getElementById(T);cc?Lg.WPk(d,z,cc,ya,sb):la.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",T))}static WPk(d,z,T,ya,sb){T?d.sGa===Object(Nb.a)("ErrorLoadingAddInsTitle")?ud.a.vOk(z,T,ya,sb):d.sGa===Object(Nb.a)("InstallingCustomFunctionsErrorStatusBarMsg")&&ud.a.cQk(z,T,Object(Nb.a)("InstallingCustomFunctionsErrorStatusBarMsg"),Object(Nb.a)("InstallingCustomFunctionsErrorCalloutMsg")):la.ULS.sendTraceTag(543801756,
220,100,String.format("addinLabelElement element is not available"))}}Object(ha.a)(Lg,"AddinCommandsStatusHandler",null,[]);var G=a(255),ta=a(88);class jb extends si.a{constructor(d,z){super();this.agaveCommandManager=this.statusBarManager=null;this.Mo=!1;this.Jff=()=>{this.kL&&this.kL.pff()};this.KOf=()=>{this.raiseEvent("LAC")};this.ij=(T,ya)=>{!T.ki&&G.b(ya)&&this.statusBarManager&&(this.statusBarManager.tN(this),this.statusBarManager=null)};this.kL=z;this.$=d;this.Mo=xa.a.Mo(this.$);this.Mo||
(this.ave=d.xi+"OfficeAddinLabel-Medium14");this.$.la.fi(29,T=>{this.statusBarManager=T;T.hO(this)});this.$.ea.$q(this.ij);this.kL.aBh(this.KOf);this.$.la.fi(206,T=>{this.agaveCommandManager=T;T.MCh(this.Jff)})}oy(d){this.addHandler("LAC",d)}cy(d){this.removeHandler("LAC",d)}Ay(d,z){if("QueryAddinLabel"!==d)return!1;d=!1;this.Mo?(d=appChrome.selectors.getControlLabel(ta.a.l8d),d=!(!d&&!this.kL.sGa)&&d!==this.kL.sGa):d=z[gg.a.LabelText]!==this.kL.sGa;d&&(d=Lg.tbk(this.kL),z[gg.a.LabelText]=d.yo,z[gg.a.Visible]=
d.visible,window.setTimeout(()=>{this.k_c()},0));return!0}rr(){return!0}k_c(){if(this.$){if(this.Mo){const d=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');d&&(this.ave=d.getElementsByClassName("ms-Button-label")[0].id)}this.ave&&Lg.k_c(this.kL,this.$.domElement,this.ave,Yd.a.instance.ia(333),Yd.a.instance.ia(334))}}dispose(){this.$.ea.Uq(this.ij);this.kL.ylk(this.KOf);this.agaveCommandManager&&(this.agaveCommandManager.Umk(this.Jff),this.agaveCommandManager=null);this.statusBarManager&&
(this.statusBarManager.tN(this),this.statusBarManager=null);this.kL=this.$=null;super.dispose()}}Object(ha.a)(jb,"AddinCommandsStatusBarManager",si.a,[155,156]);class sc{constructor(){this.Ver=1}}Object(ha.a)(sc,"CacheItem",null,[]);class Vc{constructor(d){this.REa=d}Wn(d){const z=this.REa.getItem(d);if(z){let T=new sc;try{T=Sys.Serialization.JavaScriptSerializer.deserialize(z,!0)}catch(ya){return this.REa.removeItem(d),null}return T.Data?T.Data:T.data}return null}fvb(d){this.REa.removeItem(d)}}Object(ha.a)(Vc,
"AppsDataCacheManager",null,[358]);class nd{constructor(){new Vc(aa.a.instance)}SNg(d,z){d=Hc.a.OGf()+d;aa.a.instance.setItem(d,z.toString())}sTi(){var d=Hc.a.BKf();la.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",d);d=aa.a.instance.getItem(d);return lf.a(d)}aGk(d){const z=Hc.a.BKf();la.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",z);aa.a.instance.setItem(z,lf.c(d))}TNg(d){const z=Hc.a.CKf();la.ULS.sendTraceTag(507364892,306,50,"get cache key:{0}",z);aa.a.instance.setItem(z,lf.c(Array.from(d)))}$Jd(){var d=
Hc.a.CKf();la.ULS.sendTraceTag(507364891,306,50,"get cache key:{0}",d);d=aa.a.instance.getItem(d);d=lf.a(d);return Array.isArray(d)?new Set(d):new Set}xnj(){return!!aa.a.instance.localStorage}static get instance(){nd.Va||(nd.Va=new nd);return nd.Va}}nd.Va=null;Object(ha.a)(nd,"AddInCommandsCacheManager",null,[331]);var xd=a(117);class Hd{constructor(d){this.Ga=d}get host(){var d;const z=null===(d=this.Ga)||void 0===d?void 0:d.Ya("Application");return"Word"===z||"Excel"===z||"PowerPoint"===z?z:""}get lua(){return!!this.Ga&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",!1)}get tFh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutOpenCloseTelemetryEnabled",!1)}get m5e(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinContextMenuShareButtonEnabled",!1)}get G3j(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryIds",""):""}get H3j(){return this.Ga?
this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryNames",""):""}get F3j(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableCategoryAddinIdsMapping",""):""}get P6b(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get h4(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get sFh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutNoSearchResultsV2Enabled",
!1)}get NWh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.CitationEnabled",!1)}get rFh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREScrollEnabled",!1)}get vFh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchWithOmexEnabled",!1)}get q5e(){var d,z;return null!==(z=null===(d=this.Ga)||void 0===d?void 0:d.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchDebouncing",
100))&&void 0!==z?z:100}get r5e(){return!!this.Ga&&this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchRecommendedKeyword","")}get uFh(){return this.Ga?this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchRequestSentTimeoutMs",2E4):2E4}get I3j(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableSearchQueryParameters",""):""}get mqd(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutBannerInPopularEnabled",
!1)}get lqd(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutBannerGroupInPopularEnabled",!1)}get Hea(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)}get p5e(){return!!this.Ga&&this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREBannerAddins","")}get jaf(){return!!this.Ga&&"Dev Box"===this.Ga.Ya("StatusBarEnvironmentNameToUse")}get o5e(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutCDNotificationUpdateEnabled",
!1)}get lyb(){return!!this.Ga&&this.Ga.isChangeGateEnabled("StoreDisabledErrorViewFixEnabled")}get oac(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get bId(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyEnabled",!1)}get Iyi(){return this.Ga?this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutTriggerSurveyTimeMs",25E3):25E3}get qQb(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpEnabled",
!1)}get Fyi(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpUseLabelsEnabled",!1)}get Dyi(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpSearchWithAppSourceEnabled",!1)}get Eyi(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpUXRenderCheckerEnabled",!1)}get Cyi(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.flyoutStoreExpRetryIfNotReady",
!1)}}Object(ha.a)(Hd,"AppsFlyoutGeneratorContext",null,[]);var ke;(function(d){d.LEFT="LEFT";d.Wja="MIDDLE";d.RIGHT="RIGHT"})(ke||(ke={}));Object(ha.b)("FRECarouselDirection",ke);const V=()=>({["APIC"]:Object(Nb.a)("AddInCategoryTitleAddingPicturesIconsAndCharts"),["APID"]:Object(Nb.a)("AddInCategoryTitleAddingPicturesIconsAndDiagrams"),["BBM"]:Object(Nb.a)("AddInCategoryTitleBuildByMicrosoft"),["CAIP"]:Object(Nb.a)("AddInCategoryTitleDesigningAnInteractivePresentation"),["DA"]:Object(Nb.a)("AddInCategoryTitleDataSyncAndAnalysis"),
["DWT"]:Object(Nb.a)("AddInCategoryTitleDesigningWithTemplates"),["ER"]:Object(Nb.a)("AddInCategoryTitleEducationalPurpose"),["FA"]:Object(Nb.a)("AddInCategoryTitleFinancialAnalytics"),["IPWAI"]:Object(Nb.a)("AddInCategoryTitleImprovingProductivityWithAI"),["TD"]:Object(Nb.a)("AddInCategoryTitleTrendingAddins"),["WN"]:Object(Nb.a)("AddInCategoryTitleNewAddins"),["WF"]:Object(Nb.a)("AddInCategoryTitleWritingFluently"),["PAIYO"]:Object(Nb.a)("AddInCategoryTitlePopularAddinsInYourOrg"),default:Object(Nb.a)("PopularAddins")}),
Wa=()=>({["Word"]:{["APID"]:Object(Nb.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsWord")||"Add photos, icons, and diagrams to your documents.",["ER"]:Object(Nb.a)("AddInCategoryDescriptionEducationalResources")||"Resources for educators and students.",["IPWAI"]:Object(Nb.a)("AddInCategoryDescriptionImprovingProductivityWithAIWord")||"Draft and summarize with the power of generative AI.",["WF"]:Object(Nb.a)("AddInCategoryDescriptionWritingFluently")||"Get help with spelling, grammar, and more."},
["Excel"]:{["APID"]:Object(Nb.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsExcel")||"Add photos, icons, and diagrams to spreadsheets.",["DA"]:Object(Nb.a)("AddInCategoryDescriptionDataAnalytics")||"Get key insights about the data in your speadsheets",["IPWAI"]:Object(Nb.a)("AddInCategoryDescriptionImprovingProductivityWithAIExcel")||"Use the power of AI to capture and understand your data.",["FA"]:Object(Nb.a)("AddInCategoryDescriptionFinancialAnalytics")||"Track expenses, budget, and more."},
["PowerPoint"]:{["IPWAI"]:Object(Nb.a)("AddInCategoryDescriptionImprovingProductivityWithAIPowerPoint")||"Use the power of AI in your presentations.",["APID"]:Object(Nb.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsPowerPoint")||"Add photos, icons, and diagrams to slides.",["CAIP"]:Object(Nb.a)("AddInCategoryDescriptionCreatingAnInteractivePresentation")||"Add polls, timers, and more.",["DWT"]:Object(Nb.a)("AddInCategoryDescriptionDesigningWithTemplates")||"Create beautiful slides with templates you can customize."},
jJk:{["BBM"]:Object(Nb.a)("AddInCategoryDescriptionBuildByMicrosoft")||"Create surveys, visualize data, and more, all from Microsoft.",["TD"]:Object(Nb.a)("AddInCategoryDescriptionTrending")||"Recently added by others.",["WN"]:Object(Nb.a)("AddInCategoryDescriptionWhatsNew")||"Brand new or updated add ins.",["PAIYO"]:Object(Nb.a)("AddInCategoryDescriptionPopularAddinsInYourOrg")||"Add ins people add and use the most in your organization."}});class Eb{constructor(d){this.Ojd=d}next(d){this.Ojd=(9301*
this.Ojd+49297)%233280;return Math.floor(this.Ojd/233280*d)}}Object(ha.a)(Eb,"Random",null,[]);class Jc{constructor(d){this.mU=d;this.V1d=new Set;this.PGe=[];this.hqd=nd.instance;this.LQc=()=>this.Unc=xd.a("getTheme")?appChrome.api.getTheme():null;this.context=new Hd(ea.AFrameworkApplication.fa);this.Unc=xd.a("getTheme")?appChrome.api.getTheme():null;xd.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(this.LQc)}get HVa(){return this.PGe}set HVa(d){this.PGe=d}sEj(d){if(this.context.o5e&&
this.HVa.includes(d)){this.V1d.add(d);var z=this.hqd.$Jd();z.has(d)&&(z.delete(d),this.hqd.TNg(z))}}dEi(d){const z=this.mU.getUpgradedAddinsOfOmex(),T=this.hqd.$Jd(),ya=d.filter(sb=>T.has(sb)&&!this.V1d.has(sb));d=d.filter(sb=>z.has(sb)&&!this.V1d.has(sb));return{gGh:ya,ual:d}}addNotification(d){if(this.context.o5e){var {gGh:z,ual:T}=this.dEi(d.map(ya=>ya.solutionId));this.HVa=[];b(T,this.Unc);this.HVa.push(...T);h(z,this.Unc);this.HVa.push(...z);0!==this.HVa.length&&(d={["Upgraded"]:T.map(ya=>m(this.mU.TI(ya))),
["AdminInstalled"]:z.map(ya=>m(this.mU.TI(ya)))},this.Gwb(d,"ShowNotificationAddins"))}}Gwb(d,z){Ic.a.sendTelemetryEvent({name:`Office.Extensibility.Host.${z}`,dataFields:rd.a.Rm(d)})}}Object(ha.a)(Jc,"AppsInFlyoutNotificationManager",null,[]);var od=a(1113),Pd=a(1435),ge=a(132),Be=a(671),Ye=a(145);class gf{constructor(){this.Seb=null}setErrorMessageForAddin(d,z){this.Seb||(this.Seb={});this.Seb[d]=z}$Ki(d){return this.Seb&&d in this.Seb?this.Seb[d]:null}}Object(ha.a)(gf,"AddinCommandsErrorManager",
null,[]);var Of=a(113);class sg{constructor(){this.zA=this.FAa=0;this.jqd=null;this.$Sc=this.h2c=0;this.PDa=this.hbd=this.r7c=null}get knc(){this.r7c||(this.r7c=new Qa.a);return this.r7c}get dJd(){this.hbd||(this.hbd=new Qa.a);return this.hbd}get IXa(){this.PDa||(this.PDa=new Qa.a);return this.PDa}}Object(ha.a)(sg,"AddinCommandsListLoaderContext",null,[]);class Cg{constructor(d,z){this.entitlement=d;this.metadata=z}S$b(){var d=this.entitlement;const z={};z.solutionId=d.solutionId;z.version=d.version;
z.storeType=d.storeType;z.storeId=d.storeId;z.assetId=d.assetId;z.assetStoreId=d.assetStoreId;z.targetType=d.targetType;z.requireConsent=d.requireConsent||!1;z.isAddinCommands=!0;z.addinCommandsActionType=0;z.targetType=this.targetType;return z}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(ha.a)(Cg,"AddinEntitlementEx",null,[]);var Pg=a(298),Qh=a(379);class Vh{}Object(ha.a)(Vh,"AppsForOfficeEntitlementQueryInfo",null,[]);class Rh{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(ha.a)(Rh,"AddinAbstract",
null,[]);class Ii extends Sys.EventArgs{constructor(){super();this.Mw=this.ls=null}}Object(ha.a)(Ii,"InsertionParamEventArgs",Sys.EventArgs,[]);class zj{constructor(d,z,T,ya){this.D_a=sb=>{let cc=!1,Fc=null;try{if(0<sb.data.responseData.length){const Wc=Object(wa.a)(Object,lf.a(sb.data.responseData)),id=Wc?Wc[this.appName]:null;id&&(Fc=Object(wa.a)(Object,lf.a(id.toString())))}cc=!0}catch(Wc){this.qxa(null)}cc&&this.ZCb&&this.ZCb(Fc)};this.qxa=sb=>{this.VCb&&this.VCb(sb?sb.data:null)};this.zAa=sb=>
{this.nFb&&this.nFb(sb?sb.data:null)};this.n6b=ea.AFrameworkApplication.fa.Ya("RoamingServiceHandlerWebServiceBase");this.appName=d;this.ZCb=z;this.VCb=T;this.nFb=void 0===ya?null:ya}$Fd(d){this.cti(d,this.D_a,this.qxa)}cti(d,z,T){const ya=new Sys.StringBuilder(this.n6b);ya.append("RoamingServiceHandler.ashx?action=");ya.append("getAddinTeachingCalloutSettings");ya.append("&");ya.append(this.VNd(d));ya.append("&");ya.append(ea.AFrameworkApplication.Jo);ea.AFrameworkApplication.rj.ov(ya.toString(),
1,null,null,!0,2,z,T,null)}Cxc(d){this.hti(d)}hti(d){var z=new Sys.StringBuilder(this.n6b);z.append("RoamingServiceHandler.ashx?action=");z.append("saveAddinTeachingCalloutSettings");z.append("&");z.append(ea.AFrameworkApplication.Jo);z=z.toString();d=lf.c(d);ea.AFrameworkApplication.rj.ov(z,2,d,null,!0,4,null,this.zAa,null)}VNd(d){const z=new Sys.StringBuilder("requestedsettings=");for(let T=0;T<d.count;T++)z.append(d.na(T)),T<d.count-1&&z.append(";");return z.toString()}}Object(ha.a)(zj,"AddinTeachingUIRoamingRequestHandler",
null,[]);class ej extends Sys.EventArgs{constructor(d){super();this.solutionId=d.solutionId;this.assetId=d.assetId;this.storeType=d.storeType;this.storeId=d.storeId;this.assetStoreId=d.assetStoreId;this.targetType=d.targetType;this.width=d.width;this.height=d.height;this.displayName=d.displayName;this.version=d.version}}Object(ha.a)(ej,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);class ti{constructor(d){this.Ueb=this.ls=null;this.zWc=!1;this.PDa=this.Vcc=this.bqa=this.Cl=this.v7c=
this.cwb=null;this.ZVj=()=>{const z=new Pg.ScriptSharpLegacyMap;this.Ueb&&this.Ueb.tabs&&!this.Ueb.tabs[0].isOfficeTab&&z.ga("SDX.FeatureFlags","NonOfficeTab");this.Jqb(ti.Ega(this.ls),"ClickOnLaunch",z);this.VMc();this.Ueb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.Ueb,()=>{const T=new Ii;T.ls=this.ls;this.eh.raiseEvent(Hc.a.A6f,T)}):la.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};this.iPj=()=>{this.Jqb(ti.Ega(this.ls),"ClickOnClose");
this.VMc()};this.RQj=()=>{this.Jqb(ti.Ega(this.ls),"ClickOnDismiss");this.VMc()};this.Ohg=z=>{if(z&&(z=z.detail)&&z.id&&this.Ghj(z.id)){const T=(z.action||"").toLowerCase();if(z.success&&"opened"===T)this.Jqb(ti.Ega(this.ls),"CampaignLaunched"),la.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.VMc(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.Ohg,!0);else{let ya;try{ya=JSON.stringify(z),la.ULS.sendTraceTag(508625353,
220,15,"Campaign launch failure. Event:"+ya)}catch(sb){ya="id : "+z.id+" telemetryEventName: "+z.telemetryEventName,la.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+ya+" Error: "+(sb?sb.toString():""))}}}};this.D_a=z=>{z?this.lNk(z)?(la.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.cwb="AddinHasShown"in z&&z.AddinHasShown?z.AddinHasShown.toString():null,this.Zhf()):(la.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),this.bqa(this.rGa,
null)):(la.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.cwb=null,this.Zhf())};this.qxa=z=>{la.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",z?z.httpStatus:-1);this.bqa(this.rGa,null)};this.zAa=z=>{la.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",z?z.httpStatus:-1)};this.eh=d}get appName(){return ea.AFrameworkApplication.fa.Ya("WebAppShortName")}get wIb(){this.v7c||(this.v7c=
new zj(this.appName,this.D_a,this.qxa,this.zAa));return this.v7c}get rGa(){this.Vcc||(this.Vcc=new Qa.a);return this.Vcc}set rGa(d){this.Vcc=d}get IXa(){this.PDa||(this.PDa=new Qa.a);return this.PDa}set IXa(d){this.PDa=d}$xh(d,z){window.addEventListener?(this.ls=d,this.Ueb=z,window.addEventListener("LaunchAddinTaskpane",this.ZVj,!0),window.addEventListener("DismissCallout",this.RQj,!0),window.addEventListener("CloseCallout",this.iPj,!0),window.addEventListener("FGWebSurfaceEvent",this.Ohg,!0)):la.ULS.sendTraceTag(508625357,
220,15,"AddEventListenerForTeachingCallout failed to get Window")}X9a(d,z,T,ya){this.Cl=d;this.rGa=z;this.IXa=T;this.bqa=ya;la.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",z?z.count.toString():"null",T?T.count.toString():"null");0<this.rGa.count||0<this.IXa.count?(d=new Qa.a,d.add(this.appName),this.wIb.$Fd(d)):this.bqa(new Qa.a,null)}Ghj(d){d=Td.a.ys(d);return-1!==d.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==d.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==d.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==d.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==d.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==d.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}TWc(d){if(this.appName){const z={},T={};T.LastTeachingUIShowTime=(new Date).toUTCString();T.AddinHasShown=d;z[this.appName]=lf.c(T);this.wIb.Cxc(z);la.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else la.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}VMc(){if(!this.zWc){const d=window.g_roamingAddinList;d&&(this.TWc(d),this.zWc=!0)}}Zhf(){const d=this.tei();0===d.targetType?(d.solutionId?this.obk(d):this.Jqb(null,"NoSolutionId"),this.U6g(d),this.bqa(this.rGa,null)):this.bqa(this.rGa,d);la.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",d.addinId)}obk(d){const z=new Vh;z.callbackFunc=T=>{if(T.errorCode){this.Jqb(d.solutionId,"FailToGetAppDetails");var ya=window.g_roamingAddinList;
ya&&this.TWc(ya)}else if(T.value)for(ya of T.value)if(T=ya[1],T===d.solutionId){const sb={};sb.solutionId=T;sb.assetId=ya[5];sb.storeType=ya[12];sb.storeId=ya[11];sb.assetStoreId=ya[6];sb.targetType=ya[3];sb.width=ya[7];sb.height=ya[8];sb.displayName=ya[0];sb.version=ya[4];la.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",d.solutionId);ya=new ej(sb);this.eh.raiseEvent(Hc.a.nUg,ya);break}};z.storeType=OSF.StoreTypeEnum.PrivateCatalog;z.fromInsertDialog=!1;
z.refresh=!1;this.Cl.queryEntitlementDetails(z)}lNk(d){if("LastTeachingUIShowTime"in d){if(d=+new Date-+new Date(d.LastTeachingUIShowTime.toString()),d<ea.AFrameworkApplication.fa.lP("AddinShowTeachingUIIntervalInMS",864E5))return la.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",d),!1}else la.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}tei(){let d=new Qh.a(new Rh,0),z=new Qh.a(new Rh,0),T=0,ya=0,sb=0;var cc=new Qa.a;
for(var Fc of this.rGa)cc.add(Fc);for(const Wc of this.IXa)cc.add(Wc);for(const Wc of cc)if(!("excatalog"!==Wc.storeType||wf.c(Wc.installTimeInMS)||!Wc.installTimeInMS||Wc.installTimeInMS<=ea.AFrameworkApplication.fa.lP("DateTimeInMSForNewAddin",16409952E5))){cc=ti.EDf(Wc);if(this.cwb&&(Fc=this.cwb.split(","),0<Fc.length&&Array.contains(Fc,cc))){sb++;la.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}cc.startsWith("private_")?(d=ti.wIf(Wc,d),ya++):(z=ti.wIf(Wc,
z),T++)}la.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",ya,T,sb);return 0<z.value?z.key:0<d.value?d.key:Object.assign(new Rh,{addinId:null,targetType:-1,solutionId:null})}Jqb(d,z,T){T=void 0===T?null:T;d={["AppTeachingUICalloutAction"]:z,["SDX.Id"]:d,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(T)for(const ya of T.keys)d[ya]=T.na(ya);Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:rd.a.Rm(d)})}U6g(d){d&&(window.g_roamingAddinList=this.cwb?this.cwb+","+d.addinId:d.addinId)}static Ega(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}static wIf(d,z){return z.value<d.installTimeInMS?new Qh.a(Object.assign(new Rh,{addinId:ti.EDf(d),targetType:d.targetType,solutionId:d.solutionId}),d.installTimeInMS):z}static EDf(d){return Telemetry.PrivacyRules.IsPrivateAddin(d.storeType,d.assetId,null,null,d.storeId)?"private_"+
d.installTimeInMS:d.solutionId}}Object(ha.a)(ti,"PrivateCatalogTeachingCalloutHandler",null,[]);const dj=()=>{const d=Lh.a.Bga(window.location.href.toLowerCase(),"wdomexsrctype");return!!d&&"4"===d},ui=()=>Lh.a.Bga(window.location.href.toLowerCase(),"wdtpl"),Ij=()=>{const d=Lh.a.Bga(window.location.href.toLowerCase(),"wdomexsrctype");return!!d&&"1"===d};var ik=a(1048);class Wk extends Sys.EventArgs{constructor(d){super();this.properties=d}}Object(ha.a)(Wk,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);class Jj{constructor(d,z,T){this.eh=new Of.a;this.context=new sg;this.tld=null;this.GVj=(ya,sb,cc,Fc)=>{ya?(ya=new Cg(cc.targetData,Fc),sb&&this.context.knc.add(ya),10===this.context.FAa&&(this.context.dJd.add(ya),0===ya.targetType&&this.context.IXa.add(ya))):(sb=cc.targetData,la.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(sb.solutionId,sb.storeType,sb.assetId,null,null,sb.storeId),sb.storeType));
this.E8d()};this.contextActivationMgr=d;this.pFh=z;this.Reb=T;this.appName=ea.AFrameworkApplication.fa.Ya("WebAppShortName")}get zyb(){this.tld||(this.tld=new ti(this.eh));return this.tld}ZAh(d){this.eh.addHandler(Hc.a.k5e,d)}KEh(d){this.eh.addHandler(Hc.a.nUg,d)}d4k(d){null!==d&&(this.context.FAa=d[Hc.a.i$],this.context.zA=d[Hc.a.f4],this.context.h2c=this.context.$Sc=0,d=Hc.a.EVa in d?d[Hc.a.EVa]:0,-1!==this.context.FAa&&0!==this.context.zA&&(this.context.jqd=this.pFh.createAddinDataProvider(ik.a(this.context.FAa),
this.contextActivationMgr),this.context.jqd?this.context.jqd.getEntitlementsAsync(this.contextActivationMgr.Gpa,!0,d,z=>{this.kWj(z)}):la.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.FAa)))}kWj(d){if(d&&0<d.length){this.context.h2c=d.length;const T=ui();for(let ya=0;ya<d.length;ya++){const sb=d[ya];if(Ij()&&sb&&sb.storeType&&"omex"===sb.storeType.toLowerCase()&&sb.assetId&&T&&sb.assetId.toLowerCase()===T.toLowerCase()){var z={["SDX_AppInstallOrigin"]:"DeeplinkUser",
["SDX_Id"]:Jj.Ega(sb)};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:rd.a.Rm(z)})}!sb||1!==sb.targetType&&-1!==sb.targetType?this.E8d():(z={},ea.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(z.solutionId=sb.solutionId,z.version=sb.version):(z.marketplaceId=sb.solutionId,z.marketplaceVersion=sb.version),z.storeType=sb.storeType,z.storeId=sb.storeId,z.targetData=sb,this.contextActivationMgr.isAddinCommandsExAsync(z,
this.GVj))}}else this.E8d()}E8d(){var d;(d=this.context).$Sc=d.$Sc+1;this.context.$Sc>=this.context.h2c&&(this.Reb.SNg(this.context.FAa,!1),0<this.context.h2c&&10===this.context.FAa&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(d=!1,dj()&&(d=this.Lzj(this.context.dJd)),this.Xyj(this.context.dJd),d?this.bqa(this.Yhf(this.context.knc)):this.zyb.X9a(this.contextActivationMgr,this.context.knc,this.context.IXa,(z,T)=>{const ya=new Qa.a;for(const sb of z)z=sb.S$b(),T&&T.solutionId===
sb.solutionId&&(z.showCallout=!0,this.zyb.U6g(T)),ya.add(z);this.bqa(ya)})):this.bqa(this.Yhf(this.context.knc)))}Yhf(d){const z=new Qa.a;if(d)for(const T of d)z.add(T.S$b());return z}bqa(d){d&&d.count||Bb.a.dRa(Hc.a.iqd,"false",this.context.FAa);d={["ack2"]:d};d[Hc.a.i$]=this.context.FAa;d[Hc.a.f4]=this.context.zA;this.eh.raiseEvent(Hc.a.k5e,new Wk(d),this)}Lzj(d){let z=!1;if(d&&1>d.count)return z;const T=ui();if(!T)return z;for(const ya of d)if(ya.storeId&&ya.storeId.toLowerCase()===T.toLowerCase()||
ya.assetId&&ya.assetId.toLowerCase()===T.toLowerCase())d={["SDX_Id"]:Jj.AKf(ya),["SDX_TargetType"]:wf.c(ya.targetType)?"":ya.targetType.toString()},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:rd.a.Rm(d)}),z=!0;return z}Xyj(d){if(!(d&&1>d.count))if(this.Reb.xnj()){var z=this.Reb.sTi();z?(d=this.JFf(d,z),la.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(d=this.JFf(d,null),la.ULS.sendTraceTag(527523847,306,50,"no data from cache"));
this.Reb.aGk(d)}else la.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}JFf(d,z){const T={};let ya=!1;const sb=new Set;for(const cc of d)if(d=Jj.AKf(cc))!z||d in z||(sb.add(cc.solutionId),this.OE(cc,d),la.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===d.toLowerCase()?ya||(ya=!0,T[d]=null):T[d]=null;ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutCDNotificationUpdateEnabled",!1)&&(z=this.Reb.$Jd(),this.Reb.TNg(new Set([...sb,
...z])));return T}OE(d,z){var T=d.installTimeInMS?(new Date(d.installTimeInMS)).toISOString():"";T={["SDX.Id"]:z,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:wf.c(d.targetType)?"":d.targetType.toString(),["SDX.AdminDeploymentTime"]:T};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:rd.a.Rm(T)});1===d.targetType&&Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppPinning",dataFields:rd.a.Rm({["SDX.Id"]:z,["SDX.AppInstallOrigin"]:"Organization",
["SDX.CommandPlacement"]:"Ribbon"})})}static Ega(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}static AKf(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}}Object(ha.a)(Jj,"AddInCommandsListLoader",null,[]);class Cj{constructor(d){this.lqh=d}get Gpa(){return this.lqh}insertOsfControl(d){return this.Gpa.insertOsfControl(d)}getManifestInvaildErrorString(){return this.Gpa.getManifestInvaildErrorString()}isAddinCommandsAsync(d,
z){this.Gpa.isAddinCommandsAsync(d,z)}isAddinCommandsExAsync(d,z){this.Gpa.isAddinCommandsExAsync(d,z)}ownerAddinControlRecreated(d,z){this.Gpa.ownerAddinControlRecreated(d,z)}queryEntitlementDetails(d){this.Gpa.queryEntitlementDetails(d)}}Object(ha.a)(Cj,"ContextActivationMgrWrapper",null,[341]);class oj{createAddinDataProvider(d,z){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(d,z.Gpa)}static get instance(){oj.Va||(oj.Va=new oj);return oj.Va}}oj.Va=null;Object(ha.a)(oj,"OSFAddinDataProviderFactory",
null,[332]);class Kj{constructor(d,z,T,ya,sb,cc){this.zA=d;this.ls=z;this.Aca=T;this.displayName=sb;this.x5f=cc}}Object(ha.a)(Kj,"PostLaunchAddinCommandsParameters",null,[]);class jk{constructor(d){this.Jed=null;this.cOe=d}get $2a(){return this.Jed}Aeb(d,z){this.cOe.Aeb(d,void 0===z?null:z);this.Jed=d}Cie(d){this.cOe.Cie(d)}SPg(d){this.Jed=d}}Object(ha.a)(jk,"RibbonExtensibilityManagerWithChangeDetection",null,[359]);var Lj=a(1079),Xk=a(106);class Ri{static PHf(d){const z=new Qa.a;if(Ri.Hhf)for(var T of Ri.Hhf)z.add(T);
T=null;switch(d){case "Workbook":T=Ri.dfl;break;case "Document":T=Ri.vhi;break;case "Presentation":T=Ri.U9j}if(T)for(const ya of T)z.add(ya);return z}}Ri.Hhf=["PrimaryCommandSurface","ContextMenu"];Ri.dfl=null;Ri.vhi=null;Ri.U9j=null;Object(ha.a)(Ri,"ExtensionPointType",null,[]);class Yk{constructor(d){this.ETe=null;if(wf.c(d))throw la.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.fhh=d}get D0b(){return this.ETe||
(this.ETe=new Qa.a)}get V5e(){return this.fhh}}Object(ha.a)(Yk,"ContextMenuExtensibility",null,[343]);class Rj{constructor(d,z,T){z=void 0===z?null:z;T=void 0===T?0:T;if(wf.c(d))throw la.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.eqh=d;this.xth=z;this.Ulh=T}get m7(){return this.eqh}get startedNode(){return this.xth}get sDi(){return this.Ulh}}Object(ha.a)(Rj,
"RibbonExtensibility",null,[362]);class qj{constructor(d){this.Vkh=d.entitlement}get entitlement(){return this.Vkh}createActionContext(d,z){d={};d.ownerAddinInfo=this.entitlement;d.action=z;return d}}Object(ha.a)(qj,"AddInCommandsContextProvider",null,[]);class Sj{constructor(d,z,T){this.OGe=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=d;this.eventBuilder=z;this.contextMenuBuilder=T}get addinInfo(){return this.OGe}q5h(d){return new qj(d)}createActionBuilder(d,
z){return OfficeExt.DefaultControlActionBinder.createActionBuilder(d,z.entitlement,z.manifest)}startApplyAddin(d){this.OGe=d;const z=this.q5h(d);this.actionBuilder=this.createActionBuilder(z,d)}endApplyAddin(){}HJd(d,z,T){T=void 0===T?0:T;return this.ribbonBuilder.jC&&0<this.ribbonBuilder.jC.count?new Rj(this.GCi(d,z),this.addinInfo.startedNode,T):null}MCf(){var d=void 0===d?null:d;if(this.contextMenuBuilder.nNc&&0<this.contextMenuBuilder.nNc.count){d||(d=this.addinInfo.entitlement.solutionId);d=
new Yk(d);for(const z of this.contextMenuBuilder.nNc)d.D0b.add(z);return d}return null}GCi(d,z){return this.ribbonBuilder.jC&&0<this.ribbonBuilder.jC.count?new fc.a(this.ribbonBuilder.jC,d,z):null}}Object(ha.a)(Sj,"AddinCommandsBuilder",null,[]);class tg{constructor(d,z,T,ya,sb,cc,Fc){this.o9a=new Xk.a;this.zA=d;this.Cl=z;this.Kx=T;this.ribbonManager=ya;this.contextMenuManager=sb;this.kL=cc;this.kua=Fc;this.SZ=ea.AFrameworkApplication.ra.yL}cZb(d,z,T,ya,sb,cc,Fc){const Wc=(id,Dd,ee,re)=>{sb(id,Dd,
ee,re);const Ce=Lj.a[this.zA]+Dd.assetId;let mf;(()=>{let tf=this.o9a.wj(Ce);({value:mf}=tf);return tf})().returnValue&&(mf.stop(),mf=null,this.o9a.remove(Ce))};if(0!==this.zA&&d){la.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",d.count);4===this.zA&&(la.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",ya)),this.aXh(d,ya),cc());for(const id of d)if(d=id,la.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Kx.rY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,
d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId))),this.Y8g(d))if(Fc&&d.requireConsent)Fc(d,Dd=>{try{if(this.SZ){const re=Lj.a[this.zA]+Dd.solutionId,Ce=this.SZ.Li("ComponentAttach",re);this.o9a.ga(re,Ce)}const ee=this.kL.ywa(Dd.storeType,Dd.solutionId);6!==this.zA&&(ee&&(this.Yqc(ee),ee.ZK.purge(!1)),this.Cl.insertOsfControl(this.r3b(Dd,z,T,Wc)),ee&&this.Cl.ownerAddinControlRecreated(Dd.solutionId,Dd.storeType))}catch(ee){la.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Kx.rY,Telemetry.PrivacyRules.GetPrivacyCompliantId(Dd.solutionId,Dd.ownerAddinStoreType||Dd.storeType,Dd.assetId,null,null,Dd.storeId),Dd.version,Dd.storeType,Dd.storeId,ee.message)),Wc(!1,Dd,null,null)}});else try{if(this.SZ){const ee=Lj.a[this.zA]+d.solutionId,re=this.SZ.Li("ComponentAttach",ee);this.o9a.ga(ee,re)}const Dd=this.kL.ywa(d.storeType,d.solutionId);3!==ea.AFrameworkApplication.ra.$g.kn&&1!==ea.AFrameworkApplication.ra.$g.kn&&2!==ea.AFrameworkApplication.ra.$g.kn||3!==this.zA||"excatalog"===
d.storeType||!Dd||Dd.isUpgraded?6!==this.zA&&(Dd&&(this.Yqc(Dd),Dd.ZK.purge(!1)),this.Cl.insertOsfControl(this.r3b(d,z,T,Wc)),Dd&&this.Cl.ownerAddinControlRecreated(d.solutionId,d.storeType)):(this.ribbonManager.SPg(Dd.Mw),Wc(!0,d,null,Dd.displayName))}catch(Dd){la.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Kx.rY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||
d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,Dd.message)),Wc(!1,d,null,null)}else Wc(!1,d,null,null)}}Ovj(d,z,T,ya,sb,cc){const Fc=(Wc,id,Dd,ee)=>{cc(Wc,id,Dd,ee);const re=Lj.a[this.zA]+id.solutionId;let Ce;(()=>{let mf=this.o9a.wj(re);({value:Ce}=mf);return mf})().returnValue&&(Ce.stop(),Ce=null,this.o9a.remove(re))};if(6===this.zA&&d)if(la.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Kx.rY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,
d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId))),this.Y8g(d))try{if(this.SZ){const id=Lj.a[this.zA]+d.solutionId,Dd=this.SZ.Li("ComponentAttach",id);this.o9a.ga(id,Dd)}const Wc=this.kL.ywa(d.storeType,d.solutionId);Wc||Fc(!1,d,null,null);ea.AFrameworkApplication.ra&&ea.AFrameworkApplication.ra.$g.delayInstallAddInIsEnabled?this.tDf(d,z,ya,sb,T,id=>{Fc(id,d,T,Wc.displayName)}):(this.tDf(d,z,ya,sb,T),Fc(!0,d,T,Wc.displayName))}catch(Wc){la.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.Kx.rY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,Wc.message)),Fc(!1,d,null,null)}else Fc(!1,d,null,null)}hNj(d,z,T,ya,sb,cc){if(cc)if(cc._isAddinCommandsManifest(this.Kx.rY))try{ea.AFrameworkApplication.ra&&ea.AFrameworkApplication.ra.$g.delayInstallAddInIsEnabled?this.sDf(d,z,T,sb,cc,Fc=>{ya(Fc,d,cc,cc.getDefaultDisplayName())}):(this.sDf(d,z,T,sb,cc),ya(!0,d,cc,cc.getDefaultDisplayName()))}catch(Fc){la.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Kx.rY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId,Fc.message)),ya(!1,d,cc,cc.getDefaultDisplayName())}else la.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Kx.rY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId)),ya(!1,d,null,null);else la.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Kx.rY,Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.ownerAddinStoreType||d.storeType,d.assetId,null,null,d.storeId),d.version,d.storeType,d.storeId)),
ya(!1,d,null,null)}r3b(d,z,T,ya){const sb={},cc=document.createElement("div");cc.setAttribute("visible","false");sb.div=cc;sb.id=d.solutionId;sb.solutionId=d.solutionId;sb.version=d.version;sb.storeType=d.storeType;sb.storeId=d.storeId;sb.assetId=d.assetId;sb.assetStoreId=d.assetStoreId;sb.isvirtualOsfControl=!0;sb.virtualOsfControlActivationCallback=(Fc,Wc)=>{const id=this.kL.ywa(d.storeType,d.solutionId);id&&(id.isUpgraded&&(d.isUpgraded=!0),this.Yqc(id));this.hNj(d,z,T,ya,Fc,Wc)};sb.reason=3===
this.zA?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return sb}sDf(d,z,T,ya,sb,cc){cc=void 0===cc?null:cc;const Fc={};Fc.solutionId=ya.getSolutionId();Fc.version=ya.getVersion();Fc.storeType=ya.getStoreType();Fc.storeId=ya.getStoreId();Fc.assetId=ya.getAssetId();Fc.assetStoreId=ya.getAssetStoreId();Fc.targetType=ya.getOsfControlType();let Wc=null,id=null;if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))Wc=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Kx.rY,this.Kx.formFactor)).parseExtensions(Fc,sb,this.kua),id=Ri.PHf(this.Kx.rY);else try{Wc=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Kx.rY,this.Kx.formFactor)).parseExtensions(Fc,sb,this.kua),id=Ri.PHf(this.Kx.rY)}catch(ee){throw la.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+ee.message),ee;}if(id&&0<id.count){if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Dd=z(d);z=T(d);T=!!ea.AFrameworkApplication.fa&&ea.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Dd=new Sj(Dd,null,z);for(const ee of id)Dd.commandSurface=ee,Wc.apply(Dd,this.kua,T)}else try{const ee=z(d),re=T(d),Ce=!!ea.AFrameworkApplication.fa&&ea.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");Dd=new Sj(ee,null,re);for(const mf of id)Dd.commandSurface=mf,Wc.apply(Dd,this.kua,Ce)}catch(ee){throw la.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
ee.message),ee;}if(OSF.OUtil.checkFlight(14))try{const ee=Dd.HJd(d.solutionId,sb.getDefaultDisplayName()),re=Dd.MCf();ee&&this.ribbonManager.Aeb(ee,cc);re&&this.contextMenuManager.d2e(re);this.kL.M2e(ya,ee,re,sb.getDefaultDisplayName());la.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",sb.getDefaultDisplayName())}catch(ee){throw OfficeExt.DevConsole.log(ee),la.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+ee.message),ee;}else try{const ee=Dd.HJd(d.solutionId,
sb.getDefaultDisplayName()),re=Dd.MCf();ee&&this.ribbonManager.Aeb(ee);re&&this.contextMenuManager.d2e(re);this.kL.M2e(ya,ee,re,sb.getDefaultDisplayName());la.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",sb.getDefaultDisplayName())}catch(ee){throw la.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+ee.message),ee;}}}tDf(d,z,T,ya,sb,cc){cc=void 0===cc?null:cc;const Fc={};Fc.solutionId=d.solutionId;Fc.version=d.version;Fc.storeType=d.storeType;Fc.storeId=
d.storeId;Fc.assetId=d.assetId;Fc.assetStoreId=d.assetStoreId;Fc.targetType=d.targetType;const Wc=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Kx.rY,this.Kx.formFactor);try{const id=z.getManifest(),Dd=Wc.parse(Fc,id,sb,this.kua,z.getSharedRuntimeId(),z),ee=T(d),re=ya(d),Ce=new Sj(ee,null,re);Ce.commandSurface="PrimaryCommandSurface";Dd.apply(Ce,this.kua,!0);if(Ce.ribbonBuilder.jC&&0<Ce.ribbonBuilder.jC.count){const mf=Ce.HJd(d.solutionId,z.getManifest().getDefaultDisplayName(),1);ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.Aeb(mf,cc):mf&&this.ribbonManager.Aeb(mf,cc);this.kL.Tyh(z,mf,sb,z.getManifest().getDefaultDisplayName());la.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",z.getManifest().getDefaultDisplayName())}}catch(id){la.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",z.getManifest().getDefaultDisplayName(),id.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(id)}}Yqc(d){d.Mw&&this.ribbonManager.Cie(d.Mw);
d.bMb&&this.contextMenuManager.bkk(d.bMb);this.kL.Ljk(d.ZK.getStoreType(),d.ZK.getSolutionId())}aXh(d,z){z=ik.a(z);for(const T of this.kL.wnb){if(T.ZK.getStoreType()!==z)continue;let ya=!0;for(const sb of d){const cc=sb;if(cc&&T.w2f(cc.storeType,cc.solutionId)){ya=!1;break}}ya&&(this.Yqc(T),T.ZK.purge(!1))}}Y8g(d){return!!d&&!!d.solutionId&&!!d.version&&!!d.storeType&&!!d.storeId}}Object(ha.a)(tg,"AddInCommandsIntegration",null,[]);class Tj{constructor(d,z,T,ya,sb,cc,Fc,Wc){Wc=void 0===Wc?null:Wc;
this.hh=new Of.a;this.t7c=d;this.Djh=z;this.Dr=T;this.h_e=ya;this.bdb=sb;this.Ugh=cc;this.Wcc=Fc;this.Wph=Wc}$Ah(d){this.hh.addHandler(Hc.a.l5e,d)}dDh(d){this.hh.addHandler(Hc.a.A6f,d)}JEh(d){this.hh.addHandler(Hc.a.oUg,d)}fBh(d){this.hh.addHandler(Hc.a.Esd,d)}lwj(d,z,T){const ya=T[Hc.a.sIb],sb=void 0===T[Hc.a.f4]?0:T[Hc.a.f4];if(ya&&0!==sb)if(0>=ya.count&&4!==sb)this.Yvg(new Kj(sb,null,null,z,null,!0));else{var cc=ya.count,Fc=new jk(new Kc),Wc=void 0===T[Hc.a.i$]?-1:T[Hc.a.i$],id=new tg(sb,this.Dr,
this.t7c,Fc,this.Djh,this.bdb,this.Wcc),Dd=tf=>this.h_e.BPh(tf.solutionId,this.Wcc,this.t7c,d),ee=tf=>this.h_e.MOh(tf.solutionId),re=(tf,Df,sf)=>{cc--;sf=new Kj(sb,Df,Fc,z,sf,0>=cc);if(tf&&Df)this.Yvg(sf);else{if(3===sb||Df&&Df.isUpgraded)tf="",Df&&(tf=Telemetry.PrivacyRules.GetPrivacyCompliantId(Df.solutionId,Df.ownerAddinStoreType||Df.storeType,Df.assetId,null,null,Df.storeId)),Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:rd.a.Rm({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:tf})});this.Xvg(sf)}cc||ea.AFrameworkApplication.ra.XB()},Ce=(tf,Df,sf,$f)=>{re(tf,Df,$f)},mf=()=>{this.S7d();0>=ya.count&&4===sb&&this.bdb.epe()};6===sb?(Wc=T[Hc.a.NYa],T=T[Hc.a.OYa],id.Ovj(ya.na(0),Wc,T,Dd,ee,(tf,Df,sf,$f)=>{re(tf,Df,$f)})):id.cZb(ya,Dd,ee,Wc,Ce,mf,this.Wph)}else Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:rd.a.Rm({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",
["SDX_Id"]:""})}),la.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.t7c.rY)),this.Xvg(new Kj(sb,null,null,z,null,!0))}Xvg(d){this.S7d(d);this.uVg(!1,d)}Yvg(d){const z=d.ls;let T=null;null!==z&&(T=z.storeType,T=T.toLowerCase());if(d&&"omex"===T&&(3===d.zA||z.isUpgraded)){var ya={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(z.solutionId,z.ownerAddinStoreType||
z.storeType,z.assetId,null,null,z.storeId)};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppInstall",dataFields:rd.a.Rm(ya)})}this.S7d(d);ya=Ij()&&"omex"===T&&!!d.Aca&&!!z.solutionId&&2===d.zA&&z.solutionId.toLowerCase()===ui().toLowerCase();var sb="excatalog"===T&&3===d.zA;if("omex"===T&&d.Aca&&(3===d.zA&&"hardcodedpreinstall"!==T||z.isUpgraded)||ya||sb)ya=new Ii,ya.ls=z,ya.Mw=d.Aca.$2a,this.hh.raiseEvent(Hc.a.Esd,ya);ya=dj();sb=ui();ya&&z&&"excatalog"===z.storeType&&d.Aca&&5===d.zA&&
sb&&(z.storeId&&z.storeId.toLowerCase()===sb.toLowerCase()||z.assetId&&z.assetId.toLowerCase()===sb.toLowerCase())&&(ya=new Ii,ya.ls=z,ya.Mw=d.Aca.$2a,this.hh.raiseEvent(Hc.a.Esd,ya),la.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));z&&(nd.instance.SNg(ik.b(T),!0),"uploadfiledevcatalog"===T&&(ya=this.Ugh.createAddinDataProvider(T,this.Dr))&&ya.localCacheAddinCommands(this.Dr.Gpa,z.solutionId,z.version,z.storeId),Bb.a.dRa(Hc.a.iqd,"true",ik.b(T)));this.uVg(!0,d)}uVg(d,
z){d?z.Aca&&5===z.zA&&z.Aca.$2a&&void 0!==z.ls.showCallout&&null!==z.ls.showCallout&&z.ls.showCallout?((new ti(this.hh)).$xh(z.ls,fc.a.KQb(z.Aca.$2a)),d=new Ii,d.Mw=z.Aca.$2a,d.ls=z.ls,this.hh.raiseEvent(Hc.a.oUg,d)):3!==z.zA?z.x5f&&this.bdb.epe():z.Aca&&z.Aca.$2a&&"hardcodedpreinstall"!==z.ls.storeType&&ud.a.xOk(z.displayName,z.Aca.$2a,z.ls.isAutoLaunched):3===z.zA?z.ls&&"uploadfiledevcatalog"===z.ls.storeType.toLowerCase()?(z=this.Wcc.$Ki(z.ls.solutionId),ud.a.Lse(z?z:Object(Nb.a)("InternalError")+
" "+Object(Nb.a)("InternalError_Directive"))):this.bdb.bPg():z.x5f&&this.bdb.epe()}S7d(d){var z=(d=void 0===d?null:d)?d.ls:null;const T=new Ii;if(T.ls=z){var ya=this.bdb.ywa(z.storeType,z.solutionId,6===d.zA?1:0);if(ya&&ya.Mw){T.Mw=ya.Mw;var sb=ui();sb=Ij()&&!!z.solutionId&&!!sb&&z.solutionId.toLowerCase()===sb.toLowerCase()&&2===d.zA;if(3===d.zA&&"hardcodedpreinstall"!==z.storeType||sb)d="",ya.Mw.m7&&ya.Mw.m7.jC&&(ya=ya.Mw.m7.jC.na(0))&&(d=ya.id),z={["SDX_CommandPlacement"]:d,["SDX_PinningAction"]:"Pinning",
["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(z.solutionId,z.ownerAddinStoreType||z.storeType,z.assetId,null,null,z.storeId)},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppPinning",dataFields:rd.a.Rm(z)})}}this.hh.raiseEvent(Hc.a.l5e,T)}}Object(ha.a)(Tj,"LaunchAddinCommandsHandler",null,[337]);class fh{}fh.X$a="Alt";fh.Y$a="Command";fh.id="Id";fh.aab="Image16by16";fh.Dcc="LabelText";fh.dab="Title";fh.GROUP="Group";fh.sEe="Groups";fh.xAb="Controls";
fh.button="Button";fh.ina="FlyoutAnchor";fh.LARGE="Large";fh.SMALL="Small";Object(ha.a)(fh,"AddinDataNodeConstants",null,[]);var Ak=a(289);a(664);var Bk=a(488);class rj{constructor(d,z){this.PTa=this.uJe=null;if(wf.c(d)||wf.c(z))throw la.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.Kjh=z;this._id=d;this.H4[fh.id]=this._id}get id(){return this._id||""}get H4(){return this.uJe||
(this.uJe={})}get controlType(){return this.Kjh||""}get menuItems(){return this.PTa||(this.PTa=new Qa.a)}}Object(ha.a)(rj,"ControlDefinition",null,[338]);class Zk{constructor(d){this.mSe=null;if(wf.c(d))throw la.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=d;this.Bza[fh.id]=this._id}get Bza(){return this.mSe||(this.mSe={})}get id(){return this._id||""}}Object(ha.a)(Zk,"MenuItemDefinition",
null,[361]);class $k{constructor(d){this.RDa=null;if(wf.c(d))throw la.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=d}get id(){return this._id}get controls(){return this.RDa||(this.RDa=new Qa.a)}}Object(ha.a)($k,"OfficeMenuDefinition",null,[334]);var cg=a(26);class Mj{constructor(d,z,T){this.RT=this.Rab=null;this.Bgd=d;this.Hab=z;this.gab=T;this.vph=new Qa.a}get SNc(){return this.Bgd}get CLb(){return this.Hab}get cnd(){return this.gab}addButton(d){la.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",d.actionType);this.RT=new rj(this.WGa(d.id),fh.button);this.RT.H4[fh.Dcc]=d.label;this.RT.H4[fh.X$a]=d.label;this.RT.H4[fh.aab]=d.icon["16"];this.FJb(this.RT.H4[fh.id],d.action);this.qVa(this.RT.H4);this.Rab.controls.add(this.RT);this.RT=null}startBuildMenu(d){if(wf.c(this.Rab))this.Rab=new $k(d.id);else{const z=this.WGa(d.id);this.RT=new rj(z,fh.ina);this.ogb(this.RT.H4,d);this.RT.H4[fh.aab]=d.icon["16"];this.RT.H4[fh.Y$a]=cg.a.alwaysEnabled}}addMenuItem(d){la.ULS.sendTraceTag(17085953,
220,50,"ContextMenu menu item actiontype: {0}.",d.actionType);const z=new Zk(this.WGa(d.id));this.ogb(z.Bza,d);d.icon&&(z.Bza[fh.aab]=d.icon["16"]);this.FJb(z.Bza[fh.id],d.action);this.qVa(z.Bza);this.RT.menuItems.add(z)}endBuildMenu(){wf.c(this.RT)?(this.nNc.add(this.Rab),this.Rab=null):(this.Rab.controls.add(this.RT),this.RT=null)}get nNc(){return this.vph}FJb(d,z){this.cnd.bindAction(d,z)}qVa(d){this.CLb.qVa(d)}WGa(d){return this.SNc.h_a(d)}ogb(d,z){d[fh.Dcc]=z.label;d[fh.X$a]=z.label}}Object(ha.a)(Mj,
"ContextMenuExtensibilityCreator",null,[360,353]);class Uj{constructor(d){this.JEb=d}get X_b(){return this.JEb}h_a(d){return this.X_b+d}}Object(ha.a)(Uj,"DefaultContextMenuNamingProvider",null,[357]);var fj=a(1452);class al{bindAction(d,z){OfficeExt.DefaultControlActionBinder.bindAction(d,z)}}Object(ha.a)(al,"DefaultUIControlActionBinder",null,[355]);class Ck{constructor(d){this.xSa=d}get command(){return this.xSa}qVa(d){d[fh.Y$a]=this.command}}Object(ha.a)(Ck,"DefaultUIControlCommandBinder",null,
[354]);var bl=a(34);class Dj{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(ha.a)(Dj,"AddInControl",null,[]);class kk{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(ha.a)(kk,"AddInGroup",null,[]);class gj{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(ha.a)(gj,"AddInMenuItem",null,[]);class cl{constructor(){this.groups=
this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(ha.a)(cl,"AddInTab",null,[]);class Dk{constructor(d,z,T,ya,sb,cc){this.Tcc=new Qa.a;this.PBb=this.dsa=this.Sab=null;this.Bgd=d;this.gab=z;this.Hab=T;this.IG=ya;this.Wcc=sb;this.zLe=cc}get SNc(){return this.Bgd}get jC(){return this.Tcc}get cnd(){return this.gab}get CLb(){return this.Hab}startBuildTab(d){const z=d.isOfficeTab?d.id:this.SNc.AMf(d.id),
T=d.isOfficeTab?null:d.label;this.Sab=Object.assign(new cl,{id:z,title:T,isOfficeTab:d.isOfficeTab,visible:d.visible,groups:[],tabType:d.tabType,insertBefore:d.insertBefore,insertAfter:d.insertAfter,autoFocus:d.autoFocus})}startBuildGroup(d){const z=this.WGa(d.id);this.dsa=Object.assign(new kk,{id:z,mlrId:d.mlrId,title:d.label,controls:[],groupType:0})}addNativeGroup(d){this.dsa=Object.assign(new kk,{id:d.id,mlrId:d.mlrId,title:d.label,controls:[],groupType:1});this.Sab.groups.push(this.dsa)}addButton(d){const z=
this.WGa(d.id);z&&(this.FJb(z,d.action),la.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",d.actionType),d=Object.assign(new Dj,{id:z,title:d.label,iconLocation:this.uMd(d),enabled:d.enabled,controlType:0,attributes:this.ogb()}),this.zLe.P1e(new bl.a(z,this.CLb.command.toString())),this.dsa.controls.push(d))}addNativeControl(d){d.id&&(la.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",d.actionType),d=Object.assign(new Dj,{id:d.id,
title:"",iconLocation:"",enabled:d.enabled,controlType:2,attributes:this.ogb()}),this.dsa.controls.push(d))}startBuildMenu(d){const z=this.WGa(d.id);z&&(this.PBb=Object.assign(new Dj,{id:z,title:d.label,iconLocation:this.uMd(d),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(d){const z=this.WGa(d.id);z&&(this.FJb(z,d.action),la.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",d.actionType),d=Object.assign(new gj,{id:z,title:d.label,iconLocation:this.uMd(d),
enabled:d.enabled,attributes:this.ogb()}),this.zLe.P1e(new bl.a(z,this.CLb.command.toString())),this.PBb.menuItems.push(d))}endBuildMenu(){wf.c(this.PBb.id)||this.dsa.controls.push(this.PBb);this.PBb=null}endBuildGroup(){wf.c(this.dsa.id)||this.Sab.groups.push(this.dsa);this.dsa=null}endBuildTab(){wf.c(this.Sab.id)||this.Tcc.add(this.Sab);this.Sab=null}ogb(){const d={};this.qVa(d);return d}uMd(d){return d.icon["80"]?d.icon["80"]:d.icon["32"]}qVa(d){this.CLb.qVa(d)}WGa(d){return this.SNc.h_a(d)}FJb(d,
z){this.cnd.bindAction(d,z)}}Object(ha.a)(Dk,"OneLineRibbonExtensibilityCreator",null,[352,353]);class Vj{constructor(d,z){this.JEb=d;this.gab=new al;this.Hab=new Ck(z)}MOh(d){d=new Uj(d);return new Mj(d,this.Hab,this.gab)}BPh(d,z,T,ya){T=new fj.a(this.JEb,d,T,!0);return new Dk(T,this.gab,this.Hab,d,z,ya)}}Object(ha.a)(Vj,"UIExtensibilityFactory",null,[333]);var dl=a(1114);class Th{get Eah(){return ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}constructor(d){this.CVa=
this.GVa=this.ls=this.Mw=null;this.UDg=0;this.XVj=()=>{if(this.ls&&this.CVa){const z=new tb.a(cg.a.Bea,0,0,2,null);this.addinUICommandHandler.executeCommand(0,z,{["SourceControlId"]:this.CVa},null);la.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.yOk=(z,T)=>{z=null;if(T)if(z=T,this.ls=z.ls,(this.Mw=z.Mw)&&this.Mw.m7&&this.Mw.m7.jC&&(this.GVa=this.Mw.m7.jC.na(0)),this.GVa&&this.GVa.id)if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",
!1)&&this.XPg(),this.GVa.isOfficeTab)if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)||this.XPg(),this.CVa)if(zd.a.contains(this.GVa.id,Qe.a.VS,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(fc.a.KQb(this.Mw),()=>{this.fWg(this.XNd(this.CVa))});else{if(T=this.$.Ma)T.$pd(this.hrg),la.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else la.ULS.sendTraceTag(537170694,220,10,
"Failed to get button id for addin"),T={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Th.GetPrivacyCompliantId(this.ls),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:rd.a.Rm(T)}),this.Mha();else this.hWg(this.XNd(this.GVa.id),0);else la.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),T={["AppTeachingUICalloutAction"]:"NoTabFound",
["SDX.Id"]:Th.GetPrivacyCompliantId(this.ls),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:rd.a.Rm(T)}),this.Mha();else this.Mha()};this.hrg=()=>{if(zd.a.contains(this.GVa.id,appChrome.selectors.getSelectedTabId(),!0)){var z=this.$.Ma;z&&z.WFg(this.hrg);this.fWg(this.XNd(this.CVa))}};this.$Vj=()=>{var z={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Th.Z$a(this.tM),
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:rd.a.Rm(z)});this.Mha();const T={};T[wb.a.Xk]=this.tM;z={};z.solutionId=this.tM.solutionId;z.assetId=this.tM.assetId;z.assetStoreId=this.tM.assetStoreId;z.height=0!=this.tM.height?this.tM.height:600;z.storeId=this.tM.storeId;z.storeType=this.tM.storeType;z.targetType=this.tM.targetType;z.width=0!=this.tM.width?this.tM.width:
600;z.displayName=this.tM.displayName;z.version=this.tM.version;z.isAddinCommands=!1;T[Hc.a.h$]=z;const ya=new tb.a(-741808261,0,0,2,null);Oa.TaskExtensions.Xa(ed.GetServiceTaskFactory.Tj(this.$.la,374,375,1),sb=>{sb=sb.result;null!=sb&&sb.insertAgave(T,ya)},this.$.ya,3)};this.jPj=()=>{const z={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Th.Z$a(this.tM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:rd.a.Rm(z)});this.Mha()};this.SQj=()=>{const z={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Th.Z$a(this.tM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:rd.a.Rm(z)});this.Mha()};this.zAa=z=>{la.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${z?z.httpStatus:-1}`)};this.$=d.$;this.addinUICommandHandler=
d;this.appName=ea.AFrameworkApplication.fa.Ya("WebAppShortName")||"Excel";this.zFh=ea.AFrameworkApplication.fa.Lj("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}static Z$a(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}$ik(d){this.tM=d;window.addEventListener&&(window.addEventListener("LaunchContentAddin",
this.$Vj,!0),window.addEventListener("DismissCallout",this.SQj,!0),window.addEventListener("CloseCallout",this.jPj,!0))}XPg(){var d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();const z=this.ls.solutionId;z in d?this.CVa=d[z]:(d=Th.GetPrivacyCompliantId(this.ls),la.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${d}`),this.CVa=this.cEi(this.Mw))}XNd(d){return"[id="+d+"]"}hWg(d,z){z>this.zFh?(window.clearTimeout(this.UDg),this.gWg("[data-unique-id='pivotOverflowButton']"),
la.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+d)?this.gWg(d):this.UDg=window.setTimeout(()=>{this.hWg(d,z+1)},1E3)}fWg(d){var z=document.querySelector("button[data-unique-id='RightPaddle']");if(z)d={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Th.GetPrivacyCompliantId(this.ls),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:rd.a.Rm(d)});else if(z=document.querySelector("button"+d),!z||"none"===window.getComputedStyle(z).display)if(z=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!z){z={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Th.GetPrivacyCompliantId(this.ls),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:rd.a.Rm(z)});la.ULS.sendTraceTag(537170691,
220,15,"ShowTeachingCallout failed to get an anchorElement");this.Mha();return}this.g2g(z,"ShowTeachingUIForAddinButton")}gWg(d){d=document.querySelector("button"+d);if(!d&&(d=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!d)){d={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Th.GetPrivacyCompliantId(this.ls),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:rd.a.Rm(d)});la.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.Mha();return}this.g2g(d,"ShowTeachingUIForAddinTab")}g2g(d,z){d.setAttribute("lpp-id","latestAddin");const T=Db.a.instance.fj("Common.ISystemInitiatedFeedback");T&&d?(T.execute(ya=>{ya.logActivity(z,null)}),d={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Th.GetPrivacyCompliantId(this.ls),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},
Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:rd.a.Rm(d)}),la.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(la.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),d={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Th.GetPrivacyCompliantId(this.ls),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:rd.a.Rm(d)}),this.Mha())}cEi(d){if(d&&(d=d.m7,(null===d||void 0===d?0:d.jC)&&0<d.jC.count))for(const z of d.jC)if(z.groups&&0<z.groups.length)for(const T of z.groups)if(T.controls&&0<T.controls.length)for(const ya of T.controls){if(ya.attributes&&0===ya.controlType&&ya.enabled)return ya.id;if(ya.menuItems)for(const sb of ya.menuItems)if(sb.attributes&&sb.enabled)return ya.id}}eWg(){var d="button[data-unique-id = 'Ribbon-InsertAppsForOffice']";ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&
(d=this.Eah?"button[data-unique-id = 'Ribbon-InsertAddInFlyout']":d);if((d=document.querySelector(d))&&"none"!==window.getComputedStyle(d).display)la.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{d=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==d){d={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Th.Z$a(this.tM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:rd.a.Rm(d)});la.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.Mha();return}la.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const z=Db.a.instance.fj("Common.ISystemInitiatedFeedback");null==z||null==d?(d={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Th.Z$a(this.tM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:rd.a.Rm(d)}),la.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.Mha()):(z.execute(T=>{T.logActivity("ShowTeachingUIForContentAddin",null)}),d={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Th.Z$a(this.tM),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:rd.a.Rm(d)}),la.ULS.sendTraceTag(527286664,220,
50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}TWc(d){const z={},T={};T.LastTeachingUIShowTime=(new Date).toUTCString();T.AddinHasShown=d;z[this.appName]=lf.c(T);this.wIb=new zj(this.appName,null,null,this.zAa),this.wIb.Cxc(z),la.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}Mha(){if(!this.zWc){const d=window.g_roamingAddinList;d&&(this.TWc(d),this.zWc=!0)}}}Object(ha.a)(Th,"AddinTeachingCalloutHandler",
null,[]);var Nj=a(1388),wl=a(308),hj=a(48),sj=a(240),ei=a(247);class wj extends sj.a{constructor(d,z,T,ya){super();this.k9="calc(100% - 46px)";this.pka="15px";this.l9="0";this.jCb="WACDialogPanel";this.UN=695;this.kCb=462;this.ML="80%";this.WAb=350;this.HDa="100%";this.s3=null;this.Ph=5;this.kl="AddinInstallDialog";this.Khh=d;this.y9=z;this.Wuh=T;this.bqh=ya}oG(){super.oG();this.Wo.style.width=this.HDa;this.Wo.style.height=this.k9;this.Wo.style.marginTop=this.pka;this.Wo.style.padding=this.l9;document.getElementById(this.ip("WACDialogButtonPanel")).style.display=
"none";this.dva.setAttribute("tabindex","0");$addHandler(this.dva,"keyup",Object(Hf.a)(this,this.onKeyUp,"onKeyUp"));const d=document.createElement("iframe");d.setAttribute("id","InstallAddinDialog");d.setAttribute("src","about:blank");d.setAttribute("width","100%");d.setAttribute("height","100%");d.setAttribute("marginHeight","0");d.setAttribute("marginWidth","0");d.setAttribute("frameBorder","0");d.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");
const z=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.Khh,this.y9,this.Wuh);d.setAttribute("src",z);this.s3=d;$addHandler(d,"load",Object(Hf.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(Hf.a)(this,this.onMessage,"onMessage"));this.Wo.appendChild(d);this.Wo.appendChild(this.n6h())}n6h(){const d=document.createElement("div");d.setAttribute("tabindex","0");$addHandler(d,"focus",Object(Hf.a)(this,this.uWj,"onLoopPivotFocus"));
return d}onKeyUp(d){13!==d.keyCode&&32!==d.keyCode||this.hide()}uWj(){this.dva.focus()}onLoad(){this.s3.focus()}onMessage(d){d=d.rawEvent;if(d.source===this.s3.contentWindow&&(d=(d=d.data)?d.split("|"):null)&&0<d.length&&("REFRESH_REQUIRED"===d[0]||"PRELOAD_MANIFEST"===d[0])){aa.a.instance.setItem("refreshRequired","true");const z={};z.solutionId=d[1];z.version=wj.EKj(d[3]);z.storeType=d[4];z.storeId=d[5];z.assetId=d[6];z.targetType=wj.Y4j(d[2]);z.assetStoreId=d[7];z.width=parseInt(d[8]);z.height=
parseInt(d[9]);this.bqh(z)}}KAa(){this.Wo.style.width=this.HDa;this.Wo.style.height=this.k9;this.Wo.style.marginTop=this.pka;this.Wo.style.padding=this.l9;this.UN>ei.a.Zba?(this.ph.style.width=String.format("{0}px",ei.a.Zba),this.ph.style.overflowX="scroll",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0"):(this.ph.style.width=String.format("{0}px",this.UN),this.ph.style.overflowX="hidden");this.ph.offsetHeight>ei.a.X1||this.kCb+50>ei.a.X1?(this.ph.style.height=String.format("{0}px",
ei.a.X1),this.ph.style.overflowY="scroll",this.ph.style.top="0",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0",this.Wo.style.minHeight=String.format("{0}px",this.WAb)):(this.ph.style.overflowY="hidden",this.ph.style.top="10%",this.ph.style.height=this.ML);this.cma()}cma(){if(this.ph){var d=this.ph.style.zIndex;this.ph.style.zIndex="-9999";if(this.UN>ei.a.Zba)ea.AFrameworkApplication.isRtl?this.ph.style.marginRight="0":this.ph.style.marginLeft="0";else{const z=String.format("{0}px",
Math.floor(-this.ph.offsetWidth/2));ea.AFrameworkApplication.isRtl?this.ph.style.marginRight=z:this.ph.style.marginLeft=z;ea.AFrameworkApplication.isRtl?this.ph.style.right="50%":this.ph.style.left="50%"}this.ph.style.zIndex=String(d)}else la.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}oT(){super.oT();const d=document.getElementById(this.ip(this.jCb));d.style.width=String.format("{0}px",this.UN);d.style.height=this.ML}get Lma(){return this.Wo}dispose(){super.dispose();
$removeHandler(window,"message",Object(Hf.a)(this,this.onMessage,"onMessage"))}static Y4j(d){switch(d){case "1":return 0;case "2":return 1;default:return 0}}static EKj(d){const z=d.split(".");for(let T=0;T<4-z.length;T++)d+=".0";return d}}Object(ha.a)(wj,"AddinInstallDialog",sj.a,[]);class Ek{constructor(){this.addInDetails=this.title=null}}Object(ha.a)(Ek,"AddInCategoryData",null,[]);class lk{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(ha.a)(lk,
"AddInDetailData",null,[]);class Fk{constructor(){this.href=this.text=null}}Object(ha.a)(Fk,"AddInLinkData",null,[]);var xj=a(1046),Wj;(function(d){d[d.Mjl=0]="S_OK";d[d.Khl=-2147471590]="E_REQUEST_TIME_OUT";d[d.Lhl=-2147208619]="E_USER_NOT_SIGNED_IN";d[d.Chl=-2147471591]="E_CATALOG_ACCESS_DENIED";d[d.Ehl=-2147471589]="E_CATALOG_REQUEST_FAILED";d[d.Hhl=-2147208640]="E_OEM_NO_NETWORK_CONNECTION";d[d.Jhl=-2147208617]="E_PROVIDER_NOT_REGISTERED";d[d.Ghl=-2147208637]="E_OEM_CACHE_SHUTDOWN";d[d.Ihl=-2147209421]=
"E_OEM_REMOVED_FAILED";d[d.Dhl=-1]="E_CATALOG_NO_APPS";d[d.Mhl=-2]="E_USER_NO_MAILBOX";d[d.Fhl=-1E3]="E_GENERIC_ERROR";d[d.Ljl=10]="S_HIDE_PROVIDER"})(Wj||(Wj={}));Object(ha.b)("InvokeResultCode",Wj);class Xj{constructor(d,z){this.Ga=z;this.Ww=d}get VQk(){return this.Ga?this.Ga.isChangeGateEnabled("OfficeVSO:8511220_showPopularOnFailForGuests"):!1}MVg(d){return this.VQk?d.failure?-2147208619===d.failure.invokeResultCode:!1:!1}iIf(d,z){return`invokeFailure/${3===d.errorCode&&d.failure?Wj[d.failure.invokeResultCode]:
""}/${3===z.errorCode&&z.failure?Wj[z.failure.invokeResultCode]:""}`}n8f(d,z,T,ya){d={["Source"]:this.Ww,["MRUListNumber"]:d.toString(),["MyAddinsErrorCode"]:xj.a[z.errorCode],["MyAddInsResult"]:z.Ht.length.toString(),["MyAddinsInvokeResultCode"]:z.failure?z.failure.invokeResultCode:"N/A",["AdminManagedErrorCode"]:xj.a[T.errorCode],["AdminManagedResult"]:T.Ht.length.toString(),["AdminManageInvokeResultCode"]:T.failure?T.failure.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:ya?xj.a[ya.errorCode]:
"N/A",["PopularAddinsResult"]:ya?ya.Ht.length.toString():"N/A",["PopularAddinsInvokeResultCode"]:ya&&ya.failure?ya.failure.invokeResultCode:"N/A"};this.NLk&&(d.MyAddinsQueryStart=this.cCc(z.failure),d.AdminManagedQueryStart=this.cCc(T.failure),d.PopularQueryStart=this.cCc(ya.failure));Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:rd.a.Rm(d)})}m8f(d,z,T,ya,sb){T={["MyAddinsResult"]:this.Ktd(T),["AdminManagedResult"]:this.Ktd(ya),["PopularResult"]:this.Ktd(sb)};
d={["Source"]:this.Ww,["Abnormals"]:z.join("|"),["NumAddinsInMRU"]:d.toString(),["DiagnosticDetails"]:JSON.stringify(T)};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinEntryPointAceMetrics",dataFields:rd.a.Rm(d)})}Ktd(d){return{["Count"]:d.Ht.length.toString(),["QueryStart"]:this.cCc(d.failure),["ErrorCode"]:xj.a[d.errorCode],["InvokeResultCode"]:d.failure?d.failure.invokeResultCode:"N/A"}}get M_g(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8393563_FlyoutTelemetryOptimizationEnabled")}get i8f(){return!!this.Ga&&
this.Ga.isChangeGateEnabled("OfficeVSO:8581842_LogAceMetricsEnabled")}cCc(d){let z="N/A";d&&d.queryStart&&window.performance.timeOrigin&&(z=(new Date(window.performance.timeOrigin+d.queryStart)).toISOString());return z}get NLk(){return this.Ga?this.Ga.isChangeGateEnabled("OfficeVSO:8546535_LogQueryStartEnabled"):!1}}Object(ha.a)(Xj,"AddinEntryPointCommon",null,[]);class el{constructor(d,z,T){this.$ja=0;this.VMe=!1;this.qGb=[];this.aSa=void 0;this.Ga=d;this.Zja=z;this.Whd=T;la.ULS.sendTraceTag(508396508,
220,50,"AddInCategoryManager Initialized")}u4a(d,z){d&&z&&this.$Lk(z)&&this.rvg()}$Lk(d){0===d.ZL&&(this.$ja|=1);1===d.ZL&&(this.$ja|=2);2===d.ZL&&(this.$ja|=4);return!!this.$ja}rvg(){const d=[];let z=null;const T={},ya=this.fpj,sb=this.NHj,cc=this.Zja.IR(0),Fc=this.Zja.IR(1),Wc=this.Zja.IR(2);(2===cc.errorCode||this.lyb&&2===Wc.errorCode)&&!sb.length?(z=this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?{ariaDescription:Object(Nb.a)("AddinPickerDisableError"),
iconName:"StoreDisabled",label:Object(Nb.a)("AddinPickerDisableError"),title:Object(Nb.a)("AddInBackstageErrorViewTitle"),linkText:Object(Nb.a)("AddinPickerDisableErrorDocumentText"),linkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",ea.AFrameworkApplication.uiCulture),onLinkClicked:()=>{la.ULS.sendTraceTag(507875924,220,15,
"User has clicked link on add-in backstage error view")}}:{ariaDescription:Object(Nb.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(Nb.a)("AddinPickerDisableError"),title:Object(Nb.a)("AddInBackstageErrorViewTitle")},d.push("storeDisabled")):3!==cc.errorCode||this.g4.MVg(cc)||3!==Fc.errorCode?4!==cc.errorCode||sb.length?!this.w1f&&(!this.iba||0!==Wc.errorCode&&5!==Wc.errorCode)||Wc.Ht.length||(la.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",
this.$ja,Wc.errorCode),d.push("emptyCategory")):(z={ariaDescription:Object(Nb.a)("AddinPickerServiceDisconnectedError"),iconName:"StoreDisabled",label:Object(Nb.a)("AddinPickerServiceDisconnectedError"),title:Object(Nb.a)("AddInBackstageErrorViewTitle")},d.push("serviceDisabled")):(z={ariaDescription:Object(Nb.a)("AddinPickerGeneralError"),iconName:"Common",label:Object(Nb.a)("AddinPickerGeneralError"),title:Object(Nb.a)("AddInBackstageErrorViewTitle")},d.push(this.g4.iIf(cc,Fc)));this.oac&&this.g4.n8f(sb.length,
cc,Fc,Wc);const id=!z;!id||ya||sb.length?(id?(T.mruAddIns=sb,ya&&(T.categories=this.f7j)):T.errorViewProps=z,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(T,id)),ya&&id&&!this.VMe&&(this.VMe=!0,la.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.$ja))):d.push("emptyPage");this.oac&&(this.g4.M_g&&la.ULS.sendTraceTag(508047441,220,15,`${d.join("|")}`),this.g4.i8f&&this.g4.m8f(sb.length,d,cc,Fc,Wc))}get w1f(){return!!(this.$ja&4)}get oac(){return!!this.Ga&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get fpj(){const d=this.Zja.IR(2);return(this.w1f||this.iba||this.oac)&&(0===d.errorCode||5===d.errorCode)&&!!d.Ht.length}get f7j(){var d=this.fJi();0<d.length&&(this.Whd=d);if(wf.c(this.Whd))return[];var z=JSON.parse(this.Whd);d=[];for(var T of z)z=Object.assign(new Ek,{title:T.title,addInDetails:[]}),this.zOh(z,T.solutionIds),0<z.addInDetails.length&&Array.add(d,z);0<this.qGb.length&&(T=this.Zja.IR(2),
la.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.qGb.length,this.qGb,T.Ht.length),this.qGb=[]);return d}get NHj(){var d=[],z=this.Zja.IR(0);Array.addRange(d,z.Ht);z=this.Zja.IR(1);Array.addRange(d,z.Ht);d.sort((T,ya)=>{T=ze.d(T.displayName);ya=ze.d(ya.displayName);return Td.a.localeCompare(T,ya)});z=[];for(const T of d)d=Object.assign(new lk,{description:T.description,displayName:T.displayName,solutionId:T.solutionId,uniqueId:this.LQb(T)}),
Array.add(z,d);return z}zOh(d,z){const T=this.OHj;let ya=0;for(const sb of z){if(4===ya)break;if(T.contains(sb))continue;z=this.Zja.TI(sb);if(!z){this.qGb.push(sb);continue}const cc=Object.assign(new lk,{description:z.description,displayName:z.displayName,solutionId:z.solutionId,uniqueId:this.LQb(z)});cc.links=[Object.assign(new Fk,{text:Object(Nb.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+z.solutionId})];Array.add(d.addInDetails,cc);++ya}}get OHj(){const d=[];
var z=this.Zja.IR(0);Array.addRange(d,z.Ht);z=this.Zja.IR(1);Array.addRange(d,z.Ht);z=new Fb.a(jc.a.zm());for(const T of d)z.add(T.solutionId);return z}LQb(d){return this.iba?String.format("{0}#{1}",d.solutionId,d.storeId):d.solutionId}get iba(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}fJi(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get lyb(){return!!this.Ga&&
this.Ga.isChangeGateEnabled("OfficeVSO:8362324_StoreDisabledErrorViewFixEnabled")}get g4(){this.aSa||(this.aSa=new Xj("Backstage",this.Ga));return this.aSa}}Object(ha.a)(el,"AddInCategoryManager",null,[]);var Ej=a(1047),mk=a(669);class Gk{constructor(d,z,T){this.amountToShowWhenCollapsed=d;this.expandButton=z;this.collapseButton=T}}Object(ha.a)(Gk,"GallerySectionCollapse",null,[]);class tj{constructor(){this.Collapse=this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(ha.a)(tj,
"GallerySectionProps",null,[]);var yj=a(1206);class nk{constructor(){this.text=this.href=null}}Object(ha.a)(nk,"LinkProps",null,[]);var Yj=a(1115),Hk=a(1250),ok=a(288),Ik=a(241);class fl{constructor(d,z,T){this.NHh="appsource";this.primaryKey="f45d712d6617b7e2b2f1fb0fc9757fa1eb384d7f03f6740a1a474b3ccf95b5d8";this.Dyk="99b3e3778ca726c8bd5b4b1b6aa137358f0902d731079ca80e28f79a25d3870a";this.Ga=d;this.OW=z;this.Koh=void 0===T?"en":T;this.Il=new Hd(this.Ga);this.sUe=this.XPh();this.mD={};this.Xlh=this.Il.uFh}xne(d,
z,T,ya,sb){ya=void 0===ya?15:ya;sb=void 0===sb?!1:sb;var cc=new ok.QueryStringBuilder("search"),Fc={"api-version":"2023-01-01-preview",gallery:"AppSourceApps",productTypes:"Office365",Market:"ALL",select:"UniqueProductId,DisplayName,LongSummary,SmallIconUri,Popularity"};Fc.applicableProducts=this.OW;Fc.supportedProducts=this.OW+"_Online";Fc.Language=this.Koh;Fc.searchQuery=d;Fc.top=ya.toString();this.v8e("AppSource",Fc);for(const id in Fc)cc.fq(id,Fc[id]);cc="https://catalogapi.azure.com/"+cc.toString();
Fc={};Fc["X-API-Key"]=sb?this.Dyk:this.primaryKey;Fc["X-ms-app"]=this.NHh;const Wc=window.performance.now();this.executeRequest(cc,1,Fc,id=>{let Dd="Query Succeeded",ee=!0,re=0;const Ce=[],mf=[];id=id.data.responseData;try{var tf=JSON.parse(id);re=tf.totalCount;const Df=tf.results;for(tf=0;tf<Df.length;tf++){const sf=Df[tf],$f={};$f.solutionId=sf.uniqueProductId.toLowerCase();$f.displayName=sf.displayName;$f.description=sf.longSummary;$f.iconUrl=sf.smallIconUri;$f.assetId=$f.solutionId;$f.storeId=
"en-US";$f.storeType="omex";$f.assetStoreId="omex";Ce.push($f);this.mD[$f.solutionId]=$f;mf.push(sf.popularity)}}catch(Df){Dd="Exception thrown from Json parse for responseData: "+id+". Exception: "+Df,ee=!1}this.jMc(0<d.length,T,"AppSource",ee,Dd,window.performance.now()-Wc,re,Ce,mf);z(ee,Ce)},id=>{const Dd=[];this.jMc(0<d.length,T,"AppSource",!1,`Query Failed, httpStatus: ${id.data.httpStatus}, responseData: ${id.data.responseData}`,window.performance.now()-Wc,0,Dd);sb||id.data.httpStatus!==Ik.a.Qye?
z(!1,Dd):this.xne(d,z,T,ya,!0)})}zMg(d,z){z=void 0===z?15:z;return new Promise((T,ya)=>{this.xne(d,(sb,cc)=>{sb?T(cc):ya()},Date.now(),z)})}yne(d,z,T,ya,sb){ya=void 0===ya?"":ya;sb=void 0===sb?15:sb;const cc=new ok.QueryStringBuilder("api/addins/search"),Fc={apiversion:"1.0"};0<d.length&&(Fc.qu=d);0<ya.length&&(Fc.assetids=ya);Fc.client="WAC_"+this.OW;Fc.cv=ea.AFrameworkApplication.buildVersion;Fc.top=sb.toString();this.v8e("OMEX",Fc);for(const id in Fc)cc.fq(id,Fc[id]);ya="https://api.addins.omex.office.net/"+
cc.toString();const Wc=window.performance.now();this.executeRequest(ya,1,null,id=>{let Dd="Query Succeeded",ee=!0,re=0;const Ce=[];id=id.data.responseData;try{var mf=JSON.parse(id);re=mf.TotalCount;const tf=mf.Values;for(mf=0;mf<tf.length;mf++){const Df=tf[mf],sf={};sf.solutionId=Df.Id.toLowerCase();sf.displayName=Df.Title;sf.description=Df.ShortDescription;sf.iconUrl=Df.IconUrl;sf.assetId=sf.solutionId;sf.storeId="en-US";sf.storeType="omex";sf.assetStoreId="omex";sf.version=Df.Version;sf.targetType=
Df.Shape-1;sf.height=Df.Height;sf.width=Df.Width;Ce.push(sf);this.mD[sf.solutionId]=sf}}catch(tf){Dd="Exception thrown from Json parse for responseData: "+id+". Exception: "+tf,ee=!1}this.jMc(0<d.length,T,"OMEX",ee,Dd,window.performance.now()-Wc,re,Ce);z(ee,Ce)},id=>{const Dd=[];this.jMc(0<d.length,T,"OMEX",!1,`Query Failed, httpStatus: ${id.data.httpStatus}, responseData: ${id.data.responseData}`,window.performance.now()-Wc,0,Dd);z(!1,Dd)})}AMg(d,z,T){z=void 0===z?"":z;T=void 0===T?15:T;return new Promise((ya,
sb)=>{this.yne(d,(cc,Fc)=>{cc?ya(Fc):sb()},Date.now(),z,T)})}TI(d){return this.mD[d.toLowerCase()]?this.mD[d.toLowerCase()]:null}executeRequest(d,z,T,ya,sb){return ea.AFrameworkApplication.rj.ov(d,z,null,void 0===T?null:T,!1,2,ya,sb,null,null,!1,null,this.Xlh)}jMc(d,z,T,ya,sb,cc,Fc,Wc,id){d={["hasSearchValue"]:null===d||void 0===d?void 0:d.toString(),["searchStartTime"]:null===z||void 0===z?void 0:z.toString(),["apiSource"]:T,["responseSuccess"]:null===ya||void 0===ya?void 0:ya.toString(),["responseInfo"]:sb,
["timeElapsed"]:null===cc||void 0===cc?void 0:cc.toString(),["totalCount"]:null===Fc||void 0===Fc?void 0:Fc.toString(),["solutionIds"]:Wc.map(Dd=>this.e2h(Dd)),["popularity"]:id?id:[]};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SearchApiMetrics",dataFields:rd.a.Rm(d)})}e2h(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}XPh(){let d=this.Il.I3j;if(1>=d.length)return{};la.ULS.sendTraceTag(507785891,220,50,"BuildSearchQueryParametersOverrides: overrideString: {0}.",
d);const z={};let T=!0,ya="";d=d.trim();try{const sb=d.split("$");for(let cc=0;cc<sb.length&&T;cc++){const Fc=sb[cc].split(":");if(2!==Fc.length){ya="Invalid override string format: "+sb[cc];T=!1;break}const Wc=Fc[0].trim(),id=[],Dd=Fc[1].split("|");for(let ee=0;ee<Dd.length&&T;ee++){const re=Dd[ee],Ce=re.split("\\");if(2<Ce.length){ya="Invalid override string format: "+re;T=!1;break}const mf=Ce[0].trim(),tf=2===Ce.length?Ce[1].trim():null;Array.add(id,new Qh.a(mf,tf))}z[Wc]=id}}catch(sb){ya="Failed in parsing the overrideString: "+
d+". Exception: "+sb.toString(),T=!1}if(T)return z;la.ULS.sendTraceTag(507785890,220,10,"Build override failed: {0}.",ya);return{}}v8e(d,z){if(this.sUe[d]){d=this.sUe[d];for(let T=0;T<d.length;T++){const ya=d[T].key,sb=d[T].value;sb?z[ya]=sb:delete z[ya]}}}}Object(ha.a)(fl,"AddinSearchApiManager",null,[]);var Jk=a(406);class pk{constructor(){this.Ep=d=>{var z;if(null===d||null===d.La)return!1;d=d.La.target;for(this.xHd=void 0;null!=d&&d.getAttribute;){void 0===this.xHd&&0<(null===(z=d.id)||void 0===
z?void 0:z.length)&&(this.xHd=d.id);if(null!=d.getAttribute("data-contextmenu-id"))break;d=d.parentNode}return!1}}get currentTarget(){return this.xHd}sxj(){Jk.a.instance.xa(window.document.body,this.Ep,null)}dispose(){Jk.a.instance.Qa(window.document.body,this.Ep)}}Object(ha.a)(pk,"AppFlyoutGeneratorContextMenuListener",null,[]);const xl={["WF"]:"wa200001011 wa104382081 wa200000368 wa104380122 wa200000199 wa104381727 wa200005983 wa200001361 wa200000011 wa200005106 wa200005817 wa200004216".split(" "),
["IPWAI"]:"wa200005502 wa200001011 wa200000368 wa200005107 wa200005287 wa104381714 wa200005444 wa200005826 wa200006000 wa200005313 wa200001361 wa200006001 wa200005312".split(" "),["ER"]:"wa200004257 wa104381909 wa104380917 wa200002334 wa200001482 wa200002534 wa200002891 wa104380848".split(" "),["APID"]:"wa200000113 wa104380121 wa104051163 wa104379279 wa104380118 wa104178141 wa200002281 wa104379370 wa104379997 wa104381063 wa104381411".split(" ")},gl={["IPWAI"]:"wa200005502 wa200005271 wa200004935 wa200001584 wa200005281 wa200005107 wa200005333".split(" "),
["DA"]:"wa200003784 wa200000169 wa200000018 wa104381841 wa104380711 wa104381807 wa200002503".split(" "),["APIC"]:"wa102957665 wa200004179 wa104051163 wa104380194 wa200004688 wa200004687 wa104221182 wa200003220 wa104379169 wa103147117".split(" ")},Kk={["IPWAI"]:["wa200003964","wa200005107","wa200005669","wa200006067"],["APIC"]:"wa104221182 wa104178141 wa104381909 wa200000113 wa104381155 wa104380907 wa104380121 wa104379997 wa104381063 wa104379370 wa104380902 wa104381411 wa200003220 wa200003891 wa104380848 wa104381637 wa200001766".split(" "),
["CAIP"]:"wa104379261 wa200001661 wa200002908 wa200000094 wa104218073 wa104381682 wa104382064 wa200004643 wa200004709 wa200003676 wa200001313 wa200003706 wa104381448 wa104380667".split(" ")},qk={["IPWAI"]:"wa200005502 wa200001011 wa200000368 wa200005107 wa200005287 wa104381714 wa200005444 wa200005826 wa200006000 wa200001361 wa200005313 wa200005312 wa200006001".split(" "),["WF"]:"wa200001011 wa104382081 wa200000368 wa104380122 wa200000199 wa200005983 wa104381727 wa200001361 wa200000011 wa200005106 wa200005817 wa200004216".split(" "),
["ER"]:"wa200004257 wa104381909 wa104380917 wa200002334 wa200001482 wa200002534 wa200002891 wa104380848".split(" "),["APID"]:"wa200000113 wa104380121 wa104051163 wa104379279 wa200002281 wa104178141 wa104380118 wa104379370 wa104379997 wa104381063 wa104381411 wa200001486".split(" ")},hl={["IPWAI"]:"wa200005502 wa200005271 wa200004935 wa200001584 wa200005669 wa200005281 wa200006009 wa200006007 wa200005333".split(" "),["APIC"]:"wa102957665 wa200004179 wa104051163 wa200000113 wa104380194 wa200004688 wa200004687 wa104221182 wa200003220 wa104379169 wa103147117".split(" "),
["DA"]:"wa200000169 wa200000018 wa200003784 wa104381841 wa200000025 wa200002503 wa104381807 wa104380711 wa200004632 wa200005782 wa200005817 wa200005777 wa200005960 wa200006017 wa200006008".split(" "),["FA"]:"wa104379220 wa200002311 wa104381695 wa200003692 wa104381859 wa104381717 wa104380978".split(" ")},il={["IPWAI"]:["wa200003964","wa200005669","wa200005107","wa200006000","wa200006067"],["APIC"]:"wa104221182 wa104178141 wa104381909 wa104380907 wa200000113 wa104380121 wa104381155 wa104379997 wa104381063 wa104379370 wa104380902 wa104381411 wa200003220 wa200003891 wa104380848 wa104381637 wa200001766".split(" "),
["CAIP"]:"wa104379261 wa200001661 wa200000094 wa200002908 wa104381682 wa104218073 wa104382064 wa200004709 wa200004643 wa200003676 wa200001313 wa200003706 wa104381448 wa104380667".split(" "),["DWT"]:"wa200001625 wa104380602 wa104380526 wa200002334 wa104380050 wa200003052 wa200006046 wa200003157 wa104380955 wa104380278 wa200001396 wa200001409".split(" ")};class jl{constructor(d,z,T){this.Il=d;this.CQ=z;this.i9={};this.kBb={};this.rhd={};if(d.qQb||d.Hea){this.i9=T;this.OIh();this.zIh();d=this.Il.H3j;
try{const ya=d.split("|");d={};for(z=0;z<ya.length;z+=2)d[ya[z]]=ya[z+1];this.rhd=d}catch(ya){}}}OIh(){const d={};var z=this.Il.F3j;if(!(1>=z.length)){la.ULS.sendTraceTag(507589127,220,50,"BuildCategoryAddinDetailOverrides: overrideString: {0}.",z);var T=!0,ya="";z=z.trim();try{const sb=z.split("$");for(let cc=0;cc<sb.length&&T;cc++){const Fc=sb[cc].split(":");if(2<Fc.length){ya="Invalid override string format: "+sb[cc];T=!1;break}const Wc=Fc[0].trim(),id=[];if(2===Fc.length){const Dd=Fc[1].split("|");
for(let ee=0;ee<Dd.length&&T;ee++){const re=Dd[ee],Ce=re.split("\\");if(2>Ce.length||5<Ce.length){ya="Invalid override string format: "+re;T=!1;break}const mf=Ce[0].trim(),tf={};for(let Df=1;Df<Ce.length&&T;Df++)if(0<Ce[Df].trim().length)switch(Df){case 1:tf.priority=parseInt(Ce[Df].trim());break;case 2:tf.AUP=parseInt(Ce[Df].trim());break;case 3:tf.diffAUP=parseInt(Ce[Df].trim());break;case 4:const sf=Ce[Df].trim();if(8!==sf.length){ya="Invalid override string format: "+sf;T=!1;break}tf.releaseDate=
(new Date(parseInt(sf.substring(0,4)),parseInt(sf.substring(4,6))-1,parseInt(sf.substring(6)))).getTime();break;default:ya="Invalid override string format: "+re,T=!1}if(!T)break;Array.add(id,{solutionId:mf,addinInfo:tf})}}this.i9[Wc]&&(d[Wc]=id)}}catch(sb){ya="Failed in parsing the overrideString: "+z+". Exception: "+sb.toString(),T=!1}if(T){for(const sb in d){if(!this.i9[sb])continue;const cc=d[sb];z=this.i9[sb].filter(Fc=>!cc.some(Wc=>Wc.solutionId.toLowerCase()===Fc.solutionId.toLowerCase()));
Array.addRange(cc,z)}this.i9=d}else la.ULS.sendTraceTag(507589126,220,10,"Override Failed: {0}.",ya)}}zIh(){for(const d in this.i9){const z=this.i9[d];for(let T=0;T<z.length;T++){const ya=z[T];ya.addinInfo||(ya.addinInfo={});if(!ya.addinInfo.priority||isNaN(ya.addinInfo.priority))ya.addinInfo.priority=0;if(!ya.addinInfo.AUP||isNaN(ya.addinInfo.AUP))ya.addinInfo.AUP=0;if(!ya.addinInfo.diffAUP||isNaN(ya.addinInfo.diffAUP))ya.addinInfo.diffAUP=0;if(!ya.addinInfo.releaseDate||isNaN(ya.addinInfo.releaseDate))ya.addinInfo.releaseDate=
0}}}GGi(){if(!this.i9||0===Object.keys(this.i9).length)return la.ULS.sendTraceTag(507589125,220,15,"The category add-in ids mapping is empty."),{};if(Object.keys(this.kBb).length!==Object.keys(this.i9).length){const z=[],T={};for(const ya in this.i9){if("PAIYO"===ya){var d=this.CQ.IR(1);0===d.errorCode&&(d=d.Ht)&&0<d.length&&(T[ya]=d);continue}if(this.kBb[ya]){T[ya]=this.kBb[ya];continue}d=this.i9[ya];if(!d||0===d.length){la.ULS.sendTraceTag(507589124,220,15,"The addin content list is empty for category: {0}.",
ya);continue}const sb=[];for(let cc=0;cc<d.length;cc++){const Fc=d[cc],Wc=this.CQ.TI(Fc.solutionId);if(!Fc.addinInfo||-1===Fc.addinInfo.priority||!Wc||-1===Wc.addinInfo.priority)continue;if(!Wc){Array.add(z,Fc.solutionId);continue}const id={};id.solutionId=Wc.solutionId;id.version=Wc.version;id.storeType=Wc.storeType;id.storeId=Wc.storeId;id.assetId=Wc.assetId;id.assetStoreId=Wc.assetStoreId;id.displayName=Wc.displayName;id.provider=Wc.provider;id.description=Wc.description;id.targetType=Wc.targetType;
id.height=Wc.height;id.width=Wc.width;id.iconUrl=Wc.iconUrl;id.webApplicationId=Wc.webApplicationId;id.highResolutionIconUrl=Wc.highResolutionIconUrl;id.addinInfo=Fc.addinInfo;Array.add(sb,id)}0<sb.length&&("WN"===ya?sb.sort((cc,Fc)=>cc.addinInfo.releaseDate<Fc.addinInfo.releaseDate?1:-1):"TD"===ya?sb.sort((cc,Fc)=>cc.addinInfo.diffAUP<Fc.addinInfo.diffAUP?1:-1):sb.sort((cc,Fc)=>cc.addinInfo.AUP<Fc.addinInfo.AUP?1:-1),T[ya]=sb)}this.kBb=T;0<z.length&&la.ULS.sendTraceTag(507589123,220,10,"{0} AddinIds not found in mapping: {1}, collection length: {2}",
z.length,z.toString())}return this.kBb}PDg(d,z,T){return T&&0<T.length&&"PAIYO"!==d?T.filter(ya=>!z.some(sb=>sb.toLowerCase()===ya.solutionId.toLowerCase())):T}HXi(){var d,z,T;const ya={},sb=this.Il.host;if("Word"===sb)for(const cc in qk)ya[cc]=(null===(d=qk[cc])||void 0===d?void 0:d.map(Fc=>this.CQ.TI(Fc)).filter(Fc=>!!Fc))||[];else if("Excel"===sb)for(const cc in hl)ya[cc]=(null===(z=hl[cc])||void 0===z?void 0:z.map(Fc=>this.CQ.TI(Fc)).filter(Fc=>!!Fc))||[];else if("PowerPoint"===sb)for(const cc in il)ya[cc]=
(null===(T=il[cc])||void 0===T?void 0:T.map(Fc=>this.CQ.TI(Fc)).filter(Fc=>!!Fc))||[];return ya}lIi(d){let z=null;var T=this.GGi();if(T&&0<Object.keys(T).length){z={};for(const sb in T){const cc=T[sb];z[sb]=this.PDg(sb,d.map(Fc=>Fc.solutionId),cc)}const ya=[];for(const sb in z)if((d=z[sb])&&0<d.length){d=d.filter(cc=>!ya.some(Fc=>Fc.toLowerCase()===cc.solutionId.toLowerCase()));for(T=0;T<d.length&&3>T;T++)ya.push(d[T].solutionId);z[sb]=d}}else la.ULS.sendTraceTag(507589122,220,15,"Category addins details dict is empty");
return z}SAc(){const d=this.Il.host,z=this.Il.G3j;return z?z.split("|"):"Word"===d?["IPWAI","APID","WF"]:"Excel"===d?["IPWAI","APIC","DA"]:"PowerPoint"===d?["IPWAI","APIC","CAIP"]:[]}TAc(d,z){var T,ya,sb,cc=this.Il.host;if("Word"===cc)cc=(null===(T=xl[d])||void 0===T?void 0:T.map(Fc=>this.CQ.TI(Fc)))||[];else if("Excel"===cc)cc=(null===(ya=gl[d])||void 0===ya?void 0:ya.map(Fc=>this.CQ.TI(Fc)))||[];else if("PowerPoint"===cc)cc=(null===(sb=Kk[d])||void 0===sb?void 0:sb.map(Fc=>this.CQ.TI(Fc)))||[];
else return[];return z?this.PDg(d,z,cc):cc}MGi(d){if(this.rhd[d])return this.rhd[d];switch(d){case "APIC":return"Insert Graphics";case "APID":return"Insert Graphics";case "BBM":return"Microsoft";case "CAIP":return"Interactive tools";case "DA":return"Data analytics";case "DWT":return"Templates";case "ER":return"Education";case "FA":return"Finance";case "IPWAI":return"AI";case "PAIYO":return"Org";case "TD":return"Trending";case "WF":return"Writing Fluently";case "WN":return"New"}return"Popular"}Zzc(d){return V()[d]||
V().default}}Object(ha.a)(jl,"AppFlyoutCategories",null,[]);var Yh;(function(d){d.LEFT="LEFT";d.Wja="MIDDLE";d.RIGHT="RIGHT"})(Yh||(Yh={}));Object(ha.b)("FRECarouselDirection",Yh);class Lk{constructor(d,z){this.categories=d;this.P5b=z;this.bSa=0}V_j(d){var z,T;let ya=!1;try{if(null===d||void 0===d?0:d.includes("FRECarouselSwitchIcon_")){let sb=this.bSa;const cc=d.split("_");if(3===cc.length){const Fc=cc[1],Wc=parseInt(cc[2],10);if(Fc===Yh.Wja)return;Fc===Yh.LEFT?(sb--,0>sb&&(sb=Wc-1)):(sb++,sb>=Wc&&
(sb=0));this.bSa=sb;ya=!0}}if(ya){Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchFREBanner",dataFields:rd.a.NOa({["controlId"]:d,["currentIndex"]:null===(z=this.bSa)||void 0===z?void 0:z.toString()})});try{this.FFb="banner",null===(T=this.P5b)||void 0===T?void 0:T.call(this)}finally{this.FFb=void 0}}else la.ULS.sendTraceTag(507527308,220,10,`Bad fre banner switch. SourceControlId=${d}`)}catch(sb){la.ULS.sendTraceTag(507527307,220,10,`Bad fre banner switch. SourceControlId=${d}; error=${null===
sb||void 0===sb?void 0:sb.toString()}`)}}W_j(){var d;this.eta=this.categories.SAc()[this.bSa];try{this.FFb="content",null===(d=this.P5b)||void 0===d?void 0:d.call(this)}finally{this.FFb=void 0}Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchFREContent",dataFields:rd.a.NOa({["category"]:this.eta})})}nXh(d){d.MenuSectionList.some(z=>z.ControlList.some(T=>"AddInFlyoutFREBanner"===T.Id))||w("AddInFlyoutFREBanner",!1,-1)}npk(d){var z;const T=this.categories.SAc(),ya=T[this.bSa];
d.MenuSectionList.unshift(y(ya,T.length,this.bSa));w("AddInFlyoutFREBanner",!0,1);d={["currentIndex"]:null===(z=this.bSa)||void 0===z?void 0:z.toString(),["category"]:ya};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowFREBanner",dataFields:rd.a.Rm(d)})}qSi(d,z){if(!this.eta)return d;const T=this.categories.TAc(this.eta,z).map(ya=>ya.solutionId);return d.filter(ya=>!T.includes(ya.solutionId))}LGi(d){return this.eta?this.categories.TAc(this.eta,d):[]}Zzc(){return this.eta?this.categories.Zzc(this.eta):
""}I9j(){this.FFb||(this.eta=void 0)}C8j(){"content"===this.FFb&&setTimeout(()=>{const d=document.querySelector('[id^="FRECategoryAddin"]');if(d){d.scrollIntoView({behavior:"smooth",block:"center"});const z=d.parentElement.parentElement.parentElement.parentElement;z.classList.remove("addin-flyout-highlighted");z.classList.add("addin-flyout-highlight");setTimeout(()=>{z.classList.add("addin-flyout-highlighted")},1E3)}},10)}get mAi(){var d;return null===(d=this.eta)||void 0===d?void 0:d.toString()}}
Object(ha.a)(Lk,"FRECarousel",null,[]);var yl=a(650);class Mk{constructor(d,z){this.Vth=d;this.Wth=z;this.Il=new Hd(ea.AFrameworkApplication.fa)}O1d(){null==aa.a.instance.getItem("AddinEntryPointSurveyShowed")&&(this.zrh=window.setTimeout(()=>{this.qZe=Object(yl.a)();null!=this.qZe&&this.qZe.execute(d=>{if(null==aa.a.instance.getItem("AddinEntryPointSurveyShowed")){var z=this.$Ac();this.kFi()||z&&(!z||"hidden"!==z.visibility)||(d.I8a(this.Vth,null),aa.a.instance.setItem("AddinEntryPointSurveyShowed",
"1"))}})},this.Wth))}WOa(){window.clearTimeout(this.zrh)}$Ac(){let d=null;try{const z=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");z&&(d=ge.a.CE(z.parentNode.parentNode.parentNode))}catch(z){la.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(z?z.toString():""))}return d}kFi(){let d=null;try{d=document.getElementById("BackstageGetAddIns")}catch(z){la.ULS.sendTraceTag(508343956,220,10,"Backstage get parent and parent get exception "+(z?z.toString():
""))}return d}}Object(ha.a)(Mk,"FpsHelper",null,[]);class kl extends sj.a{constructor(d,z,T,ya,sb,cc,Fc,Wc,id){super(!1,!1,!0);this.Ph=5;this.initializeAndShow("",()=>{this.hide()},{["id"]:"AddInStoreDialog",["bodyControls"]:{},["dataProvider"]:{["getAddinDetails"]:Dd=>{Dd=d.IR(Dd);const ee=Dd.Ht&&Dd.Ht instanceof Array?Dd.Ht.filter(re=>re.addinInfo&&-1!==re.addinInfo.priority):[];ee.sort((re,Ce)=>Ce.addinInfo.AUP-re.addinInfo.AUP);return{["errorCode"]:Dd.errorCode,["addinDetails"]:ee,["failure"]:Dd.failure}},
["getAddinDetailById"]:d.TI.bind(d)},["host"]:z,["getCommonString"]:Nb.a,["hide"]:this.hide.bind(this),["appsFlyoutGeneratorContext"]:{["host"]:T.host,["addinFlyoutSearchDebouncingDelay"]:T.q5e,["addinFlyoutSearchRecommendedKeyword"]:T.r5e,["flyoutStoreExpEnabled"]:T.qQb,["flyoutStoreExpUseLabelsEnabled"]:T.Fyi,["flyoutStoreExpSearchWithAppSourceEnabled"]:T.Dyi,["flyoutStoreExpUXRenderCheckerEnabled"]:T.Eyi,["flyoutStoreExpRetryIfNotReady"]:T.Cyi},["addinSearchApiManager"]:{["searchFromAppSource"]:ya.xne.bind(ya),
["searchFromAppSourceAsync"]:ya.zMg.bind(ya),["searchFromOMEX"]:ya.yne.bind(ya),["searchFromOMEXAsync"]:ya.AMg.bind(ya),["getAddinDetailById"]:ya.TI.bind(ya)},["addinCommandsHandlerForStoreExp"]:{["handleInstallPopularAddInAndLaunchIt"]:sb.FQd.bind(sb),["handleInstallSearchAddInAndLaunchIt"]:sb.p3i.bind(sb),["handleLaunchAddInInstallDialog"]:sb.fTb.bind(sb),["handleLaunchAppForOfficeDialog"]:sb.x3i.bind(sb)},["appFlyoutCategories"]:{["getContentExpCategoryAddinsRecord"]:cc.lIi.bind(cc),["getStoreExpCategoryAddinsRecord"]:cc.HXi.bind(cc),
["getCategoryTitle"]:cc.Zzc.bind(cc)},["telemetryForStoreExp"]:{["sendULSInfoTraceTag"]:Fc.JAk.bind(Fc),["sendULSWarningTraceTag"]:Fc.KAk.bind(Fc),["sendULSErrorTraceTag"]:Fc.IAk.bind(Fc),["sendOtelTelemetry"]:Fc.hAk.bind(Fc),["getPrivacyCompliantId"]:Fc.Ega.bind(Fc)},["onDialogOpen"]:Wc,["onDialogClose"]:id})}}Object(ha.a)(kl,"AddInStoreDialog",sj.a,[]);class Nk{constructor(){}JAk(d){la.ULS.sendTraceTag(507343232,220,50,d)}KAk(d){la.ULS.sendTraceTag(507343203,220,15,d)}IAk(d){la.ULS.sendTraceTag(507343202,
220,10,d)}hAk(d,z){Ic.a.sendTelemetryEvent({name:d,dataFields:rd.a.Rm(z)})}Ega(d){return Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,d.storeType,d.assetId,null,null,d.storeId)}}Object(ha.a)(Nk,"TelemetryForStoreExp",null,[]);class Ok{constructor(d,z,T,ya,sb,cc,Fc,Wc,id,Dd,ee){Wc=void 0===Wc?{}:Wc;this.P5b=Dd;this.qbd={};this.Jfc={};this.zMe=0;this.SCb=null;this.FAb={};this.aSa=void 0;this.tJe=this.IZe=this.NGe=this.mab=null;this.bZe=0;this.rdb="All";this.Ved=[];this.pdb="";this.ujc=
null;this.tXe=100;this.xjc=!1;this.VFb=[];this.u4a=(re,Ce)=>{this.iba?this.gik(Ce):(this.fik(Ce),!this.Il.oac&&this.KGe&&this.KGe.u4a(re,Ce))};this.CQ=z;this.Xsa=null;this.Qoh=ya;this.ssh=sb;this.KGe=void 0===Fc?null:Fc;this.Ga=(void 0===cc?null:cc)||ea.AFrameworkApplication.fa;this.Il=new Hd(this.Ga);this.RNe=id;this.uSa=new jl(this.Il,z,Wc);this.CQ.OAa(this.u4a);(null===appChrome||void 0===appChrome?0:appChrome.addInApi)&&appChrome.addInApi.loadOfficeAddInIcons();this.Il.tFh&&f((re,Ce)=>{Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutOpenCloseChanged",
dataFields:rd.a.NOa({["PerformanceNow"]:performance.now(),["DateNow"]:new Date,["IsOpened"]:re,["OpenDuration"]:Ce})})}).catch(re=>{la.ULS.sendTraceTag(507799683,220,15,"Failed to listen flyout open close event: "+((null===re||void 0===re?void 0:re.toString())||void 0))});if(this.Il.h4||this.Il.NWh||this.Il.qQb)this.mab=new fl(this.Ga,this.Ga.Ya("Application")),this.tXe=this.Il.q5e;this.Il.qQb&&(this.NGe=ee,this.IZe=new Nk);this.Il.m5e&&(this.tJe=new pk,this.tJe.sxj());this.Il.Hea&&(this.Cka=new Lk(this.uSa,
Dd));this.Il.h4&&this.aEk();this.Il.rFh&&U();this.Il.bId&&(this.SCb=new Mk("AddinBackstageFeedbackSurvey",this.Il.Iyi))}get a2h(){return this.Jfc}get Foj(){const d=document.querySelector('[data-unique-id="Overflow-InsertAddInFlyout"]');return d?"hidden"!==window.getComputedStyle(d).visibility:!1}fik(d){if(d.Ht)for(let z=0;z<d.Ht.length;z++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+d.Ht[z].solutionId,d.Ht[z].iconUrl);else 0===d.errorCode&&la.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get iba(){return!!this.Ga&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}UMd(d){const z=this.Il.P6b,T=z?"more"===d?"AddinFlyoutMoreButton":"AddinFlyoutLessButton":"AddinFlyoutMoreButton",ya=z?"more"===d?Object(Nb.a)("AddinsFlyoutSeeAllButtonText"):Object(Nb.a)("AddinsFlyoutSeeLessButtonText"):Object(Nb.a)("AddinsFlyoutSeeAllButtonText");d=z?"more"===d?Object(Nb.a)("AddinsPickerGalleryButtonMoreArialText"):Object(Nb.a)("AddinsPickerGalleryButtonLessArialText"):Object(Nb.a)("AddinsPickerGalleryButtonMoreArialText");
return Object.assign(new yj.a,{Id:T,ExternalId:T,Icon:"AllApps_16",Command:this.ssh,LabelText:ya,FullIconStyle:{root:{maxWidth:"16px",maxHeight:"16px",minWidth:"16px",minHeight:"16px",border:"1px solid var(--border-color, #c8c8c8)",borderRadius:"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:d})}IPi(d,z){var T=void 0===T?ea.AFrameworkApplication.isRtl:T;T={["root"]:{["width"]:"32px",["height"]:"32px",["border-radius"]:"6px",["overflow"]:"hidden",["padding"]:"7px",["border"]:"1px solid var(--border-color, #c8c8c8)",
["direction"]:T?"ltr":void 0}};return Object.assign(new yj.a,{Id:z,ExternalId:z,Icon:"AddinFlyoutControl"+d.solutionId,Command:this.Qoh,LabelText:d.displayName,Role:"menuitem",FullIconStyle:T,Alt:d.description})}RIf(d,z){d=this.QIf("MRUAddinsGalleryControl",d,z);return Object.assign(new N.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[d],Title:Object(Nb.a)("MyAddinSection")})}QIf(d,z,T,ya){ya=void 0===ya?this.Il.P6b:ya;const sb=x(tj,{SectionId:d+"Section",GalleryButtons:z.map(cc=>
this.IPi(cc,this.QMi(cc)))});ya&&3<z.length?sb.Collapse=new Gk(2,this.UMd("more"),this.UMd("less")):T&&sb.GalleryButtons.push(this.UMd("more"));return x(mk.a,{Id:d,ExternalId:d,GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",marginLeft:"12px",width:"100%",maxWidth:"unset"},["inner"]:{margin:"-4px",marginLeft:"0px",maxWidth:"333px",minWidth:"333px"}},["galleryButtonInExpanded"]:{["root"]:{width:100,height:100,backgroundColor:"transparent"},["flexContainer"]:{flexDirection:"column"},["label"]:{marginTop:"4px",
maxWidth:"86px",fontSize:"12px",textOverflow:"ellipsis"}}},Width:3,Type:4,GallerySections:[sb],GalleryContextMenu:this.Il&&this.Il.m5e?{["primaryMenuId"]:"AddInFlyoutMRUContextMenu"}:null})}TPi(){const d=x(N.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[x(Ak.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:Object(Nb.a)("AddinsPickerFooterButtonMoreArialText")})]});appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",Object(Nb.a)("AddinPickerButtonMore")));
return d}get fCf(){var d;return null===(d=this.Cka)||void 0===d?void 0:d.mAi}get LMg(){return this.rdb}IGi(){this.rdb="All";r(`${"AddinFREButton"}${this.rdb}`);var d=["All",...this.uSa.SAc()];d=x(tj,{SectionId:"AddinFlyoutButtonGroupSection",GalleryButtons:d.map(z=>{const T=this.uSa.MGi(z);return Object.assign(new yj.a,{Id:"AddinFREButton"+z,ExternalId:"AddinFREButton"+z,Command:cg.a.o$b.toString(),LabelText:T,FullIconStyle:{["root"]:{position:"absolute",["border-radius"]:"10px",width:"100%",height:"100%"}},
Role:"tab",Alt:T})})});d=x(mk.a,{Id:"AddinFlyoutButtonGroup",ExternalId:"AddinFlyoutButtonGroup",GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",width:"100%",maxWidth:"unset"},["inner"]:{Hml:2,maxWidth:"333px",minWidth:"333px",flexFlow:"nowrap",paddingLeft:15}},["galleryButtonInExpanded"]:{["root"]:{backgroundColor:"transparent",width:"unset",height:"unset",borderRadius:"10px",borderColor:"var(--border-color)",borderWidth:"1px !important",padding:"4px 8px"},["flexContainer"]:{},["label"]:{fontSize:"12px",
textOverflow:"ellipsis"}}},Type:4,GallerySections:[d],DismissHostingSurfaceOnExecute:!1});return x(N.a,{ControlList:[d]})}tXk(d){var z;if(this.rdb!==d){var T=appChrome.selectors.getFlyoutAnchorMenuItems("InsertAddInFlyout");"All"===this.rdb&&(this.Ved=Object.entries(T).filter(Wc=>{var [id,Dd]=Wc;return"MultiActionButtonModel"===Dd&&id.startsWith("AddInsListItem")}).map(Wc=>{[Wc]=Wc;return Wc}));this.rdb=d;r(`${"AddinFREButton"}${d}`);var ya=-1!==Object.keys(T).indexOf("SearchAddinInFlyout")||this.Il.h4?
appChrome.api.menuSection(["SearchAddinInFlyout"],""):void 0,sb=appChrome.api.menuSection(["InsertMoreAddInsFromFooter"],""),cc="All"===d?this.Ved:null!==(z=this.uSa.TAc(d).map(Wc=>`AddInsListItem${Wc.solutionId.toLowerCase()}`))&&void 0!==z?z:[],Fc=new Set(cc);z=this.Ved.filter(Wc=>Fc.has(Wc));z=[appChrome.api.menuSection(["AddinFlyoutButtonGroup",...z],"")];this.Il.Hea&&(cc=Object.keys(T).filter(Wc=>0<=Wc.indexOf("FRECarousel")||0<=Wc.indexOf("FREBanner")),0<(null===cc||void 0===cc?void 0:cc.length)&&
z.unshift(appChrome.api.menuSection(cc,"")));"MRUAddinsGalleryControl"in T&&z.unshift(appChrome.api.menuSection(["MRUAddinsGalleryControl"],Object(Nb.a)("MyAddinSection")));T=appChrome.actions.updateMenu("InsertAddInFlyout",z,void 0,void 0,void 0,void 0,void 0,sb,!0,ya);appChrome.api.dispatch(T);Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",dataFields:rd.a.NOa({["Category"]:d})})}}G2i(d){this.Cka.V_j(d)}H2i(){this.Cka.W_j()}WPi(d,z){var T,ya,sb;const cc=[],Fc=
[],Wc=this.CQ.IR(0);Array.addRange(Fc,Wc.Ht);const id=this.CQ.IR(1);Array.addRange(Fc,id.Ht);d||Fc.sort((pg,hg)=>{pg=ze.d(pg.displayName);hg=ze.d(hg.displayName);return Td.a.localeCompare(pg,hg)});null===(T=this.RNe)||void 0===T?void 0:T.addNotification(Fc);this.C$j(Fc);let Dd=Fc.length,ee=!1;!this.Il.P6b&&3<Dd&&(Dd=2,ee=!0);let re=[];T=null;this.Il.lyb||this.iba||!this.Xsa?(T=this.CQ.IR(2),0!==T.errorCode&&5!==T.errorCode||T.Ht.forEach(pg=>{-1!==pg.addinInfo.priority&&re.push(pg)})):re=this.Xsa;
la.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",Dd,xj.a[Wc.errorCode],Wc.Ht.length,xj.a[id.errorCode],id.Ht.length,this.Il.lyb?xj.a[T.errorCode]:"undefined",re.length);this.g4.n8f(Dd,Wc,id,T);this.Il.bId&&this.SCb&&this.SCb.O1d();const Ce=[],mf=[];d&&(Array.addRange(Ce,this.Nvi(this.pdb,Fc)),Array.addRange(mf,this.y8e(this.VFb,Fc)));const tf=Object.assign(new N.a,{Id:"HeaderSection",ControlsId:"HeaderSection.Controls",
ControlList:[]}),Df=Object.assign(new Bk.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuHeaderSection:this.Il.h4?tf:void 0,MenuFooterSection:this.TPi(),UpdateDynamically:!0,IsFlexLayout:!0});if((2===Wc.errorCode||this.Il.lyb&&2===T.errorCode)&&!Fc.length){cc.push("storeDisabled");la.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit");var sf=this.tzc({iconName:"StoreDisabled",MEc:Object(Nb.a)("AddinPickerDisableError")});Array.add(Df.MenuSectionList,sf)}else if(3!==Wc.errorCode||
this.g4.MVg(Wc)||3!==id.errorCode)if(4!==Wc.errorCode||Fc.length){const pg=0>=Ce.length&&0>=mf.length;if(this.Il.h4){const hg=d?String.format(pg?null!==(ya=Object(Nb.a)("AddInSearchNoResultsAriaText"))&&void 0!==ya?ya:"":null!==(sb=Object(Nb.a)("AddInSearchResultsAriaText"))&&void 0!==sb?sb:"",this.pdb):null;Array.add(tf.ControlList,this.XCi(hg))}if(d)pg&&this.Y7h(Df),0<Ce.length&&this.u7h(Df,Ce),0<mf.length&&this.E7h(Df,mf),sf={},sf.MRUAddins=Ce.map(hg=>m(hg)),sf.MoreAddins=mf.map(hg=>m(hg)),sf.HasResults=
!pg,Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.SearchingAddinsFromFlyout",dataFields:rd.a.Rm(sf)});else{if(this.Il.qQb&&0===Fc.length&&!z&&!this.Foj)return this.qRk(),Object.assign(new Bk.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[this.RIf([])],UpdateDynamically:!0});0<Dd?(Df.MenuSectionList.push(this.RIf(Fc.slice(0,Dd),ee)),ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(d={["solutionIds"]:id.Ht.map(ch=>m(ch))},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowAdminAddinFromFlyout",
dataFields:rd.a.Rm(d)}))):this.Il.Hea&&this.Cka.npk(Df);let hg=this.iba?this.gZi(re,Fc):this.y8e(re,Fc);hg&&0!==hg.length||(cc.push("emptyPopularAddins"),la.ULS.sendTraceTag(507523101,220,15,"The popular addins list is empty"));hg=hg.filter(ch=>!!ch).slice(0,30);if(this.Il.lua){d=this.uSa.SAc();for(var $f of d)d=this.uSa.TAc($f,Fc.map(ch=>ch.solutionId)),hg=hg.concat(d.filter(ch=>!hg.some(vj=>vj.solutionId===ch.solutionId)));Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",
dataFields:rd.a.NOa({["Category"]:"All"})})}const Fg=this.Il.mqd?null===(sf=E(this.Il.p5e,this.Il.host))||void 0===sf?void 0:sf[0]:void 0;Fg&&(hg=hg.filter(ch=>{var vj;return Fg!==(null===(vj=ch.solutionId)||void 0===vj?void 0:vj.toLowerCase())}));const Nh=this.Il.lqd?E(this.Il.p5e,this.Il.host):void 0;0<(null===Nh||void 0===Nh?void 0:Nh.length)&&(hg=hg.filter(ch=>{var vj;return!Nh.includes(null===(vj=ch.solutionId)||void 0===vj?void 0:vj.toLowerCase())}));sf=[];this.Il.Hea&&(this.Cka.I9j(),hg=this.Cka.qSi(hg,
Fc.map(ch=>ch.solutionId)),sf=this.Cka.LGi(Fc.map(ch=>ch.solutionId)));$f=this.VSi(hg);this.Il.lua&&(Df.MenuSectionList.push(this.IGi()),$f.Title="");d=this.CQ.TI(Fg);this.Il.mqd&&!this.Il.lua&&d?L(d,Df,$f,Wc.Ht,id.Ht,this.Il.h4,this.Il.host):this.Il.lqd&&!this.Il.lua&&0<(null===Nh||void 0===Nh?void 0:Nh.length)?(d=Nh.map(ch=>this.CQ.TI(ch)),Q(d,Df,$f,Wc.Ht,id.Ht,this.Il.h4,this.Il.host)):Df.MenuSectionList.push($f);0<sf.length&&(sf=x(N.a,{Id:"CategoryAddInListSection",ControlsId:"CategoryAddInListSection.Controls",
ControlList:sf.map(ch=>this.Hzc("FRECategoryAddin"+ch.solutionId.toLowerCase(),ch)),Title:this.Cka.Zzc()}),Df.MenuSectionList.push(sf),this.Cka.C8j())}}else cc.push("serviceDisabled"),la.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),sf=this.tzc({iconName:"StoreDisabled",MEc:Object(Nb.a)("AddinPickerServiceDisconnectedError")}),Array.add(Df.MenuSectionList,sf);else cc.push(this.g4.iIf(Wc,id)),la.ULS.sendTraceTag(509687426,220,10,"dataProvider invokeFailure error hit"),
sf=this.tzc({iconName:"Common",MEc:Object(Nb.a)("AddinPickerGeneralError")}),Array.add(Df.MenuSectionList,sf);this.Il.Hea&&this.Cka.nXh(Df);this.Il.mqd&&W(Df);this.Il.lqd&&J(Df);this.tWh();0===Df.MenuSectionList.length&&(Df.IsFlexLayout=!1,cc.push("emptyMenuSection"),la.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));this.g4.M_g&&la.ULS.sendTraceTag(508047442,220,15,`${cc.join("|")}`);this.g4.i8f&&this.g4.m8f(Fc.length,cc,Wc,id,T);return Df}tWh(){window.setTimeout(()=>{var d=
document.querySelector('#Ribbon-InsertAddInFlyoutDropdown > .ms-FocusZone > div[class^="root"] > div[class^="container"]');d&&(d=d.scrollTop,0<d&&(this.Il.bId&&this.SCb&&this.SCb.WOa(),Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ScrollableListView",dataFields:rd.a.Rm({["scrollTopValue"]:d.toString()})})))},6E4)}VSi(d){const z=x(N.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:this.Il.lua?d.map(T=>this.Hzc("AddInsListItem"+T.solutionId.toLowerCase(),
T)):d.map((T,ya)=>this.Hzc("PopularAddInsListItem"+ya,T)),Title:Object(Nb.a)("PopularAddins")});ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(d={["solutionIds"]:d.map(T=>m(T))},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",dataFields:rd.a.Rm(d)}));return z}Hzc(d,z){const T={default:"AddinFlyoutControl"+z.solutionId},ya=this.LQb(z),sb=[];var cc=z.solutionId.toLowerCase();cc=Object.assign(new nk,
{text:Object(Nb.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+cc});Array.add(sb,cc);return Object.assign(new Yj.a,{Id:d,ExternalId:d,CommandId:d,CommandIdMapped:cg.a.h3a.toString(),iconSet:T,SecondaryLabel:null,Details:[],Label:z.displayName,ActionText:d.includes("PAIYO_CategoryAddinListItem")?Object(Nb.a)("AddinListOpen"):Object(Nb.a)("AddinListAdd"),Description:z.description,Links:sb,ActionId:d+"Add",ActionIdMapped:cg.a.fya.toString(),ActionCommandValueId:ya,CommandValueId:ya})}LQb(d){return this.iba?
String.format("{0}#{1}",d.solutionId,d.storeId):d.solutionId}CJa(d){if(!d)return null;var z=d.split("#");if(1!==z.length&&2!==z.length)return la.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;d=z[0].trim();z=2===z.length?z[1].trim():ea.AFrameworkApplication.uiCulture;return this.CQ.TI(d,z)}ZVi(d){return d?this.mab.TI(d):null}zef(d){return d&&d.hasOwnProperty("solutionId")&&d.hasOwnProperty("version")&&d.hasOwnProperty("storeType")&&d.hasOwnProperty("storeId")&&
d.hasOwnProperty("assetId")&&d.hasOwnProperty("assetStoreId")&&d.hasOwnProperty("targetType")&&d.hasOwnProperty("displayName")&&d.hasOwnProperty("width")&&d.hasOwnProperty("height")?!0:!1}CAf(d){return new Promise((z,T)=>{if(this.zef(d))return z(d);const ya=(new Date).getTime();this.mab.yne("",(sb,cc)=>sb?1!==cc.length||cc[0].solutionId.toLowerCase()!==d.solutionId.toLowerCase()?T(Error("The search add-in and result add-in don't match.")):this.zef(cc[0])?z(cc[0]):T(Error("The result add-in details are still not ready for install.")):
T(Error("Failed to query add-in details for install.")),ya,d.solutionId)})}QMi(d){if(!(d.solutionId in this.qbd)){const z="AddinGalleryButton"+this.zMe.toString();this.qbd[d.solutionId]=z;d=this.LQb(d);this.Jfc[z]=d;this.Jfc[z+"Add"]=d;this.zMe++;return z}return this.qbd[d.solutionId]}rPd(d){return d?this.Jfc[d]:null}tzc(d){var {iconName:z,MEc:T,Zul:ya=!1,Hvl:sb=Object(Nb.a)("AddinPickerTryAgain"),Gvl:cc="ReloadAddInPicker",pml:Fc="ReloadAddInPicker"}=d;d=Object.assign(new N.a,{Id:"ErrorSection",
ControlsId:"ErrorSection.Controls",ControlList:[]});let Wc=null;Wc=T===Object(Nb.a)("AddinPickerDisableError")&&this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?Object.assign(new Ej.a,{Id:"ErrorView",ExternalId:"ReloadAddInPickerStoreDisabled",IconName:z,Label:T,RetryButtonTitle:ya?Object(Nb.a)("AddinPickerTryAgain"):"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===z?T:Object(Nb.a)("AddinPickerTryAgainAriaLabel"),LinkText:Object(Nb.a)("AddinPickerDisableErrorDocumentText"),
LinkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",ea.AFrameworkApplication.uiCulture),OnLinkClicked:()=>{la.ULS.sendTraceTag(507875925,220,15,"User has clicked link on add-in picker error view")}}):Object.assign(new Ej.a,{Id:"ErrorView",ExternalId:Fc,IconName:z,Label:T,RetryButtonTitle:ya?sb:"",OnRetryCommandId:cc,AriaDescription:"StoreDisabled"===
z?T:Object(Nb.a)("AddinPickerTryAgainAriaLabel")});Array.add(d.ControlList,Wc);return d}y8e(d,z){var T=new Qa.a;for(let ya=0;ya<d.length;ya++)T.add(d[ya]);if(this.Il.lyb||!this.Xsa)30<T.count&&(T=l(T,(new Date).getDate())),this.Xsa=T.toArray();for(d=0;d<this.Xsa.length;d++)for(T=0;T<z.length;T++)if(this.Xsa[d].solutionId.toLowerCase()===z[T].solutionId.toLowerCase()){Array.remove(this.Xsa,this.Xsa[d--]);break}return this.Xsa}WSi(d){var z=30,T=(new Date).getDate();z>d.length&&(z=d.length);var ya=new Eb(T);
for(T=new Set;T.size<z;){const sb=ya.next(d.length);T.add(sb)}for(z=0;z<d.length;z++)ya=d[z].addinInfo,T.has(z)?ya.AUP*=20:ya.AUP=1===ya.priority?4*ya.AUP:2===ya.priority?2*ya.AUP:1*ya.AUP;d.sort((sb,cc)=>sb.addinInfo.AUP<cc.addinInfo.AUP?1:-1);return d}gZi(d,z){d=d.filter(T=>!z.some(ya=>ya.solutionId.toLowerCase()===T.solutionId.toLowerCase()));return this.WSi(d).slice(0,30)}gik(d){if(0===d.errorCode||2===d.ZL&&5===d.errorCode)d.Ht?this.OCg(d.Ht):la.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${od.a[d.ZL]}`)}OCg(d){return Promise.all(d.map(z=>
{var T,ya;if(z&&z.solutionId&&z.iconUrl)return appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+z.solutionId,z.iconUrl);la.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(T=null===z||void 0===z?void 0:z.solutionId)&&void 0!==T?T:"null",null!==(ya=null===z||void 0===z?void 0:z.iconUrl)&&void 0!==ya?ya:"null");return Promise.resolve()}))}XCi(d){var z;const T=this.Il.r5e,ya=T?String.format(null!==(z=Object(Nb.a)("AddInSearchBoxRecommendationPlaceholder"))&&
void 0!==z?z:"",T):Object(Nb.a)("AddInSearchBoxPlaceholder");return Object.assign(new Hk.a,{ExternalId:"SearchAddinInFlyout",Label:ya,ShowIcon:!0,Underlined:!0,Value:this.pdb,ResultAriaLiveText:d,OnChangeCommandId:"SearchAddinInFlyout"})}u7h(d,z){const T=Object.assign(new N.a,{Id:"MRUAddinsSearchResutlsSection",ControlsId:"MRUAddinsSearchResutlsSection.Controls",ControlList:[]});Array.add(d.MenuSectionList,T);d=this.QIf("MRUAddinsSearchResutlsGalleryControl",z,!1,!1);Array.add(T.ControlList,d)}E7h(d,
z){const T=Object.assign(new N.a,{Id:"PopularAddinsListSearchResutlsSection",ControlsId:"PopularAddinsSearchResutlsSection.Controls",ControlList:[],Title:Object(Nb.a)("AddInSearchResultsDivider")});for(let ya=0;ya<z.length;ya++)T.ControlList.push(this.Hzc("PopularAddinsSearchResultsItem"+ya,z[ya]));Array.add(d.MenuSectionList,T)}Y7h(d){if(this.Il.sFh){var z=n(Object(Nb.a)("AddInSearchNoResultsLink1"),"https://aka.ms/Officeaddins"),T=n(Object(Nb.a)("AddInSearchNoResultsLink2"),"https://aka.ms/OfficeAddinOverview");
z="Excel"===this.Il.host?String.format(Object(Nb.a)("AddInSearchNoResultsDescription2"),z,T):String.format(Object(Nb.a)("AddInSearchNoResultsDescription3"),T);z=x(Ej.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",IconName:"NoSearchResultsV2",Title:Object(Nb.a)("AddInSearchNoResultsTitle"),IsNoResultView:!0,LinkText:`${Object(Nb.a)("AddInSearchNoResultsDescription1")} ${z}`});T=x(N.a,{Id:"ErrorViewSection",ControlsId:"ErrorViewSection.Controls",ControlList:[]});Array.add(T.ControlList,z);Array.add(d.MenuSectionList,
T)}else z=this.tzc({iconName:"NoSearchResults",MEc:Object(Nb.a)("AddInSearchNoResultsHint")}),Array.add(d.MenuSectionList,z)}Nvi(d,z){const T=d.toLocaleLowerCase();d=z.filter(ya=>{this.FAb[ya.solutionId]||(this.FAb[ya.solutionId]=ya.displayName.toLocaleLowerCase());return this.FAb[ya.solutionId].includes(T)});d.sort((ya,sb)=>this.FAb[ya.solutionId].indexOf(T)-this.FAb[sb.solutionId].indexOf(T));return d}fyk(d){const z=this;return Lo(function*(){z.VFb=z.Il.vFh?yield z.mab.AMg(d):yield z.mab.zMg(d);
yield z.OCg(z.VFb)})}gyk(d){this.pdb=d;appChrome.api.dispatch(appChrome.actions.updateSearchBoxValue("SearchAddinInFlyout",d));this.ujc&&window.clearTimeout(this.ujc);this.ujc=window.setTimeout(()=>{var z;this.ujc=null;d?this.fyk(d).catch(()=>{this.VFb=[];la.ULS.sendTraceTag(507577680,220,10,"Failed to call search addins API")}).finally(()=>{var T;this.pdb===d&&(this.Zeg=!0,null===(T=this.P5b)||void 0===T?void 0:T.call(this))}):(this.Zeg=!1,null===(z=this.P5b)||void 0===z?void 0:z.call(this))},this.tXe)}set Zeg(d){this.Il.h4||
(this.xjc=!1);this.xjc=d}get Cai(){let d=!1;this.xjc&&(this.xjc=!1,d=this.Il.h4);d||(this.pdb="",this.VFb=[]);return d}aEk(){let d;f(z=>{const T=document.getElementById("Ribbon-InsertAddInFlyoutDropdown")||document.getElementById("InsertAddInFlyoutMenuId");T&&z&&(d=()=>{var ya;null===(ya=document.getElementById("SearchAddinInFlyout"))||void 0===ya?void 0:ya.focus();T.removeEventListener("focus",d);d=void 0},T.addEventListener("focus",d))})}D7j(d){if(d)try{d.MenuItems=this.WPi(this.Cai,d.IsShadowMenuOpen)}catch(z){la.ULS.sendTraceTag(509687425,
220,10,`GetReactGalleryMenu hit exception ${z.message}; stack: ${z.stack}`)}else la.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}qRk(){new kl(this.CQ,this.Il.host,this.Il,this.mab,this.NGe,this.uSa,this.IZe,this.Q_j.bind(this),this.P_j.bind(this));const d=f(z=>{z&&(t(),d.then(T=>{({dispose:T}=T);return T()}))})}Q_j(d,z){this.bZe=d;Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAddInStoreDialog",dataFields:rd.a.NOa({["IsDataProviderReady"]:z})})}P_j(d,z,T){Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.CloseAddInStoreDialog",
dataFields:rd.a.NOa({["OpenDuration"]:d-this.bZe,["IsDataProviderReady"]:z,["IsDialogRenderReady"]:T})})}dispose(){}C$j(d){var z;const T=null===(z=this.RNe)||void 0===z?void 0:z.HVa;d.sort((ya,sb)=>{ya=null===T||void 0===T?void 0:T.includes(ya.solutionId);sb=null===T||void 0===T?void 0:T.includes(sb.solutionId);return ya&&!sb?-1:!ya&&sb?1:0})}get g4(){this.aSa||(this.aSa=new Xj("Flyout",this.Ga));return this.aSa}}Object(ha.a)(Ok,"AppsFlyoutGenerator",null,[4]);var Uh=a(91),Aj;(function(d){d.ugl="APIC";
d.vgl="APID";d.Jgl="BBM";d.Tgl="CAIP";d.hhl="DA";d.khl="DWT";d.Nhl="ER";d.Xhl="FA";d.qil="IPWAI";d.qjl="PAIYO";d.lkl="TD";d.Fkl="WF";d.xkl="WN"})(Aj||(Aj={}));Object(ha.b)("AddinCategoryType",Aj);const ll={["TD"]:[{solutionId:"wa200004805",addinInfo:{diffAUP:55500}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005502",addinInfo:{AUP:7758,diffAUP:1900}},{solutionId:"wa102957665",
addinInfo:{AUP:42189,diffAUP:1E5}},{solutionId:"wa104379220",addinInfo:{AUP:3017,diffAUP:1E5}},{solutionId:"wa200004935",addinInfo:{AUP:1948,diffAUP:1E5}}],["WN"]:[{solutionId:"wa200006017",addinInfo:{releaseDate:16951392E5}},{solutionId:"wa200006008",addinInfo:{releaseDate:169488E7}},{solutionId:"wa200005960",addinInfo:{releaseDate:16938432E5}},{solutionId:"wa200005817",addinInfo:{releaseDate:16886592E5}},{solutionId:"wa200005702",addinInfo:{releaseDate:16891776E5}},{solutionId:"wa200005782",addinInfo:{AUP:52,
releaseDate:1690128E6}},{solutionId:"wa200005777",addinInfo:{AUP:19,releaseDate:16893504E5}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005669",addinInfo:{AUP:248,releaseDate:16874496E5}}]},ml={["PAIYO"]:[],["BBM"]:[{solutionId:"wa102957661",addinInfo:{AUP:14891}},{solutionId:"wa104104476",addinInfo:{AUP:14404}},{solutionId:"wa104381701",addinInfo:{AUP:9652}},
{solutionId:"wa104379629",addinInfo:{AUP:4E3}},{solutionId:"wa104381504",addinInfo:{AUP:1820}},{solutionId:"wa200003696",addinInfo:{AUP:1707}},{solutionId:"wa104380330",addinInfo:{AUP:793}},{solutionId:"wa104099688",addinInfo:{AUP:404}},{solutionId:"wa200005702",addinInfo:{AUP:68}}]},nl={["IPWAI"]:[{solutionId:"wa200005271",addinInfo:{AUP:12195}},{solutionId:"wa200004935",addinInfo:{AUP:1948,diffAUP:1E5}},{solutionId:"wa200001584",addinInfo:{AUP:2278}},{solutionId:"wa200005107",addinInfo:{AUP:451}},
{solutionId:"wa200005281",addinInfo:{AUP:595}},{solutionId:"wa200005333",addinInfo:{AUP:101}},{solutionId:"wa200005502",addinInfo:{AUP:7758,diffAUP:1900}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005669",addinInfo:{AUP:248,releaseDate:16874496E5}}],["APIC"]:[{solutionId:"wa102957665",addinInfo:{AUP:42189,diffAUP:1E5}},{solutionId:"wa104381973",addinInfo:{AUP:55837}},
{solutionId:"wa104051163",addinInfo:{AUP:1643}},{solutionId:"wa104221182",addinInfo:{AUP:2980}},{solutionId:"wa104104476",addinInfo:{AUP:13287}},{solutionId:"wa200004688",addinInfo:{AUP:1260}},{solutionId:"wa104379169",addinInfo:{AUP:69}},{solutionId:"wa103147117",addinInfo:{AUP:89}},{solutionId:"wa200004179",addinInfo:{AUP:1072}},{solutionId:"wa104380194",addinInfo:{AUP:1245}},{solutionId:"wa200003220",addinInfo:{AUP:192}},{solutionId:"wa200004687",addinInfo:{AUP:226}}],["DA"]:[{solutionId:"wa200002503",
addinInfo:{AUP:461}},{solutionId:"wa200000018",addinInfo:{AUP:2210}},{solutionId:"wa200000169",addinInfo:{AUP:1962}},{solutionId:"wa104381841",addinInfo:{AUP:1010}},{solutionId:"wa200003784",addinInfo:{AUP:875}},{solutionId:"wa104381807",addinInfo:{AUP:308}},{solutionId:"wa104380711",addinInfo:{AUP:357}},{solutionId:"wa200000025",addinInfo:{AUP:1058,diffAUP:4600}},{solutionId:"wa200005782",addinInfo:{AUP:52,releaseDate:1690128E6}},{solutionId:"wa200005777",addinInfo:{AUP:19,releaseDate:16893504E5}}],
["FA"]:[{solutionId:"wa104379220",addinInfo:{AUP:3017,diffAUP:1E5}},{solutionId:"wa104381859",addinInfo:{AUP:380}},{solutionId:"wa104381717",addinInfo:{AUP:217}},{solutionId:"wa200003692",addinInfo:{AUP:295}},{solutionId:"wa104381695",addinInfo:{AUP:299}},{solutionId:"wa104380978",addinInfo:{AUP:347}}]};class Zj{constructor(d,z,T,ya,sb,cc,Fc,Wc){Fc=void 0===Fc?null:Fc;this.VA=Wc;this.disposed=!1;this.emc=this.tGa=null;this.rIb=0;this.insertTab="Insert";this.homeTab="Home";this.HZf=this.Nse=!1;this.xyi=
1E3;this.Gyi="AddinFlyoutFeedbackSurvey";this.Hyi=15E3;this.ose=!0;this.B$e=!1;this.qRh=ea.AFrameworkApplication.fa.ka("IsNewStringEnabled")?`[{"title":"${CommonUiStrings.AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUiStrings.AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUiStrings.AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`:
`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`;
this.B1i=(id,Dd,ee,re)=>{if(id){if(id=this.CJa(id,re))id={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(id.solutionId,id.storeType,id.assetId,id.storeId)},id.href=Dd,id.UILocation=ee,id.ControlId=re,Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:rd.a.Rm(id)})}else la.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.mpk=()=>{this.emc?this.emc.rvg():la.ULS.sendTraceTag(507896192,220,10,"_addInCategoryManager is null")};
this.n3i=(id,Dd,ee)=>{(id=this.CJa(id,ee))?this.sD.CAf(id).then(re=>{const Ce={};Ce.solutionId=re.solutionId;Ce.version=re.version;Ce.storeType=re.storeType;Ce.storeId=re.storeId;Ce.assetId=re.assetId;Ce.assetStoreId=re.assetStoreId;Ce.targetType=re.targetType;Ce.displayName=re.displayName;Ce.width=re.width;Ce.height=re.height;this.KPf(Dd,ee,Ce)}).catch(re=>{la.ULS.sendTraceTag(507631067,220,10,re.message)}):la.ULS.sendTraceTag(507631068,220,10,"No search add-in details.")};this.s5i=id=>{const Dd=
id.substring(14);"All"===Dd||Object.values(Aj).some(ee=>ee===Dd)?this.sD.tXk(Dd):la.ULS.sendTraceTag(507564195,220,10,`Bad category switch. SourceControlId=${id}.`)};this.u5i=()=>{this.sD?this.sD.H2i():la.ULS.sendTraceTag(507523100,220,10,`Bad fre content switch. appsFlyoutGenerator is valid: ${!!this.sD}`)};this.t5i=id=>{(id=id.SourceControlId)&&this.sD?this.sD.G2i(id):la.ULS.sendTraceTag(507560522,220,10,`Bad fre banner switch. SourceControlId=${id}; appsFlyoutGenerator is valid: ${!!this.sD}`)};
this.FQd=(id,Dd,ee)=>{if(this.h4&&(null===ee||void 0===ee?0:ee.startsWith("PopularAddinsSearchResultsItem")))this.n3i(id,Dd,ee);else{if(this.sD.iba){id=this.CJa(id,ee);if(!id){la.ULS.sendTraceTag(508872144,220,10,"Fail to get a valid AddinDetail with provided unique id.");return}id=id.S$b()}else id=this.dIf(id,ee);id?this.KPf(Dd,ee,id):la.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.")}};this.KPf=(id,Dd,ee)=>{const re={[Hc.a.h$]:ee,[wb.a.Xk]:this.Ai.wfa(ee)},Ce=new tb.a(-741808261,
0,this.$.hi,id,"");this.$.Ma.qh(Ce,re);this.Ai.zpa("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,ee);id={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ee.solutionId,ee.storeType,ee.assetId,ee.storeId),["UILocation"]:id,["ControlId"]:Dd,["FRECategory"]:this.lua?this.sD.LMg:void 0,["FRECarouselCategory"]:this.Hea?this.sD.fCf:void 0};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:rd.a.Rm(id)})};this.fTb=(id,Dd,ee)=>{ee=
void 0===ee?null:ee;if(id)if(id=this.CJa(id,ee)){var re=this.Ai.Cl;re=re?re.getAppUILocale()||"en-US":"en-US";this.tGa=new wj(id.solutionId,"wac_excel",re,Ce=>{this.Ai.zpa("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Ce);const mf=new tb.a(-741808261,0,this.$.hi,Dd,null);this.$.Ma.qh(mf,{[Hc.a.h$]:Ce,[wb.a.Xk]:this.Ai.wfa(Ce)});this.tGa&&this.tGa.hide();ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(Ce={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ce.solutionId,
Ce.storeType,Ce.assetId,null,null,Ce.storeId),["UILocation"]:Dd,["ControlId"]:ee,["FRECategory"]:this.lua?this.sD.LMg:void 0,["FRECarouselCategory"]:this.Hea?this.sD.fCf:void 0},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:rd.a.Rm(Ce)}))});this.tGa.initializeAndShow("",null,null)}else la.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else la.ULS.sendTraceTag(509362328,220,10,"Unique id is null.")};
this.A3i=(id,Dd,ee)=>{var re;if(id){if(this.sD.iba){id=this.CJa(id);if(!id){la.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");return}id=id.S$b()}else if(id=this.dIf(id),!id){la.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}var Ce={[Hc.a.h$]:id,[wb.a.Xk]:this.Ai.wfa(id)},mf=new tb.a(-741808261,0,this.$.hi,Dd,"");this.$.Ma.qh(mf,Ce);null===(re=this.aUf)||void 0===re?void 0:re.sEj(id.solutionId);ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",
!0)&&(Dd={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(id.solutionId,id.storeType,id.assetId,null,null,id.storeId),["UILocation"]:Dd,["ControlId"]:ee},Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:rd.a.Rm(Dd)}))}else la.ULS.sendTraceTag(509362326,220,10,"UniqueId is null.")};this.CJa=(id,Dd)=>this.h4&&(null===Dd||void 0===Dd?0:Dd.startsWith("PopularAddinsSearchResultsItem"))?this.sD.ZVi(id):this.sD.iba?this.sD.CJa(id):this.mU.TI(id);
this.o3i=(id,Dd)=>{if(id){var ee={};ee.solutionId=id.solutionId;ee.version=id.version;ee.storeType=id.storeType;ee.storeId=id.storeId;ee.assetId=id.assetId;ee.assetStoreId=id.assetStoreId;ee.targetType=id.targetType;ee.displayName=id.displayName;ee.width=id.width;ee.height=id.height;id={[Hc.a.h$]:ee,[wb.a.Xk]:this.Ai.wfa(ee)};var re=new tb.a(-741808261,0,this.$.hi,2,"");this.$.Ma.qh(re,id);this.Ai.zpa("installAddinFromStoreExp",OSF.AgaveHostAction.ClickTrust,ee);Dd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ee.solutionId,
ee.storeType,ee.assetId,null,null,ee.storeId),["source"]:Dd,["userAction"]:"SingleClickInstall"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallAddinFromStoreExp",dataFields:rd.a.Rm(Dd)})}else la.ULS.sendTraceTag(507332238,220,10,"AddinDetail is null.")};this.q3i=(id,Dd)=>{id?this.sD.CAf(id).then(ee=>{var re={};re.solutionId=ee.solutionId;re.version=ee.version;re.storeType=ee.storeType;re.storeId=ee.storeId;re.assetId=ee.assetId;re.assetStoreId=ee.assetStoreId;re.targetType=ee.targetType;
re.displayName=ee.displayName;re.width=ee.width;re.height=ee.height;ee={[Hc.a.h$]:re,[wb.a.Xk]:this.Ai.wfa(re)};const Ce=new tb.a(-741808261,0,this.$.hi,2,"");this.$.Ma.qh(Ce,ee);this.Ai.zpa("installAddinFromStoreExp",OSF.AgaveHostAction.ClickTrust,re);re={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(re.solutionId,re.storeType,re.assetId,null,null,re.storeId),["source"]:Dd,["userAction"]:"SingleClickInstall"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallAddinFromStoreExp",
dataFields:rd.a.Rm(re)})}).catch(ee=>{la.ULS.sendTraceTag(507332236,220,10,ee.message)}):la.ULS.sendTraceTag(507332237,220,10,"AddinDetail is null.")};this.w3i=(id,Dd)=>{if(id){var ee=this.Ai.Cl;ee=ee?ee.getAppUILocale()||"en-US":"en-US";this.tGa=new wj(id.solutionId,"wac_excel",ee,re=>{this.Ai.zpa("installAddinFromStoreExp",OSF.AgaveHostAction.ClickTrust,re);const Ce=new tb.a(-741808261,0,this.$.hi,2,null);this.$.Ma.qh(Ce,{[Hc.a.h$]:re,[wb.a.Xk]:this.Ai.wfa(re)});this.tGa&&this.tGa.hide();re={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(re.solutionId,
re.storeType,re.assetId,null,null,re.storeId),["source"]:Dd,["userAction"]:"AddinDetailsDialogInstall"};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.InstallAddinFromStoreExp",dataFields:rd.a.Rm(re)})});this.tGa.initializeAndShow("",null,null);id={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(id.solutionId,id.storeType,id.assetId,null,null,id.storeId),["source"]:Dd};Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAddInInstallDialogFromStoreExp",dataFields:rd.a.Rm(id)})}else la.ULS.sendTraceTag(507332235,
220,10,"AddinDetail is null.")};this.y3i=()=>{const id=new tb.a(1296389134,0,this.$.hi,2,null);this.$.Ma.qh(id,{[wb.a.CTk]:"InsertMoreAddInsFromFooter"});Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.LaunchAppForOfficeDialogFromStoreExp"})};this.MNj=(id,Dd)=>{if(Dd)if(Dd)if(id=Dd.ls){if(Ij()||dj()){const re=this.$.ea.workbookContext.WebExtensions;if(re){let Ce=!1;for(var ee of re)if(ee.PrimaryMarketplace.SolutionId.toLowerCase()===id.solutionId.toLowerCase()){Ce=!0;break}if(!Ce){la.ULS.sendTraceTag(512258444,
220,15,"Not find add-in persisted in the template file.");return}}else{la.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}Dd=Dd.Mw;ee=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(id.solutionId in ee)Dd=ee[id.solutionId];else if(Dd=this.qIi(Dd),void 0===Dd||null===Dd){la.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}ee=new tb.a(cg.a.Bea,0,0,2,null);this.executeCommand(0,ee,{["SourceControlId"]:Dd},
null);id.isAutoLaunched=!0}else la.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else la.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else la.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.r_j=(id,Dd)=>{null==Dd?Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:rd.a.Rm({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})}):
ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8180233_AddNullCheck")&&isNullOrUndefined(this.$)||(this.zyb=new Th(this),this.zyb.$ik(Dd),id=this.$.Ma,ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.uIb?this.tBa?(Dd=appChrome.selectors.getSelectedTabId())&&ze.a(Dd,this.homeTab)?this.zyb.eWg():null!==id&&(id.$pd(this.Jae),la.ULS.sendTraceTag(508564945,220,50,"Register home tab switched event")):la.ULS.sendTraceTag(508564944,802,50,"selector is not ready"):
null!==id&&(id.$pd(this.Jae),la.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))};this.Jae=(id,Dd)=>{id=this.insertTab;ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.uIb&&(id=this.homeTab);Dd.tabName===id&&(Dd=this.$.Ma,null!=Dd&&(Dd.WFg(this.Jae),la.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.zyb.eWg())};this.YVj=(id,Dd)=>{id=null;Dd&&(id=Dd);(null===id||void 0===id?0:id.Mw)&&this.sGk(id.Mw);
this.$.Dm();id&&id.ls&&this.ALh(id.ls)};this.z6k=(id,Dd)=>{Dd.ZL===od.a.UIj&&(this.rIb|=1);Dd.ZL===od.a.hGh&&(this.rIb|=2);!ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)&&this.PSg()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.$=d;la.ULS.shipAssertTag(537170659,0,!(void 0===z||null===z),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${hj.a.tfa()}`);
this.Ai=z;this.Qif=T;this.jnc=ya;this.xla=sb;this.tIb=cc;this.Kx=new dl.a;this.kua=new gf;this.tGd=Fc;Pd.a.Vmb=Pd.a.Rxf;this.tBd=new Qa.a;this.Uib=new Qa.a;this.uIb&&(this.Nse=ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",!1),this.mU=this.Ai.mU,null!==this.mU?(this.emc=this.VNc?new el(ea.AFrameworkApplication.fa,this.mU,this.qRh):null,this.aUf=new Jc(this.mU),d={FQd:this.o3i.bind(this),p3i:this.q3i.bind(this),fTb:this.w3i.bind(this),
x3i:this.y3i.bind(this)},this.sD=new Ok(ea.AFrameworkApplication.yh,this.mU,cg.a.dZb.toString(),cg.a.tqb.toString(),this.P6b?"-1777747317":"1296389134",ea.AFrameworkApplication.fa,this.emc,this.HGi(),this.aUf,()=>{var id;return null===(id=this.VA)||void 0===id?void 0:id.call(this,"InsertAddInFlyout")},d),this.mU.OAa(this.z6k)):la.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get uIb(){return ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&
ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}get VNc(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",!1)}get Rgi(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DistinguishUserSegmentForContentExpEnabled",!1)}get h4(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get Hea(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",
!1)}get lua(){return ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",!1)}get P6b(){return ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get isBusinessUser(){return!!ea.AFrameworkApplication.ii.IsBusinessUser}get isEduUser(){return!!ea.AFrameworkApplication.ii.IsEduUser}get isAnonymousUser(){return ea.AFrameworkApplication.fa.ka("IsAnonymousUser")}EQh(){return`IsBusinessUser: ${this.isBusinessUser}, IsEduUser: ${this.isEduUser}, IsAnonymousUser: ${this.isAnonymousUser}`}HGi(){const d=
this.Rgi&&this.isBusinessUser?ml:ll;for(const z in nl)d[z]=nl[z];return d}dispose(){void 0!==this.tIb&&null!==this.tIb&&(this.tIb.dispose(),this.tIb=null);this.Ai=this.$=null;this.disposed=!0}kLk(d,z){switch(d){case cg.a.Bea:d=this.UKk(z);break;default:d=!1}return d}Ri(d,z){return"Dev Box"===ea.AFrameworkApplication.fa.Ya("StatusBarEnvironmentNameToUse")?!1:619219938===z?(ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TempTelemetryOfInsertAddInFlyout",!1)&&Object(xd.a)("getRibbonSubComponentStatus")&&
(d=appChrome.api.getRibbonSubComponentStatus("insertAddInFlyout"),la.ULS.sendTraceTag(507909329,220,50,`insertAddInFlyout status=${d}`)),!this.PSg()):!1}executeCommand(d,z,T){d=Oa.TaskExtensions.Gq();var ya=z.command;z=cc=>{let Fc=null;if(!cc)return Fc;(Fc=cc.CommandValueId)||(Fc=this.sD.rPd(cc.SourceControlId));Fc||la.ULS.sendTraceTag(508560270,220,10,"UniqueId is null.");return Fc};switch(ya){case 843847158:break;case cg.a.dZb:this.WOa();var sb=T.UILocation;this.VNc?(T=z(T),this.fTb(T,sb)):(T=T.SourceControlId)?
this.fTb(this.sD.rPd(T),sb):la.ULS.sendTraceTag(509362329,220,10,"Control id is null.");break;case cg.a.h3a:this.WOa();z=this.VNc?z(T):T.CommandValueId;sb=T.UILocation;ya=T.SourceControlId;"LinkClickedPayload"===T.Type?this.B1i(z,T.Href,sb,ya):this.fTb(z,sb,ya);break;case cg.a.vne:this.h4&&this.sD.gyk(null!==(sb=T.SearchBoxNewValue)&&void 0!==sb?sb:"");break;case cg.a.o$b:this.lua&&(this.WOa(),this.s5i(T.SourceControlId));break;case cg.a.Z0c:this.Hea&&this.t5i(T);break;case cg.a.Y0c:this.Hea&&this.u5i();
break;case cg.a.cPb:this.B$e||(this.mU.OAa(this.mpk),this.B$e=!0);break;case cg.a.fya:this.WOa();this.FQd(T.CommandValueId,T.UILocation,T.SourceControlId);break;case cg.a.tqb:this.WOa();sb=T.UILocation;ya=T.SqmControlId;const cc=T.SourceControlId;if(this.VNc)T=z(T);else{if(!cc){la.ULS.sendTraceTag(508440995,220,10,"ControlId is null.");break}T=this.sD.iba?this.sD.rPd(cc):this.sD.a2h[cc]}this.A3i(T,sb,null!==ya&&void 0!==ya?ya:cc);break;case -2025863019:ud.a.Lse(T[Hc.a.kqd].toString(),()=>{ca.f(this.$).focus()});
break;case -1777565636:Nj.a.showUILessDialog(T[Hc.a.vIb].toString());this.Ai.ROk(T[Hc.a.vIb].toString());break;case 1592314317:Nj.a.hideUILessDialog(T[Hc.a.vIb].toString());this.Ai.N7i(T[Hc.a.vIb].toString());break;case cg.a.Bea:d=this.nQd(T);break;case cg.a.rqb:this.cZb(T);break;case cg.a.qG:this.lbk(T);break;case cg.a.vqa:this.vqa(T);break;case cg.a.N8b:this.tIb.k_c();break;case cg.a.refreshAddinCommands:this.Lgk();break;case 1949669462:this.xla.bPg(!0);break;case -1014260128:d=this.executeDynamicAddInCommandsAPI(T);
break;default:d=Ia.a(ya)}return d}Gi(d,z,T){d=!1;switch(z.command){case cg.a.h3a:case cg.a.fya:case cg.a.dZb:case cg.a.tqb:case cg.a.vne:case cg.a.o$b:case cg.a.Z0c:case cg.a.cPb:d=!!T;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case cg.a.qG:case cg.a.vqa:case cg.a.N8b:case cg.a.refreshAddinCommands:case 1949669462:case cg.a.rqb:case -1014260128:d=!0;break;case cg.a.Bea:d=!ea.AFrameworkApplication.protectedFile}return d}PSg(){return!ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8162137_NullCheckForFlyoutControlEnabled")||
void 0!==this.$&&null!==this.$?ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)?this.$.m4&&!ua.EwaSettings.Ra(174):0!==this.rIb&&this.$.m4&&!ua.EwaSettings.Ra(174):(la.ULS.sendTraceTag(508380621,220,15,"ewaControl is null"),!1)}dj(d,z,T){switch(z){case "PopulateAddInGallery":return ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.PopulateAddinGallery",
dataFields:rd.a.Rm({})}),ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8464891_ShowUserSegmentInformationEnabled")&&Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.UserSegmentInformation",dataFields:rd.a.Rm({["UserSegment"]:this.EQh()})}),this.sD.D7j(T),this.Nse&&(this.WOa(),this.O1d()),!0;default:return!1}}O1d(){aa.a.instance.getItem("AddinFlyoutOnExcelSurveyShowed")&&(this.ose=!1);this.ose&&(window.setTimeout(()=>{const d=this.$Ac();d&&"hidden"!==d.visibility&&(this.HZf=!0)},this.xyi),
this.YDg=window.setTimeout(()=>{this.d_g=Db.a.instance.fj("Common.ISystemInitiatedFeedback");aa.a.instance.setItem("removeFlyoutTaskTimeoutId",this.YDg.toString());this.HZf&&this.d_g&&this.d_g.execute(d=>{const z=this.$Ac();z&&"hidden"===z.visibility&&(d.I8a(this.Gyi,null),this.ose=!1,aa.a.instance.setItem("AddinFlyoutOnExcelSurveyShowed","1"))})},this.Hyi))}$Ac(){let d=null;try{const z=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");z&&(d=ge.a.CE(z.parentNode.parentNode.parentNode))}catch(z){la.ULS.sendTraceTag(508911886,
220,10,"AddinFlyout get parent and parent get exception "+(z?z.toString():""))}return d}WOa(){this.Nse&&(window.clearTimeout(this.YDg),aa.a.instance.removeItem("removeFlyoutTaskTimeoutId"))}qIi(d){if(!d)return la.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((d=d.m7)&&d.jC&&0<d.jC.count)for(const z of d.jC){if(z.groups&&1===z.groups.length){d=z.groups[0];if(d.controls&&1===d.controls.length){const T=d.controls[0];if(T.attributes&&!T.controlType&&T.enabled)return T.id}d.controls&&
la.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}z.groups&&la.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}get JM(){return ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}lbk(d){if(d&&Hc.a.i$ in d)if(this.Ai){var z=d[Hc.a.i$];this.JM?Hc.a.nnc in d&&(d=d[Hc.a.nnc],this.Ai.Yub(z,d),1===d&&this.qG(z,!0)):this.qG(z,
!0)}else la.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..");else la.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}qG(d,z){z=void 0===z?!1:z;this.Ai?(la.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",d,z),this.Ai.qG(d,z)):la.ULS.sendTraceTag(508564227,220,50,"QueryAddinDetails: abort because ddaFacadeService is null.")}Lgk(){if(this.xla.SLc()){this.xla.pff();
var d=this.lKd();if(d&&0<d.count)for(const z of d)d={[Hc.a.i$]:z,[Hc.a.f4]:4,[Hc.a.EVa]:(new Date).getTime()},this.vqa(d)}else ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(la.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.xla.SLc()),this.qG(10,!0),this.qG(0,!0))}vqa(d){la.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${d[Hc.a.f4]}, DataProvider ${d[Hc.a.i$]}.`);
this.xla.eCk();window.setTimeout(()=>{if(void 0===this.Ai||null===this.Ai)la.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${hj.a.tfa()}`);else{const z=new Jj(new Cj(this.Ai.Cl),oj.instance,nd.instance);z.ZAh((T,ya)=>{ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.qG(d[Hc.a.i$]);this.cZb(ya.properties)});z.KEh(this.r_j);z.d4k(d)}},0)}cZb(d){if(!this.disposed){la.ULS.sendTraceTag(537170655,
220,50,`LaunchOperationType ${d[Hc.a.f4]}.`);try{if(ua.EwaSettings.Ra(174)){const ya=d[Hc.a.sIb];if(ya&&0<ya.count){const sb=ya.count;for(let cc=sb-1;0<=cc;cc--){const Fc=ya.na(cc);OSF.OsfControl.isFirstPartyStoreString(Fc.storeType)||ya.remove(ya.na(cc))}if(ya.count<sb){const cc=Object(Uh.d)(oa.a.resolve(da.C,{va:0}));Oa.TaskExtensions.Xa(cc,()=>{cc.result.Om(36,null)},this.$.ya,3)}if(!ya.count)return}}if(void 0===this.Ai||null===this.Ai)la.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${hj.a.tfa()}`);
else{var z=null;z=ea.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?new Tj(this.Kx,this.Qif,new Cj(this.Ai.Cl),new Vj(this.$.xi,cg.a.Bea),this.xla,oj.instance,this.kua,(ya,sb)=>{const cc={};cc.InstanceId=Be.a.create().toString();cc.PrimaryMarketplace={};cc.PrimaryMarketplace.SolutionId=ya.solutionId;cc.PrimaryMarketplace.SolutionVersion=ya.version;cc.PrimaryMarketplace.MarketplaceType=ya.storeType;cc.PrimaryMarketplace.MarketplaceRef=ya.storeId;cc.WebExtensionType=1;this.Ai.DRk(cc,()=>
{sb(ya)})}):new Tj(this.Kx,this.Qif,new Cj(this.Ai.Cl),new Vj(this.$.xi,cg.a.Bea),this.xla,oj.instance,this.kua);z.fBh(this.MNj);z.$Ah(this.YVj);var T=new Th(this);z.dDh(T.XVj);z.JEh(T.yOk);this.$.la.kh(53).us&&Ye.a.get_instance().Fm(5,null).continueWith(()=>{this.disposed||z.lwj(this.tGd,this.$.domElement,d)})}}catch(ya){la.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${ya.message}.`)}}}nQd(d){const z=Oa.TaskExtensions.Gq();d=d[this.Kx.sva];const T=this.jnc.dnd(d),ya=new Nj.a(this.$,
this.Ai,T.ownerAddinInfo,z);return this.JOf(z,d,T,ya)}JOf(d,z,T,ya){this.jnc.nQd(z,this.xla,ya,new Cj(this.Ai.Cl),T,()=>{d=ya.e1h()},()=>{ca.f(this.$).focus()});return d}ALh(d){const z=Oa.TaskExtensions.Gq();var T=this.Ai.x5(d.solutionId);if(T){var ya=this.Ai.aY(T);if(vd.HelperMethods.XF(ya)&&0!==ya.SharedRuntime.State)return}ya=this.jnc.BLh;const sb=d.solutionId in ya?ya[d.solutionId]:null;if(sb){const cc=this.jnc.dnd(sb),Fc=new Nj.a(this.$,this.Ai,cc.ownerAddinInfo,z),Wc=Telemetry.PrivacyRules.GetPrivacyCompliantId(d.solutionId,
null!==cc.ownerAddinInfo?cc.ownerAddinInfo.storeType:d.storeType,d.assetId,null,null,d.storeId);ya=id=>{if(id){const Dd={};for(const ee of id)Dd[ee[0]]=ee[1];(id=Hc.a.j5e in Dd?Dd[Hc.a.j5e]:null)&&"true"===id.toLowerCase()&&(la.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${d.storeType}, StoreId ${d.storeId}, SolutionId ${Wc}.`),this.JOf(z,sb,cc,Fc))}};la.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${d.storeType}, StoreId ${d.storeId}, SolutionId ${Wc}.`);
if(T)ya(this.Ai.aY(T).OsfPropertyBag);else if(T=this.$.ea.workbookContext.WebExtensions)for(const id of T)if((1===id.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===d.targetType&&id.PrimaryMarketplace.MarketplaceType.toLowerCase()===d.storeType.toLowerCase()&&id.PrimaryMarketplace.MarketplaceRef.toLowerCase()===d.storeId.toLowerCase()&&id.PrimaryMarketplace.SolutionId.toLowerCase()===d.solutionId.toLowerCase()){ya(id.OsfPropertyBag);break}}}dwe(d,z,T){d&&(void 0===
T||!T||z||this.tBd.contains(d)||this.tBd.add(d),(T=this.Uib.contains(d))&&z&&this.Uib.remove(d),T||z||this.Uib.add(d))}sGk(d){if((d=d.m7)&&d.jC)for(const z of d.jC)if(z.groups)for(const T of z.groups)if(T.controls)for(const ya of T.controls)if(this.dwe(ya.id,ya.enabled,!0),1===ya.controlType&&ya.menuItems)for(const sb of ya.menuItems)this.dwe(sb.id,sb.enabled,!0)}lKd(){const d=new Qa.a;ua.EwaSettings.Ra(52)&&(this.$.ea.Vn.get(27)&&(d.add(0),d.add(16)),this.$.ea.Vn.get(33)&&d.add(1),d.add(8));return d}executeDynamicAddInCommandsAPI(d){let z=
!0;if(void 0===d||null===d||void 0===d[Hc.a.COb]||null===d[Hc.a.COb])return jf.Task.Ua(!1);switch(d[Hc.a.COb]){case 1:z=this.s7k(d);break;case 2:z=this.wGk(d);break;case 4:this.Uib.clear();this.Uib.addRange(this.tBd);break;case 3:z=this.installContextualTab(d);break;default:z=!1}return jf.Task.Ua(z)}UKk(d){return d&&this.Kx.sva in d?(d=d[this.Kx.sva])?this.Uib.contains(d):!1:!1}s7k(d){var z=null;let T=null,ya=null,sb=!0;void 0!==d[Hc.a.Qfa]&&null!==d[Hc.a.Qfa]&&void 0!==d[this.Kx.sva]&&null!==d[this.Kx.sva]&&
void 0!==d[Hc.a.Pfa]&&null!==d[Hc.a.Pfa]&&(z=d[Hc.a.Qfa],T=d[Hc.a.hwc],ya=d[this.Kx.sva],sb=d[Hc.a.Pfa]);if(!z||!ya)return la.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;d=(new fj.a(this.$.xi,z,this.Kx,!0)).h_a(ya);z={DynamicAddinCommandsApiName:"UpdateControlEnableState"};z.AssetId=T;z.MaskedTabId=d;z.IsToEnable=sb;la.ULS.sendTraceTag(537170648,220,50,mc.a.Ci(z));this.dwe(d,sb);wl.a.eB.XB();return!0}wGk(d){var z,T,ya=null,sb=null;let cc=
null;var Fc=null;let Wc=!0;void 0!==d[Hc.a.mDd]&&null!==d[Hc.a.mDd]&&void 0!==d[Hc.a.Qfa]&&null!==d[Hc.a.Qfa]&&void 0!==d[this.Kx.sva]&&null!==d[this.Kx.sva]&&void 0!==d[Hc.a.Pfa]&&null!==d[Hc.a.Pfa]&&(ya=d[Hc.a.mDd],sb=d[Hc.a.Qfa],cc=d[Hc.a.hwc],Fc=d[this.Kx.sva],Wc=d[Hc.a.Pfa]);if(!ya||!sb||!Fc)return la.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;d=(new fj.a(this.$.xi,sb,this.Kx,!0)).AMf(Fc);Fc={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
Fc.StoreType=ya;Fc.AssetId=cc;Fc.MaskedTabId=d;Fc.IsToShow=Wc;la.ULS.sendTraceTag(537170646,220,15,mc.a.Ci(Fc));ya=this.xla.ywa(ya,sb,1);sb=!1;if(null===(T=null===(z=null===ya||void 0===ya?void 0:ya.Mw)||void 0===z?void 0:z.m7)||void 0===T?0:T.jC)for(const id of ya.Mw.m7.jC)if(id.id===d){sb=!0;break}if(!sb)return la.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;z=[];Wc?appChrome.selectors.getSelectedTabId()!==d&&z.push(appChrome.actions.activateRibbonTab(d)):
(appChrome.selectors.getSelectedTabId()===d&&z.push(appChrome.actions.setCurrentTab(Qe.a.VS)),z.push(appChrome.actions.deactivateRibbonTab(d)));appChrome.api.dispatch(z);return!0}dIf(d,z){if(this.mU){if(d=this.CJa(d,z))return z={},z.solutionId=d.solutionId,z.version=d.version,z.storeType=d.storeType,z.storeId=d.storeId,z.assetId=d.assetId,z.assetStoreId=d.assetStoreId,z.targetType=d.targetType,z.displayName=d.displayName,z.width=d.width,z.height=d.height,z;la.ULS.sendTraceTag(509362324,0,10,"Get addinDetail fail.");
return null}la.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(d){let z=null,T=null,ya=null;var sb=null;if(void 0!==d[Hc.a.Qfa]&&null!==d[Hc.a.Qfa]&&void 0!==d[Hc.a.Pfa]&&null!==d[Hc.a.Pfa]){const cc=d[Hc.a.Pfa];z=d[Hc.a.Qfa];void 0!==cc[Hc.a.NYa]&&null!==cc[Hc.a.NYa]&&void 0!==cc[Hc.a.OYa]&&null!==cc[Hc.a.OYa]&&(T=cc[Hc.a.NYa],ya=cc[Hc.a.OYa],sb=cc[Hc.a.nDd])}if(!(z&&ya&&T&&sb))return la.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),
!1;d=this.xla.ywa(sb.PrimaryMarketplace.MarketplaceType,sb.PrimaryMarketplace.SolutionId,1);if(null===d||void 0===d?0:d.Mw)return la.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;d={};d.solutionId=sb.PrimaryMarketplace.SolutionId;d.version=sb.PrimaryMarketplace.SolutionVersion;d.storeType=sb.PrimaryMarketplace.MarketplaceType;d.storeId=sb.PrimaryMarketplace.MarketplaceRef;sb.AssetMarketplace?(d.assetId=sb.AssetMarketplace.SolutionId,d.assetStoreId=sb.AssetMarketplace.MarketplaceRef):
(d.assetId=null,d.assetStoreId=null);d.targetType=sb.WebExtensionOsfControlType;d.width=sb.TaskpaneWidth;d.height=0;d.isAddinCommands=!0;sb=new Qa.a;sb.add(d);d={};d[Hc.a.sIb]=sb;d[Hc.a.f4]=6;d[Hc.a.NYa]=T;d[Hc.a.OYa]=ya;this.cZb(d);return!0}get tBa(){return!!window.appChrome&&!!appChrome.selectors}}Object(ha.a)(Zj,"AddinUICommandHandler",null,[231,34,4]);var zl=a(51);class Oj{constructor(d,z,T,ya){this.ore=void 0===d?null:d;this.lnd=void 0===z?null:z;this.iBd=void 0===T?null:T;this.EPb=void 0===
ya?0:ya}gQa(){return this.ore()}activate(){return this.lnd()}deactivate(){this.iBd()}dispose(){this.iBd=this.lnd=this.ore=null}}Object(ha.a)(Oj,"FeatureActivator",null,[285,4]);var ol=a(52),ki=a(43);class Pj extends we.a{constructor(d){super(d);this.handler=null;this.swh=()=>{la.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.Ij&16384)}]`);const z=new ie.a;this.$.la.fi(53,Dd=>{la.ULS.sendTraceTag(38410435,0,
50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");z.setResult(Dd)});const T=z.task,ya=new pa,sb=Xa.a.getInstance(),cc=new jb(this.$,sb),Fc=ed.GetServiceTaskFactory.create(this.$.la,203,this.ya,this.xh),Wc=this.vhk(ya),id=Object(Uh.d)(oa.a.resolve(da.ke,{va:this.xh}));return Oa.TaskExtensions.Xa(Oa.TaskExtensions.Vo([T,Fc,Wc,id],this.ya),()=>{la.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
da.xb.Aa()?void oa.a.resolve(da.xb,{va:this.xh}).then(Dd=>{let ee;if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)||ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)){const re=T.result;ee=Ce=>{var mf,tf;return null===(tf=null===(mf=null===re||void 0===re?void 0:re.us)||void 0===mf?void 0:mf.VA)||void 0===tf?void 0:tf.call(mf,Ce)}}else ee=()=>{};this.handler=new Zj(this.$,
Dd,ya,new Jd,sb,cc,Db.a.instance.Ho("Common.IExternalUICommandDefinitionMapping"),ee);la.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Qr([this.handler]);this.$.la.Hh(198,this.handler)}):Oa.TaskExtensions.Xa(ed.GetServiceTaskFactory.create(this.$.la,106,this.ya,this.xh),Dd=>{Dd=Dd.result;let ee;if(ea.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)){const re=T.result;ee=Ce=>
{var mf,tf;return null===(tf=null===(mf=null===re||void 0===re?void 0:re.us)||void 0===mf?void 0:mf.VA)||void 0===tf?void 0:tf.call(mf,Ce)}}else ee=()=>{};this.handler=new Zj(this.$,Dd,ya,new Jd,sb,cc,Db.a.instance.Ho("Common.IExternalUICommandDefinitionMapping"),ee);la.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.Qr([this.handler]);this.$.la.Hh(198,this.handler)},this.ya,3)},this.ya,3)};this.Gbi=()=>{void 0!==this.handler&&null!==this.handler?
(this.$.Ma.gvb(this.handler),this.$.la.Kma(198),this.handler=null):la.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.la.Kma(204);ki.a(ol.a,19,this.$.la,198)}}Kt(){la.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");const d=ua.EwaSettings.Rp("AddinUICommandHandler"),z=d?128:2;zl.a(this.$).add(Object(Bi.a)(new Oj,{ore:()=>{const T=(d?this.$.ea.jn:this.$.ea.bN)&&
this.$.ea.ki&&!!(this.$.Ij&16384)&&this.$.isEditMode;this.$.ea.ki&&la.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${T}] IsSessionFullyLoaded [${this.$.ea.bN}] IsSessionActive [${this.$.ea.ki}] ShowCommandUI [${!!(this.$.Ij&16384)}] IsEditMode [${this.$.isEditMode}] IsAppVisuallyReady [${this.$.ea.jn}]`);return T},lnd:this.swh,iBd:this.Gbi,EPb:z}))}vhk(d){const z=Object(Uh.d)(oa.a.resolve(da.uf,{va:this.xh}));return Oa.TaskExtensions.Xa(z,
()=>{la.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.la.Hh(204,new Tf(z.result,d))},this.ya,3)}static Ba(d){we.a.qy(199,new Pj(d))}}Object(ha.a)(Pj,"AddinUICommandHandlerFactory",we.a,[]);var ak=a(9),Qj=a(428),pl=a(1376),ql=a(1377),bk=a(921);class ck extends Qj.a{constructor(d){super();this.$=d;this.gm()}create(){let d;if(ua.EwaSettings.Ra(355)){const z=da.xb.Aa()?Object(Uh.d)(oa.a.resolve(da.xb,{va:this.xh})):
ed.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,this.xh),T=Object(Uh.d)(oa.a.resolve(da.vd,{va:this.xh}));Oa.TaskExtensions.Xa(jf.Task.yQ(z,T),()=>{this.Bk(Object(bk.a)(this.$.la,278,()=>new pl.CustomFunctionsInstaller(this.$,z.result,T.result)))},this.$.ya,3)}else d=Object(bk.a)(this.$.la,278,()=>new ql.CustomFunctionsLegacyInstaller(this.$)),this.Bk(d)}static Ba(d){d.la.Hh(279,new ck(d))}}Object(ha.a)(ck,"CustomFunctionsInstallerFactory",Qj.a,[]);var rl=a(60),Pk=a(1405),rk=a(1404);class sk extends Qj.a{constructor(d){super();
this.kBg=this.ddaFacade=null;this.$=d;d.la.Hh(106,this);this.gm()}get Ai(){return this.ddaFacade||(this.ddaFacade=new nb.DdaFacade(this.$,this.kBg,this.yk,null))}create(){la.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");ea.AFrameworkApplication.disableWholeAppsForOfficeFeature?la.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${ea.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
ua.EwaSettings.Ra(359)?Db.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(d=>{const z=Db.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");Promise.all([d.isFeatureEnabled("mso_officeStore",!0),z.JR("WACSideloadAddins")]).then(T=>{var [ya,sb]=T;nb.DdaFacade.eMb=ya;nb.DdaFacade.JAe=sb;this.plf();return null},T=>{la.ULS.sendTraceTag(508073758,0,10,`Unsable to fetch office store or add-in sideload enabled flag from OCPS: ${T}.`);
return null})}):this.plf()}plf(){const d=Object(Uh.d)(oa.a.resolve(da.j,{va:this.xh})),z=rl.a.z2d(65,()=>!(void 0===window.OSF||null===window.OSF),this.$.ua.MaxRetriesForLoadingScript,this.$.ya,this.xh,106),T=We.a(this.ya,this.xh),ya=Object(Uh.d)(oa.a.resolve(da.xc,{va:this.xh}));Oa.TaskExtensions.Xa(Oa.TaskExtensions.Vo([d,z,T,ya],this.$.ya),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?la.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${hj.a.tfa()}`):
this.Saj();la.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.kBg=d.result;this.yk=ya.result;this.Bk(this.Ai);la.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ya,3)}Saj(){ua.EwaSettings.Ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new rk.a);this.$.uk.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new rk.a,new Pk.a(ea.AFrameworkApplication.fa.appSettings.WebServiceBase),ua.EwaSettings.Ra(70),
!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new rk.a);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new rk.a)}dispose(){Va.a.dh(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static Ba(d){new sk(d)}}Object(ha.a)(sk,"DdaFacadeServiceFactory",Qj.a,[]);class dk extends we.a{constructor(d){super(d)}Kt(){jd.a(this.$,374,375,this.xh,d=>{const z=[];da.h.Aa()||z.push(new za(this.$,d));da.jg.Aa()||z.push(new Bh(this.$,
d));this.Qr(z)})}static Ba(d){we.a.qy(76,new dk(d))}}Object(ha.a)(dk,"AgaveCommandHandlerFactory",we.a,[]);var tk=a(1453),uj=a(136);class ij{constructor(){this.Ai=null;this.yub=(d,z,T,ya,sb)=>{if(2===T){d=sb?sb:{};z=d.callback;T=d.refresh?d.refresh:!1;if(!z)return 16;ea.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=d.storeType?this.Ai.Myg(z,T,d.storeType):this.Ai.pfe(z,T)}return 32};this.dUc=(d,z,T,ya,sb)=>{if(2===T){d=sb?sb:{};z=d.Observer;
if(!z)return la.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(d)),16;if(!this.Ai||!this.Ai.mU)return la.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(d)),16;this.Ai.mU.OAa(z)}return 32};this.Aik=(d,z,T,ya,sb)=>{2===T&&(d=sb?sb.callback:null)&&this.Ai.PBh(d);return 32};this.pej=(d,z,T,ya,sb)=>{2===T&&this.Ai.zpa(null,
OSF.AgaveHostAction.InsertAgave,sb);return 32}}initialize(d){ij.initialized||(this.Ai=d,this.ho(),ij.initialized=!0)}ho(){ea.AFrameworkApplication.yh.dl(cg.a.yub,uj.a.frame,this.yub,96);ea.AFrameworkApplication.yh.dl(cg.a.dUc,uj.a.frame,this.dUc,96);ea.AFrameworkApplication.yh.Uh(cg.a.khk,uj.a.frame,this.Aik);ea.AFrameworkApplication.yh.dl(cg.a.JVf,uj.a.frame,this.pej,96)}static get instance(){ij.Va||(ij.Va=new ij);return ij.Va}}ij.Va=null;ij.initialized=!1;Object(ha.a)(ij,"AgaveCommandActor",null,
[]);var Oi=a(1520),uk=a(366),vk=a(367);a(1163);var Qk=a(1406),Fj=a(395);class Rk{constructor(){this.uwe=this.s1c=null;this.twe=!1;this.rwe=null;this.UZ=0;this.r1c=null}}Object(ha.a)(Rk,"FirstPartyAddinTaskpaneOverrides",null,[]);class ek{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(ha.a)(ek,"IdeasSelectionContext",null,[]);class wk extends ek{constructor(){super();
this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(ha.a)(wk,"IdeasTableSelectionContext",ek,[]);class Sk{constructor(d,z){this.selection=d;this.tables=z}}Object(ha.a)(Sk,"IdeasXLIMTableBoundaries",null,[]);var sl=a(1119),Gj=a(1559),nh=a(1259),tl=a(154),Bj=a(427),Tk=a(190),fk=a(155);class Uk extends sj.a{constructor(){super();this.k9="calc(100% - 46px)";this.pka="15px";this.l9="0";this.jCb="WACDialogPanel";this.UN=695;this.kCb=462;this.ML=
"80%";this.WAb=350;this.HDa="100%";this.Ph=5;this.kl="AppsForOfficeInsertionDialog";this.ead=!!ea.AFrameworkApplication.fa&&ea.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}oG(){var d;super.oG();this.Wo.style.width=this.HDa;this.Wo.style.height=this.k9;this.Wo.style.marginTop=this.pka;this.Wo.style.padding=this.l9;if(null===(d=ea.AFrameworkApplication.fa)||void 0===d?0:d.isChangeGateEnabled("AddInDialogBugFix"))this.k3.classList.add("AddInDialog"),this.Wo.classList.add("AddInDialog")}KAa(){this.Wo.style.width=
this.HDa;this.Wo.style.height=this.k9;this.Wo.style.marginTop=this.pka;this.Wo.style.padding=this.l9;this.UN>ei.a.Zba?(this.ph.style.width=String.format("{0}px",ei.a.Zba),this.ph.style.overflowX="scroll",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0"):(this.ph.style.width=String.format("{0}px",this.UN),this.ph.style.overflowX="hidden");this.ph.offsetHeight>ei.a.X1||this.kCb+50>ei.a.X1?(this.ph.style.height=String.format("{0}px",ei.a.X1),this.ph.style.overflowY="scroll",
this.ph.style.top="0",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0",this.ead||(this.ph.style.marginTop="-48px"),this.Wo.style.minHeight=String.format("{0}px",this.WAb)):(this.ph.style.overflowY="hidden",this.ph.style.top="10%",this.ph.style.height=this.ML);this.cma()}cma(){if(this.ph){var d=this.ph.style.zIndex;this.ph.style.zIndex="-9999";if(this.UN>ei.a.Zba)ea.AFrameworkApplication.isRtl?this.ph.style.marginRight="0":this.ph.style.marginLeft="0";else{const z=String.format("{0}px",
Math.floor(-this.ph.offsetWidth/2));ea.AFrameworkApplication.isRtl?this.ph.style.marginRight=z:this.ph.style.marginLeft=z;ea.AFrameworkApplication.isRtl?this.ph.style.right="50%":this.ph.style.left="50%"}this.ph.style.zIndex=String(d)}else la.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}oT(){super.oT();const d=document.getElementById(this.ip(this.jCb));d.style.width=String.format("{0}px",this.UN);d.style.height=this.ML}get Lma(){return this.Wo}}Object(ha.a)(Uk,"AppsForOfficeInsertionDialog",
sj.a,[383]);class Vk extends sj.a{constructor(d,z,T){d=void 0===d?!0:d;z=void 0===z?!0:z;T=void 0===T?null:T;super();this.k9="calc(100% - 46px)";this.pka="15px";this.l9="0";this.jCb="WACDialogPanel";this.UN=695;this.kCb=462;this.ML="80%";this.WAb=350;this.HDa="100%";this.uKe=this.mKe=this.zsa=null;this.GKe="auto";this.HKe="5px";this.IKe="auto";this.FKe="40px";this.Jec="100px";this.lCb="200px";this.Ph=5;this.kl="SDXDialog";this.Fgc=d;this.DTb=z;this.Fec=T}oG(){super.oG();this.Wo.style.width=this.HDa;
this.Wo.style.height=this.k9;this.Wo.style.marginTop=this.pka;this.Wo.style.padding=this.l9}KAa(){this.Wo.style.width=this.HDa;this.Wo.style.height=this.Fgc?this.k9:"100%";this.Wo.style.marginTop=this.Fgc?this.pka:"0px";this.Wo.style.padding=this.l9;if(this.Fgc){this.Jec&&this.lCb&&(this.UN=parseInt(this.lCb.substring(0,this.lCb.length-2)),this.ML=this.Jec);this.UN>ei.a.Zba?(this.ph.style.width=String.format("{0}px",ei.a.Zba),this.ph.style.overflowX="scroll",ea.AFrameworkApplication.isRtl?this.ph.style.right=
"0":this.ph.style.left="0"):(this.ph.style.width=String.format("{0}px",this.UN),this.ph.style.overflowX="hidden");if(this.ph.offsetHeight>ei.a.X1||this.kCb+50>ei.a.X1)this.ph.style.height=String.format("{0}px",ei.a.X1),this.ph.style.overflowY="scroll",this.ph.style.top="0",ea.AFrameworkApplication.isRtl?this.ph.style.right="0":this.ph.style.left="0",this.Wo.style.minHeight=String.format("{0}px",this.WAb);else{this.ph.style.overflowY="hidden";const d="%"===this.ML.substring(this.ML.length-1,this.ML.length),
z=d?parseInt(this.ML.substring(0,this.ML.length-1)):parseInt(this.ML.substring(0,this.ML.length-2));this.ph.style.top=d?(100-z)/2+"%":100*(ei.a.X1-z)/ei.a.X1/2+"%";this.ph.style.height=this.ML}this.cma()}else this.ph.style.left=this.GKe,this.ph.style.right=this.HKe,this.ph.style.top=this.IKe,this.ph.style.bottom=this.FKe,this.ph.style.width=this.lCb,this.ph.style.height=this.Jec,this.ph.style.overflowX="hidden",this.ph.style.overflowY="hidden"}cma(){if(this.ph){var d=this.ph.style.zIndex;this.ph.style.zIndex=
"-9999";if(this.UN>ei.a.Zba)ea.AFrameworkApplication.isRtl?this.ph.style.marginRight="0":this.ph.style.marginLeft="0";else{const z=String.format("{0}px",Math.floor(-this.ph.offsetWidth/2));ea.AFrameworkApplication.isRtl?this.ph.style.marginRight=z:this.ph.style.marginLeft=z;ea.AFrameworkApplication.isRtl?this.ph.style.right="50%":this.ph.style.left="50%"}this.ph.style.zIndex=String(d)}else la.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}oT(){super.oT();const d=document.getElementById(this.ip(this.jCb));
d.style.width=String.format("{0}px",this.UN);d.style.height=this.ML}get qha(){return this.Fgc}get Lma(){return this.Wo}get instanceId(){return this.zsa}set instanceId(d){this.zsa=d}get Wuc(){return this.mKe}set Wuc(d){this.mKe=d}get cvc(){return this.uKe}set cvc(d){this.uKe=d}iDk(d,z,T,ya){this.GKe=d;this.HKe=z;this.IKe=T;this.FKe=ya}kDk(d,z){this.Jec=d;this.lCb=z}}Object(ha.a)(Vk,"SDXDialog",sj.a,[]);var jj=a(1117),xk=a(101),Hj=a(269),gk;(function(d){d[d.Valid=2]="Valid";d[d.Invalid=4]="Invalid";
d[d.All=6]="All"})(gk||(gk={}));Object(ha.b)("MetadataState",gk);var ul=a(392),yk=a(923),vl=a(1120);class eg extends si.a{constructor(d,z,T,ya,sb,cc,Fc){super();this.$Pa={};this.tne={};this.AHd={};this.oOa=this.sdxDialog=this.aoa=null;this.HTg=this.Khe=!1;this.FTk=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter",
"InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"]]);this.FOc=()=>{this.oOa=null};this.EAk=Wc=>{const id=this;return Lo(function*(){yield id.Yo.submitCustomMessage(Object.assign(new sl.a,{message:new Gj.a({authToken:Wc})}))})};this.z3i=(Wc,id,Dd,ee,re)=>{if(2!==Dd)return 32;this.zLc(re);return 32};this.eZb=(Wc,id,Dd,ee,re)=>{2===Dd&&(this.olf(),Wc=re.CommandValueId,id=[],id.push(re.SourceControlId),
id.push(Wc),id.push(null),this.Ai.K6f(this.aoa.Lma,id));return 32};this.zLc=Wc=>{var id=Wc[jj.a.APb];Wc=Wc[jj.a.Fpa];var Dd=Wc.Ak[vg.a.tpf];const ee=Wc.Ak[vg.a.ypf],re=Wc.Ak[vg.a.dialogTitle],Ce=Wc.Ak[vg.a.dialogHeight],mf=Wc.Ak[vg.a.dialogWidth],tf=Wc.Ak[vg.a.dialogLeft],Df=Wc.Ak[vg.a.xpf],sf=Wc.Ak[vg.a.dialogTop],$f=Wc.Ak[vg.a.lpf];var pg=Wc.Ak.InstanceToken;pg=null!=pg?pg:(new Be.a(Ib.a.create(),1)).toString();this.sdxDialog=new Vk(Dd,ee);null!=tf&&null!=Df&&null!=sf&&null!=$f&&this.sdxDialog.iDk(tf,
Df,sf,$f);null!=Ce&&null!=mf&&this.sdxDialog.kDk(Ce,mf);this.sdxDialog.instanceId=pg;this.sdxDialog.Wuc=Wc.Ak[vg.a.Wuc];this.sdxDialog.cvc=Wc.Ak[vg.a.cvc];this.sdxDialog.initializeAndShow(re,null,null);Dd={};Dd.div=this.sdxDialog.Lma;Dd.id=pg;Dd.solutionId=id.getId();Dd.version=id.hSa;Dd.storeType=id.getStoreType();Dd.storeId=id.getStoreId();Dd.assetId=null;Dd.assetStoreId=null;Dd.settings=null!=Wc.ex?Wc.ex:{};Dd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Dd.osfControlType=
OSF.OsfControlType.ContainerLevel;Dd.sourceLocationOverrideResourceId=Wc.Ak[vg.a.sourceLocationOverrideResourceId];Dd.featureGates=ea.AFrameworkApplication.fa.QGf(id.getId());Dd.onExtensionLaunchCallback=Wc.Ak[vg.a.onExtensionLaunchCallback];id={};id.InstanceId=Dd.id;id.WebExtensionType=2;id.PrimaryMarketplace={};id.PrimaryMarketplace.SolutionId=Dd.solutionId;id.PrimaryMarketplace.MarketplaceType=Dd.storeType;id.PrimaryMarketplace.MarketplaceRef=Dd.storeId;id.PrimaryMarketplace.SolutionVersion=Dd.version;
id.SrcLocationOverrideResourceId=Dd.sourceLocationOverrideResourceId;id.WebExtensionOsfControlType=6;id.OnExtensionLaunchCallback=Dd.onExtensionLaunchCallback;this.$Pa[Dd.solutionId]=Dd.settings;const {bTc:hg,ZPb:Fg}=this.pNc([],Dd.solutionId);id.OsfPropertyBag=hg;id.HostPropertyBag=Fg;this.Ai.YXa(id);this.Ai.Cl.insertOsfControl(Dd)};this.l5i=(Wc,id,Dd,ee,re)=>{if(2!==Dd)return 32;const Ce=re[jj.a.APb];var mf=re[jj.a.DXa];const tf=re[jj.a.Fpa];if(null!=tf.Ak[vg.a.actionName])return this.iPf(Wc,id,
Dd,ee,re);Wc=new Oi.a;Wc.FFc=tf.Ak.InstanceToken;Wc.Ys=tf.Ak[vg.a.Ys];Wc.uW=tf.Ak[vg.a.uW];vg.a.taskPaneWidth in tf.Ak&&(Wc.taskPaneWidth=tf.Ak[vg.a.taskPaneWidth]);Wc.sourceLocationOverrideResourceId=tf.Ak[vg.a.sourceLocationOverrideResourceId];Wc.onTaskPaneClose=tf.Ak[vg.a.onTaskPaneClose];Wc.onExtensionLaunchCallback=tf.Ak[vg.a.onExtensionLaunchCallback];Wc.showLoadingSpinner=tf.Ak[vg.a.showLoadingSpinner];Wc.JH=tf.ex;Wc.DXa=mf;mf=new tb.a(-859308420,0,2,0,"");id=Ce.getStoreType()===OSF.StoreType.Sdx;
Dd=new nh.a;Dd.Kaa=tf.Ak.HeaderCssClass||dc.a.pPb;Dd.Qyb=tf.Ak.TitleCssClass;this.t8(mf,Ce.getId(),Wc,id,Dd);return 32};this.N4i=(Wc,id,Dd,ee,re)=>{if(2!==Dd)return 32;Wc=re[jj.a.APb].getId();re=re[jj.a.Fpa].Ak[vg.a.sourceLocationOverrideResourceId];return Wc?(this.Ai.Cl.refreshOsfControl(Wc,re),32):8};this.t8j=Wc=>{Wc=Wc.Result;if(Wc=null===Wc?null:Wc.SolutionId)this.Ai.g2e(Wc),sd.a(this.$).yPa(3,Wc)};this.Wvg=(Wc,id)=>{var Dd;const ee=(Wc=Wc.Result)?Wc.AgaveData:null;if(ee){var re=Telemetry.PrivacyRules.GetPrivacyCompliantId(ee.PrimaryMarketplace.SolutionId,
ee.PrimaryMarketplace.MarketplaceType,null===(Dd=null===ee||void 0===ee?void 0:ee.AssetMarketplace)||void 0===Dd?void 0:Dd.SolutionId,null,null,ee.PrimaryMarketplace.MarketplaceRef);la.ULS.shipAssertTag(537170434,0,ee.TaskpaneWidth===eg.qof,`Taskpane width is ${ee.TaskpaneWidth}, assetId is ${re}.`);if(Dd=this.AHd[ee.PrimaryMarketplace.SolutionId])Dd.s1c&&(ee.TaskpaneTitle=Dd.s1c),Dd.uwe&&(ee.TaskpaneTitleTag=Dd.uwe),Dd.twe&&(ee.ShowResizeChatButton=Dd.twe),Dd.r1c&&(ee.TaskpaneIconId=Dd.r1c),Dd.rwe&&
(ee.TaskpaneButtonTooltip=Dd.rwe),0<Dd.UZ&&(ee.TaskpaneWidth=Dd.UZ);id&&(ee.FocusOnIframeWhenLoaded=id.focusOnIframeWhenLoaded,id.width&&(ee.TaskpaneWidth=id.width),ee.TaskpaneIconCssClass=id.Xx,ee.TaskpaneHeaderCssClass=id.Kaa,ee.TaskpaneTitleCssClass=id.Qyb,ee.IsFirstPartyOptOutAppContextOptmization=id.isFirstPartyOptOutAppContextOptmization,ee.ShowLoadingSpinner=id.showLoadingSpinner);if(this.$Pa[ee.PrimaryMarketplace.SolutionId]){const {bTc:Ce,ZPb:mf}=this.pNc(ee.OsfPropertyBag,ee.PrimaryMarketplace.SolutionId);
ee.OsfPropertyBag=Ce;ee.HostPropertyBag=mf}Qd.a(ee)||(ee.WebExtensionOsfControlType=1);ee.OnExtensionLaunchCallback=this.tne[ee.PrimaryMarketplace.SolutionId];ee&&(this.Ai.g2e(Wc.SolutionId),this.Ai.YXa(ee))}else la.ULS.sendTraceTag(593285650,220,50,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.iPf=(Wc,id,Dd,ee,re)=>{if(2!==Dd)return 32;if(rb.a.Im(re))return 8;Wc=re[jj.a.Xhf];if(Wc!==qd.a.action&&Wc!==qd.a.taskpane)return 8;id=re[jj.a.Fpa];return id?
(Wc=(Wc=this.fSi(re))?this.Ai.x5(Wc):null)?(re=this.Ai.N3h(re[jj.a.DXa],id.Ak[vg.a.bnd]),ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Dd=this.Ai.aY(Wc),Dd.TaskpaneTitle!==id.Ak[vg.a.Ys]&&(Dd.TaskpaneTitle=id.Ak[vg.a.Ys],Dd.TaskpaneIconCssClass=id.Ak.IconCssClass,Dd.TaskpaneIconUrl=id.Ak.TaskPaneIconUrl,Dd.TaskpaneIconId=id.Ak.TaskPaneIconId,Dd.OnExtensionLaunchCallback=id.Ak[vg.a.onExtensionLaunchCallback],ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?
(id=this.Ai.Cl,id.changeIframeTitle(Wc,Dd.TaskpaneTitle),Dd=id.getOsfControl(Wc),id.raiseOsfControlStatusChange(Dd)):(id=this.Ai.Cl.getOsfControl(Wc),this.Ai.Cl.raiseOsfControlStatusChange(id)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Wc,re,this.Z6b),32):8:8};this.Z6b=(Wc,id)=>{this.Ai.dxi(Wc,id)};this.hUc=()=>{void oa.a.resolve(da.ug,{va:1}).then(Wc=>{Wc.Caa()})};this.$=d;this.viewBlockContainerHelpers=T;this.Ai=z;this.Qn=sb;this.pGh=cc;this.jMj=Fc;this.Qn.Uh(cg.a.NUg,
uj.a.frame,this.l5i);this.Qn.Uh(cg.a.OIg,uj.a.frame,this.N4i);this.Qn.Uh(cg.a.Txf,uj.a.frame,this.iPf);this.Qn.Uh(cg.a.zLc,uj.a.frame,this.z3i);this.Qn.Uh(cg.a.eZb,uj.a.frame,this.eZb);this.HTg=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Augloop.ShowChatPaneAfterSendToken",!1);this.$.ea.K3e(this.FOc)}MCh(d){this.addHandler(eg.kbe,d)}Umk(d){this.removeHandler(eg.kbe,d)}dispose(){Va.a.dh(this.aoa);this.aoa=null;!ua.EwaSettings.wl()&&this.Khe&&(this.$.ea.Bv(this.hUc),this.Khe=!1);super.dispose()}Lud(){this.aoa&&
this.aoa.hide()}LUk(d,z){var T;if(d){this.raiseEvent(eg.kbe);const ya=d.split("|");this.CAj(d,z,ya);this.olf();this.Ai.K6f(this.aoa.Lma,ya);window[eg.wFh]=null!==(T=this.FTk.get(d))&&void 0!==T?T:"Unknown"}}olf(){const d=z=>{0===z&&(this.Ai.zpa("",OSF.AgaveHostAction.RefreshAddinCommands,{}),Ic.a.sendTelemetryEvent({name:"Office.Extensibility.Host.RefreshAddinsAfterClosingDialog"}))};this.aoa=new Uk;this.aoa.initializeAndShow("",ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8619119_RefreshAddinsAfterClosingDialog")?
d:null,null)}AQd(d,z){var T=Oa.TaskExtensions.Gq();if(-515602470===z.command||-167264441===z.command||-336193495===z.command||-1444574190===z.command)T=this.e3i(d,z);418618014===z.command&&(T=new Oi.a,T.Ys=Yd.a.instance.ia(1823),T=this.t8(z,eg.v7i,T,!0));if((z.tabName===this.$.xi+Qe.a.zJg||z.tabName===Qe.a.K7)&&2===z.jk||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback Tutorials".split(" "),d[wb.a.Qi])||d[wb.a.Qi]===Qe.a.FK)return this.EPf(d,z);if(7===z.jk&&d.SourceControlId===
this.$.xi+Qe.a.FKa)return d.MenuItemId=Qe.a.vge,this.EPf(d,z);1221897806===z.command&&(T=this.rUg(z,"Format"));if(1930653487===z.command||1172793074===z.command)T=this.rUg(z,"Data");-1753056834===z.command&&(T=this.UPk(z));if(932597253===z.command){la.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested");xk.c(932597253,!0);T=new Oi.a;T.Ys=Yd.a.instance.ia(2163);T.sourceLocationOverrideResourceId=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?eg.F8j:eg.H8j;T.focusOnIframeWhenLoaded=!0;T.taskPaneWidth=eg.HTf;var ya={};ya.LaunchSource=Object(wa.a)(String,d.SourceControlId);ya.LaunchMode="Default";T.JH=ya;T=this.t8(z,eg.G8j,T,!0)}301511274===z.command&&(T=this.iQk(z));if(515196233===z.command){T=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8093484_EnableCoauthCheckOnOptimize");if(ya=oa.a.nh(da.te))ya.Sga(),T&&ya.Kdj();ya=new Oi.a;ya.Ys=Yd.a.instance.ia(2237);const sb={};sb.SourceUILocation=uk.a[z.jk];sb.TaskPaneVisualRefreshEnabled=
ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskPaneVisualRefreshEnabled",!1);T&&(sb.SessionID=this.$.ea.sessionId,sb.EnableCoauthCheckOnOptimize=T);ya.JH=sb;T=new nh.a;T.Kaa=dc.a.pPb;T=this.t8(z,eg.M2j,ya,!0,T,void 0,ya.Ys)}1723441034===z.command&&(T=new Oi.a,T.Ys=Yd.a.instance.ia(2249),T.focusOnIframeWhenLoaded=!0,T.taskPaneWidth=eg.Wak,ya=new nh.a,ya.Kaa=dc.a.svf,T=this.t8(z,Hj.e,T,!0,ya));ea.AFrameworkApplication.rba(Hj.a)&&d.LoadDataFromPictureTaskpane&&(T={},ya=new Oi.a,
ya.Ys=Yd.a.instance.ia(2276),T.SessionID=d.SessionID,ya.JH=T,ya.focusOnIframeWhenLoaded=!0,T=this.t8(z,d.DataFromPictureAssetId,ya,!0));762629271===z.command&&(this.M7i(),T=Oa.TaskExtensions.Gq());-1997160483!==z.command&&1485761473!==z.command||!xa.a.hV()||(ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8777768_ColorFillEntryPointTrigger")&&"FillColor"===d.ParentMenuId&&(T="ColorFill"+d.CommandValueId.replace(/(^\w|\s\w)/g,sb=>sb.toUpperCase()).replace(/\s+/g,""),xk.b(T)),T=this.h2i(d,z),xa.a.LVd()&&
this.pGh.addListener());return T}insertAgave(d,z){var T=Oa.TaskExtensions.Gq();const ya=this.$;var sb=d[Hc.a.h$];const cc=d[wb.a.Xk];let Fc=null;nh.a.key in d&&(Fc=d[nh.a.key]);this.aoa&&this.aoa.hide();if(!cc||!sb)return la.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),T;this.$.Eoa&&Qe.a.wja in d&&(cc.EnabledInViewMode=d[Qe.a.wja]);d=this.HHi(z.command);if(!cc.EnabledInViewMode&&!ya.uy(null,!1,d))return T;let Wc=void 0===cc.IsToBePersisted||null===cc.IsToBePersisted||
cc.IsToBePersisted?0:16;if(1===cc.TargetType)T=this.Mej(cc,sb,z,Fc,Wc);else{sb=ca.f(ya);T=this.viewBlockContainerHelpers.J$a(sb);const id=ya.ea.isNamedObjectViewMode?ya.ma.sheetName:ya.ma.name;let Dd,ee,re,Ce;T?(sb=T.fk,Dd=sb.yj.top,ee=sb.yj.left,re=T.HT.x,Ce=T.HT.y):(Dd=ee=1,T=this.viewBlockContainerHelpers.BKa(sb),re=T.x,Ce=T.y);const mf=this.$.pa.ta.Vh();Wc|=64;T=Bj.a(this.$.userOperationManager,(tf,Df,sf)=>{var $f=ya.pa.ta,pg=Dd,hg=ee,Fg=re,Nh=Ce;tf=$d.c(tf,this.t8j);const ch=$f.$a(9,mf);ch.sharedInfo=
cc;ch.sheetName=id;ch.positionRow=pg;ch.positionCol=hg;ch.positionOffsetX=Fg;ch.positionOffsetY=Nh;return tc.h($f,"InsertWebExtension",ch,tf,Df,sf,null,0)},tf=>new Bd.a(534,0,tf,Wc),z)}return T}Y0h(){var d=Db.a.instance.fj("Common.App.ICustomerFeedbackUiWrapper"),z={};ea.AFrameworkApplication.fa.ood(z);d=d.instance.getContext(z);z={};"telemetryGroup"in d&&(z=d.telemetryGroup);z.processSessionId=d.sessionId;z.officeBuild=d.build;d.telemetryGroup=z;d.feedbackType=-1;d.userVoiceEnabled=!1;"disableIncludeScreenshot"in
d||(d.disableIncludeScreenshot=!1);"screenshot"in d||(d.screenshot=!1);d.disableScreenshotPreview=!1;d.includeScreenshotSelectedDefault=!0;return d}uwg(d){if(!this.oOa){var z=this.EMd();z=this.Yaf(z);const T=new nh.a;T.Xx=dc.a.tPb;T.Kaa=dc.a.Bvf;T.Qyb=dc.a.eFd;this.oOa=this.gXc(z,null,!1,null,T);fk.b(this.$).Aj(tl.a.d9j,{["Location"]:d?uk.a[d.jk]:0,["InputMethod"]:d?vk.a[d.method]:0},void 0,!0)}}cPg(d){const z=this.$.ea.Vn.get(17);Db.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(T=>
{T.isFeatureEnabled("mso_sendASmile",z).then(ya=>{d.FeedbackEnabled=z&&ya;return null})})}ymj(){return this.Ai.osj(this.Ai.zJa(eg.D0a,this.EMd()))}onPaneClosed(d){var z;switch(d){case eg.Hsc:null===(z=this.Yo)||void 0===z?void 0:z.unregister("Copilot")}}rUg(d,z){const T=ca.f(this.$),ya=new Oi.a;var sb={};sb.ActiveTab=z;sb.IsRTL=this.$.isChromeRtl;sb.DatapaneFlighting=!0;sb.MergeIvyBiDataSources=!0;sb.ComboChartUIInXLO=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",
!1);sb.ThemeColorsFlighting=!0;sb.FormatTaskPaneUXImprovePhase2=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",!1);sb.ChartTPNewFontAndColorTheme=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",!1);sb.UOMirrorTaskPaneRefactor=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirrorTaskPaneRefactor",!1);sb.DataPaneAddNewField=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataPaneAddNewField",
!1);sb.LineFormatTaskPane=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSLineFormatTaskPane",!1);sb.ChartTaskPaneNewTheme=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneNewTheme",!1);sb.SnowballChartImprovement=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",!1);this.cPg(sb);sb.startTimeMs=Date.now();sb.UserSessionId=this.$.ua.UserSessionId;(z=T.ha.$e.Kp)&&(sb.SubSelection=z);la.ULS.sendTraceTag(592524688,
0,50,`Chart task pane launched. UserSessionId: ${sb.UserSessionId}, UILocation: ${void 0===d.jk||null===d.jk?"Null":uk.a[d.jk]}, SubSelection: ${z||"ChartRoot"}`);ya.JH=sb;ya.Ys=Yd.a.instance.ia(984);sb=new nh.a;sb.Kaa=dc.a.pPb;return this.t8(d,eg.KVh,ya,!0,sb)}UPk(d){const z=new Oi.a;z.JH={};z.Ys=Yd.a.instance.ia(1809);z.uW=eg.m7f;const T=new nh.a;T.Kaa=dc.a.pPb;return this.t8(d,eg.m7f,z,!0,T,void 0,z.Ys)}iQk(d){const z=new Oi.a;z.JH={};z.Ys=Yd.a.instance.ia(2187);const T=new nh.a;T.Kaa=dc.a.lpi;
T.Qyb=dc.a.Evf;const ya=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavPaneWebReadOnly",!1);return this.t8(d,eg.GJj,z,!0,T,ya)}EPf(d,z){const T=eg.y7i;var ya=d[wb.a.Qi].toString();const sb={},cc=new Oi.a;cc.Ys=Yd.a.instance.ia(9);switch(ya){case "A0":sb.query=(d[wb.a.Xk]||"").split("|").slice(2,Fj.a.Z8).join("|");break;case "A1":sb.query=d.CommandValueId;break;case "Help":sb.query="";cc.uW="HelpTaskPane";break;case Qe.a.vge:cc.Ys=Yd.a.instance.ia(1775);cc.sourceLocationOverrideResourceId=
eg.NPd;sb.feedback=this.Y0h();break;case "HelpArticle":sb.query=d[wb.a.Xk];break;case "Tutorials":sb.query=d.CommandValueId;break;case "ContactSupport":sb.query=ya;cc.sourceLocationOverrideResourceId=eg.f1h;cc.Ys=Yd.a.instance.ia(2389);cc.uW="ContactSupportTaskPane";break;case "ShowTraining":case "WhatsNew":sb.query=ya;break;default:return jf.Task.Ua(!0)}cc.JH=sb;ya=new nh.a;ya.Kaa=dc.a.pPb;d=d[Qe.a.wja]||!1;return this.t8(z,T,cc,ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8469439_UseSdxActivationFlow"),
ya,d)}Yaf(d){const z={};z.SolutionId=eg.D0a;z.Version="0.0.0.0";z.StoreType=OSF.StoreType.Sdx;z.StoreId=OSF.StoreType.Sdx;z.AssetId=null;z.AssetStoreId=null;z.Height=0;z.Width=0;z.TargetType=OSF.OsfControlTarget.TaskPane;z.IsToBePersisted=!1;z.SourceLocationOverrideResourceId=d;z.SharedRuntimeId=d;return z}e3i(d,z){const T=new Oi.a,ya=new nh.a,sb={};this.oOa&&this.cPg(sb);sb.LaunchSource="";sb.StartTimeMs=Date.now();sb.CorrelationId=Ib.a.create().toString();T.JH=sb;T.focusOnIframeWhenLoaded=!0;T.taskPaneWidth=
eg.HTf;ya.Kaa=dc.a.Bvf;ya.Qyb=dc.a.eFd;switch(z.command){case -1444574190:let cc,Fc,Wc;sb.LaunchMode="RecommendedPivotTables";sb.SelectionContext="";sb.LaunchSource="PivotTableHandRaise"===Object(wa.a)(String,d.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&d.SourceSelection){const id=d.SourceSelection.split(",")[0],Dd=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?
-1:0;if((()=>{let ee=xb.jb(id,this.$.sa);({sheetName:cc,mAg:Fc,range:Wc}=ee);return ee})().returnValue&&!ca.f(this.$).oh.EY(Wc))d=this.$.sa.getItemByName(cc),sb.SelectionContext=JSON.stringify(Object(Bi.a)(new ek,{address:Fc,addressWithSheet:cc+"!"+Wc.FE(!1),sheetId:ra.d(d),sheetName:cc,isSheetEmpty:!1,columnCount:Wc.width,rowCount:Wc.height,columnIndex:Wc.left+Dd,rowIndex:Wc.top+Dd,selectionType:"Continuous"}));else if((d=this.$.$h.getItemByName(Object(wa.a)(String,d.SourceSelection)))&&ra.m(d)){Wc=
Tk.a(d,!0);const ee=this.$.sa.getItemByName(d.sheetName);sb.SelectionContext=JSON.stringify(Object(Bi.a)(new wk,{tableName:d.name,hasTableHeaders:Tk.d(d),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Wc.FE(!1),addressWithSheet:ee.name+"!"+Wc.FE(!1),sheetId:ra.d(ee),sheetName:ee.name,isSheetEmpty:!1,columnCount:Wc.width,rowCount:Wc.height,columnIndex:Wc.left+Dd,rowIndex:Wc.top+Dd,selectionType:"Continuous"}))}}T.Ys=Yd.a.instance.ia(1821);T.uW=eg.D6j;T.Xx=dc.a.uxf;ya.Xx=dc.a.uxf;break;
case -336193495:sb.LaunchMode="RecommendedCharts";T.Ys=Yd.a.instance.ia(1820);T.uW=eg.Gfk;T.Xx=dc.a.vxf;ya.Xx=dc.a.vxf;break;case -167264441:sb.LaunchMode="ExcelIntelligence";sb.TableName=d.tableName;T.Ys=Yd.a.instance.ia(2287);T.uW=eg.B6e;T.Xx=dc.a.tPb;ya.Xx=dc.a.tPb;break;default:sb.LaunchMode="Default",T.Ys=Yd.a.instance.ia(1822),T.uW=eg.B6e,T.Xx=dc.a.tPb,ya.Xx=dc.a.tPb}T.sourceLocationOverrideResourceId=this.EMd();return this.oOa?this.oOa.lB(()=>this.uzk(sb,T)):this.Ecj(z,T,ya,sb)}M7i(){const d=
this.Ai.x5(eg.Hsc);if(d){const z=this.pYk(d);xa.a.Ut()?void oa.a.resolve(da["if"],{va:0}).then(T=>T.hideTaskPane(z)):void Gf.a.cp().then(T=>{T.hideTaskPane(z,2);return null})}}pYk(d){return eg.qYk+d.replace(/[{}]/g,"")}HRi(){const d=oa.a.nh(da.pe),z=xd.c()&&appChrome.api.isCachedControlVisible(Qe.a.g6a);return void 0!==d?d.FXb:z}cPi(){const d=new Oi.a;d.Ys=appChrome.getCopilotString();let z=!1;ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8583475_CheckAccountTypeForPreviewTag")&&(z="msa"===ea.AFrameworkApplication.fa.Ya("HostAuthType").toLowerCase());
(z?ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitleConsumer",!1):ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitle",!1))||(d.B_g=appChrome.getPreviewTaskPaneHeaderTagString());ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")&&(d.uW=eg.g3h);d.focusOnIframeWhenLoaded=!0;d.taskPaneWidth=eg.qof;return d}dPi(){const d={};d.AudienceGroup=ea.AFrameworkApplication.ii.AudienceGroup;d.StartTimeMs=Date.now();
ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8337949_sendAnnotationsToCopilotOnOpen")&&ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FA000000124.TabularRangeSupportForCopilot",!1)&&(d.TableBoundaries=this.gYi());d.HandoffMessageId=this.$.ua.HandoffMessageId;const z=ua.EwaSettings.getBooleanFeatureGate(yk.a.I4,!1),T=ua.EwaSettings.getBooleanFeatureGate(yk.a.tva,!1);d.CopilotSaveAutomation=z&&this.HRi();d.CopilotSaveRegularScript=T;return d}h2i(d,z){const T=this.cPi();var ya=this.dPi();
ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)&&d.MenuItemId&&(ya.CopilotStartQuery=JSON.stringify(d.MenuItemId));d=vl.a.AIf(this.$,!0,"Copilot",{});const sb={};sb.devProperties=d.ex;sb.optionalProperties=d.Ak;ya.LaunchOfficeScriptsSDXOptionalProperties=JSON.stringify(sb);T.JH=ya;const cc=new nh.a;cc.Kaa=dc.a.svf;const Fc=id=>{id.register(id.J5().n8("Copilot").m8(()=>{la.ULS.sendTraceTag(508347875,0,15,"Copilot AugLoop host received close message")}).activateAnnotation({annotationType:"FakeCopilotAnnotation",
Ny:!1,Hkj:!0}).build())},Wc=()=>this.HTg?Object(Uh.d)(Object(Qk.a)(this.jMj).then(this.EAk.bind(this)).catch(id=>{la.ULS.sendTraceTag(507562076,0,10,`[Copilot Chat] Failed to get and send token. ${id}`)}).then(()=>Object(Uh.a)(this.t8(z,eg.Hsc,T,!0,cc)))):this.t8(z,eg.Hsc,T,!0,cc);if(this.Yo)return Fc(this.Yo),Wc();ya=oa.a.resolve(da.p,{va:1});return Object(Uh.d)(ya.then(id=>{this.Yo=id;Fc(this.Yo);la.ULS.sendTraceTag(508347904,0,15,"Copilot proxy created IAugmentationLoopManager manager");return Object(Uh.a)(Wc())}))}Ecj(d,
z,T,ya){this.oOa=this.gXc(this.Yaf(z.sourceLocationOverrideResourceId),z,!1,d,T,!1);ya.NoActionMsgOnFirstInstance=!0;this.$Pa[eg.D0a]=ya;return this.oOa}uzk(d,z){const T=this.Ai.x5(this.Ai.zJa(eg.D0a,z.sourceLocationOverrideResourceId));if(T){this.$Pa[eg.D0a]=d;const {bTc:ya,ZPb:sb}=this.pNc(this.Ai.aY(T).OsfPropertyBag,eg.D0a);this.Ai.aY(T).OsfPropertyBag=ya;this.Ai.aY(T).HostPropertyBag=sb}this.kza(eg.D0a,qd.a.taskpane,"LaunchIdeasAction",d,"1.0.0.0",z);return jf.Task.Ua(!0)}EMd(){switch(ea.AFrameworkApplication.fa.Ya("SovereignEnvironmentName")){case "USGov":return"Insights.Https.GCC.Bundle";
case "Pathfinder":return"Insights.Https.DOD.Bundle";case "Trailblazer":return"Insights.Https.GCCH.Bundle"}const d=ea.AFrameworkApplication.ii.AudienceGroup;if(ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(d){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(d){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}t8(d,z,T,ya,sb,cc,Fc){T=void 0===
T?null:T;ya=void 0===ya?!1:ya;sb=void 0===sb?null:sb;cc=void 0===cc?!1:cc;Fc=void 0===Fc?null:Fc;Oa.TaskExtensions.Gq();T||(T=new Oi.a);const Wc={};Wc.SolutionId=z;Wc.Version="0.0.0.0";Wc.StoreType=ya?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Wc.StoreId=ya?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Wc.AssetId=null;Wc.AssetStoreId=null;Wc.Height=0;Wc.Width=0;Wc.TargetType=OSF.OsfControlTarget.TaskPane;Wc.IsToBePersisted=!1;Wc.SourceLocationOverrideResourceId=T.sourceLocationOverrideResourceId;if(T.Ys||
Fc)this.AHd[z]=Object(Bi.a)(new Rk,{s1c:T.Ys,uwe:T.B_g,twe:T.showResizeChatButton,rwe:Fc,r1c:T.uW});T.JH||(T.JH={});T.JH.ShowFeedback=this.$.isFeedbackEnabled;this.$Pa[z]=T.JH;this.tne[z]=T.onExtensionLaunchCallback;z={};z[wb.a.Xk]=Wc;Fc={};Fc.solutionId=Wc.SolutionId;Fc.version=Wc.Version;Fc.storeType=Wc.StoreType;Fc.storeId=Wc.StoreId;Fc.assetId=Wc.AssetId;Fc.assetStoreId=Wc.AssetStoreId;Fc.height=Wc.Height;Fc.targetType=Wc.TargetType;Fc.width=Wc.Width;Fc.isAddinCommands=!ya;z[Hc.a.h$]=Fc;sb||(sb=
new nh.a);sb.focusOnIframeWhenLoaded=T.focusOnIframeWhenLoaded;sb.width=T.taskPaneWidth;sb.showLoadingSpinner=T.showLoadingSpinner;z[nh.a.key]=sb;z[Qe.a.wja]=cc;return this.insertAgave(z,d)}Mej(d,z,T,ya,sb){const cc=(Dd,ee)=>{var re=Dd.SolutionId;const Ce=OSF.OsfControl.isFirstPartyStoreString(Dd.StoreType);Ce&&Dd.SourceLocationOverrideResourceId&&(re=this.Ai.zJa(re,Dd.SourceLocationOverrideResourceId));var mf=this.Ai.Hef(re,null,Dd.SharedRuntimeId);if(Ce){if(mf&&(re=this.Ai.x5(re))){const {bTc:tf,
ZPb:Df}=this.pNc(this.Ai.aY(re).OsfPropertyBag,Dd.SolutionId);if(re=this.Ai.Cl.getOsfControl(re))re.setSettings(tf),re.setHostSettings(Df)}Dd.SharedRuntimeId&&mf||this.Ai.Cl.refreshOsfControl(Dd.SolutionId,Dd.SourceLocationOverrideResourceId)}if(!mf){const tf=this.$.pa.ta.Vh();let Df=519;mf=(sf,$f,pg)=>{var hg=this.$.pa.ta;sf=$d.c(sf,this.Wvg);const Fg=hg.$a(9,tf);Fg.sharedInfo=Dd;return tc.h(hg,"InsertAgaveTaskpane",Fg,sf,$f,pg,ya,0)};void 0===Dd.IsToBePersisted||null===Dd.IsToBePersisted||Dd.IsToBePersisted||
(Df=538,mf=(sf,$f,pg)=>{var hg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Dd.SolutionId,Dd.StoreType,Dd.AssetId,null,null,Dd.StoreId);la.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Dd.StoreType}, StoreId ${Dd.StoreId}, SolutionId ${hg}.`);hg=this.$.pa.ta;sf=$d.c(sf,this.Wvg);const Fg=hg.$a(9,void 0===tf?null:tf);Fg.sharedInfo=Dd;return tc.h(hg,"ShowAgaveTaskpane",Fg,sf,$f,pg,ya,0)});sb|=64;return Bj.a(this.$.userOperationManager,mf,sf=>new Bd.a(Df,0,sf,
sb),ee)}return Oa.TaskExtensions.Daa()},Fc=Dd=>{var ee=Telemetry.PrivacyRules.GetPrivacyCompliantId(Dd.solutionId,Dd.storeType,Dd.assetId,null,null,Dd.storeId);la.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${ee} from ${Dd.storeType}.`);ee={};const re=[];re.push(Dd);ee[Hc.a.sIb]=re;ee[Hc.a.f4]=3;Dd=new tb.a(cg.a.rqb,0,this.$.hi,0,null);return this.$.Ma.qh(Dd,ee)};if(!ua.EwaSettings.Ra(52)||d.StoreId===OSF.StoreType.FirstParty)return cc(d,T,ya);if(z.isAddinCommands)return Fc(z);const Wc=
new ie.a,id={};id.solutionId=d.SolutionId;id.version=d.Version;id.storeType=d.StoreType;id.storeId=d.StoreId;id.targetData=d;this.Ai.Cl.isAddinCommandsAsync(id,(Dd,ee,re)=>{Wc.setResult(ee);Dd||(Dd=re.targetData,ee=Telemetry.PrivacyRules.GetPrivacyCompliantId(Dd.SolutionId,Dd.StoreType,Dd.AssetId,null,null,Dd.StoreId),la.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${ee} from ${Dd.StoreType} during addin inserting`))});return Oa.TaskExtensions.ts(Wc.task,Dd=>Dd.result?Fc(z):
cc(d,T,ya),this.$.ya)}pNc(d,z){if(!this.$Pa[z])return{Ttl:d,ZPb:null};const T={},ya={};if(d)for(var sb of d){const [Fc,Wc]=sb;T[Fc]=Wc}d=this.$Pa[z];for(var cc of Object.keys(d))sb=d[cc],cc===eg.Hui?T[cc]=ya[cc]=Sys.Serialization.JavaScriptSerializer.serialize(sb):(!ua.EwaSettings.isChangeGateEnabled("OfficeVSO:8380805_LogsToInvestigateMergeFirstPartySettingsCrash_2")||null!==sb&&void 0!==sb||la.ULS.sendTraceTag(508072652,220,15,"AgaveCommandHandler.mergeFirstPartySettings: value is null or undefined. firstPartySolutionId: "+
z+". key: "+cc+". value is null: "+(null===sb)),T[cc]=ya[cc]=Sys.Serialization.JavaScriptSerializer.serialize(sb.toString()));z=Object.keys(T).map(Fc=>[Fc,T[Fc].toString()]);cc=Object.keys(ya).map(Fc=>[Fc,ya[Fc].toString()]);return{bTc:z,ZPb:cc}}CAj(d,z,T){const ya=this.$.ua.UserSessionId,sb=this.$.ua.UICultureTag,cc=this.$.ua.UICultureTagLcid,Fc=this.$.ua.WacHostId;let Wc="",id="";5<=T.length&&(Wc=T[3],id=T[4]);this.DAj(Wc,id,d,z,sb,cc,ya,Fc)}DAj(d,z,T,ya,sb,cc,Fc,Wc){const id={};id.a=Fc;id.b=T;
id.c=ya;id.d=d;id.e=z;id.f=sb;id.g=cc;id.h=Wc;Ee.b().Ll(36,id)}gXc(d,z,T,ya,sb,cc){z=void 0===z?null:z;T=void 0===T?!1:T;ya=void 0===ya?null:ya;sb=void 0===sb?null:sb;cc=void 0===cc?!0:cc;var Fc=d.SolutionId,Wc=jf.Task.Ua(!1);d&&Fc&&d.SharedRuntimeId&&(ya=ya||new tb.a(-859308420,0,2,0,""),Fc={},Fc.solutionId=d.SolutionId,Fc.version=d.Version,Fc.storeType=d.StoreType,Fc.storeId=d.StoreId,Fc.assetId=d.AssetId,Fc.assetStoreId=d.AssetStoreId,Fc.height=d.Height,Fc.targetType=d.TargetType,Fc.width=0,Fc.isAddinCommands=
!1,Fc.sharedRuntimeId=d.SharedRuntimeId,d.Preload=cc,sb=sb?sb:new nh.a,sb.width=0,z&&(cc=z,sb.focusOnIframeWhenLoaded=cc.focusOnIframeWhenLoaded,Wc=new Rk,cc.Ys&&(Wc.s1c=cc.Ys),0<cc.taskPaneWidth&&(Wc.UZ=cc.taskPaneWidth),cc.uW&&(Wc.r1c=cc.uW),ua.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&cc.JH&&(this.$Pa[d.SolutionId]=z.JH),this.AHd[d.SolutionId]=Wc,this.tne[d.SolutionId]=z.onExtensionLaunchCallback),z={},z[wb.a.Xk]=d,z[Hc.a.h$]=Fc,z[nh.a.key]=sb,z[Qe.a.wja]=T,Wc=
this.insertAgave(z,ya));return Wc}kza(d,z,T,ya,sb,cc){cc=void 0===cc?null:cc;if(d&&T){d=new Nc.a(d,OSF.StoreType.Sdx,OSF.StoreType.Sdx,sb);sb=new je.a("ExcelOnline","Web",this.$.ua.UICultureTag);const Fc=new hd.a;Fc.Ak[vg.a.bnd]=ya;cc&&(ya=cc,ya.sourceLocationOverrideResourceId&&(Fc.Ak[vg.a.sourceLocationOverrideResourceId]=ya.sourceLocationOverrideResourceId),ya.Ys&&(Fc.Ak[vg.a.Ys]=ya.Ys),ya.Xx&&(Fc.Ak.IconCssClass=ya.Xx),ya.owe&&(Fc.Ak.TaskPaneIconUrl=ya.owe),ya.uW&&(Fc.Ak.TaskPaneIconId=ya.uW),
ya.onExtensionLaunchCallback&&(Fc.Ak[vg.a.onExtensionLaunchCallback]=ya.onExtensionLaunchCallback));T&&(Fc.Ak[vg.a.actionName]=T);Ac.a.instance.kza(d,z,T,sb,Fc)}}fSi(d){if(!rb.a.Im(d)){var z=d[jj.a.APb];if(z&&(z=z.getId(),d=d[jj.a.Fpa],z&&d))return this.zJa(z,d.Ak[vg.a.sourceLocationOverrideResourceId])}return null}zJa(d,z){z=void 0===z?null:z;return d&&z?`${d}.${z}`:d}HHi(d){switch(d){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:return 1;case 1723441034:return 1023;case -859308420:return 1023;
case 515196233:return 1023;case 301511274:return 1023;default:return 1}}n2g(){this.$.ea.nm?this.hUc():ua.EwaSettings.wl()?this.$.ea.Yq(this.hUc):(this.$.ea.lr(this.hUc),this.Khe=!0)}gYi(){var d=oa.a.nh(da.ug);if(!d)return this.n2g(),"";d=d.Caa();if(!d)return this.n2g(),"";var z=this.$.sa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.ma.sheetName:this.$.ma.name);z=ra.d(z);var T=ca.f(this.$).ha.qa.selectedRanges;const ya=[];for(const cc of T){T=new ul.a(cc,z);var sb=d.sKa(T,gk.Valid);T=[];if(sb)for(const Fc of sb)(sb=
Fc.table.analyzedRange)&&(sb=sb.range.toString())&&T.push(sb);T=new Sk(cc.toString(),T);ya.push(T)}return JSON.stringify(ya)}}eg.kbe="IDS";eg.y7i="FA000000012";eg.D0a="FA000000005";eg.v7i="HelloWorld";eg.KVh="FA000000014";eg.NPd="Help.GiveFeedback.Url";eg.f1h="Help.ContactSupport.Url";eg.Hui="feedback";eg.m7f="FA000000066";eg.H8j="PowerBi.Url";eg.F8j="PowerBi.DevUrl";eg.G8j="FA000000054";eg.GJj="FA000000064";eg.M2j="FA000000075";eg.B6e="AnalyzeDataTaskPane";eg.Gfk="RecommendedChartsTaskPane";eg.D6j=
"PivotTableTaskPane";eg.HTf=320;eg.Wak=320;eg.g3h="CopilotSDXTaskpane";eg.Hsc="FA000000124";eg.qof=350;eg.qYk="AgaveTaskPane-";eg.wFh="g_InstallOrigin";Object(ha.a)(eg,"AgaveCommandManager",si.a,[370,371]);class zk extends Qj.a{constructor(d){super();this.$=d;this.gm()}create(){const d=this.$.la,z=da.xb.Aa()?Object(Uh.d)(oa.a.resolve(da.xb,{va:this.xh})):ed.GetServiceTaskFactory.create(d,106,this.ya,this.xh),T=ed.GetServiceTaskFactory.create(d,104,this.ya,this.xh),ya=Object(Uh.d)(oa.a.resolve(da.i));
Oa.TaskExtensions.Xa(Oa.TaskExtensions.Vo([T,z,ya],this.ya),()=>{let sb=null;sb=Db.a.instance.fj("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance;ij.instance.initialize(z.result);const cc=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(bk.a)(this.$.la,374,()=>new eg(this.$,z.result,T.result,sb,ea.AFrameworkApplication.yh,ya.result,Db.a.instance.fj("Common.App.OAuth.IOAuthManager"))):new eg(this.$,z.result,T.result,sb,
ea.AFrameworkApplication.yh,ya.result,Db.a.instance.fj("Common.App.OAuth.IOAuthManager"));d.Hh(206,cc);this.Bk(d.kh(374)||d.Hh(374,cc))},this.ya,3);Db.a.instance.register(tk.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").yi().Ei(()=>new tk.a(this.$.pK))}static Ba(d){d.la.Hh(375,new zk(d))}}Object(ha.a)(zk,"AgaveCommandManagerFactory",Qj.a,[]);class hk extends we.a{constructor(d){super(d)}Kt(){const d=da.xb.Aa()?Object(Uh.d)(oa.a.resolve(da.xb,{va:this.xh})):ed.GetServiceTaskFactory.create(this.$.la,
106,this.ya,this.xh),z=Object(Uh.d)(oa.a.resolve(da.ee,{va:this.xh})),T=We.a(this.ya,this.xh),ya=Object(Uh.d)(oa.a.resolve(da.pd,{va:this.xh})),sb=da.Wb.Aa()?Object(Uh.d)(oa.a.resolve(da.Wb,{va:this.xh})):jf.Task.Ua(null);Oa.TaskExtensions.Xa(Oa.TaskExtensions.Vo([d,z,T,ya,sb],this.ya),()=>{const Fc=d.result,Wc=Db.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.Qr([new ff(this.$,Fc,Wc,ya.result,sb.result)])},this.ya,3);const cc=Db.a.instance;da.nd.Aa()?void oa.a.resolve(da.nd,
{va:this.xh}).then(()=>{Db.a.instance.register(pf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").yi().Ei(()=>new pf)}):Oa.TaskExtensions.Xa(ed.GetServiceTaskFactory.create(this.$.la,137,this.$.ya,this.xh),()=>{cc.register(pf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").yi().Ei(()=>new pf)},this.$.ya)}static Ba(d){we.a.qy(82,new hk(d))}}Object(ha.a)(hk,"DdaCommandHandlerFactory",we.a,[]);ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",
!1)||a(1110);(()=>{ak.a.gh(d=>{ua.EwaSettings.Ra(52)&&Pj.Ba(d)})})();(()=>{ak.a.gh(d=>{ua.EwaSettings.Ra(114)&&ck.Ba(d)})})();(()=>{ak.a.gh(d=>{da.xb.Aa()||sk.Ba(d)})})();(()=>{ak.a.gh(d=>{da.h.Aa()&&da.jg.Aa()||dk.Ba(d);zk.Ba(d)})})();(()=>{ak.a.gh(d=>{hk.Ba(d)})})();String(D);String(I);String(X);String(nb);String(Y);String(ja);String(Ua);String(ka);String(pi);window.___1710758652167_closurehack=D;window.___1710758652168_closurehack=I;window.___1710758652168_closurehack=X;window.___1710758652168_closurehack=
nb;window.___1710758652168_closurehack=Y;window.___1710758652168_closurehack=ja;window.___1710758652168_closurehack=Ua;window.___1710758652168_closurehack=ka;window.___1710758652168_closurehack=pi},940:function(A,u,a){a.r(u);a.d(u,"DdaFacade",function(){return Rd});var c=a(0),b=a(2),h=a(15),r=a(1573),f=a(113);class l{constructor(va,Bb,Ac){this._id=va;this.Xgh=Bb;this.cjh=Ac;this.wWf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get xFh(){return this.Xgh}get EZh(){return this.cjh}execute(va,
Bb,Ac){Ac=Ac||{};Ac.commandMode=this.wWf;Bb.invokeAppCommand(this.xFh,this.EZh,Ac,()=>{va.QWj(this.id)})}}Object(c.a)(l,"AddinNativeActionBase",null,[350]);class m extends l{constructor(va,Bb){super(1,va,Bb);this.wWf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(m,"AddinTakeSnapshotAction",l,[]);class x{S3h(va){return new l(3,va,this.aEi().getNativeActionName(3))}aEi(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(x,"AddinNativeActionManager",null,[321]);var n=
a(240);class t{invokeAppCommand(va,Bb,Ac,Nc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(va,Bb,Ac,Nc)}static getInstance(){t.Va||(t.Va=new t);return t.Va}}t.Va=null;Object(c.a)(t,"OSFAddinCommandsRuntimeManager",null,[322]);var w=a(6),v=a(247),k=a(35);class y extends n.a{constructor(va,Bb,Ac){super();this.jla=null;this.Qld="WACDialogTitleText";this.l9="0";this.pka="15px";this.wjh="0px";this.k9="calc(100% - 30px)";this.vjh="100%";this.dWe=0;this.hh=new f.a;this.Zgh=new x;this.Ph=5;this.kl=
this.OSa=Ac;this.K$c=va;this.nKe=Bb;this.ead=!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}ADh(va){this.hh.addHandler("OnDialogClosedEventKey",va)}nFk(){this.RTa=null}oG(){super.oG();this.Wo.style.width="100%";this.Wo.style.height=this.DTb?this.k9:this.vjh;this.Wo.style.marginTop=this.DTb?this.pka:this.wjh;this.Wo.style.padding=this.l9}oT(){super.oT();this.ph.style.width=String.format("{0}px",this.K$c*window.innerWidth/100);this.ph.style.height=
String.format("{0}px",this.nKe*window.innerHeight/100);this.ph.style.minWidth="0px";this.ead&&w.AFrameworkApplication.isRtl&&100===this.K$c&&(this.ph.style.right="0px",this.ph.style.marginRight="0px");this.jla=document.getElementById(this.ip(this.Qld));this.jla.style.position="absolute";this.jla.style.whiteSpace="nowrap";this.jla.style.textOverflow="ellipsis";w.AFrameworkApplication.isRtl?(this.jla.style.right="14px",this.jla.style.left="44px"):(this.jla.style.right="44px",this.jla.style.left="14px")}qL(va){super.qL(va);
this.jla&&this.jla.setAttribute("title",va)}get Lma(){return this.Wo}jle(){this.ph.style.width=String.format("{0}px",this.K$c*window.innerWidth/100);this.ph.style.height=String.format("{0}px",this.nKe*window.innerHeight/100);this.ph.style.overflowY="hidden";this.ph.style.overflowX="hidden";this.ph.style.marginTop="";this.ph.style.top="";k.a.w6&&w.AFrameworkApplication.isRtl?(this.ph.style.right="",this.ph.style.marginRight=""):(this.ph.style.left="",this.ph.style.marginLeft="")}hide(){this.Zgh.S3h(this.OSa).execute(this,
t.getInstance(),{});this.dWe=window.setTimeout(()=>{this.hh.raiseEvent("OnDialogClosedEventKey",this.OSa);v.a.prototype.hide.call(this)},500)}QWj(va){3===va&&(window.clearTimeout(this.dWe),this.hh.raiseEvent("OnDialogClosedEventKey",this.OSa),super.hide())}}Object(c.a)(y,"AppsForOfficeDialog",n.a,[300,301]);class C{constructor(){this.dialog=this.kl=null}}Object(c.a)(C,"DialogInfo",null,[]);class B{}B.url="url";B.height="height";B.width="width";B.ACd="displayInIframe";B.qEc="hideTitle";Object(c.a)(B,
"DialogSettings",null,[]);class E{constructor(){this.height=this.width=0;this.kl=this.controlId=this.pageUrl=null;this.qEc=this.ACd=!1}}Object(c.a)(E,"DisplayDialogParams",null,[]);class K extends Sys.EventArgs{constructor(va,Bb,Ac,Nc,hd){Ac=void 0===Ac?null:Ac;Nc=void 0===Nc?"":Nc;hd=void 0===hd?"":hd;super();this.controlId=va;this.messageType=Bb;this.messageContent=Ac;this.messageOrigin=Nc;this.targetOrigin=hd}}Object(c.a)(K,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class F extends Sys.EventArgs{constructor(va,
Bb,Ac,Nc,hd){Ac=void 0===Ac?null:Ac;Nc=void 0===Nc?"":Nc;hd=void 0===hd?"":hd;super();this.controlId=va;this.messageType=Bb;this.messageContent=Ac;this.messageOrigin=Nc;this.targetOrigin=hd}}Object(c.a)(F,"OnMessageParentEventArgs",Sys.EventArgs,[]);var W=a(47),J=a(33),L=a(189),M=a(106),Q=a(22);class H{constructor(va){this.hh=new f.a;this.MQj=(Bb,Ac)=>{if(Bb=this.h_a(Ac))this.Dr.purgeDialogControl(Ac),H.bka.remove(Bb),this.hh.raiseEvent("OnMessageParentEventKey",new F(Bb,OSF.DialogMessageType.DialogClosed,
null,null,"*"))};this.Dr=va}KDh(va){this.hh.addHandler("OnMessageParentEventKey",va)}JDh(va){this.hh.addHandler("OnMessageDialogEventKey",va)}showDialog(va,Bb,Ac,Nc){if(H.bka.lh(Bb))h.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Ac(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const fd=W.b(va),Qd=fd[B.url];if(this.Dr.getOsfControl(Bb).checkAppDomains(Qd)){var hd=new E;hd.width=fd[B.width];hd.height=fd[B.height];hd.pageUrl=
Qd;hd.ACd=fd[B.ACd];hd.qEc=fd[B.qEc];hd.controlId=Bb;hd.kl=L.a.create().toString();var qd=new C;qd.kl=hd.kl;var je=this.Dr.getOsfControl(hd.controlId).getManifest().getDefaultDisplayName(),Ie=this.Dr.getOsfControl(hd.controlId).getStoreType().toLowerCase();va=null;va=(4===w.AFrameworkApplication.ra.$g.kn&&"hardcodedpreinstall"===Ie||"sdxcatalog"===Ie)&&hd.qEc?this.createAndShowAppsForOfficeDialog(hd.width,hd.height,hd.kl,!0,je):this.createAndShowAppsForOfficeDialog(hd.width,hd.height,hd.kl,!1,je);
var Oe=this.Dr.getOsfControl(hd.controlId),Vb=Oe.getManifest();Bb={};Bb.id=hd.kl;Bb.solutionId=Oe.getSolutionId();Bb.version=Oe.getVersion();Bb.storeType=Ie;Bb.storeId=Oe.getStoreId();Bb.assetId=Oe.getAssetId();Bb.assetStoreId=Oe.getAssetStoreId();Bb.ownerAddinSolutionId=Oe.getOwnerAddinSolutionId();Bb.ownerAddinStoreType=Oe.getOwnerAddinStoreType();Bb.appDomains=Vb.getAppDomains();Bb.dialogUrl=Qd;Bb.osfControlType=1;Bb.agaveName=je;Bb.div=va.Lma;h.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(Bb.solutionId,Bb.ownerAddinStoreType||Bb.storeType,Bb.assetId,null,null,Bb.storeId),J.a.qE(hd.pageUrl));this.Dr.insertDialogControl(Bb);va.ADh(this.MQj);qd.dialog=va;H.bka.ga(hd.controlId,qd);Nc&&Nc(Bb);Ac(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else h.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Ac(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(fd){h.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",
fd.message),Ac(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}wGj(va,Bb,Ac,Nc){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Nc&&(Nc=Ac);try{const hd=this.h_a(va);hd&&this.hh.raiseEvent("OnMessageParentEventKey",new F(hd,OSF.DialogMessageType.DialogMessageReceived,Bb,Ac,Nc))}catch(hd){return h.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",hd.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}oXa(va,
Bb){if(H.bka.lh(va))try{const Ac=H.bka.na(va);Ac.dialog&&Ac.dialog.hide();this.Dr.purgeDialogControl(Ac.kl);H.bka.remove(va);Bb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ac){h.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Ac.message),Bb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else h.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Bb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}cAk(va,
Bb,Ac,Nc){w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Nc&&(Nc=Ac);if(H.bka.lh(va)&&(va=H.bka.na(va),va.dialog))try{this.hh.raiseEvent("OnMessageDialogEventKey",new K(va.kl,OSF.DialogMessageType.DialogParentMessageReceived,Bb,Ac,Nc))}catch(hd){h.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",hd.message)}}h_a(va){let Bb=null;for(const Ac of H.bka)if(Ac.value.kl===va){Bb=Ac.key;
break}return Bb}createAndShowAppsForOfficeDialog(va,Bb,Ac,Nc,hd){va=new y(va,Bb,Ac);hd=Nc?"":String.format(Object(Q.a)("ShowDialogApiInlineDialogTitle"),hd);Nc&&(va.DTb=!1,va.GC=!1);va.initializeAndShow(hd,null,null);va.nFk();return va}static f0i(){return H.bka}static getInstance(va){H.Va||(H.Va=new H(va));return H.Va}}H.Va=null;H.bka=new M.a;Object(c.a)(H,"AppsForOfficeDialogManager",null,[291]);var ba=a(1513),U=a(854),D=a(648),I=a(210),X=a(435),Y=a(1113);class ja{constructor(){this.releaseDate=
this.diffAUP=this.AUP=this.priority=0}}Object(c.a)(ja,"AddinDetailInfo",null,[]);class Ua{constructor(va,Bb){this.failure=null;this.E$=va;this.errorCode=void 0===Bb?0:Bb}}Object(c.a)(Ua,"AddinQueryResult",null,[]);class ka extends Ua{constructor(va,Bb){super(va,void 0===Bb?0:Bb);this.solutionIds=null}}Object(c.a)(ka,"AddinCollection",Ua,[]);var fb;(function(va){va[va.stop=-1]="stop";va[va.skip=0]="skip";va[va.query=1]="query"})(fb||(fb={}));Object(c.b)("QueryStrategy",fb);var ha=a(1046);class ea extends Sys.EventArgs{constructor(va,
Bb,Ac,Nc){Nc=void 0===Nc?null:Nc;super();this.ZL=va;this.errorCode=Bb;this.Ht=Ac;this.failure=Nc}}Object(c.a)(ea,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class aa{constructor(va){this.errorCode=va;this.Ht=[];this.failure=null}}Object(c.a)(aa,"GetAddinDetailsResult",null,[]);var ca=a(928),xa=a(1031);class Oa{}Object(c.a)(Oa,"GetEntitlementDetailsParameters",null,[]);var ua=a(122),Ia=a(231),Sa=a(172);class Ya{constructor(va){this.bIe=432E5;va&&(this.bIe=36E5*va.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutCacheExpiration",
12))}GXi(va){const Bb=new Date;let Ac=new Date(-1);try{const Nc=Ya.T2g(`${va}_ExpirationTime`);Nc&&(Ac=new Date(parseInt(Nc,10)))}catch(Nc){h.ULS.sendTraceTag(508063829,220,50,`Failed to parse expiration time for add-in ${va}: ${Nc}`)}if(Bb.getTime()<Ac.getTime()&&(va=Ya.T2g(`${va}_StoreDisabled`)))return"true"===va}hHk(va,Bb){void 0!==Bb&&null!==Bb&&(Ya.o3g(Bb.toString(),`${va}_StoreDisabled`),Ya.o3g(((new Date).getTime()+this.bIe).toString(),`${va}_ExpirationTime`))}static T2g(va){let Bb=null;try{const Ac=
Ya.J$b;if(void 0!==Ac&&Ac){const Nc=ca.a.flb("Flyout")+"_"+va;Bb=Ac.getItem(Nc)}else h.ULS.sendTraceTag(508063828,220,50,"tryGetCache: Storage.Local null")}catch(Ac){h.ULS.sendTraceTag(508063827,220,10,"tryGetCache: Failed to get data Cache {0} for suffix {1}.","Flyout",va)}return Bb}static o3g(va,Bb){try{const Ac=Ya.J$b;if(void 0!==Ac&&Ac){const Nc=ca.a.flb("Flyout")+"_"+Bb;Ac.setItem(Nc,va)}else h.ULS.sendTraceTag(508063826,220,50,"trySetCache: Storage.Local null")}catch(Ac){h.ULS.sendTraceTag(508063825,
220,10,"trySetCache: Failed to set AddinCommands Cache {0} for suffix {1}.","Flyout",Bb)}}static get J$b(){if(!Ya.Jaa)return null;let va=null;try{va=localStorage}catch(Bb){Ya.Jaa=!1,va=null,h.ULS.sendTraceTag(508063824,220,50,`Failed to use localStorage: error name: ${Bb.name}; message: ${Bb.message}; stack: ${Bb.stack}`)}return va}}Ya.Jaa=!0;Object(c.a)(Ya,"StoreDisabledCache",null,[]);class da{constructor(va,Bb,Ac){Ac=void 0===Ac?null:Ac;var Nc;this.hh=new f.a;this.mD=new U.a(D.a.zm());this.pF=
new X.a;this.g3=0;this.iX=new X.a;this.Xhd=null;this.Isb=(hd,qd,je)=>{if(je)if(this.l3d(hd,je,window.performance.now()-qd),0===je.errorCode){let Ie;if(je.value){let Oe=0;Ie=Array(je.value.length);je.value.forEach(Vb=>{Ie[Oe++]=Vb})}else Ie=[];this.jG(new Ua(hd),Ie)}else-1===je.errorCode||10===je.errorCode?this.jG(new Ua(hd),[]):(hd=this.Ztd(hd,qd,je),this.jG(hd));else hd=da.$td(hd,qd),this.jG(hd)};this.u4a=(hd,qd)=>{if(0!==qd.errorCode)this.pF.ga(qd.ZL,Object.assign(new ka(qd.ZL,qd.errorCode),{failure:qd.failure})),
this.UGj&&this.qca(qd.ZL,1);else{hd=Object.assign(new ka(qd.ZL),{solutionIds:new I.a});var je=qd.Ht;for(const Ie of je)je=Ie.solutionId,this.mD.lh(je)?this.mD.ga(je,this.K5d(this.mD.na(je),qd.ZL,Ie)):this.mD.add(je,Ie),hd.solutionIds.add(je);this.pF.ga(qd.ZL,hd);this.qca(hd.E$,1)}};this.tta=new Ia.a;this.tta.add(OSF.StoreTypeEnum.MarketPlace,0);this.tta.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ga=va;this.Dr=Bb;this.RJ=Ac;this.Ccd=da.vMd(va,"https://store-images.s-microsoft.com");this.UHb(this.u4a);
this.cZe=null!==(Nc=Ac.StoreDisabledCache)&&void 0!==Nc?Nc:new Ya(va)}get UGj(){return!!this.Ga&&this.Ga.isChangeGateEnabled("MissRegisterCollectionTypeFixEnabled")}get JM(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get n3d(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get Tte(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8350408_SingleStoreDisabledQueryEnabled")}get UVk(){return!!this.Ga&&
this.Ga.isChangeGateEnabled("OfficeVSO:8352847_StoreDisabledCacheEnabled")}get isAnonymousUser(){return!!this.Ga&&this.Ga.ka("IsAnonymousUser")}get dId(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get ykb(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get lga(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Cl(){return this.Dr.value}IR(va){if(this.JM&&
!this.lya(va))return new aa(0);if(!this.$0a(va))return va=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Y.a[va]}),Object.assign(new aa(1),{failure:va});if(this.pF.na(va).failure)return Object.assign(new aa(this.pF.na(va).errorCode),{failure:this.pF.na(va).failure});h.ULS.shipAssertTag(509870082,220,!!this.pF.na(va).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",va);const Bb=new aa(0);for(const Ac of this.pF.na(va).solutionIds)this.mD.lh(Ac)&&
Array.add(Bb.Ht,this.mD.na(Ac));return Bb}getUpgradedAddinsOfOmex(){return this.Cl.getUpgradedAddinsOfOmex()}TI(va){return this.mD.lh(va)?this.mD.na(va):null}OAa(va){if(va){this.UHb(va);for(const Bb of this.pF.keys){if(this.JM&&!this.lya(Bb))continue;if(!this.$0a(Bb)||this.pF.na(Bb).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.pF.na(Bb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Bb);const Ac=[],Nc=this.pF.na(Bb);for(const hd of Nc.solutionIds)Array.add(Ac,
this.mD.na(hd));va(null,new ea(Bb,Nc.errorCode,Ac,Nc.failure))}}}get name(){return"AddinDetailsManager1"}Yub(va,Bb){if(this.JM&&da.L2a(va)){var Ac=hd=>{this.jG(da.zWa(hd,4,"The connected service is disabled."));this.qca(hd,-1)},Nc=hd=>{this.jG(da.zWa(hd,0,"The user doesn't have any addin installed."),[]);this.qca(hd,0)};0===va?(this.LUb(0,Bb,Ac,Nc),this.LUb(2,Bb,Ac,()=>{this.a6a(this.Isb)})):10===va&&this.qca(1,1)}}qG(va,Bb){da.L2a(va)?this.nfe(va,this.Isb,void 0===Bb?!1:Bb):h.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",xa.a[va])}UHb(va){this.hh.addHandler(ca.a.mnc,va)}LUb(va,Bb,Ac,Nc){this.lya(va)||(3===Bb&&Ac?Ac(va):2===Bb&&Nc?Nc(va):this.qca(va,1))}lya(va){return this.iX.lh(va)}qca(va,Bb){if(this.JM){var Ac=this.lya(va);if(!Ac||-1!==this.iX.na(va)&&this.iX.na(va)!==Bb)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Y.a[va],Ac?fb[this.iX.na(va)]:"undefined",fb[Bb]),this.iX.ga(va,Bb)}}Ztd(va,Bb,Ac){const Nc=
{};Nc.collectionType=Y.a[va];Nc.invokeResultCode=Ac.errorCode;Nc["queryResult.Value"]=Ac.value?String.format("Length: {0}",Ac.value.length):"null";Nc.queryStart=Bb;Nc.queryDuration=window.performance.now()-Bb;return Object.assign(new Ua(va,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Nc)})}gMk(){return this.$0a(2)?this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.pF.na(2).errorCode:!1:!0}Exb(va){return this.JM&&this.iX.lh(va)?1===
this.iX.na(va):!0}nfe(va,Bb,Ac){Ac=void 0===Ac?!1:Ac;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",va);if(va!==OSF.StoreTypeEnum.MarketPlace&&va!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",va);else{var Nc=this.tta.na(va);(!this.Tte||this.ykb&&this.isAnonymousUser)&&va===OSF.StoreTypeEnum.MarketPlace&&this.Exb(2)&&this.a6a(Bb);this.Exb(Nc)&&(this.ykb&&this.isAnonymousUser?(va=da.Ltd(Nc),this.jG(va)):this.ofe(va,
Bb,Ac))}}ofe(va,Bb,Ac){this.Uyg(va,(Nc,hd)=>{if(Nc===OSF.StoreTypeEnum.MarketPlace&&hd)hd=da.XGa(0),this.jG(hd),this.Tte&&this.jG(da.XGa(2));else if(Nc===OSF.StoreTypeEnum.PrivateCatalog&&hd)hd=da.XGa(1),this.jG(hd);else{this.Tte&&Nc===OSF.StoreTypeEnum.MarketPlace&&this.Exb(2)&&Bb(2,window.performance.now(),this.bJg());var qd=window.performance.now();this.Cl.getEntitlementDetails(Object.assign(new Oa,{storeType:Nc,refresh:Ac}),je=>{Bb(this.tta.na(Nc),qd,je)})}})}a6a(va){this.gMk()&&this.Uyg(0,(Bb,
Ac)=>{Ac?(Bb=da.XGa(2),this.jG(Bb)):(Bb=window.performance.now(),va(2,Bb,this.bJg()))})}jG(va,Bb){Bb=void 0===Bb?null:Bb;0!==va.errorCode?(h.ULS.shipAssertTag(509116673,220,!Bb,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!va.failure,"The result.Failure must not be available for any failed queries"),this.Zre(va)?h.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",Y.a[va.E$],ha.a[va.errorCode],va.failure?va.failure.toString():"null",JSON.stringify(va.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Y.a[va.E$],ha.a[va.errorCode],va.failure?va.failure.toString():"null",JSON.stringify(va.failure))):(h.ULS.shipAssertTag(509116643,220,!!Bb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",
Y.a[va.E$]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",Y.a[va.E$],Bb?Bb.length:-1));va=new ea(va.E$,va.errorCode,Bb,va.failure);this.hh.raiseEvent(ca.a.mnc,va)}Zre(va){return 3===va.errorCode&&(this.ykb&&-2147208619===da.VRb(va)||this.dId&&-2===da.VRb(va))||4===va.errorCode?!1:2!==va.errorCode}$0a(va){return this.pF.lh(va)?!!this.mD:!1}get poc(){return this.RJ?!this.RJ.AreThirdPartyAddInsAllowed||this.RJ.AppsForOfficeThirdPartyIsDisabled:
!this.Ga.ka("AreThirdPartyAddInsAllowed")||this.Ga.ka("AppsForOfficeThirdPartyIsDisabled")}get lIc(){return this.RJ?!this.RJ.AppsForOfficeAllowExternalMarketplace:!this.Ga.ka("AppsForOfficeAllowExternalMarketplace")}get Ptb(){return this.RJ?this.RJ.PopularAddinDetailsJsonString:this.Ga.Ya("PopularAddinDetailsJsonString")}queryStoreDisabled(va,Bb){if(this.poc)Bb(va,!0);else if(va===OSF.StoreTypeEnum.MarketPlace&&this.lIc)Bb(va,!0);else{const Ac=da.V1c(va);if(Ac){const Nc=window.performance.now();this.Cl.queryStoreDisabled(Ac,
hd=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",va,hd,Nc,window.performance.now()-Nc);Bb(va,hd)})}else Bb(va,!1)}}Uyg(va,Bb){if(this.UVk)if(this.poc)Bb(va,!0);else if(va===OSF.StoreTypeEnum.MarketPlace&&this.lIc)Bb(va,!0);else{const Ac=da.V1c(va),Nc=this.cZe.GXi(va);if(void 0===Nc)if(Ac){const hd=window.performance.now();this.Cl.queryStoreDisabled(Ac,qd=>{this.cZe.hHk(va,qd);h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
va,qd,hd,window.performance.now()-hd);Bb(va,void 0!==qd?qd:!0)})}else Bb(va,!1);else Bb(va,Nc)}else this.queryStoreDisabled(va,Bb)}K5d(va,Bb,Ac){return va?Ac?2===Bb?da.w_b(Ac,va):da.w_b(va,Ac):va:Ac}bJg(){if(!this.Xhd){const va=JSON.parse(this.Ptb);this.HHd(va);this.Xhd=va}return da.Apc(0,this.Xhd)}HHd(va){da.nrd(va);this.hoc(va);this.IHd(va)}hoc(va){const Bb=this.Wtd();for(var Ac=0;Ac<va.length&&0<Bb.count;Ac++){const Nc=va[Ac];if(Bb.lh(Nc.solutionId)){let hd=String.format("Found an override, solutionId: {0}",
Nc.solutionId);const qd=Bb.na(Nc.solutionId);qd&&(isNaN(qd.addinInfo.priority)||(hd=String.format("{0}; AddinInfo.Priority: update {1} to {2}",hd,Nc.addinInfo.priority,qd.addinInfo.priority),Nc.addinInfo.priority=qd.addinInfo.priority),isNaN(qd.addinInfo.AUP)||(hd=String.format("{0}; AddinInfo.AUP: update {1} to {2}",hd,Nc.addinInfo.AUP,qd.addinInfo.AUP),Nc.addinInfo.AUP=qd.addinInfo.AUP),qd.displayName&&(hd=String.format("{0}; DisplayName: update {1} to {2}",hd,Nc.displayName,qd.displayName),Nc.displayName=
qd.displayName),qd.iconUrl&&(hd=String.format("{0}; IconUrl: update {1} to {2}",hd,Nc.iconUrl,qd.iconUrl),Nc.iconUrl=qd.iconUrl),qd.description&&(hd=String.format("{0}; Description: update {1} to {2}",hd,Nc.description,qd.description),Nc.description=qd.description));Bb.remove(Nc.solutionId);this.lga&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",hd)}}for(const Nc of Bb.keys)Ac=Bb.na(Nc),Ac.displayName&&Ac.iconUrl&&Ac.addinInfo&&(va.push(Ac),this.lga&&h.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ac)))}Wtd(){const va=new U.a(D.a.zm());let Bb=this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Bb)return va;Bb=Bb.trim();if(12>=Bb.length)return 0<Bb.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Bb),va;this.lga&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
Bb);try{const Ac=[],Nc=Bb.split("|");for(let hd=Nc.length-1;0<=hd;hd--){const qd=Nc[hd],je=qd.split("\\");if(2>je.length){Ac.push(qd);continue}const Ie=da.bce(je);Ie?va.lh(Ie.solutionId)||va.add(Ie.solutionId,Ie):Ac.push(qd)}this.lga&&0<Ac.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ac.join("|"));this.lga&&0<va.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",va.count,JSON.stringify(Sa.toArray(va.values)));
return va}catch(Ac){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Bb,Ac.toString())}return va}IHd(va){for(let Bb=0;Bb<va.length;Bb++)ua.c(va[Bb].iconUrl.toLowerCase(),"http",0)||(va[Bb].iconUrl=String.format("{0}/image/apps.{1}",this.Ccd,va[Bb].iconUrl))}static L2a(va){return 0===va||10===va}static $td(va,Bb){const Ac={};Ac.collectionType=Y.a[va];Ac.queryResult="null";Ac.queryStart=Bb;Ac.queryDuration=window.performance.now()-
Bb;return Object.assign(new Ua(va,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ac)})}static zWa(va,Bb,Ac){const Nc={};Nc.collectionType=Y.a[va];va=new Ua(va,Bb);0!==Bb&&(va.failure=Error.create(Ac,Nc));return va}static XGa(va){return da.zWa(va,2,"The store is disabled.")}static Ltd(va){const Bb={};Bb.collectionType=Y.a[va];Bb.invokeResultCode=-2147208619;Bb.queryDuration=0;return Object.assign(new Ua(va,3),{failure:Error.create("Anonymous users do not have installed add-ins.",
Bb)})}static VRb(va){return va.failure?va.failure.invokeResultCode:-1E3}m3d(va,Bb,Ac){const Nc={};Nc.AddinCollectionType=Y.a[va];Nc.ErrorCode=Bb.errorCode;Nc.AddinCount=Bb.value?Bb.value.length:0;va=window.performance.now();Bb=Date.now()-w.AFrameworkApplication.mR;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Ac,va,Bb,JSON.stringify(Nc))}l3d(va,Bb,Ac){this.n3d?(Ac={["AddinCollectionType"]:Y.a[va],
["ErrorCode"]:Bb.errorCode,["QueryDuration"]:Ac,["FlyoutDataReadySinceBoot"]:Date.now()-w.AFrameworkApplication.mR},this.OWd(va)&&h.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(Ac)),Ac.AddinCount=Bb.value?Bb.value.length:0,h.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(Ac))):this.m3d(va,Bb,Ac)}OWd(va){0===va?this.g3|=1:1===va&&(this.g3|=2);va=this.g3&131;if(va=1===va||2===va)this.g3=255;return va}static Apc(va,Bb){const Ac={};Ac.errorCode=va;Ac.value=Bb;
return Ac}static V1c(va){return va===OSF.StoreTypeEnum.MarketPlace?"omex":va===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static w_b(va,Bb){Bb.solutionId=Bb.solutionId||va.solutionId;Bb.version=Bb.version||va.version;Bb.storeType=Bb.storeType||va.storeType;Bb.storeId=Bb.storeId||va.storeId;Bb.assetId=Bb.assetId||va.assetId;Bb.assetStoreId=Bb.assetStoreId||va.assetStoreId;Bb.displayName=Bb.displayName||va.displayName;Bb.provider=Bb.provider||va.provider;Bb.description=Bb.description||va.description;
Bb.iconUrl=Bb.iconUrl||va.iconUrl;Bb.webApplicationId=Bb.webApplicationId||va.webApplicationId;Bb.highResolutionIconUrl=Bb.highResolutionIconUrl||va.highResolutionIconUrl;Bb.licenseUrl=Bb.licenseUrl||va.licenseUrl;Bb.privacyUrl=Bb.privacyUrl||va.privacyUrl;Bb.addinInfo=Bb.addinInfo||va.addinInfo;isNaN(Bb.targetType)&&(Bb.targetType=va.targetType);isNaN(Bb.height)&&(Bb.height=va.height);isNaN(Bb.width)&&(Bb.width=va.width);return Bb}static nrd(va){for(const Bb of va)isNaN(Bb.targetType)&&(Bb.targetType=
1),Bb.assetId=Bb.assetId||Bb.solutionId,Bb.storeId=Bb.storeId||"en-US",Bb.storeType=Bb.storeType||"omex",Bb.assetStoreId=Bb.assetStoreId||"omex",isNaN(Bb.width)&&(Bb.width=0),isNaN(Bb.height)&&(Bb.height=0)}static bce(va){const Bb={};let Ac=0;Ac<va.length&&0<va[Ac].trim().length&&va[Ac].trim().toLowerCase().startsWith("wa")&&(Bb.solutionId=va[Ac].trim(),Bb.addinInfo=Object.assign(new ja,{priority:Number.NaN,AUP:Number.NaN}),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.addinInfo.priority=parseInt(va[Ac].trim())),
++Ac<va.length&&0<va[Ac].trim().length&&(Bb.addinInfo.AUP=parseInt(va[Ac].trim())),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.displayName=va[Ac].trim()),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.iconUrl=va[Ac].trim()),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.description=va[Ac].trim()));return Bb.solutionId?Bb:null}static vMd(va,Bb){va=va.Ya("AddinImageStoreServiceUrl");if(!va)return Bb;va=va.toLowerCase();return va.startsWith("http://")||va.startsWith("https://")?va:Bb}}Object(c.a)(da,"AddinDetailsManager1",
null,[400,401]);class Ea{constructor(va,Bb){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=va.solutionId;this.version=va.version;this.storeType=va.storeType;this.storeId=va.storeId;this.assetId=va.assetId;this.assetStoreId=va.assetStoreId;
this.displayName=va.displayName;this.provider=va.provider;this.description=va.description;this.targetType=va.targetType;this.height=va.height;this.width=va.width;this.iconUrl=va.iconUrl;this.webApplicationId=va.webApplicationId;this.highResolutionIconUrl=va.highResolutionIconUrl;this.licenseUrl=va.licenseUrl;this.privacyUrl=va.privacyUrl;this.addinInfo=void 0===Bb?null:Bb}S$b(){const va={};va.solutionId=this.solutionId;va.version=this.version;va.storeType=this.storeType;va.storeId=this.storeId;va.assetId=
this.assetId;va.assetStoreId=this.assetStoreId;va.targetType=this.targetType;va.displayName=this.displayName;va.width=this.width;va.height=this.height;return va}}Object(c.a)(Ea,"AddinDetail",null,[]);class oa{constructor(va,Bb,Ac,Nc,hd){this.hkc=null;this.Ga=va;this.Dr=Bb;this.hUa=Ac;this.erh=Nc;this.MBb=hd}qG(va,Bb){this.Cl.queryAppDetails(this.erh,this.MBb,this.solutionIds,va,(Ac,Nc)=>{let hd=null;if(Nc){hd=Array(Nc.length);for(let qd=0;qd<Nc.length;qd++)hd[qd]=new Ea(Nc[qd],this.FCj(Nc[qd].solutionId))}Bb(Ac,
hd||[])})}get Llj(){return!!this.Cl.queryAppDetails}FCj(va){return this.hUa.na(va)}get solutionIds(){if(!this.hkc){this.hkc=new I.a;for(const va of this.hUa.keys)this.hkc.add(ua.d(va))}return this.hkc.toArray()}get Cl(){return this.Dr.value}}Object(c.a)(oa,"AddinDetailsLoader",null,[]);class za{constructor(va,Bb){this.failure=null;this.E$=va;this.errorCode=void 0===Bb?0:Bb}}Object(c.a)(za,"AddinQueryResult",null,[]);class la extends za{constructor(va,Bb){super(va,void 0===Bb?0:Bb);this.sve=this.solutionIds=
null}}Object(c.a)(la,"AddinCollection",za,[]);var Ca=a(908);class Va extends Ca.a{constructor(){super(D.a.zm())}}Object(c.a)(Va,"AddinDetailTable",Ca.a,[]);var ia;(function(va){va[va.stop=-1]="stop";va[va.skip=0]="skip";va[va.query=1]="query"})(ia||(ia={}));Object(c.b)("QueryStrategy",ia);class wa{constructor(va,Bb,Ac){Ac=void 0===Ac?null:Ac;this.hh=new f.a;this.mD=new U.a(D.a.zm());this.pF=new X.a;this.g3=0;this.iX=new X.a;this.hUa=this.H8c=null;this.Isb=(Nc,hd,qd)=>{qd?(this.l3d(Nc,qd,window.performance.now()-
hd),0===qd.errorCode?(hd=qd.value?wa.CHh(qd.value):[],this.jG(new za(Nc),hd)):-1===qd.errorCode||10===qd.errorCode?this.jG(new za(Nc),[]):(Nc=this.Ztd(Nc,hd,qd),this.jG(Nc))):(Nc=wa.$td(Nc,hd),this.jG(Nc))};this.u4a=(Nc,hd)=>{if(0!==hd.errorCode&&5!==hd.errorCode)this.W4g(hd.ZL,Object.assign(new la(hd.ZL,hd.errorCode),{failure:hd.failure}));else{Nc=Object.assign(new la(hd.ZL,hd.errorCode),{solutionIds:new I.a,sve:new I.a});var qd=hd.Ht;for(const Ie of qd){qd=Ie.solutionId;const Oe=Ie.storeId;if(this.mD.lh(qd)){var je=
this.mD.na(qd);je.lh(Oe)?je.ga(Oe,this.K5d(je.na(Oe),hd.ZL,Ie)):je.add(Oe,Ie)}else je=new Va,je.add(Oe,Ie),this.mD.add(qd,je);Nc.solutionIds.add(qd);Nc.sve.add(Oe)}this.W4g(hd.ZL,Nc)}};this.tta=new Ia.a;this.tta.add(OSF.StoreTypeEnum.MarketPlace,0);this.tta.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ga=va;this.Dr=Bb;this.RJ=Ac;this.Ccd=wa.vMd(va,"https://store-images.s-microsoft.com");this.Yhd=null;this.UHb(this.u4a)}get Bpc(){this.H8c||(this.H8c=this.wEf());return this.H8c}wEf(){const va=JSON.parse(this.Ptb);
this.HHd(va);return va.map(Bb=>new Ea(Bb,Bb.addinInfo))}get JM(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get n3d(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get isAnonymousUser(){return!!this.Ga&&this.Ga.ka("IsAnonymousUser")}get dId(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get ykb(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get lga(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Cl(){return this.Dr.value}get Zce(){this.Yhd||(this.Yhd=new oa(this.Ga,this.Dr,this.i7j,0,this.Cl.getAppUILocale()));return this.Yhd}IR(va){if(this.JM&&!this.lya(va))return new aa(0);if(!this.$0a(va))return va=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Y.a[va]}),Object.assign(new aa(1),{failure:va});const Bb=this.pF.na(va);if(Bb.failure)return Object.assign(new aa(Bb.errorCode),{failure:Bb.failure});h.ULS.shipAssertTag(509870082,220,!!Bb.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
va);const Ac=new aa(Bb.errorCode);for(let Nc=0;Nc<Bb.solutionIds.count;Nc++){const hd=Bb.solutionIds.na(Nc),qd=Bb.sve.na(Nc);if(this.mD.lh(hd)){const je=this.mD.na(hd);je.lh(qd)?Array.add(Ac.Ht,je.na(qd)):h.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",hd,va,qd)}else h.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",hd,va)}return Ac}getUpgradedAddinsOfOmex(){return this.Cl.getUpgradedAddinsOfOmex()}TI(va,
Bb){Bb=void 0===Bb?null:Bb;if(va=this.YDi(va))if(Bb||(Bb=this.uiCulture),va.lh(Bb))return va.na(Bb);return null}YDi(va){return this.mD.lh(va)?this.mD.na(va):null}OAa(va){if(va){this.UHb(va);for(const Bb of this.pF.keys){if(this.JM&&!this.lya(Bb))continue;if(!this.$0a(Bb)||this.pF.na(Bb).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.pF.na(Bb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Bb);const Ac=[],Nc=this.pF.na(Bb);for(const hd of Nc.solutionIds)Array.add(Ac,
this.mD.na(hd));va(null,new ea(Bb,Nc.errorCode,Ac,Nc.failure))}}}get name(){return"AddinDetailsManager2"}Yub(va,Bb){if(this.JM&&wa.L2a(va)){var Ac=hd=>{this.jG(wa.zWa(hd,4,"The connected service is disabled."));this.qca(hd,-1)},Nc=hd=>{this.jG(wa.zWa(hd,0,"The user doesn't have any addin installed."),[]);this.qca(hd,0)};0===va?(this.LUb(0,Bb,Ac,Nc),this.LUb(2,Bb,Ac,()=>{this.a6a(this.Isb,this.Bpc)})):10===va&&this.qca(1,1)}}qG(va,Bb){wa.L2a(va)?this.nfe(va,this.Isb,void 0===Bb?!1:Bb):h.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",xa.a[va])}UHb(va){this.hh.addHandler(ca.a.mnc,va)}LUb(va,Bb,Ac,Nc){this.lya(va)||(3===Bb&&Ac?Ac(va):2===Bb&&Nc?Nc(va):this.qca(va,1))}lya(va){return this.iX.lh(va)}qca(va,Bb){if(this.JM){var Ac=this.lya(va);if(!Ac||-1!==this.iX.na(va)&&this.iX.na(va)!==Bb)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Y.a[va],Ac?ia[this.iX.na(va)]:"undefined",ia[Bb]),this.iX.ga(va,Bb)}}Ztd(va,Bb,Ac){const Nc=
{};Nc.collectionType=Y.a[va];Nc.invokeResultCode=Ac.errorCode;Nc["queryResult.Value"]=Ac.value?String.format("Length: {0}",Ac.value.length):"null";Nc.queryStart=Bb;Nc.queryDuration=window.performance.now()-Bb;return Object.assign(new za(va,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Nc)})}hMk(va){if(va!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.Exb(2)){if(!this.$0a(2))return!0;if(this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===
this.pF.na(2).errorCode}return!1}Exb(va){return this.JM&&this.iX.lh(va)?1===this.iX.na(va):!0}nfe(va,Bb,Ac){Ac=void 0===Ac?!1:Ac;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",va);if(va!==OSF.StoreTypeEnum.MarketPlace&&va!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",va);else{var Nc=this.tta.na(va);this.hMk(va)&&this.a6a(Bb,this.P8j);this.Exb(Nc)&&(this.ykb&&this.isAnonymousUser?(va=wa.Ltd(Nc),this.jG(va)):this.ofe(va,
Bb,Ac))}}get P8j(){return this.pF.lh(2)?null:this.Bpc}ofe(va,Bb,Ac){this.queryStoreDisabled(va,(Nc,hd)=>{if(Nc===OSF.StoreTypeEnum.MarketPlace&&hd)hd=wa.XGa(0),this.jG(hd);else if(Nc===OSF.StoreTypeEnum.PrivateCatalog&&hd)hd=wa.XGa(1),this.jG(hd);else{var qd=window.performance.now();this.Cl.getEntitlementDetails(Object.assign(new Oa,{storeType:Nc,refresh:Ac}),je=>{Bb(this.tta.na(Nc),qd,je)})}})}a6a(va,Bb){va=void 0===va?null:va;Bb=void 0===Bb?null:Bb;null===va&&(va=this.Isb);this.queryStoreDisabled(0,
(Ac,Nc)=>{Nc?(Ac=wa.XGa(2),this.jG(Ac)):null!=Bb?this.jG(new za(2,5),Bb):this.ybk(va)})}jG(va,Bb){Bb=void 0===Bb?null:Bb;0!==va.errorCode&&5!==va.errorCode?(h.ULS.shipAssertTag(509116673,220,!Bb,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!va.failure,"The result.Failure must not be available for any failed queries"),this.Zre(va)?h.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",Y.a[va.E$],ha.a[va.errorCode],va.failure?va.failure.toString():"null",JSON.stringify(va.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Y.a[va.E$],ha.a[va.errorCode],va.failure?va.failure.toString():"null",JSON.stringify(va.failure))):(h.ULS.shipAssertTag(509116643,220,!!Bb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",
Y.a[va.E$]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",Y.a[va.E$],Bb?Bb.length:-1,ha.a[va.errorCode]));va=new ea(va.E$,va.errorCode,Bb,va.failure);this.hh.raiseEvent(ca.a.mnc,va)}Zre(va){return 3===va.errorCode&&(this.ykb&&-2147208619===wa.VRb(va)||this.dId&&-2===wa.VRb(va))||4===va.errorCode?!1:2!==va.errorCode}W4g(va,Bb){this.pF.ga(va,Bb);this.qca(va,1)}$0a(va){return this.pF.lh(va)?!!this.mD:!1}get uiCulture(){return this.RJ&&
this.RJ.UICulture?this.RJ.UICulture:w.AFrameworkApplication.uiCulture}get poc(){return this.RJ?!this.RJ.AreThirdPartyAddInsAllowed||this.RJ.AppsForOfficeThirdPartyIsDisabled:!this.Ga.ka("AreThirdPartyAddInsAllowed")||this.Ga.ka("AppsForOfficeThirdPartyIsDisabled")}get lIc(){return this.RJ?!this.RJ.AppsForOfficeAllowExternalMarketplace:!this.Ga.ka("AppsForOfficeAllowExternalMarketplace")}get i7j(){if(!this.hUa){this.hUa=new U.a(D.a.zm());const va=JSON.parse(this.Ptb);for(const Bb of va)this.hUa.add(Bb.solutionId,
Bb.addinInfo)}return this.hUa}get Ptb(){return this.RJ?this.RJ.PopularAddinDetailsJsonString:this.Ga.Ya("PopularAddinDetailsJsonString")}queryStoreDisabled(va,Bb){if(this.poc)Bb(va,!0);else if(va===OSF.StoreTypeEnum.MarketPlace&&this.lIc)Bb(va,!0);else{const Ac=wa.V1c(va);if(Ac){const Nc=window.performance.now();this.Cl.queryStoreDisabled(Ac,hd=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",va,hd,Nc,window.performance.now()-
Nc);Bb(va,hd)})}else Bb(va,!1)}}K5d(va,Bb,Ac){return va?Ac?2===Bb?wa.w_b(Ac,va):wa.w_b(va,Ac):va:Ac}ybk(va){const Bb=(Nc,hd,qd)=>{va(2,qd,wa.Apc(Nc,hd))},Ac=window.performance.now();this.Zce&&this.Zce.Llj?this.Zce.qG(!1,(Nc,hd)=>{this.hoc(hd);va(2,Ac,wa.Apc(Nc,hd))}):Bb(0,this.wEf(),Ac)}HHd(va){wa.nrd(va);this.hoc(va);this.IHd(va)}hoc(va){const Bb=this.Wtd();for(var Ac=0;Ac<va.length&&0<Bb.count;Ac++){const Nc=va[Ac];if(Bb.lh(Nc.solutionId)){let hd=String.format("Found an override, solutionId: {0}",
Nc.solutionId);const qd=Bb.na(Nc.solutionId);qd&&(isNaN(qd.addinInfo.priority)||(hd=String.format("{0}; AddinInfo.Priority: update {1} to {2}",hd,Nc.addinInfo.priority,qd.addinInfo.priority),Nc.addinInfo.priority=qd.addinInfo.priority),isNaN(qd.addinInfo.AUP)||(hd=String.format("{0}; AddinInfo.AUP: update {1} to {2}",hd,Nc.addinInfo.AUP,qd.addinInfo.AUP),Nc.addinInfo.AUP=qd.addinInfo.AUP),qd.displayName&&(hd=String.format("{0}; DisplayName: update {1} to {2}",hd,Nc.displayName,qd.displayName),Nc.displayName=
qd.displayName),qd.iconUrl&&(hd=String.format("{0}; IconUrl: update {1} to {2}",hd,Nc.iconUrl,qd.iconUrl),Nc.iconUrl=qd.iconUrl),qd.description&&(hd=String.format("{0}; Description: update {1} to {2}",hd,Nc.description,qd.description),Nc.description=qd.description));Bb.remove(Nc.solutionId);this.lga&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",hd)}}for(const Nc of Bb.keys)Ac=Bb.na(Nc),Ac.displayName&&Ac.iconUrl&&Ac.addinInfo&&(va.push(Ac),this.lga&&h.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ac)))}Wtd(){const va=new U.a(D.a.zm());let Bb=this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!Bb)return va;Bb=Bb.trim();if(12>=Bb.length)return 0<Bb.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",Bb),va;this.lga&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
Bb);try{const Ac=[],Nc=Bb.split("|");for(let hd=Nc.length-1;0<=hd;hd--){const qd=Nc[hd],je=qd.split("\\");if(2>je.length){Ac.push(qd);continue}const Ie=wa.bce(je);Ie?va.lh(Ie.solutionId)||va.add(Ie.solutionId,Ie):Ac.push(qd)}this.lga&&0<Ac.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ac.join("|"));this.lga&&0<va.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",va.count,JSON.stringify(Sa.toArray(va.values)));
return va}catch(Ac){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",Bb,Ac.toString())}return va}IHd(va){for(let Bb=0;Bb<va.length;Bb++)ua.c(va[Bb].iconUrl.toLowerCase(),"http",0)||(va[Bb].iconUrl=String.format("{0}/image/apps.{1}",this.Ccd,va[Bb].iconUrl))}static L2a(va){return 0===va||10===va}static $td(va,Bb){const Ac={};Ac.collectionType=Y.a[va];Ac.queryResult="null";Ac.queryStart=Bb;Ac.queryDuration=window.performance.now()-
Bb;return Object.assign(new za(va,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ac)})}static zWa(va,Bb,Ac){const Nc={};Nc.collectionType=Y.a[va];va=new za(va,Bb);0!==Bb&&(va.failure=Error.create(Ac,Nc));return va}static XGa(va){return wa.zWa(va,2,"The store is disabled.")}static Ltd(va){const Bb={};Bb.collectionType=Y.a[va];Bb.invokeResultCode=-2147208619;Bb.queryDuration=0;return Object.assign(new za(va,3),{failure:Error.create("Anonymous users do not have installed add-ins.",
Bb)})}static VRb(va){return va.failure?va.failure.invokeResultCode:-1E3}m3d(va,Bb,Ac){const Nc={};Nc.AddinCollectionType=Y.a[va];Nc.ErrorCode=Bb.errorCode;Nc.AddinCount=Bb.value?Bb.value.length:0;va=window.performance.now();Bb=Date.now()-w.AFrameworkApplication.mR;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Ac,va,Bb,JSON.stringify(Nc))}l3d(va,Bb,Ac){this.n3d?(Ac={["AddinCollectionType"]:Y.a[va],
["ErrorCode"]:Bb.errorCode,["QueryDuration"]:Ac,["FlyoutDataReadySinceBoot"]:Date.now()-w.AFrameworkApplication.mR},this.OWd(va)&&h.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(Ac)),Ac.AddinCount=Bb.value?Bb.value.length:0,h.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(Ac))):this.m3d(va,Bb,Ac)}OWd(va){0===va?this.g3|=1:1===va&&(this.g3|=2);va=this.g3&131;if(va=1===va||2===va)this.g3=255;return va}static Apc(va,Bb){const Ac={};Ac.errorCode=va;Ac.value=Bb;
return Ac}static V1c(va){return va===OSF.StoreTypeEnum.MarketPlace?"omex":va===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static w_b(va,Bb){Bb.solutionId=Bb.solutionId||va.solutionId;Bb.version=Bb.version||va.version;Bb.storeType=Bb.storeType||va.storeType;Bb.storeId=Bb.storeId||va.storeId;Bb.assetId=Bb.assetId||va.assetId;Bb.assetStoreId=Bb.assetStoreId||va.assetStoreId;Bb.displayName=Bb.displayName||va.displayName;Bb.provider=Bb.provider||va.provider;Bb.description=Bb.description||va.description;
Bb.iconUrl=Bb.iconUrl||va.iconUrl;Bb.webApplicationId=Bb.webApplicationId||va.webApplicationId;Bb.highResolutionIconUrl=Bb.highResolutionIconUrl||va.highResolutionIconUrl;Bb.licenseUrl=Bb.licenseUrl||va.licenseUrl;Bb.privacyUrl=Bb.privacyUrl||va.privacyUrl;Bb.addinInfo=Bb.addinInfo||va.addinInfo;isNaN(Bb.targetType)&&(Bb.targetType=va.targetType);isNaN(Bb.height)&&(Bb.height=va.height);isNaN(Bb.width)&&(Bb.width=va.width);return Bb}static CHh(va){const Bb=Array(va.length);for(let Ac=0;Ac<Bb.length;Ac++)Bb[Ac]=
new Ea(va[Ac],va[Ac].addinInfo);return Bb}static nrd(va){for(const Bb of va)isNaN(Bb.targetType)&&(Bb.targetType=1),Bb.assetId=Bb.assetId||Bb.solutionId,Bb.storeId=Bb.storeId||"en-US",Bb.storeType=Bb.storeType||"omex",Bb.assetStoreId=Bb.assetStoreId||"omex",isNaN(Bb.width)&&(Bb.width=0),isNaN(Bb.height)&&(Bb.height=0)}static bce(va){const Bb={};let Ac=0;Ac<va.length&&0<va[Ac].trim().length&&va[Ac].trim().toLowerCase().startsWith("wa")&&(Bb.solutionId=va[Ac].trim(),Bb.addinInfo=Object.assign(new ja,
{priority:Number.NaN,AUP:Number.NaN}),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.addinInfo.priority=parseInt(va[Ac].trim())),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.addinInfo.AUP=parseInt(va[Ac].trim())),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.displayName=va[Ac].trim()),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.iconUrl=va[Ac].trim()),++Ac<va.length&&0<va[Ac].trim().length&&(Bb.description=va[Ac].trim()));return Bb.solutionId?Bb:null}static vMd(va,Bb){va=va.Ya("AddinImageStoreServiceUrl");
if(!va)return Bb;va=va.toLowerCase();return va.startsWith("http://")||va.startsWith("https://")?va:Bb}}Object(c.a)(wa,"AddinDetailsManager2",null,[399]);class Jb{constructor(va,Bb){this.Qtb="popular";this.n5e="addinDetails";this.Ybf="cache-lastUpdate";this.qbf="builtin-lastUpdate";this.qvg=144E5;this.Ga=this.MT=null;this.iNj=(Ac,Nc)=>{2===Nc.ZL&&0===Nc.errorCode&&(this.uud=Nc.Ht,this.Qpc=this.now,h.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};
this.MT=Bb;this.Ga=va;this.MT.OAa(this.iNj);this.qvg=this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",144E5)}get epj(){return this.Qpc?this.now.getTime()-this.Qpc.getTime()>=this.qvg:!0}IR(va){var Bb=this.MT.IR(va);2===va&&this.dpj(Bb.errorCode)&&(va=this.uud,null!=va?(this.epj&&this.MT.a6a(null,null),Bb=this.toDateString(this.now),Bb=this.toDateString(this.dud)===Bb?this.Jtd(5,this.MT.Bpc):this.Jtd(0,va)):(Jb.Jaa&&(Bb=this.Jtd(5,this.MT.Bpc)),this.dud=this.now,
this.MT.a6a(null,null)));return Bb}Jtd(va,Bb){var Ac=void 0===Ac?null:Ac;return Object.assign(new aa(va),{Ht:Bb,failure:Ac})}toDateString(va){return va.toISOString().substring(2,16)}get dud(){const va=Jb.c$a(this.Qtb,this.qbf);return null!==va?new Date(va):new Date(0)}set dud(va){Jb.dRa(this.Qtb,va.toISOString(),this.qbf)}get Qpc(){const va=Jb.c$a(this.Qtb,this.Ybf);return null!==va?new Date(va):new Date(0)}set Qpc(va){Jb.dRa(this.Qtb,va.toISOString(),this.Ybf)}get uud(){const va=Jb.c$a(this.Qtb,
this.n5e);let Bb=null;va&&(Bb=JSON.parse(va));return Bb}set uud(va){va=JSON.stringify(va);Jb.dRa(this.Qtb,va,this.n5e)}get now(){return new Date}dpj(va){return 2!==va&&4!==va}TI(va,Bb){return this.MT.TI(va,void 0===Bb?null:Bb)}getUpgradedAddinsOfOmex(){return this.MT.getUpgradedAddinsOfOmex()}OAa(va){this.MT.OAa(va)}get name(){return"AddinDetailsCacheManager"}Yub(va,Bb){this.MT.Yub(va,Bb)}qG(va,Bb){this.MT.qG(va,void 0===Bb?!1:Bb)}static c$a(va,Bb){let Ac=null;try{const Nc=Jb.J$b;if(void 0!==Nc&&
Nc){const hd=ca.a.flb(va)+"_"+Bb;Ac=Nc.getItem(hd)}else h.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(Nc){h.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",va,Bb)}return Ac}static dRa(va,Bb,Ac){try{const Nc=Jb.J$b;if(void 0!==Nc&&Nc){const hd=ca.a.flb(va)+"_"+Ac;Nc.setItem(hd,Bb)}else h.ULS.sendTraceTag(508352217,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(Nc){h.ULS.sendTraceTag(508352216,
220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",va,Ac)}}static get J$b(){if(!Jb.Jaa)return null;let va=null;try{va=localStorage}catch(Bb){Jb.Jaa=!1,va=null,h.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${Bb.name}; message: ${Bb.message}; stack: ${Bb.stack}`)}return va}}Jb.Jaa=!0;Object(c.a)(Jb,"AddinDetailsCacheManager",null,[400]);class $a{static createInstance(va,Bb,Ac){Ac=void 0===Ac?null:Ac;va=$a.qFh(va)?new Jb(va,new wa(va,Bb,Ac)):new da(va,Bb,Ac);
h.ULS.sendTraceTag(508352212,220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${va.name}`);return va}static qFh(va){return(va||w.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(c.a)($a,"AddinDetailsManagerFactory",null,[]);var Ka=a(1048),nb=a(605),sa=a(1452),na=a(1558),ab=a(1162),Ja=a(42),Pa=a(182),hb=a(1453),ac=a(138),Hc=a(181),bd=a(126),zc=a(94),oc=a(768),Nb=a(153),Aa=a(355),Ub=a(142),Db=a(598),
Ib=a(183),yc=a(40),xc=a(1114),zb=a(1388),vb=a(1118),bb=a(78);class La{constructor(){this.command=0;this.properties=null}}Object(c.a)(La,"DdaRequestInfo",null,[]);var pb=a(947),fa=a(65);class kb extends bb.a{constructor(va,Bb){super();this.requests=[];this.disposed=this.zqc=!1;this.Rl=()=>{if(!this.disposed){this.grid.Fh.Lw(this.Rl);this.zqc=!1;const Ac=this.requests;this.requests=[];for(const Nc of Ac)this.ddaFacade.aV(Nc.command,Nc.properties)}};this.ddaFacade=va;this.grid=Bb}Sci(va,Bb){this.disposed||
(this.zqc||(this.grid.Fh.Jx(this.Rl),this.zqc=!0),this.requests.push(Object(b.a)(new La,{command:va,properties:Bb})))}dispose(){if(!this.disposed){this.disposed=!0;this.zqc&&this.grid.Fh.Lw(this.Rl);var va=this.requests;this.requests=null;for(const Bb of va)(va=Bb.properties?Bb.properties[fa.a.Gfa]:null)&&this.ddaFacade.lo(pb.a.fVb,va);this.ddaFacade=this.grid=null;super.dispose()}}static HZh(va,Bb){var Ac=!1;974713501===va&&(Bb=(va=Bb?Bb[fa.a.Xk]:null)?va.DdaMethod:null)&&Bb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(Ac=va.ArrayData,Ac=!!Ac&&64===(Ac[6]&64));return Ac}}Object(c.a)(kb,"DdaCellEditDelayRequestHandler",bb.a,[]);var db=a(985);class gb extends db.a{constructor(va,Bb,Ac,Nc,hd,qd,je){super(va,Bb,Ac);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Nc;this.messageContent=hd;this.messageOrigin=qd;this.targetOrigin=je}}Object(c.a)(gb,"DialogMessageReceivedEventArgs",db.a,[]);class Kb extends db.a{constructor(va,Bb,Ac,Nc,hd,qd,je){super(va,Bb,Ac);this.messageType=
0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Nc;this.messageContent=hd;this.messageOrigin=qd;this.targetOrigin=je}}Object(c.a)(Kb,"DialogParentMessageReceivedEventArgs",db.a,[]);var ub=a(1),lb=a(23);class Ba{constructor(va){this.Cl=this.trd=null;this.FWj=(Bb,Ac)=>{this.handlers.lh(Ac.controlId)&&(Bb=new gb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Ac.controlId,null,Ac.messageType,Ac.messageContent,Ac.messageOrigin,Ac.targetOrigin),this.handlers.na(Ac.controlId)(Bb),
Ac.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(Ac.controlId))};this.EWj=(Bb,Ac)=>{this.rNc.lh(Ac.controlId)&&(Bb=new Kb(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Ac.controlId,null,Ac.messageType,Ac.messageContent,Ac.messageOrigin,Ac.targetOrigin),this.rNc.na(Ac.controlId)(Bb))};this.handlers=new M.a;this.rNc=new M.a;this.jq=va;this.Oib.KDh(this.FWj);this.Oib.JDh(this.EWj)}get Oib(){this.trd||(this.trd=H.getInstance(this.contextActivationMgr));return this.trd}get contextActivationMgr(){!this.Cl&&
this.jq&&(this.Cl=this.jq.Cl);return this.Cl}addHandler(va,Bb,Ac,Nc){h.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const hd=qd=>{qd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ga(va,Bb),this.jq.zE(Ac)):(h.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.jq.lo(qd,Ac))};this.handlers.lh(va)?hd(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(va,Nc,hd)}Lyh(va,Bb,Ac){h.ULS.sendTraceTag(537170500,
0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!");this.rNc.ga(va,Bb);this.jq.zE(Ac)}removeHandler(va,Bb){this.handlers.lh(va)?(h.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Oib.oXa(va,Ac=>{this.handlers.remove(va);Ac===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.jq.zE(Bb):(h.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.jq.lo(Ac,Bb))})):this.jq.lo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Bb)}Mkk(va,Bb){h.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");this.rNc.remove(va);this.jq.zE(Bb)}showDialog(va,Bb,Ac){try{ub.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&lb.f(this.jq.$).isEditing&&lb.f(this.jq.$).Tz(!0),this.Oib.showDialog(Bb,va,Ac,Nc=>{this.jq.ezh(this.FQh(Nc))})}catch(Nc){h.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Nc.message}`),Ac(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}FQh(va){const Bb=
{};Bb.InstanceId=va.id;Bb.WebExtensionType=va.osfControlType===OSF.OsfControlTarget.InContent?0:1;Bb.PrimaryMarketplace={};Bb.PrimaryMarketplace.SolutionId=va.solutionId;Bb.PrimaryMarketplace.SolutionVersion=va.version;Bb.PrimaryMarketplace.MarketplaceRef=va.storeId;Bb.PrimaryMarketplace.MarketplaceType=va.storeType;Bb.OwnerAddinSolutionId=va.ownerAddinSolutionId;Bb.OwnerAddinStoreType=va.ownerAddinStoreType;return Bb}static Ba(va){if(!va.$.la.kh(232)){const Bb=new Ba(va);va.$.la.Hh(232,Bb)}}}Object(c.a)(Ba,
"DialogMessageReceivedEventManager",null,[368]);class ra{constructor(va,Bb){this.uK=null;this.qsa=va;this.auh=Bb}Rmc(va){va&&(this.uK||(this.uK=[]),this.uK.push(va))}fVc(va){this.uK&&Array.remove(this.uK,va)}get eventId(){return this.qsa}get targetId(){return this.auh}get s6i(){return 0<this.uK.length}MEj(va){return this.eventId!==va.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===va.ddaBinding.Name:
!0}dqc(va){this.uK&&Array.forEach(this.uK,Bb=>{Bb(va)})}VOa(){this.uK=[]}}Object(c.a)(ra,"DdaEventRegistration",null,[]);class wb{constructor(va){this.VO=null;this.aLa=!1;this.Jj=()=>{this.VO.forEach(Bb=>{Bb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Bb.dqc(new db.a(Bb.eventId,"",null))})};this.jq=va}invokeDdaMethod(va,Bb){const Ac={};Ac[fa.a.Xk]=va;Ac[fa.a.Gfa]=Bb;this.jq.aV(974713501,Ac)}registerDdaEventAsync(va,Bb,Ac,Nc,hd){wb.hWb(va)?(wb.VVd(va)&&this.fSd(),this.VO||(this.VO=
[]),Bb=this.SPb(va,Ac),Bb||(Bb=new ra(va,Ac),this.VO.push(Bb)),Bb.Rmc(Nc),this.jq.zE(hd)):this.jq.lo(-1,hd)}unregisterDdaEventAsync(va,Bb,Ac,Nc,hd){wb.hWb(va)?((va=this.SPb(va,Ac))&&va.fVc(Nc),this.jq.zE(hd)):this.jq.lo(-1,hd)}fSd(){this.aLa||(lb.f(this.jq.$).ha.g$(this.Jj),this.aLa=!0)}SPb(va,Bb){if(!this.VO)return null;for(let Ac=0;Ac<this.VO.length;Ac++){const Nc=this.VO[Ac];if(Nc.eventId===va&&Nc.targetId===Bb)return Nc}return null}static hWb(va){return va===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static VVd(va){return va===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(wb,"EmbeddingPage",null,[275]);var mc=a(233);class xb extends db.a{constructor(va,Bb,Ac,Nc,hd,qd,je,Ie){super(va,Bb,Ac);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=qd-Nc.Reference.FirstColumn;this.columnCount=Ie;va=Math.max(hd,Nc.Reference.FirstRow);hd=Math.min(hd+je-1,Nc.Reference.LastRow);va>hd?this.startRow=this.rowCount=void 0:(this.startRow=va-Nc.Reference.FirstRow,this.rowCount=hd-va+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}
Object(c.a)(xb,"DdaBindingSelectionEventArgs",db.a,[]);var Ec=a(212),ed=a(27),jd=a(46),Xd=a(486),Td=a(39),gc=a(662),nc=a(322),dc=a(60),Gc=a(83),vd=a(16),zd=a(13),Yb=a(103),Pb=a(91),$c=a(95),wd=a(5),Bd=a(358),tc=a(216),Zc=a(427);a(1110);class Ab extends mc.a{constructor(va,Bb,Ac,Nc,hd){hd=void 0===hd?!1:hd;super();this.Iwb=0;this.VO=null;this.aLa=!1;this.NSc=null;this.b5=0;this.guc=this.Vab=this.QJe=this.sHe=null;this.Egc=this.vPe=!1;this.hhd=this.xqa=this.jCe=null;this.Jj=()=>{this.enabled&&(this.tAk(),
this.NSc=jd.d(lb.f(this.$).ha.qa.selectedRanges))};this.XOf=qd=>{qd.controlId===this.Kj.InstanceId&&Array.forEach(this.VO,je=>{je.MEj(qd)&&je.dqc(qd)})};this.Tgg=qd=>{qd=Object(Nb.a)(270,qd);if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:8220021_ExcludingMisMatchingPaneAndData")&&null!=(null===qd||void 0===qd?void 0:qd.Xm)&&(null===qd||void 0===qd?void 0:qd.Xm.InstanceId)!==this.Kj.InstanceId)h.ULS.sendTraceTag(508302915,220,15,"InstanceIds mismatching for webExtensionPane and webExtensionData.");
else if(qd&&!qd.q6())if(!this.Kj||OSF.OsfControl.isFirstPartyStoreString(this.Kj.PrimaryMarketplace.MarketplaceType)||this.$.m4){qd.Xm=this.Kj;qd.xt=this.jq;this.jCe=qd;this.NYc(qd.AIb);const je=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&zd.HelperMethods.XF(this.Kj)&&this.Kj.Preload&&!this.Kj.TaskpaneVisible;je?qd.q$d():ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(qd.q$d(),(this.Kj.SharedRuntime&&1===this.Kj.SharedRuntime.LifeTime||
this.Kj.SharedRuntimeId)&&!this.Kj.TaskpaneVisible&&qd.eF(!1)):((this.Kj.SharedRuntime&&1===this.Kj.SharedRuntime.LifeTime||this.Kj.SharedRuntimeId)&&!this.Kj.TaskpaneVisible&&qd.eF(!1),qd.q$d());this.Fnb||je||qd.PS();this.$.la.kh(77).OEg(this.Tgg);this.Kla=Object(Nb.a)(366,qd)}else h.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(qd,je)=>{3===je.control.floatingObject.type&&je.control.floatingObject.io.InstanceId===this.sda.WebExtensionId&&
(this.Kla=Object(Nb.a)(366,je.control),this.NYc(je.control.Vj.firstChild),Yb.a(this.$).XUc(this.onFloatingObjectControlAdded))};this.th=va.$;this.webExtensionView=Nc;this.jq=va;this.Kj=Ac;this.Kj.InstanceId=Ac.SrcLocationOverrideResourceId?va.zJa(Ac.InstanceId,Ac.SrcLocationOverrideResourceId):Ac.InstanceId;this.ao=Bb;this.sda={};this.sda.WebExtensionId=Ac.InstanceId;this.rtg="osfControl_"+Ac.InstanceId;this.jCd="disabled_"+Ac.InstanceId;this.sda.BindingData=Ac.BindingData;this.Fnb=this.jq.Fnb(Ac.InstanceId);
this.eGc=this.jq.eGc(Ac.InstanceId);this.kUe=Ac.WebExtensionOsfControlType;this.Zwg=hd}get controlId(){return this.Kj.InstanceId}get N_f(){return this.Egc}sdj(va){this.xqa||(this.xqa=va)}wEg(){this.xqa&&(this.xqa.dispose(),this.xqa=null)}get controlType(){return this.Kj.WebExtensionType}get ownerAddinSolutionId(){return this.Kj.OwnerAddinSolutionId}get $(){return this.th}get enabled(){return!this.b5}get visible(){return this.Kj.TaskpaneVisible}get lG(){return this.hhd}get OX(){return this.Kj.SrcLocationOverrideResourceId?
this.jq.zJa(this.Kj.PrimaryMarketplace.SolutionId,this.Kj.SrcLocationOverrideResourceId):this.Kj.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Kj.SrcLocationOverrideResourceId}get io(){return this.Kj}get Kla(){return this.sHe}set Kla(va){this.sHe=va}get osfControlType(){return this.kUe}get $Ha(){return this.QJe}set $Ha(va){this.QJe=va}get fuc(){return this.Vab}set fuc(va){this.Vab=va}get focusOnIframeWhenLoaded(){return this.Kj.FocusOnIframeWhenLoaded}get JIc(){return this.vPe}set JIc(va){this.vPe=
va}uTd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Kj.PrimaryMarketplace.MarketplaceType)&&ub.EwaSettings.Ra(174)){const Bb=Object(Pb.d)($c.a.resolve(wd.C,{va:0}));Td.TaskExtensions.Xa(Bb,()=>{Bb.result.Om(36,null)},this.ya,3);return this}if(1===this.Kj.WebExtensionType)Td.TaskExtensions.Xa(Xd.a(this.$),Bb=>{Bb.result.ktc(this.$.la,77,5,this.Tgg,1)},this.ya,3);else{var va=this.Mzf();const Bb=Yb.a(this.$);va||(va={Type:3},va.Id=this.sda.WebExtensionId,va.WebExtensionData=this.Kj,va.ContentHtml=
"<div/>",va.Version=0,va.AbsoluteLeft=0,va.AbsoluteTop=0,va.AbsoluteRight=0,va.AbsoluteBottom=0,va.Width=0,va.Height=0,va.ZOrder=0,va.OriginDeltaX=0,va.OriginDeltaY=0,va=new Ec.a(va),Bb.Ysc(va,null),va=Bb.Tx(va.rn()));va?(this.NYc(va.Vj.firstChild),this.Kla=Object(Nb.a)(366,va)):Bb.Hmc(this.onFloatingObjectControlAdded)}return this}FUf(va){this.NYc(va);return this}WOc(){this.Zwg||this.jq.Cl.purgeOsfControl(this.controlId,!1);if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")&&
this.$.isEditMode||!ub.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")){const Bb=this.$.pa.ta.Vh();Zc.a(this.$.userOperationManager,(Ac,Nc,hd)=>Bd.e(this.$.pa.ta,this.Kj.InstanceId,Ac,Nc,hd,Bb),Ac=>new tc.a(606,0,Ac,64),null)}this.$3g(!0);const va=this.Mzf();va&&Yb.a(this.$).deleteFloatingObject(va);this.jq.Xn.qkk(this.controlId);this.jq.Xn.jtf(this.controlId,!0);this.hhd=null}C$d(va){this.sda=va}invokeDdaMethod(va,Bb){if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled){var Ac={};Ac[fa.a.Xk]=va;Ac[fa.a.Gfa]=Bb;this.jq.aV(974713501,Ac)}else this.jq.lo(pb.a.fVb,Bb)}xhk(va,Bb,Ac,Nc){if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!Ab.Dhi(va)||void 0!==Bb&&null!==Bb&&void 0!==this.nkb(Bb)&&null!==this.nkb(Bb))if(h.ULS.sendTraceTag(36444195,0,50,`eventId: ${va}, targetId: ${Bb}`),Ab.yYf(va)&&this.D8i(),Ab.VVd(va)&&this.fSd(),Ab.wYf(va))this.Egc=!0,this.jq.$.la.kh(232).addHandler(this.controlId,Ac,Nc,Bb);else if(Ab.xYf(va))this.Egc=
!0,this.jq.$.la.kh(232).Lyh(this.controlId,Ac,Nc);else{Ab.vYf(va)&&this.$Of(-1777565636,Nc);this.VO||(this.VO=[]);var hd=this.SPb(va,Bb);hd||(hd=new ra(va,Bb),this.VO.push(hd));hd.VOa();hd.Rmc(Ac);this.jq.zE(Nc);va===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.Vab&&(this.guc=Ac)}else this.jq.lo(3002,Nc);else this.jq.lo(-1,Nc)}w5k(va,Bb,Ac,Nc){Ab.wYf(va)?(this.jq.$.la.kh(232).removeHandler(this.controlId,Nc),ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",!1)&&
(this.Egc=!1)):Ab.xYf(va)?this.jq.$.la.kh(232).Mkk(this.controlId,Nc):(Ab.vYf(va)&&this.$Of(1592314317,Nc),Bb=this.SPb(va,Bb),this.enabled?(Bb&&(Bb.fVc(Ac),Bb.s6i||Array.remove(this.VO,Bb),this.VO.length?Ab.yYf(va)&&this.a4g(!1):this.$3g(!1)),this.jq.zE(Nc)):this.jq.lo(-1,Nc))}Ba(va){vd.DOMElementExtensions.getElementById(va,this.rtg)||va.appendChild(vd.DOMElementExtensions.an(this.lG))}showHide(va){vd.DOMElementExtensions.setVisible(this.lG,va)}resize(va,Bb){vd.DOMElementExtensions.hI(this.lG,va);
vd.DOMElementExtensions.DW(this.lG,Bb)}Jpf(va){if(!this.b5&&!vd.DOMElementExtensions.getElementById(this.lG,this.jCd)&&this.lG){const Bb=document.createElement("div");Bb.id=this.jCd;Bb.className="ewa-wx-disabled-div";Bb.style.backgroundImage="url("+dc.a.current.Pu(102)+")";Bb.style.opacity=va?"1":"0";Bb.style.backgroundRepeat="no-repeat";Bb.style.backgroundPosition="center";this.lG.insertBefore(Bb,this.lG.firstChild)}this.b5++}Jki(){0<this.b5&&this.b5--;this.b5||(vd.DOMElementExtensions.an(vd.DOMElementExtensions.getElementById(this.lG,
this.jCd)),this.aLa&&!jd.X(this.NSc,lb.f(this.$).ha.qa.selectedRanges)&&this.Jj(null,null))}nkb(va){if(!this.sda||!this.sda.BindingData)return null;for(let Bb=0;Bb<this.sda.BindingData.length;Bb++)if(this.sda.BindingData[Bb].Name===va)return this.sda.BindingData[Bb];return null}getDefaultIconUrl(){const va=this.YJf();return va?va.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Kj.TaskpaneTitle)return this.Kj.TaskpaneTitle;const va=this.YJf();return va?va.getDefaultDisplayName():null}fyg(){if(this.Vab&&
this.guc){const va=new db.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.Vab);this.guc(va);this.guc=this.Vab=null}}eF(va){this.jCe&&this.jCe.eF(va)}KCk(){this.$.ea.isNamedObjectViewMode&&this.upj()&&(wd.Ug.Aa()?this.webExtensionView.FOg(this.lG):vb.a(this.$).FOg(this.lG),this.showHide(!1));if(this.jq.Cel){if(!this.Zwg){const va={};va.div=this.lG;va.id=this.Kj.InstanceId;va.solutionId=this.Kj.PrimaryMarketplace.SolutionId;va.version=this.Kj.PrimaryMarketplace.SolutionVersion;
va.storeId=this.Kj.PrimaryMarketplace.MarketplaceRef;va.storeType=this.Kj.PrimaryMarketplace.MarketplaceType;va.ownerAddinSolutionId=this.Kj.OwnerAddinSolutionId;va.ownerAddinStoreType=this.Kj.OwnerAddinStoreType;this.Kj.AssetMarketplace?(va.assetId=this.Kj.AssetMarketplace.SolutionId,va.assetStoreId=this.Kj.AssetMarketplace.MarketplaceRef):(va.assetId=null,va.assetStoreId=null);va.settings=this.Kj.OsfPropertyBag;va.hostSettings=this.Kj.HostPropertyBag;ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?
va.reason=this.Fnb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.eGc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:va.reason=this.Fnb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;va.osfControlType=0===this.Kj.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;va.isForUILessAction=4===
this.Kj.WebExtensionOsfControlType;va.sourceLocationOverrideResourceId=this.Kj.SrcLocationOverrideResourceId;va.focusOnIframeWhenLoaded=this.Kj.FocusOnIframeWhenLoaded;gc.a(this.Kj)&&(va.featureGates=w.AFrameworkApplication.fa.QGf(va.solutionId));va.hostInfoFlags=0;this.$Ha&&(va.hostInfoFlags|=2);zd.HelperMethods.XF(this.Kj)&&(va.hostInfoFlags|=1);this.$.m4||(h.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),va.hostInfoFlags|=4);ub.EwaSettings.Ra(553)&&(va.hostInfoFlags|=
8);va.sharedRuntimeId=this.Kj.SharedRuntime?this.Kj.SharedRuntime.Resid:this.Kj.SharedRuntimeId;!zd.HelperMethods.XF(this.Kj)||this.Kj.Preload||gc.a(this.Kj)||this.jq.Cl.getOsfControl(a(940).DdaFacade.getSolutionId(this.Kj,this.$))||(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.jq.$rg(this.Kj):this.jq.$rg(this.Kj));va.onExtensionLaunchCallback=this.Kj.OnExtensionLaunchCallback;va.initialDisplayMode=this.Kj.TaskpaneVisible?2:1;ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&
(va.titleOverride=this.io.TaskpaneTitle);this.jq.Cl.insertOsfControl(va)}this.b5=0}else this.Jpf(!0)}$3g(va){this.a4g(va);this.d5k()}D8i(){this.Iwb||this.ao.Rmc(this.XOf);this.Iwb++}a4g(va){0<this.Iwb&&(va?this.Iwb=0:this.Iwb--,this.Iwb||this.ao.fVc(this.XOf))}fSd(){if(!this.aLa){const va=lb.f(this.$).ha;this.NSc=jd.d(lb.f(this.$).ha.qa.selectedRanges);va.g$(this.Jj);this.aLa=!0}}d5k(){this.aLa&&(lb.f(this.$).ha.uca(this.Jj),this.aLa=!1)}izk(va){var Bb=new ed.Range(va.Reference.FirstRow+1,va.Reference.FirstColumn+
1,va.Reference.LastRow+1,va.Reference.LastColumn+1,!1,!1);1===va.BindingType&&(va.HasHeaders&&--Bb.top,va.HasTotals&&(Bb.bottom+=1));var Ac=lb.f(this.$).ha.qa.selectedRanges;va=Bb.xnb(this.NSc);Ac=Bb.xnb(Ac);return(Bb=Bb.Ik(lb.f(this.$).ha.qa.activeRange))&&(nc.a(va)&&!nc.a(Ac)||!nc.a(va)&&!nc.a(Ac)&&!jd.X(va,Ac))?Bb:null}tAk(){Array.forEach(this.VO,va=>{if(va.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&va.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.jq.Xn.ooc(this.controlId))if(va.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)va.dqc(new db.a(va.eventId,this.controlId,null));else if(va.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const Bb=this.nkb(va.targetId);if((null===Bb||void 0===Bb?0:Bb.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.$h.ma.sheetName:this.$.sa.ma.name)===Bb.Reference.SheetName){const Ac=this.izk(Bb);Ac&&va.dqc(new xb(va.eventId,this.controlId,this.jq.Yoc(Bb),Bb,Ac.top-1,Ac.left-1,Ac.height,Ac.width))}}})}SPb(va,Bb){if(!this.VO)return null;
for(let Ac=0;Ac<this.VO.length;Ac++){const Nc=this.VO[Ac];if(Nc.eventId===va&&Nc.targetId===Bb)return Nc}return null}Mzf(){const va=Yb.a(this.$).F0;for(let Bb=va.length-1;0<=Bb;--Bb){const Ac=va[Bb];if(3===Ac.floatingObject.type&&Ac.floatingObject.io.InstanceId===this.sda.WebExtensionId)return Ac}return null}upj(){for(let va=0;va<this.$.$h.count;va++)if(this.$.$h.getItem(va).imageId===this.sda.WebExtensionId)return!0;return!1}NYc(va){this.hhd=va;this.lG.id=this.rtg;this.lG.className="ewa-wx-container-div";
this.lG.dir=this.$.isChromeRtl?"rtl":"ltr";this.KCk()}YJf(){if(!this.enabled)return null;const va=gc.a(this.io)?"":this.io.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.io.PrimaryMarketplace.SolutionId,va)}$Of(va,Bb){try{if(h.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.kUe)this.jq.lo(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Bb);else{const Ac={};Ac[ca.a.vIb]=this.controlId;const Nc=new Gc.a(va,
0,this.$.isEditMode?2:1,0,null);this.$.Ma.qh(Nc,Ac);this.jq.zE(Bb)}}catch(Ac){h.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${Ac.message}.`),this.jq.lo(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Bb)}}static Dhi(va){return va===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||va===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static yYf(va){return va===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||va===OSF.DDA.EventDispId.dispidSettingsChangedEvent||
va===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static VVd(va){return va===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||va===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static wYf(va){return va===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static xYf(va){return va===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static vYf(va){return va===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(Ab,"OsfControl",mc.a,[367]);class rb{constructor(){this.Veb=
{}}add(va){this.Veb[va]=!0}remove(va){delete this.Veb[va]}clear(){for(const va of Object.keys(this.Veb))delete this.Veb[va]}zQf(){return 0<Object.keys(this.Veb).length}$Di(){return Object.keys(this.Veb)}}Object(c.a)(rb,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Fb=a(61);class jc{constructor(va,Bb,Ac){this.bDg=this.aDg=0;this.m8b=this.jub=null;this.DOj=()=>{var Nc=lb.f(this.$).ha.$e.sK;if(this.tVd(Nc)&&(Nc=this.jRb(Nc))){var hd={};hd.chartId=Nc;hd.worksheetId=this.$wa();
hd=Fb.a.Ci(hd);this.Bwa(51,Nc,hd);this.Bwa(51,this.$wa(),hd)}};this.EOj=()=>{if(this.jub){var Nc={};Nc.chartId=this.jub;Nc.worksheetId=this.m8b;Nc=Fb.a.Ci(Nc);this.Bwa(52,this.jub,Nc);this.Bwa(52,this.m8b,Nc)}Nc=lb.f(this.$).ha.$e.sK;this.tVd(Nc)?(this.jub=this.jRb(Nc),this.m8b=this.$wa()):this.m8b=this.jub=null};this.$=va;this.Xn=Bb;this.ao=Ac}rJb(va){51===va.messageType?this.aDg=this.iWa(va.actionType,this.aDg,this.DOj):52===va.messageType&&(this.bDg=this.iWa(va.actionType,this.bDg,this.EOj))}iWa(va,
Bb,Ac){if(1===va)Bb||lb.f(this.$).ha.$e.hpd(Ac),Bb++,this.QGk();else if(2===va){if(1>Bb)return Bb;1===Bb&&lb.f(this.$).ha.$e.Sie(Ac);Bb--}return Bb}Bwa(va,Bb,Ac){Bb&&this.Xn.eS(va,Bb)&&this.ao.HM(va,Bb,Ac)}jRb(va){return va&&va.floatingObject?(va=va.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===va.length?va[0]:null:null}$wa(){const va=this.$.sa.ma;return va&&0===va.zG?va.sheetId:null}QGk(){const va=lb.f(this.$).ha.$e.sK;this.tVd(va)&&(this.jub=this.jRb(va),this.m8b=
this.$wa())}tVd(va){return!!va&&!!va.floatingObject&&0===va.floatingObject.type}}Object(c.a)(jc,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Oc=a(948),cd=a(200),Ed=a(727),Sd=a(118),$d=a(67);class be extends bb.a{constructor(va,Bb,Ac){super();this.b5=this.UOa=0;this.Jj=(Nc,hd)=>{if(this.enabled&&!(this.V_f()||null!==hd&&void 0!==hd&&hd.C3f)&&(Nc=Object(Nb.a)(Sd.a,this.$.sa.ma))&&0===Nc.zG){const qd=Nc.sheetId,je=this.NFf();let Ie=null,Oe=null;this.Xn.s3f()&&(Ie=this.grid.oh.Kl(this.grid.ha.qa.activeCell),
Oe=qd in this.QKc?this.QKc[qd]:null);this.N8e(qd,je)&&Td.TaskExtensions.Xa($d.Task.Ua(!0),()=>{this.Q5i(qd,je);this.A5i(qd,je,Ie,Oe)},this.ya);this.Sqf(qd,je,Ie)}};this.$=va;this.Xn=Bb;this.ao=Ac;this.grid=lb.f(va);this.d3a={};this.QKc={}}get enabled(){return!this.b5&&0<this.UOa}Joc(va){1===va.actionType?(this.UOa||this.grid.ha.g$(this.Jj),this.UOa++):2!==va.actionType||1>this.UOa||(1===this.UOa&&this.grid.ha.uca(this.Jj),this.UOa--)}xYc(va){va?this.b5++:(0<this.b5&&this.b5--,this.b5||this.Jj(null,
new Ed.a(!1)))}NFf(){return this.grid.ha.qa.selectedRanges}N8e(va,Bb){return ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!va&&cd.e(this.d3a)||va in this.d3a)&&!jd.X(this.d3a[va],Bb):va in this.d3a&&!jd.X(this.d3a[va],Bb)}Sqf(va,Bb,Ac){this.d3a[va]=jd.d(Bb);this.QKc[va]=Ac}V_f(){return this.grid.isEditing||this.grid.lq}fAf(va,Bb){this.Xn.eS(14,va)&&this.ao.HM(14,va,Bb);this.Xn.eS(14,Oc.a.bW)&&this.ao.HM(14,Oc.a.bW,Bb)}Q5i(va,Bb){const Ac=
{};Ac.worksheetId=va;Ac.address=this.aOd(Bb);Bb=Fb.a.Ci(Ac);this.fAf(va,Bb)}A5i(va,Bb,Ac,Nc){if(this.Xn.s3f()){var hd="";let qd="";Nc&&(hd=Nc.Wq);Ac&&(qd=Ac.Wq);Nc?Ac?(Bb=Ac.usedRange.xnb(Bb),hd!==qd&&this.Hyc(hd,"",va),this.Hyc(qd,this.aOd(Bb),va)):this.Hyc(hd,"",va):Ac&&(hd=Ac.usedRange.xnb(Bb),this.Hyc(qd,this.aOd(hd),va))}}Hyc(va,Bb,Ac){if(this.Xn.eS(100,va)){const Nc={};Nc.address=Bb;Nc.worksheetId=Ac;this.ao.HM(100,va,Fb.a.Ci(Nc))}}aOd(va){return jd.j(va,",",this.$,!1)}dispose(){0<this.UOa&&
this.grid.ha.uca(this.Jj);this.QKc=this.d3a=null;this.UOa=0;this.ao=this.Xn=this.$=this.grid=null}}Object(c.a)(be,"RichApiEventSelectionChangedHandler",bb.a,[]);var Fe=a(392);class Pe extends be{constructor(va,Bb,Ac){super(va,Bb,Ac);this.K5f=this.L5f=null}NFf(){return Fe.a.utc(this.grid.ha.rangePicker.pZ)}N8e(va,Bb){return this.L5f!==va||!jd.X(this.K5f,Bb)}Sqf(va,Bb){this.L5f=va;this.K5f=jd.d(Bb)}V_f(){return!this.grid.isEditing&&!this.grid.lq}fAf(va,Bb){this.Xn.eS(2700,Oc.a.bW)&&this.ao.HM(2700,
Oc.a.bW,Bb)}}Object(c.a)(Pe,"RichApiEventPickedRangesChangedHandler",be,[]);class hc{constructor(va,Bb,Ac){this.B6a=this.A6a=0;this.NWa=this.Uua=null;this.xkg=()=>{var Nc=lb.f(this.$).ha.$e.sK;if(0<this.B6a&&this.Uua&&this.NWa){var hd={};hd.shapeId=this.Uua;hd.worksheetId=this.NWa;hd=Fb.a.Ci(hd);this.fireEvent(2102,this.Uua,hd)}this.mrj(Nc)?(this.Uua=this.C3k(Nc),this.NWa=this.$wa(),this.Uua&&this.NWa)?0<this.A6a&&(Nc={},Nc.shapeId=this.Uua,Nc.worksheetId=this.NWa,Nc=Fb.a.Ci(Nc),this.fireEvent(2101,
this.Uua,Nc)):h.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.Uua}', or worksheet id: '${this.NWa}' from a Floating object or gridview.`):this.NWa=this.Uua=null};this.$=va;this.Xn=Bb;this.ao=Ac}rJb(va){const Bb=lb.f(this.$).ha;1===va.actionType?(this.A6a||this.B6a||Bb.$e.hpd(this.xkg),2101===va.messageType?this.A6a++:2102===va.messageType&&this.B6a++):2===va.actionType&&(2101===va.messageType?this.A6a=0<this.A6a?this.A6a-1:0:2102===va.messageType&&(this.B6a=
0<this.B6a?this.B6a-1:0),this.A6a||this.B6a||Bb.$e.Sie(this.xkg))}mrj(va){return!!va&&!!va.floatingObject&&(0===va.floatingObject.type||7===va.floatingObject.type||1===va.floatingObject.type||3===va.floatingObject.type||5===va.floatingObject.type)}C3k(va){if(!va||!va.floatingObject)return null;va=va.floatingObject.id;var Bb=va.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Bb=Bb&&1===Bb.length?Bb[0]:null;return Bb?Bb:(h.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${va}', but we failed.`),
null)}$wa(){const va=this.$.sa.ma;return va&&0===va.zG?va.sheetId:null}fireEvent(va,Bb,Ac){Bb&&this.Xn.eS(va,Bb)&&this.ao.HM(va,Bb,Ac)}}Object(c.a)(hc,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Lb{constructor(va,Bb,Ac){this.fDg=this.eDg=this.gDg=this.dDg=0;this.F1j=(Nc,hd)=>{Nc=Object(Nb.a)(Sd.a,hd.ma);this.Hpb(Nc)&&(hd={},hd.worksheetId=Nc.sheetId,hd=Fb.a.Ci(hd),this.Bwa(11,Nc.sheetId,hd))};this.I1j=(Nc,hd)=>{Nc=Object(Nb.a)(Sd.a,hd.LB);this.Hpb(Nc)&&(hd={},hd.worksheetId=Nc.sheetId,
hd=Fb.a.Ci(hd),this.Bwa(12,Nc.sheetId,hd))};this.G1j=(Nc,hd)=>{Nc=Object(Nb.a)(Sd.a,hd.ma);this.Hpb(Nc)&&(hd={},hd.worksheetId=Nc.sheetId,Nc=Fb.a.Ci(hd),this.Bwa(11,null,Nc,!0))};this.H1j=(Nc,hd)=>{Nc=Object(Nb.a)(Sd.a,hd.LB);this.Hpb(Nc)&&(hd={},hd.worksheetId=Nc.sheetId,Nc=Fb.a.Ci(hd),this.Bwa(12,null,Nc,!0))};this.$=va;this.Xn=Bb;this.ao=Ac}rJb(va){11===va.messageType?va.targetId===Oc.a.bW?this.xKh(va.actionType):this.wKh(va.actionType):12===va.messageType&&(va.targetId===Oc.a.bW?this.yKh(va.actionType):
this.zKh(va.actionType))}wKh(va){this.dDg=this.iWa(va,this.dDg,this.F1j)}zKh(va){this.gDg=this.iWa(va,this.gDg,this.I1j)}xKh(va){this.eDg=this.iWa(va,this.eDg,this.G1j)}yKh(va){this.fDg=this.iWa(va,this.fDg,this.H1j)}iWa(va,Bb,Ac){1===va?Bb=this.hWa(Bb,Ac):2===va&&(Bb=this.CYa(Bb,Ac));return Bb}hWa(va,Bb){va||this.$.sa.pn(Bb);va++;return va}CYa(va,Bb){if(1>va)return va;1===va&&this.$.sa.Gn(Bb);va--;return va}Hpb(va){return!!va&&0===va.zG}Bwa(va,Bb,Ac,Nc){Bb=(void 0===Nc?0:Nc)?Oc.a.bW:Bb;this.Xn.eS(va,
Bb)&&this.ao.HM(va,Bb,Ac)}}Object(c.a)(Lb,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var kc=a(306),dd=a(17),yb=a(290);class Ta extends Sys.EventArgs{constructor(va,Bb,Ac,Nc){super();this.sheet=va;this.GUh=Bb;this.offsetX=Ac;this.offsetY=Nc}}Object(c.a)(Ta,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class Hb{constructor(va,Bb,Ac){this.rrc=null;this.q_d=!1;this.onPointerDown=Nc=>{if(3===Nc.Dh){const {ihb:hd}=this.da.$zc(Nc.clientPoint);this.q_d=!!hd&&this.da.ha.qa.erf(hd)}else this.q_d=
!1;this.rrc=Nc.clientPoint;return!1};this.vj=Nc=>{if(this.da.inRangePicker||this.da.lq||this.q_d||Nc.shiftKey||Nc.ctrlKey||Nc.La.button!==Sys.UI.MouseButton.leftButton||!this.rrc||!Nc.clientPoint||Nc.clientPoint.x!==this.rrc.x||Nc.clientPoint.y!==this.rrc.y)return!1;let hd;var qd=(()=>{let Ie=this.da.$zc(Nc.clientPoint);({ihb:hd}=Ie);return Ie})().returnValue;const je=Object(Nb.a)(Sd.a,this.$.sa.ma);if(qd&&je&&0===je.zG){if(!this.da.ha.qa.saa.contains(hd))return!1;qd=new Ta(je,hd,zd.HelperMethods.dSc(qd.x),
zd.HelperMethods.dSc(qd.y));this.J1j(qd)}return!1};this.$=va;this.da=lb.f(va);this.Xn=Bb;this.ao=Ac;this.bjk()}dispose(){this.S5k()}bjk(){for(const va of this.da.Wu){const Bb=va.domElement;kc.a.instance.xa(dd.a.qj,Bb,this.onPointerDown);yb.a.instance.xa(dd.a.click,Bb,this.vj)}}S5k(){for(const va of this.da.Wu){const Bb=va.domElement;kc.a.instance.Qa(dd.a.qj,Bb,this.onPointerDown);yb.a.instance.Qa(dd.a.click,Bb,this.vj)}}J1j(va){var Bb=va.sheet;if(this.Hpb(Bb)){var Ac={};Ac.worksheetId=Bb.sheetId;
Ac.address=va.GUh.toString();Ac.offsetX=va.offsetX;Ac.offsetY=va.offsetY;va=Bb.sheetId;this.Xn.eS(21,va)&&(Bb=Fb.a.Ci(Ac),this.ao.HM(21,va,Bb));va=Oc.a.bW;this.Xn.eS(21,va)&&(Ac=Fb.a.Ci(Ac),this.ao.HM(21,va,Ac))}}Hpb(va){return!!va&&0===va.zG}}Object(c.a)(Hb,"RichApiEventSingleClickedHandler",null,[]);class uc{constructor(va,Bb,Ac){this.E4b=0;this.Vtb=this.fub=null;this.wsg=()=>{const Nc=lb.f(this.$).ha.$e.sK;if(Nc)if(this.o4f(Nc)){const hd=this.$wa();this.rHd(hd);this.fub=Nc.floatingObject.id;this.Vtb=
hd}else this.fub&&(this.rHd(this.Vtb),this.Vtb=this.fub=null);else this.fub&&(this.rHd(this.Vtb),this.Vtb=this.fub=null)};this.$=va;this.Xn=Bb;this.ao=Ac}Joc(va){2E3===va.messageType&&(1===va.actionType?(this.E4b||lb.f(this.$).ha.$e.hpd(this.wsg),this.E4b++,this.SCk()):2===va.actionType&&this.E4b&&(1===this.E4b&&lb.f(this.$).ha.$e.Sie(this.wsg),this.E4b--))}rHd(va){var Bb;const Ac={};Ac.worksheetId=va;Ac.revisionLoad=!1;if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")){const Nc=
lb.f(this.$).ha.$e.sK;(null===(Bb=null===Nc||void 0===Nc?void 0:Nc.floatingObject)||void 0===Bb?0:Bb.Ti)?Ac.selectedVisualId=Nc.floatingObject.Ti.VisualID:Ac.selectedVisualId=null}Bb=Fb.a.Ci(Ac);va&&this.Xn.eS(2E3,va)&&this.ao.HM(2E3,va,Bb)}$wa(){const va=this.$.sa.ma;return va&&0===va.zG?va.sheetId:null}SCk(){const va=lb.f(this.$).ha.$e.sK;this.o4f(va)&&(this.fub=va.floatingObject.id,this.Vtb=this.$wa())}o4f(va){return!!va&&va.Z_d()}}Object(c.a)(uc,"RichApiEventVisualSelectionChangedHandler",null,
[]);class Sc{constructor(va,Bb,Ac){this.F4b=0;this.G$g=!0;this.Uyc=0;this.fZd=!0;this.Qef=()=>{const Nc=document.hasFocus();if(this.G$g!==Nc){if(Nc){const hd=Fb.a.Ci({});this.ao.HM(2203,Oc.a.bW,hd)}this.G$g=Nc}};this.Ref=Nc=>{(0<Nc.timeRemaining()||Nc.didTimeout)&&this.Qef();window.requestIdleCallback(this.Ref)};this.$=va;this.Xn=Bb;this.ao=Ac;window.requestIdleCallback||(this.fZd=!1)}vKh(va){1===va.actionType?(this.F4b||this.KKh(),this.F4b++):2!==va.actionType||1>this.F4b||(1===this.F4b&&this.jei(),
this.F4b--)}KKh(){if(this.Xn.eS(2203,Oc.a.bW))if(this.fZd){const va={};va.timeout=this.$.ua.CheckFocusTimeout;this.Uyc=window.requestIdleCallback(this.Ref,va)}else this.Uyc=window.setInterval(this.Qef,this.$.ua.CheckFocusTimeInterval)}jei(){this.fZd?window.cancelIdleCallback(this.Uyc):window.clearInterval(this.Uyc)}}Object(c.a)(Sc,"RichApiEventWorkbookActivatedHandler",null,[]);var bc;(function(va){va[va.none=0]="none";va[va.registerEvent=1]="registerEvent";va[va.unregisterEvent=2]="unregisterEvent";
va[va.customFunction=3]="customFunction";va[va.showCard=4]="showCard";va[va.createWorkbook=5]="createWorkbook";va[va.openWorkbook=6]="openWorkbook";va[va.enableEvents=7]="enableEvents";va[va.closeWorkbook=8]="closeWorkbook";va[va.setCalculationMode=9]="setCalculationMode";va[va.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";va[va.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";va[va.workbookLinksEnableContent=12]="workbookLinksEnableContent";va[va.workbookLinksFindNextLink=
13]="workbookLinksFindNextLink";va[va.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";va[va.rangePicker=15]="rangePicker";va[va.enableRichApiRecording=16]="enableRichApiRecording";va[va.recordAction=17]="recordAction";va[va.focus=18]="focus";va[va.businessBarShow=19]="businessBarShow";va[va.businessBarHide=20]="businessBarHide";va[va.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";va[va.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";va[va.showRangeValuesPreview=
23]="showRangeValuesPreview";va[va.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(bc||(bc={}));Object(c.b)("PostProcessActionType",bc);var vc=a(287);class Xc{constructor(va,Bb,Ac,Nc){this.stg=null;this.pHd=(hd,qd)=>{const je=Oc.a.bW,Ie={};Ie.eventId=hd;Ie.payload=qd;this.Xn.eS(2201,je)&&this.ao.HM(2201,je,Fb.a.Ci(Ie))};this.$=va;this.Xn=Bb;this.ao=Ac;this.ddaFacade=Nc;this.Ocj()}uKh(va){1===va.actionType?(this.$.nha=!0,(wd.xb.Aa()?this.ddaFacade:Object(Nb.a)(a(940).DdaFacade,vc.a(this.$))).qHd(!0)):
2===va.actionType&&(this.$.nha=!1);this.stg=va.controlId;h.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${bc[va.actionType]}; controlId: ${this.stg}; this.ewaControl.IsMacroRecorderListening: ${this.$.nha}.`)}jmi(va){(wd.xb.Aa()?this.ddaFacade:Object(Nb.a)(a(940).DdaFacade,vc.a(this.$))).hAf(va,this.$.nha)}Ocj(){this.$.x6&&Td.TaskExtensions.Xa(Object(Pb.d)($c.a.resolve(wd.Sd,{va:1})),va=>{(va=va.result)&&va.init(this.pHd)},this.$.ya,3)}}Object(c.a)(Xc,"RichApiMacroRecorderEventHandler",
null,[]);class ad{}Object(c.a)(ad,"StyleCacheItem",null,[]);class Id{constructor(va,Bb,Ac){this.$=va;this.da=Bb;this.yk=Ac}Hua(va){this.range=va;this.Nrc=Array(va.width);this.C0c=Array.from({length:va.height},()=>Array(va.width))}zCk(va,Bb,Ac,Nc){this.s2f(va,Bb)&&(this.C0c[va-this.range.top][Bb-this.range.left]||(this.C0c[va-this.range.top][Bb-this.range.left]={backgroundColor:Ac.backgroundColor}),Ac.backgroundColor=Nc)}BCk(va,Bb,Ac){if(this.s2f(va,Bb)){va=ed.Range.vi(va,Bb);var Nc=this.da.zh(va);
Nc&&(this.Nrc[Bb-this.range.left]||(this.Nrc[Bb-this.range.left]=Nc.width),Bb=this.yk.ite(this.da,[va],Ac,!1),"Success"!==Bb.kind&&h.ULS.sendTraceTag(508303323,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${Bb.reason}.`))}}restore(){this.range&&(this.Nrc.forEach((va,Bb)=>{va=this.yk.ite(this.da,[ed.Range.vi(this.range.top,this.range.left+Bb)],va,!1);"Success"!==va.kind&&h.ULS.sendTraceTag(508303322,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${va.reason}`)}),
this.C0c.forEach((va,Bb)=>{va.forEach((Ac,Nc)=>{Nc=ed.Range.vi(this.range.top+Bb,this.range.left+Nc);if(Nc=this.da.zh(Nc))Nc.cell.backgroundColor=Ac.backgroundColor})}),this.Nrc=this.C0c=this.range=void 0)}s2f(va,Bb){if(!this.range)return h.ULS.sendTraceTag(508303321,0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),!1;(va=this.range.contains(ed.Range.vi(va,Bb)))||h.ULS.sendTraceTag(508303320,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");
return va}}Object(c.a)(Id,"InstantaneousGridContentRestorer",null,[]);var ue=a(217),Vd=a(157);class Kd{constructor(va,Bb,Ac,Nc){this.cUi=hd=>{const qd=hd.mj.block;if(this.WC.Ik(qd.yj)){this.Mvg([qd.yj]);const je=lb.f(this.$).GW(qd.yj),Ie=()=>this.Evg([qd.yj]);setTimeout(()=>{je.skeletonMode?setTimeout(()=>{je.skeletonMode?h.ULS.sendTraceTag(508303319,0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time."):Ie()},Kd.rdh):Ie()},Kd.Heh)}};this.gia=(hd,qd)=>
{0===qd.tx&&576!==qd.Ul.operation.operationName&&this.Pmb(!0)};this.cae=hd=>{this.q_c&&(this.fxi(hd),this.AZ())};this.$=va;this.Xn=Bb;this.ao=Ac;this.da=lb.f(this.$);this.HFc=new Id(this.$,this.da,Nc)}n5i(va,Bb,Ac,Nc){this.E1f(va)?(Bb=this.CSh(Bb,Ac))?this.XE?h.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):(this.worksheetId=va,this.WC=Bb,this.values=Ac,this.w8(Nc)):h.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):
h.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}a3i(va){this.E1f(va)?this.Pmb(!1):h.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}w8(va){this.Mvg(this.oEf());va&&(h.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(va)}`),
va.autoexpandTable&&this.HSh(),va.autofitColumns&&this.URh());this.q_c=this.da.qN.w8(this.WC,this.cUi).then(Bb=>{h.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");this.XE=Bb;this.HFc.Hua(this.WC);this.Evg(this.oEf());this.$.userOperationManager.mw(this.gia);Bb.d6b.then(()=>this.cae(!0),()=>this.cae(!0));return Promise.resolve()},Bb=>{h.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${Bb}`);
this.AZ();return Promise.resolve()})}Pmb(va){this.q_c&&(h.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),this.q_c.then(()=>{const Bb=this.XE;this.cae(va);Bb&&Bb.Naa("RichApiRangeValuesPreview")},()=>{h.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}CSh(va,Bb){va=jd.jb(va,this.$.sa);if(va.returnValue)return new ed.Range(va.range.top,va.range.left,va.range.top+Bb.length-
1,va.range.left+Bb[0].length-1,!0,!0)}E1f(va){const Bb=this.$.sa.ma;return Bb&&va===Bb.sheetId}Mvg(va){this.uId(va,(Bb,Ac,Nc,hd)=>{hd.cell.KV=this.values[Bb][Ac];return!0})}Evg(va){this.YBa&&this.uId(va,(Bb,Ac,Nc,hd)=>{this.HFc.zCk(Nc.top,Nc.left,hd,this.ELi(Nc.top));return!0});if(this.Pfb){const Bb=this.WC.xnb(va);0<Bb.length&&this.Pfb&&this.Pfb.forEach((Ac,Nc)=>{this.HFc.BCk(Bb[0].top,this.WC.left+Nc,Ac)})}}uId(va,Bb){for(let Nc=0;Nc<this.values.length;++Nc)for(let hd=0;hd<this.values[Nc].length;++hd){const qd=
ed.Range.vi(this.WC.top+Nc,this.WC.left+hd);if(!va||va.some(je=>je.contains(qd))){var Ac=this.da.HD(qd);if((!Ac||qd.equals(Ac.topLeft))&&(Ac=this.da.zh(qd))&&!Bb(Nc,hd,qd,Ac))return}}}oEf(){return this.da.za.qA().filter(va=>va.ma===this.$.ma).map(va=>va.yj)}fxi(va){this.Xn.eS(3400,this.worksheetId)&&(va=Fb.a.Ci({type:"RangeValuesPreviewDismissed",source:"Local",qnl:va}),this.ao.HM(3400,this.worksheetId,va))}AZ(){this.$.userOperationManager.uu(this.gia);this.Otk();this.YBa=this.worksheetId=this.q_c=
this.values=this.WC=this.XE=void 0}HSh(){if(this.WC){var va=this.lYi(this.WC);if(va){h.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");var Bb=(qd,je)=>{var Ie;return null===(Ie=this.da.zh(ed.Range.vi(qd,je)))||void 0===Ie?void 0:Ie.backgroundColor},Ac=va.usedRange.top;if(va.attributes&16){var Nc=Bb(va.usedRange.top,va.usedRange.left);++Ac}var hd=Bb(Ac,va.usedRange.left);Bb=Bb(Ac+
1,va.usedRange.left);this.YBa={x1g:va.usedRange.top,DRd:Nc,H0k:hd,vNh:Bb}}else h.ULS.sendTraceTag(508303318,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else h.ULS.sendTraceTag(509227291,0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}URh(){this.Pfb=Array(this.WC.width);let va=!1;this.uId(void 0,(Bb,Ac,Nc,hd)=>{var qd;if(this.da.HD(Nc))return va=!0,!1;Bb=hd.cell;
Bb=Bb.Jif(Bb.KV);Bb>hd.width&&(this.Pfb[Ac]=Object(Vd.a)(null!==(qd=this.Pfb[Ac])&&void 0!==qd?qd:0,Bb));return!0});va&&(this.Pfb=void 0)}Otk(){this.HFc.restore();jd.B(this.WC,(va,Bb)=>{va=ed.Range.vi(va,Bb);if(va=this.da.zh(va))va.cell.KV=void 0})}ELi(va){return this.YBa.DRd&&va===this.YBa.x1g?this.YBa.DRd:0===(va-this.YBa.x1g-(this.YBa.DRd?1:0))%2?this.YBa.H0k:this.YBa.vNh}lYi(va){const Bb=ue.b(this.da.$,va,!0);if(!(1<Bb.length)){var Ac=hd=>{var qd;const je=null!==(qd=this.da.oh.kYi(hd))&&void 0!==
qd?qd:this.da.oh.mYi(hd);if(je)return je},Nc=Ac(va);if(Nc&&0===Bb.length)return Nc;if(0!==Bb.length&&(va=jd.fb(va,Bb[0].usedRange),1===va.length))return Ac(va[0])}}}Kd.Heh=20;Kd.rdh=100;Object(c.a)(Kd,"RichApiRangeValuesPreview",null,[]);class Yd{}Object(c.a)(Yd,"SessionRecreationInfo",null,[]);class Bc{constructor(va,Bb,Ac){this.$=va;this.Xn=Bb;this.runtimeCalculationMode=Ac}JJj(){return ub.EwaSettings.Ra(234)?this.Xn.F6i()||0!==this.runtimeCalculationMode:!1}SPh(){var va={};va.eventRegistrationInfos=
this.Xn.hLi();va.runtimeCalculationMode=this.runtimeCalculationMode;va=Object(b.a)(new Yd,{runtimeState:va});const Bb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Bb.RequestBody=JSON.stringify(va);Bb.RequestFlags=1;return Bb}}Object(c.a)(Bc,"RichApiRuntimeStateHandler",null,[]);class Mc{constructor(va,Bb,Ac,Nc,hd,qd,je,Ie,Oe){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=
this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=va;this.processUtcTime=Bb;this.dequeueUtcTime=Ac;this.inQueueDurationInMS=Nc;this.executionDurationInMS=hd;this.operationCount=qd;this.ServerCorrelationId=je;this.UserOperationName=Ie;this.IsDocumentHidden=Oe}}Object(c.a)(Mc,"UserOperationQueueItemsStatisticsData",null,[]);var Fd=a(1258),Md=a(73),oe=a(255),ye=a(509),te=a(64),ze=a(77),He=a(25),ne=a(124),of=a(58),lf=a(54),jf=a(198),Cf=a(131),Gf=a(51),Af=a(32),Lf=a(36),Ef=a(254),
Hf=a(28),$b=a(12),Wb=a(264),Dc=a(943),Jf=a(62),Rb=a(1116),Gb=a(26),Cc=a(924);class cb{constructor(va,Bb,Ac){this.jUc=0;this.$0e=new Set;this.Z1f=!1;this.$=va;this.Xn=Bb;this.ao=Ac}tKh(va){1===va.actionType?this.Xn.eS(65541,Oc.a.bW)?this.jUc++:h.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===va.actionType&&0<this.jUc&&this.jUc--}uNj(va,Bb){if(0===this.jUc)h.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(Bb){va=Bb.annotation;
var Ac=[];Ac.push({content:JSON.stringify(Bb.annotation),annotationType:Cc.a.getTypeNameFor(va),id:va.id});this.ao.HM(65541,Oc.a.bW,JSON.stringify({annotationProperties:Ac}))}else h.ULS.sendTraceTag(509649752,0,10,"Event args are null")}L1i(va){const Bb=this;return Lo(function*(){if(!Bb.Xn.eS(65541,Oc.a.bW))h.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!Bb.$0e.has(va.annotationType)){var Ac=yield $c.a.resolve(wd.p,{va:1});Bb.Z1f||(Ac.register(Ac.J5().n8("RichApi").m8(()=>{}).build()),
Bb.Z1f=!0);Ac.kqa("RichApi",{annotationType:va.annotationType,Ny:!1,BV:Bb.uNj.bind(Bb)});Bb.$0e.add(va.annotationType)}})}M1i(va){return Lo(function*(){(yield $c.a.resolve(wd.p,{va:1})).oyb(JSON.parse(va.content));h.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${va.signalType}`)})}}Object(c.a)(cb,"RichApiAugmentationLoopHandler",null,[]);var pc=a(1049),Ic=a(1405),rd=a(1404);Object($c.b)(wd.xb,{Fk:"singleton"})(va=>Lo(function*(){h.ULS.sendTraceTag(507581071,0,50,"DdaFacade created");
if(w.AFrameworkApplication.disableWholeAppsForOfficeFeature)return h.ULS.sendTraceTag(507581070,0,50,`Not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${w.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`),null;const Bb=yield $c.a.resolve(wd.Nb,va),Ac=yield $c.a.resolve(wd.j,va),Nc=yield $c.a.resolve(wd.xc,va),hd=yield $c.a.resolve(wd.Ug,va);yield Object(Pb.a)(dc.a.z2d(65,()=>!(void 0===window.OSF||null===window.OSF),Bb.ua.MaxRetriesForLoadingScript,Bb.ya,va.va));yield Object(Pb.a)(pc.a(Bb.ya,
va.va));if(ub.EwaSettings.Ra(359)){const qd=yield(yield Object(Pb.e)(nb.a.qxe(Ja.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")))).isFeatureEnabled("mso_officeStore",!0),je=yield Ja.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").JR("WACSideloadAddins");Rd.eMb=qd;Rd.JAe=je}"undefined"!==typeof OfficeExt&&"undefined"!==typeof OSF&&(ub.EwaSettings.Ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new rd.a),Bb.uk.get(35)&&
OfficeExt.PrivateCatalogService.initRequestHandler(new rd.a,new Ic.a(w.AFrameworkApplication.fa.appSettings.WebServiceBase),ub.EwaSettings.Ra(70),!0),OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new rd.a),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new rd.a));return new Rd(Bb,Ac,Nc,hd)}));class Rd extends yc.a{constructor(va,Bb,Ac,Nc){super();this.ao=this.Dr=this.ea=null;this.Fl=[];this.TYa=null;this.disposed=this.initialized=
this.ecc=this.Zmf=!1;this.gDa=null;this.jRc=[];this.Tmf=[];this.u5a=[];this.zib=null;this.Ace=new oc.a(D.a.zm());this.inc=new U.a(D.a.zm());this.Q2b=[];this.Nug=[];this.GNb=350;this.gMa=this.g9=null;this.Fmd=!1;this.QWe=this.PWe=this.FWe=this.OWe=this.NWe=this.LWe=this.HWe=this.MWe=this.IWe=this.KWe=this.GWe=this.JWe=null;this.Vgh=3E3;this.u7c=!1;this.MT=this.XDb=null;this.Fkd=!1;this.Ggd=new U.a(D.a.zm());this.Vgd=new U.a(D.a.zm());this.Dl=()=>{this.HUd?this.RZ||(this.gDa=this.ea.Qq.WebExtensions):
this.gDa=this.ea.Qq.WebExtensions;var hd=Ie=>ub.EwaSettings.Ra(114)?!Ie.$Ha:!0,qd=Ie=>ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?!Ie.N_f:!0;const je=Ie=>ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopilotSilentReload",!1)?"FA000000124"!==Ie.io.PrimaryMarketplace.SolutionId:!0;for(let Ie=this.Fl.length-1;0<=Ie;--Ie){const Oe=this.Fl[Ie];!this.Ywi(Oe.controlId)&&hd(Oe)&&qd(Oe)&&je(Oe)&&(Oe.WOc(),this.Fl.splice(Ie,1))}if(this.gDa)for(let Ie=
0,Oe=this.gDa.length;Ie<Oe;Ie++)hd=this.gDa[Ie],(qd=this.gs(hd.WebExtensionId))&&qd.C$d(hd)};this.$Pc=hd=>{this.raiseEvent("csc",hd.getID())};this.zpa=(hd,qd,je)=>{if(qd===OSF.AgaveHostAction.KeyboardShortcuts){var Ie=Object(Nb.a)(Object,je);qd={};qd.keyCode=Ie.keyCode;qd.type="keydown";qd.ctrlKey=Ie.ctrlKey;qd.shiftKey=Ie.shiftKey;qd.altKey=Ie.altKey;qd.metaKey=Ie.metaKey;Ie=this.gs(hd);hd=Ie.Kla;qd.srcElement=Object(Aa.a)(270,hd)?hd.AIb:lb.f(this.$).hj;hd=new Sys.UI.DomEvent(qd);Ie=Rd.DJa(Ie.io,
this.$);qd={};qd.focusedAddinId=Ie;Ie=new Gc.a(1461300262,1,this.$.hi,6,null);lb.f(this.$).p6b(hd,Ie,qd)}else if(qd===OSF.AgaveHostAction.Select)this.LOf(!0);else if(qd===OSF.AgaveHostAction.UnSelect)this.LOf(!1);else if(qd===OSF.AgaveHostAction.CancelDialog)this.aV(-684355545,null);else if(qd===OSF.AgaveHostAction.InsertAgave)hd={},je&&(this.XDb=je,hd[ca.a.h$]=je,hd[fa.a.Xk]=this.wfa(je),this.aV(-741808261,hd));else if(qd===OSF.AgaveHostAction.ClickTrust)this.Aqd&&je&&(this.XDb=je);else if(qd===
OSF.AgaveHostAction.OsfControlLoad)this.Aqd&&this.XDb&&je&&this.uJh(this.XDb,je)&&je.storeType&&(this.XDb=null,this.qG(Ka.b(je.storeType)));else if(qd===OSF.AgaveHostAction.InsertDevManifest)hd={},je&&(hd[ca.a.h$]=je,hd[fa.a.Xk]=this.wfa(je),this.aV(-741808261,hd));else if(qd===OSF.AgaveHostAction.InsertDevManifestError)hd=Object(Nb.a)(Object,je),hd={[ca.a.kqd]:this.Dr.getDevManifestInvalidUrlErrorString(hd.manifestUrl)},this.aV(-2025863019,hd);else if(qd===OSF.AgaveHostAction.NotifyHostError)hd=
{[ca.a.kqd]:this.Dr.getManifestInvaildErrorString()},this.aV(-2025863019,hd);else if(qd===OSF.AgaveHostAction.RefreshAddinCommands)ub.EwaSettings.Ra(52)&&this.aV(Gb.a.refreshAddinCommands,null);else if(qd===OSF.AgaveHostAction.CtrlF6Exit||qd===OSF.AgaveHostAction.CtrlF6ExitShift){if(Ie=$c.a.nh(wd.Mb)){(hd=this.gs(hd).Kla)&&hd.s0c();k.a.Am&&document.activeElement.blur();var Oe={keyCode:117,type:"keydown",ctrlKey:!0};Oe.shiftKey=qd===OSF.AgaveHostAction.CtrlF6ExitShift;Oe.srcElement=Object(Aa.a)(270,
hd)?hd.AIb:lb.f(this.$).hj;hd=new Sys.UI.DomEvent(Oe);Ie.cAa(hd)}}else if(qd===OSF.AgaveHostAction.PageIsReady){if((hd=this.gs(hd).Kla)&&hd.gfb===OSF.OsfControlTarget.TaskPane&&(hd=null,(hd=He.a.Ut()?$c.a.nh(wd["if"]):this.$.la.kh(183))&&this.Fl))for(Ie of this.Fl)Rd.s1a(Ie.OX)&&hd.Vp(!0,!1)}else if(qd===OSF.AgaveHostAction.TabExit){qd=this.gs(hd);const Qd=qd.Kla;Qd?Qd.gfb===OSF.OsfControlTarget.InContent?Qd.o5f():Qd.gfb===OSF.OsfControlTarget.TaskPane&&(k.a.Am&&document.activeElement.blur(),He.a.Ut()?
void $c.a.resolve(wd["if"],{va:3}).then(me=>{const se=Object(Aa.a)(270,Qd)?Qd:null;se?se.isResizable?me.focusResizeHandle():me.focusTabbedTaskPaneArea():me.focusTabbedTaskPaneArea()}):Pa.a.cp().then(me=>{const se=Object(Aa.a)(270,Qd)?Qd:null;se?se.isResizable?me.focusResizeHandle():me.focusTabbedTaskPaneArea():me.focusTabbedTaskPaneArea();return null})):qd&&4===qd.osfControlType&&this.Dr.notifyAgave(hd,OSF.AgaveHostAction.TabIn)}else if(qd===OSF.AgaveHostAction.TabExitShift)(qd=this.gs(hd),Ie=qd.Kla)?
Ie.gfb===OSF.OsfControlTarget.InContent?Ie.p5f():Ie.gfb===OSF.OsfControlTarget.TaskPane&&(hd=Object(Aa.a)(270,Ie)?Ie:null)&&(k.a.Am&&document.activeElement.blur(),hd.SDk()):qd&&4===qd.osfControlType&&this.Dr.notifyAgave(hd,OSF.AgaveHostAction.TabIn);else if(qd===OSF.AgaveHostAction.EscExit||qd===OSF.AgaveHostAction.ExitNoFocusable||qd===OSF.AgaveHostAction.ExitNoFocusableShift)if(Ie=this.gs(hd).Kla)Ie.s0c();else{if(qd===OSF.AgaveHostAction.EscExit){qd=null;for(Oe of H.f0i())if(Oe.value.kl===hd){Oe.value.dialog.hide();
qd=Oe.key;break}qd&&(hd=this.gs(qd))&&4!==hd.osfControlType&&this.Cl.notifyAgave(qd,OSF.AgaveHostAction.TabIn)}}else if(qd===OSF.AgaveHostAction.InstallCustomFunctions)if(ub.EwaSettings.Ra(114)){Gf.a(this.$).BBf(()=>!1);var Vb=this.$.la;Td.TaskExtensions.Xa(ze.GetServiceTaskFactory.Tj(Vb,278,279,1),Qd=>{Qd=Qd.result;Vb.kh(278)||Vb.Hh(278,Qd);const me=je.osfControl.getStoreType();Qd.QVf(je.osfControl.getSolutionId(),me,Rd.bJi(je.osfControl),je).jBa()},this.ya,3)}else h.ULS.sendTraceTag(537170577,0,
10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(qd===OSF.AgaveHostAction.UninstallCustomFunctions)if(ub.EwaSettings.Ra(114)){Gf.a(this.$).BBf(()=>!1);var fd=this.$.la;Td.TaskExtensions.Xa(ze.GetServiceTaskFactory.Tj(fd,278,279,1),Qd=>{Qd=Qd.result;fd.kh(278)||fd.Hh(278,Qd);Qd.c4g(je.solutionId,je.storeType).jBa()},this.ya,3)}else h.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");
else qd===OSF.AgaveHostAction.SendTelemetryEvent?Hc.a.sendOtelEvent({otelEvent:je}):qd===OSF.AgaveHostAction.SendCustomerContent?Hc.a.sendOtelCustomerContent({otelEvent:je}):qd===OSF.AgaveHostAction.LaunchExtensionComponent?r.a.instance.Rvj(je):qd===OSF.AgaveHostAction.RefreshRibbonGallery?void $c.a.resolve(wd.pe,{va:0}).then(Qd=>{Qd.PQd(je)}):qd===OSF.AgaveHostAction.RemoveAppCommandsAddin?this.Tkk(je.solutionId):qd===OSF.AgaveHostAction.GetOriginalControlId&&(hd=new sa.a(this.$.xi,je.ownerAddinSolutionId,
new xc.a,!0),je.originalControlId=hd?hd.unf(je.controlId):je.controlId)};this.wNg=(hd,qd)=>{const je=Array(2);je[0]=qd;je[1]=null;this.ao.jxi(hd,JSON.stringify(je))};this.ysg=()=>{this.$.ma&&Md.n(this.$.ma)&&(wd.Ug.Aa()?this.webExtensionView.QUb():vb.a(this.$).QUb())};this.Cj=()=>{this.y7f()};this.onBlockCacheItemChanged=(hd,qd)=>{hd=qd.mj;(hd=(hd=hd.block.state&1?hd.block.Pj:null)?hd.CustomFunctionsObjects:null)&&this.izd(hd)};this.O1=(hd,qd)=>{var je,Ie;1===qd.tx&&(hd=qd.Ul)&&(qd=new Mc(Cf.toTimestamp(hd.enqueueUtcTime),
Cf.toTimestamp(hd.processUtcTime),Cf.toTimestamp(hd.dequeueUtcTime),Cf.getElapsedMilliseconds(hd.enqueueUtcTime,hd.processUtcTime),Cf.getElapsedMilliseconds(hd.processUtcTime,hd.dequeueUtcTime),hd.operationCount,(null===(Ie=null===(je=hd.operation)||void 0===je?void 0:je.pk)||void 0===Ie?0:Ie.ServerCorrelationId)?hd.operation.pk.ServerCorrelationId:null,hd.operation?Enum.toString(ye.a,hd.operation.operationName):null,Dc.a.UM(Cf.getElapsedMilliseconds(hd.enqueueUtcTime,Af.a.ih.ri))),je=Sys.Serialization.JavaScriptSerializer.serialize(qd),
h.ULS.sendTraceTag(50872916,0,50,je))};this.FOc=()=>{this.yDg()};this.ij=(hd,qd)=>{!this.ea.ki&&oe.a(qd)?this.yDg():(qd.RM&&(h.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.qIg()),this.ZV(),ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.ecc=!1))};this.$t=()=>{ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(h.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),
this.qIg());this.ZV();ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.ecc=!1)};this.Zvg=hd=>{hd=hd.Result;if(hd=null===hd||void 0===hd?void 0:hd.AgaveData){var qd=hd.PrimaryMarketplace.SolutionId;qd=hd.SrcLocationOverrideResourceId?this.zJa(hd.PrimaryMarketplace.SolutionId,hd.SrcLocationOverrideResourceId):qd;if(qd=this.jHd(qd))this.Ggd.ga(hd.InstanceId,qd.controlId),this.Vgd.ga(qd.controlId,hd.InstanceId)}else h.ULS.sendTraceTag(507637772,0,10,"Silent Reload::postServerReloadSuccess: failed to return valid response.")};
this.ljg=hd=>{hd.WOc();this.raiseEvent("cd",hd.controlId)};this.th=va;this.webExtensionView=Nc;this.Dqd=Bb;this.initialize(Ac);Ba.Ba(this);this.GJg=0;(va=(va=!(k.a.Zx||k.a.j1))&&!k.a.Am)&&OfficeExt.ShortcutKeyDispatchManager.init();this.mnh={}}get Cfb(){return this.g9||(this.g9=new hb.a(this.$.pK))}$od(va){this.addHandler("cd",va)}fmk(va){this.removeHandler("cd",va)}RBh(va){this.addHandler("csc",va)}hmk(va){this.removeHandler("csc",va)}OBh(va){this.addHandler("ca",va)}emk(va){this.removeHandler("ca",
va)}PBh(va){this.addHandler("ci",va)}QBh(va){this.addHandler("ekros",va)}gmk(va){this.removeHandler("ekros",va)}dce(va,Bb){try{return JSON.parse(va)[Bb].toLowerCase()}catch(Ac){return""}}oKk(va){const Bb=this.dce(va,"AudienceGroup"),Ac=this.dce(va,"SessionOrigin");try{const Nc=parseInt(this.dce(va,"Ring"),10);if("automation"!==Bb&&"bluechicken"!==Ac&&-2<=Nc)return!0}catch(Nc){if("automation"!==Bb&&"bluechicken"!==Ac)return!0}return!1}get Cl(){if(!this.Dr){const va={},Bb=!(this.$.Ij&1),Ac=dc.a.current.SS,
Nc=this.$.workbookContext,hd=w.AFrameworkApplication.W8?w.AFrameworkApplication.fa.Ya("StaticContentHostNonOverriden"):ac.a.sW,qd=hd+ac.a.Urc;va.pageBaseUrl=Ac.LayoutsContentUrlPrefix;va.appName=OSF.AppName.ExcelWebApp;va.appVersion="16";va.appSettings=this.JNi();va.singleSignOnSettings=ba.a.cXi();va.clientMode=Bb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;va.appUILocale=this.$.ua.UICultureTag;va.dataLocale=this.$.ua.DataCultureTag;va.docUrl=Nc.ClientUrl;va.hostControl=this;va.formFactor=OSF.FormFactor.Default;
va.lcid=this.$.EN.toString();va.localizedScriptsUrl=hd+ac.a.Jhf;va.localizedImagesUrl=qd;va.localizedStylesUrl=hd+ac.a.Ghf;va.localizedResourcesUrl=qd;va.osfOmexBaseUrl=Ac.OsfOmexBaseUrl;va.firstPartyManifestCDNUrl=Ac.FirstPartyAddInManifestCDN;va.sdxAssetsToPrefetchMapping=w.AFrameworkApplication.fa.Ya("SdxAssetsToPrefetchMapping");va.sdxCdnUrl=Ac.SdxCdnUrl;va.sdx1CdnUrl=Ac.Sdx1CdnUrl;va.forceUseSdx1Cdn=Ac.ForceUseSdx1Cdn;va.sdxDmsUrl=Ac.SdxDmsUrl;va.sovereignFederationDMSToken=Ac.SovereignFederationDMSToken;
va.sovereignFederationDMSTokenSuffix=Ac.SovereignFederationDMSTokenSuffix;va.defaultManifestTokens=w.AFrameworkApplication.defaultManifestTokens;va.devCatalogUrl=Ac.DevCatalogUrl;va.controlStatusChanged=this.$Pc;va.notifyHost=this.zpa;va.allowExternalMarketplace=this.$.ea.Vn.get(27)&&Rd.eMb;va.enableAddinCommands=ub.EwaSettings.Ra(52);va.enableBlackForestRedirect=ub.EwaSettings.Ra(87);va.enableMyOrg=this.$.ea.Vn.get(33);va.enableMyApps=this.$.ea.Vn.get(34);va.enableDevCatalog=ub.EwaSettings.Ra(43);
va.enablePrivateCatalog=this.lLk();va.showSignOutFromPrivateCatalogMessage=this.$.ea.Vn.get(36);va.enableUploadFileDevCatalog=ub.EwaSettings.Ra(52)&&!ub.EwaSettings.Ra(254)&&Rd.JAe;va.userNameHashCode=J.a.qE(w.AFrameworkApplication.userName);va.envCode=this.$.ua.OfficeAddinTelemetryDataSourceCode.toString();va.enableSingleSignOnForAddin=w.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;va.enableDisplayBlockedMinorError=ub.EwaSettings.Ra(171);va.hideAppsExtensionUrl=w.AFrameworkApplication.hideAppsExtensionUrl;
va.enableAnonymousUseLegacyCatalogService=ub.EwaSettings.Ra(162);va.enableInsertDialogAccessibilityFix=ub.EwaSettings.Ra(169);va.disableAppsForOfficeThirdParty=ub.EwaSettings.Ra(174);va.enableFirstPartySSO=ub.EwaSettings.Ra(186);va.wacSessionId=this.$.ua.UserSessionId;va.disableLogging=!this.$.ua.AriaLoggingIsEnabled;va.enableFirstPartySDXErrorMessages=ub.EwaSettings.Ra(198);va.isHostDocumentDomain=ub.EwaSettings.Ra(209);va.loggableUserId=w.AFrameworkApplication.fa.Ya("LoggableUserId");va.sessionStartInfoJson=
w.AFrameworkApplication.fa.Ya("SessionStartInfoJson");va.wopiHostOriginFromPostMessage=w.AFrameworkApplication.wopiHostOriginFromPostMessage;va.wopiHostOriginFromWacPropBag=w.AFrameworkApplication.fa.Ya("PostMessageOrigin");va.wacIsEmbedded=w.AFrameworkApplication.fa.ka("IsEmbedded");va.accessibilityAllowFocusAddinTaskpane=w.AFrameworkApplication.fa.ka("AccessibilityAllowFocusAddinTaskpane");va.enableRemoveAppCommandsAddin=w.AFrameworkApplication.fa.ka("RemoveAppCommandsAddinIsEnabled");va.isHostFrameTrustCheckEnabledForAddIns=
w.AFrameworkApplication.fa.ka("HostFrameTrustCheckIsEnabledForAddIns");va.isHostFrameTrusted=w.AFrameworkApplication.isHostFrameTrusted;va.agaveAddinUploadEnabled=ub.EwaSettings.Ra(45);va.hostAllowedOfficeStore=w.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");va.hostAllowedSdxEmbedding=w.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");va.hostInstallAddIns=w.AFrameworkApplication.fa.Ya("HostInstallAddIns");va.hostInstallAddInsIsEnabled=w.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");
va.approvedAddIns=w.AFrameworkApplication.fa.Ya("ApprovedAddIns");va.addinEnforceHttpsIsEnabled=this.oKk(va.sessionStartInfoJson);va.hostFeatureGateFlag=0;va.isUpnCheckEnabled=w.AFrameworkApplication.fa.ka("IsUpnCheckEnabled");va.wacUpn=w.AFrameworkApplication.fa.Ya("UserPrincipalName");va.isReactRibbonEnabled=He.a.isReactRibbonEnabled();va.enableSetFocusOnTaskpaneOnUserAction=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);va.isSafariWithIndexedDBDisabled=
ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&k.a.Foa;va.isIndexedDBDisabled=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&k.a.Foa||ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&k.a.Am;va.enableCustomShortcuts=!0;va.changeGetModifierKeyStringOutputOrder=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");va.officeJsUrl=w.AFrameworkApplication.vJ("OfficeJs/excel.js",5);
va.enableOfficeJsUrlParam=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Dr=new OSF.ContextActivationManager(va);this.Dr.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.Dr.setWSA(w.AFrameworkApplication.cu);this.Dr&&"undefined"!==typeof this.Dr.hostCheckReadyHandler&&w.AFrameworkApplication.RCh(Object(Ub.a)(this.Dr,this.Dr.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const je=Ja.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.Dr.setOAuthManager(je)}catch(je){}}return this.Dr}get Cel(){return this.Fmd}get Xn(){return this.JWe}get gBa(){return this.GWe}get jme(){return this.KWe}get ime(){return this.IWe}get Ruk(){return this.MWe}get Puk(){return this.HWe}get Quk(){return this.LWe}get Suk(){return this.NWe}get Tuk(){return this.OWe}get kme(){return this.PWe}get FJg(){return this.QWe}get i6(){return this.mnh}get $(){return this.th}get hme(){return this.FWe}Yoc(va){const Bb={};Bb.Name=va.Name;Bb.BindingType=va.BindingType;
Bb.HasHeaders=va.HasHeaders;va.IsValidRef&&(Bb.ColCount=va.Reference.LastColumn-va.Reference.FirstColumn+1,Bb.RowCount=va.Reference.LastRow-va.Reference.FirstRow+1);return Bb}get uIb(){return w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")}K6f(va,Bb){const Ac=this.TOh(Bb);let Nc=null;if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==Bb&&"LaunchAddinDialogFromTellMe"===Bb[0])null!==Ac.assetId&&"undefined"!==typeof Ac.assetId&&(Nc="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.uIb){const hd=this.$.ea.Vn.get(27);!hd||null===Bb||"InsertMoreAddInsFromFooter"!==Bb[0]&&"InsertMoreAddInsFromBackstageFooter"!==Bb[0]?!hd||null===Bb||"AddinFlyoutMoreButton"!==Bb[0]&&"LaunchMyAddInsFromBackstage"!==Bb[0]||(Nc="0"):Nc="{98143890-AC66-440E-A448-ED8771A02D52}"}ub.EwaSettings.isChangeGateEnabled("OfficeVSO:8253544_LogTelemetryForStoreDialog")&&
Hc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.ShowStoreDialog",dataFields:bd.a.Rm({["controlId"]:null!==Bb?Bb[0]:"AllSources"})});this.Dr.launchInsertDialog(va,Nc,Ac)}get RZ(){return this.Fkd}get HUd(){return ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)}get Nmj(){return ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",!1)}mxa(va){return this.Vgd.lh(va)?this.Vgd.na(va):va}zaa(va){return this.Ggd.lh(va)?this.Ggd.na(va):
va}get mU(){return this.DVa}get DVa(){this.Aqd&&!this.MT&&(this.Jik&&this.imi(this.Vgh),this.MT=$a.createInstance(w.AFrameworkApplication.fa,new Db.a(()=>this.Dr),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.hZk,["AreThirdPartyAddInsAllowed"]:this.$.m4,["PopularAddinDetailsJsonString"]:this.jaf&&this.h7j?Rd.g7j:Rd.Ptb,["UICulture"]:w.AFrameworkApplication.uiCulture}));return this.MT}get hZk(){return ub.EwaSettings.Ra(174)}get allowExternalMarketplace(){return this.$.ea.Vn.get(27)}get Aqd(){return w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}static get Ptb(){return'[{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":45662}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":84}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1759}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":3,"AUP":6458}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":13200}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":73}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":10751}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":3216}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":872}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":3,"AUP":3973}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.7.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"33107.40f3490e-24f2-4502-9a44-28e543d36a75.71f00b00-2d16-4d33-9b7a-7b1cbdbbbf52.5eeb833f-109d-4a4b-8a7d-c5954dfd778e.png","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":822}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":1968}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":3473}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":346}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":1332}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":533}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":348}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":1167}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1755}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":374}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":9563}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":311}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":1247}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":444}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":54042}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":3,"AUP":699}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1898}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":851}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\'s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":3,"AUP":2986}},{"displayName":"OrbusInfinity Import Tool","solutionId":"wa200000421","version":"2.9.0.0","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your OrbusInfinity Repository","iconUrl":"58921.df1e5367-d9bc-46a7-8259-9b24225f294e.1638f80d-c1de-4a83-96d5-4dd2012058c9.0f1a47c7-5d54-427b-be34-d415727301cc.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":3,"AUP":144554}},{"displayName":"Workspace Lite Add-in","solutionId":"wa200000565","version":"1.0.0.75","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using LSEG\u2019s unique content and analytics","iconUrl":"29750.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.965e10e4-deeb-43e1-b9e3-5801171d8464.baa9f23e-6f54-4889-9419-35de7fe21515.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":516}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":1938}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1073}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":487}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\'s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":996}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":324}},{"displayName":"Excel Labs, a Microsoft Garage project","solutionId":"wa200003696","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"Try experimental features from the Microsoft Excel team.","iconUrl":"56617.70ef3bb6-fd4c-4868-b560-ed816d7473dd.47eea830-aced-47db-900a-a37347c5fdff.edeaaad8-6367-401c-9a40-138c4200c0ec.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":1616}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":798}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":1340}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":955}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":340}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.4.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":1297}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":-1,"AUP":58}},{"displayName":"Formula Bot | AI Formula Generation and Data Automation","solutionId":"wa200004935","version":"6.0.0.0","targetType":1,"width":0,"height":0,"description":"Revolutionize your analytics workflow, from formula generation to data automation.","iconUrl":"55472.02bef729-7dee-4518-80a6-f1201acff812.93152da9-df92-4449-86fb-7b5555756176.fa00d9a4-0225-4c45-a649-c70f05461582.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://formulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":4975}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Use ChatGPT with the CoPilot experience right within your favorite office app.","iconUrl":"33851.9a73910f-bc07-461c-a5aa-da58e2ce898e.fe022fd3-f2d4-4057-bd68-fd8ef192180a.ac2e20fb-999e-43fc-b780-f35d91b9db91.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":402}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":3,"AUP":41}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"2.4.4.0","targetType":1,"width":0,"height":0,"description":"Unlock the Power of Excel with AI intelligence - Chat GPT for Excel ","iconUrl":"19817.86bed75f-2814-457c-b505-403f890ae109.370b210a-a3c6-4be9-a1b5-9cd2ccfd6dc5.ff278ee8-b733-429b-b34b-9fc3b08d5bea.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":9879}},{"displayName":"Numerous.ai - ChatGPT for Excel","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":555}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":123}},{"displayName":"GPT for Excel Word","solutionId":"wa200005502","version":"1.0.0.11","targetType":1,"width":0,"height":0,"description":"Use GPT AI in Excel and Word to edit, translate, explain, ask, classify, extract, summarize.","iconUrl":"57573.f9f47c4a-38c2-4ed8-b7cc-a8815cd3dcd0.c5bed181-b36c-4c88-b989-056784b5402d.c22af8d2-689f-4982-b9e1-80b025140566.png","licenseUrl":"https://static.talarian.io/gpt-in-excel/GPT_in_Excel_TOS.pdf","privacyUrl":"https://talarian.io/privacy-policy","addinInfo":{"priority":1,"AUP":25712}},{"displayName":"Supermetrics","solutionId":"WA104381807","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Unlock the power of your marketing data in Excel with Supermetrics","iconUrl":"19350.bb8cdc30-0a91-4002-884a-b62395c980a4.49156328-1344-48b2-b77d-a29f2fddb106.210c5e26-f550-4bf3-825d-674d9f004172.png","licenseUrl":"https://supermetrics.com/terms-of-service","privacyUrl":"https://supermetrics.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Business Assist - Forecast","solutionId":"WA200005702","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Reduce your organization\'s helpdesk cost by using Business Assist Forecast.","iconUrl":"14472.f9e7cd0c-b0a1-46c9-8121-703e461934bb.9bb6db57-0f7e-4365-83e3-c71dfb411640.49c33548-12d6-4184-a39c-04b1918d113e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":78}},{"displayName":"Autopilot","solutionId":"WA200005669","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Free - Use ChatGPT within Microsoft Office with a Copilot experience.","iconUrl":"63616.36723807-bf6b-458b-85d4-c6c068296f33.f8d6629a-b2a5-468d-9d29-61660784380c.50af4801-c087-475b-af11-23b4531d0479.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":3,"AUP":586}},{"displayName":"Compare and Merge for Excel","solutionId":"WA200005782","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Compare Excel data within minutes. Find and resolve differences. Save hours of manual data review.","iconUrl":"30074.934ac94e-6eb5-42e9-bd61-d950303e2383.64b35664-874b-4eea-a5c5-22b9b1dfa6fd.d9552652-5a80-4f6b-b7dc-254b48fbb5ff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.strivetech.com/apps/excelcompareandmergeprivacy","addinInfo":{"priority":3,"AUP":135}},{"displayName":"Array Assistant","solutionId":"WA200005565","version":"1.0.1.0","targetType":1,"width":0,"height":0,"description":"Your AI Excel Assistant, Helping You Work Smarter and Faster! Try your first two weeks for Free!","iconUrl":"19248.dfd99dce-ae19-48c0-89aa-3654a01080ce.5d15e809-f4e4-42e1-813f-8235aab23209.6bb22ab5-ef1d-4810-8ad3-b0ac5496fc4e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://arrayassistant.ai/legal","addinInfo":{"priority":3,"AUP":100}},{"displayName":"Webex","solutionId":"WA200000068","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Bring Webex messaging and collaboration to your Microsoft files.","iconUrl":"39598.b4ad1d22-0361-475d-8552-534f8374babf.520bf26d-4b81-43fa-ac63-415826cb02fb.11a6abf0-7171-48ff-8c69-26b9e338033f.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848812/Product_42949683051/Asset_46d15f2a-cf03-461d-bd9f-9633d61422c9/universalcloudagreement.pdf","privacyUrl":"https://www.cisco.com/c/en/us/about/legal/privacy-full.html","addinInfo":{"priority":3,"AUP":192}},{"displayName":"draw.io Diagrams","solutionId":"WA200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":1,"AUP":797}},{"displayName":"Personalised QR Code Generator","solutionId":"WA200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":156}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"WA104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":1249}},{"displayName":"Wikipedia","solutionId":"WA104099688","version":"1.7.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":332}},{"displayName":"Bing Maps","solutionId":"WA102957661","version":"1.6.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":13556}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"WA104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":-1,"AUP":697}},{"displayName":"CSV Import+Export","solutionId":"WA200000025","version":"1.0.0","targetType":1,"width":0,"height":0,"description":"Import and export CSV files on Excel.","iconUrl":"58575.082549a1-a61c-4d6a-b397-1281a6b2818d.f4f41bd6-d825-4219-af6e-da610c4a7324.1b9d835d-23bf-45b0-818d-783bef621094.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.emeditor.com/about/privacy-policy","addinInfo":{"priority":3,"AUP":858}},{"displayName":"Money in Excel","solutionId":"WA200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.asp","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Isograd Learning Platform","solutionId":"WA200006017","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Isograd Learning Platform is an online courseware solution for Microsoft 2019 and Microsoft 365.","iconUrl":"6539.d4a08e78-43e8-4bd4-823f-8b9bb98f71c8.358fe9da-edf0-4bd2-8f23-eabe1b2de609.79a5fd12-e871-4f4b-ad2d-e3265cff3b2c.png","licenseUrl":"https://learning.isograd.com/eula","privacyUrl":"https://learning.isograd.com/privacypolicy","addinInfo":{"priority":3,"AUP":10}},{"displayName":"Bracket Builder","solutionId":"WA200006008","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Build double elimination tournament brackets compatible with Little League","iconUrl":"50028.22f4f90a-426f-475a-beba-d0189799b8bd.7f3ed4ca-2f1a-436c-9839-dd7764195b7f.db54fea0-fdaf-44f7-a816-41361b822660.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://addin.red.traynrex.com/help/Privacy.html","addinInfo":{"priority":3,"AUP":3}},{"displayName":"Excel Send to Trello","solutionId":"WA200005960","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"This Excel add-in makes it easy to bulk create cards in Trello from a table.","iconUrl":"8664.52ca8fd6-95d6-47e7-b679-b9f888571bc7.5efe9dcf-a87f-4171-ac66-cb9c30b5226e.5d8ecce4-7fc8-49dd-87fd-07095c48deac.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://kryl.com/?page=/privacy","addinInfo":{"priority":3,"AUP":3}},{"displayName":"XperienceED","solutionId":"WA200005817","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Web-based, hands-on learning for Microsoft 365 Apps and Microsoft 2019.","iconUrl":"6120.0e948c8b-c5cf-4b7a-b18f-3d59a7105ce2.fcdc57d0-ecf7-430c-94c1-9742dc8a097c.af83a49b-bd1c-43a3-bf7d-9c061ec545c8.png","licenseUrl":"https://ccilearning.com/wp-content/uploads/2023/03/XperienceED-EULA-August-14-2022_clear.docx","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":7}},{"displayName":"Green Street Add-In","solutionId":"WA200005876","version":"1.0.4.24","targetType":1,"width":0,"height":0,"description":"Enhance your investment analyses with Green Street\'s industry leading commercial real estate data ","iconUrl":"49943.bc2d4344-5f24-4610-b662-91c4934d717d.590cce90-117c-42db-baa3-83d5d7daa95f.c83b6cf7-1070-4e11-896f-53331b434c3e.png","licenseUrl":"https://www.greenstreet.com/termsofuse","privacyUrl":"https://files.greenstreet.com/public_files/GlobalPrivacyPolicy.pdf","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"R2 Copilot: Private Chat GPT for Excel","solutionId":"WA200006007","version":"1.0.4.0","targetType":1,"width":0,"height":0,"description":"R2 Copilot is a privacy-centric, GPT-powered AI assistant for your everyday business communications.","iconUrl":"56225.35fd77ec-1e64-4d91-b540-7e993a97b899.736533f6-6174-46c6-9736-9d0074bc04cb.93461044-7ae6-496e-abfb-17b484279f77.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://r2copilot.ai/policy","addinInfo":{"priority":2,"AUP":252}},{"displayName":"Spreadsheet AI","solutionId":"WA200006009","version":"1.0.1.6","targetType":1,"width":0,"height":0,"description":"AI chat copilot in Excel who understands your workbook and assists with countless spreadsheet tasks.","iconUrl":"14669.7db070f8-5e86-4224-b93c-0f0447636b16.132765a9-fdd4-41f1-9c90-aa6f0d6b82dc.45c767b9-81c9-4813-a7d1-462156cc844b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/docs/privacy","addinInfo":{"priority":2,"AUP":76}},{"displayName":"Widata","solutionId":"WA200005777","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"WiData is a platform seamlessly integrated into Excel to assist you in accessing all financial data","iconUrl":"42486.cf83fc97-7cc4-4fc9-a442-27252297bd9d.a3b30b83-17e9-41ef-88f3-72c47dfaee63.4eb440c2-941b-4d85-bc6f-a0c115f258ab.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.widata.vn/en/ch%C3%ADnh-s%C3%A1ch-b%E1%BA%A3o-m%E1%BA%ADt","addinInfo":{"priority":3,"AUP":25}},{"displayName":"McGraw Hill","solutionId":"WA200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":-1,"AUP":176861}},{"displayName":"Web Video Player","solutionId":"WA104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":294}},{"displayName":"AP Essentials Online Reports","solutionId":"WA200004805","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Easily generate Excel reports of your AP Essentials documents.","iconUrl":"46463.4f2ef016-20cb-4469-89c8-91b3ed852e94.bc9b4ced-e86a-461d-bf3e-ea85bc5923db.3fc71624-1087-40f3-bdbf-d437b17759cb.png","licenseUrl":"https://www.kofax.com/legal/terms-of-service","privacyUrl":"https://www.kofax.com/Legal/Privacy","addinInfo":{"priority":-1,"AUP":225}},{"displayName":"Velixo","solutionId":"WA200002311","version":"1.2023.8.64","targetType":1,"width":0,"height":0,"description":"Excel-based reporting for your ERP. Build your own reports in less than 5 minutes!","iconUrl":"56800.9a67df19-bebd-46e1-932f-c05f1da5d162.aded0159-fc94-4c0e-922c-a61decdb9403.0ad5536a-3258-403d-8f0a-adb854889d11.png","licenseUrl":"https://www.velixo.com/eula","privacyUrl":"https://www.velixo.com/privacy-policy","addinInfo":{"priority":2,"AUP":880}},{"displayName":"Mail Merge","solutionId":"WA200006466","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Send personalized emails with Excel, create email drafts or schedule emails for sending later.","iconUrl":"6987.7e407018-9102-4508-a2e9-e769a41b7735.b8d24346-5fb6-49bf-b22b-7baa15ddcad8.847e5579-8358-4333-a405-47191f54a8c1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://digitalinspiration.com/privacy","addinInfo":{"priority":2,"AUP":18}},{"displayName":"NielsenIQ Discover","solutionId":"WA200004632","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"The new NielsenIQ Discover add-In makes generating robust Excel reports faster and easier than ever.","iconUrl":"31362.41c487ba-25d8-4918-a85c-916c87cf1a6d.f8335a3c-da4c-4faa-85ef-58d1bd876169.9204b71b-9802-4510-b8d0-81455582dd72.png","licenseUrl":"https://nielseniq.com/global/en/legal/terms-of-use","privacyUrl":"https://nielseniq.com/global/en/legal/privacy-policy","addinInfo":{"priority":-1,"AUP":180}}]'}static get g7j(){return'[{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541}}]'}get h7j(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinDetailsForTestEnabled",
!1)}get jaf(){return"Dev Box"===w.AFrameworkApplication.fa.Ya("StatusBarEnvironmentNameToUse")}get Jik(){return w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}imi(va){window.setTimeout(()=>{this.iti()},va)}iti(){this.u7c?h.ULS.sendTraceTag(508826715,220,50,"The 1st attempt succeeded."):(h.ULS.sendTraceTag(508826716,220,15,"the 1st attempt was timeout, trigger another try."),this.qG(0,!0))}static L2a(va){return 0===va||10===
va}Yub(va,Bb){this.DVa&&this.DVa.Yub(va,Bb)}qG(va,Bb){this.DVa&&(!this.u7c&&Rd.L2a(va)&&(this.u7c=!0),this.DVa.qG(va,Bb))}dUc(va){this.DVa&&this.DVa.OAa(va)}uJh(va,Bb){return D.a.zm().equals(va.solutionId,Bb.solutionId)&&D.a.zm().equals(va.storeType,Bb.storeType)}pfe(va,Bb){if(w.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.Myg(va,Bb,OSF.StoreTypeEnum.MarketPlace);else{const Ac={};Ac.callbackFunc=va;Ac.storeType=OSF.StoreTypeEnum.MarketPlace;
Ac.fromInsertDialog=!1;Ac.refresh=Bb;this.Dr.queryEntitlementDetails(Ac)}}Myg(va,Bb,Ac){const Nc={};Nc.callbackFunc=va;Nc.storeType=Ac;Nc.fromInsertDialog=!1;Nc.refresh=Bb;this.Dr.queryEntitlementDetails(Nc)}invokeDdaMethod(va,Bb){const Ac=this.gs(va.DdaMethod.ControlId);if(Ac){if(this.HUd&&this.RZ){const Nc=this.mxa(va.DdaMethod.ControlId);va.DdaMethod.ControlId=Nc}Ac.invokeDdaMethod(va,Bb)}else this.lo(pb.a.internalError,Bb)}registerDdaEventAsync(va,Bb,Ac,Nc,hd){(Bb=this.gs(Bb))?Rd.hWb(va)?Bb.xhk(va,
Ac,Nc,hd):this.lo(pb.a.tbe,hd):this.lo(pb.a.internalError,hd)}unregisterDdaEventAsync(va,Bb,Ac,Nc,hd){(Bb=this.gs(Bb))?Rd.hWb(va)?Bb.w5k(va,Ac,Nc,hd):this.lo(pb.a.tbe,hd):this.lo(pb.a.internalError,hd)}dispose(){if(!this.disposed){this.$.Wr(this.Cj);this.ea.Clk(this.FOc);this.ea.Uq(this.ij);this.ea.aQ(this.$t);this.ea.LA(this.Dl);this.Dqd.detach(this);this.$.userOperationManager.uu(this.O1);const va=lb.f(this.$);null===va||void 0===va?void 0:va.za.Zy(this.onBlockCacheItemChanged);this.jRc=this.Fl=
this.ao=this.Dqd=this.th=null;this.TYa&&(this.TYa.dispose(),this.TYa=null);zc.a.dh(this.jme);zc.a.dh(this.ime);this.zib&&(this.zib.dispose(),this.zib=null);super.dispose();this.disposed=!0;h.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed")}}dLd(va){return(va=this.gs(va))?va.getDefaultIconUrl():null}xYc(va){if(this.Zmf!==va){this.Zmf=va;for(let Bb=0,Ac=this.Fl.length;Bb<Ac;Bb++){const Nc=this.Fl[Bb];va?Nc.Jpf(!1):Nc.Jki()}this.jme.xYc(va);this.ime.xYc(va)}}CJi(va){return(va=this.gs(va))?va.getDefaultDisplayName():
null}lo(va,Bb,Ac){const Nc={};Nc[fa.a.Xk]=va;Nc[fa.a.Gfa]=Bb;this.aV(451041795,Nc,void 0===Ac?!0:Ac)}zE(va){const Bb={};Bb[fa.a.Gfa]=va;this.aV(1237877382,Bb)}aV(va,Bb,Ac){Ac=void 0===Ac?!0:Ac;const Nc=new Gc.a(va,0,this.$.hi,0,null),hd=Bb?Bb[fa.a.Gfa]:null;this.zib&&lb.f(this.$).isEditing&&kb.HZh(va,Bb)?this.zib.Sci(va,Bb):(va=this.$.Ma.qh(Nc,Bb),Ac&&Td.TaskExtensions.Xa(va,qd=>{jf.a(qd)?this.lo(pb.a.internalError,hd,!1):qd.result||(lb.f(this.$).isEditing?this.lo(pb.a.fVb,hd,!1):this.lo(pb.a.internalError,
hd,!1))},this.ya,8))}l1h(va){return!!this.Awa(Bb=>Rd.getSolutionId(Bb.io,this.$)===Rd.getSolutionId(va,this.$)&&Bb.io.PrimaryMarketplace.MarketplaceType===va.PrimaryMarketplace.MarketplaceType&&Bb.io.PrimaryMarketplace.MarketplaceRef===va.PrimaryMarketplace.MarketplaceRef&&Bb.io.PrimaryMarketplace.SolutionVersion===va.PrimaryMarketplace.SolutionVersion)}gs(va){return this.Awa(Bb=>Bb.controlId.startsWith(va))}zZa(va){let Bb=va;this.RZ&&(Bb=this.zaa(va));return this.gs(Bb)}Mwi(va){return this.Awa(Bb=>
Bb.$Ha===va)}Ozf(va){return this.Awa(Bb=>Bb.OX===va&&!!Bb.$Ha)}$zf(va,Bb,Ac,Nc){return this.Awa(hd=>hd.OX===va&&hd.io.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Bb.toLowerCase()&&hd.io.PrimaryMarketplace.MarketplaceType.toLowerCase()===Ac.toLowerCase()&&!!hd.io.SharedRuntime&&!!hd.io.SharedRuntime.Resid&&!!Nc&&!!Nc.Resid&&hd.io.SharedRuntime.Resid.toLowerCase()===Nc.Resid.toLowerCase())}fKh(va,Bb){if(va=this.gs(va))va.Ba(Bb),va.showHide(!0)}APk(va){(va=this.gs(va))&&va.showHide(!1)}YXa(va){var Bb;
if(1!==va.WebExtensionType||this.$.Ij&8388608&&va.TaskpaneVisible||this.$.Ij&8388608&&!va.TaskpaneVisible&&zd.HelperMethods.XF(va)){let Ac=null;zd.HelperMethods.XF(va)&&(Ac=Rd.DJa(va,this.$),va.TaskpaneWidth||(va.TaskpaneWidth=this.GNb));const Nc=(new Ab(this,this.ao,va,this.webExtensionView)).uTd();h.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(va.PrimaryMarketplace.SolutionId,va.OwnerAddinStoreType||va.PrimaryMarketplace.MarketplaceType,
null===(Bb=va.AssetMarketplace)||void 0===Bb?void 0:Bb.SolutionId,null,null,va.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${va.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${zd.HelperMethods.XF(va)}`);Ac&&(Nc.$Ha=Ac);this.Fl.push(Nc);this.gMa=null;this.Fnb(va.InstanceId)||(va=String.format("{0}|{1}|{2}|{3}|{4}",va.PrimaryMarketplace.SolutionId,va.PrimaryMarketplace.SolutionVersion,va.PrimaryMarketplace.MarketplaceRef,va.PrimaryMarketplace.MarketplaceType,va.WebExtensionType),this.raiseEvent("ci",
va))}}DRk(va,Bb){va.TaskpaneWidth=this.GNb;va.TaskpaneVisible=!0;const Ac={};Ac.SolutionId=va.PrimaryMarketplace.SolutionId;Ac.TargetType=va.WebExtensionType;Ac.Version=va.PrimaryMarketplace.SolutionVersion;Ac.StoreType=va.PrimaryMarketplace.MarketplaceType;Ac.StoreId=va.PrimaryMarketplace.MarketplaceRef;va.AssetMarketplace?(Ac.AssetId=va.AssetMarketplace.SolutionId,Ac.AssetStoreId=va.AssetMarketplace.MarketplaceRef):(Ac.AssetId=null,Ac.AssetStoreId=null);Ac.Width=va.TaskpaneWidth;const Nc=new Ab(this,
this.ao,va,this.webExtensionView,!0);Nc.uTd();this.Fl.push(Nc);const hd=()=>{this.L6a(Nc.controlId);this.Cl.purgeOsfControl(Nc.controlId,!1);Bb()};let qd=null;qd=of.a.instance.LO(()=>{Nc.lG&&(zc.a.dh(qd),qd=null,this.Cl.insertBlankControlWithErrorUX(this.r3b(Nc,Ac),hd))},100,lf.a.Bbi)}izd(va){if(va&&va.length){var Bb=[];va.forEach(Ac=>{if(Ac.ContainsCustomFunctions){const Nc=Rd.DJa(Ac,this.$);this.Ace.contains(Nc)||(this.Ace.add(Nc),this.Nug.push(Ac));this.l1h(Ac)||Bb.push(Ac)}});Bb.length&&this.Zjf(Bb)}}hmf(va,
Bb){this.gs(va.InstanceId)||(Bb=Bb(),va=(new Ab(this,this.ao,va,this.webExtensionView)).FUf(Bb),this.Fl.push(va),this.gMa=null)}ROk(va){Rd.uib.lh(va)&&Rd.uib.na(va).initializeAndShowWithTitle()}N7i(va){Rd.uib.lh(va)&&Rd.uib.na(va).hide()}XRi(va){var Bb=null;let Ac=null;const Nc=Rd.CPd(va,!0);if(!Nc)return h.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),$d.Task.Ua(null);const hd=this.Dr.getOsfControl(Rd.getSolutionId(Nc,this.$));hd&&(Bb=
hd.getManifest())&&(Ac=Bb.getSharedRuntimeForCustomFunctions("Workbook"));if(Bb=Ac&&1===Ac.LifeTime?this.$zf(Nc.PrimaryMarketplace.SolutionId,Nc.PrimaryMarketplace.MarketplaceRef,Nc.PrimaryMarketplace.MarketplaceType,Ac):this.Mwi(va))return $d.Task.Ua(Bb.controlId);const qd=new Ib.a;zd.HelperMethods.hKc(Ac)&&(Nc.SharedRuntime=Ac);va=hd?hd.getNotificationParams():[];if(!va.length)return this.Gkf(Nc);this.kUg(va,()=>{Td.TaskExtensions.Xa(qd.task,()=>{this.Gkf(Nc)},this.ya,3)},()=>{});return qd.task}XDi(va){va=
Rd.CPd(va,!1);if(!va)return h.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let Bb=null;var Ac=this.Dr.getOsfControl(Rd.getSolutionId(va,this.$));Ac&&(Ac=Ac.getManifest())&&(Bb=Ac.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return zd.HelperMethods.hKc(Bb)&&(va=this.$zf(va.PrimaryMarketplace.SolutionId,va.PrimaryMarketplace.MarketplaceRef,va.PrimaryMarketplace.MarketplaceType,Bb))?va.controlId:null}R3h(va,Bb){var Ac=Rd.CPd(va,!1);if(Ac){var Nc=
null,hd=this.Dr.getOsfControl(Rd.getSolutionId(Ac,this.$));hd&&(hd=hd.getManifest())&&(Nc=hd.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(zd.HelperMethods.hKc(Nc)){Ac.SharedRuntime=Nc;var qd=Ac.PrimaryMarketplace.SolutionId;hd=Ac.PrimaryMarketplace.SolutionVersion;var je=OSF.OsfManifestManager.getCachedManifest(qd,hd);if(je)if(this.inc.lh(va))Nc=this.inc.na(va),Td.TaskExtensions.Xa(Nc,Vb=>{(Vb=Vb.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Vb,Bb,this.ao.Z6b)},
this.ya,3);else{var Ie={};Ie.solutionId=qd;Ie.version=hd;Ie.storeType=Ac.PrimaryMarketplace.MarketplaceType;Ie.storeId=Ac.PrimaryMarketplace.MarketplaceRef;Ac.AssetMarketplace?(Ie.assetId=Ac.AssetMarketplace.SolutionId,Ie.assetStoreId=Ac.AssetMarketplace.MarketplaceRef):(Ie.assetId=null,Ie.assetStoreId=null);Ie.targetType=OSF.OsfControlTarget.TaskPane;var Oe=new Ib.a;Ac=Td.TaskExtensions.Gq();Ac=new zb.a(this.$,this,Ie,Ac);Nc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(qd,Nc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(je,
Nc,hd);Ac.createUILessSandbox(Ie,je,(Vb,fd)=>{Vb&&!fd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Vb,Bb,this.ao.Z6b),Oe.setResult(Vb)):Oe.setResult(null);this.inc.remove(va)});this.inc.ga(va,Oe.task)}}}else h.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}Eef(va){(va=this.Ozf(va))&&(va.io.SharedRuntime||this.N4b(va.controlId))}N4b(va){(va=this.Ozf(va))&&this.L6a(va.controlId)}ahi(va,Bb){if(!this.Fl||!va||!Bb)return!1;
if(va.toLowerCase()===Bb.toLowerCase())return!0;let Ac=null,Nc=null;for(let hd=0,qd=this.Fl.length;hd<qd;hd++){const je=this.Fl[hd];if(je.ownerAddinSolutionId&&(je.controlId===va&&(Ac=je.ownerAddinSolutionId.toLowerCase()),je.controlId===Bb&&(Nc=je.ownerAddinSolutionId.toLowerCase()),Ac&&Nc))break}return Ac&&Ac===Nc?!0:!1}ezh(va){this.gs(va.InstanceId)||(va=new Ab(this,this.ao,va,this.webExtensionView),this.Fl.push(va),this.gMa=null)}lEg(va){if(this.Fl&&0<=va&&va<this.Fl.length){const Bb=this.Fl[va],
Ac=Bb.lG;this.Fl.splice(va,1);this.ljg(Bb);vd.DOMElementExtensions.an(Ac)}}L6a(va){if(this.Fl)for(let Bb=0,Ac=this.Fl.length;Bb<Ac;Bb++)if(this.Fl[Bb].controlId===va){this.lEg(Bb);break}}Tkk(va){if(this.Fl){va=va.toLowerCase();for(let Bb=0,Ac=this.Fl.length;Bb<Ac;Bb++)if(va===this.Fl[Bb].ownerAddinSolutionId.toLowerCase()){this.lEg(Bb);break}}}JKh(va){va.Wv&&(this.gs(va.floatingObject.io.InstanceId)||(this.eGc(va.floatingObject.io.InstanceId)||this.jRc.push(va.floatingObject.io.InstanceId),this.YXa(va.floatingObject.io)),
this.ea.isNamedObjectViewMode&&this.fKh(va.floatingObject.io.InstanceId,va.Vj))}jHd(va){return null==this.Fl?null:this.Fl.find(Bb=>1===Bb.controlType&&Hf.a.equals(Bb.OX,va,!0))}x5(va){if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return va=this.jHd(va),null===va||void 0===va?void 0:va.controlId;if(this.Fl)for(let Bb=0,Ac=this.Fl.length;Bb<Ac;Bb++)if(1===this.Fl[Bb].controlType&&Hf.a.equals(this.Fl[Bb].OX,va,!0))return this.Fl[Bb].controlId;return null}osj(va){return(va=
this.jHd(va))?va.visible:!1}nwi(va){const Bb=[];if(this.Fl)for(let Ac=0,Nc=this.Fl.length;Ac<Nc;Ac++)Hf.a.equals(this.Fl[Ac].OX,va,!0)&&Bb.push(this.Fl[Ac].controlId);return Bb}Twi(va,Bb){if(!Bb||!va)return null;if(this.Fl)for(let Ac=0,Nc=this.Fl.length;Ac<Nc;Ac++)if(1===this.Fl[Ac].controlType&&Hf.a.equals(this.Fl[Ac].OX,va,!0)&&this.Fl[Ac].io.SharedRuntime&&Hf.a.equals(this.Fl[Ac].io.SharedRuntime.Resid,Bb.Resid,!0))return this.Fl[Ac].controlId;return null}zJa(va,Bb){Bb=void 0===Bb?null:Bb;return va?
Bb?`${va}.${Bb}`:va:""}Hef(va,Bb,Ac){if(this.gMa===va)return!0;this.gMa=va;let Nc=null,hd=!1;if(!Nc&&this.Fl)for(let qd=0,je=this.Fl.length;qd<je;qd++)if(1===this.Fl[qd].controlType&&Hf.a.equals(this.Fl[qd].OX,va,!0)){let Ie=!1,Oe=!1;Bb?(Ie=!0,Oe=!!this.Fl[qd].io.SharedRuntime&&Hf.a.equals(this.Fl[qd].io.SharedRuntime.Resid,Bb.Resid,!0)):Ac&&(Ie=!0,Oe=Hf.a.equals(this.Fl[qd].io.SharedRuntimeId,Ac,!0));if(!Ie||Oe){Oe&&this.Fl[qd].eF(!0);Nc=this.Fl[qd].controlId;hd=!0;this.gMa=null;break}}Nc&&this.raiseEvent("ca",
Nc);return hd}setAppRuntimeState(va,Bb){var Ac;if(va){let Nc;if((Nc=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?this.zZa(va):this.gs(va))&&zd.HelperMethods.XF(Nc.io))Nc.eF(Bb),Bb&&(this.raiseEvent("ca",va),(null===(Ac=Nc.lG)||void 0===Ac?0:Ac.firstChild)&&(va=Nc.lG.firstChild.title)&&0<va.length&&this.Cfb.gAk(va));else throw h.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation($b.a.instance.ia(2250));
}else throw h.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation($b.a.instance.ia(2251));}getAppRuntimeState(va){if(va)if((va=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?this.zZa(va):this.gs(va))&&zd.HelperMethods.XF(va.io))va=va.io.TaskpaneVisible;else throw h.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation($b.a.instance.ia(2250));else throw h.ULS.sendTraceTag(537170562,
0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation($b.a.instance.ia(2251));return va}nkb(va,Bb){return(va=this.gs(va))?va.nkb(Bb):null}Fnb(va){return this.Jef(this.jRc,va)}eGc(va){return this.Jef(this.Tmf,va)}g2e(va){this.Tmf.push(va)}aY(va){return(va=this.gs(va))?va.io:null}O7d(va){this.raiseEvent("ekros",va,this)}$rg(va){if(va){var Bb=this.gs(va.InstanceId);Bb&&(va.SharedRuntime||va.SharedRuntimeId||(this.L6a(Bb.controlId),this.Cl.purgeOsfControl(Bb.controlId,!1)),Bb={},Bb.SolutionId=
va.PrimaryMarketplace.SolutionId,Bb.TargetType=va.WebExtensionType,Bb.Version=va.PrimaryMarketplace.SolutionVersion,Bb.StoreType=va.PrimaryMarketplace.MarketplaceType,Bb.StoreId=va.PrimaryMarketplace.MarketplaceRef,va.AssetMarketplace?(Bb.AssetId=va.AssetMarketplace.SolutionId,Bb.AssetStoreId=va.AssetMarketplace.MarketplaceRef):(Bb.AssetId=null,Bb.AssetStoreId=null),Bb.Width=va.TaskpaneWidth,Bb.SharedRuntimeId=va.SharedRuntimeId,this.h2g(Bb))}}iwa(){this.ao.iwa()}HM(va,Bb,Ac){this.ao.HM(va,Bb,Ac)}hAf(va,
Bb){Bb=Rd.o9h(Bb);va=this.aY(va);this.ao.Gyc(va.InstanceId,2202,Oc.a.bW,Bb)}qHd(va){for(let Bb=0,Ac=this.Fl.length;Bb<Ac;Bb++)this.hAf(this.Fl[Bb].controlId,va)}exi(va,Bb){Bb=Rd.w4h(Bb);this.ao.Gyc(va,65539,"",Bb)}hxi(va,Bb,Ac){this.ao.Gyc(va,1,Bb,Ac)}dxi(va,Bb){this.ao.ixi(va,Bb)}N3h(va,Bb){return[[2,1E3,"",JSON.stringify([va,Bb]),0,!1]]}pXf(){return!!this.gBa&&this.gBa.zQf()}dXh(){this.gBa&&this.gBa.clear()}eAf(){if(this.gBa&&this.gBa.zQf()){var va=this.gBa.$Di();for(const Bb of va){va=this.nwi(Bb);
for(const Ac of va)this.ao.Gyc(Ac,65540,"","{}")}}}qhk(va){this.gBa.add(va)}t5k(va){this.gBa.remove(va)}Awa(va){if(!this.Fl)return null;for(const Bb of this.Fl)if(va(Bb))return Bb;return null}Gkf(va){const Bb=new Ib.a,Ac=Rd.DJa(va,this.$);if(zd.HelperMethods.XF(va))h.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.Kug(va,Nc=>{Nc?(va.InstanceId=Nc.InstanceId,va.WebExtensionOsfControlType=3,va.TaskpaneVisible=!1,this.YXa(va),Bb.setResult(va.InstanceId)):(h.ULS.sendTraceTag(537170530,
0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(va.PrimaryMarketplace.SolutionId,va.PrimaryMarketplace.MarketplaceType,null,null,null,va.PrimaryMarketplace.MarketplaceRef)} failed`),Bb.setException(Error.create("Null insert data")))});else{Rd.uib.ga(va.InstanceId,new na.a);const Nc=Rd.uib.na(va.InstanceId).Lma;this.y5h(va,Nc,Ac);this.Kug(va,null);Bb.setResult(va.InstanceId)}return Bb.task}y5h(va,Bb,Ac){this.gs(va.InstanceId)||(va=new Ab(this,this.ao,va,
this.webExtensionView),va.$Ha=Ac,va.FUf(Bb),this.Fl.push(va),this.gMa=null)}Kug(va,Bb){const Ac=Rd.DJa(va,this.$);if(!this.Ace.contains(Ac))this.Q2b.push(va),1<=this.Q2b.length&&this.Lug(va,Bb);else if(Bb)for(const Nc of this.Nug)if(Rd.DJa(Nc,this.$)===Ac){Bb(Nc,0);break}}Lug(va,Bb){let Ac=null;const Nc={};Nc.SolutionId=Rd.getSolutionId(va,this.$);Nc.TargetType=va.WebExtensionType;Nc.Version=va.PrimaryMarketplace.SolutionVersion;Nc.StoreType=va.PrimaryMarketplace.MarketplaceType;Nc.StoreId=va.PrimaryMarketplace.MarketplaceRef;
va.AssetMarketplace?(Nc.AssetId=va.AssetMarketplace.SolutionId,Nc.AssetStoreId=va.AssetMarketplace.MarketplaceRef):(Nc.AssetId=null,Nc.AssetStoreId=null);Nc.Width=va.TaskpaneWidth;Nc.ContainsCustomFunctions=!0;zd.HelperMethods.XF(va)&&(Nc.SharedRuntimeId=va.SharedRuntime.Resid);const hd=this.$.pa.ta;va=this.$.pa.ta.Vh();const qd=hd.$a(9,va);qd.sharedInfo=Nc;const je=Oe=>{Oe=ne.a.gk(Oe.data);h.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Lf.a.Yh(Oe)}`)},
Ie=Oe=>{Oe&&!Ef.a(Oe)||h.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Nc.SolutionId,Nc.StoreType,Nc.AssetId,null,null,Nc.StoreId)} finish with errors: ${Lf.a.Yh(Oe.Errors)}`);this.Q2b.shift();0<this.Q2b.length&&this.Lug(this.Q2b[0],Bb)};if(Bb){const Oe=Vb=>{const fd=Vb.Result;(Ac=fd?fd.AgaveData:null)||Bb(null,Vb.Errors?Vb.Errors[0].ErrorCause:5001);Bb(Ac,0)};va=(Vb,fd,Qd)=>te.h(hd,"InsertAgaveTaskpane",qd,Wb.c(Vb,Ie,Oe),Wb.b(fd,je),
Qd,null,0)}else va=(Oe,Vb,fd)=>te.h(hd,"InsertAgaveTaskpane",qd,Wb.c(Oe,Ie),Wb.b(Vb,je),fd,null,0);Zc.a(this.$.userOperationManager,va,Oe=>new tc.a(519,0,Oe,64),null)}lLk(){return this.$.uk.get(35)}Zkk(va){va=this.gs(va);(null===va||void 0===va?0:va.xqa)&&va.wEg()}M7d(va){var Bb=this.Awa(Ac=>Rd.s1a(Ac.OX));Bb&&(Bb=this.Cl.getOsfControl(Bb.controlId))&&Bb.notifyAgave(OSF.AgaveHostAction.SendMessage,va)}KXf(){return!!this.Awa(va=>1===va.controlType&&Rd.s1a(va.OX))}JXf(){const va=this.Awa(Bb=>Rd.s1a(Bb.OX));
return va?va.lG?vd.DOMElementExtensions.isVisible(va.lG):!1:!1}mPg(){const va=this.Awa(Bb=>Rd.s1a(Bb.OX));va&&(va.eF(!0),this.raiseEvent("ca",va.controlId))}initialize(va){var {DdaEventDispatch:Bb}=a(1522);const Ac=void 0===this.$||null===this.$||ub.EwaSettings.Ra(234);void 0!==this.$&&null!==this.$||h.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Ac&&h.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);
this.initialized||(wd.Ug.Aa()||Fd.WebExtensionView.sJb(this.$),this.ea=this.$.ea,this.ao=new Bb(this.$,this),this.$.mr(this.Cj),this.ea.K3e(this.FOc),this.ea.$q(this.ij),this.ea.oO(this.$t),this.ea.pz(this.Dl),this.$.userOperationManager.mw(this.O1),Bb=lb.f(this.$),null===Bb||void 0===Bb?void 0:Bb.za.nz(this.onBlockCacheItemChanged),this.y7f(),this.nWj(),this.Wbj(),wd.Ug.Aa(),wd.xb.Aa()||this.$.la.Hh(35,this),this.Dqd.Ba(this),Ac&&h.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),
this.JWe=new Oc.a,Ac&&h.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.MWe=new Lb(this.$,this.Xn,this.ao),new Hb(this.$,this.Xn,this.ao),this.KWe=new be(this.$,this.Xn,this.ao),this.IWe=new Pe(this.$,this.Xn,this.ao),this.HWe=new jc(this.$,this.Xn,this.ao),this.LWe=new hc(this.$,this.Xn,this.ao),this.NWe=new uc(this.$,this.Xn,this.ao),this.OWe=new Sc(this.$,this.Xn,this.ao),this.$.x6&&(this.PWe=new Xc(this.$,this.Xn,this.ao,this)),this.QWe=new Kd(this.$,
this.Xn,this.ao,va),this.zib=new kb(this,lb.f(this.$)),ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.GWe=new rb),this.FWe=new cb(this.$,this.Xn,this.ao),this.initialized=!0,h.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}Ywi(va){if(!this.gDa)return null;for(let Bb=0,Ac=this.gDa.length;Bb<Ac;Bb++)if(va.startsWith(this.gDa[Bb].WebExtensionId))return this.gDa[Bb];return null}y7f(){var va,Bb=this.ea;if(Bb.ki&&!this.ecc){if(Bb.workbookContext){if(this.Fmd=
this.$.ea.Vn.get(22),null===(va=Bb.workbookContext.WebExtensions)||void 0===va?0:va.length){va=Bb.workbookContext.WebExtensions;Bb=!1;if(w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TelemetryForAddinsWithinFileEnabled",!1)&&0<va.length){var Ac=[];for(var Nc=va.length-1;0<=Nc;Nc--)Ac.push(Telemetry.PrivacyRules.GetPrivacyCompliantId(va[Nc].PrimaryMarketplace.SolutionId,va[Nc].PrimaryMarketplace.MarketplaceType,null,null,null,va[Nc].PrimaryMarketplace.MarketplaceRef));
Hc.a.sendTelemetryEvent({name:"Office.Extensibility.Host.AddinsWithinFile",dataFields:bd.a.Rm({["solutionIds"]:Ac})})}for(Ac=va.length-1;0<=Ac;Ac--){if(!this.ea.isNamedObjectViewMode){this.jRc.push(va[Ac].InstanceId);if(1!==va[Ac].WebExtensionType){va.splice(Ac,1);continue}if(zd.HelperMethods.XF(va[Ac])&&0!==va[Ac].SharedRuntime.State)1===va[Ac].SharedRuntime.State?va[Ac].TaskpaneVisible=!1:2===va[Ac].SharedRuntime.State?va[Ac].TaskpaneVisible=!0:h.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");
else if(!va[Ac].ContainsCustomFunctions&&!va[Ac].TaskpaneVisible&&!gc.a(va[Ac])){va.splice(Ac,1);continue}}Nc=OSF.OsfControl.isFirstPartyStoreString(va[Ac].PrimaryMarketplace.MarketplaceType);if(ub.EwaSettings.Ra(174)&&!Nc&&(va.splice(Ac,1),!Bb)){Bb=!0;const hd=Object(Pb.d)($c.a.resolve(wd.C,{va:3}));Td.TaskExtensions.Xa(hd,()=>{hd.result.Om(36,null)},this.ya,3)}ub.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&va[Ac].PrimaryMarketplace&&Rd.s1a(va[Ac].PrimaryMarketplace.SolutionId)&&
(h.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),va.splice(Ac,1))}this.Zjf(va)}}else this.Fmd=!1;this.ecc=!0}}LOf(va){const Bb=lb.f(this.$),Ac=Bb.ha.$e.Lh;if(Ac&&va){va=!1;if(this.Fl)for(const Nc of this.Fl)if(Rd.s1a(Nc.OX)||Rd.zmj(Nc.OX)||Rd.hoj(Nc.OX)){va=!0;break}va||Bb.ha.$e.XO(Ac)}}nWj(){this.Cl&&this.ea.isNamedObjectViewMode&&this.$.ma&&Md.n(this.$.ma)&&(wd.Ug.Aa()?this.webExtensionView.wY?this.webExtensionView.QUb():this.webExtensionView.dA(this.ysg):
vb.a(this.$).wY?vb.a(this.$).QUb():vb.a(this.$).dA(this.ysg))}Zjf(va){let Bb=null;Bb=Ac=>{const Nc=Ac.WebExtensionData,hd=Ac.IsTaskPane,qd=Ac.RecordHandler,je=()=>{this.u5a.shift();0<this.u5a.length&&Bb(this.u5a[0])};if(this.x5(Nc.PrimaryMarketplace.SolutionId))je();else{hd&&(Nc.WebExtensionOsfControlType=1);var Ie=gc.a(Nc);if(!hd||Nc.TaskpaneVisible||Ie||Nc.SharedRuntime&&0!==Nc.SharedRuntime.State||Nc.ContainsCustomFunctions){var Oe=new Ab(this,this.ao,Nc,this.webExtensionView,!hd);h.ULS.sendTraceTag(537170517,
0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Nc.PrimaryMarketplace.SolutionId,Nc.PrimaryMarketplace.MarketplaceType,null,null,null,Nc.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Nc.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${zd.HelperMethods.XF(Nc)}`);Oe.uTd();zd.HelperMethods.XF(Nc)&&(Oe.$Ha=Rd.DJa(Nc,this.$),Nc.TaskpaneWidth=this.GNb);Ie&&(Nc.WebExtensionToolTip="");!ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&
hd&&Nc.TaskpaneVisible&&!Ie&&(Nc.TaskpaneWidth=this.GNb);this.Fl.push(Oe);var Vb=this.gMa=null;Vb=of.a.instance.LO(()=>{Oe.lG&&(zc.a.dh(Vb),Vb=null,qd&&qd(Ac,Oe),je())},100,lf.a.Abi)}else je()}};for(let Ac=0;Ac<va.length;Ac++){if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const Nc=va[Ac].WebExtensionType===OSF.OsfControlTarget.TaskPane,hd=gc.a(va[Ac]);Nc&&!hd&&(va[Ac].TaskpaneWidth=this.GNb)}if(!this.gs(va[Ac].InstanceId))if(1!==va[Ac].WebExtensionType)this.YXa(va[Ac]);
else if(!ub.EwaSettings.Ra(52))this.hHb(va[Ac],Bb);else if(this.$.Ij&8388608||va[Ac].TaskpaneVisible){const Nc={};Nc.solutionId=va[Ac].PrimaryMarketplace.SolutionId;Nc.version=va[Ac].PrimaryMarketplace.SolutionVersion;Nc.storeType=va[Ac].PrimaryMarketplace.MarketplaceType;Nc.storeId=va[Ac].PrimaryMarketplace.MarketplaceRef;Nc.targetData=va[Ac];this.Cl.isAddinCommandsAsync(Nc,(hd,qd,je)=>{if(hd){var Ie=je.targetData;if(qd)if(Nc.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())hd=Nc.storeType.toLowerCase()===
OSF.StoreType.UploadFileDevCatalog.toLowerCase(),qd=Nc.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(hd||qd)&&zd.HelperMethods.XF(Ie)&&this.hHb(Ie,Bb);else if(ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.W3i(je,Bb);else{let Oe=!1;this.pfe(Vb=>{if(!Vb.errorCode){if(Vb.value)for(const fd of Vb.value){if(Oe)break;Oe=ua.e(fd[1])===ua.e(Ie.PrimaryMarketplace.SolutionId)}Oe?zd.HelperMethods.XF(Ie)&&this.hHb(Ie,Bb):(Vb={},
Vb.SolutionId=je.solutionId,Vb.Version=je.version,Vb.StoreType=Ie.PrimaryMarketplace.MarketplaceType,Vb.StoreId=je.storeId,Vb.AssetId=null,Vb.AssetStoreId=null,Vb.Width=Ie.TaskpaneWidth,Vb.TargetType=Ie.WebExtensionType,Ie.TaskpaneVisible=!0,this.R0e(Vb,Ie,Bb))}},!0)}else this.hHb(Ie,Bb)}else hd=je.targetData,h.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(hd.PrimaryMarketplace.SolutionId,hd.PrimaryMarketplace.MarketplaceType,null,
null,null,hd.PrimaryMarketplace.MarketplaceRef)} from ${hd.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}W3i(va,Bb){let Ac=!1;this.pfe(Nc=>{const hd=va.targetData;if(!Nc.errorCode){if(Nc.value)for(const qd of Nc.value){if(Ac)break;Ac=ua.e(qd[1])===ua.e(hd.PrimaryMarketplace.SolutionId)}Ac?zd.HelperMethods.XF(hd)&&this.hHb(hd,Bb):(Nc={},Nc.SolutionId=va.solutionId,Nc.Version=va.version,Nc.StoreType=hd.PrimaryMarketplace.MarketplaceType,Nc.StoreId=va.storeId,Nc.AssetId=null,Nc.AssetStoreId=
null,Nc.TargetType=hd.WebExtensionType,Nc.Width=hd.TaskpaneWidth,hd.TaskpaneVisible=!0,this.R0e(Nc,hd,Bb))}},!0)}hHb(va,Bb){const Ac={};Ac.WebExtensionData=va;Ac.IsTaskPane=!0;this.u5a.push(Ac);1===this.u5a.length&&Bb(Ac)}R0e(va,Bb,Ac){const Nc={};Nc.ActivationInfo=va;Nc.WebExtensionData=Bb;Nc.IsTaskPane=!1;Nc.RecordHandler=(hd,qd)=>{const je=hd.ActivationInfo;this.Cl.insertBlankControlWithErrorUX(this.r3b(qd,je),()=>{this.L6a(qd.controlId);this.Cl.purgeOsfControl(qd.controlId,!1);this.h2g(je)})};
this.u5a.push(Nc);1===this.u5a.length&&Ac(Nc)}h2g(va){var Bb={};Bb.solutionId=va.SolutionId;Bb.version=va.Version;Bb.storeType=va.StoreType;Bb.storeId=va.StoreId;Bb.assetId=va.AssetId;Bb.assetStoreId=va.AssetStoreId;Bb.targetType=va.TargetType;Bb.sharedRuntimeId=va.SharedRuntimeId;va=new I.a;va.add(Bb);Bb={};Bb[ca.a.sIb]=va;Bb[ca.a.f4]=3;va=new Gc.a(Gb.a.rqb,0,this.$.hi,0,null);this.$.Ma.qh(va,Bb)}r3b(va,Bb){const Ac={};Ac.div=va.lG;Ac.id=va.controlId;Ac.solutionId=Bb.SolutionId;Ac.version=Bb.Version;
Ac.storeId=Bb.StoreId;Ac.storeType=Bb.StoreType;Ac.osfControlType=OSF.OsfControlTarget.TaskPane;return Ac}yDg(){this.Fl.forEach(this.ljg);this.Fl.length=0;this.ecc=!1}BEi(va){const Bb=va.PrimaryMarketplace.MarketplaceType,Ac=Rd.getSolutionId(va,this.$);return Bb===OSF.StoreType.InMemory&&Ac.toLowerCase().startsWith("wa")?{solutionId:Ac,MYg:OSF.StoreType.OMEX}:{solutionId:va.PrimaryMarketplace.SolutionId,MYg:Bb}}Ega(va){var Bb;const Ac=this.BEi(va);return Telemetry.PrivacyRules.GetPrivacyCompliantId(Ac.solutionId,
Ac.MYg,null===(Bb=va.AssetMarketplace)||void 0===Bb?void 0:Bb.SolutionId,null,null,va.PrimaryMarketplace.MarketplaceRef)}gOk(va){var Bb,Ac;const Nc=va.io,hd={AssetId:null===(Bb=Nc.AssetMarketplace)||void 0===Bb?void 0:Bb.SolutionId,AssetStoreId:null===(Ac=Nc.AssetMarketplace)||void 0===Ac?void 0:Ac.MarketplaceRef,EnabledInViewMode:!0,Height:0,IsToBePersisted:!1,SolutionId:Nc.PrimaryMarketplace.SolutionId,SourceLocationOverrideResourceId:Nc.SrcLocationOverrideResourceId,StoreId:Nc.PrimaryMarketplace.MarketplaceRef,
StoreType:Nc.PrimaryMarketplace.MarketplaceType,TargetType:Nc.WebExtensionType,Version:Nc.PrimaryMarketplace.SolutionVersion,Width:Nc.TaskpaneWidth},qd={width:Nc.TaskpaneWidth,Xx:Nc.TaskpaneIconCssClass,showLoadingSpinner:Nc.ShowLoadingSpinner,focusOnIframeWhenLoaded:Nc.FocusOnIframeWhenLoaded};let je=hd.IsToBePersisted?0:16;const Ie=this.$.pa.ta.Vh();je|=64;this.Fkd=!0;Zc.a(this.$.userOperationManager,(Oe,Vb,fd)=>{var Qd=this.Ega(Nc);h.ULS.sendTraceTag(507637774,0,50,`Silent Reload::showAgaveTaskpaneReload:Web Method ShowAgaveTaskpane is called, StoreType ${hd.StoreType}, StoreId ${hd.StoreId}, SolutionId ${Qd}.`);
Qd=this.$.pa.ta;Oe=Wb.c(Oe,this.Zvg);const me=Qd.$a(9,void 0===Ie?null:Ie);me.sharedInfo=hd;return te.h(Qd,"ShowAgaveTaskpane",me,Oe,Vb,fd,qd,0)},Oe=>new tc.a(538,0,Oe,je),null)}qej(va){const Bb=va.io,Ac={AssetId:Bb.PrimaryMarketplace.SolutionId,AssetStoreId:Bb.PrimaryMarketplace.MarketplaceRef,OwnerAddinSolutionId:Bb.OwnerAddinSolutionId,OwnerAddinStoreType:Bb.OwnerAddinStoreType,Preload:Bb.Preload,SharedRuntimeId:Bb.SharedRuntimeId,SolutionId:Bb.PrimaryMarketplace.SolutionId,StoreId:Bb.PrimaryMarketplace.MarketplaceRef,
StoreType:Bb.PrimaryMarketplace.MarketplaceType,TargetType:Bb.WebExtensionType,Version:Bb.PrimaryMarketplace.SolutionVersion,Width:Bb.TaskpaneWidth},Nc=this.$.pa.ta,hd=Nc.$a(9);hd.sharedInfo=Ac;this.Fkd=!0;Zc.a(this.$.userOperationManager,(qd,je,Ie)=>{const Oe=this.Ega(Bb);h.ULS.sendTraceTag(507637771,0,50,`Silent Reload::insertAgaveSandboxReload:Web Method InsertAgaveTaskpane is called, StoreType ${Ac.StoreType}, StoreId ${Ac.StoreId}, SolutionId ${Oe}.`);return te.h(Nc,"InsertAgaveTaskpane",hd,
Wb.c(qd,this.Zvg),Wb.b(je,je),Ie,null,0)},qd=>new tc.a(500,0,qd,64),null)}qIg(){const va=[];var Bb=this.Fl.length;for(var Ac=0;Ac<Bb;Ac++){var Nc=this.Fl[Ac];if(this.HUd){if(Nc.N_f&&this.Nmj){va.push(Nc);continue}const hd=gc.a(Nc.io),qd=3===Nc.osfControlType,je=0===Nc.osfControlType||4===Nc.osfControlType;hd||qd?Nc.io.PrimaryMarketplace?"FA000000112"===Nc.io.PrimaryMarketplace.SolutionId?va.push(Nc):hd?this.gOk(Nc):this.qej(Nc):(h.ULS.sendTraceTag(507642883,0,10,"Silent Reload::ResetOsfControlAfterServerReload: PrimaryMarketplace is null."),
va.push(Nc)):je&&va.push(Nc)}else 0!==Nc.osfControlType&&3!==Nc.osfControlType&&4!==Nc.osfControlType||va.push(Nc)}Bb=!1;for(Ac=0;Ac<va.length;Ac++)Nc=va[Ac],this.L6a(Nc.controlId),!Bb&&Nc&&Nc.io&&(Bb=zd.HelperMethods.XF(Nc.io));Bb&&this.aV(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4});ub.EwaSettings.Ra(355)&&Td.TaskExtensions.Xa(ze.GetServiceTaskFactory.Tj(this.$.la,278,279,3),hd=>{hd&&(hd=hd.result)&&(this.$.la.kh(278)||this.$.la.Hh(278,hd),hd.SVf().jBa())},this.ya,3)}ZV(){var va=new Bc(this.$,
this.Xn,this.GJg);void 0===this.$||null===this.$?h.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):ub.EwaSettings.Ra(234)&&h.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Xn||null===this.Xn));if(va.JJj()){const Bb=()=>{},Ac=hd=>{hd=ne.a.gk(hd.data);h.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Lf.a.Yh(hd)}.`)},
Nc=va.SPh();va=Rd.xNd(Nc);va|=64;this.$.userOperationManager.$O(new tc.a(507,0,(hd,qd,je)=>te.h(this.$.pa.ta,"ExecuteRichApiRequest",this.UPh(Nc),Wb.c(hd,Bb),Wb.b(qd,Ac),je,null,0),va))}}UPh(va){const Bb=this.$.pa.ta.$a(1);Bb.request=va;return Bb}Jef(va,Bb){if(va)for(let Ac=0;Ac<va.length;Ac++)if(Hf.a.equals(va[Ac],Bb,!0))return!0;return!1}TOh(va){const Bb={};Bb.navigationMode=OSF.OsfNavigationMode.DefaultMode;Bb.assetId=null;Bb.category=null;if(!va||3>va.length)return Bb;if(va[0]){const Ac=parseInt(va[0],
10);isNaN(parseInt(Ac,10))||(Bb.navigationMode=Ac)}va[1]&&(Bb.assetId=va[1]);va[2]&&(Bb.category=va[2]);return Bb}Wbj(){var va=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(va&&"*"!==va.trim()){this.TYa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new wb(this),va,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.uk.get(2));try{this.TYa.init()}catch(Bb){try{this.TYa.dispose()}catch(Ac){}this.TYa=null;h.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+
Bb.message)}va={};va.a=this.$.ua.UserSessionId;Jf.b().Ll(39,va)}}kUg(va,Bb,Ac){const Nc=Rd.eOh(va[0]),hd=Nc.Sua,qd=Nc.Tva;Nc.Sua=()=>{hd&&hd();const je=Nc.J0a!==OSF.InfoType.Error?Bb:null;va.shift();va.length?this.kUg(va,je,Ac):je&&je()};Nc.Tva=()=>{qd&&qd();Ac&&Nc.J0a!==OSF.InfoType.Error&&Ac()};ab.a.Mse(Nc)}JNi(){const va={};va.Application=w.AFrameworkApplication.fa.Ya("Application");va.UICulture=w.AFrameworkApplication.fa.Ya("UICulture");va.AddinRibbonControlsOverriddenByApi=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
va.AddinActionDefinitionHybridMode=ub.EwaSettings.Ra(556).toString();va.UseActionIdForUILessCommand=ub.EwaSettings.Ra(559).toString();va.AllowStorageAccessByUserActivationOnIFrame=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();va.RequirementSetRibbonApiOnePointTwo=ub.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();va.flightingTreatmentVariables=w.AFrameworkApplication.fa.dQb;
va.ShortcutInfoArrayInUserPreferenceData=ub.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();va.DisabledChangeGates=w.AFrameworkApplication.fa.Ya("DisabledChangeGates");va.SdxIsEnabled=w.AFrameworkApplication.fa.ka("SdxIsEnabled");va.DmsSdxListWorkbook=w.AFrameworkApplication.Hqf;va.AddinDevicePermissionAllowList=w.AFrameworkApplication.fa.Ya("AddinDevicePermissionAllowList");return va}static get eMb(){return Rd.vJe}static set eMb(va){Rd.vJe=va}static getSolutionId(va){let Bb=
va.PrimaryMarketplace.SolutionId;ub.EwaSettings.Ra(261)&&va.OwnerAddinSolutionId&&(Bb=va.OwnerAddinSolutionId);return Bb}static xNd(va){return va.RequestFlags&1&&256!==(va.RequestFlags&256)?0:16}static DJa(va,Bb){Bb=Rd.getSolutionId(va,Bb);return Rd.QFf(Bb,va.PrimaryMarketplace.SolutionVersion,va.PrimaryMarketplace.MarketplaceType,va.PrimaryMarketplace.MarketplaceRef)}static o9h(va){return JSON.stringify({["recording"]:va})}static w4h(va){const Bb={};Bb.visibility=va?"Visible":"Hidden";return JSON.stringify(Bb)}static bJi(va){const Bb=
va.getSolutionId(),Ac=va.getVersion(),Nc=va.getStoreType();va=va.getStoreId();return Rd.QFf(Bb,Ac,Nc,va)}static QFf(va,Bb,Ac,Nc){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",va,Bb,Rd.IXi(Ac).toString(),Nc)}static CPd(va,Bb){var Ac=va.split("|");if(7>Ac.length)return h.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Ac[0])return h.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${Ac[0]}'.`),
null;let Nc=Ac[1];const hd=Ac[2],qd=Rd.JXi(Ac[3]),je=Ac[4];Ac=Ac[5];Nc&&Nc.length||(Nc=Ac);Ac={};Ac.InstanceId=String.format("{{{0}}}",L.a.create().toString());Ac.WebExtensionOsfControlType=4;Ac.WebExtensionType=1;Ac.PrimaryMarketplace={};Ac.PrimaryMarketplace.SolutionId=Nc;Ac.PrimaryMarketplace.SolutionVersion=hd;Ac.PrimaryMarketplace.MarketplaceRef=je;Ac.PrimaryMarketplace.MarketplaceType=qd;Ac.ContainsCustomFunctions=Bb?!0:!1;Bb&&(Ac.OsfPropertyBag=[["customFunctionAddinId",va]]);return Ac}static JXi(va){va=
parseInt(va,10);return va===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:va===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:va===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:va===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:va===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:va===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:va===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:va===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:va===OSF.StoreTypeEnum.FirstParty?
OSF.StoreType.FirstParty:va===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:va===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static IXi(va){return va===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:va===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:va===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:va===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:va===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:va===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:
va===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:va===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:va===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:va===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:va===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}wfa(va){const Bb={};Bb.Version=va.version;Bb.AssetId=va.assetId;Bb.AssetStoreId=va.assetStoreId;Bb.StoreType=va.storeType;Bb.Height=va.height;Bb.SolutionId=
va.solutionId;Bb.StoreId=va.storeId;Bb.TargetType=va.targetType;Bb.Width=1===Bb.TargetType?0:va.width;Bb.SharedRuntimeId=va.sharedRuntimeId;return Bb}static hWb(va){return va===OSF.DDA.EventDispId.dispidSettingsChangedEvent||va===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||va===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||va===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||va===OSF.DDA.EventDispId.dispidRichApiMessageEvent||va===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||
va===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||va===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static eOh(va){return Object(b.a)(new Rb.a,{J0a:va.infoType,id:va.id,title:va.title,description:va.description,buttonText:va.buttonTxt,Sua:va.buttonCallback,rEc:va.highPriority,Tva:va.dismissCallback,errorCode:va.errorCode,MTf:va.iframeNotificationUrl})}static s1a(va){let Bb="FA000000014"===va;Bb||(Bb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===va);return Bb}static zmj(va){return"FA000000005"===
va}static hoj(va){return"FA000000064"===va}}Rd.uib=new M.a;Rd.vJe=!0;Rd.JAe=!0;Object(c.a)(Rd,"DdaFacade",yc.a,[271,272,273,274,275,4])},947:function(A,u,a){a.d(u,"a",function(){return b});A=a(0);var c=a(41);class b{static get uGj(){return b.tSe||(b.tSe={["-2002156328"]:b.Rgf,["-1954750170"]:b.HLf,["317650254"]:b.YYh,["-1005263101"]:b.tfj,["1353664579"]:b.pzk,["159671765"]:b.ufj,["1446690022"]:b.TFf,["1150069548"]:b.a3c,["-1409306331"]:b.Bdf,["338507772"]:b.znf,["-457159301"]:b.M3j,["-1037701970"]:b.abi,
["-1893322318"]:b.yfj,["965579896"]:b.cbi,["93287890"]:b.bbi,["358088857"]:b.ZCk,["-1223650923"]:b.znf,["2007306190"]:b.JUh,["1549955423"]:b.T$e,["-1275974171"]:b.xfj,["382101082"]:b.E2j,["-898776235"]:b.YIj,["335464256"]:b.QIj,["1677378049"]:b.wfj,["-261992848"]:b.k5k,["-980820954"]:b.T$e,["-931375837"]:b.D2j,["929186550"]:b.pji,["-982144310"]:b.Uak,["-785741187"]:b.rfj,["2125217573"]:b.Afj,["299124955"]:b.sfj,["1669853884"]:b.fvk,["-1515932330"]:b.ZYh,["314621024"]:b.vzi,["-300049690"]:b.NUh,["14766835"]:b.DIk,
["-1251992761"]:b.brf,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.mVa,["49173765"]:b.mVa,["-907155566"]:b.mVa,["-1201603824"]:b.mVa,["1541165282"]:b.mVa,["-1347753427"]:b.mVa,["134912532"]:b.mVa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static nCf(h){return c.a.Pw(b.uGj,
h.toString(),b.internalError)}}b.success=0;b.Rgf=1E3;b.HLf=1001;b.YYh=1002;b.tfj=1003;b.pzk=1004;b.ufj=1005;b.TFf=1008;b.tzf=1009;b.invalidSheetName=1014;b.a3c=2E3;b.Bdf=2001;b.znf=2002;b.M3j=2003;b.abi=2004;b.yfj=2005;b.cbi=2007;b.bbi=2008;b.ZCk=2009;b.JUh=2014;b.hzk=3E3;b.T$e=3002;b.xfj=3004;b.E2j=3005;b.YIj=3006;b.QIj=3007;b.wfj=3008;b.k5k=3009;b.D2j=3010;b.DIk=4002;b.tbe=5E3;b.internalError=5001;b.brf=5002;b.fVb=5004;b.q6k=5007;b.E$i=5008;b.EHg=5011;b.invalidOrTimedOutSession=5012;b.E5c=5016;
b.mVa=5102;b.Frk=5103;b.responsePayloadSizeLimitExceeded=5104;b.hUh=7001;b.yXg=7002;b.pji=8E3;b.Uak=8001;b.rfj=8010;b.Afj=8011;b.sfj=8012;b.fvk=8020;b.ZYh=8021;b.vzi=8022;b.NUh=8023;b.aGj=11E3;b.OJj=11001;b.zfj=11002;b.tSe=null;Object(A.a)(b,"DdaErrorIds",null,[])},948:function(A,u,a){a.d(u,"a",function(){return h});A=a(0);var c=a(15),b=a(92);class h{constructor(){this.Nhe=0;this.P7={};this.yHa={}}gSi(r,f){return this.P7[h.Qtd(r,f)]}jtf(r,f){f||void 0!==this.yHa[r]&&null!==this.yHa[r]?f&&void 0!==
this.yHa[r]&&null!==this.yHa[r]&&delete this.yHa[r]:this.yHa[r]=1}ooc(r){return void 0===this.yHa[r]||null===this.yHa[r]}yQd(r){const f=h.Qtd(r.messageType,r.targetId);1===r.actionType?this.H4i(r.controlId,r.messageType,f):2===r.actionType&&this.J5i(r.controlId,r.messageType,f)}qkk(r){if(r){var f=Object.keys(this.P7);if(!(void 0===f||null===f||0>=f.length))for(const l of f)f=this.P7[l],f[r]&&(delete f[r],Object.keys(f).length||delete this.P7[l])}}eS(r,f){r=h.Qtd(r,f);r=this.P7[r];return!!r&&0<Object.keys(r).length}F6i(){return!b.a.isEmpty(this.P7)}s3f(){return 0<
this.Nhe}hLi(){const r=[],f=this.P7;for(const x in f){var l=x,m=f[x];for(const n in m){m=n;const t={};t.eventType=parseInt(l.split("#")[0],10);t.targetId=l.split("#")[1];t.addinId=m;r.push(t)}}return r}H4i(r,f,l){if(this.P7[l])l=this.P7[l],l[r]=l[r]?l[r]+1:1;else{const m={};m[r]=1;this.P7[l]=m}100===f&&this.Nhe++}J5i(r,f,l){if(this.P7[l]){const m=this.P7[l];if(r){const x=m[r];1===x?(delete m[r],Object.keys(m).length||delete this.P7[l]):m[r]=x-1;100===f&&this.Nhe--}else c.ULS.sendTraceTag(537170459,
0,50,`The OsfControl[${r}] doesn't register event with key[${l}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${l}] that will be unregistered doesn't exist.`)}static Qtd(r,f){return String.format("{0}#{1}",r,f)}}h.bW="Workbook";Object(A.a)(h,"RichApiEventRegistration",null,[])},949:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.Xmd="AccessDenied";c.notSupported=
"NotSupported";c.Nnc="ApiNotAvailable";c.kfg="NotAllowed";c.obe="OperationCancelled";c.cBe="UserNotSignedIn";c.Wzb="UserAborted";c.t6k="UnsupportedUserIdentity";c.ynb="InvalidResourceUrl";c.QFc="InvalidGrant";c.yFh="AddinIsAlreadyRequestingToken";c.ptk="ResourceNotAllowed";c.qrc="ClientError";c.serverError="ServerError";c.b2h="ControlIdNotFound";c.quk="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";
Object(A.a)(c,"ErrorCodes",null,[])},985:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{constructor(b,h,r,f){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=h;this.ddaBinding=r;this.ArrayData=void 0===f?null:f}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(A.a)(c,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.agave.js.map/24a0f6d36f9fde2c7281b056f6069f77/EwaTS.agave.js.map