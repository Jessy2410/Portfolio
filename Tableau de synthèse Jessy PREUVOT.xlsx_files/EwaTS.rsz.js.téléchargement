'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[37],{781:function(A,u,a){function c(yb){return 0<yb&&yb<=nb.a.Rk}function b(yb){return 0<yb&&yb<=nb.a.Gk}function h(yb,Ta){let Hb="";Ta.sort((vc,Xc)=>vc.start-Xc.start);let uc=0,Sc=Ta.shift();const bc=yb.length;for(;uc<bc&&Sc;)uc===Sc.start?(Hb+=Sc.value,Sc.NLa&&(Hb+="#"),uc=Sc.end,Sc=Ta.shift()):(Hb+=yb[uc],uc++);uc<bc&&(Hb+=yb.substring(uc));return Hb}function r(yb,Ta){return yb.top<=Ta.top&&yb.left<=Ta.left&&
yb.bottom>=Ta.bottom&&yb.right>=Ta.right}function f(yb,Ta,Hb,uc){const Sc=Hb.FirstScrollableRow,bc=Hb.FirstScrollableColumn;switch(Ta){case 1:var vc=yb.XG.length;return yb.PB[yb.PB.length-1]>=Sc&&yb.XG[vc-1]>=bc;case 4:var Xc;vc=Hb.FirstScrollableRow;Hb=Hb.FirstScrollableColumn;uc=null===(Xc=yb.PB)||void 0===Xc?void 0:Xc.length;return 0<uc&&yb.PB[uc-1]>=vc&&Hb>=yb.XG[0];case 3:Xc=Hb.FirstScrollableRow;Hb=Hb.FirstScrollableColumn;var ad=Number.MAX_VALUE;for(const ue of uc)ue.ar.Y<ad&&(ad=ue.ar.Y);
yb.ar.Y>ad&&Xc<yb.PB[0]?yb=!1:(uc=null===(vc=yb.XG)||void 0===vc?void 0:vc.length,yb=0<uc&&yb.XG[uc-1]>=Hb);return yb;case 2:var Id;vc=Hb.FirstScrollableRow;Hb=Hb.FirstScrollableColumn;return 0<(null===(ad=yb.XG)||void 0===ad?void 0:ad.length)&&yb.XG[0]<=Hb&&0<(null===(Id=yb.PB)||void 0===Id?void 0:Id.length)&&yb.PB[0]<=vc}return!1}function l(yb,Ta,Hb){const uc=yb.kj;var Sc=Va.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxHiddenRangeCountForFreezeCSE",1);const bc=Va.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxHiddenRowColCountForFreezeCSE",
10),{$Rf:vc,Lmb:Xc}=x(yb,Ta.FirstScrollableRow,!0),{$Rf:ad,Lmb:Id}=x(yb,Ta.FirstScrollableColumn,!1);if(vc>Sc||ad>Sc||Xc>bc||Id>bc)return n(`Hidden Row/Col, exceeds supported hidden range limit, hiddenRowCount: ${Xc}, hiddenColCount: ${Id}, hiddenRowRangeCount: ${vc}, hiddenColRangeCount: ${ad}`,Hb),!1;yb=nb.a.yR;Sc=nb.a.zR;if(Xc&&Ta.FirstScrollableRow>Sc+Xc&&(Sc=Math.ceil((Ta.FirstScrollableRow-Xc)/Sc)*Sc-Ta.FirstScrollableRow+Xc,Sc<Xc))return n(`Hidden Row/Col, CSE at block end, rowCountFromBlockEnd: ${Sc}`,
Hb),!1;if(Id&&Ta.FirstScrollableColumn>yb+Id&&(yb=Math.ceil((Ta.FirstScrollableColumn-Id)/yb)*yb-Ta.FirstScrollableColumn+Id,yb<Id))return n(`Hidden Row/Col, CSE at block end, colCountFromBlockEnd: ${yb}`,Hb),!1;Ta=new oa.Range(Math.max(1,Ta.FirstScrollableRow-1),Math.max(1,Ta.FirstScrollableColumn-1),Ta.FirstScrollableRow,Ta.FirstScrollableColumn,!1,!1);return uc.Coa(Ta)?(n("Hidden Row/Col, Adjacent range hidden",Hb),!1):!0}function m(yb){var Ta;const Hb=null!==(Ta=yb.emb())&&void 0!==Ta?Ta:yb.R5();
yb=yb.Uzc();return null===Hb||null===yb?null:new oa.Range(Hb.top,Hb.left,yb.bottom,yb.right,!0,!0)}function x(yb,Ta,Hb){var uc;const Sc=yb.kj;yb=null!==(uc=m(yb))&&void 0!==uc?uc:new oa.Range(1,1,Ta,Ta,!0,!0);uc=Sc.mBc([yb]).filter(vc=>Hb&&!vc.isRow||!Hb&&!vc.lk||Hb&&vc.top>Ta||!Hb&&vc.left>Ta?!1:Hb?vc.isRow:vc.lk);let bc=0;uc.forEach(vc=>{bc=Hb?bc+(Math.min(vc.bottom,Ta)-vc.top+1):bc+(Math.min(vc.right,Ta)-vc.left+1)});return{$Rf:uc.length,Lmb:bc}}function n(yb,Ta){Ca.ULS.sendTraceTag(507368522,
0,20,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${Ta}, CSE Unattempted Reason=${yb}`)}function t(yb,Ta){if(!yb.length||yb[0]>Ta)return 0;let Hb=0;for(let uc=0;uc<yb.length&&!(yb[uc]>=Ta);uc++)0<uc&&(Hb+=yb[uc]-yb[uc-1]-1);return Hb}function w(yb,Ta,Hb,uc){var Sc,bc,vc;const Xc=Ta.FirstScrollableColumn;Ta=nb.a.yR;const ad=Xc>Ta?Xc<=Ta+uc?Xc:Xc%Ta:Xc;let Id=0,ue=ad-1;const Vd=null===(Sc=yb.ColumnNumbers)||void 0===Sc?void 0:Sc.length;Sc=uc?t(yb.ColumnNumbers,Xc):0;
switch(Hb){case 1:Xc<=Ta+uc?Id=ue-uc:(yb=Xc>yb.ColumnNumbers[Vd-1]?0:ad-1,yb=0>yb?Ta-Math.abs(yb):yb,Id=yb-uc);ue-=uc;ue=uc&&0>ue?Ta-Math.abs(ue):ue;break;case 2:Xc<=Ta+uc?Id=Vd-ue+uc:(ue=yb=Xc>yb.ColumnNumbers[Vd-1]?yb.ColumnNumbers[Vd-1]:Xc-(null===(bc=yb.ColumnNumbers)||void 0===bc?NaN:bc[0]),Id=Vd-ue+Sc);break;case 3:Xc<=Ta+uc||(yb=Xc>yb.ColumnNumbers[Vd-1]?yb.ColumnNumbers[Vd-1]:ad-1,ue=yb=0>yb?Ta-Math.abs(yb):yb);Id=ue-uc;break;case 4:Xc<=Ta+uc?Id=Vd-ue+uc:(ue=yb=Xc>yb.ColumnNumbers[Vd-1]?yb.ColumnNumbers[Vd-
1]:Xc-(null===(vc=yb.ColumnNumbers)||void 0===vc?NaN:vc[0]),Id=Vd-ue+Sc)}return{r6b:0,GWc:0,yLb:ue,Frc:Id-1}}function v(yb,Ta,Hb,uc){var Sc,bc,vc;const Xc=Ta.FirstScrollableRow;Ta=nb.a.zR;const ad=Xc>Ta?Xc<=Ta+uc?Xc:Xc%Ta:Xc;let Id=0,ue=ad-1;const Vd=null===(Sc=yb.RowNumbers)||void 0===Sc?void 0:Sc.length;Sc=uc?t(yb.RowNumbers,Xc):0;switch(Hb){case 1:Xc<=Ta+uc?Id=ue-uc:(yb=Xc>yb.RowNumbers[Vd-1]?0:ad-1,yb=0>yb?Ta-Math.abs(yb):yb,Id=yb-uc);ue-=uc;ue=uc&&0>ue?Ta-Math.abs(ue):ue;break;case 2:Xc<=Ta+
uc?Id=Vd-ue+uc:(ue=yb=Xc>yb.RowNumbers[Vd-1]?yb.RowNumbers[Vd-1]:Xc-(null===(bc=yb.RowNumbers)||void 0===bc?NaN:bc[0]),Id=Vd-ue+Sc);break;case 3:Xc<=Ta+uc?Id=Vd-ue+uc:(ue=yb=Xc>yb.RowNumbers[Vd-1]?yb.RowNumbers[Vd-1]:Xc-(null===(vc=yb.RowNumbers)||void 0===vc?NaN:vc[0]),Id=Vd-ue+Sc);break;case 4:Xc<=Ta+uc||(yb=Xc>yb.RowNumbers[Vd-1]?yb.RowNumbers[Vd-1]:ad-1,ue=yb=0>yb?Ta-Math.abs(yb):yb),Id=ue-uc}return{r6b:ue,yLb:0,GWc:Id-1,Frc:0}}function k(yb,Ta,Hb){var uc,Sc,bc,vc,Xc;return(null===(uc=yb.PB)||
void 0===uc?void 0:uc[0])<=Ta&&(null===(Sc=yb.PB)||void 0===Sc?void 0:Sc[yb.PB.length-1])>=Ta&&(null===(bc=yb.XG)||void 0===bc?void 0:bc[0])<=Hb&&(null===(vc=yb.XG)||void 0===vc?void 0:vc[(null===(Xc=yb.XG)||void 0===Xc?NaN:Xc.length)-1])>=Hb}function y(yb,Ta){const Hb={};Hb.X=yb.X-Ta.X;Hb.Y=yb.Y-Ta.Y;return Hb}function C(yb,Ta,Hb,uc,Sc){return Va.EwaSettings.X1a()?gridRenderer.CanvasRendererGlobals.canMultipleRowColHideOrCascade(yb,Ta,Hb,uc,Sc):gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(yb,
Ta,uc,Sc)}function B(yb,Ta,Hb,uc){switch(Hb){case -706918724:case 674605324:var Sc=yb.destination.yj;if(!Sc)return X("shouldCurrentBlockPairBeProcessed",Hb),!1;if(Sc.right<Ta.left)return yb.mV=!0,Ca.ULS.sendTraceTag(508150742,0,50,`GridInstantaneousAction.processGridAction command=${Hb}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${Ta.left}, blockRangeRightMostValue=${Sc.right}, hashCode=${yb.destination.Pi}, isRow=${uc}`),!1;break;case 369708605:case 1415868706:Sc=yb.source.yj;
if(!Sc)return X("shouldCurrentBlockPairBeProcessed",Hb),!1;if(Sc.right<Ta.left)return yb.mV=!0,Ca.ULS.sendTraceTag(508150741,0,50,`GridInstantaneousAction.processGridAction command=${Hb}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${Ta.left}, blockRangeRightMostValue=${Sc.right}, hashCode=${yb.source.Pi}, isRow=${uc}`),!1;break;case 1542466017:case -1113896058:Sc=yb.source.yj;if(!Sc)return X("shouldCurrentBlockPairBeProcessed",Hb),!1;if(Sc.bottom<Ta.top)return yb.mV=!0,Ca.ULS.sendTraceTag(508150740,
0,50,`GridInstantaneousAction.processGridAction command=${Hb}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${Ta.top}, blockRangeBottomMostValue=${Sc.bottom}, hashCode=${yb.source.Pi}, isRow=${uc}`),!1;break;case 1051390410:case 1554436520:Sc=yb.destination.yj;if(!Sc)return X("shouldCurrentBlockPairBeProcessed",Hb),!1;if(Sc.bottom<Ta.top)return yb.mV=!0,Ca.ULS.sendTraceTag(508150739,0,50,`GridInstantaneousAction.processGridAction command=${Hb}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${Ta.top}, blockRangeBottomMostValue=${Sc.bottom}, hashCode=${yb.destination.Pi}, isRow=${uc}`),
!1}return!0}function E(yb,Ta,Hb,uc,Sc){if(Va.EwaSettings.j2a()&&yb.fh.Fy&&1===Sc.length){var bc=Sc[0],vc=yb.fh.Ym,Xc=yb.fh.Gm;Sc=[];if(!Hb&&bc.right<vc){vc=K(Ta,Hb,uc,2);yb=K(Ta,Hb,uc,4);var ad=[],Id=[];-706918724!==uc&&(bc.top<Xc&&(Id=K(Ta,Hb,uc,3)),ad=K(Ta,Hb,uc,1));Sc.push(...vc);Sc.push(...yb);Sc.push(...Id);Sc.push(...ad);return Sc}if(!Hb&&bc.left>=vc)return bc=K(Ta,Hb,uc,3),Ta=K(Ta,Hb,uc,1),Sc.push(...bc),Sc.push(...Ta),Sc;if(Hb&&bc.bottom<Xc)return Xc=K(Ta,Hb,uc,2),yb=K(Ta,Hb,uc,3),ad=[],Id=
[],1051390410!==uc&&(bc.left<vc&&(Id=K(Ta,Hb,uc,4)),ad=K(Ta,Hb,uc,1)),Sc.push(...Xc),Sc.push(...yb),Sc.push(...Id),Sc.push(...ad),Sc;if(Hb&&(bc.top>=Xc||yb.fh.NYd(bc)))return bc=K(Ta,Hb,uc,4),Ta=K(Ta,Hb,uc,1),Sc.push(...bc),Sc.push(...Ta),Sc}return K(Ta,Hb,uc,1)}function K(yb,Ta,Hb,uc){const Sc=yb.filter(Xc=>Xc.yK().paneType===uc),bc=Ta?ba(Sc):H(Sc),vc=[];if(!Va.EwaSettings.xha()&&0===bc&&1===yb.length)return vc.push({destination:yb[0],source:null,mV:!1}),vc;if(Va.EwaSettings.Fya()||Va.EwaSettings.Eya()||
Va.EwaSettings.wLa())vc.push(...W(Sc,bc,Ta,Hb));else for(let Xc=0;Xc<=bc;Xc++)for(yb=Sc.filter(ad=>ad.yK().topLeft.Y===Xc),Ta=0;Ta<yb.length;Ta+=1)vc.push({destination:yb[Ta],source:yb[Ta+1]?yb[Ta+1]:null,mV:!1});Ca.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${vc.length}`);return vc}function F(yb){const Ta=ba(yb),Hb=H(yb),uc=[],Sc={};yb.forEach(bc=>{const {X:vc,Y:Xc}=bc.yK().topLeft;Sc[`${vc},${Xc}`]=bc});for(yb=0;yb<=Ta;yb++)for(let bc=
0;bc<=Hb;bc++){const vc=Sc[`${yb+1},${bc}`],Xc=Sc[`${yb},${bc+1}`],ad=Sc[`${yb+1},${bc+1}`],Id=Sc[`${yb},${bc}`];uc.push({destination:null!==Id&&void 0!==Id?Id:null,sXg:null!==vc&&void 0!==vc?vc:null,oXg:null!==Xc&&void 0!==Xc?Xc:null,pXg:null!==ad&&void 0!==ad?ad:null,mV:!1})}Ca.ULS.sendTraceTag(507586694,0,50,`GridInstantaneousAction.getadjacentBlocksInViewport parameter = blockPairsLength, value=${uc.length}`);return uc}function W(yb,Ta,Hb,uc){const Sc=[];for(let bc=0;bc<=Ta;bc++){const vc=yb.filter(ad=>
Hb?ad.yK().topLeft.X===bc:ad.yK().topLeft.Y===bc),Xc=vc.length;for(let ad=0;ad<Xc;ad+=1)switch(uc){case -1113896058:case 1542466017:Sc.push({source:vc[ad],destination:J(ad+1,vc),mV:!1});break;case 1554436520:case 1051390410:Sc.push({destination:vc[ad],source:J(ad+1,vc),mV:!1});break;case 1415868706:case 369708605:Sc.push({source:vc[ad],destination:J(ad+1,vc),mV:!1});break;case 674605324:case -706918724:Sc.push({destination:vc[ad],source:J(ad+1,vc),mV:!1})}}return Sc}function J(yb,Ta){return yb<Ta.length?
Ta[yb]:null}function L(yb,Ta,Hb,uc,Sc,bc){let vc,Xc=0;Xc=Ua(uc)?za.HelperMethods.jN(()=>{vc=gridRenderer.CanvasRendererGlobals.performModelRowColOperation(yb,Ta,Hb,uc,Sc)}):za.HelperMethods.jN(()=>{vc=gridRenderer.CanvasRendererGlobals.hideRowCols(yb,Ta,Sc)});U("HideRowCols",Xc,bc);return vc}function M(yb,Ta,Hb,uc,Sc,bc,vc){let Xc;if(!yb||!Ta)return Xc;Xc=Ua(Sc)?gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(yb,Ta,Hb,uc,Sc,bc):gridRenderer.CanvasRendererGlobals.performModelCascade(yb,
Ta,Hb,bc);Xc.metric&&U("ModelCascade",Xc.metric.Avl,vc);return Xc}function Q(yb,Ta,Hb,uc){return Hb?-1113896058===uc||1542466017===uc?yb.RowNumbers[yb.RowNumbers.length-Ta-1]:yb.RowNumbers[0]:1415868706===uc||369708605===uc?yb.ColumnNumbers[yb.ColumnNumbers.length-Ta-1]:yb.ColumnNumbers[0]}function H(yb){let Ta=-1;for(let Hb=0;Hb<yb.length;Hb++){const uc=yb[Hb].yK().topLeft.Y;uc>Ta&&(Ta=uc)}return Ta}function ba(yb){let Ta=-1;for(let Hb=0;Hb<yb.length;Hb++){const uc=yb[Hb].yK().topLeft.X;uc>Ta&&(Ta=
uc)}return Ta}function U(yb,Ta,Hb){Hb=Pa.b().zp(Hb);Ca.ULS.sendTraceTag(509723719,0,20,`GridInstantaneousAction: Time taken to complete operation=${yb} is time=${Ta} and command=${Hb}`)}function D(yb,Ta,Hb){var uc,Sc;for(const vc of Ta)if(!Va.EwaSettings.xha()||vc.source&&vc.destination){if(!(Va.EwaSettings.xha()||vc.source&&vc.destination))return!0;var bc=null===(uc=vc.destination)||void 0===uc?void 0:uc.yj;Ta=null===(Sc=vc.source)||void 0===Sc?void 0:Sc.yj;if(Va.EwaSettings.PHc()&&(!bc||!Ta))return X("isFirstRowColOfNextBlockHidden",
Hb),!0;bc=yb.YJd(bc);Ta=yb.YJd(Ta);switch(Hb){case -706918724:case 674605324:return bc&&bc.IsFirstColOfNextBlockHidden;case 369708605:case 1415868706:return bc&&(null===bc||void 0===bc?void 0:bc.IsLastColOfPrevBlockHidden)||Ta&&(null===Ta||void 0===Ta?void 0:Ta.IsFirstColOfNextBlockHidden);case 1051390410:case 1554436520:return bc&&bc.IsFirstRowOfNextBlockHidden;case 1542466017:case -1113896058:return bc&&(null===bc||void 0===bc?void 0:bc.IsLastRowOfPrevBlockHidden)||Ta&&(null===Ta||void 0===Ta?void 0:
Ta.IsFirstRowOfNextBlockHidden)}}return!1}function I(yb,Ta,Hb){for(const uc of Ta){if(Va.EwaSettings.gmj()&&!uc)return Ca.ULS.sendTraceTag(508339915,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: blockPair or sourceBlock is null and command=${Hb}`),!0;if(!uc.source||!uc.destination)if(Va.EwaSettings.xha())continue;else return Ca.ULS.sendTraceTag(507875778,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: sourceBlock or destination Block is null and command=${Hb}`),!0;if(Va.EwaSettings.PHc()){Ta=
uc.source.yj;const Sc=uc.destination.yj;if(!Ta||!Sc)return X("isSelectedRangeAcrossBlocks",Hb),!0;if(Va.EwaSettings.fmj()){if(Ta.Xi(yb)&&Sc.Xi(yb))return!0}else{const bc=-706918724===Hb||674605324===Hb||1051390410===Hb||1554436520===Hb;if(bc&&Ta.Xi(yb)||!bc&&Sc.Xi(yb))return!0}}else if(uc.source.yj.Xi(yb))return!0}return!1}function X(yb,Ta){Ca.ULS.sendTraceTag(508347672,0,50,`GridInstantaneousAction: BlockRange was null in the method = ${yb} and command =${Ta}`)}function Y(yb,Ta,Hb){if(-706918724===
Ta||674605324===Ta||1051390410===Ta||1554436520===Ta){if(yb.destination)return yb=yb.destination.yj,yb?yb.Xi(Hb):(X("doesBlockRangeIntersectWithSelectedRange",Ta),!1);X("doesBlockRangeIntersectWithSelectedRange destinationBlock",Ta)}else if(369708605===Ta||1415868706===Ta||1542466017===Ta||-1113896058===Ta){if(yb.source)return yb=yb.source.yj,yb?yb.Xi(Hb):(X("doesBlockRangeIntersectWithSelectedRange",Ta),!1);X("doesBlockRangeIntersectWithSelectedRange sourceBlock",Ta)}return!1}function ja(yb){switch(yb){case -706918724:case 1051390410:return hb.Hide;
case 369708605:case 1542466017:return hb.Unhide;case 674605324:case 1554436520:return hb.Delete;case 1415868706:case -1113896058:return hb.Insert}throw Error(`GridInstantaneousAction::getGridInstantaneousOperation: Command ${yb} not supported currently`);}function Ua(yb){switch(yb){case hb.Hide:return Va.EwaSettings.X1a()||Va.EwaSettings.QHc();case hb.Insert:return Va.EwaSettings.Fya()||Va.EwaSettings.Eya();case hb.Delete:return Va.EwaSettings.wLa()||Va.EwaSettings.Znb();default:return!1}}function ka(yb){const Ta=
Va.EwaSettings.Fya()&&-1113896058===yb;return Va.EwaSettings.Eya()&&1415868706===yb||Ta}function fb(yb){const Ta=Va.EwaSettings.QHc()&&1051390410===yb;return Va.EwaSettings.uob()&&-706918724===yb||Ta}function ha(yb){const Ta=Va.EwaSettings.wLa()&&1554436520===yb;return Va.EwaSettings.Znb()&&674605324===yb||Ta}function ea(){return ac}function aa(){ac={dispose(){}}}function ca(yb,Ta,Hb){const uc=yb.Pj.PaneViewData;yb=yb.tKa();const Sc={};switch(Ta){case -1113896058:Sc.Height=yb.BlockHeight;Sc.AbsoluteTop=
yb.BlockHeight;Sc.FirstScrollableRow=uc.FirstScrollableRow+Hb;Sc.VisibleRows=uc.VisibleRows+Hb;Sc.FirstFrozenRow=uc.FirstFrozenRow;break;case 1554436520:case 1051390410:Sc.Height=yb.BlockHeight;Sc.AbsoluteTop=yb.BlockHeight;Sc.FirstScrollableRow=uc.FirstScrollableRow-Hb;Sc.VisibleRows=uc.VisibleRows-Hb;Sc.FirstFrozenRow=uc.FirstFrozenRow;break;default:Sc.Height=uc.Height,Sc.AbsoluteTop=uc.AbsoluteTop,Sc.FirstScrollableRow=uc.FirstScrollableRow,Sc.VisibleRows=uc.VisibleRows,Sc.FirstFrozenRow=uc.FirstFrozenRow}switch(Ta){case 1415868706:Sc.AbsoluteLeft=
yb.BlockWidth;Sc.Width=yb.BlockWidth;Sc.VisibleColumns=uc.VisibleColumns+Hb;Sc.FirstScrollableColumn=uc.FirstScrollableColumn+Hb;Sc.FirstFrozenColumn=uc.FirstFrozenColumn;break;case 674605324:Sc.AbsoluteLeft=yb.BlockWidth;Sc.Width=yb.BlockWidth;Sc.VisibleColumns=uc.VisibleColumns-Hb;Sc.FirstScrollableColumn=uc.FirstScrollableColumn-Hb;Sc.FirstFrozenColumn=uc.FirstFrozenColumn;break;case -706918724:Sc.FirstScrollableColumn=uc.FirstScrollableColumn;Sc.AbsoluteLeft=yb.BlockWidth;Sc.Width=yb.BlockWidth;
Sc.VisibleColumns=uc.VisibleColumns-Hb;Sc.FirstFrozenColumn=uc.FirstFrozenColumn;break;default:Sc.AbsoluteLeft=uc.AbsoluteLeft,Sc.Width=uc.Width,Sc.VisibleColumns=uc.VisibleColumns,Sc.FirstScrollableColumn=uc.FirstScrollableColumn,Sc.FirstFrozenColumn=uc.FirstFrozenColumn}Sc.State=uc.State;Sc.IsEstimated=uc.IsEstimated;return Sc}function xa(yb,Ta,Hb){if(-706918724===Ta||1051390410===Ta)return!1;let uc=!0;if(yb)switch(Ta){case 1415868706:Oa(yb,Hb,!0,!1);break;case 674605324:Oa(yb,Hb,!1,!1);break;case -1113896058:Oa(yb,
Hb,!0,!0);break;case 1554436520:Oa(yb,Hb,!1,!0)}else uc=!1;return uc}function Oa(yb,Ta,Hb,uc){if(Hb)if(uc)for(Hb=0;Hb<yb.RowNumbers.length;Hb++)yb.RowNumbers[Hb]+=Ta;else for(Hb=0;Hb<yb.ColumnNumbers.length;Hb++)yb.ColumnNumbers[Hb]+=Ta;else if(uc)for(Hb=0;Hb<yb.RowNumbers.length;Hb++)yb.RowNumbers[Hb]-=Ta;else for(Hb=0;Hb<yb.ColumnNumbers.length;Hb++)yb.ColumnNumbers[Hb]-=Ta}function ua(yb){return bd?Math.max(yb-1,1):yb-1}a.r(u);var Ia={};a.r(Ia);a.d(Ia,"GridInstantaneousOperation",function(){return hb});
a.d(Ia,"GridInstantaneousAction",function(){return Aa});a.d(Ia,"canRowColHideOrCascade",function(){return C});a.d(Ia,"testableGetBlockPairsInViewport",function(){return E});a.d(Ia,"testablePerformModelRowColOperation",function(){return L});a.d(Ia,"testablePerformModelCascade",function(){return M});a.d(Ia,"testableGetPartialInteractivityState",function(){return ea});a.d(Ia,"testableInitPartialInteractivityState",function(){return aa});a.d(Ia,"testableIsFirstRowColOfNextBlockHidden",function(){return D});
a.d(Ia,"testableIsSelectedRangeAcrossBlocks",function(){return I});a.d(Ia,"testableGetRowColNumberForCascade",function(){return Q});var Sa={};a.r(Sa);a.d(Sa,"ResizeCommandHandler",function(){return Xd});var Ya=a(135),da=a(0),Ea=a(23),oa=a(27),za=a(13),la=a(189),Ca=a(15),Va=a(1),ia=a(44),wa=a(12),Jb=a(94),$a=a(5),Ka=a(95),nb=a(10),sa=a(1085);class na{constructor(yb,Ta,Hb){this.YVb=!0;this.Sj=yb;this.Eia=Ta;this.YVb=Hb||Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8453101_deleteRowsRefUpdate")}f$k(yb,
Ta,Hb,uc){if(yb){var Sc=yb.includes(this.Eia);if(!this.Sj)return{isRefError:yb.includes(this.Eia),newFormula:yb};var bc=this.Sj.vGd(yb);if(bc){var vc=0>Hb||0>Ta,Xc=[];try{for(const Id of bc){const ue=Id.ref;switch(ue.type){case sa.a.cell:bc=ue;const Vd=bc.row,Kd=bc.col,Yd="Abs"===Vd.kind,Bc="Abs"===Kd.kind,Mc=Vd.index+1,Fd=Kd.index+1,Md=oa.Range.vi(Mc,Fd),oe=bc.span;if(vc&&r(uc,Md)){Xc.push({value:this.Eia,start:oe.start,end:oe.end});Sc=!0;break}const ye=0===Hb?!0:Md.left<uc.right,te=0===Ta?!0:Md.bottom<
uc.top;if(ye&&te)break;bc=te?Mc:Mc+Ta;var ad=ye?Fd:Fd+Hb;if(!c(bc)||!b(ad)){Xc.push({value:this.Eia,start:oe.start,end:oe.end});Sc=!0;break}const ze=oa.Range.vi(bc,ad).Fga(Bc,Yd,Bc,Yd);Xc.push({value:ze,start:oe.start,end:oe.end,NLa:this.Sj.$Wa(oe.end,yb)});break;case sa.a.column:if(!Hb)break;bc=ue;const He=bc.startIndex,ne=bc.endIndex,of=He.index+1,lf=ne.index+1,jf="Abs"===He.kind,Cf="Abs"===ne.kind,Gf=oa.Range.fY(of,lf),Af=bc.span;if(vc&&r(uc,Gf)){Xc.push({value:this.Eia,start:Af.start,end:Af.end});
Sc=!0;break}const Lf=Gf.left<uc.left,Ef=Gf.right<uc.left;if(Lf&&Ef)break;bc=Lf?of:of+Hb;ad=Ef?lf:lf+Hb;vc&&0<=ad-bc&&1>bc&&(bc=1);this.YVb&&0>Hb&&Lf&&!Ef&&uc.right>lf&&1<=uc.left-1&&(ad=uc.left-1);if(!b(bc)||!b(ad)){Xc.push({value:this.Eia,start:Af.start,end:Af.end});Sc=!0;break}const Hf=oa.Range.fY(bc,ad).Fga(jf,!1,Cf,!1);Xc.push({value:Hf,start:Af.start,end:Af.end});break;case sa.a.row:if(!Ta)break;bc=ue;const $b=bc.startIndex,Wb=bc.endIndex,Dc="Abs"===$b.kind,Jf="Abs"===Wb.kind,Rb=$b.index+1,Gb=
Wb.index+1,Cc=oa.Range.QU(Rb,Gb),cb=bc.span;if(vc&&r(uc,Cc)){Xc.push({value:this.Eia,start:cb.start,end:cb.end});Sc=!0;break}const pc=Cc.top<uc.top,Ic=Cc.bottom<uc.top;if(pc&&Ic)break;bc=pc?Rb:Rb+Ta;ad=Ic?Gb:Gb+Ta;vc&&0<=ad-bc&&1>bc&&(bc=1);this.YVb&&0>Ta&&pc&&!Ic&&uc.bottom>Gb&&1<=uc.top-1&&(ad=uc.top-1);if(!c(bc)||!c(ad)){Xc.push({value:this.Eia,start:cb.start,end:cb.end});Sc=!0;break}const rd=oa.Range.QU(bc,ad).Fga(!1,Dc,!1,Jf);Xc.push({value:rd,start:cb.start,end:cb.end});break;case sa.a.range:bc=
ue;const Rd=bc.top,va=bc.left,Bb=bc.bottom,Ac=bc.right,Nc=Rd.index+1,hd=va.index+1,qd=Bb.index+1,je=Ac.index+1,Ie="Abs"===Rd.kind,Oe="Abs"===va.kind,Vb="Abs"===Bb.kind,fd="Abs"===Ac.kind,Qd=new oa.Range(Nc,hd,qd,je,!1,!1),me=bc.topLeftSpan,se=bc.bottomRightSpan;if(vc&&r(uc,Qd)){Xc.push({value:this.Eia,start:me.start,end:se.end});Sc=!0;break}const Ne=0===Ta?!0:Qd.top<uc.top,Ue=0===Hb?!0:Qd.left<uc.left,nf=0===Ta?!0:Qd.bottom<uc.top,tb=0===Hb?!0:Qd.right<uc.left;if(Ne&&Ue&&nf&&tb)break;bc=Ne?Nc:Nc+
Ta;ad=nf?qd:qd+Ta;let lc=Ue?hd:hd+Hb,Tc=tb?je:je+Hb;this.YVb&&0>Ta&&Ne&&!nf&&uc.bottom>qd&&1<=uc.top-1&&(ad=uc.top-1);this.YVb&&0>Hb&&Ue&&!tb&&uc.right>je&&1<=uc.left-1&&(Tc=uc.left-1);vc&&0<=ad-bc&&1>bc&&(bc=1);vc&&0<=ad-lc&&1>lc&&(lc=1);if(!b(lc)||!c(bc)){Xc.push({value:this.Eia,start:me.start,end:me.end});Sc=!0;break}if(!b(Tc)||!c(ad)){Xc.push({value:this.Eia,start:se.start,end:se.end});Sc=!0;break}const md=oa.Range.vi(bc,lc).Fga(Ie,Oe,!1,!1),sd=oa.Range.vi(ad,Tc).Fga(Vb,fd,!1,!1);Xc.push({value:md,
start:me.start,end:me.end,NLa:this.Sj.$Wa(me.end,yb)});Xc.push({value:sd,start:se.start,end:se.end,NLa:this.Sj.$Wa(se.end,yb)})}}return{newFormula:h(yb,Xc),isRefError:Sc}}catch(Id){if(Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8793263_improvedExceptionHandlingGlobalStyles"))Ca.ULS.sendTraceTag(507360605,0,15,`GridReferenceUpdates.UpdateReference failed with error: ${Id}`);else throw Id;}}}}dispose(){this.Sj=null}}Object(da.a)(na,"GridReferenceUpdate",null,[4]);var ab=a(407),Ja=a(217),Pa=a(62),
hb;(function(yb){yb.Hide="Hide";yb.Unhide="Unhide";yb.Insert="Insert";yb.Delete="Delete";yb.FreezePane="FreezePane"})(hb||(hb={}));Object(da.b)("GridInstantaneousOperation",hb);let ac=null;const Hc=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8524738_CanvasAndSelectionHighlightBugFix");let bd=!1,zc=!1;const oc=nb.a.xR/4,Nb=nb.a.m0/4;let Aa=class{constructor(yb,Ta,Hb){this.$=yb;this.Sj=Ta;this.yk=Hb;this.n4b="!REF#";this.vp=()=>{ac&&(Jb.a.dh(ac),ac=null);this.roa&&(this.$.aXd=!1)};this.Tng=()=>{this.n4b=
this.jUd.zk.ErrorNames[3];this.eQd=new na(this.Sj,this.n4b)};this.da=Ea.f(this.$);this.za=this.da.za;this.Oya=!1;this.bNb=this.$.ea.Ek;this.$5b={};this.My={};this.$la={};this.roa=Va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GlobalStylesSlice1",!1);this.T1a=Va.EwaSettings.pob();this.za.ny(this.vp);this.Gjj=Va.EwaSettings.wLa();this.Vmj=Va.EwaSettings.Fya();this.Rmj=Va.EwaSettings.Eya();this.Fjj=Va.EwaSettings.Znb();this.GLa=this.Rmj||this.Vmj||this.Gjj||this.Fjj;this.r2f=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8619261_EnableRowColCSEForCellEntryPoint");
this.JUd=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8645280_EnablingRowColCSEIfFirstRowColOfNextBlockHidden");this.OHc=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8702535_EnablingHiddenRangeSlice2Ewa");this.x3a=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8780264_logFpCseUnattemptedInSingleTag");this.EHc=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8775076_FreezeCseWhenRowsColumnsHidden")&&Va.EwaSettings.UWd();this.MWf=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8788453_hideSelectionForFreezePanesCse");
this.GLa&&void Ka.a.sj($a.Cd).then(uc=>{this.jUd=uc;uc.zk?(uc.zk.ErrorNames&&3<uc.zk.ErrorNames.length&&(this.n4b=uc.zk.ErrorNames[3]),this.eQd=new na(this.Sj,this.n4b)):uc.ypd(this.Tng)});bd=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8575809_mathMax");zc=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8699403_measureValidations");this.Hnb=Va.EwaSettings.pob()&&Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8771915_enableAsyncFreezePanesCSEOperation");this.Jnj=Va.EwaSettings.UWd()&&Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8778653_enableFreezePanesCseForSheetsWithMergeCells")}dispose(){this.da=
this.$=null;this.My={};this.Oya=!1;this.$5b={};this.za.ux(this.vp);this.jUd&&this.jUd.eVc(this.Tng)}msd(yb,Ta,Hb){try{if(this.Oya)Ca.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${yb}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=${Ta}`);else if(this.Hlj(yb)){const Kd=this.za.Qzc();this.OKh(yb,null===Hb||void 0===Hb?void 0:Hb.Oz,Kd)}else{var uc=Va.EwaSettings.X1a()?Va.EwaSettings.wme():Va.EwaSettings.i5d(),
Sc=this.za.Qzc(1554436520===yb||1051390410===yb?uc:0,674605324===yb||-706918724===yb?uc:0);this.LF=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8627749_EnabledSelectedRangePassingAsParameter")&&(null===Hb||void 0===Hb?0:Hb.selectedRanges)?null===Hb||void 0===Hb?void 0:Hb.selectedRanges:this.da.ha.qa.selectedRanges;if(this.r2f){const Kd=this.LF[0];var bc=Ta?!(1===Kd.left&&Kd.right===Kd.maxColumns):!(1===Kd.top&&Kd.bottom===Kd.maxRows)}else bc=!1;this.wqj=bc;if(this.r2f&&this.wqj){var vc=this.LF;if(0===
vc.length)var Xc=null;else{uc=[];for(const Kd of vc){const Yd=Kd.clone();Ta?(Yd.left=1,Yd.right=Yd.maxColumns):(Yd.top=1,Yd.bottom=Yd.maxRows);uc.push(Yd)}Xc=uc}this.LF=Xc}var ad=E(this.da,Sc,Ta,yb,this.LF);this.My={};this.GLa&&(this.$la={},this.Tub=0,this.ELb=Hb);if(!zc||!this.XFa("WebServiceResponseReceivedInAttemptInstantaneousGridAction",Sc,yb,Ta)){var Id=performance.now();this.w7d=this.hRi(yb,Ta);var ue=this.Wmj(yb,Sc,ad,Ta),Vd=performance.now()-Id;Vd&&zc&&Ca.ULS.sendTraceTag(507556638,0,50,
`GridInstantaneousAction.attemptInstantaneousGridAction command=${yb}, time taken for isInstantaneousGridActionPossible=${Vd}, isRow=${Ta}`);ue?(this.Oya=!0,this.$.aXd=!0,this.Tsg=performance.now(),this.ayg(yb,Ta,ad,Sc)):this.da.Hk.zza(!1)}}}catch(Kd){this.tDc("GridInstantaneousAction.AttemptInstantaneousGridAction",Kd,yb)}}Oge(){this.bNb=this.$.ea.Ek}OKh(yb,Ta,Hb){if(this.Glj(yb,Hb,Ta)){this.Tsg=performance.now();this.Oya=!0;const uc=F(Hb);this.My={};this.Hnb?(this.$ce(Hb),this.Mee(yb,uc,Hb,Ta,new Map,
new Map)):this.Mee(yb,uc,Hb,Ta)}else this.da.Hk.zza(!1)}Glj(yb,Ta,Hb){var uc,Sc,bc;if(!this.Flj(yb))return!1;if(isNullOrUndefined(Hb))return this.x3a&&n("PaneViewData Null",yb),!1;var vc=this.da;const Xc=vc.kj;if(this.EHc){var ad=null!==(uc=vc.emb())&&void 0!==uc?uc:vc.R5();if(null===ad||1!==ad.top||1!==ad.left)return n("Horizontal/Vertical Scroll",yb),!1;if(!l(vc,Hb,yb))return!1}else if(Hb.VisibleColumns+1!==Hb.FirstScrollableColumn||Hb.VisibleRows+1!==Hb.FirstScrollableRow)return this.x3a?n("Horizontal/Vertical Scroll",
yb):Ca.ULS.sendTraceTag(507650447,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${yb}, parameter = Scroll present`),!1;for(const Bc of Ta){uc=Bc.Pj;if(0<(null===(bc=null===(Sc=null===uc||void 0===uc?void 0:uc.Content)||void 0===Sc?void 0:Sc.MergedRanges)||void 0===bc?void 0:bc.length)){if(!this.Jnj)return this.x3a?n("Merged Cell",yb):Ca.ULS.sendTraceTag(507650446,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${yb}, parameter = Merged Cell present`),
!1;a:{var Id=Ta,ue=Bc;vc=Hb;ad=this.da;if(!ue&&0>=ue.Vs){uc=!0;break a}uc=ue.Pj.GridBlockModel;const Mc=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8775076_FreezeCseWhenRowsColumnsHidden")&&Va.EwaSettings.UWd();var Vd=Id,Kd=ue,Yd=vc;if(f(Kd,1,Yd,Vd)||f(Kd,4,Yd,Vd))if(Vd=v(uc,vc,1,Mc?x(ad,vc.FirstScrollableRow,!0).Lmb:0),Vd=uc.RowNumbers[0]+Vd.r6b-1,Vd=Vd<uc.RowNumbers[0]?uc.RowNumbers[0]:Vd,!C(uc,Vd,0,!0,"FreezePane")){uc=!1;break a}Vd=vc;if(f(ue,1,Vd,Id)||f(ue,3,Vd,Id))if(vc=w(uc,vc,1,Mc?x(ad,
vc.FirstScrollableColumn,!1).Lmb:0),vc=uc.ColumnNumbers[0]+vc.yLb-1,vc=vc<uc.ColumnNumbers[0]?uc.ColumnNumbers[0]:vc,!C(uc,vc,0,!1,"FreezePane")){uc=!1;break a}uc=!0}if(!uc)return this.x3a?n("Merged Cells Spanblocks",yb):Ca.ULS.sendTraceTag(507360354,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${yb}, parameter = Merged Cells Spanblocks present`),!1}if(0<Bc.$o.count)return this.x3a?n("Floating Objects",yb):Ca.ULS.sendTraceTag(507650445,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${yb}, parameter = FO present`),
!1;if(Bc.ql.getHasTable())return this.x3a?n("Table/PivotTable",yb):Ca.ULS.sendTraceTag(507650444,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${yb}, parameter = Table present`),!1;if(!this.EHc&&Xc.Coa(Bc.yj))return this.x3a?n("Hidden Row/Col",yb):Ca.ULS.sendTraceTag(507650443,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${yb}, parameter = Hidden row/col present`),!1}return!0}Wmj(yb,Ta,Hb,uc){const Sc=this.da,bc=this.da.Hk;if(!this.vXf(yb))return bc.RY("CSENotEnabledForCommand"),
!1;if(Sc.rtl)return Ca.ULS.sendTraceTag(508171339,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = hasRtl, value=true, isRow=${uc}`),bc.RY("RTL"),!1;if(!Va.EwaSettings.j2a()&&Sc.fh.Fy)return Ca.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = hasPanes, value=true, isRow=${uc}`),!1;var vc=Sc.kj,Xc=this.LF,ad=this.LF[0],Id=Xc.length;if(1<Id)return Ca.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = SelectedRanges, value=${Id}, reason = Discontinuous selection, isRow=${uc}`),
bc.RY("Discontinuous selection"),!1;var ue=Va.EwaSettings.Fya()&&-1113896058===yb;Id=Va.EwaSettings.Eya()&&1415868706===yb;if(ue||Id){if(ue){if(1!==ad.top){var Vd=new oa.Range(ad.top-1,ad.left,ad.top-1,ad.right,!1,!1);Vd=vc.cpb(Vd)}}else 1!==ad.left&&(Vd=new oa.Range(ad.top,ad.left-1,ad.bottom,ad.left-1,!1,!1),Vd=vc.Tnb(Vd));if(Vd)return Ca.ULS.sendTraceTag(508072654,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = isPreviousRowColHidden, value=true, isRow=${uc}`),
bc.RY("isPreviousRowColHidden"),!1;var Kd;a:{for(const te of Hb){if(Va.EwaSettings.xha()){if(!te.source)continue}else if(!te.source)break;Vd=null===(Kd=te.source)||void 0===Kd?void 0:Kd.yj;if(!Vd){X("isFirstRowColOfNonInitialModel",yb);break}if(Vd.Xi(ad)){Kd=!1;ue?1!==Vd.top&&ad.top===Vd.top&&(Kd=!0):Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8690337_InsertColumnFlickerBugFixV2")&&1===Vd.left||ad.left!==Vd.left||(Kd=!0);break a}}Kd=!0}if(Kd)return Ca.ULS.sendTraceTag(508065493,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = isFirstRowColInNonInitialModel, value=true, isRow=${uc}`),
bc.RY("isFirstRowColInNonInitialModel"),!1}if(Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8598978_EnablingCseForHiddenRangesSlice1")){if(!this.OHc&&!this.Ycf(ad,uc))return Ca.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = isPartOfRangeHidden, value=true, isRow=${uc}`),!1}else if(vc.Coa(ad))return Ca.ULS.sendTraceTag(507635548,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = isPartOfRangeHidden, value=true, isRow=${uc}`),
!1;vc=this.w7d;if(Va.EwaSettings.X1a()?vc>Va.EwaSettings.wme():vc>Va.EwaSettings.i5d())return Ca.ULS.sendTraceTag(508409418,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = rowColCount, value=${vc}, reason = rowColCount is higher than the limit, isRow=${uc}`),bc.RY("rowColCount is higher than the limit"),!1;if(ue&&(ue=Sc.usedRange.bottom+vc,ue>nb.a.eG))return Ca.ULS.sendTraceTag(508061699,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = newRowCount, value=${ue}, reason = newRowCount is higher than the MaxRows, isRow=${uc}`),
bc.RY("newRowCount is higher than the MaxRows"),!1;if(Id&&(Id=Sc.usedRange.right+vc,Id>nb.a.PE))return Ca.ULS.sendTraceTag(508061698,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = newColCount, value=${Id}, reason = newColCount is higher than the MaxRows, isRow=${uc}`),bc.RY("newColCount is higher than the MaxCols"),!1;if(I(ad,Hb,yb))return Ca.ULS.sendTraceTag(508404044,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = isSelectedRangeAcrossBlocks, value=true, isRow=${uc}`),
bc.RY("isSelectedRangeAcrossBlocks"),!1;if(Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8624357_DisableRowColCSEForTables")&&!this.jTh(ad,yb))return Ca.ULS.sendTraceTag(507855194,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = selectedRangeContainingTable, value=true, isRow=${uc}`),bc.RY("selectedRangeContainingTable"),!1;Id=Ta.length;if(Id>Va.EwaSettings.QEj())return Ca.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = BlocksInViewport, value=${Id}, reason = Blocks in viewport limit exceeded, isRow=${uc}`),
bc.RY("Blocks in viewport limit exceeded"),!1;a:{Id=vc-1;for(Yd of Hb){if(!Yd){Ca.ULS.sendTraceTag(509649925,0,50,`GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null and command=${yb}`);var Yd=!1;break a}vc=Yd.source;if(!Va.EwaSettings.xha()||vc){if(!Va.EwaSettings.xha()&&!vc){Yd=!1;break a}vc=vc.Pj.GridBlockModel;ue=Q(vc,Id,uc,yb);if(!C(vc,ue,Id,uc,ja(yb))){Yd=!1;break a}}}Yd=!0}if(!Yd)return Ca.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=${uc}`),
bc.RY("Model has complex cells"),!1;a:{Yd=uc?ad.top:ad.left;Id=uc?ad.bottom-ad.top:ad.right-ad.left;if(ad=this.za.JJa(ad,this.$.activeItemName))for(Bc of ad)if(!C(Bc.Pj.GridBlockModel,Yd,Id,uc,ja(yb))){var Bc=!1;break a}Bc=!0}if(!Bc)return Ca.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=${uc}`),bc.RY("Selected row or Col has complex cells"),
!1;a:{Xc=Xc[0];Bc=0;for(Mc of Hb)if(!Va.EwaSettings.xha()||Mc.source&&Mc.destination){if(!(Va.EwaSettings.xha()||Mc.source&&Mc.destination))break;Yd=Mc.destination.yj;ad=Mc.source.yj;if(null===Yd||null===ad){X("getTransitionCount source or destination block range is null",yb);var Mc=Va.EwaSettings.j5d()+1;break a}if(!Yd&&Va.EwaSettings.PHc()){X("getTransitionCount",yb);Mc=Va.EwaSettings.j5d()+1;break a}Id=Xc;(ad=369708605===yb||1415868706===yb||1542466017===yb||-1113896058===yb?ad.Xi(Id):Yd.Xi(Id))||
(ad=yb,vc=Mc,Yd=Xc,!Va.EwaSettings.xha()||vc.source&&vc.destination?(Id=vc.source.yj,vc=vc.destination.yj,!Va.EwaSettings.PHc()||vc&&Id?ad=-706918724===ad||674605324===ad?vc.left>Yd.right:369708605===ad||1415868706===ad?Id.left>Yd.right:1051390410===ad||1554436520===ad?vc.top>Yd.bottom:Id.top>Yd.bottom:(X("shouldPerformTransitions",ad),ad=!1)):ad=!1);ad&&(Bc+=1)}Mc=Bc}if(Mc>Va.EwaSettings.j5d())return Ca.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = TransitionCount, value=${Mc}, reason = Transition count limit exceeded, isRow=${uc}`),
bc.RY("Transition count limit exceeded"),!1;if(!this.JUd&&D(Sc,Hb,yb))return Ca.ULS.sendTraceTag(508564123,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = isFirstRowColOfNextBlockHidden, value=true, isRow=${uc}`),!1;if(Hb=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8683331_OutlineBugFix")){var Fd;a:{var Md,oe,ye;for(const te of Ta)if(Ta=te.tKa(),uc&&Ta&&0<(null===(Fd=Ta.RowOutlines)||void 0===Fd?void 0:Fd.length)&&0<(null===(Md=Ta.RowOutlinesInformation)||
void 0===Md?void 0:Md.length)||!uc&&Ta&&0<(null===(oe=Ta.ColumnOutlines)||void 0===oe?void 0:oe.length)&&0<(null===(ye=Ta.ColumnOutlinesInformation)||void 0===ye?void 0:ye.length)){Fd=!1;break a}Fd=!0}Hb=!Fd}if(Hb)return Ca.ULS.sendTraceTag(507566090,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = outlines, value=true, isRow=${uc}`),bc.RY("Outlines are present"),!1;Ca.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${yb}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=${uc}`);
return!0}M3b(yb,Ta,Hb,uc,Sc,bc,vc){const Xc=bc?Sc.GWc:Sc.Frc;Sc=bc?Sc.yLb:Sc.r6b;const ad=bc?"FreezeRow":"FreezeColumn";a:{const Id=Hb.FirstScrollableRow;Hb=Hb.FirstScrollableColumn;switch(uc){case 1:uc={FWc:bc?yb.RowNumbers[0]:yb.ColumnNumbers[0],SRc:!vc,RRc:!0,performDiagonalCascading:vc,skipCascadingBeforeRowColIndex:!vc};break a;case 2:uc={FWc:bc?Id:Hb,SRc:!0,RRc:!1,performDiagonalCascading:vc,skipCascadingBeforeRowColIndex:!1};break a;case 3:uc={FWc:bc?Id:yb.ColumnNumbers[0],SRc:!0,RRc:bc?!1:
!0,performDiagonalCascading:vc,skipCascadingBeforeRowColIndex:!1};break a;case 4:uc={FWc:bc?yb.RowNumbers[0]:Hb,SRc:!0,RRc:bc?!0:!1,performDiagonalCascading:vc,skipCascadingBeforeRowColIndex:!1};break a}uc=null}if(!uc)return Ca.ULS.sendTraceTag(507569417,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${ad}, parameter = isHideRowColumnSuccessful, value=false, reason = "fpConstructionParams failed", `),!1;if(yb&&0<=Xc){if(uc.SRc&&!gridRenderer.CanvasRendererGlobals.performModelRowColOperation(yb,
uc.FWc,Xc,hb.FreezePane,bc))return Ca.ULS.sendTraceTag(507586704,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${ad}, parameter = freezePaneRestructureSuccessful, isRow =${bc}, value=false, reason = "Restructuring was failure", `),!1;if(Ta&&yb&&uc.RRc)if(gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(Ta,yb,bc?Ta.RowNumbers[0]:Ta.ColumnNumbers[0],Xc,hb.FreezePane,bc,{rowColIndexToEndRangeCascade:Sc,skipCascadingBeforeRowColIndex:uc.skipCascadingBeforeRowColIndex,
performDiagonalCascading:uc.performDiagonalCascading}).isSuccess)Ca.ULS.sendTraceTag(507576470,0,50,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${ad}, parameter = freezePaneBlockCascadeOperation, value=true, isRow =${bc}, reason = "BlockCascadeRowColsOperations success", `);else return Ca.ULS.sendTraceTag(507586703,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${ad}, parameter = freezePaneBlockCascadeOperation, value=false, isRow =${bc}, reason = "BlockCascadeRowColsOperations was failure", `),
!1}return!0}ayg(yb,Ta,Hb,uc){var Sc;try{if(this.vXf(yb)){var bc=za.HelperMethods.Kh(),vc=Va.EwaSettings.XMc(),Xc=Hb.filter(Mc=>!Mc.mV),ad=this.LF[0],Id=this.OHc?this.w7d-1:Ta?ad.bottom-ad.top:ad.right-ad.left,ue=ja(yb);for(const Mc of Xc){if(this.XFa("WebServiceResponseReceivedInProcessGridAction",uc,yb,Ta))return;if(this.GLa){if(!B(Mc,ad,yb,Ta))continue}else{const ze=Mc.destination.yj;if(!ze){X("processGridAction",yb);return}if(ze.right<ad.left){Mc.mV=!0;Ca.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${yb}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${ad.left}, blockRangeRightMostValue=${ze.right}, hashCode=${Mc.destination.Pi}, isRow=false`);
continue}}const Fd=Ta?ad.topLeft.top:ad.topLeft.left;let Md,oe;Va.EwaSettings.xha()?(Md=Mc.source?this.Uwa("SourceModel",Mc.source,yb):null,oe=Mc.destination?this.Uwa("DestinationModel",Mc.destination,yb):null):(Md=this.Uwa("SourceModel",Mc.source,yb),oe=this.Uwa("DestinationModel",Mc.destination,yb));const ye=Mc.destination?Mc.destination.Pi:Mc.source.Pi;Hb=!1;const te=ue===hb.Hide||ue===hb.Delete?oe:Md;if(Y(Mc,yb,ad)){if(!L(te,Fd,Id,ue,Ta,yb)){this.eU();Ca.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${yb}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${ye}, isRow=${Ta}, rowColNumber=${Fd}`);
return}Ca.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${yb}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${ye}, isRow=${Ta}, rowColNumber=${Fd}`)}else if(Va.EwaSettings.j2a()&&this.da.fh.NYd(ad)){const ze=this.da.fh.Gm;if(ad.right<=this.da.fh.Ym||ad.bottom<=ze)Hb=xa(te,yb,Id+1)}if(Md&&oe&&!Hb){let ze;ze=this.GLa?Q(Md,Id,Ta,yb):Md.ColumnNumbers[0];const He=Mc.source.Pi;if(M(Md,oe,ze,Id,ue,Ta,yb).isSuccess)Mc.mV=
!0,this.JUd&&(this.My[He]||this.DEg(Md,Ta),this.My[null===(Sc=null===Mc||void 0===Mc?void 0:Mc.destination)||void 0===Sc?void 0:Sc.Pi]||this.DEg(oe,Ta),this.A6k(Md,oe,ue,Ta)),Ca.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${yb}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${He}, isRow=${Ta}, rowColNumber=${ze}`);else{this.eU();Ca.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${yb}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${He}, isRow=${Ta}, rowColNumber=${ze}`);
return}}else Mc.mV=!0;this.YVk(oe,Md,Mc);if(za.HelperMethods.Kh()-bc>vc){this.txk(yb,Ta,Xc,uc);return}}var Vd=()=>{try{this.l_h(Ta,yb,uc,ad),U("ProcessGridAction",za.HelperMethods.Kh()-bc,yb)}catch(Mc){this.tDc("GridInstantaneousAction.ProcessGridAction",Mc,yb)}};if(this.GLa&&this.ELb&&this.ELb.AFc&&this.ELb.AFc.InsertDeleteRangeItems&&0<this.ELb.AFc.InsertDeleteRangeItems.length)if(this.eQd){var Kd=this.ELb.AFc.InsertDeleteRangeItems[0],Yd=(Mc,Fd)=>0!==Kd.DeltaRow?Mc>=ad.top:0!==Kd.DeltaColumn?Fd>=
ad.left:!1,Bc=Mc=>this.eQd.f$k(Mc,Kd.DeltaRow,Kd.DeltaColumn,ad);zc?window.setTimeout(()=>{this.iAe(uc,yb,Ta,Yd,Bc,Vd)},0):this.iAe(uc,yb,Ta,Yd,Bc,Vd)}else this.Oya=!1,this.da.Hk.zza(!1),Ca.ULS.sendTraceTag(508063873,0,15,`GridInstantaneousAction:processGridAction gridReferenceUpdates is null command=${yb}`);else Vd()}else this.Oya=!1,this.da.Hk.zza(!1)}catch(Mc){this.tDc("GridInstantaneousAction.ProcessGridAction",Mc,yb)}}Z0h(yb,Ta,Hb,uc,Sc,bc){var vc,Xc,ad,Id,ue,Vd,Kd=v(yb,Sc,bc,this.EHc?x(this.da,
Sc.FirstScrollableRow,!0).Lmb:0);const Yd=w(yb,Sc,bc,this.EHc?x(this.da,Sc.FirstScrollableColumn,!1).Lmb:0);Kd={r6b:Kd.r6b,GWc:Kd.GWc,yLb:Yd.yLb,Frc:Yd.Frc};switch(bc){case 1:if(!this.M3b(yb,Hb,Sc,bc,Kd,!0,!1))return this.eU(),Ca.ULS.sendTraceTag(507568152,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${bc} failed, cascadingType=Row`),null;if(!this.M3b(yb,Ta,Sc,bc,Kd,!1,!1))return this.eU(),Ca.ULS.sendTraceTag(507568151,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${bc} failed, cascadingType=Col`),
null;if(!this.M3b(yb,uc,Sc,bc,Kd,!1,!0))return this.eU(),Ca.ULS.sendTraceTag(507568150,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${bc} failed, cascadingType=Diagonal-Col`),null;break;case 2:case 3:case 4:if(!this.M3b(yb,Hb,Sc,bc,Kd,!0,!1))return this.eU(),Ca.ULS.sendTraceTag(507568149,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${bc} failed, cascadingType=Row`),null;if(!this.M3b(yb,Ta,Sc,bc,Kd,!1,!1))return this.eU(),Ca.ULS.sendTraceTag(507568148,
0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${bc} failed, cascadingType=Col`),null;break;default:return null}return new oa.Range(null===(vc=yb.RowNumbers)||void 0===vc?void 0:vc[0],null===(Xc=yb.ColumnNumbers)||void 0===Xc?void 0:Xc[0],null===(ad=yb.RowNumbers)||void 0===ad?void 0:ad[(null===(Id=yb.RowNumbers)||void 0===Id?NaN:Id.length)-1],null===(ue=yb.ColumnNumbers)||void 0===ue?void 0:ue[(null===(Vd=yb.ColumnNumbers)||void 0===Vd?NaN:Vd.length)-1],!1,!1)}b1h(yb,
Ta,Hb,uc,Sc,bc){a:{var vc=Hb.FirstScrollableRow,Xc=Hb.FirstScrollableColumn;for(ad of uc)if(k(ad,vc,Xc)){vc={};vc.X=ad.ar.X;vc.Y=ad.ar.Y;var ad=vc;break a}ad=null}if(!ad||!Hb)return Ca.ULS.sendTraceTag(507576400,0,15,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Ta}, parameter = getRootBlockPostionOfFP, value=false, reason = "Construction failed", blockPosition= Failed to receive the root of FP ops `),!1;vc=Hb.FirstScrollableRow;Xc=Hb.FirstScrollableColumn;for(let Md=
1;4>=Md;Md++)if(f(yb.destination,Md,Hb,uc)){var Id=yb.destination,ue=vc,Vd=Xc,Kd=Md,Yd=ad,Bc={};if(k(Id,ue,Vd))switch(Kd){case 1:Bc.X=0;Bc.Y=0;break;case 4:Bc.X=Id.ar.X;Bc.Y=0;break;case 3:Bc.X=0;Bc.Y=Id.ar.Y;break;case 2:Bc.X=Id.ar.X,Bc.Y=Id.ar.Y}else switch(Kd){case 1:Id=y(Id.ar,Yd);Bc.X=Id.X;Bc.Y=Id.Y;break;case 4:var Mc=Vd=void 0,Fd=void 0;(null===(Fd=Id.PB)||void 0===Fd?void 0:Fd[0])<=ue&&(null===(Mc=Id.PB)||void 0===Mc?void 0:Mc[(null===(Vd=Id.PB)||void 0===Vd?NaN:Vd.length)-1])>=ue?(Bc.X=Id.ar.X,
Bc.Y=0):(Yd=y(Id.ar,Yd),Bc.X=Id.ar.X,Bc.Y=Yd.Y);break;case 3:Fd=Mc=ue=void 0;(null===(Fd=Id.XG)||void 0===Fd?void 0:Fd[0])<=Vd&&(null===(Mc=Id.XG)||void 0===Mc?void 0:Mc[(null===(ue=Id.XG)||void 0===ue?NaN:ue.length)-1])>=Vd?Bc.X=0:(Yd=y(Id.ar,Yd),Bc.X=Yd.X);Bc.Y=Id.ar.Y;break;case 2:Bc.X=Id.ar.X,Bc.Y=Id.ar.Y}Bc.PaneType=Kd;Kd=Bc;Bc=this.Uwa("DestinationModel",yb.destination,Ta);Id=yb.oXg?this.Uwa("SourceModel",yb.oXg,Ta):null;Yd=yb.sXg?this.Uwa("SourceModel",yb.sXg,Ta):null;ue=1===Md?yb.pXg?this.Uwa("SourceModel",
yb.pXg,Ta):null:null;if(Id=this.Z0h(Bc,Yd,Id,ue,Hb,Md))Sc.set(Id,Bc),bc.set(Id,{ar:Kd,yj:Id,Pbf:yb.destination}),Ca.ULS.sendTraceTag(507586701,0,50,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Ta}, parameter = isNewBlockConstructionSuccessful, value=true, reason = "Construction Successful", blockPosition=${JSON.stringify(Kd)}, paneType=${Md}, `);else return Ca.ULS.sendTraceTag(507586700,0,15,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${Ta}, parameter = isNewBlockConstructionSuccessful, value=false, reason = "Construction failed", blockPosition=${JSON.stringify(Kd)}, paneType=${Md}, `),
!1}return!0}i5g(yb,Ta,Hb,uc){if(this.Hnb&&this.XFa("WebServiceResponseReceivedInUpdateBlockCacheWithConstructedBlock",uc,1844679312,void 0))return Ca.ULS.sendTraceTag(507381976,0,15,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=1844679312, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" '),!1;try{const Sc=za.HelperMethods.Kh();let bc=!0;yb.forEach((vc,Xc)=>{if(bc)if(Xc=Ta.get(Xc)){var ad=this.za.rn(Xc.Pbf.ma,Xc.ar);this.ZVk(vc,ad);this.za.w$j(Xc.ar,
Xc.Pbf.ma)?bc=this.za.v7k(ad,vc,Xc.ar,this.bNb,Hb):(Ca.ULS.sendTraceTag(507570071,0,50,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=freezeOrUnfreezeOperation, parameter = primeCacheItem, value=false, reason = "Prime Cache Items failed"'),bc=!1)}else bc=!1});if(!bc)return!1;U("updateBlockCacheWithConstructedBlock",za.HelperMethods.Kh()-Sc,1844679312);return!0}catch(Sc){return Ca.ULS.sendTraceTag(507570070,0,10,`encountered exception in updateBlockCacheWithConstructedBlock : ${Sc}`),
!1}}Mee(yb,Ta,Hb,uc,Sc,bc){uc=void 0===uc?null:uc;try{if(this.XFa("WebServiceResponseReceivedInProcessFreezePanesGridAction",Hb,yb,void 0))Ca.ULS.sendTraceTag(507586699,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${yb}, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" `);else{var vc=za.HelperMethods.Kh(),Xc=Va.EwaSettings.XMc(),ad=[];if(this.Hnb){ad=Ta.filter(Vd=>!Vd.mV);var Id=Sc;var ue=bc}else this.$ce(Hb),ad=Ta,Id=new Map,ue=new Map;
for(const Vd of ad)if(Vd.destination){if(!this.b1h(Vd,yb,uc,Hb,Id,ue)){this.eU();Ca.ULS.sendTraceTag(507586698,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${yb}, parameter = isBlockConstructionForPairSuccessful, value=false, reason = "Construction failed", hashCode = ${Vd.destination.Pi} , `);return}if(this.Hnb&&(Vd.mV=!0,za.HelperMethods.Kh()-vc>Xc)){this.sxk(yb,Ta,Hb,uc,Id,ue);return}}Id.size!==ue.size?Ca.ULS.sendTraceTag(507576399,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${yb}, parameter = processFreezePaneGridOperation, value=false, reason = "Constructed models not matching with constructed panes" `):
(Ta=!1,(Ta=this.Hnb?this.i5g(Id,ue,uc,Hb):this.i5g(Id,ue,uc))?this.rpk(yb,uc,Hb)?(Ca.ULS.sendTraceTag(507360353,0,50,`GridInstantaneousAction.processFreezePanesGridAction command=${yb}, parameter = processFreezePanesGridAction, value=true, reason = "Freeze Panes CSE operation complete" `),U("ProcessFreezePanesGridAction",za.HelperMethods.Kh()-vc,yb)):(this.qme(Hb),Ca.ULS.sendTraceTag(507381975,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${yb}, parameter = renderFreezePanesGrid, value=false, reason = "Updating constructing model failed" `)):
(this.qme(Hb),Ca.ULS.sendTraceTag(507570069,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${yb}, parameter = updateBlockCacheItem, value=false, reason = "Updating constructing model failed" `)))}}catch(Vd){this.qme(Hb),this.tDc("GridInstantaneousAction.ProcessFreezePanesGridAction",Vd,yb)}}l_h(yb,Ta,Hb,uc){if(!this.XFa("CommitGridInstantaneousActionResults",Hb,Ta,yb)){var Sc=za.HelperMethods.Kh();if(this.My&&0!==Object.keys(this.My).length){if(ka(Ta))for(var bc=0;bc<Hb.length;bc++){var vc=
Hb[bc].Pi;vc&&(vc=this.My[vc])&&gridRenderer.CanvasRendererGlobals.removeExtraModelRowCol(vc)}if(Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8712164_ACEFix_AbortRowColCSEWhenRowColOffsetsAreOutOfBoundsV2"))for(bc=Object.keys(this.My),vc=0;vc<bc.length;vc++){var Xc=this.My[bc[vc]];if(Xc){if(30<Xc.ColumnOffsets.length){Ca.ULS.sendTraceTag(507556629,0,15,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Ta},
              block # of columns = ${Xc.ColumnOffsets.length} > MaxAllowedRowColCount`);this.eU();return}if(28<Xc.RowOffsets.length){Ca.ULS.sendTraceTag(507556628,0,15,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Ta},
              block # of Rows = ${Xc.RowOffsets.length} > MaxAllowedRowColCount`);this.eU();return}}}var ad=[];ad.push(...Hb);Hc&&!this.da.fh.Fy&&(bc=this.za.qA().filter(Yd=>this.$.activeItemName===Yd.ma.sheetName),this.e9k(yb,bc,ad,Ta));this.$ce(ad);if(ka(Ta)||ha(Ta)){bc=this.da.usedRange;for(var Id of ad)Id.cH=4,Id.Q3a=!0,Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8578927_blockModelRestoringBugFix")?this.My[Id.Pi]&&!this.Pel(yb,Id.tKa(),this.My[Id.Pi],Id.yK().paneType)?this.My[Id.Pi]=null:Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8586105_blockRestoringServerReponseBugFix")&&
this.za.dBa(Id.Pi):this.DKk(Id,bc,uc,yb,Ta)?this.My[Id.Pi]=null:Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8586105_blockRestoringServerReponseBugFix")&&this.za.dBa(Id.Pi)}if(this.GLa&&this.$la)for(var ue in this.$la)Id=this.$la[ue],(bc=Id.o$j)&&Id.vVd&&this.yk.erc(bc.range,!0);if(this.ofh(Ta,ad)){ue=la.a.create().toString();Id=this.da.kj;bc=this.LF;if(fb(Ta)||ha(Ta))var Vd=0;else if(ka(Ta)){Vd=yb?ua(uc.top):uc.top;vc=yb?ua(uc.bottom):uc.bottom;Xc=yb?uc.left:ua(uc.left);var Kd=yb?uc.right:ua(uc.right);
Vd=new oa.Range(Vd,Xc,vc,Kd,!1,!1);Vd=yb?Id.getCellHeight(Vd):Id.getCellWidth(Vd)}Id.Tac(bc,Vd,yb);if(Va.EwaSettings.j2a()&&this.da.fh.Fy){Vd=this.xVi(uc,yb);bc=!1;vc={};for(const Yd of Hb)Yd.cH=4,Hb=Yd.yK().paneType,Xc=this.da.fh.Ym,Kd=this.da.fh.Gm,(4===Hb&&!yb||3===Hb&&(uc.right<=Xc||uc.bottom<=Kd))&&0===Object.keys(vc).length&&(vc=ca(Yd,Ta,Vd)),0!==Object.keys(vc).length&&(Yd.Pj.PaneViewData=vc,bc=!0,ab.b(Yd.ma,vc,Yd.wk.Revision,void 0,!0));bc&&this.da.cq.xye(Id,this.da.fh,!0,oc,Nb,this.da.XU())}uc=
Object.keys(this.My);this.za.pTc(uc,ue,yb?"row":"column",!0,Ta);this.Oya=!1;ac=ia.a(this.$).Tm.bGa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,wa.a.instance.ia(2188));U("CommitGridInstantaneousActionResults",za.HelperMethods.Kh()-Sc,Ta);this.GLa&&this.$la?window.setTimeout(()=>{this.XFa("commitGridInstantaneousActionResults",ad,Ta,yb)||(this.fAk(),this.MBg())},Va.EwaSettings.XMc()):this.MBg()}else this.PIg(ad),this.eU()}else this.eU(),Ca.ULS.sendTraceTag(509657994,0,50,
`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Ta}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${yb}`)}}rpk(yb,Ta,Hb){const uc=za.HelperMethods.Kh();if(this.Hnb&&this.XFa("WebServiceResponseReceivedInRenderFreezePanesGridInstantaneousActionResults",Hb,1844679312,void 0))return Ca.ULS.sendTraceTag(507381974,0,15,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=1844679312, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" '),
!1;Hb=la.a.create().toString();ab.b(this.$.ma,Ta,this.bNb,void 0,!0);Ta=this.da.kj;this.MWf&&this.da.Gh.YTb();this.da.cq.xye(Ta,this.da.fh,!0,oc,Nb,this.da.XU());Ta=Object.keys(this.My);this.za.pTc(Ta,Hb,"both",!0);this.MWf&&(this.da.Gh.Pzb(),this.da.Gh.Oca({r2:!0,c1:!0}));this.Oya=!1;ac=ia.a(this.$).Tm.bGa(6,"GridInstantaneousAction.renderFreezePanesGridInstantaneousActionResults",void 0,wa.a.instance.ia(2188));this.N8f();U("renderFreezePaneGridInstantaneousActionResults",za.HelperMethods.Kh()-uc,
yb);return!0}qme(yb){yb.forEach(Ta=>{Ta.cH=0;Ta.Pj.PaneViewData=null});this.za.wPa({SIa:!0,TIa:"FreezePaneNewCseBlocksDisposed"});this.PIg(yb);this.eU()}Pel(yb,Ta,Hb,uc){if(this.JUd&&(null===Hb||void 0===Hb?void 0:Hb.AdjacentBlocksHiddensInfo)!==(null===Ta||void 0===Ta?void 0:Ta.AdjacentBlocksHiddensInfo)||Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8632989_FreezePanesRowColCSEFlickerBugFix")&&(2===uc||3===uc||4===uc)||Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8595615_CSElogsBugFix")&&!this.I_h(Ta,
Hb,yb))return!0;uc=this.LF[0];var Sc=yb?uc.top:uc.left;const bc=yb?null===Ta||void 0===Ta?void 0:Ta.RowNumbers[(null===Ta||void 0===Ta?NaN:Ta.RowNumbers.length)-1]:null===Ta||void 0===Ta?void 0:Ta.ColumnNumbers[(null===Ta||void 0===Ta?NaN:Ta.ColumnNumbers.length)-1],vc=this.da.usedRange,Xc=yb?Ta.RowHeights:Ta.ColumnWidths,ad=yb?Hb.RowHeights:Hb.ColumnWidths;if((yb?uc.bottom:uc.right)<(yb?null===Ta||void 0===Ta?void 0:Ta.RowNumbers[0]:null===Ta||void 0===Ta?void 0:Ta.ColumnNumbers[0]))return 0<Ta.Cells.length||
Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8615878_willServerSendReponseInsertBugFix")&&0<Hb.Cells.length||!this.Ohf(Xc,ad);if(Sc>bc)return!1;Sc=this.wXi(yb,Sc,Ta);return this.Ohf(Xc,ad)&&(yb&&uc.top>vc.bottom||!yb&&uc.left>vc.right||!this.rYf(Ta,Sc,yb)&&!this.rYf(Hb,Sc,yb))?!1:!0}I_h(yb,Ta,Hb){yb=Hb?yb.RowNumbers:yb.ColumnNumbers;Ta=Hb?Ta.RowNumbers:Ta.ColumnNumbers;for(Hb=0;Hb<Math.min(yb.length,Ta.length);Hb++)if(yb[Hb]!==Ta[Hb])return!1;return!0}wXi(yb,Ta,Hb){yb=yb?Hb.RowNumbers:Hb.ColumnNumbers;
for(Hb=0;Hb<yb.length;Hb++)if(yb[Hb]===Ta)return Hb;return!(Ta<yb[0])&&Ta>yb[yb.length-1]?yb.length-1:0}Ohf(yb,Ta){for(let Hb=0;Hb<Math.min(yb.length,Ta.length);Hb++)if(yb[Hb]!==Ta[Hb])return!1;return!0}rYf(yb,Ta,Hb){if(0===yb.Cells.length)return!1;if(Hb)return yb.Cells[yb.Cells.length-1].Row>=Ta;for(Hb=0;Hb<yb.Cells.length;Hb++)if(yb.Cells[Hb].Col>=Ta)return!0;return!1}Ycf(yb,Ta){const Hb=this.da.kj,uc=Ta&&Hb.cpb(yb);yb=!Ta&&Hb.Tnb(yb);return!uc&&!yb}e9k(yb,Ta,Hb,uc){for(const Sc of Ta){const bc=
Sc.Pi,vc=this.Uwa("SourceModel",Sc,uc);if(!this.My[bc]){const Xc=this.DIi(yb,Sc,Ta);if(!Xc)continue;const ad=this.My[Xc.Pi];if(!ad||!Xc)break;this.v8k(yb,vc,ad);Sc.A8b=!0;this.My[bc]=vc;Hb.push(Sc)}}}v8k(yb,Ta,Hb){yb?(Ta.RowNumbers=Hb.RowNumbers,Ta.RowHeights=Hb.RowHeights,Ta.RowOffsets=Hb.RowOffsets,Ta.RowOutlinesInformation=Hb.RowOutlinesInformation,Ta.RowOutlines=Hb.RowOutlines,Ta.BlockHeight=Hb.BlockHeight):(Ta.ColumnNumbers=Hb.ColumnNumbers,Ta.ColumnWidths=Hb.ColumnWidths,Ta.ColumnOffsets=Hb.ColumnOffsets,
Ta.ColMetadata=Hb.ColMetadata,Ta.FixedColumns=Hb.FixedColumns,Ta.BlockWidth=Hb.BlockWidth)}DIi(yb,Ta,Hb){for(const uc of Hb)if(yb){if(Ta.yK().topLeft.Y===uc.yK().topLeft.Y&&this.My[uc.Pi])return uc}else if(Ta.yK().topLeft.X===uc.yK().topLeft.X&&this.My[uc.Pi])return uc;return null}fAk(){const yb=[];for(const Hb in this.$la){const uc=this.$la[Hb];if(!uc.vVd){var Ta=oa.Range.vi(uc.rowNum,uc.colNum);(Ta=this.da.zh(Ta))&&yb.push({Hfa:Ta,editText:uc.cellText})}}0<yb.length&&this.yk.YRh(yb)}Uwa(yb,Ta,Hb){let uc=
this.My[Ta.Pi];if(!uc){const Sc=za.HelperMethods.jN(()=>{uc=Ta.qHi()});U(yb,Sc,Hb)}return uc}$ce(yb){for(const Ta of yb)yb=Ta.Pi,this.$5b[yb]||(this.$5b[yb]=Ta.tKa())}PIg(yb){for(const Ta of yb){yb=Ta.Pi;const Hb=this.$5b[yb];if(Hb&&!Ta.Yje(Hb)){Ca.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${yb}`);this.eU();break}}}ofh(yb,Ta){for(const Hb of Ta)if(Ta=Hb.Pi,this.My[Ta]){if(!Hb.Yje(this.My[Ta]))return Ca.ULS.sendTraceTag(509657993,
0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${yb}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${Ta}, isRow=false`),!1;Hb.Q3a=!0}return!0}txk(yb,Ta,Hb,uc){window.setTimeout(()=>{this.ayg(yb,Ta,Hb,uc)},0)}sxk(yb,Ta,Hb,uc,Sc,bc){window.setTimeout(()=>{this.Mee(yb,Ta,Hb,uc,Sc,bc)},0)}Wsj(yb){for(const Ta of yb)if(Ta.Pj.Information.Revision>this.bNb)return!0;return!1}XFa(yb,Ta,Hb,uc){return this.Wsj(Ta)?(this.bNb=this.$.ea.Ek,this.eU(),
Ca.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${Hb}, parameter = ${yb}, value=true, reason = "Server response received before completing client side estimation", isRow=${uc}}`),!0):!1}eU(){this.My={};this.Oya=!1;this.$5b={};this.da.Hk.zza(!1);this.GLa&&(this.Tub=0,this.$la={})}tDc(yb,Ta,Hb){this.eU();Ca.ULS.sendTraceTag(509723721,0,10,`${yb} encountered exception ${Ta} for command=${Hb}`)}YVk(yb,Ta,Hb){yb&&(this.My[Hb.destination.Pi]=yb);Ta&&(this.My[Hb.source.Pi]=
Ta)}ZVk(yb,Ta){this.My[Ta]=yb}DKk(yb,Ta,Hb,uc,Sc){const bc=uc?yb.yj.top>Ta.bottom:yb.yj.left>Ta.right;Ta=this.My[yb.Pi];if(!Ta)return!1;if(yb=(uc?Hb.top>yb.yj.bottom:Hb.left>yb.yj.right)||bc){if(0<Ta.Cells.length)return!1;if(ka(Sc)?uc?28<Ta.RowNumbers.length:30<Ta.ColumnNumbers.length:uc?28>Ta.RowNumbers.length:30>Ta.ColumnNumbers.length)return!0}return yb}iAe(yb,Ta,Hb,uc,Sc,bc){if(!this.XFa("updateReferenceForBlocks",yb,Ta,Hb))if(yb.length-1===this.Tub)bc();else{for(var vc=za.HelperMethods.Kh();za.HelperMethods.Kh()-
vc<Va.EwaSettings.XMc()&&yb.length-1>=this.Tub;){var Xc=yb[this.Tub].Pi;this.Tub++;var ad=this.dSi(Xc);ad=gridRenderer.CanvasRendererGlobals.getChangedCells(ad,uc);for(const Id of ad)ad=oa.Range.vi(Id.rowNum,Id.colNum),ad=this.da.zh(ad),this.$la[Id.rowNum+"|"+Id.colNum]=Object.assign({},Id,{vVd:!0,o$j:ad});Xc=gridRenderer.CanvasRendererGlobals.updateReferenceUpdateForModel(this.My[Xc],this.n4b,uc,Sc);for(const Id of Xc)this.$la[Id.rowNum+"|"+Id.colNum]=Object.assign({},Id,{vVd:!1})}yb.length-1>this.Tub?
window.setTimeout(()=>{this.iAe(yb,Ta,Hb,uc,Sc,bc)},0):bc()}}dSi(yb){return this.za.Wn(yb).Pj.GridBlockModel}jTh(yb,Ta){if(674605324===Ta||-706918724===Ta)return!0;yb=Object(Ja.a)(this.da.$,yb);if(!yb)return!0;yb=yb.usedRange;if(Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8616266_RowColCSETableCheckBugFix")){if((Ta=this.da.fh.Fy?this.da.pRb():this.da.KR())&&Ta.Xi(yb))return!1}else if(this.da.KR().contains(yb))return!1;return!0}Hlj(yb){return-73576432===yb||-806625837===yb||-1564089444===yb||340334732===
yb||1844679312===yb||83934709===yb?!0:!1}Flj(yb){switch(yb){case -806625837:case 340334732:case 1844679312:case -1564089444:case -73576432:return this.T1a;case 83934709:return!1;default:return!1}}vXf(yb){return-1113896058===yb||1415868706===yb||1554436520===yb||674605324===yb||1051390410===yb?Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8551204_globalStyle")?this.roa&&gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled():
gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled():-706918724===yb}MBg(){this.N8f()}N8f(){const yb=performance.now()-this.Tsg;this.da.Hk&&this.$.ea&&this.da.Hk.xEj(yb)}DEg(yb,Ta){if(yb.AdjacentBlocksHiddensInfo){var Hb={},uc=Ta?yb.RowNumbers[0]:yb.ColumnNumbers[0],Sc=Ta?yb.RowNumbers[yb.RowNumbers.length-1]:yb.ColumnNumbers[yb.ColumnNumbers.length-1],bc=Ta?this.LF[0].top:this.LF[0].left,vc=Ta?this.LF[0].bottom:
this.LF[0].right,Xc=!1;Ta?(yb.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden&&(Xc=Hb.IsFirstColOfNextBlockHidden=!0),yb.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden&&(Xc=Hb.IsLastColOfPrevBlockHidden=!0),yb.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden&&Sc<vc&&(Xc=Hb.IsFirstRowOfNextBlockHidden=!0),yb.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden&&uc<bc&&(Xc=Hb.IsLastRowOfPrevBlockHidden=!0)):(yb.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden&&(Xc=Hb.IsFirstRowOfNextBlockHidden=
!0),yb.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden&&(Xc=Hb.IsLastRowOfPrevBlockHidden=!0),yb.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden&&Sc<vc&&(Xc=Hb.IsFirstColOfNextBlockHidden=!0),yb.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden&&uc<bc&&(Xc=Hb.IsLastColOfPrevBlockHidden=!0));yb.AdjacentBlocksHiddensInfo=Xc?Hb:void 0}}A6k(yb,Ta,Hb,uc){const Sc=this.Hgj(uc?yb.RowNumbers:yb.ColumnNumbers,uc?Ta.RowNumbers:Ta.ColumnNumbers,Hb);if(Sc)switch(Hb){case hb.Hide:case hb.Delete:Sc&&
(uc?(this.fGa(yb,{IsLastRowOfPrevBlockHidden:!0}),this.fGa(Ta,{IsFirstRowOfNextBlockHidden:!0})):(this.fGa(yb,{IsLastColOfPrevBlockHidden:!0}),this.fGa(Ta,{IsFirstColOfNextBlockHidden:!0})));break;case hb.Insert:case hb.Unhide:Sc&&(uc?(this.fGa(yb,{IsFirstRowOfNextBlockHidden:!0}),this.fGa(Ta,{IsLastRowOfPrevBlockHidden:!0})):(this.fGa(yb,{IsFirstColOfNextBlockHidden:!0}),this.fGa(Ta,{IsLastColOfPrevBlockHidden:!0})))}}Hgj(yb,Ta,Hb){const uc=yb.length,Sc=Ta.length;switch(Hb){case hb.Hide:case hb.Delete:return yb[0]-
1!==Ta[Sc-1];case hb.Insert:case hb.Unhide:return yb[uc-1]+1!==Ta[0]}return!1}fGa(yb,Ta){yb.AdjacentBlocksHiddensInfo?(Ta.IsFirstRowOfNextBlockHidden&&(yb.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden=!0),Ta.IsLastRowOfPrevBlockHidden&&(yb.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden=!0),Ta.IsFirstColOfNextBlockHidden&&(yb.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden=!0),Ta.IsLastColOfPrevBlockHidden&&(yb.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden=!0)):yb.AdjacentBlocksHiddensInfo=
Ta}hRi(yb,Ta){if(!this.OHc||this.Ycf(this.LF[0],Ta)||-1113896058===yb||1415868706===yb)return Ta?this.LF[0].bottom-this.LF[0].top+1:this.LF[0].right-this.LF[0].left+1;yb=this.da.kj.mBc([this.LF[0]]).filter(uc=>Ta?uc.isRow:uc.lk);let Hb=0;for(const uc of yb)Hb+=Ta?uc.bottom-uc.top+1:uc.right-uc.left+1;return(Ta?this.LF[0].bottom-this.LF[0].top+1:this.LF[0].right-this.LF[0].left+1)-Hb}xVi(yb,Ta){return this.OHc?this.w7d:Ta?yb.bottom-yb.top+1:yb.right-yb.left+1}};Aa=Object(Ya.__decorate)([Object(Ka.d)($a.gd),
Object(Ya.__param)(0,Object($a.Nb)()),Object(Ya.__param)(1,Object($a.E)()),Object(Ya.__param)(2,Object($a.xc)())],Aa);Object(da.a)(Aa,"GridInstantaneousAction",null,[235]);var Ub=a(485),Db=a(46),Ib=a(427),yc=a(216),xc=a(139),zb=a(39),vb=a(254),bb=a(264),La=a(66);class pb{constructor(yb,Ta){this.isRow=!1;this.autoFitRange=null;this.isRow=yb;this.autoFitRange=Ta}}Object(da.a)(pb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[60]);class fa{constructor(yb){this.resizeParameters=null;this.resizeParameters=
yb}}Object(da.a)(fa,"MacroRecorderSheetRowsColumnsResizedPayload",null,[60]);var kb=a(153),db=a(429),gb=a(65),Kb=a(28);class ub{constructor(yb){this.lDd=yb}pjf(yb){yb=za.HelperMethods.dSc(yb);return Math.max(0,Math.min(ub.lcg,yb))}bjf(yb){return this.K6j(yb)}oZh(yb){return Math.round(this.lDd*yb+2*this.mGf()+1)}K6j(yb){return Math.max(0,Math.min(ub.Pbg,(Math.max(0,Math.min(nb.a.ZMc,yb))-2*this.mGf()-1)/this.lDd))}mGf(){return Math.floor(Math.max((this.lDd+3)/4,2))}DBc(yb,Ta){return Ta?yb?ub.lcg:nb.a.p5d:
yb?ub.Pbg:nb.a.ZMc}}ub.lcg=409;ub.Pbg=255;Object(da.a)(ub,"ResizeHeadersConverter",null,[]);class lb extends db.a{constructor(yb,Ta){super(yb);this.vna=(Hb,uc)=>{Hb=this.CMd(Hb,uc);return this.xJd(Hb)};this.Rsk=(Hb,uc)=>{var Sc=this.QXb=uc[lb.Cjj];1===Hb?(Hb=uc[lb.aSk],Sc=this.pNf(Hb,Sc),Ca.ULS.shipAssertTag(537153996,0,Sc!==lb.doa,`ResizeHeadersDialogHandler - invalid size input, size = ${Hb}`),Hb=Sc!==this.ATd,Ca.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",
this.isRow,this.QXb,Sc,Hb),Hb&&this.i4h(Sc)):Ca.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===Ta.command;this.da=Ea.f(this.$);this.hWc=new ub(this.$.workbookContext.DxDigitNormal);this.ATd=this.vSh();yb=this.M2h(this.ATd);Ta=this.O2h(this.ATd);this.dialogTitle=wa.a.instance.ia(this.isRow?478:479);yb=this.PR(yb,Ta);this.initializeAndShow(this.dialogTitle,this.Rsk,yb);Ca.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get Di(){return"ResizeHeadersDialog"}get QXb(){return lb.QPe}set QXb(yb){lb.QPe=
yb}PR(yb,Ta){return{[lb.aS]:this.Di,[lb.zqj]:this.isRow,[lb.ubj]:yb,[lb.tbj]:Ta,[lb.Lmj]:this.QXb,[lb.BMd]:this.vna}}vSh(){const yb=this.QDi();try{return this.TIi(yb)}finally{yb&&yb.dispose()}}i4h(yb){const Ta={};Ta.SheetMultiRange=Db.t(this.da.ha.qa.selectedRanges,this.$);lb.Ope(Ta,this.isRow,yb);this.$.si(this.isRow?745189930:-445963340,gb.a.rh,8,{["resizeRowColumnParameters"]:Ta})}pNf(yb,Ta){return Kb.a.tha(yb)?Ta?this.L2h(yb):this.N2h(yb):lb.doa}N2h(yb){return Math.floor(parseFloat(yb))}L2h(yb){yb=
parseFloat(yb);return 0>yb?lb.doa:yb?this.isRow?za.HelperMethods.V6j(yb):this.hWc.oZh(yb):0}O2h(yb){return yb===lb.doa?"":this.isRow?this.hWc.pjf(yb).toString():this.hWc.bjf(yb).toFixed(2)}M2h(yb){return yb===lb.doa?"":yb.toString()}TIi(yb){if(!yb||!yb.$$mn()||!yb.Iu)return lb.doa;var Ta=Object(kb.a)(191,yb.Iu);if(!Ta)return lb.doa;for(Ta=this.isRow?Ta.M0a:Ta.yTd;yb.$$mn();){const Hb=Object(kb.a)(191,yb.Iu);if(Hb&&(this.isRow?Hb.M0a:Hb.yTd)!==Ta)return lb.doa}return Ta}QDi(){const yb=[];for(const Hb of this.da.ha.qa.selectedRanges){const uc=
Hb.clone();var Ta=this.da.sl(this.da.fh.Lo(uc));Ta=uc.Ik(Ta.Dp);if(!Ta)return null;this.isRow?uc.right=uc.left=Ta.left:uc.top=uc.bottom=Ta.top;yb.push(uc)}return yb.length?this.da.vfa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",yb):null}CMd(yb,Ta){if(!Kb.a.tha(yb))return 1;yb=this.pNf(yb,Ta);return 0!==yb||this.da.kj.Jcf(this.da.ha.qa.selectedRanges,this.isRow)?this.utj(yb)?0:2:3}xJd(yb){let Ta="";switch(yb){case 0:Ta="";break;case 1:Ta=wa.a.instance.ia(767);break;case 2:Ta=String.format(wa.a.instance.sh(99),
0,this.DBc(this.QXb));break;case 3:Ta=wa.a.instance.ia(768)}return Ta}utj(yb){return 0<=yb&&yb<=this.DBc(!1)}DBc(yb){return this.hWc.DBc(yb,this.isRow)}static Ope(yb,Ta,Hb){if(Ta){yb.ColumnWidth=lb.doa;yb.RowHeight=Hb;for(const uc of yb.SheetMultiRange.Ranges)uc.FirstColumn=0,uc.LastColumn=0}else{yb.RowHeight=lb.doa;yb.ColumnWidth=Hb;for(const uc of yb.SheetMultiRange.Ranges)uc.FirstRow=0,uc.LastRow=0}}}lb.aS="id";lb.zqj="isRow";lb.ubj="initialSizeInPx";lb.tbj="initialSizeInDefaultUnits";lb.Lmj="isInitialUnitsDefaultUnits";
lb.BMd="getInputErrorIfInvalid";lb.aSk="size";lb.Cjj="isDefaultUnits";lb.doa=-1;lb.QPe=!0;Object(da.a)(lb,"ResizeHeadersDialog",db.a,[]);var Ba=a(64);const ra=(yb,Ta,Hb,uc,Sc,bc,vc)=>{vc=yb.$a(41,void 0===vc?null:vc);vc.resizeRowColumnParameters=Ta;return Ba.h(yb,"ResizeRowsColumns",vc,Hb,uc,Sc,bc,0)};var wb=a(77),mc=a(324),xb=a(156),Ec=a(36),ed=a(359),jd=a(101);let Xd=class{constructor(yb,Ta,Hb,uc){this.UYj=(Sc,bc)=>{if(!vb.a(Sc)&&bc){const vc=!!Sc&&!!Sc.RequestTelemetryData;Ea.f(this.$).Hk.D1(bc,
Sc.StateId,vc?Sc.RequestTelemetryData.EcsOperationDuration:0,vc?Sc.RequestTelemetryData.EcsRequestDuration:0,vc?Sc.RequestTelemetryData.WfeRequestDuration:0)}};this.wPj=(Sc,bc)=>{$a.xg.Aa()?void Ka.a.resolve($a.xg,{va:1}).then(vc=>{vc.o2g(bc)}):zb.TaskExtensions.Xa(wb.GetServiceTaskFactory.Tj(this.$.la,534,535,1),vc=>{vc.result.o2g(bc)},this.$.ya,3)};this.$=yb;this.yk=Ta;this.gridInstantaneousAction=Hb;this.grid=Ea.f(this.$);this.YSb=uc}Ri(yb,Ta){yb=!0;switch(Ta){case -445963340:case 1391094586:yb=
this.Wj(8);break;case 745189930:case 146338636:yb=this.Wj(16)}return!yb}executeCommand(yb,Ta,Hb){var uc=Ea.f(this.$),Sc=Ta.command;yb=la.a.create().toString();var bc=zb.TaskExtensions.Gq();switch(Sc){case 1391094586:case 146338636:bc=1391094586===Sc;(yb=Hb.autoFitRanges)&&yb.Ranges&&yb.Ranges.length||(yb=Db.t(uc.ha.qa.selectedRanges,this.$));bc=this.Zgi(bc?1:0,yb,Ta);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:bc=-445963340===Sc||-706918724===
Sc||369708605===Sc;var vc=Va.EwaSettings.uob()||Va.EwaSettings.X1a(),Xc=Va.EwaSettings.QHc();(vc&&-706918724===Sc||Xc&&1051390410===Sc)&&uc.Hk.lQ(18,yb,Ub.a(Sc));if(-445963340===Sc||745189930===Sc){var ad=Ub.a(Ta.command);uc.Hk.lQ(16,yb,ad);var Id=Hb.resizeRowColumnParameters}else{Hb=Va.EwaSettings.z_d()&&(369708605===Sc||1542466017===Sc)&&Hb.rangeToUnhide?[Hb.rangeToUnhide]:uc.ha.qa.selectedRanges;uc=0;vc=!1;Xc="";let Kd=!1;const Yd=Va.EwaSettings.yWb();Yd&&(Xc=Ub.a(Ta.command),vc=1<Hb.length?!0:
!1);for(var ue of Hb){if(Yd&&this.YSb){var Vd=this.grid.za.iY(ue);this.YSb.god(Vd,Xc)}if(-706918724===Sc||369708605===Sc)Vd=ue.right-ue.left+1,uc+=0<Vd?Vd:-1*Vd;else if(1542466017===Sc||1051390410===Sc)Kd=!0,uc+=ue.bottom-ue.top+1}Yd&&this.YSb&&(this.YSb.c3e(uc,Xc),this.YSb.b2e(Xc,Kd,uc,Hb[0],Ta.command));if(369708605===Sc||1542466017===Sc){if(Ca.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${uc}, isDiscontinuous=${vc}`),Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8373854_LogUnhideButtonClickOnNoHiddenRangePresent")){uc=
ue=!1;vc=this.grid.kj;for(Id of Hb)if(ue=Id.isRow&&vc.cpb(Id),uc=Id.lk&&vc.Tnb(Id),ue||uc)break;ue||uc||Ca.ULS.sendTraceTag(508061769,0,50,"ResizeCommandHandler.doResize: unhide Rows/Columns clicked when no hidden range in selected range")}}else-706918724!==Sc&&1051390410!==Sc||Ca.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${uc}, isDiscontinuous=${vc}`);Sc=369708605===Sc||1542466017===Sc?-2:0;Id={};Id.SheetMultiRange=Db.t(Hb,this.$);if(bc)for(ad of Id.SheetMultiRange.Ranges)ad.FirstRow=
0,ad.LastRow=0;else for(const Bc of Id.SheetMultiRange.Ranges)Bc.FirstColumn=0,Bc.LastColumn=0;Id.RowHeight=bc?-1:Sc;Id.ColumnWidth=bc?Sc:-1}bc=this.rhi(Id,Ta,yb,bc);break;case 957527587:case 2040891415:Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===Ta.tabName&&jd.b("HomeTabFormat"),new lb(this.$,Ta)}return bc}Gi(yb,Ta,Hb,uc){if(yb=!!Hb&&!!uc&&1===uc.AO)switch(Ta.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:yb=!1}return yb}dj(){return!1}tAj(yb){Ca.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(mc.c)(yb)}. Reason: ${Object(mc.c)(yb)?void 0:yb.reason}.`)}Wj(yb){return(new xc.a(this.$.sa)).Wj(yb)}Zgi(yb,Ta,Hb){const uc=this.$.pa.ta.Vh(),Sc=0===yb,bc=()=>new pb(Sc,Ta);return Ib.a(this.$.userOperationManager,(vc,Xc,ad)=>{var Id=this.$.pa.ta;vc=bb.c(vc,this.wPj);var ue={yij:!Sc,Dsd:Ta};const Vd=Id.$a(41,uc);Vd.isRow=Sc;Vd.autoFitRanges=
Ta;return Ba.h(Id,"AutoFit",Vd,vc,Xc,ad,ue,0)},vc=>new yc.a(135,0,vc,void 0,bc),Hb)}rhi(yb,Ta,Hb,uc){const Sc=Ta.command,bc=Ea.f(this.$),vc=Db.h(yb.SheetMultiRange.Ranges);if(Va.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var Xc=-706918724===Sc||-445963340===Sc&&0===yb.ColumnWidth,ad=bc.kj;if((1051390410===Sc||745189930===Sc&&0===yb.RowHeight||Xc)&&!ad.Jcf(vc,!uc))return this.cgi(uc),zb.TaskExtensions.Gq()}let Id;Xc=(Va.EwaSettings.uob()||Va.EwaSettings.X1a())&&-706918724===
Sc;ad=Va.EwaSettings.QHc()&&1051390410===Sc;let ue=void 0;if(745189930===Sc||-445963340===Sc||Xc||ad)Ca.ULS.shipAssertTag(537154002,0,this.$.activeItemName===yb.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),Xc||ad?(this.gridInstantaneousAction.Oge(),ue=()=>{bc.Hk.zza();this.gridInstantaneousAction.msd(Sc,!uc)},Va.EwaSettings.xIc()||Object(xb.e)(()=>{ue()},this.$.ya,0)):(Id=this.yk.ite(bc,vc,uc?yb.ColumnWidth:yb.RowHeight,!uc),this.tAj(Id),Object(mc.c)(Id)&&
bc.Hk.rT(Hb,La.BasicTelemetryCalculator.bS));const Vd=this.$.pa.ta.Vh({yza:!0,gya:3});Xc=(Yd,Bc,Mc)=>{this.$.ZC();Db.j(vc,",",this.$,!1);return ra(this.$.pa.ta,yb,bb.c(Yd,this.UYj),Bc,Va.EwaSettings.xIc()?bb.a(Mc,()=>{window.setTimeout(()=>{ue&&ue()},0)}):Mc,Hb,Vd)};const Kd=()=>new fa(yb);return Id&&Object(mc.c)(Id)?Ib.a(this.$.userOperationManager,Xc,Yd=>new yc.a(136,0,Yd,64,Kd),Ta):Ib.a(this.$.userOperationManager,Xc,Yd=>new yc.a(136,0,Yd,void 0,Kd),Ta)}cgi(yb){yb=Ec.a.nj(1,0,yb?769:771,yb?770:
772,0,yb?-2037763134:503471870,yb?"HideAllColumnsError":"HideAllRowsError");new ed.a(this.$,yb)}};Xd=Object(Ya.__decorate)([Object(Ka.d)($a.tf),Object(Ya.__param)(0,Object($a.Nb)()),Object(Ya.__param)(1,Object($a.xc)()),Object(Ya.__param)(2,Object($a.gd)()),Object(Ya.__param)(3,Object($a.Zc)())],Xd);Object(da.a)(Xd,"ResizeCommandHandler",null,[34]);var Td=a(592),gc=a(9),nc=a(428),dc=a(19),Gc=a(75),vd=a(71),zd=a(7),Yb=a(29);class Pb{}Pb.upi="ewa-resizehdr-row-hidden";Pb.tpi="ewa-resizehdr-col-hidden";
Object(da.a)(Pb,"CssClassNames",null,[]);var $c=a(306),wd=a(17),Bd=a(193),tc=a(764),Zc=a(35),Ab=a(290),rb=a(6),Fb=a(245),jc=a(154),Oc=a(60),cd=a(16),Ed=a(69),Sd=a(105),$d=a(325),be=a(155),Fe=a(431),Pe=a(114);class hc{constructor(yb,Ta,Hb,uc,Sc,bc,vc){this.RKa=yb;this.J_b=Ta;this.rNa=Hb;this.BRd=uc;this.Ovb=Sc;this.N3f=bc;this.e6i=vc}}Object(da.a)(hc,"HeaderEventCachedInfo",null,[]);var Lb=a(176);class kc extends Sd.a{constructor(yb,Ta){super(Ta.domElement);this.C9=this.DIg=!1;this.Zn=this.dqb=this.vQa=
null;this.ale=!0;this.qJc=!1;this.F6b=this.Js=this.offset=0;this.pY=this.l2=this.Yca=null;this.p7i="headerResizeTooltip";this.AW=this.q3d=null;this.Gsd=this.Sda=this.gPa=!1;this.otg=this.ctb=nb.a.nLa;this.Rbc=!1;this.xXb=Va.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ResizeHeaderUXModernization",!1);this.d2f=Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8511759_RemoveResizeTooltip");this.c1a=Va.EwaSettings.c1a();this.TLa=Va.EwaSettings.TLa();this.Z5=Va.EwaSettings.t6()&&Va.EwaSettings.eXd();
this.hZd=!1;this.zre=!0;this.mJ=Hb=>{if(this.grid.fp)return!1;Hb=Pe.a().il(Hb);if(3===Hb.Dh&&!this.O3f(Hb.La)||!this.Awg(Hb,!1))return!1;Ca.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const uc=this.r_c();this.GJd(Hb.clientPoint,uc,!0);this.gPa||($c.a.instance.xa(wd.a.zv,this.domElement.ownerDocument.body,this.msb),Bd.a.instance.xa(wd.a.Jn,this.domElement.ownerDocument.body,this.msb),this.gPa=!0);this.C9&&this.RTf(Hb);return!1};this.Z0b=Hb=>{Hb=Pe.a().il(Hb);
this.Gsd&&this.RTf(Hb);if(!Hb.La.type.includes("touch")&&Hb.La.button!==Sys.UI.MouseButton.leftButton||!this.u2a)return!1;Ed.g(Hb.La);this.Dtf();Hb=this.grid.fp?this.ctb:nb.a.nLa;if(this.grid.fp&&this.Zn){var uc=Hb!==this.Js;!uc&&this.Rbc&&(this.fk.removeRowColFromModel(this.Zn.YGb,this.Zn.E6a),this.fk.Kja(this.grid.ha.qa.selectedRanges),this.fk.zr("HeaderResizeBehavior::onDocumentMouseUp"))}else this.Zn&&(Hb=this.Sda?this.qLd():this.Zn.zga()),uc=Hb!==this.Js;if(this.vQa&&uc&&Hb!==nb.a.nLa){Hb=this.grid;
var Sc=this.hOd(Hb);uc={};uc.SheetMultiRange=Db.t(Sc,Hb.$);kc.Ope(uc,this.isRow,this.Js);if(this.grid.fp){Sc=this.Zn?this.Zn.YGb:-1;const bc=uc.SheetMultiRange.Ranges[0],vc=kc.xoa()&&0===this.Js?20:50;Ca.ULS.sendTraceTag(509694147,2,vc,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${Sc}, isResizingHiddenHeader=${this.Sda}, headerViewBlockHashCode=${this.fk.hashCode},
          rangeFirstRow=${bc.FirstRow}, rangeFirstColumn=${bc.FirstColumn}, rangeLastRow=${bc.LastRow}, rangeLastColumn=${bc.LastColumn},`)}this.tli(uc);Hb.HXk=!0}else this.tm(null,null),this.R4b();this.Rbc=this.Sda=!1;this.c1a&&this.grc("onDocumentMouseUp");return!1};this.c7=Hb=>{if(this.grid.fp)return!1;Hb=tc.a.create(Hb.eventName,Hb.li,Hb.La,Hb.Dh);Hb=Pe.a().il(Hb);if(!this.Awg(Hb,!0))return!1;Hb=this.grid;var uc=this.hOd(Hb);uc=Db.t(uc,Hb.$);this.xXb?Hb.Gh.Mq([this.isRow?51:52]):Hb.Gh.Mq([this.isRow?
13:14]);Hb.Gh.Oca();this.R4b();Hb.$.si(this.isRow?146338636:1391094586,gb.a.rh,30,{["autoFitRanges"]:uc});return!1};this.Flg=Hb=>{this.C9?(this.Sda&&!this.Rbc&&(this.tyh(),this.fk.zr("HeaderResizeBehavior::onHeaderResizeChanged")),this.qJc||this.mVf(),Hb=new Sys.UI.DomEvent(Hb),Hb=tc.a.create(wd.a.wWa,this.domElement,Hb,2),Hb=Pe.a().il(Hb),this.e$d(Hb.clientPoint),this.zre&&(this.zre=!1,this.fk.DSg()&&(this.fk.HIh(),this.y_f=!0))):Ca.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.Zn?
this.Zn.YGb:-1}, isRow = ${this.isRow}`)};this.Glg=Hb=>{Hb=new Sys.UI.DomEvent(Hb);Hb=tc.a.create(wd.a.wWa,this.domElement,Hb,2);this.Z0b(Hb)};this.YUj=Hb=>{var uc;if(kc.xoa()&&!this.Zn){Hb=!!this.fk;const Sc=null===(uc=this.fk)||void 0===uc?void 0:uc.hashCode;Ca.ULS.sendTraceTag(508368662,2,15,`HeaderResizeBehavior.onHeaderResizeTouchStart: cellBeingResized is not set and we don't know which cell needs to be resized. this.isRow=${this.isRow}, isViewBlockSet=${Hb}, this.viewBlock.hashCode=${Sc}`)}else this.bia(Hb,
this.Zn,!1)};this.msb=Hb=>{Hb=Pe.a().il(Hb);Ed.g(Hb.La);return this.e$d(Hb.clientPoint)};this.KS=Hb=>{if(this.grid.fp)return!1;Hb=Pe.a().il(Hb);let uc;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ha.selectionType)return ia.a(this.grid.$).wv()&&(uc=this.pMd(Hb))&&(uc.RKa.style.cursor=""),!1;if(this.C9)return this.mVf(),!1;uc=this.pMd(Hb);if(!uc)return!1;uc.RKa.style.cursor=!this.grid.isEditing&&this.c0d(uc)?this.isRow?"row-resize":"col-resize":"";Ed.g(Hb.La);return!0};this.Vy=()=>{this.R4b()};
this.tm=()=>{if((3===gb.a.rh||Zc.a.Zx)&&this.grid.ha.qa.Bn){var Hb=this.grid.ha.qa.jj;if(!(!Hb.isRow&&!Hb.lk||!this.domElement||Hb.isRow&&this.isRow&&!this.fk.KD.includes(Hb.top)||Hb.lk&&!this.isRow&&!this.fk.KD.includes(Hb.left))){var uc=this.grid.yl(Hb,this.fk.Iq.paneType);if(uc){if(this.grid.fp){const Sc=this.isRow?Hb.bottom:Hb.right;this.Zn=this.fk.tB(oa.Range.vi(Hb.bottom,Hb.right));if(!this.Zn){Ca.ULS.sendTraceTag(522826880,2,kc.xoa?15:50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Sc}, is row ${this.isRow}`);
return}}this.AW||this.K$h();Hb.isRow&&this.isRow?(this.aZc(!0,"onSelectionEnded"),this.AW.style.top=uc.bottomRight.y-this.AW.offsetHeight/2+"px"):Hb.isRow||this.isRow||(this.aZc(!0,"onSelectionEnded"),$d.c(this.AW.style,this.grid.rtl,uc.bottomRight.x-this.AW.offsetWidth/2+"px"))}}}};this.hZ=(Hb,uc)=>{Va.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&Ca.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${uc.iU}`);
uc.iU&&this.CKb()};this.fk=Ta;this.isRow=Ta.isRow;this.rtl=Ta.Iq.rtl;this.grid=yb;this.Rbg=this.isRow?nb.a.p5d:nb.a.ZMc;this.k7i=wa.a.instance.ia(436);this.t7i=wa.a.instance.ia(435);this.n7i=wa.a.instance.ia(437);be.a(this.grid.$,Hb=>{this.q3d=Hb.i0(jc.a.Zsk,!1)});this.Ghk();this.grid.ha.wX(this.tm);this.grid.ha.wla(this.Vy);this.grid.dA(this.tm);ia.a(this.grid.$).Tm.iua(this.hZ)}get u2a(){return this.C9}get d7a(){var yb,Ta;return null!==(Ta=null===(yb=this.Zn)||void 0===yb?void 0:yb.E6a)&&void 0!==
Ta?Ta:-1}get atk(){this.mmi();return kc.Pvb}WUj(yb){Va.EwaSettings.vXb()&&!this.u2a&&this.rtj(yb.E6a)&&this.fk.bZc(yb.E6a,!1)}ZUj(yb,Ta){Va.EwaSettings.vXb()&&!this.u2a&&this.fk.bZc(yb.E6a,Ta)}bia(yb,Ta,Hb){var uc,Sc=new Sys.UI.DomEvent(yb);Sc=tc.a.create(wd.a.wWa,this.domElement,Sc,2);Sc=Pe.a().il(Sc);this.zwg(Ta,Sc.clientPoint.x,Sc.clientPoint.y,!1,Hb,yb);this.Z5&&(null===(uc=Ka.a.nh($a.jd))||void 0===uc?void 0:uc.CPf(!0));yb=this.r_c();this.GJd(this.vQa,yb,!0);this.gPa||(yb=this.domElement.ownerDocument.body,
yb.addEventListener("pointermove",this.Flg),yb.addEventListener("pointerup",this.Glg),this.gPa=!0)}VUj(yb,Ta,Hb){this.zwg(Ta,yb.clientX,yb.clientY,!0,Hb,yb);yb=this.grid;Ta=this.hOd(yb);Ta=Db.t(Ta,yb.$);this.xXb?yb.Gh.Mq([this.isRow?51:52]):yb.Gh.Mq([this.isRow?13:14]);yb.Gh.Oca();this.R4b();yb.$.si(this.isRow?146338636:1391094586,gb.a.rh,30,{["autoFitRanges"]:Ta})}dispose(){this.grc("dispose");this.grid.ha&&(this.grid.ha.vZ(this.tm),this.grid.ha.Jia(this.Vy));this.grid.$E(this.tm);ia.a(this.grid.$)&&
ia.a(this.grid.$).Tm.WAa(this.hZ);Ab.a.instance.Qa(wd.a.Nr,this.domElement,this.c7);$c.a.instance.Qa(wd.a.Co,this.domElement.ownerDocument.body,this.Z0b);Bd.a.instance.Qa(wd.a.ml,this.domElement.ownerDocument.body,this.Z0b);Zc.a.Zx||($c.a.instance.Qa(wd.a.qj,this.domElement,this.mJ),$c.a.instance.Qa(wd.a.zv,this.domElement,this.KS));this.gPa&&($c.a.instance.Qa(wd.a.zv,this.domElement.ownerDocument.body,this.msb),Bd.a.instance.Qa(wd.a.Jn,this.domElement.ownerDocument.body,this.msb),this.gPa=!1);this.AW&&
($c.a.instance.Qa(wd.a.qj,this.AW,this.mJ),Ab.a.instance.Qa(wd.a.Nr,this.AW,this.c7),kc.xoa()?this.CEg("dispose"):(this.grc(""),this.AW=null));this.DIg&&(cd.DOMElementExtensions.an(kc.Pvb),kc.Pvb=null);this.fk=null;super.dispose()}Ghk(){Ab.a.instance.xa(wd.a.Nr,this.domElement,this.c7);$c.a.instance.xa(wd.a.Co,this.domElement.ownerDocument.body,this.Z0b);Bd.a.instance.xa(wd.a.ml,this.domElement.ownerDocument.body,this.Z0b);Zc.a.Zx||($c.a.instance.xa(wd.a.qj,this.domElement,this.mJ),$c.a.instance.xa(wd.a.zv,
this.domElement,this.KS))}mmi(){if(!kc.Pvb){document.getElementById(kc.CIg);this.DIg=!0;var yb=kc.Pvb=document.createElement("div");this.grid.$.frame.qna().appendChild(yb);yb.id=kc.CIg;yb.className=Yb.jb;cd.DOMElementExtensions.setVisible(yb,!1)}}rtj(yb){return-1<=yb?!0:!1}Dtf(){var yb;if(this.gPa){const Ta=this.domElement.ownerDocument.body;this.grid.fp?(Ta.removeEventListener("pointermove",this.Flg),Ta.removeEventListener("pointerup",this.Glg)):($c.a.instance.Qa(wd.a.zv,Ta,this.msb),Bd.a.instance.Qa(wd.a.Jn,
Ta,this.msb));this.gPa=!1}this.C9=!1;Va.EwaSettings.vXb()&&this.fk.bZc(this.Zn.E6a,!1);this.elk();Fe.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation");this.Z5&&(null===(yb=Ka.a.nh($a.jd))||void 0===yb?void 0:yb.CPf(!1))}kuk(){this.xXb?this.hZd?(this.hZd=!1,this.grid.Gh.Mq(this.isRow?[49,51]:[50,52])):this.grid.Gh.Mq(this.isRow?[51]:[52]):this.grid.Gh.Mq([this.isRow?13:14]);this.grid.Gh.Oca()}tyh(){this.fk.addRowColToModel(this.Zn.YGb-1,this.Zn.E6a);this.Rbc=!0}e$d(yb){if(!this.C9)return!1;
const Ta=this.isRow;if(!this.grid.fp&&!this.Yca){this.Yca=document.createElement("div");this.Yca.style.cssText="position: relative; width: inherit; height: inherit;"+(Ta?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Hb=this.Zn.jP();Hb.nextSibling;)this.Yca.appendChild(Hb.nextSibling);Hb.parentNode.appendChild(this.Yca)}Hb=Ta?yb.y-this.dqb.y:(this.rtl?-1:1)*(yb.x-this.dqb.x);const uc=Ta?yb.y-this.vQa.y:(this.rtl?-1:1)*(yb.x-this.vQa.x),Sc=this.grid.fp?this.ctb:this.Zn.zga();if(Sc===nb.a.nLa)return!1;
Hb&&(0<this.Js||0<Sc+uc)&&Sc+uc<=this.Rbg&&(this.Js=this.r_c(uc),this.GJd(yb,this.Js,!1),this.grid.fp?this.Js>=kc.KRf?(this.ale=!0,this.Zn.setCellExtent(this.Js)):this.ale&&(this.ale=!1,this.Zn.setCellExtent(kc.KRf)):(cd.DOMElementExtensions.VCa(this.Zn.jP(),!Ta,Math.max(this.F6b+uc,0)),this.Yca.style[Ta?"top":this.rtl?"right":"left"]=Math.max(uc,-this.F6b)+"px"),Hb=(this.grid.fp?this.otg:Ta?this.Zn.fk.cM:this.Zn.fk.dM)+Math.max(uc,this.grid.fp?-this.ctb+kc.fDc:-this.F6b),cd.DOMElementExtensions.VCa(this.Zn.fk.domElement,
!Ta,Hb),this.grid.fp&&this.Zn.fk.gCk(Hb),this.dqb=new Sys.UI.Point(yb.x,yb.y),this.aZc(!1,"onHeaderResizeChangedInternal"));return!0}aZc(yb,Ta){var Hb;cd.DOMElementExtensions.setVisible(this.AW,yb);kc.xoa()&&Ca.ULS.sendTraceTag(508150752,2,50,`HeaderResizeBehavior.setTouchResizerVisible: called with visible: ${yb}. caller:${Ta} isRow: ${this.isRow}, blockHash: ${null===(Hb=this.fk)||void 0===Hb?void 0:Hb.hashCode}`)}zga(){return this.Zn?this.Sda?kc.C7i:this.Zn.zga():nb.a.nLa}GJd(yb,Ta,Hb){this.d2f||
(this.pY&&Hb&&(Ca.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.uEg()),this.pY||Hb||Ca.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead"),this.q3d&&this.q3d(()=>({["Location"]:"canvas"})),this.pY?this.rDf(Ta):(this.pY=document.createElement("div"),this.pY.id=this.p7i,this.rDf(Ta),this.pY.className=
Yb.K,Ta=document.getElementById(this.grid.$.xi+zd.a.Ndg),Ta.insertBefore(this.pY,Ta.firstChild),yb=Pe.a().Dga(yb),this.pY.style.left=(this.rtl?Math.max(yb.x-this.pY.offsetWidth,0):yb.x-Math.max(yb.x+this.pY.offsetWidth-Ta.offsetWidth,0)).toString()+"px",Ta=document.getElementById(zd.a.EGa),this.pY.style.top=(yb.y-(rb.AFrameworkApplication.ra&&rb.AFrameworkApplication.ra.$g.fl?0:Ta.offsetHeight)-this.pY.offsetHeight).toString()+"px"))}uEg(){this.d2f||(cd.DOMElementExtensions.an(this.pY),this.pY=null)}rDf(yb){var Ta=
new ub(this.grid.$.workbookContext.DxDigitNormal);Ta=this.isRow?Ta.pjf(yb).toFixed(2):Ta.bjf(yb).toFixed(2);this.pY.innerText=`${this.isRow?this.k7i:this.t7i} ${Ta} (${yb.toString()} ${this.n7i})`}Awg(yb,Ta){let Hb;const uc=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ha.selectionType||2===yb.Dh&&yb.La.button!==Sys.UI.MouseButton.leftButton||!this.c0d(Hb=this.pMd(yb))||!uc)return!1;Ed.g(yb.La);this.vQa=this.dqb=new Sys.UI.Point(yb.clientPoint.x,yb.clientPoint.y);this.DRh(Hb,Ta);if(!this.Zn)return!1;
this.C9=!0;this.jqj(this.Zn,Hb)&&this.Taj();this.F6b=this.qLd();return this.Bwg(yb.La.rawEvent,Ta)}zwg(yb,Ta,Hb,uc,Sc,bc){this.C9=!0;this.Sda=Sc;this.Zn=yb;this.Z9f("prepareResizeOperation");this.qJc=!1;this.vQa=this.dqb=new Sys.UI.Point(Ta,Hb);yb=this.Zn.getRange();this.l2=Sc?this.L5e(yb):yb;this.ctb=this.zga();this.otg=this.isRow?this.Zn.fk.cM:this.Zn.fk.dM;this.Bwg(bc,uc)}Bwg(yb,Ta){const Hb=this.grid.fp?{["IsResizingHiddenHeader"]:this.Sda,["IsAutoFitting"]:Ta,["NumberOfSelectedRanges"]:this.grid.ha.qa.GS,
["Location"]:"canvas",["ResizeRange"]:this.l2,["ResizedCellAbsoluteIndex"]:this.Zn.YGb,["HeaderViewBlockHashCode"]:this.fk.hashCode}:{["IsResizingHiddenHeader"]:this.Sda,["IsAutoFitting"]:Ta,["NumberOfSelectedRanges"]:this.grid.ha.qa.GS,["Location"]:"canvas"};be.b(this.grid.$).Aj(jc.a.Qsk,Hb);this.grid.HNk&&(Ta=Ta?"header_resize_autofit":"header_resize_start",Lb.b(this.grid.$).TA(yb,Ta,void 0));this.offset=this.Zn.Dna();this.Js=this.grid.fp?this.ctb:this.Zn.zga();if(this.Js===nb.a.nLa)return!1;Fe.c(this.grid.$,
!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}jqj(yb,Ta){var Hb=this.Zn.jP();if(!Hb)return Ca.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Hb=Hb.nextSibling;if(!Hb)return!1;yb=yb.getRange();Hb=this.fk.QJa(Hb).getRange();if(!yb||!Hb)return Ca.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;yb=this.isRow?yb.bottom:yb.right;Hb=this.isRow?Hb.bottom:Hb.right;return yb+1!==Hb&&yb!==Hb&&this.c0d(Ta,!0)}Taj(){var yb=this.Zn.jP();
const Ta=this.fk.QJa(yb.nextSibling);kc.kqj(Ta,this.isRow)?(this.Zn=Ta,this.l2=this.Zn.getRange()):(this.uyh(yb),this.Zn=Ta,yb=this.Zn.getRange(),this.l2=this.L5e(yb),this.Sda=!0)}L5e(yb){return this.isRow?new oa.Range(yb.top-1,yb.left,yb.top-1,yb.right,!1,!0):new oa.Range(yb.top,yb.left-1,yb.bottom,yb.left-1,!1,!0)}uyh(yb){const Ta=this.fk.QJa(yb.nextSibling),Hb=kc.K6h(Ta,this.isRow,this.rtl);Hb&&yb.parentNode.insertBefore(Hb,Ta.jP())}hOd(yb){const Ta=this.l2,Hb=yb.ha.qa.selectedRanges;if(yb.ha.qa.nOb(Ta))if(this.isRow){if(Fb.a.all(Hb,
uc=>uc.isRow))return Hb}else if(Fb.a.all(Hb,uc=>uc.lk))return Hb;return[Ta]}getCellExtent(){return this.Zn.getCellExtent()}qLd(){const yb=this.Zn.jP().style;return Math.max(0,Math.min(this.Rbg,0|parseInt(this.isRow?yb.height:yb.width,10)))}r_c(yb){yb=void 0===yb?0:yb;const Ta=this.grid;var Hb=this.fk.Iq.paneType;var uc=this.isRow?3===Hb?[3,2]:[1,4]:4===Hb?[2,4]:[1,3];var Sc=Math.max(this.grid.fp?this.ctb:this.Zn.zga(),0);Sc=this.Sda&&!this.grid.fp?Math.max(this.qLd(),0):Math.max(Sc+yb,0);this.xXb?
0===yb?yb=[this.isRow?51:52]:(this.hZd=!0,yb=[this.isRow?49:50]):yb=[this.isRow?13:14];Ta.Gh.tt(new oa.Range(1,1,nb.a.Rk,nb.a.Gk,!1,!0),yb,!1);if(this.TLa){Hb=new Map;for(var bc of uc)uc=Ta.sl(bc),uc=this.isRow?new vd.a(uc.Vr.topLeft.x,this.offset,uc.PH.x,Sc):new vd.a(this.offset,uc.Vr.topLeft.y,Sc,uc.PH.y),Hb.set(bc,uc);Ta.Gh.Nw(yb,null,null,!1,!0,Hb)}else bc=Ta.MPi(Hb,this.isRow),bc=this.isRow?new vd.a(0,this.offset,bc,Sc):new vd.a(this.offset,0,Sc,bc),Ta.Gh.Nw(yb,bc,uc);return Sc}grc(yb){this.l2=
this.vQa=this.dqb=null;if(this.Yca){const Ta=this.Yca.parentNode;if(Ta)for(Ta.removeChild(this.Yca);this.Yca.firstChild;)Ta.appendChild(this.Yca.firstChild);this.Yca=null}kc.xoa()?this.Zn&&(this.Zn=null,this.Z9f("clearResizeState::"+yb)):this.Zn=null;this.zre=!0;this.C9=!1}elk(){this.qJc=!1;this.uEg();this.y_f&&(this.fk.Fkk(),this.y_f=!1);cd.DOMElementExtensions.setVisible(kc.Pvb,!1);this.aZc(!1,"removeResizeArtifacts");this.kuk()}pMd(yb){if(cd.DOMElementExtensions.VM(yb.li,"a"))return null;const Ta=
this.O3f(yb.La);if(Ta&&this.grid.ha.qa.Bn){var Hb=this.grid.ha.qa.jj;Hb=this.fk.tB(oa.Range.vi(Hb.bottom,Hb.right))}else Hb=this.fk.QJa(yb.li);if(!Hb)return null;const uc=Hb.jP(),Sc=new Sys.UI.Bounds(uc.offsetLeft,uc.offsetTop,uc.offsetWidth,uc.offsetHeight);var bc=cd.DOMElementExtensions.getBoundingClientRect(yb.li);bc=new Sys.UI.Point(yb.clientPoint.x-bc.x,yb.clientPoint.y-bc.y);this.isRow&&!Ta&&(bc.y+=za.HelperMethods.tH(yb.li,uc,this.rtl).y);return new hc(uc,bc,Sc,Hb.getRange(),Math.max(kc.IGj,
Math.min(kc.BFj,(this.isRow?Sc.height:Sc.width)*kc.$sk)),Ta,!this.isRow&&0<uc.getElementsByTagName("input").length)}c0d(yb,Ta){Ta=void 0===Ta?!1:Ta;if(!yb||this.grid.isEditing)return!1;if(yb.N3f)return!0;var Hb=yb.rNa;const uc=yb.Ovb;var Sc=this.fk.Iq.paneType,bc=this.grid.sl(Sc).Dp,vc=!!bc&&bc.top===yb.BRd.top,Xc=!!bc&&bc.left===yb.BRd.left;Sc=!!bc&&bc.bottom===yb.BRd.bottom&&(3===Sc||2===Sc);this.isRow?(Xc=yb.J_b.y,yb=Xc<=uc&&!vc,Hb=Xc>=Hb.height-uc-(Sc?kc.rAi:0),Ta=Ta?yb:Hb||yb):(Sc=yb.e6i,vc=
this.rtl,bc=yb.J_b.x,yb=bc<=uc&&(!Xc||vc)&&(!Sc||!vc),Hb=bc>=Hb.width-uc&&(!vc||!Xc)&&(!Sc||vc),Ta=Ta?vc?Hb:yb:yb||Hb);return Ta}DRh(yb,Ta){const Hb=this.isRow;if(yb.N3f)this.Zn=this.fk.QJa(yb.RKa);else if(Hb&&yb.J_b.y<=yb.Ovb&&yb.rNa.height>yb.Ovb||!Hb&&yb.rNa.width>yb.Ovb&&(!this.rtl&&yb.J_b.x<=yb.Ovb||this.rtl&&yb.J_b.x>=yb.rNa.width-yb.Ovb)){if(this.Zn=yb.RKa.previousSibling?this.fk.QJa(yb.RKa.previousSibling):this.ZOi(),Ta&&yb.RKa.classList.contains(Hb?Yb.Pc:Yb.Ic)&&(yb=this.fk.QJa(yb.RKa)))yb=
yb.getRange(),this.l2=Hb?new oa.Range(yb.top-1,yb.left,yb.top-1,yb.right,!1,!0):new oa.Range(yb.top,yb.left-1,yb.bottom,yb.left-1,!1,!0)}else this.Zn=this.fk.QJa(yb.RKa);!this.l2&&this.Zn&&(this.l2=this.Zn.getRange())}ZOi(){var yb=this.isRow?1:0;return(yb=this.fk.Iq.CL(this.fk.Iq.za.rn(this.grid.$.ma,Gc.a.zU(this.fk.position.X+yb-1,this.fk.position.Y-yb,this.fk.position.PaneType))))?yb.YOi():null}mVf(){this.qJc=!0;const yb=this.atk;cd.DOMElementExtensions.setVisible(yb,!0);yb.style.cursor=this.xXb?
this.isRow?"ns-resize":"ew-resize":this.isRow?Yb.lb:Yb.g;this.r_c()}tli(yb){this.grid.$.si(this.isRow?745189930:-445963340,gb.a.rh,30,{["resizeRowColumnParameters"]:yb})}K$h(){const yb=document.createElement("div");yb.className=Yb.pb;const Ta=document.createElement("div");Ta.className=dc.a.z4;yb.appendChild(Ta);const Hb=document.createElement("img");Hb.src=Oc.a.An(0);Hb.className=this.isRow?dc.a.spi:dc.a.rpi;Ta.appendChild(Hb);this.fk.GF.domElement.parentNode.insertBefore(yb,this.fk.GF.domElement);
this.grid.fp?yb.addEventListener("pointerdown",this.YUj):($c.a.instance.xa(wd.a.qj,yb,this.mJ),Ab.a.instance.xa(wd.a.Nr,yb,this.c7));cd.DOMElementExtensions.setVisible(yb,!1);this.AW=yb}Z9f(yb){kc.xoa()&&!this.Zn&&Ca.ULS.sendTraceTag(508368661,2,20,`HeaderResizeBehavior.logUndefinedCellBeingResized: Cell being resized is undefined. caller: ${yb}`)}R4b(){this.grid.fp&&kc.xoa()&&!this.Zn||this.grc("removeResizer");this.CEg("removeResizer")}CEg(yb){var Ta,Hb,uc,Sc;if(this.AW){const bc=null===(uc=null===
(Hb=null===(Ta=this.fk)||void 0===Ta?void 0:Ta.GF)||void 0===Hb?void 0:Hb.domElement)||void 0===uc?void 0:uc.parentNode;kc.xoa()&&bc?bc.removeChild(this.AW):this.fk.GF.domElement.parentNode.removeChild(this.AW);this.AW=null;kc.xoa()&&Ca.ULS.sendTraceTag(508150751,2,50,`HeaderResizeBehavior.removeTouchResizer: Touch resized removed. Was called from caller:${yb}.isRow: ${this.isRow}, blockHash: ${null===(Sc=this.fk)||void 0===Sc?void 0:Sc.hashCode}, is flowContainer define: ${!!bc}`)}}O3f(yb){return cd.DOMElementExtensions.eo(this.AW,
yb.target)}CKb(){this.C9&&(this.grid.fp&&this.e$d(this.vQa),this.Dtf(),this.grid.fp||cd.DOMElementExtensions.VCa(this.Zn.jP(),!this.isRow,this.F6b),this.R4b(),this.Rbc=this.Sda=!1)}RTf(yb){(yb=yb.La.rawEvent)&&yb.detail===kc.yyk&&(yb.type===wd.a.Sy?(this.C9=!1,this.Gsd=!0):yb.type===wd.a.zS&&(this.C9=!0,this.Gsd=!1))}static H6h(yb,Ta){return new kc(yb,Ta)}static Ope(yb,Ta,Hb){if(Ta){yb.ColumnWidth=-1;yb.RowHeight=Hb;for(const uc of yb.SheetMultiRange.Ranges)uc.FirstColumn=0,uc.LastColumn=0}else{yb.RowHeight=
-1;yb.ColumnWidth=Hb;for(const uc of yb.SheetMultiRange.Ranges)uc.FirstRow=0,uc.LastRow=0}}static kqj(yb,Ta){if(!yb||!yb.jP())return Ca.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const Hb=yb.getRange();yb=yb.jP().style;if(!Hb||!yb)return Ca.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;yb=Ta?yb.height:yb.width;return(Ta?Hb.top:Hb.left)===(Ta?nb.a.Rk:nb.a.Gk)&&yb===kc.R$g}static K6h(yb,Ta,Hb){if(!yb)return Ca.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),
null;var uc=yb.jP();if(!uc||!uc.style)return Ca.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;yb=document.createElement("div");const Sc=uc.style;yb.style.top=Ta?Sc.top:kc.R$g;Ta||(Hb?yb.style.right=Sc.right:yb.style.left=Sc.left);yb.classList.add(Ta?Pb.upi:Pb.tpi);yb.classList.add(Ta?Yb.Rc:Yb.Kc);Hb=document.createElement("div");Hb.classList.add(Ta?Yb.zc:Yb.xb);uc=Ta?Number.parseInvariant(uc.innerText):oa.Range.qhb(uc.innerText);Hb.innerText=Ta?(uc-1).toString():
oa.Range.rR(uc-1);yb.appendChild(Hb);return yb}static xoa(){return Va.EwaSettings.isChangeGateEnabled("OfficeVSO:8257683_JSCrash_during_touch_resizeV2")}}kc.IGj=0;kc.BFj=5;kc.fDc=1;kc.KRf=1;kc.C7i=0;kc.rAi=3;kc.$sk=.1;kc.CIg="ewa-rszrbg";kc.R$g="0px";kc.yyk=2;kc.Pvb=null;Object(da.a)(kc,"HeaderResizeBehavior",Sd.a,[897]);class dd extends nc.a{constructor(){super();this.gm()}create(){this.Bk(kc.H6h)}static Ba(yb){yb.la.Hh(136,new dd)}}Object(da.a)(dd,"HeaderResizeBehaviorFactory",nc.a,[]);Td.a.Bw(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");
(()=>{gc.a.gh(yb=>{dd.Ba(yb)})})();String(Ia);String(Sa);window.___1710758652301_closurehack=Ia;window.___1710758652301_closurehack=Sa}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/d8dd7eef9269f64ab9a65cb5240ff9d7/EwaTS.rsz.js.map