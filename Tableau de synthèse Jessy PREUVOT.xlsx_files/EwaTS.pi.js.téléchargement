'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[1],{1032:function(A,u,a){a.d(u,"a",function(){return b});A=a(0);u=a(917);var c=a(83);class b extends u.a{constructor(h,r,f){super(h,r);this.Vx=!0;this.command=f}ur(h){super.ur(h);this.businessBar.$.Ma.qh(new c.a(this.command,h,this.businessBar.$.hi,10,null))}}Object(A.a)(b,"CommandActionBusinessBarEntry",u.a,[])},1081:function(A,u,a){function c(m){const x=r.a.instance;return Object.assign({},(()=>{switch(f.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarDifferentStrings",
l.Control)){case l.Clean:return{title:x.ia(2480),message:String.format(x.sh(240),m)};case l.Fix:return{title:x.ia(2481),message:String.format(x.sh(241),m)};case l.MakeConsistent:return{title:x.ia(2482),message:String.format(x.sh(242),m)};case l.MakeProfessional:return{title:x.ia(2483),message:String.format(x.sh(243),m)};case l.AvoidIncorrections:return{title:String.format(x.sh(244),m),message:x.ia(2484)};case l.Polish:return{title:x.ia(2486),message:String.format(x.sh(245),m)};default:return{title:String.format(x.sh(239),
m),message:x.ia(2475)}}})(),{Pse:x.ia(2474)})}function b(){return f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarLearnMoreLinkEnabled",!1)}function h(){switch(f.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarDifferentStrings",l.Control)){case l.Clean:return"Error";case l.Fix:return"Error";case l.MakeConsistent:return"Lightbulb";case l.MakeProfessional:return"Lightbulb";case l.AvoidIncorrections:return"Warning";case l.Polish:return"AutoEnhanceOn";
default:return"Lightbulb"}}a.d(u,"b",function(){return c});a.d(u,"c",function(){return b});a.d(u,"a",function(){return h});A=a(0);var r=a(12),f=a(1),l;(function(m){m[m.Control=0]="Control";m[m.Clean=1]="Clean";m[m.Fix=2]="Fix";m[m.MakeConsistent=3]="MakeConsistent";m[m.MakeProfessional=4]="MakeProfessional";m[m.AvoidIncorrections=5]="AvoidIncorrections";m[m.Polish=6]="Polish"})(l||(l={}));Object(A.b)("BusinessBarExperiment",l)},1083:function(A,u,a){a.d(u,"a",function(){return f});A=a(0);var c=a(15),
b=a(6),h=a(59),r=a(35);class f{static XDf(l,m){switch(l){case 3:return f.V_i(m);case 2:return f.rSi(m);case 1:return f.kLi(m)}return""}static V_i(l){switch(l){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static rSi(l){switch(l){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static kLi(l){switch(l){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static ibe(l,m,x){if(r.a.oo||r.a.Cw)window.setTimeout(()=>{f.WBg(x,f.MNf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.q7e(x),l,0,!1)}static $Xh(l,m,x,n){m&&n&&n();f.ibe(l,m,x)}static MNf(){return r.a.oo?1:r.a.Cw?2:r.a.U2a?3:r.a.isMac?4:0}static get NWb(){return"zh-CN"===window.navigator.language}static WBg(l,m){1===m?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),
l=f.XDf(l,m),8<r.a.fUb?h.a.Cm(l,void 0,void 0,"RedirectToAppStore"):h.a.H0(l)):document.hidden||(f.NWb?(l=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),h.a.H0(l)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(f.XDf(l,m),null,null)))}static q7e(l){switch(l){case 3:return 5;
case 2:return 3;case 1:return 1;default:return 0}}static get Dse(){return(r.a.U2a||r.a.isMac)&&r.a.Xv}static nEf(l){switch(l){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static ynj(l){return(l=f.HOi(l))&&""!==l?Boolean.parse(l):!1}static eqe(l){f.PEk(l)}static HOi(l){try{return localStorage.getItem(l)}catch(m){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+m.message),
null}}static PEk(l){try{localStorage.setItem(l,"true")}catch(m){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+m.message)}}}f.IWh="ChromeExtensionBarDismiss";Object(A.a)(f,"WildFireUtilities",null,[])},111:function(A,u,a){function c(d){return d.includes("aadInteractionRequired")||d.includes("sessionRevocation")||d.includes("blockAccessForTenantRestrictions")||d.includes("revoked")||d.includes("Due to organizational policies, you can't access these resources from this network location")?
!0:!1}function b(){return wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.ka("WopiTokenRevokedTokenExperiment")&&wa.AFrameworkApplication.fa.ka("ShowTokenRevocationErrorMessage"):!1}function h(){return wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAttributeGatekeeperCookieMismatch",!1):!1}function r(d,z){return Lo(function*(){if(Object(Id.l)(d.ma)){const T=d.ma.sheetProcessedData;Object(sd.a)(T);return z.map(ya=>tb(ya,!0)).filter(ya=>
T.value.Coa(ya))}return[]})}function f(d,z,T,ya){const sb=new Map;if(0===ya.size)return sb;if(!Object(Id.l)(d.ma))return ia.ULS.sendTraceTag(507568209,0,15,"Grid.getFormulasPointingToRange Unable to get activeItem."),sb;if(d.ma.sheetId===T){const cc=Object(cd.f)(d);T=cc.za.qA();const Fc=d.ma.sheetName;T.forEach(Wc=>{var id;if(Wc.ma.sheetName===Fc){const Dd=cc.$.workbookContext.WorkbookFileName;(Wc=null===(id=Wc.ql)||void 0===id?void 0:id.getCalcBlockModel())?l(z,Wc,Fc,Dd,ya).forEach(ee=>{const re=
sb.get(ee.rEe)||new Set;re.add(ee.geh);sb.set(ee.rEe,re)}):ia.ULS.sendTraceTag(507597516,0,15,"Grid.getFormulasPointingToRange Unable to get CalcBlockModel.")}})}return sb}function l(d,z,T,ya,sb){const cc=new Set;if(d){var Fc=z.getRowNumbers(),Wc=z.getColumnNumbers();Fc=Fc[0];Wc=Wc[0];z.reset();let id=null;for(;id=z.getNextCell();)if(Object(Hf.f)(id.formula)){const Dd=d.extractReferences(id.formula,T,ya,!0);if(Dd){const ee=new Rd.Range(id.row+Fc,id.col+Wc,id.row+Fc,id.col+Wc,!1,!1);for(const re of Dd.Items){const Ce=
Object(qd.F)(re.Range);sb.forEach(mf=>Ce.Ik(mf)?cc.add({rEe:ee,geh:mf}):null)}}}}else ia.ULS.sendTraceTag(507597515,0,15,"Grid.getInBlockFormulasPointingToRange Unable to get calcManager.");return cc}function m(d){switch(d){case 0:return 1;case 2:return 2;case 1:return 4;default:throw ia.ULS.sendTraceTag(508559903,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${d}`),Error.argument("illegal ExtraSpacesPaddingType");}}function x(d,z,T,ya,sb){return Lo(function*(){const cc=
Object(qd.w)(d.activeItemName,null,z),{R$d:Fc,Q$d:Wc,qbe:id}=w();Object(yb.a)(d.userOperationManager,(Dd,ee,re)=>Fe.D(d.pa.ta,sb,cc,ya,Object(uc.c)(Dd,Fc),Object(uc.b)(ee,Wc),re,null),Dd=>new Ta.a(258,0,Dd),null);yield id;return T.length})}function n(d,z,T){return Lo(function*(){const ya=Object(qd.w)(d.activeItemName,null,z),sb=d.pa.ta.Vh({yza:!0,gya:1}),{R$d:cc,Q$d:Fc,qbe:Wc}=w();Object(yb.a)(d.userOperationManager,(id,Dd,ee)=>dc.m(d.pa.ta,ya,Object(qd.q)(cd.f(d).ha.qa.activeCell,d),T,!1,null,null,
!0,!1,Object(uc.c)(id,cc),Object(uc.b)(Dd,Fc),ee,null,sb,null),id=>new Ta.a(11,0,id),null);yield Wc;return-1})}function t(d,z,T){return Lo(function*(){const ya=Object(qd.w)(d.activeItemName,null,z),{R$d:sb,Q$d:cc,qbe:Fc}=w(),Wc=T.reduce((Dd,ee)=>Dd|ee,0);Object(yb.a)(d.userOperationManager,(Dd,ee,re)=>{var Ce=d.pa.ta;Dd=Object(uc.c)(Dd,sb);ee=Object(uc.b)(ee,cc);const mf=Ce.$a(9,null);mf.ranges=ya;mf.trimWhitespaceType=Wc;return dc.h(Ce,"TrimWhitespace",mf,Dd,ee,re,null,0)},Dd=>new Ta.a(253,0,Dd),
null);const {Result:id}=yield Fc;return id})}function w(){const d=new Ub.a;return{R$d(z){z&&na.a.jl(z.Errors)?(ia.ULS.sendTraceTag(509617682,0,10,"DataCleansing onOperationSuccess: Ewa result contains error messages after applying"),d.setResult(null)):z?(ia.ULS.sendTraceTag(537163359,0,20,"DataCleansing onOperationSuccess: Suggestion applied successfully"),d.setResult(z)):(ia.ULS.sendTraceTag(508424517,0,10,"DataCleansing onOperationSuccess: Ewa result is null after applying"),d.setResult(null))},
Q$d(z){ia.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages HttpStatus [${z.data.httpStatus}]`);d.setResult(null)},qbe:Cf.e(d.task)}}function v(d,z){if(Object(R.c)(d)||Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&d.isMobileMode)return!0;d=z.worksheetState;return!!z.hostState.errorState||d.isInNamedSheetView||d.isProtected}function k(d){if(!d)return!1;d=d.sheetProcessedData;return Object(sd.d)(d)||"PartialResult"===
(null===d||void 0===d?void 0:d.reason)?!1:!0}function y(d){return Object(Eh.f)(d.name)}function C(){const d=new EventTarget;return{addEventListener:function(z,T,ya){d.addEventListener(z,sb=>{T(sb)},{signal:null===ya||void 0===ya?void 0:ya.signal,once:null===ya||void 0===ya?void 0:ya.once})},dispatchEvent:function(z,T){d.dispatchEvent(new CustomEvent(z,{detail:T}))}}}function B(d){const z=new qj.a;z.Ph=4;wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?(d=CommonUiStrings.AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUiStrings.AppsForOfficeDeveloperManifestUrl,d)+CommonUiStrings.AppsforOfficeLoadManifestUrl,z.pW(CommonUiStrings.AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,d,yk)):(d=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,d)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,z.pW(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,d,yk))}a.r(u);var E={};a.r(E);
a.d(E,"EwaAccessTokenExpirationManager",function(){return Ab});var K={};a.r(K);a.d(K,"AutoAdjustColumnsManager",function(){return hc});var F={};a.r(F);a.d(F,"RenameFileManager",function(){return Xc});var W={};a.r(W);a.d(W,"BlockPrefetcher",function(){return Fd});var J={};a.r(J);a.d(J,"CalcInterfaceAdapter",function(){return of});var L={};a.r(L);a.d(L,"CalcManager",function(){return me});var M={};a.r(M);a.d(M,"CopilotNewBadgeManager",function(){return Ne});var Q={};a.r(Q);a.d(Q,"DataCleansingHostManager",
function(){return Uc});var H={};a.r(H);a.d(H,"EnrichmentTaskPane",function(){return Ke});var ba={};a.r(ba);var U={};a.r(U);a.d(U,"ExtendedTooltipsManager",function(){return fg});var D={};a.r(D);a.d(D,"FilteredResultsStatusBarManager",function(){return Vf});var I={};a.r(I);a.d(I,"FirstRunExperienceManager",function(){return Hg});var X={};a.r(X);a.d(X,"HeaderSnappingFeature",function(){return mg});var Y={};a.r(Y);a.d(Y,"InProductMessagingManagerFactory",function(){return Ma});var ja={};a.r(ja);a.d(ja,
"InstantaneousSupportInformationManager",function(){return Uf});var Ua={};a.r(Ua);a.d(Ua,"LineageCatchUpExperimentManager",function(){return Qf});var ka={};a.r(ka);a.d(ka,"LineageTeachingCalloutTriggerManager",function(){return ag});var fb={};a.r(fb);a.d(fb,"NavigationFailHandler",function(){return Dg});var ha={};a.r(ha);a.d(ha,"NetworkConnectionStateManager",function(){return Qb});var ea={};a.r(ea);var aa={};a.r(aa);a.d(aa,"ProactiveSuggestionDebugToolsManager",function(){return de});var ca={};a.r(ca);
a.d(ca,"ProactiveSuggestionManager",function(){return Ge});var xa={};a.r(xa);a.d(xa,"ReactTaskPaneManager",function(){return P});var Oa={};a.r(Oa);a.d(Oa,"SdxManifestPrefetcher",function(){return ic});var ua={};a.r(ua);a.d(ua,"SharedUIControlsFactory",function(){return oh});var Ia={};a.r(Ia);a.d(Ia,"SheetProcessedDataPrefetcher",function(){return Di});var Sa={};a.r(Sa);a.d(Sa,"StatusBarAggregateManager",function(){return lh});var Ya={};a.r(Ya);a.d(Ya,"ThemesManager",function(){return Kg});var da=
{};a.r(da);a.d(da,"UnifiedConsentAdapter",function(){return yi});var Ea={};a.r(Ea);a.d(Ea,"ViewportObserver",function(){return yh});var oa={};a.r(oa);a.d(oa,"ViewportTelemetryManager",function(){return Ai});var za={};a.r(za);a.d(za,"ZoomEventManager",function(){return ci});var la={};a.r(la);a.d(la,"ZoomManager",function(){return si});var Ca={};a.r(Ca);a.d(Ca,"FullScreenStatusBarManager",function(){return Mi});var Va=a(0),ia=a(15),wa=a(6),Jb=a(84),$a=a(299);class Ka{constructor(){this.QXe=this.Zjd=
!1;this.Y4a=()=>{$a.a.instance.xje(this.Y4a);ia.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.$4i()};this.qqg=()=>{$a.a.instance.wje(this.qqg);this.QXe||this.Zjd||(ia.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.QXe=!0,this.hRk())};const d=wa.AFrameworkApplication.accessTokenTtl;0>=d||(this.accessTokenTtl=d,ia.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),
["BootTime"]:wa.AFrameworkApplication.mR}),$a.a.instance.Vpd(this.Y4a),$a.a.instance.Tpd(this.qqg))}$4i(){this.Zjd||(wa.AFrameworkApplication.YC(Jb.a.Kwb),this.Zjd=!0,this.gRk())}Gpd(){throw Error("Method not implemented.");}GFg(){throw Error("Method not implemented.");}}Object(Va.a)(Ka,"ASessionExpirationManager",null,[]);var nb=a(94),sa=a(40),na=a(36),ab=a(12),Ja=a(44),Pa=a(286),hb=a(8),ac=a(90),Hc=a(291),bd=a(74),zc=a(95),oc=a(5),Nb=a(210),Aa=a(142),Ub=a(183),Db=a(153),Ib=a(355);class yc{}Object(Va.a)(yc,
"Error",null,[]);class xc{}Object(Va.a)(xc,"NamedResult",null,[]);class zb extends xc{}Object(Va.a)(zb,"ErrorInfo",xc,[]);class vb{}vb.Dlc="ActivityDuration";vb.error="Error";vb.KEd="Errors";vb.failed="Failed";vb.nxi="FirstActivity";vb.initialized="Initialized";vb.jvj="LastActivity";vb.gJg="RetryOverride";vb.Crk="RequestGroups";vb.requests="Requests";vb.responses="Responses";vb.$Xc="SessionDuration";vb.status="Status";vb.success="Success";vb.successful="Successful";vb.tokens="Tokens";Object(Va.a)(vb,
"SessionExpirationStrings",null,[]);var bb=a(125);class La{constructor(d){this.Cx={};this.e9={};this.Qqh={};this.g9f=15;this.TPe=!1;this.Bsh=new Date;this.Xgc=new Date;this.K$g=()=>{ia.ULS.sendTraceTag(41964821,217,50,ia.ULS.Ci({["Aggregate"]:this.e9,["Current"]:this.Cx}))};this.vk=d;this.zkc=new bb.a(2,2,6E4*this.g9f,this.K$g,135,"SL",!1);this.vk.jm(this.zkc);this.Pcj()}Pcj(){this.e9[vb.Crk]=0;this.e9[vb.requests]=0;this.e9[vb.responses]=0;this.e9[vb.status]=vb.initialized;this.e9[vb.nxi]=new Date;
this.e9[vb.$Xc]=0;this.e9[vb.Dlc]=0;this.e9[vb.$Xc]=0;this.Cx[vb.$Xc]=0;this.e9[vb.Dlc]=0;this.Cx[vb.Dlc]=0}lTd(d,z){var T=d[z];T=T?T:0;T++;d[z]=T;this.wpe(d)}wpe(d){const z=new Date;d[vb.Dlc]=+z-+this.Xgc;this.Xgc=z;d[vb.$Xc]=+this.Xgc-+this.Bsh;d[vb.jvj]=this.Xgc}Kca(d,z){this.Cx[d]=z;this.wpe(this.Cx)}Yoe(d,z){this.Cx[d]=z;this.wpe(this.Cx)}incrementCounter(d){this.lTd(this.Cx,d);this.lTd(this.e9,d);this.lTd(this.Qqh,d)}flush(){this.TPe||(this.e9[vb.status]=this.Cx[vb.status],this.K$g(this.zkc),
this.vk.zca(this.zkc,6E4*this.g9f))}stop(){ia.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.TPe=!0;this.vk.Px(this.zkc)}}Object(Va.a)(La,"SessionLogger",null,[372]);class pb{constructor(d,z){this.Mkc=d;this.TT=z}get tokens(){return this.Mkc}get errors(){return this.TT}}Object(Va.a)(pb,"TokenRefreshArgs",null,[267]);var fa=a(107),kb=a(604),db=a(534),gb=a(189),Kb=a(394),ub=a(144),lb=a(1066),Ba=a(357),ra=a(284),wb=a(1078),mc=a(660);class xb{constructor(d,
z,T,ya,sb,cc,Fc,Wc,id,Dd,ee){ya=void 0===ya?null:ya;sb=void 0===sb?!1:sb;cc=void 0===cc?null:cc;Fc=void 0===Fc?!1:Fc;Wc=void 0===Wc?!1:Wc;id=void 0===id?!1:id;Dd=void 0===Dd?!1:Dd;ee=void 0===ee?!1:ee;this.bla=0;this.R3=this.Aq=null;this.Mkc=new Nb.a;this.TT=new Nb.a;this.kt=null;this.HEa=!1;this.KGb=this.LGb=null;this.Prk=()=>{this.FHg()};Object(wb.a)()||(this.vk=d,this.iVe=z,this.iVe.execute(re=>{re.aq(ub.a.rSd,Object(Aa.a)(this,this.aVj,"onHostResponseReceived"))}),this.aR=T,this.YZe=new lb.a("WebServiceCall",
"TokenRefresh"),this.Er=ya||new La(d),this.wsh=sb,this.kX=cc?cc:kb.SessionStatusManager.instance,this.nLe=Fc,this.$ec=Wc,this.Ish=id,this.Jsh=Dd,this.iYe=ee,this.qbb=mc.a.getInstance({Ama:"wwrelfc",featureName:"TokenRefreshManager",Afb:"Infrastructure"}))}aVj(d){if(d.MessageId!==ub.a.rSd)ia.ULS.sendTraceTag(39408099,217,15,"Unexpected message.");else{var z=new Nb.a,T=new Nb.a;this.Er.incrementCounter(vb.responses);var ya=d.Values[Kb.a.PNg];if(!ya||0>=ya.length)ia.ULS.sendTraceTag(40122317,217,15,
"Found no tokens in the dictionary"),ya=d.Values;this.Er.Kca("Correlation",d.CorrelationId);var sb="";for(let id=0;id<ya.length;id++){this.Er.Yoe(vb.tokens,ya.length);var cc=ya[id],Fc=cc;if(Fc&&Fc.Name){this.Er.incrementCounter(Fc.Name);var Wc=cc;if(Wc&&Wc.Value)z.add(Wc),this.Mkc.add(Wc),this.$ec||this.Er.Kca(vb.status,vb.success),this.nLe&&this.kX&&this.kX.Jsk();else{if(this.qTg){Wc=cc;cc=Object.assign(new zb,{Name:Wc.Name,Errors:[],SPCorrelationId:Wc.SPCorrelationId});for(const Dd of Wc.Errors)Wc=
new yc,Wc.Id=Dd.Id,Wc.Details=db.a.wKa(Dd.Details,500),cc.Errors.push(Wc)}else cc=this.XVi(cc);ia.ULS.sendTraceTag(39408129,217,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Fc.Name,JSON.stringify(cc),this.R3);T.add(cc);this.$ec||(this.TT.add(cc),sb=JSON.stringify(cc),this.Er.Kca(vb.error,JSON.stringify(cc)),this.Er.Kca(vb.status,vb.failed));if(this.nLe)for(const Dd of cc.Errors){if(this.qTg)if(Fc=Jb.a.Kwb,cc=parseInt(Dd.Id),Wc=Dd.Details.toString(),isNaN(cc))Fc=void 0;
else{switch(cc){case 401:Fc=Jb.a.p$g;b()&&c(Wc)?Fc=Jb.a.w5c:h()&&Wc.includes("GatekeeperCookieMismatch")&&(Fc=Jb.a.v5c);break;case 403:Fc=Jb.a.k$g;b()&&c(Wc)?Fc=Jb.a.w5c:h()&&Wc.includes("GatekeeperCookieMismatch")&&(Fc=Jb.a.v5c);break;case 404:wa.AFrameworkApplication.fa&&wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdatePermanentErrorList",!1)&&(Fc=Jb.a.m$g);break;case 500:Fc=Jb.a.l$g;break;case 503:Fc=Jb.a.o$g}Fc===Jb.a.Kwb&&(Fc=500<cc?Jb.a.n$g:Jb.a.j$g)}else Fc=
this.XKi(Dd);this.kX&&this.kX.EAh(Fc)}}}}this.$ec?(0<T.count?this.KGb?this.KGb(new pb(z,T)):ia.ULS.sendTraceTag(512267295,217,15,"Received errors but the promise has completed.TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}, Error: {3}",this.R3,this.kX.iHc,this.HEa.toString(),sb):this.LGb?this.LGb(new pb(z,T)):ia.ULS.sendTraceTag(512267294,217,15,"Received valid tokens but the promise has completed. TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}",this.R3,this.kX.iHc,this.HEa.toString()),
ia.ULS.sendTraceTag(512344162,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",z.count,T.count,d.CorrelationId,this.R3)):(0<T.count&&""!==sb?(ya=Object.assign({},{extendedProperties:new Map}),ya.extendedProperties.set("Errors",sb),ya.extendedProperties.set("RetryCount",this.bla.toString()),ya.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),ya.extendedProperties.set("IsTokenExpiring",this.HEa.toString()),ya.extendedProperties.set("IsAppShuttingDown",
wa.AFrameworkApplication.Xl.toString()),this.Oxb?(ya.extendedProperties.set("SkipAria","false"),ya.extendedProperties.set("TokenRefreshCorrelationId",d.CorrelationId),this.qbb.Zoa({Gw:"WACTokenRefresh",errorName:"TokenRefreshFailed",Ak:{vXd:!1,isInternal:!1,hR:ya}})):fa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ya)):this.Oxb?(sb=Object.assign({},{extendedProperties:new Map}),sb.extendedProperties.set("SkipAria","false"),sb.extendedProperties.set("TokenRefreshCorrelationId",
d.CorrelationId),this.qbb.FMa({Gw:"WACTokenRefresh",Ak:{hR:sb}})):fa.Health.instance.recordKpiSuccess("WACTokenRefresh",null),ia.ULS.sendTraceTag(39408130,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",z.count,T.count,d.CorrelationId,this.R3),0<T.count&&!this.hXb(T)?(d=this.aR.fLf(T),d!==this.aR.Uvb&&(this.Er.Yoe(vb.gJg,d),this.vk.zca(this.Aq,d))):(this.Er.flush(),this.Aq&&this.vk.Px(this.Aq),this.kt&&!this.kt.task.isCompleted?this.kt.setResult(new pb(z,
T)):ia.ULS.sendTraceTag(512267293,217,15,"Received results but the task has completed")))}}XVi(d){if(!d)return null;const z=Object.assign(new zb,{Name:d.Name,Errors:[],SPCorrelationId:d.SPCorrelationId});for(const T of d.Errors)d=new yc,d.Id=T.Id,d.Details=db.a.wKa(T.Details,500),z.Errors.push(d);return z}FHg(){ra.a.DA("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");if(this.bla>=this.aR.icg)ia.ULS.sendTraceTag(39408132,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
this.R3),this.Nkf(this.kt,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts");else{var d=gb.a.create().toString();if(this.Oxb){const z=new Map;z.set("SkipAria","false");z.set("TokenRefreshCorrelationId",d);this.qbb.Dba({Gw:"WACTokenRefresh",Ypb:Ba.b.SuccessBased,Ak:{extendedProperties:z}})}else fa.Health.instance.recordKpiUsage("WACTokenRefresh",Ba.b.SuccessBased,"wwrelfc",null);this.aNg(d)}}aNg(d){const z={};z[Kb.a.PNg]=this.aR.tokens;
this.Ish&&(z[Kb.a.yBk]=this.Jsh);ia.ULS.sendTraceTag(39408133,217,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.aR.tokens),this.bla+1,d,this.R3);this.iVe.execute(T=>{T.sendMessage(ub.a.l7e,z,d)});this.bla++;this.Er.incrementCounter(vb.requests)}Nkf(d,z,T){const ya=new Nb.a;for(let sb=0;sb<this.aR.tokens.length;sb++){const cc=Object.assign(new zb,{Name:this.aR.tokens[sb],Errors:[Object.assign(new yc,{Id:z,Details:T})]});ya.add(cc);this.TT.add(cc)}this.vk.Px(this.Aq);
this.Er.Kca(vb.KEd,JSON.stringify(this.TT));this.Er.Kca(vb.status,vb.failed);d&&!d.task.isCompleted&&d.setResult(new pb(new Nb.a,this.TT))}fhk(d,z){z=void 0===z?null:z;ra.a.DA("ej4if276;fheca743");ra.a.DA("5d4fi128;abe10395");ra.a.DA("7db39907;cegi0367;ijicc640");this.YZe.start();this.vk.k0a&&(ia.ULS.sendTraceTag(508351137,217,15,"Restarting taskmanager, is shutting down {0}",wa.AFrameworkApplication.Xl),this.vk.a6b());this.HEa=d;this.R3=gb.a.create().toString();ia.ULS.sendTraceTag(41755338,217,50,
"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.R3,this.HEa);this.bla=0;this.TT.clear();this.Mkc.clear();const T=new Ub.a;this.kt=T;z&&z.R(()=>{const ya=!!T&&!T.task.isCompleted;ia.ULS.sendTraceTag(588096223,217,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.R3,this.HEa,ya);ya&&this.Nkf(T,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.$ec?this.GHg(this.aR.icg).then(ya=>{this.kt&&!this.kt.task.isCompleted&&
this.kt.setResult(ya);this.KGb=this.LGb=null;this.Er.Kca(vb.KEd,JSON.stringify(this.TT));this.Er.Kca(vb.status,vb.success);this.Er.flush()}).catch(ya=>{this.kt&&!this.kt.task.isCompleted&&this.kt.setResult(Object(Db.a)(267,ya));this.KGb=this.LGb=null;this.Er.Kca(vb.KEd,JSON.stringify(this.TT));this.Er.Kca(vb.status,vb.failed);this.Er.flush()}):(this.Aq=new bb.a(this.aR.priority,2,this.aR.Uvb,this.Prk,98,ub.a.l7e,!0),this.wsh&&this.FHg(),this.vk.jm(this.Aq));return this.kt.task}GHg(d){const z=this,
T=gb.a.create().toString(),ya=new Promise((id,Dd)=>{z.LGb=id;z.KGb=Dd;this.Oxb?(id=new Map,id.set("SkipAria","false"),id.set("TokenRefreshCorrelationId",T),this.qbb.Dba({Gw:"WACTokenRefresh",Ypb:Ba.b.SuccessBased,Ak:{extendedProperties:id}})):fa.Health.instance.recordKpiUsage("WACTokenRefresh",Ba.b.SuccessBased,"wwrelfc",null);z.aNg(T)}),sb=this,cc=new Promise((id,Dd)=>{window.setTimeout(()=>{Dd(sb.Skf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},sb.aR.Uvb)});
let Fc=d;const Wc=this;return new Promise((id,Dd)=>{Fc--;Promise.race([ya,cc]).then(ee=>{if(this.Oxb){const re=Object.assign({},{extendedProperties:new Map});re.extendedProperties.set("SkipAria","false");re.extendedProperties.set("TokenRefreshCorrelationId",T);this.qbb.FMa({Gw:"WACTokenRefresh",Ak:{hR:re}})}else fa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);id(ee)}).catch(ee=>{var re=Wc.aR.Uvb;if(Object(Ib.a)(267,ee)&&(ee=Object(Db.a)(267,ee),0<ee.errors.count)){Wc.Rzj(ee.errors,T);
Wc.lz(ee.errors);if(Wc.hXb(ee.errors)){Dd(ee);return}const Ce=Wc.aR.fLf(ee.errors);Ce!==Wc.aR.Uvb?(Wc.Er.Yoe(vb.gJg,Ce),re=Ce):Wc.Esj(ee.errors)&&(re=0)}Fc?window.setTimeout(()=>{Wc.GHg(Fc).then(id).catch(Dd)},re):(re=Wc.Skf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Wc.lz(re.errors),Dd(re),ia.ULS.sendTraceTag(512267292,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Wc.R3))})})}lz(d){for(const z of d)this.TT.add(z)}Esj(d){if(!d.count)return!1;
d=d.na(d.count-1);return d.Errors.length?"TIMEOUT"==d.Errors[0].Id:!1}Skf(d,z){const T=new Nb.a;for(let ya=0;ya<this.aR.tokens.length;ya++){const sb=this.V5h(this.aR.tokens[ya],d,z);T.add(sb)}return new pb(new Nb.a,T)}V5h(d,z,T){return Object.assign(new zb,{Name:d,Errors:[Object.assign(new yc,{Id:z,Details:T})]})}Rzj(d,z){if(d.count){d=d.na(d.count-1);d=JSON.stringify(d);var T=Object.assign({},{extendedProperties:new Map});T.extendedProperties.set("Errors",d);T.extendedProperties.set("RetryCount",
this.bla.toString());T.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());T.extendedProperties.set("IsTokenExpiring",this.HEa.toString());T.extendedProperties.set("IsAppShuttingDown",wa.AFrameworkApplication.Xl.toString());this.Oxb?(T.extendedProperties.set("SkipAria","false"),T.extendedProperties.set("TokenRefreshCorrelationId",z),this.qbb.Zoa({Gw:"WACTokenRefresh",errorName:"TokenRefreshFailed",Ak:{hR:T}})):fa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",
!1,!1,T);this.Er.Kca(vb.error,d);this.Er.Kca(vb.status,vb.failed)}}Bak(d){this.YZe.stop();const z=this.g6i(d.result.errors);ia.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!z,this.R3,this.HEa,this.bla,this.TT.count,0<d.result.errors.count?d.result.errors.na(0).Name:"",0<d.result.errors.count&&0<d.result.errors.na(0).Errors.length?d.result.errors.na(0).Errors[0].Id:
"",0<d.result.errors.count&&0<d.result.errors.na(0).Errors.length?d.result.errors.na(0).Errors[0].Details:"");return z?!1:this.Aak(d.result.tokens)}hXb(d){return this.aR.hXb(d)}Aak(d){for(let z=0;z<d.count;z++){const T=d.na(z);if(T.Name===Kb.a.accessToken){const ya=(new Date).getTime();T.Expiry>wa.AFrameworkApplication.accessTokenTtl?(ia.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:T.Expiry,["NowGetTime"]:ya,["BootTime"]:wa.AFrameworkApplication.mR},"PreviousAccessTokenTtl",
wa.AFrameworkApplication.accessTokenTtl),wa.AFrameworkApplication.accessToken=T.Value,wa.AFrameworkApplication.accessTokenTtl=Math.floor(T.Expiry),wa.AFrameworkApplication.U$a=ya,wa.AFrameworkApplication.nla=Math.floor(T.Expiry)):ia.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:T.Expiry,["NowGetTime"]:ya,["BootTime"]:wa.AFrameworkApplication.mR},"PreviousAccessTokenTtl",wa.AFrameworkApplication.accessTokenTtl)}}return!0}g6i(d){let z=
!1;for(let T=0;T<d.count;T++){z=!0;const ya=d.na(T);ia.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",ya.Name,JSON.stringify(ya.Errors),this.R3,ya.SPCorrelationId)}return z}J3f(d){return d.includes("aadInteractionRequired")||d.includes("sessionRevocation")||d.includes("blockAccessForTenantRestrictions")||d.includes("revoked")||d.includes("Due to organizational policies, you can't access these resources from this network location")?!0:
!1}b_f(d){return d.includes("GatekeeperCookieMismatch")}XKi(d){let z=Jb.a.Kwb;const T=parseInt(d.Id);d=d.Details.toString();if(isNaN(T))z=Jb.a.Vel;else{switch(T){case 401:z=Jb.a.p$g;this.iYe&&this.J3f(d)?z=Jb.a.w5c:this.GSg&&this.b_f(d)&&(z=Jb.a.v5c);break;case 403:z=Jb.a.k$g;this.iYe&&this.J3f(d)?z=Jb.a.w5c:this.GSg&&this.b_f(d)&&(z=Jb.a.v5c);break;case 404:this.Cse&&(z=Jb.a.m$g);break;case 500:z=Jb.a.l$g;break;case 503:z=Jb.a.o$g}z===Jb.a.Kwb&&(z=500<T?Jb.a.n$g:Jb.a.j$g)}return z}get Oxb(){return null!=
this.mGe?this.mGe:this.mGe=wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseNewKPIApiForTokenRefresh",!1):!1}get qTg(){return null!=this.hGe?this.hGe:this.hGe=wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldRefactorProcessingTokenRefreshError",!1):!1}get GSg(){return null!=this.gGe?this.gGe:this.gGe=wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldAttributeGatekeeperCookieMismatch",
!1):!1}get Cse(){return null!=this.kGe?this.kGe:this.kGe=wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdatePermanentErrorList",!1):!1}}Object(Va.a)(xb,"TokenRefreshManager",null,[268]);class Ec{constructor(){this.Uvb=wa.AFrameworkApplication.Yel;this.icg=wa.AFrameworkApplication.Wel;this.tokens=wa.AFrameworkApplication.A0i();this.priority=wa.AFrameworkApplication.yCe;this.wWe=this.pGk();this.eeb=wa.AFrameworkApplication.z0i()}hXb(d){if(this.TNk){var z=
[];for(const ya of d)if(ya.Errors)for(const sb of ya.Errors)z.push(sb.Id);d=JSON.stringify(z);if(this.eeb&&0<this.eeb.length)for(var T of this.eeb)if(0<T.length&&0<=d.indexOf(T))return!0}else if(T=JSON.stringify(d),this.eeb&&0<this.eeb.length)for(z of this.eeb)if(0<z.length&&0<=T.indexOf(z))return!0;return!1}fLf(d){try{if(d)for(const z of d)if(z.Errors)for(const T of z.Errors)if(T.Id in this.wWe)return Number.parseInvariant(this.wWe[T.Id].toString())}catch(z){ia.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",
z.toString())}return this.Uvb}pGk(){const d={};try{if(!wa.AFrameworkApplication.ZCc()||0>=wa.AFrameworkApplication.ZCc().length||""===wa.AFrameworkApplication.ZCc()[0])return d;for(const z of wa.AFrameworkApplication.ZCc())0<z.length&&(d[z]=wa.AFrameworkApplication.Xel)}catch(z){ia.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",z.toString())}return d}get TNk(){return null!=this.lGe?this.lGe:this.lGe=wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseErrorsForParsingPermanentErrors",
!1):!1}}Object(Va.a)(Ec,"TokenRefreshPolicy",null,[266]);var ed=a(2),jd=a(79),Xd=a(769),Td=a(32);class gc{constructor(d,z){this.u4b=!1;this.correlationID=d;this.oAd=z;this.c2c=!1;this.creationTime=Td.a.ih.ri}}Object(Va.a)(gc,"RefreshAccessTokenContext",null,[]);var nc=a(61),dc=a(64),Gc=a(184),vd=a(54),zd=a(131),Yb=a(146),Pb=a(1),$c=a(28),wd=a(170),Bd=a(37),tc=a(112);class Zc{constructor(d,z){this.documentVisibilityObserver=null;this.eh=new sa.a;this.iM=null;this.m9a=this.Xcb=!1;this.bUc=null;this.D4b=
!1;this.J3d=!0;this.Ued=this.aQe=this.xE=this.IGb=!1;this.h3=null;this.r1g=this.qJd=this.Rxc=this.Xl=!1;this.UPf=()=>{if(this.$.ea.ki)this.rQf(!1);else if(this.J3d){this.J3d=!1;const T=bd.a(this.$);ia.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${T.Zp?T.Zp.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.N0g()}]`)}};this.ij=(T,ya)=>{this.context&&(T=this.$.ea,ya.RM&&this.context.u4b&&
!this.context.c2c?(this.context.c2c=!0,ya={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},ya.IsUserActive=T.Hl.yv,ya.RefreshAccessTokenCorrelationID=this.context.correlationID,ya=nc.a.Ci(ya),ia.ULS.sendTraceTag(537170708,0,50,ya)):!this.Xcb||T.ki||this.context.oAd||(ya={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.iM&&(this.iM.cancel(),ya.Aborted=!0,ya.ResetStopRefreshRetriesUntilTokenExpired=!0,
this.m9a=!1),ya.TimeUntilTokenExpirationInMin=this.N0g(),ya.RefreshAccessTokenCorrelationID=this.context.correlationID,ya=nc.a.Ci(ya),ia.ULS.sendTraceTag(572019856,0,50,ya)))};this.JNa=()=>{if(this.context&&this.context.u4b&&!this.context.c2c){var T={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};T.CreatedForExpired=this.context.oAd;T.RefreshAccessTokenCorrelationID=this.context.correlationID;T.OpenWorkbookErrors=na.a.Yh(this.$.ea.RP);T.ExecutionContextErrors=na.a.Yh(bd.a(this.$).xj.errors);
T.accesstokenTTL=wa.AFrameworkApplication.accessTokenTtl;T=nc.a.Ci(T);ia.ULS.sendTraceTag(537170707,0,15,T)}};this.qQf=()=>{this.m9a=!1;this.rQf(!0)};this.Rae=()=>{this.D4b&&(this.$.ea.Hl.aPa(this.Rae),this.D4b=!1);this.eYg()};this.$=d;this.Bxe=z;this.hhe=d.Eh.em("WebServiceCall","refreshToken");$a.a.instance.Vpd(this.qQf);$a.a.instance.Tpd(this.UPf);z=this.$.ea;z.$q(this.ij);z.Umc(this.JNa);this.JGj=this.$.ua.MinTokenLifetimeForRegularExpirationPromptInMin;this.wSg=this.$.ua.ShortAccessTokenExpirationPromptSeconds;
this.aCg=this.$.ua.RefreshAccessTokenDurationLimitInSec;this.s7g(d.ea.Htg,wa.AFrameworkApplication.accessTokenTtl);d=JSON.stringify({["AccessTokenTtl"]:wa.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:wa.AFrameworkApplication.mR,["WopiTokenExpiresAfterMinutes"]:wa.AFrameworkApplication.iDa,["WopiTokenTaskItemPriority"]:wa.AFrameworkApplication.yCe});ia.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${d}`);Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void zc.a.resolve(oc.Cb).then(T=>{this.documentVisibilityObserver=T}):this.$.la.fi(291,T=>{this.documentVisibilityObserver=T})}vIg(){this.m9a=this.Xcb=this.Ued=this.xE=!1;tc.a.Vha=0;tc.a.WY=0;tc.a.XY=0}Epd(d){this.eh.addHandler("SessionExpired",d)}hua(d){this.eh.addHandler("TokenRefreshed",d)}qvb(d){this.eh.removeHandler("TokenRefreshed",d)}Gpd(){}GFg(){}get zxe(){return this.IGb}get H6(){return this.aQe}get KY(){return this.Ued}get context(){return this.h3}get xxb(){return this.KY?!1:this.$.ea.Hl.yv?
1>tc.a.WY:6>tc.a.XY}get Wub(){return this.Xcb}SDc(){return $a.a.instance.aN(wa.AFrameworkApplication.accessTokenTtl)}dispose(){$a.a.instance.xje(this.qQf);$a.a.instance.wje(this.UPf);const d=this.$.ea;d&&(d.Uq(this.ij),d.kVc(this.JNa));nb.a.dh(this.eh);this.documentVisibilityObserver=this.$=null}N0g(){return this.SDc()?0:(wa.AFrameworkApplication.accessTokenTtl-(new Date).getTime())/6E4}s7g(d,z){if(0<z&&!this.SDc()){const T=wa.AFrameworkApplication.fa.Lj("AccessTokenExpirationPromptSeconds",wa.AFrameworkApplication.fU),
ya=(z-d.getTime())/6E4;ia.ULS.shipAssertTag(537170713,0,0<=ya,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${z}] creationTime [${d.getTime()}] tokenLifetimeInMin [${ya}]`);ya<this.JGj?(ia.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.wSg}] tokenLifetimeInMin [${ya}]`),wa.AFrameworkApplication.fU=this.wSg):
wa.AFrameworkApplication.fU!==T&&(ia.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${T}] tokenLifetimeInMin [${ya}]`),wa.AFrameworkApplication.fU=T)}}d4h(d){return!this.context||this.context.u4b||this.context.oAd!==d?(d=new gc(gb.a.create().toString(),d),this.context&&!this.context.c2c&&ia.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${d.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.u4b}] `),
this.h3=d,!0):!1}ksk(d){d&&this.xE&&!this.H6&&this.$.ea.Hl.yv&&!this.KY&&(this.xE=!1)}rQf(d){this.ksk(d);if(!(this.Xcb||this.m9a&&!d||this.xE)&&this.xxb){this.Xcb=!0;var z=this.context?this.context.creationTime:null,T=this.d4h(d);this.J3d=!0;var ya=this.$.ea;this.Xl=wa.AFrameworkApplication.Xl;var sb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};sb.newContextCreated=T;sb.IsUserActive=ya.Hl.yv;sb.IsSessionActive=ya.ki;sb.ContainsChangesWorkbookOperations=this.$.userOperationManager.HXa();
sb.isSessionExpired=d;sb.stopRefreshRetriesUntilTokenExpired=this.m9a;sb.FailedToRefreshExpiredToken=this.xE;sb.numOfFailuresWhileUserIsActive=tc.a.WY;sb.numOfFailuresWhileUserIsInActive=tc.a.XY;sb.numOfFailuresWhileOffline=tc.a.Vha;sb.RefreshAccessTokenCorrelationID=this.context.correlationID;sb.isShuttingDown=this.Xl;T&&z&&(sb.TimeInMinFromPreviosContextCreation=Math.round(Yb.b(Td.a.ih,z)/60));z=nc.a.Ci(sb);ia.ULS.sendTraceTag(40416199,0,50,z);if(this.Xl)ia.ULS.sendTraceTag(508126686,0,15,z);else{this.hhe.start();
this.aQe=ya.Hl.yv;this.iM=new Xd.a;this.cxj(d);var cc=this.Bxe.fhk(!d,this.iM?this.iM.token:null);cc.continueWith(()=>{this.mXh();const Fc=this.Bxe.Bak(cc);this.hhe.stop();const Wc=this.SDc();if(!Fc||Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Wc){const id=cc.result.errors;Fc&&Wc&&this.dyh(id);this.A4i(id,d)}else this.m9a=!1,this.G4i(cc.result.tokens,d);this.Xcb=!1},8)}}}dyh(d){const z=[Object(ed.a)(new yc,{Id:"200",Details:"Expired access token received on successful token request."})];
d.add(Object(ed.a)(new zb,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:z}))}cxj(d){d&&(this.$.ea.Hl.yv?this.eYg():(this.$.ea.Hl.qGa(this.Rae),this.D4b=!0))}eYg(){this.bUc=Gc.AsyncMethodContext.wC(()=>{this.ehk()},1E3*this.aCg,vd.a.Kgk,this.bUc)}mXh(){this.bUc&&this.bUc.cancel();this.D4b&&(this.$.ea.Hl.aPa(this.Rae),this.D4b=!1);this.iM=null}ehk(){ia.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.aCg}]`);
this.iM.cancel()}A4i(d,z){this.m9a=!0;z&&(this.xE||(this.IGb=this.xE=!0),this.Bxe.hXb(d)&&(this.Ued=!0));const T=!z||this.xxb&&!tc.a.IZc?40380379:39982555;z=this.Hkf(z);z.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";z.FailedToRefreshExpiredToken=this.xE;z.LastErrorIsPermanent=this.KY;if(0<d.count){var ya=d.na(0);z.errorName=ya.Name;0<ya.Errors.length&&(z.ErrorId=ya.Errors[0].Id,ya=ya.Errors[0].Details,z.ErrorDetails=this.Chi(ya.toString())?"PiiScrubbed":ya)}z=nc.a.Ci(z);ia.ULS.sendTraceTag(T,
0,15,z);if(0<d.count&&Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8514343_ReCategorizeSessionExpiryVeto")){this.Rxc=!1;for(const sb of d)if(sb.Errors)for(const cc of sb.Errors)"GatekeeperCookieMismatch"===cc.Details&&(this.qJd=!0),"403"===cc.Id&&(this.Rxc=!0)}this.eh.raiseEvent("TokenRefreshed",new pb(null,d))}Chi(d){return $c.a.contains(d,"makes the internet safe for businesses",!0)}Hkf(d){const z={},T=this.$.ea;z.Name="";z.IsUserActive=T.Hl.yv;z.IsSessionActive=T.ki;z.GotDeploymentOrTimedOutError=
T.Eaa;z.TimeInSecFromLastStatefulSuccessfulRequest=T.K8;z.TimeFromLastUserActivityInMs=T.Hl.Nyb;z.calledFromSessionExpiredFlow=d;z.RefreshTokenDurationInMS=this.hhe.zi;z.numOfFailuresWhileUserIsActive=tc.a.WY;z.numOfFailuresWhileUserIsInActive=tc.a.XY;z.numOfFailuresWhileOffline=tc.a.Vha;z.RefreshAccessTokenCorrelationID=this.context.correlationID;z.accessTokenTTL=wa.AFrameworkApplication.accessTokenTtl;z.ContainsChangesWorkbookOperations=this.$.userOperationManager.HXa();z.IsDocumentHidden=this.documentVisibilityObserver?
this.documentVisibilityObserver.un.toString():"Unknown";z.TimeFromFirstOpenInHr=Math.floor(Yb.b(Td.a.ih,zd.toUtc(T.Htg))/3600);return z}G4i(d,z){this.xE=!1;this.Z$k();this.s7g(new Date,wa.AFrameworkApplication.accessTokenTtl);const T=this.$.ea,ya=!z&&T.Hl.yv,sb=!this.$.isEditMode&&T.Nub;z=this.Hkf(z);z.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";z.shouldTriggerSilentReloadAfterExpiring=ya;z.WopiTokenTaskItemPriority=wa.AFrameworkApplication.yCe;z.isDirtyViewSession=sb;z=nc.a.Ci(z);
ia.ULS.sendTraceTag(39982556,0,15,z);this.eh.raiseEvent("TokenRefreshed",new pb(d,null));sb?T.Hl.yv&&(ia.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),T.DId()):T.Hl.yv?Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateNewUserAccessToken",!1)&&ya&&this.$.isEditMode?ia.ULS.sendTraceTag(507827846,0,50,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: successful token refresh when user is active."):
ya&&(d=bd.a(this.$).xj.activityState,d[tc.a.jzb]=!0,d[wd.a.Z9]=!0,d[Bd.a.aA]=this.$.isEditMode,d[Bd.a.Pnd]=this.$.ea.u1a,Ja.a(this.$).Xy(new Pa.a(hb.a.Kqa,2,null))):T.ki&&dc.k(this.$.pa.ta,!0,!1,!1,null,null,null,null,null)}Z$k(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=jd.a.F_(this.$.ea.workbookContext.WorkbookUri,wa.AFrameworkApplication.XL,wa.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=
jd.a.F_(this.$.ea.workbookContext.WorkbookUri,wa.AFrameworkApplication.gU,wa.AFrameworkApplication.accessTokenTtl.toString()),this.$.ea.WQc()):ia.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ua.AccessToken=wa.AFrameworkApplication.accessToken;this.$.ua.AccessTokenValidTo=wa.AFrameworkApplication.accessTokenTtl;void 0!==this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion&&
(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion=jd.a.F_(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion,wa.AFrameworkApplication.XL,wa.AFrameworkApplication.accessToken),this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion=jd.a.F_(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion,wa.AFrameworkApplication.gU,wa.AFrameworkApplication.accessTokenTtl.toString()));void 0!==this.$.ua.EmbedConfiguratorUrl&&null!==this.$.ua.EmbedConfiguratorUrl&&(this.$.ua.EmbedConfiguratorUrl=jd.a.F_(this.$.ua.EmbedConfiguratorUrl,
wa.AFrameworkApplication.XL,wa.AFrameworkApplication.accessToken),this.$.ua.EmbedConfiguratorUrl=jd.a.F_(this.$.ua.EmbedConfiguratorUrl,wa.AFrameworkApplication.gU,wa.AFrameworkApplication.accessTokenTtl.toString()));this.context.u4b=!0}}Object(Va.a)(Zc,"EwaAccessTokenExpirationRefreshManager",null,[249,250,4]);Object(zc.b)(oc.a,{Fk:"singleton"})(d=>Lo(function*(){const z=yield zc.a.resolve(oc.Nb,d);if(wa.AFrameworkApplication.fa.ka("RefreshAccessTokenSilently")){const T=new xb(wa.AFrameworkApplication.Lp,
wa.AFrameworkApplication.UF(),new Ec);return new Zc(z,T)}return new Ab(z)}));class Ab extends Ka{constructor(d){super();this.eh=new sa.a;this.qJd=this.Rxc=this.xE=this.IGb=!1;this.$=d}vIg(){}Epd(d){this.eh.addHandler("SessionExpired",d)}hua(d){this.eh.addHandler("TokenRefreshed",d)}qvb(d){this.eh.removeHandler("TokenRefreshed",d)}get accessTokenExpiringMessage(){const d=(new Date(this.accessTokenTtl)).format(this.$.ua.ShortTimeFormat);return String.format(ab.a.instance.sh(78),d)}get zxe(){return this.IGb}get xxb(){return!1}get H6(){return!1}get Wub(){return!1}get KY(){return!1}SDc(){return $a.a.instance.aN(wa.AFrameworkApplication.accessTokenTtl)}dispose(){nb.a.dh(this.eh);
this.$=null}hRk(){this.$.isEditMode&&this.nDc(!1)}gRk(){this.IGb=!0;this.nDc(!0);this.eh.raiseEvent("SessionExpired")}nDc(d){ia.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${d}, GotDeploymentOrTimedOutError ${this.$.ea.Eaa}`);const z=this.$.vh.rw;d&&z&&z.isVisible&&1299163859===z.error.MessageId&&this.$.vh.rw.nK();const T=this.nj(d);Ja.a(this.$).Xy(new Pa.a(hb.a.DD,5,()=>{const ya=bd.a(this.$),sb=ya.xj.activityState;sb[ac.a.xea]=this.$.VJb(this.$.isEditMode);
sb[ac.a.qX]=ac.a.Hrb;sb[Hc.a.Yw]=hb.a.accessTokenExpiringWarning;ya.xj.lz([T])}))}nj(d){return Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8691397_RecategorizeAccessTokenExpiredSilentRefreshDisabled")?na.a.mmf():d?na.a.Zzd():this.R9h()}R9h(){const d=na.a.nj(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");d.Description=this.accessTokenExpiringMessage;return d}}Object(Va.a)(Ab,"EwaAccessTokenExpirationManager",Ka,[249,250,4]);var rb=a(135),Fb=a(101),jc=a(126),Oc=a(115),cd=a(23),Ed=a(7),Sd=a(83),
$d=a(65),be=a(25),Fe=a(358),Pe=a(124);let hc=class{constructor(d,z){this.rsd=this.f$e=this.ssd=0;this.e$e=!1;this.proactiveSuggestionCard=null;this.Dhb=this.pif=!1;this.sessionCount=this.autoAdjustColumnWidthSettings=0;this.bM=!1;this.ij=(T,ya)=>{ia.ULS.sendTraceTag(508363741,0,50,"AutoAdjustColumnsManagerService::onSessionIdChanged detected.");ya.ki?this.initialize():ia.ULS.sendTraceTag(508360707,0,15,"AutoAdjustColumnsManagerService::onSessionIdChanged but session is still not active.");this.$.ea.Uq(this.ij)};
this.V4a=T=>{if(na.a.jl(T.Errors)){const ya=T.Errors[0].MessageId;Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")&&-315732528===ya||ia.ULS.sendTraceTag(508641556,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${na.a.Yh(T.Errors)}.`)}else T.Result&&(this.autoAdjustColumnWidthSettings=parseInt(T.Result,10),this.Dhb=0!==(this.autoAdjustColumnWidthSettings&3),this.sessionCount=(this.autoAdjustColumnWidthSettings&65280)>>
8),this.bM=2!==(this.autoAdjustColumnWidthSettings&2),this.e$e||0!==(this.autoAdjustColumnWidthSettings&2)||(0===this.sessionCount&&(this.Dhb=!1),this.x$i())};this.Jsb=T=>{T=Pe.a.gk(T.data);ia.ULS.sendTraceTag(508641555,0,10,`AutoAdjustColumnWidth.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${na.a.Yh(T)}.`)};this.e5a=T=>{na.a.jl(T.Errors)?ia.ULS.sendTraceTag(508641554,0,10,`AutoAdjustColumnWidth.onWriteRoamingStringSuccess: encountered an error. Errors: ${na.a.Yh(T.Errors)}`):
T.Result||ia.ULS.sendTraceTag(508641553,0,10,"AutoAdjustColumnWidth.onWriteRoamingStringSuccess failed to write to roaming service.")};this.vYj=T=>{if(na.a.jl(T.Errors))ia.ULS.sendTraceTag(508641552,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${na.a.Yh(T.Errors)}.`);else{var ya=0;T.Result&&(ya=parseInt(T.Result,10));ya=ya&-4|this.autoAdjustColumnWidthSettings&3;this.F5c(ya)}};this.Nig=()=>{Fb.a("AutoAdjustColumnWidthKeepOn");0===(this.autoAdjustColumnWidthSettings&
1)&&(this.autoAdjustColumnWidthSettings|=1,this.$Ag());this.Dhb=!0;this.proactiveSuggestionCard.hide()};this.GPj=()=>{this.A0h();this.proactiveSuggestionCard.hide()};this.B2j=()=>{Fb.a("AutoAdjustColumnWidthHelp");const T=new Sd.a(-859308420,$d.a.rh,this.$.hi,9,null);this.$.Ma.qh(T,{[$d.a.Xk]:"HelpID=151880",["InputMethod"]:$d.a.rh,["ShouldCanvasTakeFocus"]:!0,[$d.a.Qi]:Ed.a.FK,[Ed.a.wja]:!0})};this.OUj=()=>{const T={};T[Ed.a.cP]="AutoAdjustColumnWidth";this.$.si(802602464,$d.a.rh,8,T)};this.O0j=
()=>{Fb.a("AutoAdjustColumnWidthTurnedOff");this.autoAdjustColumnWidthSettings|=2;this.$Ag();this.Dhb=!0;this.proactiveSuggestionCard.hide();this.bM=!1};this.$=d;this.proactiveSuggestionCard=z;this.f$e=Pb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmThreshold",3);this.rsd=Pb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmSessionCycle",3);this.e$e=0===this.rsd;!Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")||
this.$.ea.ki?this.initialize():this.$.ea.$q(this.ij)}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose();this.$=null}initialize(){ia.ULS.shipAssertTag(508641557,0,be.a.hoa(),"AutoAdjustColumnWidth feature is off");Fe.C(this.$.pa.ta,5,this.V4a,this.Jsb,null,null)}F5c(d){Fe.J(this.$.pa.ta,5,d.toString(),this.e5a,this.Jsb,null,null)}x$i(){if(2!==(this.autoAdjustColumnWidthSettings&2)){var d=this.sessionCount+1;d>=this.rsd&&(d=0);this.F5c(this.autoAdjustColumnWidthSettings&
-65281|d<<8)}}$Ag(){Fe.C(this.$.pa.ta,5,this.vYj,this.Jsb,null,null)}mhg(d){if(0===this.ssd){const z=[];z.push(jc.a.lm("Command",d,Oc.g.String));Fb.a("AutoAdjustedColumnWidth",void 0,void 0,z)}++this.ssd;ia.ULS.shipAssertTag(508641551,0,0===(this.autoAdjustColumnWidthSettings&2),"AutoAdjustedColumns when AutoAdjustColumnWidthSettings is Off");!this.Dhb&&this.ssd>=this.f$e&&this.z0h()}z0h(){if(null!=this.proactiveSuggestionCard){Fb.a("AutoAdjustColumnWidthDialog");var d=ab.a.instance.Ea(858),z=ab.a.instance.Ea(859),
T=ab.a.instance.Ea(860),ya=ab.a.instance.Ea(861),sb=ab.a.instance.Ea(863);this.proactiveSuggestionCard.show(cd.f(this.$).ha.qa.jj,d,z,T,ya,this.Nig,this.GPj,this.FBc(),void 0,void 0,"WrapText",void 0,void 0,void 0,void 0,!1,!1,sb,this.OUj);this.pif?this.Dhb=!0:this.pif=!0}}FBc(){return[{key:"learnMessage",text:ab.a.instance.Ea(862),onClick:this.B2j}]}A0h(){const d=ab.a.instance.Ea(864),z=ab.a.instance.Ea(865),T=ab.a.instance.Ea(866),ya=ab.a.instance.Ea(861);this.proactiveSuggestionCard.show(cd.f(this.$).ha.qa.jj,
d,z,T,ya,this.Nig,this.O0j,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!1,!1,void 0,void 0)}};hc=Object(rb.__decorate)([Object(zc.d)(oc.q),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,Object(oc.af)())],hc);Object(Va.a)(hc,"AutoAdjustColumnsManager",null,[4,660]);var Lb=a(33),kc=a(78),dd=a(437),yb=a(427),Ta=a(216),Hb=a(254),uc=a(264);class Sc{constructor(d){this.$=d}get rZf(){return this.$.workbookContext.FileCoauthorable}get MWb(){return!1}get XQb(){return this.$.ea.K_}get frf(){if(this.XQb)return!0;
for(const d of this.$.ea.Wt)if(!d.SupportsRename)return!1;return!0}}Object(Va.a)(Sc,"EwaCoauthManager",null,[634]);var bc=a(26),vc;let Xc=vc=class extends kc.a{constructor(d,z){super();this.gqa=this.Ije=this.dGg=this.sBd=null;this.Ixa=()=>{var T=this.$.ea.Qq;if(T&&T.WorkbookFileName){var ya=Lb.a.Dz(T.WorkbookFileName),sb=!!$c.a.compare(this.$.workbookContext.WorkbookFileName,T.WorkbookFileName,!1),cc=Pb.EwaSettings.Ra(465)&&!!T.BreadcrumbFolderUrl&&!!$c.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,
T.BreadcrumbFolderUrl,!1);if(sb||cc)this.gqa={},this.gqa.NewFileName=ya,this.gqa.EditDocInClientUrl=T.EditDocInClientUrl,this.gqa.DirectInvokeDAVUrl=T.DirectInvokeDAVUrl,this.gqa.DownloadACopyUrl=T.DownloadACopyUrl,Pb.EwaSettings.Ra(465)&&T.BreadcrumbFolderUrl&&(this.gqa.BreadcrumbFolderName=T.BreadcrumbFolderName,this.gqa.BreadcrumbFolderUrl=T.BreadcrumbFolderUrl),T=wa.AFrameworkApplication.yh.ek(bc.a.kyc,2,ya),this.gqa=null,ia.ULS.shipAssertTag(537154064,0,32===T,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.GRj=(T,ya,sb)=>{this.dGg=ya;this.Ije=sb;this.$.Ma.qh(new Sd.a(1897077126,$d.a.rh,2,3,null),{["newFileName"]:T})};this.FRj=T=>{this.gqa&&T(this.XKf(this.gqa),this.Aw)};this.H1b=T=>{Hb.a(T)||!T.Result?(T=vc.RCi(T),bd.a(this.$).xj.YL([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.Ije(T)):this.dGg(this.XKf(T.Result),this.Aw)};this.KYj=()=>{this.Ije(5)};this.$=d;this.Aw=z;this.$.ea.pz(this.Ixa)}initialize(){wa.AFrameworkApplication.Exc=this.GRj;wa.AFrameworkApplication.lZa=
this.FRj;this.sBd=wa.AFrameworkApplication.FI;wa.AFrameworkApplication.FI=new Sc(this.$)}dispose(){wa.AFrameworkApplication.Exc=null;wa.AFrameworkApplication.lZa=null;this.$.ea.LA(this.Ixa);wa.AFrameworkApplication.FI=this.sBd;this.$=this.sBd=null;super.dispose()}renameFile(d,z){const T=d.newFileName;if(T&&(d=Lb.a.Dz(this.$.workbookContext.WorkbookFileName),$c.a.compare(d,T,!1))){const ya=this.$.pa.ta.Vh();yb.a(this.$.userOperationManager,(sb,cc,Fc)=>{var Wc=this.$.pa.ta;sb=uc.c(sb,this.H1b);cc=uc.b(cc,
this.KYj);const id=Wc.$a(9,ya);id.newFileName=T;return dc.h(Wc,"RenameFile",id,sb,cc,Fc,null,0)},sb=>new Ta.a(134,0,sb),z)}}CVd(){return 32===wa.AFrameworkApplication.yh.gl(bc.a.oma,1)}XKf(d){var z=this.$.workbookContext;wa.AFrameworkApplication.Mfa=d.DownloadACopyUrl;const T=Pb.EwaSettings.Ra(465)&&!!d.BreadcrumbFolderUrl;T&&(wa.AFrameworkApplication.ju.breadcrumbFolderName=d.BreadcrumbFolderName,wa.AFrameworkApplication.ju.breadcrumbFolderUrl=d.BreadcrumbFolderUrl,z.FullDocumentInfo.BreadcrumbFolderUrl=
d.BreadcrumbFolderUrl,z.FullDocumentInfo.BreadcrumbFolderName=d.BreadcrumbFolderName);z.FullDocumentInfo.BreadcrumbDocName=d.NewFileName;dd.d(z,d.NewFileName);z={};z.NewName=d.NewFileName;z.DirectInvokeDavUrl=d.DirectInvokeDAVUrl;z.EditDocInClientUrl=d.EditDocInClientUrl;T&&(z.BreadcrumbFolderName=d.BreadcrumbFolderName,z.BreadcrumbFolderUrl=d.BreadcrumbFolderUrl);z.OperationResult=0;return z}static RCi(d){switch(d.Errors[0].MessageId){case -414480287:d=2;break;case 650565124:d=1;break;case 1636785843:d=
6;break;case -782844485:d=4;break;default:d=5}return d}};Xc=vc=Object(rb.__decorate)([Object(zc.d)(oc.pf),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,Object(oc.nd)())],Xc);Object(Va.a)(Xc,"RenameFileManager",kc.a,[610,4]);var ad=a(208),Id=a(73),ue=a(81),Vd=a(156),Kd=a(116),Yd=a(10),Bc=a(55),Mc;let Fd=Mc=class{constructor(d,z,T){this.da=d;this.W2=z;this.DL=T;this.Uja=new AbortController;this.zEc=Pb.EwaSettings.zEc();this.X4c=Pb.EwaSettings.X4c();this.YIc=Pb.EwaSettings.YIc();this.XIc=
Pb.EwaSettings.XIc();this.BYd=this.aMk();this.Yme=ya=>{void Vd.b(()=>{this.prefetch(ya)},{priority:"background"})};this.rxk=()=>{this.Yme(!1)};this.WLg=()=>{this.Yme(!0);this.da.$.ea.KA(this.WLg)};this.BYd&&this.W2.K2e(this.rxk,this.Uja.signal,!1);if(this.BYd||this.YIc||this.XIc)this.da.$.ea.jn?this.Yme(!0):this.da.$.ea.lw(this.WLg)}prefetch(d){const z=this.da.$.ma;this.kpj(z)&&(d=this.yFi(d),d=this.jdi(d),d.length>Mc.t0b&&(ia.ULS.sendTraceTag(507545357,0,50,`BlockPrefetcher.prefetch Trying to prefetch more than the limit. blocksToPrefetch.length: ${d.length}. numOfPrefetchRequestsPerPrefetchLimit: ${Mc.t0b}`),
d.splice(Mc.t0b)),void this.qxk(d,z))}Q8j(d,z){let T=0;for(let ya=0;ya<d.length;ya++)this.vrk(d[ya],z)&&(T++,this.DL.brk());return T}vrk(d,z){const T=this.da.za,ya=T.rn(z,d);let sb=!1;T.Wn(ya)||(sb=T.wHg(d,z,"PrefetchCachedBufferedBlock"));ia.ULS.sendTraceTag(507569688,0,50,`BlockPrefetcher.requestBlockCacheItem getRange request for block: hashCode ${ya} is pending? ${sb}. isBeyondUsedRange? ${this.da.mGc(d).result}`);return sb}qxk(d,z){const T=this;return Lo(function*(){let ya=0;for(let sb=0;sb<
d.length;sb+=Mc.Qfg){const cc=d.slice(sb,sb+Mc.Qfg);ya+=yield Vd.b(()=>T.Q8j(cc,z),{priority:"background",delay:Mc.yde})}T.fBj(ya)})}kpj(d){const z=this.da.$.ea;(d=z.ki&&d&&Id.i(d)&&!z.isNamedObjectViewMode)||ia.ULS.sendTraceTag(507569687,0,50,"BlockPrefetcher.isPrefetchingBlocksPossible prefetching is not possible");return d}yFi(d){const z=this.da.kj,T=[];if(this.BYd){const ya=ue.f(this.da.kj,this.da.Nu,this.da.CKa(),this.zEc,this.X4c);T.push(...ad.c(ya,this.da.fh,!1))}d&&this.jTi(T,z);return T}jTi(d,
z){let T;this.YIc&&(T=ue.j(this.da.usedRange,this.da.fh.Gm,this.da.fh.Ym,this.da.rowsPerBlock,this.da.columnsPerBlock,1,z),T.bottomRight.X=Math.min(T.bottomRight.X,Mc.t0b),T.bottomRight.Y=Math.min(T.bottomRight.Y,Mc.t0b),d.push(...ad.c(T,this.da.fh,!1)));this.XIc&&(T=this.M0k(z),d.push(...ad.c(T,this.da.fh,!1)))}jdi(d){const z=Yd.a.aFj+1,T=new Set,ya=[];for(const sb of d)d=5*sb.X+sb.Y*z*5+sb.PaneType,T.has(d)||(T.add(d),ya.push(sb));return ya}M0k(d){const z=new Kd.a(1,1,1,1,Yd.a.Rk,Yd.a.Gk),T=new Bc.a(0,
0);return ad.b(z,T,d,this.da.fh,this.da.Wga,this.da.Tja,this.da.$,this.da.XU()).Jk}aMk(){return-1!==this.zEc&&-1!==this.X4c}fBj(d){ia.ULS.sendTraceTag(507569686,0,50,`BlockPrefetcher.logPrefetchEnded prefetchedBlocksCount is ${d}`)}};Fd.t0b=Pb.EwaSettings.bMj();Fd.yde=100;Fd.Qfg=5;Fd=Mc=Object(rb.__decorate)([Object(zc.d)(oc.y),Object(rb.__param)(0,Object(oc.id)()),Object(rb.__param)(1,Object(oc.Rg)()),Object(rb.__param)(2,Object(oc.Sg)())],Fd);Object(Va.a)(Fd,"BlockPrefetcher",null,[]);var Md=a(739),
oe=a(1392),ye=a(1084),te=a(197);class ze{}ze.editCell="Edited";ze.dependentCell="Dependents";Object(Va.a)(ze,"RecalcPriorityGroupType",null,[]);var He=a(1203),ne=a(307);let of=class{constructor(){this.m6=Pb.EwaSettings.HGc()}IId(d,z){d=d.units;var T=z.units;if(d.length!==T.length)return ia.ULS.sendTraceTag(508367051,0,15,"CalcInterfaceAdapter.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;z=[];let ya=
-1;for(let sb=0;sb<d.length;sb++)switch(d[sb].kind){case He.a.blank:z.push(...Array(T[sb].str.length).fill(" "));break;case He.a.string:z.push(d[sb].str);break;case He.a.HAf:z.push("");ya=sb;break;case He.a.general:z.push(T[sb].str);break;default:ia.ULS.sendTraceTag(508367050,0,15,"CalcInterfaceAdapter.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=ya||""===T[ya].str)return null;T={};T.Start=z.slice(0,ya).join("");T.Separator=d[ya].str;T.End=z.slice(ya+1,z.length).join("");return T}OHf(d){switch(d.alignment){case "Center":return 2;
case "Left":return 1;case "Right":return 3;default:return ia.ULS.sendTraceTag(508367049,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}ZGf(d){if(d=d.color){if("String"===Object.getType(d).getName())return te.a.Ou(d);if("Number"===Object.getType(d).getName())return null}else return null;ia.ULS.sendTraceTag(508367048,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}bij(d,z){d=excelOnlineCalc.calc.getCellValueKind(d.rangeDelta.data.value);
switch(d){case "number":case "string":case "boolean":case "Blank":case "Error":return!0;case "Rich":return z.numberOfUnsupportedRichCellTypes++,!1;default:return ia.ULS.shipAssertTag(508367047,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${d}`),!1}}VEf(d){d=excelOnlineCalc.calc.getCellValueKind(d.rangeDelta.data.value);let z=0;switch(d){case "number":z=1;break;case "string":z=2;break;case "boolean":z=3;break;case "Error":z=4;break;case "Blank":z=0;break;default:ia.ULS.shipAssertTag(508367046,
0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${d}`)}return z}S4h(d){const z=d.value;switch(d.type){case 2:return void 0===z||null===z?"":z;case 1:return d=parseFloat(z),isNaN(d)?null:d;case 3:return d=parseFloat(z),isNaN(d)?null:1===d;case 4:return d=parseFloat(z),isNaN(d)?null:excelOnlineCalc.calc.errorValue(d);default:return excelOnlineCalc.calc.blankValue}}hRb(d){"kind"in d&&ia.ULS.shipAssertTag(508367045,0,d.kind!==ye.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");
d=excelOnlineCalc.numfmt.getValueEditOperKind(d);let z=0;switch(d){case 0:case 128:z=0;break;case 1:z=1;break;case 2:z=2;break;case 4:z=3;break;case 8:z=4;break;case 16:case 32:case 64:case 256:ia.ULS.sendTraceTag(508367044,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${d} to a CellValueType`);break;default:ia.ULS.shipAssertTag(508367043,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${d}`)}return z}PKf(d,z){const T=this.iCc(z);var ya=
!(void 0===z.rangeDelta.data.format||null===z.rangeDelta.data.format);ia.ULS.shipAssertTag(508367042,0,0===T||!ya,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${z.priorityGroup}`);d=Math.max(d.cell.qo,0);ya&&(ya=excelOnlineCalc.calc.getCellFormatKind(z.rangeDelta.data.format.format),"number"===ya?d=z.rangeDelta.data.format.format:"string"===ya?ia.ULS.sendTraceTag(508367041,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===
ya?ia.ULS.sendTraceTag(508367040,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):ia.ULS.shipAssertTag(508367011,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return d}iCc(d){if(d.priorityGroup===ze.editCell)return 0;if(d.priorityGroup===ze.dependentCell)return 1;ia.ULS.sendTraceTag(508367010,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}mOi(d){d=this.iCc(d);if(0===d)return 1;if(1===d)return 2;ia.ULS.sendTraceTag(508367009,
0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}QGi(d){return d.rangeDelta.range.column+1}XGi(d){return d.rangeDelta.range.row+1}QKf(d){return this.m6?this.vPd(d.rangeDelta.data.value):d.rangeDelta.data.value.toString()}getCellValueKind(d){return excelOnlineCalc.calc.getCellValueKind(d.rangeDelta.data.value)}gRb(d,z){var T,ya;if(!this.m6)return null===(ya=null===(T=null===d||void 0===d?void 0:d.value)||void 0===T?void 0:T.value)||void 0===ya?void 0:
ya.toString();d=excelOnlineCalc.calc.readOperToCellValue(z,d.value);return this.vPd(d)}vPd(d){if(!Object(ne.c)(d)){if("string"===typeof d)return d;if("number"===typeof d)return String(d);if("boolean"===typeof d)return d?"1":"0";if("kind"in d){if("Error"===d.kind)return String(d.type);if("Blank"===d.kind)return}ia.ULS.shipAssertTag(507646812,0,!1,"CalcInterfaceAdapter.GetValue: unknown cell value type!")}}};of=Object(rb.__decorate)([Object(zc.d)(oc.D),Object(rb.__param)(0,Object(oc.Ub)())],of);Object(Va.a)(of,
"CalcInterfaceAdapter",null,[611]);var lf=a(92),jf=a(231),Cf=a(91);class Gf{}Gf.local="Local";Gf.jZk="Thread";Object(Va.a)(Gf,"RecalcServiceCreateMode",null,[]);var Af=a(190);class Lf{constructor(d){this.YIe=null;this.init(d)}get ima(){return this.YIe}init(d){this.YIe=new jf.a;if(void 0!==d&&null!==d&&void 0!==d.HeadersList&&null!==d.HeadersList&&0<d.HeadersList.length)for(const z of d.HeadersList)this.ima.ga(z.Index,z.Name)}}Object(Va.a)(Lf,"ColHeadersListData",null,[]);var Ef=a(118),Hf=a(161);class $b{constructor(d,
z){this.$bf=d;this.sheetName=z;this.m7b=!1}}Object(Va.a)($b,"CalcBlockInformation",null,[]);class Wb{constructor(d,z,T,ya,sb){this.type=d;this.fullName=z;this.range=T;this.sheetId=ya;this.attributes=sb;this.HO=null}}Object(Va.a)(Wb,"CalcNamedObject",null,[]);class Dc{get Cr(){return this.gYe}constructor(){this.gYe=[];this.uze=[];this.Agb={}}UQg(d,z){this.gYe[d]=z}getSheetIndex(d){for(let z=1;z<this.Cr.length;z++)if($c.a.equals(this.Cr[z].MBa.sheetName,d,!1))return z;return-1}}Object(Va.a)(Dc,"GridCache",
null,[]);var Jf=a(854),Rb=a(648);class Gb{constructor(d){this.MBa=d;this.Rha=new Jf.a(Rb.a.zm());this.RNc=!1}}Object(Va.a)(Gb,"SheetInformation",null,[]);var Cc=a(1168),cb;(function(d){d[d.initialization=0]="initialization";d[d.contentReady=1]="contentReady";d[d.cellEdit=2]="cellEdit"})(cb||(cb={}));Object(Va.b)("UpdateDataTrigger",cb);class pc{constructor(d){this.Bge=null;this.F2d=this.zge=this.iae=!1;this.mee=0;this.eee=this.gee=this.hee=this.fee=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=
this.xx=null;this.BB=this.currentStateId=-1;this.QHa="";this.Ema=null;this.getNameLoc=(z,T)=>this.vIc()?this.Ql.na(this.currentStateId).Cr[0].Rha.lh(T)?(z=excelOnlineCalc.location.nameLoc(z,T),excelOnlineCalc.util.success(z)):excelOnlineCalc.util.success(null):(z=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(z));this.getContainingTable=z=>{if(!this.vIc())return z=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(z);const T=z.range.col,ya=z.range.row;var sb=this.Ql.na(this.currentStateId).Cr[0].Rha,
cc=null;for(const Fc of sb)if(sb=Fc.value,2===sb.type&&$c.a.equals(z.sheet.index.toString(),sb.sheetId,!0)){const Wc=sb.range;T>=Wc.left-1&&T<=Wc.right-1&&ya<=Wc.bottom-1&&ya>=Wc.top-1&&(cc=excelOnlineCalc.location.nameScope(this.documentLoc,sb.sheetId),cc=excelOnlineCalc.location.nameLoc(cc,sb.fullName))}return cc?excelOnlineCalc.util.success(cc):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(z,T)=>{if(!this.vIc()){var ya=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(ya)}ya=
z.name;var sb=this.Ql.na(this.currentStateId).Cr[0].Rha;if(sb.lh(ya)){sb=sb.na(ya);const Fc=sb.range;if(2!==sb.type)return excelOnlineCalc.util.failure(this.Dzd(5));const Wc=sb.HO?sb.HO.ima:null;if(!Wc)return excelOnlineCalc.util.success(null);for(var cc of Wc)if($c.a.equals(cc.value,T,!0))return z=excelOnlineCalc.location.documentLoc(z.scope.document.path,z.scope.document.name),z=excelOnlineCalc.location.sheetIndex(z,sb.sheetId),cc=excelOnlineCalc.location.gridRange(Fc.top-1,cc.key,Fc.bottom-Fc.top+
1,1),cc=excelOnlineCalc.location.sheetGridRange(z,cc),ya=excelOnlineCalc.location.structRefColumnLoc(ya,cc,!!(sb.attributes&16),!!(sb.attributes&8)),excelOnlineCalc.util.success(ya);return Fc.right-Fc.left+1!==Wc.count?(ya=excelOnlineCalc.util.unavailable([17,z,T]),excelOnlineCalc.util.failure(ya)):excelOnlineCalc.util.failure(this.Dzd(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(z,T)=>{if(!this.vIc())return T=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(T);
var ya=this.Ql.na(this.currentStateId).Cr[0].Rha;if(ya.lh(z.name)){var sb=ya.na(z.name);if(2!==sb.type)return excelOnlineCalc.util.failure(this.Dzd(5));ya=!!(sb.attributes&16);const cc=!!(sb.attributes&8),Fc=ya?1:0,Wc=cc?1:0;z=excelOnlineCalc.location.documentLoc(z.scope.document.path,z.scope.document.name);z=excelOnlineCalc.location.sheetIndex(z,sb.sheetId);sb=sb.range;let id={};if(1===T)id=excelOnlineCalc.location.gridRange(sb.top-Fc-1,sb.left-1,sb.bottom+Wc-sb.top+Fc+1,sb.right-sb.left+1);else if(2===
T)id=excelOnlineCalc.location.gridRange(sb.top-1,sb.left-1,sb.bottom-sb.top+1,sb.right-sb.left+1);else if(3===T)if(ya)id=excelOnlineCalc.location.gridRange(sb.top-2,sb.left-1,1,sb.right-sb.left+1);else return excelOnlineCalc.util.success(null);else if(4===T)if(cc)id=excelOnlineCalc.location.gridRange(sb.bottom,sb.left-1,1,sb.right-sb.left+1);else return excelOnlineCalc.util.success(null);T=excelOnlineCalc.location.sheetGridRange(z,id);return excelOnlineCalc.util.success(T)}return excelOnlineCalc.util.success(null)};
this.getDocumentLoc=(z,T)=>{if(($c.a.equals(z,this.documentLoc.path,!0)||!z)&&$c.a.equals(T,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);z=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(z,T)]);return excelOnlineCalc.util.failure(z)};this.getSheetIndex=(z,T)=>{if(!this.Ql.lh(this.currentStateId)||!this.Ql.na(this.currentStateId).Cr)return T=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(T);z=this.Ql.na(this.currentStateId).Cr;
for(let ya=1;ya<z.length;ya++)if($c.a.equals(z[ya].MBa.sheetName,T,!0))return excelOnlineCalc.util.success(z[ya].MBa.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(z,T)=>{if(!this.Ql.lh(this.currentStateId)||!this.Ql.na(this.currentStateId).Cr)return T=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(T);z=this.Ql.na(this.currentStateId).Cr;for(let ya=1;ya<z.length;ya++)if($c.a.equals(z[ya].MBa.sheetId,T,!0))return excelOnlineCalc.util.success(z[ya].MBa.sheetName);
return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.Ung=()=>{this.setNumberFormats()};this.Cj=()=>{ia.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Ql=new jf.a;this.currentStateId=this.BB=-1;this.QHa=
"";this.sib=null;this.zge=!1;this.xx&&this.clearCache()};this.pj=d;this.Ql=new jf.a;this.sib=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.pj.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.NCa()}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.eVc(this.Ung);this.pj&&this.pj.Wr(this.Cj);this.close()}Hac(d){if(!this.xx)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=
zc.a.nh(oc.Cd),!this.instantaneousSupportInformationManager))return ia.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==d&&(this.currentStateId=this.pj.ea.NC,this.currentStateId===Yd.a.Dk&&(this.currentStateId=this.pj.ea.Ek));if(1===d&&this.currentStateId<this.BB)return ia.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.BB} - ignoring update`),!1;
this.$Ck();0!==d&&this.zge||(this.RHk(),this.MEk(),this.BFk(),this.setNumberFormats(),this.instantaneousSupportInformationManager.ypd(this.Ung),this.pj.mr(this.Cj),this.zge=!0);this.Hfk();let z=!1;0===d&&(z=this.ucj());if(0!==d||z)this.WGk()?(this.CHk(d),this.BHk(),this.BB=this.currentStateId,this.WWh()):ia.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==d&&this.resumeRecalc();return!0}evalFormula(d,z,T,ya){if(!this.xx)return ia.ULS.sendTraceTag(537170195,
0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});z=excelOnlineCalc.calc.sheetCellLocation(null!==T&&void 0!==T?T:Id.d(this.pj.sa.ma),z.top-1,z.left-1);d=this.xx.evalFormula(this.pj.ea.Ek,d,z,ya);this.resumeRecalc();return d}jSh(d,z,T,ya){ya=void 0===ya?null:ya;const sb=Id.d(this.pj.sa.ma);let cc=d.cell.xH-1,Fc=d.cell.IK-1;var Wc=cc,id=Fc;let Dd=null;ya&&(Dd=excelOnlineCalc.calc.cellLocation(cc,Fc),cc=ya.top-1,Fc=ya.left-1,Wc=ya.bottom-1,id=ya.right-1);T=this.mBe(d,T,
"SetCell");0>T||(id=pc.xfa("CalculateFormula.cell",sb,cc,Fc,Wc,id),Wc=[],ya=this.PCc(sb),z=excelOnlineCalc.calc.inferredRangeFormulaEdit(id,z,Dd,ya),Wc.push(z),d=(z=this.BPd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",sb,cc,Fc,$c.a.O6e(d.cell.text),T,z.top-1,z.left-1,z.bottom-1,z.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
sb,cc,Fc,$c.a.O6e(d.cell.text),T,"","","",""),ia.ULS.sendTraceTag(537170180,0,50,d),this.xx.editRangeFormulas(T,Wc),this.resumeRecalc())}kSh(d,z){const T=[];var ya=Id.d(this.pj.sa.ma),sb=this.PCc(ya);z=this.mBe(d[0].Hfa,z,"SetCellBatched");if(0>z)return!1;for(var cc of d){var Fc=cc.Hfa.cell,Wc=Fc.xH-1;Fc=Fc.IK-1;Wc=pc.xfa("CalculateFormulaBatched.cell",ya,Wc,Fc,Wc,Fc);Wc=excelOnlineCalc.calc.inferredRangeFormulaEdit(Wc,cc.editText,null,sb);T.push(Wc)}sb=this.BPd();cc=d[0].Hfa.cell.xH-1;Wc=d[0].Hfa.cell.IK-
1;Fc=d[d.length-1].Hfa.cell.xH-1;d=d[d.length-1].Hfa.cell.IK-1;ya=sb?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",ya,cc,Wc,Fc,d,z,sb.top-1,sb.left-1,sb.bottom-1,sb.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",ya,cc,Wc,Fc,d,z,"","","","");ia.ULS.sendTraceTag(508932947,0,50,ya);this.xx.editRangeFormulas(z,
T);this.resumeRecalc();return!0}q5(d,z,T,ya,sb){if(!this.xx)return ia.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!T||!z)return ia.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!T}, outputColumnRange null: ${!z}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");ia.ULS.shipAssertTag(537170178,0,T.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const cc=Id.d(this.pj.sa.ma),Fc=this.PCc(cc);let Wc=null;if(d){Wc=[];for(const Dd of d)if(Dd.column!==T.left){d=Dd.row-1;var id=Dd.column-1;d=pc.xfa("EvalFormulaRangeOnClone.cell",cc,d,id,d,id);id=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?Ic(Dd.Ln,Dd.formulaBarText,Dd.qo):excelOnlineCalc.calc.valueCellData(Dd.text,Dd.text,Dd.qo,null);Wc.push(excelOnlineCalc.calc.rangeWrite(d,id))}}T=excelOnlineCalc.calc.cellLocation(T.top-1,T.left-1);z=pc.xfa("EvalFormulaRangeOnClone.outputColumnRange",
cc,z.top-1,z.left-1,z.bottom-1,z.right-1);sb?(ya=[excelOnlineCalc.calc.inferredRangeFormulaEdit(z,ya,T,Fc)],sb=this.xx.evalOnClonedModel(Wc,ya,sb)):(ya=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(z,ya,T,Fc)],sb=this.xx.evalOnClonedModel(Wc,ya,sb));this.resumeRecalc();return sb}localizeEnglishFormula(d,z,T){z=excelOnlineCalc.calc.sheetCellLocation(Id.d(z),T.top-1,T.left-1);return this.xx.localizeEnglishFormula(d,z)}Gmf(d){let z=null;try{if(d)if(this.QHa=cd.f(this.pj).za.IJa(d),this.currentStateId=
d.DQa,this.currentStateId<this.BB||this.currentStateId===Yd.a.Dk)ia.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.QHa} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.BB}`);else{if(this.zcj(),1===d.ar.PaneType&&this.fal(d.ma),!this.XMh())if(z=this.pj.Eh.Li("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.QHa} StateId:${this.currentStateId}`),this.sib=this.S0(d.ma.sheetName))if(cd.f(this.pj).za.$u.oOb(d.Pi)){var T=
d.ql;if(T){var ya=T.getCalcBlockModel();if(ya)if(this.PMh(ya)){this.Ql.na(this.currentStateId).Agb[this.QHa]=new $b(ya,d.ma.sheetName);var sb=d.Pj;sb?this.Qyh(sb.NamedObjects):ia.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else ia.ULS.sendTraceTag(509117971,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else ia.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else ia.ULS.sendTraceTag(537170146,
0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.QHa}`)}else ia.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");else{const cc=!!(this.pj.Ij&32),Fc=this.Ql.lh(this.currentStateId)&&this.Ql.na(this.currentStateId).Cr?this.Ql.na(this.currentStateId).Cr.length:0;ia.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${Fc}, scratchPad:${cc}, sheetNameLength:${d.ma.sheetName?
d.ma.sheetName.length:-1} Hash:${d.ma.hash}`)}}else ia.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{z&&z.stop()}}O_a(d){var z;if(!this.Ql.lh(this.currentStateId))return ia.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const T=null===(z=this.Ql.na(this.currentStateId))||void 0===z?void 0:z.Cr;if(!T||!T[0])return null;z=T[0].Rha;if(!z||!z.lh(d.name))return ia.ULS.sendTraceTag(509646789,
0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==z}`),null;d=z.na(d.name);if(!d||!d.HO)return null;z=[];for(const ya of d.HO.ima)z.push(ya.value);return z}lSh(d,z,T){var ya=cd.f(this.pj).zh(d[0].targetRange);z=this.mBe(ya,z,"CopyPaste");if(0>z)ia.ULS.sendTraceTag(508065925,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPasteBatched(). Revision not valid. targetRevision:${z}.`);else{ya=[];for(const sb of d)d=this.kUi(z,
T,sb.sourceRange,sb.targetRange),ya.push(d);this.xx.editRangePaste(z,ya);this.resumeRecalc()}}kUi(d,z,T,ya){const sb=Id.d(this.pj.sa.ma);z=z?Id.d(this.pj.sa.getItemByName(z)):sb;const cc=this.PCc(sb);T=pc.xfa("getRangePasteEdit.srcRange",z,T.top-1,T.left-1,T.bottom-1,T.right-1);ya=pc.xfa("getRangePasteEdit.targetRange",sb,ya.top-1,ya.left-1,ya.bottom-1,ya.right-1);ya=excelOnlineCalc.calc.copyPasteRangePasteEdit(ya,T,cc);d=cc?String.format("CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",
z,sb,d,cc.row,cc.column,cc.lastRow,cc.lastColumn):String.format("CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",sb,d,"","","","");ia.ULS.sendTraceTag(537170142,0,50,d);return ya}PCc(d){const z=this.BPd();let T=null;z?T=pc.xfa("GetViewport.viewport",d,z.top-1,z.left-1,z.bottom-1,z.right-1):ia.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return T}BPd(){const d=cd.f(this.pj);
let z=d.Dp;if(cd.f(this.pj).fh.pp){z=d.sl(1).Dp;if(Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!z)return ia.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;z.Nqa(1,1);z.Nqa(3,1)}return z}mBe(d,z,T){let ya;if(!this.xx||!d)return ia.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.xx}, modifiedCell is null:${!d}, operation:${T}`),-1;
const sb=d.cell.xH-1,cc=d.cell.IK-1;if(d.cell.VF){if(ya=d.cell.VF.fpc,ya===Yd.a.Dk)return ia.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${d.cell.VF.Pi}, operation:${T}`),-1}else return ia.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${d.cell.xH},${d.cell.IK}), operation:${T}`),-1;if(ya<this.BB)return ia.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${sb},${cc}) - blockRevision:${ya} < lastUpdatedStateId:${this.BB}, operation:${T}`),
-1;if(ya<this.currentStateId)return ia.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${sb},${cc}) - blockRevision:${ya} < currentStateId:${this.currentStateId}, operation:${T}`),-1;z&&!this.iae&&(this.xx.setOnRecalcResults(z),this.iae=!0);return this.c6k()&&!this.Hac(2)?(ia.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${T}`),-1):ya}getFormulaBarText(d,z,T){return z&&z.startsWith("'")?
z:d.cell.formulaBarText||T.toString()}e9h(d,z,T){let ya=null;this.sib=this.S0(T);if(this.Pcf()&&this.Ql.na(this.BB).Agb){const Wc=this.Ql.na(this.BB).Agb[d];if(null===Wc||void 0===Wc?0:Wc.m7b)ya=Wc.$bf}T=this.thj(ya,z,T);const {eMj:sb,numberOfNonEmptyCells:cc,cMj:Fc}=this.B_h(ya,z,T);ia.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${d} StateId:${this.currentStateId} number of formulas ${sb}, number of non-empty cells ${cc}, number of cells ${Fc}`)}thj(d,
z,T){let ya=!1;const sb=pc.EEf(z);if(d){const cc=pc.EEf(d);$c.a.equals(cc,sb,!1)&&(ya=!0)}ya?this.yzh(d,this.BB,T):this.Azh(z,T);return ya}Pcf(){let d=!1;this.xx&&-1!==this.BB&&(d=this.xx.stateIdAvailable(this.BB));return d&&this.Ql.lh(this.BB)&&this.BB<this.currentStateId}B_h(d,z,T){let ya=0,sb=0,cc=0,Fc,Wc;for(z.reset();Fc=z.getNextCell();)cc++,(Fc.value||Fc.formula)&&sb++,Hf.f(Fc.formula)&&ya++,(Wc=T?d.getCell(Fc.row,Fc.col):null)?this.v_h(z,Fc,Wc):this.zzh(z,Fc);if(T)for(d.reset();Wc=d.getNextCell();)(Fc=
z.getCell(Wc.row,Wc.col))||this.X2e(d,Wc);return{eMj:ya,numberOfNonEmptyCells:sb,cMj:cc}}BFk(){this.xx.setOnUpdateRequest(()=>{})}AFk(){this.xx.setOnUnresponsive((d,z,T,ya)=>{this.Q0j(d,z,T,ya)})}Q0j(d,z,T,ya){ia.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${d}, waitTime:${z}, timeoutCount:${T}, hasBeenClosed:${ya}.`);ya&&(this.Lsk(),this.NCa())}Lsk(){this.Cj(null,null);this.F2d=this.iae=!1;this.mee=0;this.eee=this.gee=this.hee=this.fee=
-1}close(){this.xx.close()}clearCache(){this.xx.clearCache()}resumeRecalc(){this.xx.resumeRecalc()}MEk(){this.xx.setA1ReferenceStyle(!0)}Hfk(){if(this.instantaneousSupportInformationManager){var d=this.instantaneousSupportInformationManager.Uej;const T=this.instantaneousSupportInformationManager.Xej,ya=this.instantaneousSupportInformationManager.Wej,sb=this.instantaneousSupportInformationManager.Vej;var z=!1;d!==this.fee&&(z=!0,this.fee=d);T!==this.hee&&(z=!0,this.hee=T);ya!==this.gee&&(z=!0,this.gee=
ya);sb!==this.eee&&(z=!0,this.eee=sb);const cc=[];Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(z=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",null),cc.push(z),z=!0);Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(z=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),cc.push(z),z=!0);Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(z=
excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),cc.push(z),z=!0);z&&(d=excelOnlineCalc.calc.recalcServiceConfig(null,d,null,T,null,null,null,ya,cc,sb),this.xx.reconfigure(d))}}CHk(d){let z=null;if(this.Ql.lh(this.currentStateId))try{this.Ema=[],z=this.pj.Eh.Li("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${cb[d]}`),lf.a.forEach(this.Ql.na(this.currentStateId).Agb,(T,ya)=>{ya.m7b||(this.e9h(T,ya.$bf,ya.sheetName),ya.m7b=!0)},
null),this.xx.updateRanges(this.currentStateId,this.Ema)}finally{z&&z.stop()}else ia.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}BHk(){const d=[],z=this.Pcf();var T=z&&this.Ql.na(this.BB).Cr&&this.Ql.na(this.BB).Cr[0]&&this.Ql.na(this.BB).Cr[0].RNc?this.Ql.na(this.BB).Cr[0].Rha:null;this.Nhf(T,this.Ql.na(this.currentStateId).Cr[0].Rha,null,this.BB,d);this.Ql.na(this.currentStateId).Cr[0].RNc=!0;for(let ya=1;ya<this.Ql.na(this.currentStateId).Cr.length;ya++)T=
-1,z&&this.Ql.na(this.BB).Cr&&(T=this.DOd(this.Ql.na(this.currentStateId).Cr[ya].MBa.sheetName,this.BB)),T=-1!==T&&this.Ql.na(this.BB).Cr[T].RNc?this.Ql.na(this.BB).Cr[T].Rha:null,this.Nhf(T,this.Ql.na(this.currentStateId).Cr[ya].Rha,this.Ql.na(this.currentStateId).Cr[ya].MBa.sheetId,this.BB,d),this.Ql.na(this.currentStateId).Cr[ya].RNc=!0;this.xx.updateNamedObjects(this.currentStateId,d)}Nhf(d,z,T,ya,sb){if(void 0!==T&&null!==T){var cc=excelOnlineCalc.calc.undefinedNamesWrite(T);sb.push(cc)}if(d){var Fc=
!1;cc=[];var Wc=[];if(z)for(const Dd of z){const ee=Dd.value;if(d.lh(Dd.key)){var id=d.na(Dd.key);pc.pKj(id,ee)?Fc=!0:(id=excelOnlineCalc.calc.namedObject(Dd.key,null),cc.push(id),pc.uod(Dd.key,ee,Wc))}else pc.uod(Dd.key,ee,Wc)}for(const Dd of d)z&&z.lh(Dd.key)||(d=excelOnlineCalc.calc.namedObject(Dd.key,null),cc.push(d));Fc&&(z=excelOnlineCalc.calc.namedObjectsPromote(T,ya),sb.push(z));0<cc.length&&(z=excelOnlineCalc.calc.namedObjectsWrite(T,cc),sb.push(z));0<Wc.length&&(T=excelOnlineCalc.calc.namedObjectsWrite(T,
Wc),sb.push(T))}else if(z){ya=[];for(Wc of z)pc.uod(Wc.key,Wc.value,ya);0<ya.length&&(T=excelOnlineCalc.calc.namedObjectsWrite(T,ya),sb.push(T))}}XMh(){const d=this.Ql.na(this.currentStateId).Agb[this.QHa];return d?(ia.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.QHa} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.BB}. sentToRecalcEngine: ${null===d||void 0===d?void 0:d.m7b}`),!0):!1}PMh(d){return 1===d.getColumnNumbers().length&&
d.getColumnNumbers()[0]===pc.s5d+1?!1:!0}ucj(){let d=!1;cd.f(this.pj).za.Dkb(z=>{z.state&1&&this.pj.ea.Ek===z.wk.Revision&&(this.Gmf(z),d=!0)});return d}qkf(d,z){var T=d.getRowNumbers(),ya=d.getColumnNumbers();d=T[0]-1;T=T[T.length-1]-1;const sb=ya[0]-1;ya=ya[ya.length-1]-1;z=this.S0(z);if(!z){const cc=this.Ql.lh(this.currentStateId)&&this.Ql.na(this.currentStateId).Cr?this.Ql.na(this.currentStateId).Cr.length:0;ia.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${cc}`)}return pc.xfa("CreateBlockRangeLocation",
z,d,sb,T,ya)}yzh(d,z,T){if(T=this.qkf(d,T)){var ya=pc.jtc(d.getRowNumbers());d=pc.jtc(d.getColumnNumbers());z=excelOnlineCalc.calc.rangePromote(T,z,ya,d);this.Ema[this.Ema.length]=z}}Azh(d,z){if(z=this.qkf(d,z)){var T=pc.jtc(d.getRowNumbers());d=pc.jtc(d.getColumnNumbers());d=excelOnlineCalc.calc.rangeWrite(z,null,T,d);this.Ema[this.Ema.length]=d}}v_h(d,z,T){let ya=null,sb=0,cc=0;switch(z.valueType){case 2:ya=this.wPd(z);var Fc=this.wPd(T);Fc=$c.a.equals(Fc,ya,!1);break;case 1:null===z.value&&null===
T.value?Fc=!0:(sb=parseFloat(z.value),Fc=parseFloat(T.value)===sb);break;default:null===z.value&&null===T.value?Fc=!0:(cc=parseFloat(z.value),Fc=cc===parseFloat(T.value))}Fc&&z.valueType===T.valueType&&z.ifmt===T.ifmt&&z.formulaType===T.formulaType&&$c.a.equals(T.formula,z.formula,!1)||(void 0!==z.formula&&null!==z.formula||void 0!==z.value&&null!==z.value||void 0!==z.text&&null!==z.text||0!==z.valueType?this.nmc(d,z,ya,sb,cc):this.X2e(d,z))}Qyh(d){if(this.pj.$h&&this.pj.$h.items)for(let cc=0;cc<
this.pj.$h.count;cc++){var z=this.pj.$h.items[cc];if(2!==z.type&&3!==z.type)continue;var T=0,ya=z.name,sb=ya.lastIndexOf("!");if(0<sb){T=ya.substr(0,sb);"'"===T.charAt(0)&&(T=T.substr(1,T.length-2));T=this.DOd(T,this.currentStateId);if(-1===T){ya=this.Ql.lh(this.currentStateId)&&this.Ql.na(this.currentStateId).Cr?this.Ql.na(this.currentStateId).Cr.length:0;ia.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ya}`);continue}ya=
ya.substr(sb+1)}sb=this.Ql.na(this.currentStateId).Cr[T].Rha;let Fc=z.usedRange;2===z.type&&(Fc=Af.a(z));if(sb.lh(ya)){if(T=sb.na(ya),T.range=Fc,T.attributes=z.attributes,2===T.type)if(ya=z.E8,!T.HO)T.HO=new Lf(ya);else if(ya)for(const Wc of ya.HeadersList)T.HO.ima.ga(Wc.Index,Wc.Name)}else if(T=this.S0(z.sheetName)){T=new Wb(z.type,z.name,Fc,T,z.attributes);if(2===T.type)if(z.E8)T.HO=new Lf(z.E8);else if(z=pc.Ewi(z.name,d))T.HO=new Lf(z.ColHeadersList);sb.ga(ya,T)}else ya=this.Ql.lh(this.currentStateId)&&
this.Ql.na(this.currentStateId).Cr?this.Ql.na(this.currentStateId).Cr.length:0,ia.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ya}`)}}nmc(d,z,T,ya,sb){var cc=d.getRowNumbers()[z.row]-1;d=d.getColumnNumbers()[z.col]-1;cc=pc.xfa("AddRangeUpdateCommand",this.sib,cc,d,cc,d);d=null;let Fc=z.formula||z.text;const Wc=excelOnlineCalc.calc.blankValue;let id=null;void 0!==z.text&&null!==z.text||void 0!==z.value&&null!==z.value||(T=
"",id="This cell contains blanks only",0===z.formulaType&&(Fc=""));switch(z.valueType){case 2:null!==T&&(0===z.formulaType&&(d=excelOnlineCalc.calc.valueCellData(Fc,T,z.ifmt,id)),1===z.formulaType&&(d=excelOnlineCalc.calc.cellFormulaCellData(Fc,T,z.ifmt,id)),2===z.formulaType&&(d=excelOnlineCalc.calc.valueCellData("",Wc,0,"This cell is a part of an array")));break;case 1:isNaN(ya)?ia.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${z.row},${z.col}) invalid numeric value`):
(0===z.formulaType&&(d=excelOnlineCalc.calc.valueCellData(Fc,ya,z.ifmt,null)),1===z.formulaType&&(d=excelOnlineCalc.calc.cellFormulaCellData(Fc,ya,z.ifmt,null)),2===z.formulaType&&(d=excelOnlineCalc.calc.valueCellData("",Wc,0,"This cell is a part of an array")));break;case 3:isNaN(sb)?ia.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${z.row},${z.col}) invalid boolean value`):(T=1===sb?!0:!1,0===z.formulaType&&(d=excelOnlineCalc.calc.valueCellData(Fc,T,z.ifmt,null)),
1===z.formulaType&&(d=excelOnlineCalc.calc.cellFormulaCellData(Fc,T,z.ifmt,null)),2===z.formulaType&&(d=excelOnlineCalc.calc.valueCellData("",Wc,0,"This cell is a part of an array")));break;case 4:isNaN(sb)?ia.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${z.row},${z.col}) invalid error value`):(T=excelOnlineCalc.calc.errorValue(sb),0===z.formulaType&&(d=excelOnlineCalc.calc.valueCellData(Fc,T,z.ifmt,null)),1===z.formulaType&&(d=excelOnlineCalc.calc.cellFormulaCellData(Fc,
T,z.ifmt,null)),2===z.formulaType&&(d=excelOnlineCalc.calc.valueCellData("",Wc,0,"This cell is a part of an array")));break;default:d=excelOnlineCalc.calc.valueCellData("",Wc,z.ifmt,null)}d&&(z=excelOnlineCalc.calc.rangeWrite(cc,d,null,null),this.Ema[this.Ema.length]=z)}zzh(d,z){switch(z.valueType){case 2:this.nmc(d,z,this.wPd(z),null,0);break;case 1:this.nmc(d,z,null,parseFloat(z.value),0);break;default:this.nmc(d,z,null,null,parseFloat(z.value))}}X2e(d,z){var T=d.getRowNumbers()[z.row]-1;d=d.getColumnNumbers()[z.col]-
1;T=pc.xfa("AddRangeUpdateCommandEmptyCell",this.sib,T,d,T,d);z=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,z.ifmt,null);z=excelOnlineCalc.calc.rangeWrite(T,z,null,null);this.Ema[this.Ema.length]=z}S0(d){d=this.DOd(d,this.currentStateId);return 0<d?this.Ql.na(this.currentStateId).Cr[d].MBa.sheetId:null}DOd(d,z){if(!this.Ql.lh(z))return ia.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${z} does not exist in GridCache`),-1;const T=this.Ql.na(z);
return T.Cr?T.getSheetIndex(d):(ia.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${z}`),-1)}WGk(){if(!this.Ql.lh(this.currentStateId)||!this.Ql.na(this.currentStateId).Cr.length)return ia.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const d=[];for(let z=1;z<this.Ql.na(this.currentStateId).Cr.length;z++){const T=
this.Ql.na(this.currentStateId).Cr[z];T&&d.push(T.MBa)}this.xx.updateSheetNames(this.currentStateId,d);this.xx.updateUnusedCells(this.currentStateId,this.Ql.na(this.currentStateId).uze);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var d=[];for(const z of this.instantaneousSupportInformationManager.lNa){const T=excelOnlineCalc.calc.numberFormat(z.IfmtIndex,z.FormatString,z.Builtin);d.push(T)}this.xx.setNumberFormats(d,!0)}}$Ck(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.zk){var d=this.xcj();if(!this.F2d||d)this.instantaneousSupportInformationManager.zk.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.zk.TrueValueString),this.instantaneousSupportInformationManager.zk.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.zk.FalseValueString),d=Cc.CalcHelper.ulf(this.instantaneousSupportInformationManager,d),this.xx.setLocale(d),this.F2d=!0}}RHk(){var d=null;if(void 0!==this.pj.workbookContext.TimeZoneInformation&&
null!==this.pj.workbookContext.TimeZoneInformation){d=null;this.pj.workbookContext.TimeZoneInformation.StandardDate.Month&&(d=excelOnlineCalc.date.dateTime(this.pj.workbookContext.TimeZoneInformation.StandardDate.Year,this.pj.workbookContext.TimeZoneInformation.StandardDate.Month,this.pj.workbookContext.TimeZoneInformation.StandardDate.Day,this.pj.workbookContext.TimeZoneInformation.StandardDate.Hour,this.pj.workbookContext.TimeZoneInformation.StandardDate.Minute,this.pj.workbookContext.TimeZoneInformation.StandardDate.Second,
this.pj.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.pj.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let z=null;this.pj.workbookContext.TimeZoneInformation.DaylightDate.Month&&(z=excelOnlineCalc.date.dateTime(this.pj.workbookContext.TimeZoneInformation.DaylightDate.Year,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Month,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Day,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Minute,
this.pj.workbookContext.TimeZoneInformation.DaylightDate.Second,this.pj.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.pj.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));d=excelOnlineCalc.date.tzData(this.pj.workbookContext.TimeZoneInformation.Bias,d,this.pj.workbookContext.TimeZoneInformation.StandardBias,z,this.pj.workbookContext.TimeZoneInformation.DaylightBias)}else ia.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");
d=excelOnlineCalc.calc.workbookProps(this.pj.workbookContext.F1904,this.pj.workbookContext.FDateCompatibility,d);this.xx.setWorkbookProps(d)}NCa(){const d=Pb.EwaSettings.Ra(570)?Gf.local:Gf.jZk,[z,T]=[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()];this.Bge=Cf.d(excelOnlineCalc.calc.createRecalcService(d,z,T));this.Bge.continueWith(ya=>{ya.exception?ia.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${ya.exception.toString()}`):
(ia.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.xx=this.Bge.result)?this.Hac(0)?this.AFk():ia.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):ia.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}xcj(){const d=this.instantaneousSupportInformationManager.Qwa;if(!d||this.mee===d.length)return null;this.mee=d.length;return Cc.CalcHelper.Zkf(d)}zcj(){if(!(this.Ql.lh(this.currentStateId)&&
0<this.Ql.na(this.currentStateId).Cr.length)){this.Ql.ga(this.currentStateId,new Dc);this.Ql.na(this.currentStateId).UQg(0,new Gb(null));var d=this.pj.sa;for(let ya=0;ya<d.count;ya++){var z=Object(Db.a)(Ef.a,d.getItem(ya));if(z){void 0!==z.sheetId&&null!==z.sheetId&&void 0!==z.name&&null!==z.name&&z.sheetId.length&&z.sheetName.length||ia.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${ya} Id:${z.sheetId} Hash:${z.hash} NameLength:${z.name?z.name.length:
-1}`);var T=excelOnlineCalc.calc.sheetName(z.sheetId,z.name);this.Ql.na(this.currentStateId).UQg(ya+1,new Gb(T));T=z.usedRange.jF();T=excelOnlineCalc.calc.rangeLocation(0,0,T.LastRow,T.LastColumn);z=excelOnlineCalc.calc.unusedCellsUpdate(z.sheetId,T);this.Ql.na(this.currentStateId).uze.push(z)}else ia.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${ya}`)}}}fal(d){if(d instanceof Ef.a){var z=d.usedRange.jF();
z=excelOnlineCalc.calc.rangeLocation(0,0,z.LastRow,z.LastColumn);z=excelOnlineCalc.calc.unusedCellsUpdate(d.sheetId,z);this.Ql.na(this.currentStateId).uze[d.index]=z}}WWh(){for(const d of this.Ql)d.key<this.BB&&this.Ql.remove(d.key)}wPd(d){d=d.value||d.text;if(void 0===d||null===d)d="";return d}c6k(){if(!this.Ql.lh(this.currentStateId))return!1;let d=!1;lf.a.forEach(this.Ql.na(this.currentStateId).Agb,(z,T)=>{T.m7b||(d=!0)},null);return d}Dzd(d){const z={};z.reason=d;z.kind=1;return z}vIc(){return this.Ql.lh(this.currentStateId)&&
this.Ql.na(this.currentStateId).Cr&&this.Ql.na(this.currentStateId).Cr[0]&&this.Ql.na(this.currentStateId).Cr[0].Rha?!0:!1}static a5h(d){const z=[];if(null===d||void 0===d?0:d.ima)for(const T of d.ima)d=excelOnlineCalc.calc.columnData(T.key,T.value),z.push(d);return z}static pKj(d,z){if(d.type!==z.type||d.attributes!==z.attributes||!$c.a.equals(d.fullName,z.fullName,!1)||!d.range.equals(z.range))return!1;if(!d.HO&&!z.HO)return!0;if(!d.HO||!z.HO||d.HO.ima.count!==z.HO.ima.count)return!1;for(const T of d.HO.ima){let ya;
if(d=T.value)d=z.HO.ima.wj(T.key),{value:ya}=d,d=d.returnValue;if(!(d&&ya&&$c.a.equals(T.value,ya,!1)))return!1}return!0}static uod(d,z,T){var ya=pc.xfa("NamedObject",z.sheetId,z.range.top-1,z.range.left-1,z.range.bottom-1,z.range.right-1);if(2===z.type){const sb=!!(z.attributes&16),cc=!!(z.attributes&8);z=pc.a5h(z.HO);ya=excelOnlineCalc.calc.namedTableData(ya,sb,cc,z);d=excelOnlineCalc.calc.namedObject(d,ya)}else ya=excelOnlineCalc.calc.namedRangeData(ya),d=excelOnlineCalc.calc.namedObject(d,ya);
T.push(d)}static EEf(d){const z=Sys.Serialization.JavaScriptSerializer.serialize(d.getRowNumbers());d=Sys.Serialization.JavaScriptSerializer.serialize(d.getColumnNumbers());return z+d}static jtc(d){let z=null;if(1<d.length)for(let T=1;T<d.length;T++){let ya=0;for(;d[T-1]+1+ya<d[T];)z=z||[],z.push(d[T-1]+ya),ya++}return z}static Ewi(d,z){if(!z)return null;for(let T=0,ya=z.length;T<ya;++T)if($c.a.equals(d,z[T].Name,!1))return z[T];return null}static xfa(d,z,T,ya,sb,cc){const Fc=(Wc,id,Dd,ee)=>{(0>Dd||
Dd>=ee)&&ia.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${Wc} invalid ${id}:${Dd}`)};void 0!==z&&null!==z||ia.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${d} sheetId is null`);Fc(d,"top",T,pc.mcg);Fc(d,"left",ya,pc.s5d);Fc(d,"bottom",sb,pc.mcg);Fc(d,"right",cc,pc.s5d);return excelOnlineCalc.calc.sheetRangeLocation(z,T,ya,sb,cc)}}pc.mcg=1048576;pc.s5d=16384;Object(Va.a)(pc,"CalcAsyncEngine",null,[4]);const Ic=(d,z,
T)=>{switch(d.type){case 2:return excelOnlineCalc.calc.valueCellData(z,d.value,T,null);case 1:return excelOnlineCalc.calc.valueCellData(z,parseFloat(d.value),T,null);case 3:return excelOnlineCalc.calc.valueCellData(z,1===parseFloat(d.value),T,null);case 4:return excelOnlineCalc.calc.valueCellData(z,excelOnlineCalc.calc.errorValue(parseFloat(d.value)),T,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,T,null)}};class rd{constructor(){this.jya=this.kya=this.eoa=
this.foa=this.r2a=!1}}Object(Va.a)(rd,"AbsoluteRelativeReferenceInfo",null,[]);var Rd=a(27);class va{}va.awg="#";Object(Va.a)(va,"Operators",null,[]);var Bb=a(1204);class Ac{}Ac.sheet="Sheet";Ac.sheetRange="SheetRange";Ac.document="Document";Ac.y9i="Ident";Object(Va.a)(Ac,"TraverseFormulaQualifierTypes",null,[]);var Nc=a(1085),hd=a(1001),qd=a(46),je=a(67),Ie=a(76),Oe=a(324);class Vb extends Sys.EventArgs{constructor(d){super();this.Bq=d}}Object(Va.a)(Vb,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,
[]);var fd=a(1399),Qd;let me=Qd=class extends sa.a{constructor(d,z){super();this.ty=z;this.sz=null;this.Qbc=!1;this.Hle=this.instantaneousSupportInformationManager=this.Inc=this.rAa=null;this.b8d=new Map;this.qTe=null;this.JPc=T=>{ia.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");T.eVc(this.JPc);T.Qwa.length?this.oPc(T,Sys.EventArgs.Empty):(ia.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),T.j4e(this.oPc))};
this.oPc=T=>{ia.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");T.Wie(this.oPc);this.F3k(T)};this.onContentReady=()=>{this.sz&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.GFc||je.Task.delay(0).continueWith(()=>{this.sz.Hac(1)?this.raiseEvent(Qd.Cwd):ia.ULS.sendTraceTag(508368722,0,15,"CalcManager.onContentReady: calc engine failed to update in the calc model")},0,null,Ie.a.current))};this.Bhg=(T,ya)=>{this.sz&&(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.GFc||this.sz.Gmf(ya.mj.block))};ia.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.sGc=!1;this.th=d;this.lE=cd.f(d);this.V8c=null;this.da.dA(this.onContentReady);this.da.za.Eeb(this.Bhg);this.VUf=new Promise((T,ya)=>{this.htk=T;this.Ohe=ya});void zc.a.sj(oc.Cd).then(T=>{T.zk?(ia.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.JPc(T,Sys.EventArgs.Empty)):(ia.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),
T.ypd(this.JPc))});this.YLa=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8373394_setCellEstimationPrefetch");this.KVd=oc.Lf.Aa();this.YLa&&!this.KVd&&(this.Mjc=new fd.SetCellEstimationPrefetcher(this,this.lE,z))}bpd(d){this.addHandler(Qd.hsf,d)}vfg(d){this.raiseEvent(Qd.hsf,new Vb(d))}WAh(d){this.addHandler(Qd.xnd,d)}tlk(d){this.removeHandler(Qd.xnd,d)}gOc(d){this.raiseEvent(Qd.xnd,d)}Dmc(d){this.addHandler(Qd.Cwd,d)}Kie(d){this.removeHandler(Qd.Cwd,d)}get PPa(){return this.Mjc}get w4(){return this.V8c}get da(){return this.lE}get $(){return this.th}get mN(){return this.qTe}get localeInfo(){return this.w4?
this.w4.config.localeInfo:null}get config(){var d;return null===(d=this.w4)||void 0===d?void 0:d.config}dispose(){ia.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");void zc.a.sj(oc.Cd).then(d=>{d.eVc(this.JPc);d.Wie(this.oPc)});this.da&&(this.da.$E(this.onContentReady),this.da.za&&this.da.za.a5b(this.Bhg),this.lE=null);this.V8c=null;this.sGc=!1;this.YLa&&(nb.a.dh(this.PPa),this.Mjc=null)}mSh(d,z,T,ya){this.sz&&this.sz.jSh(d,z,T,void 0===ya?null:ya)}nSh(d,z){return this.sz?this.sz.kSh(d,
z):!1}evalFormula(d,z,T,ya){return this.sz?this.sz.evalFormula(d,z,T,ya):Promise.reject("calc engine not initialized")}q5(d,z,T,ya,sb){return this.sz?this.sz.q5(d,z,T,ya,sb):Promise.reject("CalcEngine is null")}localizeEnglishFormula(d,z,T){return this.sz?this.sz.localizeEnglishFormula(d,z,T):Promise.resolve(void 0)}O_a(d){if(!d)return ia.ULS.sendTraceTag(509649312,0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.sz)return null;ia.ULS.shipAssertTag(537170059,0,2===d.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");
return this.sz.O_a(d)}d6e(d,z){if(!z||2!==d.type)return!1;d=Af.a(d);return d.right-d.left+1===z.length}vGd(d,z){if(!this.rAa)return this.Qbc||ia.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var T=this.Fsc(Rd.Range.vi(1,1));T=this.rAa.parseFormula(excelOnlineCalc.parse.parseLocals(1,T.range),d);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(T))return ia.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),
null;try{const ya=null!==z&&void 0!==z?z:this.da.ha.qa.activeCell,sb=excelOnlineCalc.location.gridCell(ya.top-1,ya.left-1),cc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Fc=excelOnlineCalc.location.sheetIndex(cc,this.$.sa.ma.sheetId),Wc=this.y9h(sb,Fc);this.Hle||(this.Hle=excelOnlineCalc.util.createResolver(this.x9h()));const id=excelOnlineCalc.parse.parseResultHelper.extractReferences(T,this.w4.config.localeInfo,!1,Wc,this.Hle);Pb.EwaSettings.Ra(101)&&
this.S9k(id,d);return id}catch(ya){return ia.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${ya.message}`),null}}N_d(d){if(!this.rAa||!this.Inc)return this.Qbc||ia.ULS.sendTraceTag(507912481,0,15,this.rAa||this.Inc?this.rAa?"CalcManager.isValidReference - analyzer not initialized":"CalcManager.isValidReference - parser not initialized":"CalcManager.isValidReference - parser and analyzer not initialized"),null;var z=this.Fsc(Rd.Range.vi(1,1));d=this.rAa.parseFormula(excelOnlineCalc.parse.parseLocals(1,
z.range),d);if(!excelOnlineCalc.util.isSuccess(d))return d.reason.kind===excelOnlineCalc.parse.ReasonKind.NotFormulaString?"notFormulaString":"internalError";z=this.Inc.checkFormula(excelOnlineCalc.analyze.analyzeLocalsName(z),d.value);return excelOnlineCalc.util.isSuccess(z)?z.value.isWellFormed?"valid":"illFormed":"internalError"}extractLetVariables(d,z){if(!this.rAa)return this.Qbc||ia.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const T=this.Fsc(Rd.Range.vi(1,
1));d=this.rAa.parseFormula(excelOnlineCalc.parse.parseLocals(1,T.range),d);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(d))return ia.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(d,z,this.w4.config.localeInfo)}catch(ya){return ia.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${ya.message}`),null}}extractReferences(d,z,T,ya,sb,cc){if(!z)return ia.ULS.sendTraceTag(537170051,
0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!T)return ia.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const Fc=this.vGd(d,sb);if(!Fc)return ia.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.v8h(Fc,z,T,d,ya,sb,cc)}catch(Wc){return ia.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${Wc.message}`),null}}Fsc(d,z){z=void 0===
z?!0:z;return d&&this.w4?this.w4.U9h(this.w4.Iai(),d.top-1,d.left-1,z):null}BHc(d,z){d=this.wna(d);if(!Object(Oe.c)(d))return null;z=this.mN.parseEdit(z,d.value);return excelOnlineCalc.util.isSuccess(z)?z.value.kind===ye.a.formula:null}h_d(d){d=this.wna(d);return Object(Oe.c)(d)?"Text"===d.value.valueType:null}sYf(d){d=this.wna(d);return Object(Oe.c)(d)?"Date"===d.value.valueType&&!d.value.hasTime:null}wna(d){if(null==this.mN)return Object(Oe.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(Oe.a)("Instantaneous manager is null");
if(this.b8d.has(d))return Object(Oe.d)(this.b8d.get(d));if("number"===typeof d){var z=this.GJf(d);if(null==z)return Object(Oe.a)(`Invalid ifmt=${d}`);var T=z.FormatString;z=z.Builtin}else T=d,z=!1;T=this.mN.createFormat(T,z);return excelOnlineCalc.util.isSuccess(T)?(this.b8d.set(d,T.value),Object(Oe.d)(T.value)):Object(Oe.a)("Could not create number format")}getWorksheetFuncId(d){return this.localeInfo.getWorksheetFuncId(d)}v8h(d,z,T,ya,sb,cc,Fc){const Wc={Items:[]};for(let ee=0;ee<d.length;ee++){var id=
d[ee];const re={};re.Start=id.span.start;re.End=id.span.end;if(sb||id.kind!==Bb.a.func)if(sb||id.kind!==Bb.a.xxj){if(Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8719736_calcFormulaExtractReferencesCrossSheet")&&Fc&&!id.ref.qualifier)continue;if(!this.Ghi(id,z,T))continue;var Dd=new rd;const Ce=this.iUi(id,z,Dd,ya,cc);if(Ce){const mf={};mf.Span=re;mf.Range=Ce;mf.IsRangeRef=Dd.r2a;mf.IsAbsoluteFirstRow=Dd.foa;mf.IsAbsoluteFirstColumn=Dd.eoa;mf.IsAbsoluteSecondRow=Dd.kya;mf.IsAbsoluteSecondColumn=
Dd.jya;mf.IsStructRef=id.kind===Bb.a.aZg;Wc.Items.push(mf)}}else id=id.ref.value.oper.kind,Dd={},Dd.Span=re,Dd.IsString=2===id,Dd.IsBoolean=4===id,Dd.IsNumber=1===id,Wc.Items.push(Dd);else re.End=id.span.start+id.ref.name.length,id={},id.Span=re,id.IsFunction=!0,id.FunctionId=this.getWorksheetFuncId(ya.substring(re.Start,re.End)),Wc.Items.push(id)}Wc.Items.sort((ee,re)=>ee.Span.Start-re.Span.Start);return Wc}iUi(d,z,T,ya,sb){if(d.kind===Bb.a.range)return T.r2a=!0,this.fjf(d,z,T,ya);if(d.kind===Bb.a.namedRange){T=
d.ref;(d=this.$.$h.getItemByName(T.name))||(d=this.$.$h.getItemByName(z+"!"+T.name));if(!(d&&d.sheetName&&d.usedRange&&$c.a.equals(d.sheetName,z,!0)))return null;z=2===d.type?Af.a(d):d.usedRange;return qd.o(z,d)}if(d.kind===Bb.a.aZg){const cc=d.ref;cc.name?(sb=this.$.$h.getItemByName(cc.name))||(sb=this.$.$h.getItemByName(z+"!"+cc.name)):sb=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&sb?this.da.oh.Kl(sb):this.da.oh.Kl(this.da.ha.qa.activeCell);if(!(sb&&
sb.sheetName&&sb.usedRange&&$c.a.equals(sb.sheetName,z,!0)))return null;T.r2a=!1;return this.fjf(d,z,T,ya)}return null}fjf(d,z,T,ya){d=d.ref;if(d.type){if(d.type===Nc.a.column){var sb=d.startIndex;d=d.endIndex;T.eoa=sb.kind===hd.a.abs;T.jya=d.kind===hd.a.abs;return this.createRange(0,sb.index,Yd.a.Rk,d.index,z)}if(d.type===Nc.a.row)return sb=d.endIndex,T.foa=d.startIndex.kind===hd.a.abs,T.kya=sb.kind===hd.a.abs,this.createRange(d.startIndex.index,0,d.endIndex.index,Yd.a.Gk,z);if(d.type===Nc.a.cell){sb=
d.row;var cc=d.col;T.foa=T.kya=sb.kind===hd.a.abs;T.eoa=T.jya=cc.kind===hd.a.abs;return this.$Wa(d.span.end,ya)&&(T=Rd.Range.vi(sb.index+1,cc.index+1),T=this.da.oh.hMf(T))?qd.p(T,z):this.createRange(sb.index,cc.index,sb.index,cc.index,z)}if(d.type===Nc.a.range){sb=d.top;cc=d.left;ya=d.bottom;d=d.right;const Fc=Math.min(sb.index,ya.index),Wc=Math.min(cc.index,d.index),id=Math.max(sb.index,ya.index),Dd=Math.max(cc.index,d.index);T.foa=sb.kind===hd.a.abs;T.kya=ya.kind===hd.a.abs;T.eoa=cc.kind===hd.a.abs;
T.jya=d.kind===hd.a.abs;return this.createRange(Fc,Wc,id,Dd,z)}ia.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${d.type}'`);return null}ia.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}$Wa(d,z){return z.length>=d&&0<d&&z.charAt(d-1)===va.awg}aSh(d,z,T){this.sz&&this.sz.lSh(d,z,T)}GJf(d){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.lNa&&
this.instantaneousSupportInformationManager.lNa[d]&&this.mN?this.instantaneousSupportInformationManager.lNa[d]:null}U3i(d){var z;"number"!==typeof d&&"string"!==typeof d?this.gOc(null):(d=this.wna(d),Object(Oe.c)(d)?(d=d.value,Object(ne.c)(d)||Object(ne.c)(d.formatString)?this.gOc(null):this.gOc({formatString:d.formatString,builtIn:null!==(z=d.isBuiltIn)&&void 0!==z?z:!1})):this.gOc(null))}toXLNumber(d){if(!this.mN)return null;d=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.mN,d);return excelOnlineCalc.util.isSuccess(d)?
d.value:null}gaa(d,z,T,ya,sb,cc,Fc){if(!d)return Object(Oe.a)("Null");var Wc=excelOnlineCalc.numfmt.renderCallback(T,Dd=>gridRenderer.CanvasRendererGlobals.measureTextWidth(Dd,ya,!0,Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth")),cc),id=this.mN.renderValue(d,Wc);if(!excelOnlineCalc.util.isSuccess(id))return Object(Oe.a)("Finalize");T=null;if(cc=excelOnlineCalc.numfmt.isHashesValue(id.value)){if(id=this.mN.renderHashesValue(id.value,Wc),!excelOnlineCalc.util.isSuccess(id))return Object(Oe.a)("Hashes")}else T=
this.ty.IId(d,id.value);id=id.value;d=excelOnlineCalc.numfmt.renderedValueToString(id);Wc=this.ty.OHf(id);id=this.ty.ZGf(id);return Object(Oe.d)({text:d,valueType:z,fontColor:id,format:sb,horizontalAlignment:Wc,numFmt:T,isHashesValue:cc,cellValue:Fc})}S9k(d,z){if(d)for(const T of d)T.ref.type&&T.ref.type===Nc.a.cell&&(d=T.ref,Qd.D8j(d,z)&&(d.span.end+=1,T.span.end+=1))}createRange(d,z,T,ya,sb){const cc={};cc.FirstRow=d;cc.FirstColumn=z;cc.LastRow=T;cc.LastColumn=ya;cc.SheetName=sb;return cc}Ghi(d,
z,T){var ya=d.ref.qualifier;if(!ya)return!0;switch(d.ref.qualifier.type){case Ac.sheet:return d=ya.document,$c.a.equals(ya.sheet,z,!0)&&(!d||$c.a.equals(d.document,T,!0));case Ac.sheetRange:return z=this.$.sa.getItemByName(z),T=this.$.sa.getItemByName(ya.sheet1),ya=this.$.sa.getItemByName(ya.sheet2),!!z&&!!T&&!!ya&&(T.index<=z.index&&z.index<=ya.index||ya.index<=z.index&&z.index<=T.index);case Ac.document:return $c.a.equals(ya.document,T,!0);case Ac.y9i:return ya=ya.name,$c.a.equals(ya,z,!0)||$c.a.equals(ya,
T,!0);default:return ia.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${ya.type}'`),!1}}ykj(){try{void 0!==excelOnlineCalc}catch(d){return!1}try{void 0!==excelOnlineCalc.location}catch(d){return!1}return!0}F3k(d){this.instantaneousSupportInformationManager=d;if(d.lNa.length&&d.Qwa.length)if(this.ykj())try{this.V8c=new Cc.CalcHelper(this.da.$,this.instantaneousSupportInformationManager),this.rAa=this.w4.createParser(),this.Inc=this.w4.createAnalyzer(),
this.qTe=this.w4.createNumberFormatter(),this.sGc=!0,ia.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.sz||(ia.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.sz=new pc(this.$)),this.htk()}catch(z){ia.ULS.sendTraceTag(507533056,0,10,`CalcManager.TryInitializeInternal: Exception while trying to create CalcManager. Exception message is: ${z.message}`),Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&
this.Ohe()}else ia.ULS.shipAssertTag(40939861,0,this.Qbc,"CalcManager.TryInitializeInternal: ExcelOnlineCalc is not loaded, any usage of it causes JS crash. Aborting calc initialization."),this.Qbc=!0,Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Ohe();else ia.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${d.lNa.length}, functions info count = ${d.Qwa.length}`),
Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Ohe()}y9h(d,z){const T={allowUnqualifiedCell:!0,wrapCellReferences:!0};T.config=this.w4.config;T.originGridCell=excelOnlineCalc.util.success(d);T.originSheet=excelOnlineCalc.util.success(z);return T}x9h(){const d={};d.config=this.w4.config;d.getNameLoc=this.sz.getNameLoc;d.getContainingTable=this.sz.getContainingTable;d.getStructRefColumn=this.sz.getStructRefColumn;d.getStructRefSpecialRef=this.sz.getStructRefSpecialRef;
d.getDocumentLoc=this.sz.getDocumentLoc;d.getSheetIndex=this.sz.getSheetIndex;d.getSheetName=this.sz.getSheetName;d.getUserDefinedFuncLoc=this.sz.getUserDefinedFuncLoc;d.getSheetRangeIndexes=this.sz.getSheetRangeIndexes;return d}static D8j(d,z){return z.length>d.span.end&&z.charAt(d.span.end)===va.awg}};me.hsf="ECRC";me.xnd="ActiveCellNumberFormatChanged";me.Cwd="ClientDataFlushedToWorkerKey";me=Qd=Object(rb.__decorate)([Object(zc.d)(oc.E),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,
Object(oc.D)()),Object(rb.__param)(2,Object(oc.Ub)())],me);Object(Va.a)(me,"CalcManager",sa.a,[612,4]);var se=a(972);let Ne=class{constructor(d){this.I7a=!1;this.V4a=z=>{na.a.jl(z.Errors)?(-315732528!==z.Errors[0].MessageId&&ia.ULS.sendTraceTag(507609629,0,10,`CopilotNewBadgeManager.onReadRoamingStringSuccess: encountered an error. Errors: ${na.a.Yh(z.Errors)}`),this.I7a=!1,this.y3c(!1)):z.Result&&((this.I7a=!!parseInt(z.Result,10))||this.y3c(!1))};this.Jsb=z=>{z=Pe.a.gk(z.data);ia.ULS.sendTraceTag(507609627,
0,10,`CopilotNewBadgeManager.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${na.a.Yh(z)}.`);this.I7a=!1;this.y3c(!1)};this.e5a=z=>{na.a.jl(z.Errors)?ia.ULS.sendTraceTag(507609628,0,10,`CopilotNewBadgeManager.onWriteRoamingStringSuccess: encountered an error. Errors: ${na.a.Yh(z.Errors)}`):z.Result||ia.ULS.sendTraceTag(507609626,0,10,"CopilotNewBadgeManager.onWriteRoamingStringSuccess failed to write to roaming service.")};this.$=d;this.initialize()}dispose(){this.$=
null}initialize(){ia.ULS.shipAssertTag(507609630,0,be.a.MVd(),"Copilot New Badge feature is off");this.$.ea.ki||ia.ULS.shipAssertTag(507569056,0,this.$.ea.ki,"CopilotNewBadgeManager.initialize but session is inactive");Fe.C(this.$.pa.ta,8,this.V4a,this.Jsb,null,null)}F5c(d){Fe.J(this.$.pa.ta,8,d.toString(),this.e5a,this.Jsb,null,null)}y3c(d){d&&this.I7a||(appChrome.api.dispatch(appChrome.actions.setControlIconSet("Copilot",this.NZi(d))),d&&(this.I7a=!0,this.F5c(Number(this.I7a))))}NZi(d){const z=
Pb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopilotNewBadgeEnabled",0),T={"default":"M365Excel_20",icon32:"M365Excel_32"};d||(1===z?(T["default"]="CopilotExcelNewBadge_20",T.icon32="CopilotExcelNewBadge_32"):2===z&&(T["default"]="CopilotExcelDotBadge_20",T.icon32="CopilotExcelDotBadge_32"));return T}};Ne=Object(rb.__decorate)([Object(zc.d)(oc.ib),Object(rb.__param)(0,Object(oc.Nb)())],Ne);Object(Va.a)(Ne,"CopilotNewBadgeManager",null,[4]);var Ue=a(740),nf=a(392);const tb=(d,z)=>{z=void 0===
z?!1:z;d=new Rd.Range(d.top,d.left,d.bottom,d.right,!1,z);if(z&&(1>d.top||d.top>d.maxRows||1>d.bottom||d.bottom>d.maxRows||d.top>d.bottom||1>d.left||d.left>d.maxColumns||1>d.right||d.right>d.maxColumns||d.left>d.right))throw ia.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return d};var lc=a(1004),Tc=a(1082),md=a(945),sd=a(120),Zd=a(976);const Ae={[0]:[45],[1]:[46]};class Ee{constructor(d,z){this.$=d;this.sessionStorage=
z;this.doUndo=()=>{const T=this;return Lo(function*(){yield Object(lc.e)(T.$)})};this.highlightRangesOnGrid=(T,ya,sb)=>{const cc=this;return Lo(function*(){cc.highlightRanges(T,ya,Ae[sb])})};this.openLearnMore=()=>{const T=this;return Lo(function*(){Object(Tc.b)(T.$)})};this.openCustomNumberFormat=()=>{const T=this;return Lo(function*(){return new Promise(ya=>{Object(lc.a)(T.$,sb=>{ya(sb);ia.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${sb?"OK":"Cancel"}"`)})})})};
this.openFeedback=T=>{const ya=this;return Lo(function*(){Object(lc.f)(ya.$,T)})};this.sendOtelEvent=T=>Lo(function*(){Object(md.c)(T)});this.containsHiddenCells=T=>r(this.$,T);this.replaceMultipleStrings=(T,ya,sb,cc)=>{const Fc=this;return Lo(function*(){const Wc=T.map(id=>tb(id,!1));return x(Fc.$,Wc,ya,sb,{["SheetName"]:Fc.$.ma.sheetName,["MatchCase"]:cc.matchCase,["MatchEntireCell"]:cc.matchEntireCell,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:ya,["ReplaceWholeWordOnly"]:cc.replaceWholeWordOnly})})};
this.trimWhitespace=(T,ya)=>{const sb=this;return Lo(function*(){const cc=T.map(Fc=>tb(Fc,!1));return t(sb.$,cc,ya.map(m))})};this.formatCells=(T,ya)=>{const sb=this;return Lo(function*(){const cc=T.map(Wc=>tb(Wc,!1)),Fc={NumberFormatOptions:Object(ed.a)(new Zd.a,{NumberFormatCategory:-1,CustomFormatString:ya}),ValidMembers:32,NumberFormat:15};return n(sb.$,cc,Fc)})};this.getIgnoredSuggestions=()=>{const T=this;return Lo(function*(){return T.sessionStorage.getIgnoredSuggestions()})};this.addToIgnoredSuggestions=
T=>{const ya=this;return Lo(function*(){return ya.sessionStorage.addToIgnoredSuggestions(T)})};this.getAppliedSuggestions=()=>{const T=this;return Lo(function*(){return T.sessionStorage.getAppliedSuggestions()})};this.addToAppliedSuggestions=T=>{const ya=this;return Lo(function*(){return ya.sessionStorage.addToAppliedSuggestions(T)})};this.removeFromAppliedSuggestions=T=>{const ya=this;return Lo(function*(){return ya.sessionStorage.removeFromAppliedSuggestions(T)})}}get grid(){return cd.f(this.$)}highlightRanges(d,
z,T){T=void 0===T?[45]:T;const ya=this.grid.Gh;ya.Mq(T,!1,!0);ya.tt(null,T,!1);if(null===d||void 0===d?0:d.length){const sb=nf.a.P9a(Id.d(this.$.ma),d.map(cc=>tb(cc,!1)));ya.fQ(sb,T,!0,void 0,!1);z&&this.JHj(d)}ya.update(!1)}JHj(d){if(null===d||void 0===d?0:d.length){const z=this.grid;[d]=d.sort((T,ya)=>T.top<ya.top?-1:T.top>ya.top?1:0);d=Rd.Range.vi(d.top,d.left);z.bG(d)||(ia.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),z.FC(d,0,"DataCleansing"))}else ia.ULS.sendTraceTag(509617690,
0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(Va.a)(Ee,"HostAppCallbacks",null,[]);class Ze{constructor(){this.annotations=[];this.hostState={isInCoauthoring:!1,isFeedbackAllowed:!1};this.worksheetState={isInNamedSheetView:!1,isProtected:!1}}}Object(Va.a)(Ze,"DataCleansingHostState",null,[]);class Te{constructor(d){this.$=d;this.Dpf=!1}get isEnabled(){return Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingLearnMoreTeachingCallout",
!1)}show(){this.Dpf||(ia.ULS.sendTraceTag(508887310,0,20,"DataCleansing.showCallout: dispatchShowCalloutCommand."),Object(lc.c)(this.$),this.Dpf=!0)}}Object(Va.a)(Te,"TeachingCallout",null,[]);var We=a(266),qf=a(1081);class bf{constructor(d){this.$=d;this.Cpf=!1;this.localStorage=new We.a;this.$rk()}y8a(d,z){const T=this;return Lo(function*(){if(T.Cpf)ia.ULS.sendTraceTag(509089825,0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else if(T.NMk()){var ya=
Object(qf.b)(d);T.CWa||(T.CWa=yield zc.a.resolve(oc.C,{va:1}));T.CWa.SOk(ya.title,ya.message,ya.Pse,()=>{ia.ULS.sendTraceTag(508117194,0,20,"DataCleansingBusinessBar.showBusinessBar: Show suggestions was clicked.");T.Sga();T.aIg()},()=>{ia.ULS.sendTraceTag(507789517,0,20,'DataCleansingBusinessBar.showBusinessBar: "X" button was clicked.');T.l$i();z()});T.Cpf=!0;ia.ULS.sendTraceTag(509089824,0,20,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${d} suggestions.`)}else ia.ULS.sendTraceTag(507789518,
0,20,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar should not be shown.")})}Sga(){this.CWa&&this.CWa.mM(70)&&this.CWa.removeEntry(70)}NMk(){if(this.localStorage.zl()){const d=this.localStorage.getItem("CleanDataBBClosedCount");return!d||this.$_f()||3>parseInt(d,10)}ia.ULS.sendTraceTag(507789516,0,20,"DataCleansingBusinessBar.shouldShowBusinessBar: Local storage is not supported.");return!0}$rk(){this.$_f()?this.aIg():ia.ULS.sendTraceTag(507787410,0,20,"DataCleansingBusinessBar.resetBBCloseValuesIfNeeded: Last close was less than 30 days ago.")}$_f(){if(this.localStorage.zl()){const d=
this.localStorage.getItem("CleanDataBBClosedDate");if(d){const z=Date.now()-parseInt(d,10),T=2592E6<z;ia.ULS.sendTraceTag(507787409,0,20,`DataCleansingBusinessBar.isLastCloseAboveCooldown: timeFromLastClose: ${z}, lastCloseDate: ${d}, isLastCloseAboveCooldown: ${T} `);return T}}return!1}aIg(){this.localStorage.zl()&&(this.localStorage.removeItem("CleanDataBBClosedCount"),this.localStorage.removeItem("CleanDataBBClosedDate"),ia.ULS.sendTraceTag(507789515,0,20,"DataCleansingBusinessBar.resetBBClosedCount"))}l$i(){if(this.localStorage.zl()){let d=
this.localStorage.getItem("CleanDataBBClosedCount");d=d?(parseInt(d,10)+1).toString():"1";const z=Date.now().toString();this.localStorage.setItem("CleanDataBBClosedCount",d);this.localStorage.setItem("CleanDataBBClosedDate",z);ia.ULS.sendTraceTag(507789514,0,20,`DataCleansingBusinessBar.increaseBBClosedCount: new count is: ${d}, new date is: ${z}`)}}}Object(Va.a)(bf,"BusinessBar",null,[]);var af=a(903);class Nf{constructor(d){af.a.assign(Nf,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=
d}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,[Nf.getTypeName()])}}Nf.H_={T_:Nf.getTypeName(),B_:Nf.getBaseTypes()};class uf{constructor(d){af.a.assign(uf,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,
[uf.getTypeName()])}}uf.H_={T_:uf.getTypeName(),B_:uf.getBaseTypes()};class pf{constructor(d){af.a.assign(pf,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,[pf.getTypeName()])}}pf.H_={T_:pf.getTypeName(),B_:pf.getBaseTypes()};class ff{constructor(d){af.a.assign(ff,
this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,[ff.getTypeName()])}}ff.H_={T_:ff.getTypeName(),B_:ff.getBaseTypes()};class Qa{constructor(d){af.a.assign(Qa,this,d)}static getTypeName(){return"AugLoop_Tablelint_TableLintSuggestion"}static getBaseTypes(){return[]}static typeGuard(d){return af.a.matchesTypesFor(d,
[Qa.getTypeName()])}}Qa.H_={T_:Qa.getTypeName(),B_:Qa.getBaseTypes()};class Ob{constructor(d){af.a.assign(Ob,this,d)}static getTypeName(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(d){return af.a.matchesTypesFor(d,[Ob.getTypeName()])}}Ob.H_={T_:Ob.getTypeName(),B_:Ob.getBaseTypes()};class Pc{constructor(d){af.a.assign(Pc,this,d)}static getTypeName(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(d){return af.a.matchesTypesFor(d,
[Pc.getTypeName()])}}Pc.H_={T_:Pc.getTypeName(),B_:Pc.getBaseTypes()};class Cd{constructor(d){af.a.assign(Cd,this,d)}static getTypeName(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(d){return af.a.matchesTypesFor(d,[Cd.getTypeName()])}}Cd.H_={T_:Cd.getTypeName(),B_:Cd.getBaseTypes()};class Ud{constructor(d){af.a.assign(Ud,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,
[Ud.getTypeName()])}}Ud.H_={T_:Ud.getTypeName(),B_:Ud.getBaseTypes()};class Wd{constructor(d){af.a.assign(Wd,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,[Wd.getTypeName()])}}Wd.H_={T_:Wd.getTypeName(),B_:Wd.getBaseTypes()};class le{constructor(d){af.a.assign(le,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=
d}static getTypeName(){return"AugLoop_ExcelCleanData_CleanDataResolverAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,[le.getTypeName()])}}le.H_={T_:le.getTypeName(),B_:le.getBaseTypes()};class Fa{constructor(d){af.a.assign(Fa,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,
[Fa.getTypeName()])}}Fa.H_={T_:Fa.getTypeName(),B_:Fa.getBaseTypes()};class mb{constructor(d){af.a.assign(mb,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,[mb.getTypeName()])}}mb.H_={T_:mb.getTypeName(),B_:mb.getBaseTypes()};class e{constructor(d){af.a.assign(e,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=
d}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,[e.getTypeName()])}}e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class Ra{constructor(d){af.a.assign(Ra,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,
[Ra.getTypeName()])}}Ra.H_={T_:Ra.getTypeName(),B_:Ra.getBaseTypes()};class O{constructor(d){af.a.assign(O,this,d)}get metadata(){return this.M_}set metadata(d){this.M_=d}static getTypeName(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(d){return af.a.matchesTypesFor(d,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class qa{constructor(d,z){this.Yo=d;this.jhg=z;this.uua=!1;this.BD=new EventTarget;this.CZg=
(T,ya)=>{if(T=ya.annotation)switch(ya.operationType){case 1:case 2:this.BD.dispatchEvent(new CustomEvent("suggestionsAnnotationReceived",{detail:T}));break;case 3:break;default:ia.ULS.sendTraceTag(508560024,306,15,`AnnotationsProvider.suggestionsAnnotationHandler Received unexpected OperationType:${ya.operationType}`)}else ia.ULS.sendTraceTag(508560025,306,50,"AnnotationsProvider.suggestionsAnnotationHandler suggestionsAnnotation is null.")};this.ltk=(T,ya)=>{if(T=ya.annotation)switch(ya.operationType){case 1:case 2:this.BD.dispatchEvent(new CustomEvent("resolverAnnotationReceived",
{detail:T}));break;case 3:break;default:ia.ULS.sendTraceTag(508560027,306,15,`AnnotationsProvider.resolverAnnotationHandler Received unexpected OperationType:${ya.operationType}`)}else ia.ULS.sendTraceTag(508560028,306,50,"AnnotationsProvider.resolverAnnotationHandler: resolverAnnotation is null.")};ia.ULS.sendTraceTag(507777624,0,50,"AnnotationsProvider.constructor: AnnotationsProvider is created.");this.Yo=d;this.jhg=z}activateEvents(){this.uua?ia.ULS.sendTraceTag(508560026,0,50,"AnnotationsProvider.ActivateEvents: Events are already registered"):
(this.shk(),this.uua=!0)}deactivateEvents(){this.uua&&(this.u5k(),this.uua=!1)}registerSuggestionsAnnotationReceived(d){this.BD.addEventListener("suggestionsAnnotationReceived",z=>{z instanceof CustomEvent&&d(null===z||void 0===z?void 0:z.detail)})}registerResolverAnnotationReceived(d){this.BD.addEventListener("resolverAnnotationReceived",z=>{z instanceof CustomEvent&&d(null===z||void 0===z?void 0:z.detail)})}u5k(){this.Yo.unregister("DataCleansing")}shk(){ia.ULS.sendTraceTag(574482312,0,50,"AnnotationsProvider.registerCleanDataEvents: activate annotations");
const d=this.Yo.J5().n8("DataCleansing").m8(this.jhg).activateAnnotation({annotationType:pf.getTypeName(),Ny:!0,eDa:this.CZg}).activateAnnotation({annotationType:Wd.getTypeName(),Ny:!0,eDa:this.CZg}).activateAnnotation({annotationType:le.getTypeName(),Ny:!0,eDa:this.ltk});Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",!1)&&d.activateAnnotation({annotationType:mb.getTypeName(),Ny:!0});Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",
!1)&&d.activateAnnotation({annotationType:Ra.getTypeName(),Ny:!0});Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDataOutliers",!1)&&d.activateAnnotation({annotationType:O.getTypeName(),Ny:!0});this.Yo.register(d.build())}}Object(Va.a)(qa,"AnnotationsProvider",null,[]);var ob=a(1208),R=a(151);class Za{constructor(d,z){this.$=d;this.Sj=z}isUsageRangeTable(d){const z=cd.f(this.$),T=z.Ayj;return d.worksheetName!==z.$.ma.sheetName?null:null==T?(ia.ULS.sendTraceTag(507847903,0,20,"AnnotationsHostCallbacks.isUsageRangeTable: usedRange is null"),
null):1===d.tableRange.top&&d.tableRange.bottom===T.bottom}logCtrlAComparisonResults(d){d={["range"]:new Rd.Range(d.tableRange.top,d.tableRange.left,d.tableRange.bottom-1,d.tableRange.right,!1,!1),["sheetId"]:d.worksheetId,["sheetName"]:d.worksheetName,["callback"]:this.DQd};Object(lc.b)(this.$,d)}getDependentFormulasSuggestionInfo(d,z){const T=new Set;z.forEach(ya=>T.add(tb(ya)));d=f(this.$,this.Sj,d,T);return new Map(Array.from(d.entries(),ya=>{var [sb,cc]=ya;return[sb.toString(),Array.from(new Set(Array.from(cc,
Fc=>Fc.toString())))]}))}DQd(d,z,T){d.Result?na.a.Lx(d.Errors)?(T=na.a.Yh(d.Errors),ia.ULS.sendTraceTag(507867614,0,15,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: result return with errors: ${T}, AnnotationRange: ${z}`)):(d=qd.H(d.Result),z.bottom+=1,ia.ULS.sendTraceTag(507867613,0,20,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: sheetId: ${T}, annotationRange: ${z}, ctrlARange: ${d}, isSameRangeAsCtrl+A: ${d.toString()===z.toString()}, isTopAndBottomAsCtrl+A: ${d.top===
z.top&&d.bottom===z.bottom}`)):ia.ULS.sendTraceTag(507867615,0,50,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: result.Result is null. AnnotationRange: ${z}`)}}Object(Va.a)(Za,"AnnotationsHostCallbacks",null,[]);class Cb{constructor(d){this.$=d}readIgnoredSuggestionsString(){return new Promise(d=>{Fe.B(this.$.pa.ta,9,z=>{if(na.a.jl(z.Errors))ia.ULS.sendTraceTag(507577634,0,10,`RoamingOperations.readIgnoredSuggestions: encountered an error while reading roaming setting. Errors: ${na.a.Yh(z.Errors)}`),
d(null);else{const T=z.Result?JSON.parse(z.Result):[];ia.ULS.sendTraceTag(507577633,0,20,`RoamingOperations.readIgnoredSuggestions: ignoredSuggestionsIds.size: ${T.length}`);d(z.Result)}},z=>{this.FTj(z);d(null)},null,null)})}writeIgnoredSuggestionsString(d){Fe.I(this.$.pa.ta,9,d,z=>{this.O1j(z)},z=>{this.M1j(z)},null,null)}FTj(d){({data:d}=d);d=Pe.a.gk(d);ia.ULS.sendTraceTag(507577632,0,10,`RoamingOperations.onGetIgnoredSuggestionsFromRoamingFailure: encountered errors while reading roaming setting. Errors: ${na.a.Yh(d)}.`)}M1j(d){d=
Pe.a.gk(d.data);ia.ULS.sendTraceTag(507577631,0,10,`RoamingOperations.onWriteRoamingFailed: encountered errors: ${na.a.Yh(d)}.`)}O1j(d){na.a.jl(d.Errors)||!d.Result?ia.ULS.sendTraceTag(507577630,0,10,`RoamingOperations.onWriteRoamingSuccess: write Failed${na.a.jl(d.Errors)?", Encountered some errors. Errors: "+na.a.Yh(d.Errors):""}`):ia.ULS.sendTraceTag(507577629,0,50,"RoamingOperations.onWriteRoamingSuccess: write Succeeded")}}Object(Va.a)(Cb,"RoamingOperations",null,[]);class rc{constructor(d,z,
T,ya){this.$=d;this.zX=z;this.bga=T;this.Lnc=ya;this.k$f=new Set}ZOf(){if(Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingFormulasDependencies",!1)&&Id.l(this.$.ma)){var d=this.$.ma.sheetId,z=this.zX.sheetAnnotations(d);if(0<z.length){let T=!1;this.k$f.has(d)||(this.k$f.add(d),T=!0);this.logDependentSuggestionsInfo(d,z,T)}}}logDependentSuggestionsInfo(d,z,T){const ya=this.bga.annotationsUtils.getSuggestionAffectedRanges(z);this.bga.suggestionsTelemetryUtils.logDependentSuggestionsInfo(d,
z,T,this.Lnc.getDependentFormulasSuggestionInfo(d,ya))}}Object(Va.a)(rc,"SuggestionDependency",null,[]);var ma;(function(d){d.None="None";d.ShowBusinessBar="ShowBusinessBar";d.HideBusinessBar="HideBusinessBar"})(ma||(ma={}));class qb{constructor(d,z,T,ya){this.$=d;this.bga=z;this.zX=T;this.sessionStorage=ya;this.isEnabled=!0;this.fCe=!1;this.businessBar=new bf(this.$);this.z$b=new Te(this.$)}V1i(d){const z=this;return Lo(function*(){z.fCe?z.businessBar.Sga():yield z.Y1g(d)})}Y1g(d){const z=this;return Lo(function*(){if(z.isEnabled&&
!z.fCe){var T=yield z.Knd(d),ya=z.bga.disoverabilityUtils.getDiscoverabilityCommand(T);T=z.bga.listsUtils.sum(T.values());switch(ya){case ma.ShowBusinessBar:yield z.X1k(T);break;case ma.HideBusinessBar:z.businessBar.Sga()}}})}Sib(){this.businessBar.Sga();this.isEnabled=!1}X9a(){this.z$b.isEnabled&&this.z$b.show()}Knd(d){const z=this;return Lo(function*(){const T=z.zX.sheetAnnotations(d),ya=yield z.sessionStorage.getIgnoredSuggestions();return z.bga.annotationsUtils.suggestionsToShowCountByType(T,
ya)})}X1k(d){const z=this;return Lo(function*(){z.zX.pauseAugmentationLoop("triggerBusinessBar");yield z.businessBar.y8a(d,()=>{z.aOj()});z.fCe=!0})}aOj(){this.X9a()}}Object(Va.a)(qb,"DiscoverabilityManager",null,[]);var Xb=a(1209),qc;let Uc=qc=class extends sa.a{constructor(d,z,T,ya){super();this.$=d;this.bga=T;this.Sj=ya;this.Sib=!1;this.gpa=new Ze;this.h_j=()=>{const sb=this;return Lo(function*(){sb.stateChanged();if(Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",
!1)){const cc=sb.SQb();if(!cc)return;yield sb.aOb.Y1g(cc)}else yield sb.cPf();sb.BZg.ZOf()})};this.wq=(sb,cc)=>{const Fc=this;return Lo(function*(){Fc.P4g(cc.LB);Fc.qZg(cc.ma);Fc.stateChanged();if(Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)){const Wc=Fc.SQb();if(!Wc)return;yield Fc.aOb.V1i(Wc)}else Fc.businessBar.Sga(),yield Fc.cPf();Fc.BZg.ZOf()})};this.dAa=()=>{this.stateChanged()};this.VE=()=>{this.stateChanged()};this.FA=()=>{this.$.ea.isEditMode?
(void this.zX.activateEvents(),this.$.ea.WH(this.FA)):ia.ULS.sendTraceTag(507856794,0,20,"DataCleansingHostManager.onApplicationModeChanged: the workbook is not in edit mode, therefore we don't activate the events.")};this.P0j=(sb,cc)=>{sb=void 0===sb?"Unknown":sb;ia.ULS.sendTraceTag(520987272,0,20,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:ob.a[sb],["errorCode"]:cc})}`);Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8749328_SendCrucialOtelEvents")&&
Object(md.c)(Object(Xb.a)(ob.a[sb],cc));this.gpa.hostState.errorState=cc;this.stateChanged()};this.jia=(sb,cc)=>{Id.l(cc.item)&&cc.item.wn!==this.gpa.worksheetState.isProtected&&(ia.ULS.sendTraceTag(509613388,0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${cc.item.wn}.`),this.stateChanged())};this.gAa=(sb,cc)=>{v(this.$,cc)&&(Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)?this.aOb.Sib():this.Ppf())};ia.ULS.sendTraceTag(507777625,
0,50,"DataCleansingHostManager.constructor: DataCleansingHostManager is created.");this.sessionStorage=T.getOrCreateSessionStorage(new Cb(this.$));this.AHh=new Ee(this.$,this.sessionStorage);this.z$b=new Te(this.$);this.businessBar=new bf(this.$);z=new qa(z,this.P0j);this.Lnc=new Za(this.$,this.Sj);this.zX=T.createAnnotationsManger(z,this.Lnc);this.zX.registerSheetAnnotationsChanged(this.h_j);Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)&&(this.aOb=
new qb(this.$,this.bga,this.zX,this.sessionStorage));this.$.ea.isEditMode?void this.zX.activateEvents():this.$.ea.cK(this.FA);d.fu.pn(this.wq);d.ea.Gea(this.VE);this.qZg(this.$.ma);this.cnc(this.gAa);this.$.Ovd(()=>{this.stateChanged()});this.BZg=new rc(d,this.zX,T,this.Lnc)}cnc(d){this.addHandler(qc.Yue,d)}VFg(d){this.removeHandler(qc.Yue,d)}nYk(){this.zX.pauseAugmentationLoop("taskPaneClosed");Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)?
this.aOb.X9a():this.X9a()}rYk(){Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)&&this.aOb.Sib();this.zX.resumeAugmentationLoop("taskPaneOpened")}dispose(){this.$.fu.Gn(this.wq);this.$.ea.R7(this.VE);this.$.ea.WH(this.FA);this.P4g(this.$.ma);super.dispose()}get state(){this.gpa.annotations=this.zX.allAnnotations();if(Id.l(this.$.ma)){const d=this.$.ma.wn,z=this.$.ma.sheetId,T=this.$.ma.sheetName;this.gpa.worksheetState.isInNamedSheetView=this.$.ma.dk.jx;
this.gpa.worksheetState.isProtected=d;this.gpa.worksheetState.sheetId=z;this.gpa.worksheetState.sheetName=T}this.gpa.hostState.isInCoauthoring=this.isInCoauthoring();this.gpa.hostState.isFeedbackAllowed=this.$.isFeedbackEnabled;return this.gpa}Ppf(){this.businessBar.Sga();this.Sib=!0}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(qc.Yue,this.state)}qZg(d){Id.l(d)&&(d.dk.Keb(this.dAa),d.Oeb(this.jia))}P4g(d){Id.l(d)&&(d.dk.i5b(this.dAa),d.oVc(this.jia))}SQb(){if(Id.l(this.$.ma))return this.$.ma.sheetId;
ia.ULS.sendTraceTag(507510927,0,50,"DataCleansingHostManager.getActiveSheetId: active item is not a sheet.")}Knd(){const d=this;return Lo(function*(){if(!Id.l(d.$.ma))return new Map;const z=d.zX.sheetAnnotations(d.$.ma.sheetId);if(!d.bga.annotationsUtils.getAggregateAnnotation(z))return new Map;const T=yield d.sessionStorage.getIgnoredSuggestions();return d.bga.annotationsUtils.suggestionsToShowCountByType(z,T)})}cPf(){const d=this;return Lo(function*(){const z=yield d.Knd(),T=d.bga.listsUtils.sum(z.values());
0===T?d.businessBar.Sga():d.INk(T,z)&&(yield d.b2k(T),d.Sib=!0)})}X9a(){this.z$b.isEnabled&&this.z$b.show()}b2k(d){const z=this;return Lo(function*(){z.zX.pauseAugmentationLoop("triggerDiscoverabilityBusinessBar");yield z.businessBar.y8a(d,()=>{z.LQh()})})}LQh(){this.X9a()}INk(d,z){var T;if(!(T=this.Sib)){T=this.$;var ya;(ya=v(T,this.state))||(T=T.ea,ya=!T.isEditMode&&!T.dm());T=ya}return T||2>d||!z.get("TextInconsistency")?!1:!0}};Uc.Yue="scek";Uc=qc=Object(rb.__decorate)([Object(zc.d)(oc.ob),Object(rb.__param)(0,
Object(oc.Nb)()),Object(rb.__param)(1,Object(oc.p)()),Object(rb.__param)(2,Object(oc.Pb)()),Object(rb.__param)(3,Object(oc.E)())],Uc);Object(Va.a)(Uc,"DataCleansingHostManager",sa.a,[]);var ld=a(265),yd=a(305),fe=a(283),De=a(16),Tb=a(944),Yc=a(19),Ld=a(773);const he=Yc.a.sri;let Ke=class extends ld.a{constructor(d,z){let T=document.getElementById(d.xi+Ed.a.Ntf);T||(T=Tb.a("div",d.xi+Ed.a.Ntf,"cui-taskpane"));super(T);this.UZ=0;this.Q$a=!1;this.ej=()=>{this.eF(!1)};this.$=d;this.taskPaneManager=z;
yd.a(d).Tq(this);this.$.gq(this.ej);this.isVisible=!1}jua(d){this.addHandler("EnrichmentTaskPaneVilibilityChanged",d)}XAa(d){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",d)}BDh(d){this.addHandler("EnrichmentTaskPaneOnFocus",d)}Dnk(d){this.removeHandler("EnrichmentTaskPaneOnFocus",d)}get isVisible(){return super.isVisible}set isVisible(d){super.isVisible=d;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Zo(){return this.isVisible}get hl(){return fe.a.Dli}get F9a(){return 10}get Xx(){return he}get titleText(){return Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")?
wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?CommonUiStrings.EnrichmentPaneTitle:CommonUIStrings.l_EnrichmentPaneTitle:"Enrichment"}get JP(){return 300}get isResizable(){return!1}get hj(){return this.domElement}get height(){return this.taskPaneManager.o1c.offsetHeight}get BJ(){return this.taskPaneManager.clb(this.hj,this.titleText,this.JP,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.JP)}gV(){return this.Q$a}q6(){return this.Q$a}dispose(){this.$&&
this.$.Yu(this.ej);this.taskPaneManager=this.$=null;super.dispose()}Vp(d,z){z||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!z}tq(d){return De.DOMElementExtensions.eo(this.hj,d)}Qs(){}nu(){}eF(d){(this.isVisible=this.Q$a=d)?this.taskPaneManager.PS("EnrichmentTaskPane",this.BJ):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane");d||(cd.f(this.$).Vp(!0,!1),this.$.Dm())}};Ke=Object(rb.__decorate)([Object(zc.d)(oc.Lb),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,Object(oc["if"])()),
Object(rb.__param)(2,Object(Ld.b)()),Object(rb.__param)(3,Object(oc.cb)())],Ke);Object(Va.a)(Ke,"EnrichmentTaskPane",ld.a,[602,4,239,47]);var Me=a(540),df=a(916);Object(zc.b)(oc.Pb,{Fk:"singleton"})(d=>Lo(function*(){yield Object(df.a)("excelCleanData",{va:d.va});const z=window.excelCleanData.ExcelCleanDataGlobal;z.init(new Me.a);ia.ULS.shipAssertTag(507777623,0,!!z,"Failed to initialize ExcelCleanDataGlobal");return z}));var xf=a(35);let fg=class{constructor(d,z){this.$=d;this.shortcutKeyManager=
z;this.Hhg=()=>{this.v$a(this.$.ea.gRa,this.$.ea.t6a);this.Q8k()};this.isMac=xf.a.isMac;Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8368791_ExtendedTooltips_NewArchitecture_UndoRedo")||this.shortcutKeyManager.O3e(this.Hhg)}dispose(){Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8368791_ExtendedTooltips_NewArchitecture_UndoRedo")||this.shortcutKeyManager.REg(this.Hhg);this.$=null}vEk(){const d=this.s_h.concat(this.ZGj).map(z=>appChrome.actions.setControlCustomTooltip(z.commandId,this.dmb(z)));appChrome.api.dispatch(d)}v$a(d,
z){this.V4k&&(this.nX[0].title=this.nX[2].title=this.Szb(d),this.nX[1].title=this.Sac(z),this.nX[1].shortcut=this.isMac?this.shortcutKeyManager.Pk(192):this.shortcutKeyManager.Pk(154));d=this.dmb(this.nX[1]);z=this.dmb(this.nX[2]);d=[appChrome.actions.setControlCustomTooltip(this.nX[0].commandId,this.dmb(this.nX[0])),appChrome.actions.setControlCustomTooltip(this.nX[1].commandId,d),appChrome.actions.setControlCustomTooltip(this.nX[2].commandId,z)];appChrome.api.dispatch(d)}get ZGj(){this.XQ||(this.XQ=
[],this.XQ.push(this.Ap("Paste_MLR",ab.a.instance.Ea(513),ab.a.instance.Ea(767),this.shortcutKeyManager.Pk(176))),this.XQ.push(this.Ap("Cut",ab.a.instance.Ea(511),ab.a.instance.Ea(768),this.shortcutKeyManager.Pk(172))),this.XQ.push(this.Ap("Copy",ab.a.instance.Ea(512),ab.a.instance.Ea(769),this.shortcutKeyManager.Pk(174))),this.XQ.push(this.Ap("AlignTop_MLR",ab.a.instance.Ea(791),ab.a.instance.Ea(792))),this.XQ.push(this.Ap("AlignMiddle_MLR",ab.a.instance.Ea(793),ab.a.instance.Ea(794))),this.XQ.push(this.Ap("AlignBottom_MLR",
ab.a.instance.Ea(795),ab.a.instance.Ea(796))),this.XQ.push(this.Ap("AlignLeft_MLR",ab.a.instance.Ea(797),ab.a.instance.Ea(799))),this.XQ.push(this.Ap("AlignCenter_MLR",ab.a.instance.Ea(800),ab.a.instance.Ea(801))),this.XQ.push(this.Ap("AlignRight_MLR",ab.a.instance.Ea(802),ab.a.instance.Ea(803))),this.XQ.push(this.Ap("IncreaseIndent",ab.a.instance.Ea(804),ab.a.instance.Ea(805))),this.XQ.push(this.Ap("DecreaseIndent",ab.a.instance.Ea(806),ab.a.instance.Ea(807))),this.XQ.push(this.Ap("Wrap",ab.a.instance.Ea(808),
ab.a.instance.Ea(809))),this.XQ.push(this.Ap("Merge",ab.a.instance.Ea(810),ab.a.instance.Ea(811))),this.XQ.push(this.Ap("NumberFormatPercentage_MLR",ab.a.instance.ia(453),ab.a.instance.Ea(814),this.shortcutKeyManager.Pk(404))),this.XQ.push(this.Ap("NumberFormatComma_MLR",ab.a.instance.Ea(815),ab.a.instance.Ea(816))));return this.XQ}get s_h(){this.iw||(this.iw=[],this.iw.push(this.Ap("UndoRedo",ab.a.instance.Ea(83),"",this.isMac?this.shortcutKeyManager.Pk(191):this.shortcutKeyManager.Pk(153))),this.iw.push(this.Ap("FormatPainter",
ab.a.instance.ia(14),ab.a.instance.Ea(770))),this.iw.push(this.Ap("FontName_New",ab.a.instance.Ea(771),ab.a.instance.Ea(772))),be.a.el()&&this.iw.push(this.Ap("FontPicker",ab.a.instance.Ea(771),ab.a.instance.Ea(772))),this.iw.push(this.Ap("FontSize",ab.a.instance.Ea(773),ab.a.instance.Ea(774))),this.iw.push(this.Ap("Bold",ab.a.instance.ia(1333),ab.a.instance.Ea(775),this.isMac?this.shortcutKeyManager.Pk(180):this.shortcutKeyManager.Pk(179))),this.iw.push(this.Ap("Italic",ab.a.instance.ia(1334),ab.a.instance.Ea(776),
this.isMac?this.shortcutKeyManager.Pk(184):this.shortcutKeyManager.Pk(183))),this.iw.push(this.Ap("BordersSplitButtonCompactMenu",ab.a.instance.Ea(777),ab.a.instance.Ea(779),this.isMac?this.shortcutKeyManager.Pk(190):this.shortcutKeyManager.Pk(189))),this.iw.push(this.Ap("FillColor",ab.a.instance.ia(537),ab.a.instance.Ea(780))),this.iw.push(this.Ap("FontColor",ab.a.instance.Ea(781),ab.a.instance.Ea(782))),this.iw.push(this.Ap("GrowFontSize",ab.a.instance.Ea(783),ab.a.instance.Ea(784),this.shortcutKeyManager.Pk(187))),
this.iw.push(this.Ap("ShrinkFontSize",ab.a.instance.Ea(785),ab.a.instance.Ea(786),this.shortcutKeyManager.Pk(188))),this.iw.push(this.Ap("Underline",ab.a.instance.ia(1335),ab.a.instance.Ea(787),this.isMac?this.shortcutKeyManager.Pk(182):this.shortcutKeyManager.Pk(181))),this.iw.push(this.Ap("Strikethrough",ab.a.instance.ia(1336),ab.a.instance.Ea(788),this.isMac?this.shortcutKeyManager.Pk(186):this.shortcutKeyManager.Pk(185))),this.iw.push(this.Ap("DoubleUnderline",ab.a.instance.Ea(789),ab.a.instance.Ea(790))),
this.iw.push(this.Ap("NumberFormatNew",ab.a.instance.Ea(812),ab.a.instance.Ea(813))),this.iw.push(this.Ap("NumberFormatAccountingNew",ab.a.instance.ia(449),ab.a.instance.Ea(817))),this.iw.push(this.Ap("IncreaseDecimal",ab.a.instance.Ea(818),ab.a.instance.Ea(819))),this.iw.push(this.Ap("DecreaseDecimal",ab.a.instance.Ea(820),ab.a.instance.Ea(821))),this.iw.push(this.Ap("ConditionalFormatting",ab.a.instance.Ea(822),ab.a.instance.Ea(823))),this.iw.push(this.Ap("CellStylesGallery",ab.a.instance.Ea(824),
ab.a.instance.Ea(825))),this.iw.push(this.Ap("FormatAsTableAlt",ab.a.instance.Ea(826),ab.a.instance.Ea(827))),this.iw.push(this.Ap("Format",ab.a.instance.Ea(828),ab.a.instance.Ea(829))),this.iw.push(this.Ap("AutoSum",ab.a.instance.Ea(830),ab.a.instance.Ea(831),this.shortcutKeyManager.Pk(259))),this.iw.push(this.Ap("SortAndFilter",ab.a.instance.Ea(832),ab.a.instance.Ea(833))),this.iw.push(this.Ap("FindAndSelect",ab.a.instance.Ea(834),ab.a.instance.Ea(835),this.shortcutKeyManager.Pk(85))),this.iw.push(this.Ap("AnalyzeData",
ab.a.instance.Ea(836),ab.a.instance.Ea(837))),this.iw.push(this.Ap("Sensitivity",ab.a.instance.Ea(838),ab.a.instance.Ea(839))),this.iw.push(this.Ap("InsertCells",ab.a.instance.ia(345),ab.a.instance.Ea(840),this.shortcutKeyManager.q7?this.shortcutKeyManager.Pk(409):"")),this.iw.push(this.Ap("DeleteCells",ab.a.instance.ia(409),ab.a.instance.Ea(841),this.shortcutKeyManager.q7?this.shortcutKeyManager.Pk(407):"")),this.iw.push(this.Ap("ClearCells",ab.a.instance.Ea(842),ab.a.instance.Ea(843))));return this.iw}get V4k(){this.nX||
(this.nX=[],this.nX.push(this.Ap("Undo",this.Szb(2),ab.a.instance.Ea(765),this.isMac?this.shortcutKeyManager.Pk(191):this.shortcutKeyManager.Pk(153))),this.nX.push(this.Ap("Redo",this.Sac(2),ab.a.instance.Ea(766),this.isMac?this.shortcutKeyManager.Pk(192):this.shortcutKeyManager.Pk(154))),this.nX.push(this.Ap("UndoRedo",this.Szb(2),"",this.isMac?this.shortcutKeyManager.Pk(191):this.shortcutKeyManager.Pk(153))));return this.nX}Ap(d,z,T,ya){return{commandId:d,title:z,description:T,shortcut:ya,N6i:ya?
!0:!1}}dmb(d){let z;z=d.title;d.N6i&&(z+=" "+d.shortcut);"UndoRedo"!==d.commandId&&(z+="\n\n"+d.description);return z}Szb(d){switch(d){case 1:case 0:return d=ab.a.instance.Ea(81);case 3:return d=ab.a.instance.Ea(84);case 2:return d=ab.a.instance.Ea(83);case 4:return d=ab.a.instance.Ea(82);default:return d=ab.a.instance.Ea(81)}}Sac(d){switch(d){case 1:case 0:return d=ab.a.instance.Ea(78);case 2:return d=ab.a.instance.Ea(80);case 4:return d=ab.a.instance.Ea(79);default:return d=ab.a.instance.Ea(78)}}Q8k(){var d=
this.Ap("InsertCells",ab.a.instance.ia(345),ab.a.instance.Ea(840),this.shortcutKeyManager.q7?this.shortcutKeyManager.Pk(409):"");const z=this.Ap("DeleteCells",ab.a.instance.ia(409),ab.a.instance.Ea(841),this.shortcutKeyManager.q7?this.shortcutKeyManager.Pk(407):"");d=[appChrome.actions.setControlCustomTooltip(d.commandId,this.dmb(d)),appChrome.actions.setControlCustomTooltip(z.commandId,this.dmb(z))];appChrome.api.dispatch(d)}};fg=Object(rb.__decorate)([Object(zc.d)(oc.Vb),Object(rb.__param)(0,Object(oc.Nb)()),
Object(rb.__param)(1,Object(oc.Zf)())],fg);Object(Va.a)(fg,"ExtendedTooltipsManager",null,[4]);var xg=a(1034),lg=a(88);let Vf=class extends sa.a{constructor(d){super();this.statusBarManager=null;this.tooltip=this.Zpb="";this.isVisible=!1;this.s$b=-1;this.sheetName=null;this.gr=()=>{this.Kac();this.$.ea.KA(this.gr)};this.GB=()=>{this.Kac();this.$.ea.TAa(this.GB)};this.rlg=()=>{this.Kac(!0);this.$.ea.TAa(this.rlg)};this.HYj=z=>{if(this.isVisible&&this.Zpb){z=this.da.oh.Kl(z);var T=this.$.sa.ma;if(z?
z.hasAutoFilter&&z.lWa:T&&0===T.zG&&T.hasAutoFilter&&T.lWa)this.Z7b(ab.a.instance.ia(2421),!0,z?this.iPd(z.name):this.hPd()),this.$v()}};this.M1b=()=>{this.Kac()};this.$=d;this.da=cd.f(this.$);this.ha=this.da.ha;this.qa=this.ha.qa;this.ha.Zw(this.M1b);this.$.la.fi(29,z=>{this.statusBarManager=z;z.hO(this)});this.$.ea.jn?this.Kac():this.$.ea.lw(this.gr)}oy(d){this.addHandler("FilteredResultsStateChangedEventKey",d)}cy(d){this.removeHandler("FilteredResultsStateChangedEventKey",d)}$v(){this.rr("QueryFilteredResultsButton")&&
this.raiseEvent("FilteredResultsStateChangedEventKey")}Zqc(){this.isVisible&&this.Zpb&&(this.Z7b(null,!1,null),this.$v())}X7k(d,z){this.s$b=d;this.sheetName=z}Z7b(d,z,T){this.Zpb=d;this.isVisible=z;this.tooltip=T}TBa(d,z,T){T=void 0===T?-1:T;null!==d&&d.HasFilters?(this.X7k(z?T:-1,this.$.sa.ma.name),T=new Rd.Range(d.FirstRow+1,d.FirstColumn+1,d.LastRow+1,d.LastColumn+1,!1,!1),T=z?this.da.oh.Kl(T):void 0,this.Z7b(this.Zpb=String.format(ab.a.instance.sh(233),d.NumRowsFiltered,d.LastRow-d.FirstRow),
!0,z?this.iPd(null===T||void 0===T?void 0:T.name):this.hPd()),this.$v()):(ia.ULS.sendTraceTag(507852319,0,50,"FilteredResultsStatusBarManager: EwaResult is null. All filters of that object will be cleared"),this.Zqc())}Kac(d){d=void 0===d?!1:d;if(!this.da.isEditing&&!this.da.lq){var z=!1,T=this.$.sa.ma,ya=this.da.oh.Kl(this.qa.activeCell);if(ya&&(d||ya.objectId!==this.s$b))if(this.s$b=ya.objectId,this.sheetName=T.name,ya.hasAutoFilter&&ya.lWa)this.Z7b(ab.a.instance.ia(2421),!0,this.iPd(ya.name)),
z=!0;else{this.Zqc();return}else if(!ya&&T&&0===T.zG){if(!this.sheetName||0<this.s$b||d||T.name!==this.sheetName)this.sheetName=T.name,T.hasAutoFilter&&T.lWa?T.rL&&(this.Z7b(ab.a.instance.ia(2421),!0,this.hPd()),z=!0):this.Zpb&&this.Zqc();this.s$b=-1}z&&this.$v()}}rr(){return Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)}Ay(d,z){if("QueryFilteredResultsButton"!==d)return!1;z[xg.a.Visible]=this.isVisible;z[xg.a.LabelText]=this.Zpb;window.setTimeout(()=>
{appChrome.api.dispatch(appChrome.actions.setControlCustomTooltip(lg.a.XGd,this.tooltip))},0);return!0}dispose(){this.$&&this.ha.vx(this.M1b);this.statusBarManager&&(this.statusBarManager.tN(this),this.statusBarManager=null);this.$=null;super.dispose()}iPd(d){return ab.a.instance.ia(2422)+`${d?": "+d:""}`}hPd(){return ab.a.instance.ia(2423)}};Vf=Object(rb.__decorate)([Object(zc.d)(oc.kc),Object(rb.__param)(0,Object(oc.Nb)())],Vf);Object(Va.a)(Vf,"FilteredResultsStatusBarManager",sa.a,[4,155,156]);
var dg=a(42);class Gg{constructor(d){this.$=d}get brd(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get wjj(){return this.isEnabled()&&Pb.EwaSettings.Ra(295)}get Cpb(){return this.isEnabled()&&Pb.EwaSettings.Ra(297)}get zpb(){return Pb.EwaSettings.Ra(296)}get Lxi(){return null}get $cg(){return 24}get LJg(){return 4E3}get n6b(){return this.$.ua.WebServiceBase||""}isEnabled(){if(wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.ka("IsAnonymousUser"):
1)return!1;const d=wa.AFrameworkApplication.ii?Object(Db.a)(String,wa.AFrameworkApplication.ii.AudienceGroup):"";return"Unknown"!==d&&"Automation"!==d}}Object(Va.a)(Gg,"FirstRunExperienceLauncherSettings",null,[617]);let Hg=class{constructor(d){this.uAf=dg.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher");this.zxi=new Gg(d);this.ate()}ate(){this.uAf&&this.uAf.ate(this.zxi)}};Hg=Object(rb.__decorate)([Object(zc.d)(oc.oc),Object(rb.__param)(0,Object(oc.Nb)())],
Hg);Object(Va.a)(Hg,"FirstRunExperienceManager",null,[601]);var Mg=a(244),Ff=a(1207),yf=a(13);let mg=class{constructor(d,z){this.wMa=1;this.Ota=[];this.active=!1;this.kG=()=>{const T=this.da.nPd();if(Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8645951_removeShouldWaitForAll")){if(0>=T||T===this.wMa)return}else if(0>=T||T===this.wMa||this.da.yx)return;let ya=!1;const sb=[],cc=[];for(var Fc=this.Ota.length-1;0<=Fc;Fc--){var Wc=this.Ota[Fc];if(this.mPd(Wc)>T||Wc.bottom<T)sb.push(Wc),this.Ota.splice(Fc,
1),ya=!0}for(Fc=this.Qj.rangeList.length-1;0<=Fc;Fc--){Wc=this.Qj.rangeList[Fc];const id=this.mPd(Wc);id<=T&&Wc.bottom>=T&&!(id<=this.wMa&&Wc.bottom>=this.wMa)&&Wc.Oxa&&(cc.push(Wc),ya=!0)}if(ya){Wc=this.da.C2b;for(const id of Wc)for(const Dd of id)for(const ee of Dd)this.wWh(ee,sb,cc)}else ia.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.wMa=T};this.Hlg=(T,ya)=>{ya.isRow||ya.bqd(this.XDc)};this.Ilg=(T,ya)=>{ya.isRow||(this.Qj.rangeList.length||
this.deactivate(),ya.Cje(this.XDc))};this.XDc=(T,ya)=>{if(this.Wj())this.activate();else if(T=this.active,this.deactivate(),!T){ia.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(ya=ya.uv)&&this.lXg(ya)};this.Qog=(T,ya)=>{!this.da.yx&&(this.Wj()?this.activate():(T=this.active,this.deactivate(),T||ia.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),
ya=ya.uv)&&(T=Ff.a(ya.m0a),this.lXg(ya)&&ya.zPg(T))};this.onActiveItemChanged=()=>{this.da.fh.Fy?this.deactivate():this.activate()};this.Qj=d;this.da=z;this.$=z.$;d.Opd(this.Qog);z.BCh(this.Hlg);z.CCh(this.Ilg);this.$.sa.pn(this.onActiveItemChanged);this.$.$h.pn(this.onActiveItemChanged);this.s8e(T=>{T.bqd(this.XDc)});this.Wj()&&(this.activate(),this.kG(this,null))}dispose(){this.deactivate();this.da&&(this.Qj.rje(this.Qog),this.da.Kmk(this.Hlg),this.da.Lmk(this.Ilg),this.$.sa.Gn(this.onActiveItemChanged),
this.$.$h.Gn(this.onActiveItemChanged),this.s8e(d=>{d.Cje(this.XDc)}));this.da=this.Qj=this.Ota=null}Y1c(d,z,T){if(!Id.b(this.$.ma)||this.$.ea.isNamedObjectViewMode||this.da.fh.V9a)return z&&ia.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const ya=T.lNf();if(Pb.EwaSettings.JWd()&&!ya)return ia.ULS.sendTraceTag(508368917,0,15,`HeaderSnappingFeature.toggleHeaderSnapping: HeaderNumbers should have been initialized, isActivate=${z}, headerViewBlock.hashCode=${T.hashCode}`),
!1;var sb=ya.length;if(ya[sb-1]<d.left)return!1;var cc=yf.HelperMethods.eK(new Mg.a(ya),0,sb,d.left,yf.HelperMethods.FS);if(0>cc)return!1;const Fc=d.T0g,Wc=d.m$e;sb=Math.min(Fc.length+cc,sb);let id=0;if(!Wc)return ia.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;cc<sb;cc++){const Dd=ya[cc],ee=Wc[id];z?(T.updateCellText(cc,Fc[id]),T.updateCellAlignment(cc,!0),Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8133326_fixAceRegressionInAutoFilterMenu")?
ee&&(T.activateCellAutoFilter(cc,ee),this.I2e(d,id,Dd)):(T.activateCellAutoFilter(cc,ee),this.I2e(d,id,Dd)),Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&T.o6g(cc,!0)):(T.updateCellText(cc,Rd.Range.rR(Dd)),T.updateCellAlignment(cc,!1),T.deactivateCellAutoFilter(cc),Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&T.o6g(cc,!1),this.uii(Dd));z&&T.sEk();id++}T.zr("HeaderSnappingFeature::toggleHeaderSnapping");d.Z8a=z;
return!0}I2e(d,z,T){oc.fb.Aa()?void zc.a.sj(oc.fb).then(ya=>{Pb.EwaSettings.IIc()?null===ya||void 0===ya?void 0:ya.fJa.f$d(d,z,T):ya.fJa.f$d(d,z,T)}):this.$.la.fi(8,ya=>{ya.fJa.f$d(d,z,T)})}uii(d){oc.fb.Aa()?void zc.a.sj(oc.fb).then(z=>{Pb.EwaSettings.IIc()?null===z||void 0===z?void 0:z.fJa.g$d(d):z.fJa.g$d(d)}):this.$.la.fi(8,z=>{z.fJa.g$d(d)})}wWh(d,z,T){if(d.hTh()){for(var ya=z.length-1;0<=ya;ya--)this.Y1c(z[ya],!1,d)&&(ia.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),
z.splice(ya,1));for(z=T.length-1;0<=z;z--)ya=T[z],this.Y1c(ya,!0,d)&&(ia.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.Ota.push(ya))}else ia.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}lXg(d){var z=d.lNf();if(Pb.EwaSettings.JWd()&&!z)return ia.ULS.sendTraceTag(508368916,0,15,`HeaderSnappingFeature.snapHeadersAfterGetRange: HeaderNumbers should have been initialized, headerViewBlock.hashCode=${d.hashCode}`),
!1;const T=z[0];z=z[z.length-1];const ya=this.KZi(T,z);let sb=!1;for(let cc=this.Ota.length-1;0<=cc;cc--){const Fc=this.Ota[cc];z>=Fc.left&&T<=Fc.right&&(this.Y1c(Fc,!1,d),this.Ota.splice(cc,1),sb=!0)}for(let cc=0,Fc=ya.length;cc<Fc;cc++)this.Y1c(ya[cc],!0,d)&&(this.Ota.push(ya[cc]),sb=!0);return sb}activate(){this.Wj()&&!this.active&&(this.da.view.oz(this.kG),this.active=!0)}deactivate(){this.active&&(this.da.view.dy(this.kG),this.active=!1)}Wj(){return Id.b(this.$.ma)&&!this.$.ea.isNamedObjectViewMode&&
0>=this.da.fh.IJ&&0<this.Qj.rangeList.length}s8e(d){const z=this.da.C2b;for(const T of z)for(const ya of T)for(const sb of ya)d(sb)}KZi(d,z){const T=[];if(!this.active)return T;this.wMa=this.da.nPd();for(let ya=this.Qj.rangeList.length-1;0<=ya;ya--){const sb=this.Qj.rangeList[ya];sb.bottom>=this.wMa&&this.mPd(sb)<=this.wMa&&sb.left>=d&&sb.right<=z&&sb.Oxa&&T.push(sb)}return T}mPd(d){const z=this.da.oh.Kl(d);return z&&this.Qj.k_f(d,z.usedRange.topLeft)?d.top+1:d.top}};mg=Object(rb.__decorate)([Object(zc.d)(oc.kd),
Object(rb.__param)(0,Object(oc.vg)()),Object(rb.__param)(1,Object(oc.id)())],mg);Object(Va.a)(mg,"HeaderSnappingFeature",null,[4]);var jh=a(145),bg=a(428),Og=a(63),rg=a(921);Object(zc.b)(oc.ud,{Fk:"singleton"})(()=>Lo(function*(){const d=dg.a.instance.Ho("Common.IInProductMessagingUIManager"),z=()=>{dg.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(T=>{void T.isFeatureEnabled("MsoPremiumBadge",!0).then(ya=>{!ya&&T.isFreemiumUpsellEnabled()&&d.t2d();return null})})};
Og.a.Wl.Ew?jh.a.get_instance().Fm(16,()=>{z()}):z();return d}));class Ma extends bg.a{constructor(d){super();this.dTd=null;this.$=d;this.gm()}create(){const d=Object(rg.a)(this.$.la,361,()=>this.W6h());this.Bk(d)}W6h(){this.dTd=dg.a.instance.Ho("Common.IInProductMessagingUIManager");Og.a.Wl.Ew?jh.a.get_instance().Fm(16,()=>{this.uVf()}):this.uVf();return this.dTd}uVf(){dg.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(d=>{d.isFeatureEnabled("MsoPremiumBadge",
!0).then(z=>{!z&&d.isFreemiumUpsellEnabled()&&this.dTd.t2d();return null})})}static Ba(d){d.la.Hh(362,new Ma(d))}}Object(Va.a)(Ma,"InProductMessagingManagerFactory",bg.a,[]);var Na=a(1088),Qc=a(255),ce=a(674);class ve extends Sys.EventArgs{constructor(){super()}}Object(Va.a)(ve,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var Ve=a(58),vf=a(41),Kf=a(729);class ng{constructor(d){this.data=d}}Object(Va.a)(ng,"NumberFormatDataHolder",null,[]);var Bf;let Uf=Bf=class extends sa.a{constructor(d){super();
this.v1d=Yd.a.Dk;this.xud=null;this.lAb=this.OKc=!1;this.Ggg=(z,T)=>{var ya;(z=cd.f(this.$))&&(T=null!==(ya=T.cell)&&void 0!==ya?ya:z.zh(null))&&this.zra(T.cell.qo,!0)};this.aTj=z=>{this.isActive()&&(na.a.Lx(z.Errors)||!z.Result?(z=z.Errors?z.Errors.map(T=>JSON.stringify(T)).join(","):"None",ia.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${z}`)):(z=z.Result,ia.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${z.Index}, category = ${z.Category}`),
this.wFk(z.Index,z.Category),this.raiseEvent(Bf.jvd,new Na.a(z.Index,z.Category),this)))};this.refresh=()=>{ia.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.pqc();this.isActive()&&this.ea.Ih.allowEdits&&(this.lAb||this.mx&&!(this.ea.NC>this.v1d)?this.n5c():(ia.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.GMd=ce.a(this.$.pa.ta,this.mx?this.mx.Digest:"",this.KTj,
this.JTj,null,null)),ia.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.nHf())};this.clg=z=>{ia.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${z.data.status}, HTTP status = ${z.data.httpStatus}.`);this.n_a=null};this.L1=()=>{this.lAb=!1;this.ea.hL(this.L1);this.D7a(this.OKc?Bf.mre:Bf.B7d)};this.ij=(z,T)=>{ia.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");
Qc.a(T)&&this.D7a(Bf.mre)};this.Dl=()=>{ia.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.L7d(0===this.$.workbookContext.CalcMode)};this.Cj=()=>{ia.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.D7a(Bf.mre);3!==this.$.workbookContext.CalcMode&&this.L7d(0===this.$.workbookContext.CalcMode)};this.BTj=(z,T,ya)=>{ia.ULS.sendTraceTag(537155712,0,
50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.n_a=null;this.isActive()?z.StateId===Yd.a.Dk?(ia.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.n5c()):!z.Result||this.w9&&this.w9.length?this.D7a(Bf.B7d):this.hpg(z,T,ya):ia.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.hpg=z=>{this.w9=
z.Result;ia.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.w9?this.w9.length:-1} functions.`);z=!1;if(this.w9){for(const T of this.w9)T&&(this.vCf[T.NameUI.toLocaleUpperCase()]=T.FunctionIndex.toString(),T.NameUI!==T.NameDataStrings&&(this.vCf[T.NameDataStrings.toLocaleUpperCase()]=T.FunctionIndex.toString(),z=!0),this.NAi.ga(T.FunctionIndex,T.NameUI));this.raiseEvent(Bf.lJd,Sys.EventArgs.Empty,this)}z&&
ia.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.KTj=z=>{if(this.isActive())if(ia.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.OKc=!1,this.v1d=z.StateId,this.v1d===Yd.a.Dk)this.OKc=!0,this.n5c();else{if(z.Result){var T=this.mx;this.mx=z.Result;ia.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.mx.Digest}.`);z=[];if(T)z=Bf.iQi(T.NumberFormats,
this.mx.NumberFormats);else for(T=0;T<this.mx.NumberFormats.length;T++)this.nOc.ga(T,this.mx.NumberFormats[T].NumberFormatCategory);for(const ya of z)this.nOc.ga(ya,this.mx.NumberFormats[ya].NumberFormatCategory);this.raiseEvent(Bf.e8d,new ve(z),this);this.raiseEvent(Bf.c8f)}this.D7a(Bf.B7d)}};this.JTj=z=>{this.isActive()&&(10===z.data.status?ia.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(ia.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${z.data.status}, HTTP status = ${z.data.httpStatus}.`),
this.OKc=!0,this.n5c()))};ia.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=d.ea;this.$=d;this.mx=this.n_a=this.GMd=this.t4b=null;this.nOc=new jf.a;this.eRb=new jf.a;this.w9=[];this.NAi=new jf.a;this.vCf={};this.ea.$q(this.ij);this.$.mr(this.Cj);cd.f(this.$).ha.kGa(this.Ggg);this.ea.pz(this.Dl);this.D7a(Bf.XTf);ia.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}ypd(d){this.addHandler(Bf.e8d,d)}eVc(d){this.removeHandler(Bf.e8d,
d)}wBh(d){this.addHandler(Bf.jvd,d)}Olk(d){this.removeHandler(Bf.jvd,d)}j4e(d){this.addHandler(Bf.lJd,d)}Wie(d){this.removeHandler(Bf.lJd,d)}iDh(d){this.addHandler(Bf.c8f,d)}get zk(){return this.mx?this.mx.LocaleInformation:null}get lNa(){return this.mx?this.mx.NumberFormats:[]}get Qwa(){this.w9&&this.w9.length||this.nHf();return this.w9}get Uej(){return this.mx&&void 0!==this.mx.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.mx.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.mx.InstantaneousCalcWebWorkerPrecisionSamplingRate:
Bf.hci}get Xej(){return this.mx&&void 0!==this.mx.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.mx.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.mx.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:Bf.lci}get Wej(){return this.mx&&void 0!==this.mx.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.mx.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.mx.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:Bf.kci}get Vej(){return this.mx&&
void 0!==this.mx.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.mx.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.mx.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:Bf.jci}get ZUb(){return this.mx?this.mx.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:Bf.ici}get GFc(){return null!==this.xud?this.xud:!1}y3k(d){let z;if(!d)return{returnValue:!0,category:"General"};let T;z="";if(!(()=>{let ya=this.zra(d,!1);({category:T}=ya);return ya})().returnValue)return{returnValue:!1,
category:z};z=this.w2h(T);return{returnValue:!0,category:z}}w2h(d){let z="";switch(d){case 0:z="General";break;case 1:z="Number";break;case 2:z="Currency";break;case 3:z="Accounting";break;case 4:z="Date";break;case 5:z="Time";break;case 6:z="Percentage";break;case 7:z="Fraction";break;case 8:z="Scientific";break;case 9:z="Text";break;case 10:z="Special";break;case 11:z="Custom"}return z}zra(d,z){let T,ya=(()=>{let sb=this.nOc.wj(d,0);({value:T}=sb);return sb})().returnValue;!ya&&0<d&&this.$&&(ia.ULS.sendTraceTag(537155735,
0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${d}`),this.KGi(d),z&&(T=this.JGi(d),ya=!0),Kf.a(d,this.$.EN)&&(T=6));return{returnValue:ya,category:T}}ulj(d){let z=0;if((()=>{let T=this.zra(d,!0);({category:z}=T);return T})().returnValue)return 6===z;ia.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${d}`);return!1}jzi(d){this.ea.ki&&
(ia.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions"),this.n_a=dc.p(this.$.pa.ta,{FilterType:0},uc.c(this.hpg,d),this.clg,null,null,null))}CBf(){this.D7a(Bf.XTf)}X5h(){return Object(ne.c)(this.zk.ErrorNames)?(ia.ULS.shipAssertTag(508699781,0,!1,"ErrorNames undefined"),this.DJi()):this.zk.ErrorNames.map((d,z)=>excelOnlineCalc.calc.errorTypeName(z+1,d))}DJi(){const d=[],z=Object.keys(Yd.a.errorNames);for(let T=0;T<z.length;T++){const ya=
excelOnlineCalc.calc.errorTypeName(T+1,z[T]);ya&&d.push(ya)}return d}L7d(d){this.xud=d}KGi(d){if(this.eRb&&this.$){var z;if(!(()=>{let ya=this.eRb.wj(d);({value:z}=ya);return ya})().returnValue||z.isCompleted){ia.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${d}`);var T=ce.c(this.$.pa.ta,d,this.aTj,null,null,null);T&&this.eRb.ga(d,T)}}else ia.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}JGi(d){return 1<=
d&&8>=d?1:9<=d&&12>=d?2:13===d||14===d?6:15===d?8:17===d|18===d?7:19===d?4:16===d||20<=d&&29>=d||31===d?11:30===d?9:32<=d&&35>=d?3:0}isActive(){const d=void 0===this.ea||null===this.ea,z=!d&&this.ea.ki;ia.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${z} - sessionStateManager IsNullOrUndefined: ${d}`);return z}wFk(d,z){this.nOc.ga(d,z)}dispose(){nb.a.dh(this.t4b);this.t4b=null;this.pqc();for(const d of this.eRb){const z=
d.value;z&&!z.isCompleted&&wa.AFrameworkApplication.rj.fE(z.uD)}this.eRb=null;this.ea&&(this.ea.Uq(this.ij),this.lAb&&this.ea.hL(this.L1),this.lAb=!1,this.ea.LA(this.Dl));this.ea=null;this.$&&cd.f(this.$)&&cd.f(this.$).ha&&(cd.f(this.$).ha.RAa(this.Ggg),this.$.Wr(this.Cj));this.$=null;super.dispose()}isFeatureEnabled(d){try{switch(d){case "LocaleLongDateFormat":return Pb.EwaSettings.Ra(184);case "GetLocaleDayNames":return Pb.EwaSettings.Ra(185);case "OfficeVSO:3657744_CalcFixForDateFormat":return Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");
case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return Pb.EwaSettings.Ra(101);
default:return d.startsWith("OfficeVSO:")?Pb.EwaSettings.isChangeGateEnabled(d):!1}}catch(z){return ia.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${d}): feature parsing failed, returning false. Exception: ${z.toString()}.`),!1}}D7a(d){this.isActive()&&this.ea.Ih.allowEdits?(nb.a.dh(this.t4b),this.t4b=null,this.t4b=Ve.a.instance.create(this.refresh,d,vd.a.Yej)):ia.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==
this.ea&&null!==this.ea&&void 0!==this.ea.Ih&&null!==this.ea.Ih?this.ea.Ih.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}nHf(){ia.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.n_a?ia.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.w9&&this.w9.length||(this.n_a=dc.p(this.$.pa.ta,{FilterType:0},this.BTj,
this.clg,null,null,null)):ia.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}n5c(){this.lAb||(this.lAb=!0,this.ea.dK(this.L1))}pqc(){this.fE(this.GMd);this.fE(this.n_a);this.n_a=this.GMd=null}fE(d){d&&!d.isCompleted&&this.$.pa.ta.pzb(d.uD)}static iQi(d,z){if(!d||!d.length)return[];if(!z||!z.length){var T=Array(d.length);for(var ya=0;ya<d.length;++ya)T[ya]=d[ya].IfmtIndex;return T}T=new jf.a;for(var sb of d)T.ga(sb.IfmtIndex,
new ng(sb));d=new Nb.a;for(ya of z)sb=T.wj(ya.IfmtIndex),{value:z}=sb,sb.returnValue&&z.data.FormatString===ya.FormatString||d.add(ya.IfmtIndex);return d.toArray()}};Uf.e8d="isim0";Uf.jvd="isim1";Uf.lJd="isim2";Uf.c8f="isim3";Uf.XTf=100;Uf.mre=1E3;Uf.B7d=3E5;Uf.hci=.001;Uf.lci=.1;Uf.kci=.2;Uf.jci=.001;Uf.ici=50;Uf=Bf=Object(rb.__decorate)([Object(zc.d)(oc.Cd),Object(rb.__param)(0,Object(oc.Nb)())],Uf);Object(Va.a)(Uf,"InstantaneousSupportInformationManager",sa.a,[600,4]);Object(zc.b)(oc.Ld,{Fk:"singleton"})(d=>
Lo(function*(){if(Qf.uVd()){var z=yield zc.a.resolve(oc.Md,d);z=yield Object(Cf.e)(z.FTg());return new Qf(z)}return new Qf(!0)}));class Qf{constructor(d){this.Uxb=!0;Qf.whj()?this.Uxb=!1:Qf.uVd()?(ia.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!d}`),this.Uxb=d):this.Uxb=!1}Cob(){return!this.Uxb}static uVd(){return!Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableLineageTUI",!1)}static whj(){return Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",
!1)}}Object(Va.a)(Qf,"LineageCatchUpExperimentManager",null,[598]);var ug;let ag=ug=class{constructor(d,z){this.UYd=!1;this.Dl=()=>{this.t2g()};this.$=d;this.$.ea.zqb&&!ug.BTb&&(z&&!z.Uxb||this.idl(),ug.FQf?ia.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):z&&!z.Uxb||this.qdl());ia.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.oie();this.$=null;
ia.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){ug.BTb||(ug.BTb=!0,ia.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.oie()}qdl(){this.$.isAnonymousUser()||dc.j(this.$.pa.ta,d=>{this.$?(d=d.Result,ia.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${d}.`),ug.FQf=!0,d&&this.Z1g(0)):ia.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},
()=>{ia.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}idl(){this.t2g()||(this.$.ea.pz(this.Dl),this.UYd=!0)}t2g(){return this.$.ea&&this.$.ea.Qq&&this.$.ea.Qq.ShouldTriggerLineageCalloutOnMerge?(ia.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.Z1g(1),!0):!1}Z1g(d){ug.BTb?ia.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):
(ug.BTb=!0,ia.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${d}.`),this.oie(),Pb.EwaSettings.Ra(418)&&(d=new Sd.a(-847286761,$d.a.rh,this.$.hi,0,Ed.a.K7),this.$.Ma.qh(d,{["CalloutName"]:4})))}oie(){this.UYd&&(this.UYd=!1,this.$.ea.LA(this.Dl))}};ag.BTb=!1;ag.FQf=!1;ag=ug=Object(rb.__decorate)([Object(zc.d)(oc.Pd),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,Object(oc.Ld)())],ag);Object(Va.a)(ag,"LineageTeachingCalloutTriggerManager",
null,[596,4]);let Dg=class{constructor(d){this.K$d=z=>{this.fHg(z.detail.viewportScenarioContext,"eventHandler")};d.L2e(this.K$d,(new AbortController).signal)}fHg(d,z){try{ia.ULS.sendTraceTag(1851881062,1,15,`NavigationFailHandler.onNavigationFailed: from ${z}, context = ${this.zlf(d)}`)}catch(T){ia.ULS.sendTraceTag(507590041,1,15,`NavigationFailHandler.onNavigationFailed: from ${z}, exception = ${T.message}`)}}zlf(d){const z=d.targetRange;return JSON.stringify({name:d.name,targetRange:null===z||
void 0===z?void 0:z.toString(),requiredViewportStateIdStateId:d.O5b})}};Dg=Object(rb.__decorate)([Object(zc.d)(oc.be),Object(rb.__param)(0,Object(oc.Rg)())],Dg);Object(Va.a)(Dg,"NavigationFailHandler",null,[]);class Tg{}Tg.yxj=3;Tg.connected=0;Object(Va.a)(Tg,"ConnectionStateConstants",null,[]);class ig{constructor(d,z,T){var ya;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=
0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.Chg=(cc,Fc)=>{this.blockedOperationsCount++;cc=`${Fc.componentName}_${Fc.actionName}_${Fc.details})`;this.blockedActions[cc]=this.blockedActions[cc]?this.blockedActions[cc]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.Sae=cc=>{this.durationUntilUserInactive=
zd.getElapsedSeconds(this.startTime,Td.a.ih.ri);cc.Dje(this.Sae)};this.OP=()=>{this.hasTabbedOut=!0};this.Dpa=(cc,Fc)=>{Fc.fug!==this.type||this.isToastShown||(this.durationUntilToastShownMs=Yb.a(Td.a.ih,this.startTime),this.toastRaiser=Fc.toastRaiser,this.isToastShown=!0)};this.startTime=d;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=T;if(null===(ya=z.ea)||void 0===ya?0:ya.Hl)this.wasUserActiveOnPIStart=z.ea.Hl.yv;this.Hp(z);this.isDialogShown=0<z.vh.U1;let sb=null;be.a.Ut()?
void zc.a.resolve(oc["if"],{va:1}).then(cc=>{sb=cc}):sb=z.la.kh(183);this.isTaskPaneShown=!!sb&&sb.isVisible&&!sb.isCollapsed;this.isTaskPaneCollapsed=!!sb&&sb.isVisible&&sb.isCollapsed}WOg(){this.durationMs=Yb.a(Td.a.ih,this.startTime)}V$d(d){var z;this.WOg();Ja.a(d).k5b(this.Chg);Ja.a(d).Tm.lVc(this.Dpa);Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void zc.a.resolve(oc.Cb).then(T=>{T.S6a(this.OP)}):d.la.fi(291,T=>{T.S6a(this.OP)});if(null===
(z=d.ea)||void 0===z?0:z.Hl)d.ea.Hl.Dje(this.Sae),this.wasUserActiveOnPIEnd=d.ea.Hl.yv}Hp(d){Ja.a(d).Vmc(this.Chg);this.isToastShown?this.toastRaiser="Immediate":Ja.a(d).Tm.Hpd(this.Dpa);Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void zc.a.resolve(oc.Cb).then(z=>{this.hasTabbedOut=z.un;z.f$(this.OP)}):d.la.fi(291,z=>{this.hasTabbedOut=z.un;z.f$(this.OP)});this.wasUserActiveOnPIStart&&d.ea.Hl.d5e(this.Sae)}}Object(Va.a)(ig,"PartialInteractivityData",
null,[]);var Yg=a(1212);class vh extends ig{constructor(d,z,T,ya,sb,cc){super(d,z,ya);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=null;this.type=4;this.swappedOffline=T;this.disconnectionSource=Enum.toString(Yg.a,sb);this.triggeringRequest=cc}KPj(d,
z){this.swappedByOffline=z;this.V$d(d)}DDk(d){this.errorDataDuringConnectivityIssuesMode=d}Vfk(d){10>this.failedRequests.length&&(d=d+"_"+zd.getElapsedSeconds(this.startTime,Td.a.ih.ri).toString(),this.failedRequests.push(d))}}Object(Va.a)(vh,"ConnectivityIssuesData",ig,[]);var Zg=a(162),Qg=a(143),Wg=a(129);class dh{}dh.Hii="DuringWork";dh.connectivityIssues="ConnectivityIssues";dh.offline="Offline";Object(Va.a)(dh,"UnavailabilityTypes",null,[]);var gh=a(62);class Gh{constructor(d){this.KKc=this.data=
null;this.CGd=0;this.wif=null;this.Sig=(z,T)=>{T.iU?(this.data=new vh(Td.a.ih.ri,this.$,5===T.ora,0!==T.ora,this.$.km.disconnectionSource,this.wif),this.KKc=this.$.km.p6f,this.CGd=1,this.$.pa.km.jFh(this.Wy),Zg.a(this.$).dpd(this.fLg)):(this.data.KPj(this.$,5===T.ora),this.$.pa.km.bGg(this.Wy),this.data.lastFailedRequestToOnlineTimeGapSec=zd.getElapsedSeconds(this.KKc,Td.a.ih.ri),Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?gh.b().j7b(557682689,
0,50,dh.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",nc.a.Ci(this.data)):ia.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${nc.a.Ci(this.data)}`),this.data&&this.data.isToastShown&&fa.Health.instance.recordQosError(Qg.a.UXh,[Wg.a.ELc],!0,!1,!1,!1,null),Zg.a(this.$).Pie(this.fLg),this.data=null)};this.fLg=(z,T)=>{this.data.DDk(T.aP)};
this.Wy=(z,T)=>{this.data.Vfk(T.context.methodName);z=Td.a.ih.ri;T=zd.getElapsedSeconds(this.KKc,z);this.KKc=z;T>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=T);this.CGd++;this.data.averageDurationBetweenFailedRequestsSec=this.VRh(T)};this.Pig=(z,T)=>{this.wif=T.J2k};this.$=d;Ja.a(this.$).Tm.V3e(this.Sig);this.$.km.U3e(this.Pig)}dispose(){this.$&&(Ja.a(this.$).Tm.$Eg(this.Sig),this.$.km&&this.$.km.ZEg(this.Pig));this.data&&this.$.pa.km.bGg(this.Wy);
this.$=null}VRh(d){const z=this.CGd-1;return(this.data.averageDurationBetweenFailedRequestsSec*(z-1)+d)/z}}Object(Va.a)(Gh,"ConnectivityIssuesTelemetryManager",null,[4]);var Ch=a(1397),Dh=a(1211),Xg=a(1210);class og{constructor(d){this.YJg=null;this.b1d=this.W5d=this.y0b=this.z0b=0;this.bse=!1;this.Nxd=this.X8a=this.J_c=this.Lrb=null;this.Zxd=0;this.zzk=()=>{if(12E4>this.$.ea.Hl.Nyb)for(const z of this.J_c)z.runTest();else this.eve("UserInactive")};this.hrk=z=>{z=Sys.Serialization.JavaScriptSerializer.serialize(z);
ia.ULS.sendTraceTag(388821830,0,50,z)};this.tqk=z=>{if(z){var T=this.Nxd[z.testIteration.toString()];T?T.push(z):(T=[z],this.Nxd[z.testIteration.toString()]=T);if(T.length===this.YJg.length){T=Sys.Serialization.JavaScriptSerializer.serialize(T);if(this.$&&this.$.km){if(z.EstimatedLatency=this.$.km.v$e,this.$.km.v$e>this.$.BI.ExcelRountripThresholdMs){ia.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${T}, consequtive slow ping iteration #: ${this.Zxd++}`);return}}else ia.ULS.sendTraceTag(537155209,
0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");ia.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${T}`);this.Zxd=1}}};this.xp=(z,T)=>{z=T.context.methodName;if(z===Yd.a.vSb||z===Yd.a.rKa)this.y0b++,z=Date.now(),this.RLk(z)&&(this.y0b=0,this.b1d=z,this.fVk())};this.Cpa=()=>{this.Iue("OnThrottledUserActivity")};this.OP=()=>{this.eve("OnDocumentHidden")};this.kJ=()=>{this.Iue("OnDocumentUnhidden")};this.$=d;if(this.dse=this.lWh())this.YJg=[Xg.a.O5c],
this.Zxd=1,this.Nxd={},this.$.ea.Hl.qGa(this.Cpa),Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void zc.a.resolve(oc.Cb).then(z=>{z.f$(this.OP);z.c4(this.kJ)}):this.$.la.fi(291,z=>{z.f$(this.OP);z.c4(this.kJ)})}dispose(){this.$&&(this.bse&&this.$.pa&&0<this.Lrb.count&&this.$.pa.iL(this.xp),this.dse&&(this.eve("Dispose"),this.$.ea.Hl.aPa(this.Cpa)))}taj(){Pb.EwaSettings.Ra(199)&&this.f9j();this.dse&&this.g9j()}Xaj(){this.y0b=this.z0b;this.b1d=
0;var d={};if(!this.Lrb){this.Lrb=new Nb.a;const z=Dh.a.DJd(this.hrk,"InitSampleMeasurement",this.$);for(const T of z)d[T.lSd]=T.baseUrl,this.Lrb.add(T)}d=Sys.Serialization.JavaScriptSerializer.serialize(d);ia.ULS.sendTraceTag(537155210,0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.z0b}, numberOfRequestFromTheLastNetworkMeasurement: ${this.y0b}, testParams: ${d} `);0<this.Lrb.count&&this.$.pa.yI(this.xp)}fVk(){for(const d of this.Lrb)d.runTest()}Iue(d){this.X8a&&
this.X8a.Vt||(ia.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${d}`),this.X8a=Ve.a.instance.LO(this.zzk,5E3,vd.a.$Sk),this.X8a.c1())}eve(d){this.X8a&&this.X8a.Vt&&(ia.ULS.sendTraceTag(537155207,0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${d}`),this.X8a.cancel())}RLk(d){return this.y0b>=this.z0b&&d-this.b1d>this.W5d}lWh(){return og.NJg(this.$.ua.SlowNetworkMeasurementsSamplePercentage)}f9j(){this.z0b=
this.$.ua.NumberOfRequestToWaitPerNetworkMeasurement;this.W5d=1E3*this.$.ua.MinTimeBetweenNetworkMeasurementInSec;const d=this.$.ua.NetworkMeasurementsSamplePercentage;0<this.z0b&&0<this.W5d&&(this.bse=og.NJg(d))&&this.Xaj()}g9j(){if(!this.J_c){this.J_c=new Nb.a;const d=Dh.a.DJd(this.tqk,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Xg.a.O5c]);for(const z of d)this.J_c.add(z);this.$.ea.Hl.yv&&this.Iue("PrepareAndInitSlowNetworkTests")}}static NJg(d){return 100*Math.random()<d}}Object(Va.a)(og,
"NetworkMeasurement",null,[4]);var Ug=a(39),Rg=a(159),fi=a(607);class Sg{constructor(d){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=d}get count(){return this._count}get P4(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}w7k(){this.P4&&this.P4.WOg()}jzh(d){this.allOfflinePartialInteractivitiesDataInSession.push(d);this._count++}}
Object(Va.a)(Sg,"OfflinePartialInteractivitiesDataForLog",null,[]);class Bg extends ig{constructor(d,z,T){super(d,z,T);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=null;this.timeFromLastOffline=-1;this.type=5}sHk(d){this.timeFromLastOffline=d}EDk(d){this._errorDataDuringOfflineMode=d}}Object(Va.a)(Bg,"OfflinePartialInteractivityData",ig,[]);class zg{constructor(d,z){this.r4a=this.P4=null;this.nee=-1;this.mQb=null;this.j6f=je.Task.delay(0);this.Fsb=(T,ya)=>{ya.iU?this.wXj(ya.ora):this.xXj()};
this.Dpa=(T,ya)=>{5===ya.fug&&this.wkb()};this.gLg=(T,ya)=>{this.P4.EDk(ya.aP)};this.wkb=()=>{this.r4a.w7k();this.Lwk(zg.ece,Sys.Serialization.JavaScriptSerializer.serialize(this.r4a))};this.Vqk=T=>{if(T=T.result)this.R9g=!0,ia.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${T}`)};this.ekk=()=>{this.R9g&&(this.$?Ug.TaskExtensions.Xa(this.indexedDB.IBd(zg.ece),()=>{ia.ULS.sendTraceTag(537155204,
0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.ya):ia.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.v4a=()=>{if(this.r4a&&0<this.r4a.count){const T=Sys.Serialization.JavaScriptSerializer.serialize(this.r4a);ia.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${T}`)}};
this.$=d;this.indexedDB=z;this.R9g=!1;this.indexedDB.zl()&&(this.indexedDB.initialize(zg.pnb,zg.qnb),this.nqk(),this.r4a=new Sg(this.$.ua.UserSessionId),Ja.a(this.$).Tm.zpd(this.Fsb));this.du=Rg.a.instance.BU();this.du.Ba("beforeunload",this.v4a)}dispose(){this.$&&Ja.a(this.$)&&Ja.a(this.$).Tm.jje(this.Fsb);nb.a.dh(this.mQb);this.$=this.mQb=null}wXj(d){this.P4=new Bg(Td.a.ih.ri,this.$,0!==d);this.P4.sHk(-1!==this.nee?window.performance.now()-this.nee:-1);this.r4a.jzh(this.P4);Ja.a(this.$).Tm.Hpd(this.Dpa);
this.wkb();this.mQb=Ve.a.instance.LO(this.wkb,zg.lyi,vd.a.wkb);Zg.a(this.$).dpd(this.gLg)}xXj(){this.P4.V$d(this.$);this.wkb();nb.a.dh(this.mQb);this.mQb=null;this.nee=window.performance.now();Ja.a(this.$).Tm.lVc(this.Dpa);Zg.a(this.$).Pie(this.gLg);this.uqk()}Lwk(d,z){this.$?this.j6f=Ug.TaskExtensions.Xa(this.j6f,()=>{this.indexedDB.lBa(new fi.a(d,z))},this.$.ya):ia.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}nqk(){const d=
this.$.ya;Ug.TaskExtensions.Xa(Ug.TaskExtensions.Xa(this.indexedDB.fxa(zg.ece),this.Vqk,d),this.ekk,d)}uqk(){if(this.P4){const d=Sys.Serialization.JavaScriptSerializer.serialize(this.P4);Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?gh.b().j7b(560791645,0,50,dh.offline,this.P4.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",d):ia.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${d}`)}this.P4&&
this.P4.isToastShown&&fa.Health.instance.recordQosError(Qg.a.jbl,[Wg.a.ELc],!0,!1,!1,!1,null)}}zg.pnb="NetworkAvailability";zg.qnb="NetworkAvailabilityData";zg.ece="partialInteractivityData";zg.lyi=3E3;Object(Va.a)(zg,"OfflineModeTelemetryManager",null,[4]);var Ng=a(1414);const Ig=d=>{d.isSuccess||(d=Sys.Serialization.JavaScriptSerializer.serialize(d),ia.ULS.sendTraceTag(509669840,0,10,d))};class bh{constructor(d,z){this.Hza=this.a7d=this.xgg=null;this.$=d;Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
xf.a.Am||(this.xgg=new zg(d,z));Pb.EwaSettings.Ra(199)&&(this.a7d=new og(this.$),this.a7d.taj());Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&xf.a.Am||(this.Hza=new Ch.NetworkConnectionHealthChecker(this.$));this.R0h=new Gh(this.$);Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(d=this.$,z=Pb.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==z&&(new Ng.a(d,"1CDN",z,Ig,"runOneCdnNetworkTest")).runTest())}dispose(){nb.a.dh(this.xgg);
nb.a.dh(this.a7d);nb.a.dh(this.Hza);nb.a.dh(this.R0h);this.$=null}}Object(Va.a)(bh,"NetworkConnectionTelemetryManager",null,[4]);class wh extends ig{constructor(d,z,T,ya){super(d,z,T);this.wasInteruptedByOfflineMode=!1;this.type=ya;this.wasInteruptedByOfflineMode=!1}Fsb(){this.wasInteruptedByOfflineMode=!0}}Object(Va.a)(wh,"SilentReopenData",ig,[]);class Ga{constructor(d){this.pja=null;this.Rqg=(z,T)=>{this.Pqg(T,3)};this.Ymg=(z,T)=>{this.Pqg(T,2)};this.$=d;this.Tm=Ja.a(this.$).Tm;this.Tm.u4e(this.Ymg);
this.Tm.LEh(this.Rqg)}dispose(){this.Tm.xFg(this.Ymg);this.Tm.Fok(this.Rqg);this.pja=this.Tm=this.$=null}Pqg(d,z){d.iU?this.pja=new wh(Td.a.ih.ri,this.$,0!==d.ora,z):(5===d.ora&&(this.pja.wasInteruptedByOfflineMode=!0),3!==d.ora&&2!==d.ora||ia.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.pja.V$d(this.$),2===z?Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?
gh.b().k7b(571289604,0,50,dh.offline,this.pja.durationMs,this.pja):ia.ULS.sendTraceTag(571289604,0,50,nc.a.Ci(this.pja)):Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?gh.b().k7b(542782150,0,50,dh.Hii,this.pja.durationMs,this.pja):ia.ULS.sendTraceTag(542782150,0,50,nc.a.Ci(this.pja)),this.pja=null)}}Object(Va.a)(Ga,"SilentReopenPartialInteractivityTelemetryManager",null,[4]);let Qb=class extends sa.a{constructor(d,z,T){T=void 0===T?!0:T;super();
this.Qca=this.ksc=this.s4a=this.XBa=this.O8a=null;this.xeg=0;this.pUc=this.$ub=this.avb=!1;this.zeg=this.documentVisibilityObserver=null;this.DEa=!1;this.eTd=this.yja=0;this.tXb=!1;this.EWg=0;this.Sre=!1;this.ada=null;this.Lng=()=>{ia.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.yNc(1,!1)};this.kJ=()=>{this.vya||this.NZb?window.setTimeout(()=>{this.xxe()},this.xeg):this.xxe();this.documentVisibilityObserver.ZOa(this.kJ);this.tXb=!1};this.Rl=
()=>{ia.ULS.sendTraceTag(537155218,0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.NZb}, IsInDuringWorkSilentReopenMode:${this.rMc&&!this.DEa}`);this.NZb&&this.W0e();this.rMc&&!this.DEa&&this.S0e();cd.f(this.$).cellTextEditBox.Lw(this.Rl);this.avb=this.$ub=!1};this.Nng=()=>{ia.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.yNc(1,!0);this.$ub&&!this.avb&&cd.f(this.$).cellTextEditBox.Lw(this.Rl);this.$ub=
!1};this.Cpa=(ya,sb)=>{this.eTd=this.yja;this.yja=sb.M1c};this.Qqg=()=>{this.$&&(this.pUc||(bd.a(this.$).I5(hb.a.WNa).hCh(this.Yng),this.$.mr(this.Cj),this.pUc=!0),this.DEa=this.mhj(),this.yNc(2,!1))};this.Yng=()=>{var ya=bd.a(this.$).Zp;const sb=ya.eJh();ya=ya.aC.xj.errors.map(cc=>cc.MessageIdName);ia.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${sb}, IsB2W:${this.DEa}, Errors: ${nc.a.Ci(ya)}`);sb&&(this.O8a?(this.DEa=
!1,this.Mnf(),this.V2c()):this.XBa&&(this.Nnf(),this.V2c()))};this.Cj=()=>{this.$?(ia.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.DEa=!1,this.Qca&&this.Qca.Vt&&(nb.a.dh(this.Qca),this.Qca=null),this.ada&&this.ada.Vt&&(nb.a.dh(this.ada),this.ada=null),this.yNc(2,!0),this.V2c()):ia.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.Qig=()=>{this.idg(!0)};this.Rig=()=>
{this.idg(!1)};this.Hjc=Tg.yxj;this.Uxd=Tg.connected;this.$=d;this.km=d.pa.km;T&&(this.zeg=new bh(d,z));Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void zc.a.resolve(oc.Cb).then(ya=>{this.documentVisibilityObserver=ya}):this.$.la.fi(291,ya=>{this.documentVisibilityObserver=ya});this.xeg=this.$.ua.ExcelNetworkCheckAfterTabActivationDelayMs;this.km.A4e(this.Lng);this.km.eIb(this.Nng);this.km.U3e(this.Qig);this.km.NBh(this.Rig);new Ga(this.$,
this);this.s$f=this.$.ua.LongInactivityTimePeriodSeconds;this.$.ea.nIb(this.Qqg);this.$.ea.Hl.qGa(this.Cpa);this.EWg=this.$.ua.SilentReopenDuringWorkDelayMs}get Ujj(){return this.DEa}get NZb(){return!(this.Hjc&1)}get rMc(){return!(this.Hjc&2)}get vya(){return!!(this.Uxd&2)}dispose(){this.km&&(this.km.CFg(this.Lng),this.km.j5b(this.Nng),this.km.ZEg(this.Qig),this.km.cmk(this.Rig));this.tXb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.ZOa(this.kJ),this.tXb=!1);this.$&&(this.pUc&&
this.V2c(),this.$.ea&&(this.$.ea.pVc(this.Qqg),this.$.ea.Hl&&this.$.ea.Hl.aPa(this.Cpa)));this.ada&&(this.ada.dispose(),this.ada=null);nb.a.dh(this.zeg);this.$=null;super.dispose()}BEj(){this.Sre=!0}S0e(){this.XBa||(this.XBa=Ja.a(this.$).Tm.bGa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}mhj(){if(this.Sre)return this.Sre=!1,!0;const d=this.yja>this.s$f||this.eTd>this.s$f&&10>this.yja;ia.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.yja}, Time gap between last two activities: ${this.eTd}. return value:${d}`);
return d}jrk(){this.ada=Ve.a.instance.create(()=>{fa.Health.instance.recordQosError(Qg.a.eTk,[Wg.a.ELc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}wwh(){this.XBa||this.Qca?ia.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.Qca=Ve.a.instance.create(()=>
{this.$?this.XBa?ia.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):cd.f(this.$).isEditing?(this.$ub||(cd.f(this.$).cellTextEditBox.Jx(this.Rl),ia.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.avb=!0,
ia.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.S0e():ia.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.EWg,vd.a.WRk,void 0,!0)}idg(d){this.Uxd=this.acf(2,d,!0);this.H5e()}yNc(d,z){this.Hjc=this.acf(d,z,!1);this.H5e()}acf(d,
z,T){T=T?this.Uxd:this.Hjc;return z?T|d:T&~d}xxe(){const d=!!this.s4a,z=!!this.O8a,T=!!this.XBa,ya=!!this.ksc;this.NZb&&!d?this.vwh():!this.NZb&&d&&this.Hbi();!this.rMc||z||T?this.rMc||(z?this.Mnf():(T||this.Qca&&this.Qca.Vt)&&this.Nnf()):this.DEa?this.uwh():this.Qca||this.wwh();this.vya&&!ya?this.d1g(!0):!this.vya&&ya&&this.d1g(!1)}vwh(){this.$?this.s4a?ia.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):
cd.f(this.$).isEditing?(this.avb||(cd.f(this.$).cellTextEditBox.Jx(this.Rl),ia.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.$ub=!0,ia.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.W0e():ia.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}W0e(){this.s4a||
(this.s4a=Ja.a(this.$).Tm.bGa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}Hbi(){this.s4a&&(nb.a.dh(this.s4a),this.s4a=null)}Mnf(){this.O8a&&(nb.a.dh(this.O8a),this.O8a=null);this.ada&&this.ada.Vt&&this.ada.cancel();this.ada=null}Nnf(){this.XBa&&(nb.a.dh(this.XBa),this.XBa=null);this.Qca&&(nb.a.dh(this.Qca),this.Qca=null);this.avb&&!this.$ub&&cd.f(this.$).cellTextEditBox.Lw(this.Rl);this.avb=!1}uwh(){this.O8a||(this.O8a=Ja.a(this.$).Tm.bGa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,ab.a.instance.ia(2190)));this.jrk()}d1g(d){d?(this.ksc=Ja.a(this.$).Tm.bGa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.wbk()):(nb.a.dh(this.ksc),this.ksc=null)}wbk(){if(this.$&&this.$.pa){const d=this.$.pa.ta.Vh();dc.J(this.$.pa.ta,null,null,null,d)}}V2c(){bd.a(this.$).I5(hb.a.WNa).cy(this.Yng);this.$.Wr(this.Cj);this.pUc=!1}H5e(){this.documentVisibilityObserver||ia.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");
this.documentVisibilityObserver&&this.documentVisibilityObserver.un?this.tXb||(this.documentVisibilityObserver.c4(this.kJ),this.tXb=!0,ia.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.xxe()}};Qb=Object(rb.__decorate)([Object(zc.d)(oc.ce),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,Object(oc.vd)())],Qb);Object(Va.a)(Qb,"NetworkConnectionStateManager",
sa.a,[599,4]);var wc=a(749),S=a(689),eb=a(181);class ec{constructor(d){this.G3a=this.z4d=this.K3a=this.DMc=0;this.s4d=this.Jag=null;this.fQc=z=>{"pen"!==z.pointerType||this.K3a||(this.K3a=Math.floor(this.vNb()/1E3),this.K3a<=this.DMc&&(this.K3a=this.DMc),this.z4d=0)};this.Bpa=()=>{this.ZPf()};this.nTb=(z,T)=>{0!==T.newState&&this.ZPf()};this.aBj=()=>{0<this.G3a&&this.pNg(this.G3a);this.G3a=0};d?(this.NMc=d,this.vNb=Date.now,this.y8h(),this.Dik()):ia.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}NFk(){this.Jag=
"Office.Excel.Online.Data.Activity.PenMinutes"}Dik(){window.document.body.addEventListener("pointerenter",this.fQc);window.document.body.addEventListener("pointerleave",this.Bpa);Object(S.a)().execute(d=>{d.M4e(this.nTb)})}ZPf(){const d=Math.ceil(this.vNb()/1E3);this.K3a&&d>this.DMc&&(this.z4d=d,this.G3a+=this.z4d-this.K3a);this.DMc=d;this.K3a=0}y8h(){this.s4d=new bb.a(4,2,6E4,this.aBj);this.NMc.jm(this.s4d)}pNg(d){const z={name:this.Jag,dataFields:[]};(d=jc.a.lm("PenInputSec",d.toString(),Oc.g.Int64))&&
z.dataFields.push(d);eb.a.sendActivityEvent(z)}dispose(){0<this.G3a&&this.pNg(this.G3a);this.NMc.Px(this.s4d)}}Object(Va.a)(ec,"PenMinutesManager",null,[640]);var Lc=a(282);class Ad{constructor(){this.Dhd=this.Wh=null}get name(){return"Common.App.PenMinutesManager"}$n(d){this.Wh=d;const z=wa.AFrameworkApplication.Lp;this.Wh.register(640,"Common.App.PenMinutesManager.IPenMinutesManager").yi().Ei(()=>new ec(z))}init(){this.Dhd=dg.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.Dhd&&
this.Dhd.dispose()}static main(){Lc.a.instance.Do(new Ad)}}Object(Va.a)(Ad,"PenMinutesManagerPackage",null,[11,12]);Object(zc.b)(oc.De,{Fk:"singleton"})(()=>{Type.registerNamespace("Common.App.PenMinutesManager");Ad.main();const d=dg.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");d.NFk();return d});var pd=a(137);let de=class{constructor(d){d.P5(z=>{void z.taa(1).then(()=>{const T=document.createElement("div"),ya=Object(cd.f)(d).yn;appChrome.renderProactiveSuggestionDebugPane(T,
ya,pd.a.ey)})});void zc.a.resolve(oc.kf,{va:1})}};de=Object(rb.__decorate)([Object(zc.d)(oc.bf),Object(rb.__param)(0,Object(oc.Nb)())],de);Object(Va.a)(de,"ProactiveSuggestionDebugToolsManager",null,[]);let Ge=class extends sa.a{constructor(){super()}pye(d,z){ia.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${d}, TriggerType: ${z}`);if(Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1))switch(z){case 0:this.raiseEvent("pssort",void 0,d);break;case 1:this.raiseEvent("psfilter",void 0,d);break;case 2:this.raiseEvent("pscrttbl",void 0,d)}}};Ge=Object(rb.__decorate)([Object(zc.d)(oc.cf)],Ge);Object(Va.a)(Ge,"ProactiveSuggestionManager",sa.a,[597]);var Re=a(1430),kf=a(98),Xf=a(182);class kg{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=
this.onClose=this.onOpen=this.middleContainer=null}}Object(Va.a)(kg,"TaskPaneGroupAppProps",null,[]);class Yf{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(Va.a)(Yf,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var eh=a(52),jg=a(43),Se=a(336);Object(zc.b)(oc["if"],{Fk:"singleton"})(d=>Lo(function*(){const z=yield zc.a.resolve(oc.Nb,d);return P.Ba(z)}));class P extends sa.a{constructor(d,z){super();this.isVisible=
!1;this.Cof=500;this.j8b=[];this.hnf=this.n$c=null;this.O9d=()=>{this.kIg()};this.q1c=new Set;this.q1c.add("FieldListTaskPane");this.q1c.add("PivotTableSettingsTaskPane");this.q1c.add("SlicerSettingsTaskPane");this.th=z;yd.a(this.$).Tq(this);this.w$b=d;wa.AFrameworkApplication.ra.$g.fl||(this.w$b.style.bottom=this.$.Ij&4?yf.HelperMethods.Ki(this.$.xQa):"0");this.Qxc={};this.x$b={};this.DGe=new Set;this.nwe=Rg.a.instance.Yk(this.hj);this.nwe.Ba("focusin",this.O9d);this.Jdj()}get $(){return this.th}get Alc(){return this.DGe}get pYa(){return this.n$c}get isCollapsed(){return!this.pYa}dispose(){yd.a(this.$).VH(this);
const d=this.Qxc;for(const z in d)({key:z,value:d[z]}).value();this.x$b=this.DGe=this.Qxc=null;this.nwe.zM();this.w$b=this.nwe=null;super.dispose()}clb(d,z,T,ya,sb,cc,Fc,Wc,id,Dd,ee,re,Ce,mf,tf,Df,sf){id=void 0===id?P.Pwj:id;Dd=void 0===Dd?P.Owj:Dd;ee=void 0===ee?null:ee;re=void 0===re?null:re;Ce=void 0===Ce?!1:Ce;mf=void 0===mf?!1:mf;tf=void 0===tf?null:tf;Df=void 0===Df?!1:Df;const $f=Object(ed.a)(new Yf,{getContent:()=>d});$f.isSharedRuntime=Ce;return Object(ed.a)(new Re.a,{hideHeader:mf,contentProps:$f,
title:z,titleTag:tf,width:T,location:2,onOpen:sb,onClose:cc,onShow:Fc,onHide:Wc,iconUrl:ee,iconId:re,enableResize:ya,minResizeWidth:id,maxResizeWidth:Dd,showResizeChatButton:Df,onCloseButtonTabKeyDown:pg=>{Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8039664_TaskpaneCloseShiftTab")&&(pg.shiftKey&&pg.keyCode===kf.a.CG&&!ya?void Xf.a.cp().then(hg=>{1>=hg.selectors.getTabbedTaskPaneCount()&&sf(pg);return null}):pg.keyCode!==kf.a.CG||pg.shiftKey||sf(pg))}})}PS(d,z){Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&
this.j8b.indexOf(d)&&(this.j8b[d]=!0);void Xf.a.cp().then(T=>{this.Alc.has(d)?T.setSelectedTaskPane(d):T.showTaskPane(d,z);return null})}kAd(d,z){this.j8b[d]=!1;void Xf.a.cp().then(T=>{T.initializeHiddenSharedRuntimeTaskPane(d,z);const ya=this.$.domElement;ya.addEventListener("scroll",function cc(){0!=ya.scrollLeft&&(ya.scrollLeft=0,ya.removeEventListener("scroll",cc))})})}updateTaskPane(d,z){Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&this.j8b.indexOf(d)&&!this.j8b[d]||
void Xf.a.cp().then(T=>{T.updateTaskPane(d,z);return null})}setSelectedTaskPane(d){void Xf.a.cp().then(z=>{z.setSelectedTaskPane(d);return null})}hideTaskPane(d){void Xf.a.cp().then(z=>{z.hideTaskPane(d,P.oYk);return null})}get hj(){return this.w$b}get Zo(){return this.isVisible}get hl(){return fe.a.pwe}Vp(d,z){return z?!1:(this.KMg(),!0)}tq(d){return De.DOMElementExtensions.eo(this.hj,d)}Qs(){this.$.frame.Km.Ev(this.hl)}nu(){}focusResizeHandle(){void Xf.a.cp().then(d=>{d.focusResizeHandle();return null})}focusTabbedTaskPaneArea(){void Xf.a.cp().then(d=>
{d.focusTabbedTaskPaneArea();return null})}Jdj(){Xf.a.cp().then(d=>{const z=new kg;z.onOpen=T=>{this.isVisible=!0;this.Alc.add(T)};z.onClose=T=>{this.isVisible=0<d.selectors.getTabbedTaskPaneCount();ia.ULS.sendTraceTag(537014371,0,50,`Closing of ${T} TaskPane`);this.isVisible||this.jBf();delete this.x$b[T];this.Alc.delete(T);this.aqa()};z.onShow=(T,ya)=>{this.n$c=T;this.kIg();1!==ya&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Fvk()},0)});this.aqa()};z.onHide=(T,ya,sb)=>{this.n$c=
null;sb&&1!==ya&&this.jBf();this.aqa()};z.setFocusCallback=(T,ya)=>{ya&&(this.x$b[T]=ya)};z.onResizeStart=()=>{};z.onResizeEnd=()=>{this.aqa();ia.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.pYa} TaskPane`)};d.renderTaskPaneGroups(null,this.w$b,z);return null})}WSh(){Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8426131_gridLayoutCleanup")&&je.Task.delay(this.Cof).continueWith(()=>{this.$.hsk()})}jBf(){cd.f(this.$).setFocus()}aqa(){wa.AFrameworkApplication.ra.$g.fl?Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridAdjustmentPostTakePaneTrigger",
!1)&&(je.Task.delay(this.Cof).continueWith(()=>{this.$.aqa(Se.a.ixa("ResetContentAreaMargin"))}),ia.ULS.sendTraceTag(507609505,0,50,"TaskPane.onContentAreaResize")):this.WSh()}Fvk(){if(this.x$b[this.pYa]){const d=this.x$b[this.pYa];d&&d(null,null)}else this.q1c.has(this.pYa)||this.KMg()}KMg(){Xf.a.cp().then(d=>{if(!Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<d.selectors.getTabbedTaskPaneCount())d.focusTabbedTaskPaneArea();else{const z=De.DOMElementExtensions.DE(this.hj.querySelectorAll(De.DOMElementExtensions.RI));
z?z.focus():Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<d.selectors.getTabbedTaskPaneCount()&&d.focusTabbedTaskPaneArea()}return null})}kIg(){this.$.domElement.scrollLeft=0;xf.a.Foa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}get o1c(){return this.w$b}ktc(d,z,T,ya,sb){let cc=d.kh(z);cc||(cc=jg.a(eh.a,T,d,z),cc.SetScriptLoadFlavor(sb));ya&&cc.L3e(ya);const Fc=""+z;let Wc=null;
const id=()=>{cc.create();Wc()};this.Qxc[Fc]=Wc=()=>{cc.Qie(id);delete this.Qxc[Fc]};cc.fpd(id)}static Ba(d){const z=P.qQh(d.xi,d.isChromeRtl);P.EKh(d,z);return new P(z,d)}static qQh(d,z){const T=document.createElement("div");T.id=d+Ed.a.qwe;wa.AFrameworkApplication.ra.$g.fl?T.classList.add(Yc.a.eel):(T.classList.add(z?Yc.a.gel:Yc.a.fel),wa.AFrameworkApplication.ra.$g.fl&&T.classList.add(Yc.a.Xub));return T}static EKh(d,z){d.isMobileMode&&z.setAttribute("aria-hidden","true");if(wa.AFrameworkApplication.ra.$g.fl){let T;
(T=document.getElementById("FarPaneRegion"))?T.appendChild(z):ia.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else document.getElementById(d.xi+Ed.a.prc).insertBefore(z,d.wQa)}}P.Pwj=300;P.Owj=950;P.oYk=2;Object(Va.a)(P,"ReactTaskPaneManager",sa.a,[595,47,4]);var Da=a(60),ib;let ic=ib=class{constructor(){this.o9e=null;this.DZj=z=>{ia.ULS.sendTraceTag(508421248,0,50,`DMS call to get SDX list succeeds with status ${z.data.httpStatus}.`);
this.fQf(z.data.responseData)};this.CZj=z=>{200<=z.data.httpStatus&&300>z.data.httpStatus?(ia.ULS.sendTraceTag(508421219,0,50,`DMS call to get SDX list succeeds with status ${z.data.httpStatus}.`),this.fQf(z.data.responseData)):ia.ULS.sendTraceTag(508421218,0,15,`DMS call to get SDX list fails with status ${z.data.httpStatus}.`)};const d=Pb.EwaSettings.getStringFeatureGate("Microsoft.Office.ExcelOnline.SdxManifestPrefetchAssetIds","");""!==d&&(this.o9e=d.split(";"),this.$8j())}$8j(){const d=gb.a.create().toString();
ia.ULS.sendTraceTag(508421250,0,50,`Start calling DMS to retrieve the list of SDXs to prefetch (dmsActivityId = ${d}).`);wa.AFrameworkApplication.rj.ov(Da.a.current.SS.SdxDmsUrl,2,ib.K9h(),ib.L9h(d),!1,4,this.DZj,this.CZj,null)}Ski(){return Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.UseSdx1CdnUrl",!1)||Da.a.current.SS.ForceUseSdx1Cdn}fQf(d){try{const z=JSON.parse(d).Packages,T=this.Ski()?Da.a.current.SS.Sdx1CdnUrl:Da.a.current.SS.SdxCdnUrl;for(const ya of z)if(this.o9e.includes(ya.AssetId)){const sb=
String.format(T,ya.AssetId,ya.FFN,ya.Version,"en-us");Da.a.Wtb(sb,!1,null,!0)}window.prefetchedDmsResponse=d}catch(z){ia.ULS.sendTraceTag(508421249,0,15,`Failed to parse DMS response: "${d.substring(0,40)}...".`)}}static K9h(){const d=Object(Db.a)(String,wa.AFrameworkApplication.ii.AudienceGroup)||"",z=wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExcelApiUndo25Bump",!1)?"1.25":wa.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8722614_RichApiUndoExcelApiUndoBump1_24")?
"1.24":"1.19",T=be.a.isReactRibbonEnabled()?wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RequirementSetRibbonApiOnePointThreePrime",!1)?"1.3":"1.2":"1.1";return JSON.stringify({Context:{Hosts:["Workbook"],ReactNativeVersion:"0.0.0.0",Channel:"DevMain",Capabilities:[{Name:"addincommands",Version:"1.2"},{Name:"augloopsharedsession",Version:"1.1"},{Name:"bindingevents",Version:"1.1"},{Name:"biplatvisualrichapi",Version:"1.8"},{Name:"cdnurlsupport",Version:"1.1"},{Name:"compressedfile",
Version:"1.1"},{Name:"customfunctions",Version:"1.9"},{Name:"customfunctionsruntime",Version:"1.4"},{Name:"datafrompicture",Version:"1.1"},{Name:"delayforcelledit",Version:"1.1"},{Name:"dialogapi",Version:"1.2"},{Name:"dialogorigin",Version:"1.2"},{Name:"documentevents",Version:"1.1"},{Name:"excelapi",Version:"1.17"},{Name:"excelapionline",Version:"1.1"},{Name:"excelapiundo",Version:z},{Name:"file",Version:"1.1"},{Name:"firstpartyauthentication",Version:"1.1"},{Name:"identityapi",Version:"1.3"},{Name:"keyboardshortcuts",
Version:"1.1"},{Name:"matrixbindings",Version:"1.1"},{Name:"matrixcoercion",Version:"1.1"},{Name:"navigationpanesdx",Version:"1.2"},{Name:"numberformatting",Version:"1.2"},{Name:"pdffile",Version:"1.1"},{Name:"pivot",Version:"1.6"},{Name:"pivottablenativegrouping",Version:"1.2"},{Name:"ribbonapi",Version:T},{Name:"richapiruntime",Version:"1.2"},{Name:"richapiruntimeflag",Version:"1.2"},{Name:"selection",Version:"1.1"},{Name:"settings",Version:"1.1"},{Name:"sharedruntime",Version:"1.1"},{Name:"sharedruntimeinternal",
Version:"1.2"},{Name:"tablebindings",Version:"1.1"},{Name:"tablecoercion",Version:"1.1"},{Name:"tablestyle",Version:"1.1"},{Name:"textbindings",Version:"1.1"},{Name:"textcoercion",Version:"1.1"},{Name:"webauth",Version:"1.1"}],Ring:"Automation"===d?"Dogfood":d,Platform:"Web",Locales:[wa.AFrameworkApplication.uiCulture],ClientId:wa.AFrameworkApplication.fa.Ya("LoggableUserId")},SyncId:0})}static L9h(d){return{"Content-Type":"application/json",DMSActivityId:d}}};ic=ib=Object(rb.__decorate)([Object(zc.d)(oc.Af)],
ic);Object(Va.a)(ic,"SdxManifestPrefetcher",null,[]);var Rc=a(224);class kd extends kc.a{constructor(d,z,T,ya,sb){sb=void 0===sb?null:sb;super();this.BIb=null;this.c1f=!1;this.kJ=()=>{this.mVb&&ia.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.d_b}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.X0a}, AggregatedActionParams not null: ${this.mVb}`);this.nUd()};this.gwh=d;this.hwh=z;this.documentVisibilityObserver=T;this.d_b=ya;this.vW=sb;T&&this.documentVisibilityObserver.c4(this.kJ)}get X0a(){return this.c1f}get mVb(){return!!this.BIb}Hug(d){ia.ULS.sendTraceTag(537153864,
0,50,`ActionAggregator<${this.d_b}>.PerformThrottledAction: Start. IsActionOngoing: ${this.X0a}, AggregatedActionParams not null: ${this.mVb}`);this.BIb=this.hwh.Y5e(d,this.BIb);this.nUd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.ZOa(this.kJ);super.dispose()}nQg(d){this.c1f=d}bxi(){ia.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.d_b}>.FinishedCallback: Start. IsActionOngoing: ${this.X0a}, AggregatedActionParams not null: ${this.mVb}`);this.nQg(!1);this.nUd()}nUd(){if(!this.L8b()){var d=
this.BIb;this.BIb=null;this.nQg(!0);ia.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.d_b}>.InternalPerformAction: Calling PerformAction.`);Ug.TaskExtensions.Xa(this.gwh.Dug(d),()=>{this.bxi()},Rc.a.none,0,this.vW)}}L8b(){return!this.mVb||this.X0a?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.un?(ia.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.d_b}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}}Object(Va.a)(kd,"ActionAggregator",
kc.a,[619,4]);var td=a(158),Z=a(17),Ha=a(53);class Mb extends sa.a{constructor(d){super();this.cG=this.IM=null;this.M1a=!1;this.$B=null;this.sKk=xf.a.Am;this.Gmg=z=>{const T=z.La.keyCode;return T===kf.a.yu?this.yRj():T===kf.a.CG&&z.La.shiftKey?this.uti(this.IM):!1};this.Esg=z=>{if(!this.M1a||z.La.keyCode!==kf.a.d_)return!1;Mb.DSf();je.Task.delay(1).lB(()=>{this.cG.focus();return!0},0,this.ya);return!0};this.z1j=()=>{document.activeElement&&document.activeElement.id===this.cG.id||(Mb.DSf(),je.Task.delay(1).lB(()=>
{this.cG.focus();return!0},0,this.ya))};this.qkg=()=>{this.R1g(this.cG)};this.Fmg=z=>{z.stopPropagation();z.preventDefault();this.M1a&&(this.M1a=!1)};this.$=d;(d=this.$.ea.Ih)&&ia.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${d.uHa}; InWebPart = '${d.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${d.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);d&&(d.inWebPart||d.inEmbedView)?ia.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${d.inWebPart?
"Classic":"Non Classic"}', InEmbedView = '${d.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.h6h(),this.g7h(),td.a.instance.xa(Z.a.Ui,this.$.domElement,this.Esg));this.$.la.Hh(238,this)}$Ch(d){this.addHandler("KBIS",d)}gnk(d){this.removeHandler("KBIS",d)}dispose(){this.IM&&Ha.a.removeHandler(this.IM,Z.a.focus,this.qkg);this.$B&&this.$B.detach("focus");this.cG&&(Ha.a.removeHandler(this.cG,Z.a.focus,this.Fmg),Ha.a.removeHandler(this.cG,Z.a.blur,Mb.onBlur),td.a.instance.Qa(Z.a.Ui,this.cG,
this.Gmg));td.a.instance.Qa(Z.a.Ui,this.$.domElement,this.Esg);this.$B=this.cG=this.IM=this.$=null;super.dispose()}h6h(){this.sKk?(this.IM=document.documentElement,this.$B=Rg.a.instance.BU(document.parentWindow),this.$B.Ba("focus",this.z1j)):(this.IM=Mb.Vkf(),document.body.insertBefore(this.IM,document.body.childNodes[0]),Ha.a.addHandler(this.IM,Z.a.focus,this.qkg))}g7h(){this.cG=Mb.Vkf();this.cG.id=Ed.a.Ssf;this.cG.setAttribute(Ed.a.tD,ab.a.instance.ia(863));document.body.appendChild(this.cG);Ha.a.addHandler(this.cG,
Z.a.focus,this.Fmg);Ha.a.addHandler(this.cG,Z.a.blur,Mb.onBlur);td.a.instance.xa(Z.a.Ui,this.cG,this.Gmg)}uti(d){this.R1g(d);return!1}yRj(){this.M1a=!0;cd.f(this.$).focus();cd.f(this.$).ha.qPf();this.raiseEvent("KBIS");return!0}R1g(d){this.M1a?this.M1a=!1:(this.M1a=!0,d&&d.focus())}static Vkf(){const d=document.createElement("div");d.tabIndex=0;return d}static DSf(){document.body.classList.add(Yc.a.nvf)}static onBlur(){document.body.classList.remove(Yc.a.nvf)}}Object(Va.a)(Mb,"EmbedViewFocusControl",
sa.a,[618,4]);var Zb=a(71),gd=a(610);class Nd extends sa.a{constructor(d,z){super();this.f6b=this.ELd=this.ERb=this.o_=null;this.jhc=!1;this.JJe=null;this.tya=this.Afe=!1;this.rTj=(T,ya,sb)=>{ia.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+sb);this.f6b&&this.f6b.stop();this.o_=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.sTj=T=>{Hb.a(T)||(this.f6b&&this.f6b.stop(),this.jhc=!1,(this.o_=T.Result)&&0<this.o_.length&&ia.ULS.sendTraceTag(25264351,
0,50,`Retrieved ${this.o_.length} rich value field list context for autocomplete`),this.Sbb=!0,this.rTc())};this.Sbb=!1;this.th=d;this.Gfc=-1;this.Qj=z;this.Afe=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults");this.tya=Pb.EwaSettings.tya()}gpd(d){this.addHandler("FieldInfoListContextLoaded",d)}Rie(d){this.removeHandler("FieldInfoListContextLoaded",d)}xCh(d){this.addHandler("GetFieldInfoListContextOperationFailed",d)}Imk(d){this.removeHandler("GetFieldInfoListContextOperationFailed",
d)}get CWd(){return this.Sbb}get yyj(){return this.jhc}get sCf(){return this.Gfc}get zAd(){return this.JJe}get $(){return this.th}get Qx(){return this.o_}get yLi(){return!!this.ERb}dispose(){this.th=null;this.eWc();super.dispose()}Blb(d,z,T,ya){ya=void 0===ya?null:ya;if(d){this.Nud();this.mqc();var sb=null,cc=!1;if(!ya&&(()=>{let Fc=this.v3k(d,z,T);({qtb:cc,Qx:sb}=Fc);return Fc})().returnValue)if(this.Afe||this.dPg(sb),this.jhc=!0,this.o_=sb,this.Afe){if(!cc){this.Sbb=!0;this.rTc();return}}else if(this.o_&&
0<this.o_.length&&(this.Sbb=!0,this.rTc()),!cc)return;this.l6g(d,ya,z,T,!1)}}l6g(d,z,T,ya,sb){if(this.$.ea.ki){this.$.Eh&&(this.f6b=this.$.Eh.Li("WebServiceCall","GetRichValueFieldInfoListContext"));this.ERb=null;var cc=this.$.pa.ta.Vh(),Fc=this.$.pa.ta,Wc=this.sTj,id=this.rTj;const Dd=Fc.$a(1,null);Dd.selectedRange=d;Dd.richValueKeyPath=z;Dd.singleColumn=T;Dd.searchForRange=ya;Dd.calculateMajorityDataType=sb;this.ERb=dc.h(Fc,"GetRichValueFieldListContextList",Dd,Wc,id,null,cc,4)}else this.o_=null}eWc(){this.o_=
null;this.Sbb=!1;this.Nud();this.mqc();this.ERb=null;this.Gfc=-1}Nud(){Nd.DKb(this.ERb)}mqc(){Nd.DKb(this.ELd)}rTc(){this.raiseEvent("FieldInfoListContextLoaded")}Ey(d){d=qd.H(d);--d.left;--d.right;return this.Qj.Ey(d)}j_a(d){d.FirstColumn=d.FirstColumn;d.LastColumn=d.LastColumn;d.FirstRow=d.FirstRow;d.LastRow=d.LastRow;this.mqc();this.ELd=null;return yb.a(this.$.userOperationManager,(z,T,ya)=>Fe.k(this.$.pa.ta,d,uc.c(z,sb=>{this.ATj(sb)}),uc.b(T,T,sb=>{this.zTj(sb)}),ya,null),z=>new Ta.a(264,0,z,
80),null)}zTj(d){d=Pe.a.gk(d.data);ia.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${na.a.Yh(d)}`)}ATj(d){if(Hb.a(d))-315732528!==d.Errors[0].MessageId&&ia.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${na.a.Yh(d.Errors)}`);else if(d&&d.Result){d=d.Result;var z=d.HasHeaderRow;z=new gd.AutofilterRange(d.TableRange.FirstRow+(z?1:0)+1,d.TableRange.FirstColumn+
1,d.TableRange.LastRow+1,d.TableRange.LastColumn+1,null,null,null,0,z);this.Gfc=d.TableRange.FirstColumn;(d=this.iyg(!1,!0,z))||ia.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.dPg(d)}else ia.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}v3k(d,z,T){let ya,sb;sb=null;ya=!1;if(d.SheetName!==this.$.ea.ma.sheetName)return{returnValue:!1,qtb:ya,j_a:!1,Qx:sb};let cc;
this.Gfc=-1;if(T){cc=this.Ey(d);if(!cc||!cc.Oxa)return{returnValue:!1,qtb:ya,j_a:!1,Qx:sb};var Fc=this.tya?(Fc=cd.f(this.$).oh.iLf(cc))&&0<Fc.size:(Fc=cd.f(this.$).oh.jLf(cc))&&0<Fc.count;this.JJe=cc;if(Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Fc)return--d.FirstColumn,--d.LastColumn,this.ELd=this.j_a(d),{returnValue:!0,qtb:ya,j_a:!0,Qx:sb};cc.top+=1;cc.right=qd.H(d).right-1}else cc=new gd.AutofilterRange(d.FirstRow+1,d.FirstColumn+
1,d.LastRow+1,d.LastColumn+1,null,null,null,0,!1);if(cc.top>cc.bottom||cc.left>cc.right)return{returnValue:!0,qtb:ya,j_a:!1,Qx:sb};d=cd.f(this.$);var Wc=d.fh.width,id=d.fh.height;Fc=d.view.visibleArea;Wc=new Zb.a(Fc.x-Wc,Fc.y-id,Fc.width+Wc,Fc.height+id);id=d.yl(cc);if(!Fc||!id||!d.bJc(cc))return{returnValue:!1,qtb:ya,j_a:!1,Qx:sb};Wc.contains(id)||(ya=!0);sb=this.iyg(z,T,cc);return{returnValue:!0,qtb:ya,j_a:!1,Qx:sb}}dPg(d){d&&ia.ULS.sendTraceTag(25264348,0,50,`Retrieved ${d.length} rich value field contexts from block cache`);
this.jhc=!0;(this.o_=d)&&0<this.o_.length&&(this.Sbb=!0,this.rTc())}iyg(d,z,T){let ya;ya=null;const sb=T.clone();if(z)for(let cc=T.right,Fc=0;cc>=T.left;--cc){if(sb.left=cc,sb.right=cc,z=this.EGf(sb,!0,T.left)){ya||(ya=[]);ya[Fc]=z;if(d)break;++Fc}}else if(d=this.EGf(sb,!1))ya=[],ya[0]=d;return ya}EGf(d,z,T){T=void 0===T?0:T;var ya=null;let sb=[];if(this.tya){var cc=cd.f(this.$).oh.iLf(d);if(!cc||0>=cc.size)return ya;sb=Array(cc.size);let Wc=0;cc.forEach(id=>{const Dd={};Dd.Name=id.Value;Dd.RefersToDotFunction=
id.RefersToDotFunction;sb[Wc]=Dd;++Wc})}else{var Fc=cd.f(this.$).oh.jLf(d);if(!Fc||0>=Fc.count)return ya;sb=Array(Fc.count);ya=0;for(cc of Fc.values)Fc={},Fc.Name=cc,sb[ya]=Fc,++ya}cc="";Fc=-1;0<d.top&&z&&(d=new Rd.Range(d.top-1,d.left,d.top-1,d.left,!1,!1),null!=cd.f(this.$).zh(d)&&null!=cd.f(this.$).zh(d).originalText&&(cc=cd.f(this.$).zh(d).originalText),Fc=d.left-T);ya={};ya.ColumnName=cc;ya.ColumnIndex=Fc;ya.FieldInfoDataList=sb;return ya}static DKb(d){d&&wa.AFrameworkApplication.rj.fE(d.uD)}}
Object(Va.a)(Nd,"FieldInfoManager",sa.a,[616,4]);class ae extends Nd{constructor(d,z,T,ya){super(d,z);this.njb=null;this.jkg=()=>{this.Rie(this.jkg);if(this.Qx&&this.Qx.length&&this.contextMenuManager){var sb=this.contextMenuManager.wAc("autoFilterRichFieldList"),cc=window.document.getElementById(this.njb);sb.Mca(null,cc,this,null,!0)}};this.Whh=T;this.contextMenuManager=ya}get lR(){return this.Whh}MLi(d,z){this.njb=z;ia.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${d.FirstRow}, ${d.FirstColumn}, ${d.LastRow}, ${d.LastColumn})`);
this.l6g(d,null,!0,!1,!0)}}Object(Va.a)(ae,"FilterInfoManager",Nd,[615,616,4]);var qe=a(1089),Le=a(1213);class Je{}Je.vpi="ewa-sharedUi-launchButton";Je.ypi="ewa-sharedUi-launchButtonWithText";Je.wpi="ewa-sharedUi-launchButtonClick";Je.zpi="ewa-sharedUi-launchButtonWithTextClick";Je.xpi="ewa-sharedUi-launchButtonText";Object(Va.a)(Je,"CssClassNames",null,[]);a(601);var cf=a(306),If=a(290),Pf=a(329),Zf=a(69),$e=a(325);class zf extends ld.a{constructor(d,z,T,ya,sb,cc,Fc,Wc,id,Dd){super(document.createElement("div"));
this.Y5f=null;this.Lte=!1;this.zoom=this.Bi=this.F$b=this.L8a=null;this.fZ=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.eZ=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.QRk=()=>{this.Z0e()};this.vj=ee=>{this.raiseEvent(this.a3b,ee);this.Ntb();return!0};this.aRj=ee=>{100<Yb.a(Td.a.ih,this.Y5f)&&this.KQd(new Sys.UI.Point(Math.round(ee.clientX),Math.round(ee.clientY)))};this.bZ=ee=>{Zf.g(ee.La,!1);return!1};this.zoom=Dd;this.U$=this.pl.VXa();this.set_visible(!1);this.KJc=sb;this.a3b=
cc;this.dOc=d;this.mrc=z;this.Bi=id;this.KJc&&(this.L8a=Ve.a.instance.create(this.QRk,3E4,"OnObjectButton.ShyTimerFired",!1,!1));d&&this.domElement.classList.add(d);this.FWa=document.createElement("div");this.domElement.appendChild(this.FWa);T&&this.FWa.classList.add(T);this.Cze(ya);Fc&&(this.F$b=document.createElement("div"),this.domElement.appendChild(this.F$b),this.F$b.classList.add(Wc),this.F$b.innerText=Fc,this.domElement.style.padding="3px",cf.a.instance.xa(Z.a.qj,this.domElement,this.bZ));
this.lgb=new Pf.a(this.domElement,7);If.a.instance.xa(Z.a.click,this.domElement,this.vj);Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&cf.a.instance.xa(Z.a.qj,this.domElement,this.bZ);d=ee=>{Zf.g(ee)};this.oj.Ba("mouseup",d);this.oj.Ba("click",d);this.oj.Ba("dblclick",d)}e$(d){this.addHandler(this.a3b,d)}Iia(d){this.get_events().removeHandler(this.a3b,d)}tDh(d){this.addHandler("OnObjectButtonMouseOver",d)}ynk(d){this.get_events().removeHandler("OnObjectButtonMouseOver",
d)}sDh(d){this.addHandler("OnObjectButtonMouseOut",d)}xnk(d){this.get_events().removeHandler("OnObjectButtonMouseOut",d)}Cze(d){d&&this.Bi.hr(this.FWa,d)}l3c(d){this.FWa&&d&&this.FWa.setAttribute("title",d)}W6k(d,z,T){var ya=16,sb=16;ya=void 0===ya?0:ya;sb=void 0===sb?0:sb;this.Bi.nM(this.FWa);d?d.Zna(z,16,16,this.FWa,ya,sb,void 0,T):ia.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}X6k(d,z){d&&(this.F$b.innerText=d);this.domElement.title=z}dispose(){this.get_isInitialized()&&
(this.hide(),this.oj.zM(),nb.a.gj([this.U$,this.lgb]),If.a.instance.Qa(Z.a.click,this.domElement,this.vj),cf.a.instance.Qa(Z.a.qj,this.domElement,this.bZ),this.L8a&&this.L8a.dispose(),super.dispose())}Q5b(){this.mrc&&this.domElement.classList.remove(this.mrc);this.dOc&&this.domElement.classList.add(this.dOc)}Ntb(){this.dOc&&this.domElement.classList.remove(this.dOc);this.mrc&&this.domElement.classList.add(this.mrc);this.Ijb()}Ijb(){this.KJc&&(this.L8a.cancel(),this.BYg(),this.setOpacity(1));this.set_visible(!0)}fv(d,
z,T,ya,sb){sb=void 0===sb?!1:sb;d=this.zoom.zoomManager.jo(d);z=this.zoom.zoomManager.jo(z);this.zoom.zoomManager.MYc(this.domElement);this.domElement.style.top=yf.HelperMethods.Ki(z);this.domElement.style.left=this.domElement.style.right="";z=d;sb&&(z=d-this.domElement.offsetWidth);$e.c(this.domElement.style,T,yf.HelperMethods.Ki(z));this.set_visible(!0);this.setOpacity(1);this.KJc&&(this.Lte=!1,this.SUk(),this.L8a.MA())}hide(){this.Q5b();this.set_visible(!1);this.KJc&&(this.BYg(),this.L8a.cancel())}XDd(){this.oj.Ba("mouseover",
this.fZ,!0);this.oj.Ba("mouseout",this.eZ,!0)}SUk(){this.U$.Wv("mousemove")||this.U$.Ba("mousemove",this.aRj)}BYg(){this.U$.Wv("mousemove")&&this.U$.detach("mousemove")}KQd(d){if(this.domElement.parentNode){var z=Sys.UI.DomElement.getBounds(this.domElement);const T=new Sys.UI.Point(Math.round(z.x+z.width),Math.round(z.y+z.height));z=Math.abs(T.x-d.x);d=Math.abs(T.y-d.y);d=z>d?z:d;this.Lte?this.setOpacity(zf.ySh(d)):100>=d&&this.Z0e()}}Z0e(){this.Lte=!0;this.L8a.cancel()}setOpacity(d){xf.a.setOpacity(this.domElement,
d);this.Y5f=Td.a.ih.ri}static ySh(d){return 100>=d?1:250<=d?0:.01*(100-(d-100)/150*100)}}Object(Va.a)(zf,"OnObjectButton",ld.a,[639,512,4]);var Rf=a(978);const Sf=Je.xpi;class yg extends kc.a{constructor(d,z,T,ya,sb,cc,Fc,Wc,id,Dd){Dd=void 0===Dd?"":Dd;super();this.gLa=null;this.eTf=!1;this.Bi=this.CNc=this.DNc=null;this.buttons={};this.Suf={};this.zoom=id;this.$=d;this.svgIconProvider=z;this.gPj=T;this.USd=ya;this.TSd=sb;this.altText=cc;this.a3b=Fc;this.Bi=Wc;this.buttonText=Dd}get zoomManager(){return this.zoom.zoomManager}get IE(){return this.zoomManager.vGa(Yd.a.sXj)}get MKb(){return Yd.a.rXj}get buttonWidth(){return this.zoomManager.vGa(Yd.a.tXj)}dispose(){this.Agi();
this.$=null;super.dispose()}getButton(d,z){return this.Twa(d,void 0===z?!0:z)}Twa(d,z){const T=d.toString();T in this.buttons||this.i7h(d,void 0===z?!0:z);return this.buttons[T]}fv(d,z,T,ya,sb,cc){sb=void 0===sb?!0:sb;cc=void 0===cc?!1:cc;this.hide();if(this.$.ea.isNamedObjectViewMode&&Id.i(this.$.ma)){var Fc=cd.f(this.$).GZ.domElement;const Wc=d+this.buttonWidth-Fc.scrollWidth;Fc=z+this.buttonWidth-Fc.scrollHeight;d=0<Wc?d-Wc:d;z=0<Fc?z-Fc:z}this.Twa(ya,sb).fv(d,z,T,this.$,cc)}hide(){const d=this.buttons;
for(const z in d)d[z].hide()}XDd(d,z){!this.eTf&&(z=this.buttons[z.toString()])&&(this.DNc=(T,ya)=>{d(ya,!0)},z.tDh(this.DNc),this.CNc=(T,ya)=>{d(ya,!1)},z.sDh(this.CNc),this.eTf=!0,z.XDd())}i7h(d,z){this.gLa=String.format(this.USd===Yc.a.kxc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Lb.a.Or(this.USd),Lb.a.Or(this.TSd),"{0}");var T=String.format(this.gLa,Lb.a.Or(this.altText));
z=new zf(""===this.buttonText?Je.vpi:Je.ypi,""===this.buttonText?Je.wpi:Je.zpi,Yc.a.z4,T,z,this.a3b,this.buttonText,Sf,this.Bi,this.zoom);T=(ya,sb)=>{this.gPj(sb,d)};z.e$(T);this.buttons[d.toString()]=z;this.Suf[d.toString()]=T;T=cd.f(this.$).sl(d);T.domElement.insertBefore(z.domElement,T.domElement.firstChild)}Agi(){for(const d of Rf.a(this.buttons)){const z=this.buttons[d];z.Iia(this.Suf[d]);nb.a.dh(z);delete this.buttons[d];this.DNc&&z.ynk(this.DNc);this.CNc&&z.xnk(this.CNc)}}domElement(d){return this.Twa(d).domElement}Ijb(d){this.Twa(d).Ijb()}fbc(d,
z,T){T=void 0===T?!0:T;this.gLa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Lb.a.Or(this.USd),Lb.a.Or(this.TSd),"{0}");d=String.format(this.gLa,Lb.a.Or(d));this.Twa(z,T).Cze(d)}t$a(d,z,T){this.Twa(T,!1).X6k(d,z)}i6g(){var d=void 0===d?!1:d;this.gLa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Lb.a.Or(this.TSd),"{1}");const z=String.format(this.gLa,void 0,Lb.a.Or(void 0));
this.Twa(void 0,d).Cze(z)}M3c(d,z,T){this.Twa(T,!1).W6k(this.svgIconProvider,d,z)}l3c(d,z){this.Twa(z,!1).l3c(d)}}Object(Va.a)(yg,"OnObjectLaunchButton",kc.a,[614,4]);var $g=a(105);class rf extends $g.a{constructor(d,z){super(d);this.tZb=null;this.hgi=()=>{this.display()};this.I$i=Math.max(1,z)}dispose(){nb.a.dh(this.tZb);this.tZb=null;super.dispose()}f9a(){nb.a.dh(this.tZb);this.tZb=Ve.a.instance.create(this.hgi,this.I$i,vd.a.Dyj)}l9a(){nb.a.dh(this.tZb);this.hide()}}Object(Va.a)(rf,"LoadingIndicatorBehavior",
$g.a,[637,4]);class xh extends rf{constructor(d,z,T,ya){super(d,z);this.sZb=null;this.xkh=T;this.F7i=ya;this.Gyh()}dispose(){this.sZb=null;super.dispose()}display(){this.xkh(this.sZb)}hide(){this.F7i(this.sZb)}Gyh(){this.sZb=document.createElement("div");this.domElement.appendChild(this.sZb)}}Object(Va.a)(xh,"ShimmerLoadingIndicatorBehavior",rf,[]);var kh=a(57);class Hh extends rf{constructor(d,z,T,ya,sb,cc){ya=void 0===ya?null:ya;sb=void 0===sb?null:sb;cc=void 0===cc?0:cc;super(d,z);this.bnb=this.u3a=
null;this.bnb=T;this.WEc=ya||Da.a.current.Pu(103);this.Y7f=cc;this.EAd=sb;this.Fyh()}dispose(){this.u3a=null;super.dispose()}display(){De.DOMElementExtensions.setVisible(this.u3a,!0)}hide(){De.DOMElementExtensions.setVisible(this.u3a,!1)}Fyh(){this.u3a=document.createElement("div");this.u3a.classList.add(kh.k);const d=document.createElement("div");d.classList.add(kh.l);this.EAd&&""!=this.EAd&&d.classList.add(this.EAd);const z=0===this.Y7f?"":ab.a.instance.ia(this.Y7f),T=String.format('<div class="'+
kh.m+'">{0}</div>',z);this.WEc?this.bnb.hr(d,`<img src="${this.WEc}" alt="${z}" title="${z}"/>`+T):this.bnb.hr(d,T);this.u3a.appendChild(d);this.domElement.appendChild(this.u3a)}}Object(Va.a)(Hh,"SpinnerLoadingIndicatorBehavior",rf,[]);Object(zc.b)(oc.Qf)(d=>Lo(function*(){const [z,T]=yield Promise.all([zc.a.resolve(oc.pd,{va:d.va}),zc.a.resolve(oc.ah)]);return new oh(z,T)}));class oh{constructor(d,z){this.bnb=d;this.zoom=z}Hzd(d,z,T){return new qe.a(d,z,T)}qtc(d,z,T,ya,sb,cc,Fc,Wc,id,Dd){return new Le.a(d,
z,T,ya,sb,cc,Fc,Wc,id,Dd)}RMb(d,z,T,ya,sb){return new Hh(d,z,this.bnb,T,ya,void 0===sb?0:sb)}BNd(d){return d.la.kh(238)||new Mb(d)}GMb(d,z,T,ya,sb,cc,Fc,Wc){return new yg(d,z,T,ya,sb,cc,Fc,this.bnb,this.zoom,void 0===Wc?"":Wc)}nzd(d,z){return new Nd(d,z)}e6h(d,z,T,ya){return new ae(d,z,T,ya)}Vjf(d,z,T,ya){return new kd(d,z,T,ya)}}Object(Va.a)(oh,"SharedUIControlsFactory",null,[592]);var Zh=a(478);let Di=class{constructor(d,z,T){var ya,sb;this.$=d;this.da=z;this.DL=T;this.g8d=3;this.bgg=100;this.ej=
()=>{this.DL.X6a({abortReason:"workbookClosed"})};T.X6a({success:!1,entriesCount:this.azb,abortReason:"notStarted",sheetCount:null===(sb=null===(ya=this.$.sa)||void 0===ya?void 0:ya.items)||void 0===sb?void 0:sb.length});this.Zme();this.$.gq(this.ej)}Zme(){window.requestIdleCallback?window.requestIdleCallback(()=>this.pwg()):Vd.e(()=>{this.pwg()},this.$.ya,100)}pwg(){if(this.xKk()){var d=this.$.sa.items,z=this.$.fu.activeItemIndex;0>z&&(ia.ULS.sendTraceTag(507635023,0,50,"SheetProcessedDataProvider.prefetchSheetProcessedData: active item index is unknown, using 0 instead..."),
z=0);var T=this.ILh;if(0===d.length||T===d.length)ia.ULS.sendTraceTag(507635022,0,15,`SheetProcessedDataProvider.prefetchSheetProcessedData: there are ${T}/${d.length} available spds, nothing to prefetch.`),this.DL.X6a({success:!0,entriesCount:this.azb});else{ia.ULS.sendTraceTag(507635021,0,50,`SheetProcessedDataProvider.prefetchSheetProcessedData: there are ${T}/${d.length} available spds, searching for unavailable SPD to prefetch...`);T=z-1;z+=1;for(var ya;0<=T||z<d.length;){if(0<=T){var sb=d[T];
if(k(sb)){ya=sb.sheetName;break}--T}if(z<d.length){sb=d[z];if(k(sb)){ya=sb.sheetName;break}z+=1}}null==ya?(this.DL.X6a({success:!0,entriesCount:this.azb}),ia.ULS.sendTraceTag(507635020,1,50,"SheetProcessedDataProvider.prefetchSheetProcessedData: done prefetching.")):this.da.Lrk(ya).then(()=>{this.Zme()}).catch(cc=>{--this.g8d;const Fc=Zh.a.isExpectedError(cc);ia.ULS.sendTraceTag(507635019,0,50,`SheetProcessedDataProvider.prefetchSheetProcessedData: unable to prefetch SPD, error='${cc.message}', isExpected=${Fc}. Remaining attempts=${this.g8d}...`);
0<this.g8d?this.Zme():this.DL.X6a({success:!1,entriesCount:this.azb,abortReason:"failedAttemptsLimit"})})}}}xKk(){let d=!0,z;--this.bgg;0>this.bgg&&(z="iterationLimit",d=!1);this.Nmi&&(z="maxEntriesExceeded",d=!1);d||(this.DL.X6a({success:!1,entriesCount:this.azb,abortReason:z}),ia.ULS.sendTraceTag(507635018,0,50,`SheetProcessedDataProvider.shouldAttemptPrefetch: unable to prefetch all SPDs, reason=${z}`));return d}get Nmi(){return 1E3<=this.azb}get azb(){var d=this.$.sa.items;let z=0;for(const T of d)d=
T.sheetProcessedData,Object(sd.d)(d)&&(z+=d.value.p4a);return z}get ILh(){let d=0;const z=this.$.sa.items;for(const T of z)d+=Object(sd.d)(T.sheetProcessedData)?1:0;return d}};Di=Object(rb.__decorate)([Object(zc.d)(oc.Wf),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,Object(oc.id)()),Object(rb.__param)(2,Object(oc.Sg)())],Di);Object(Va.a)(Di,"SheetProcessedDataPrefetcher",null,[]);var Pi=a(245),$h=a(130),Ei=a(599);class Fi extends sa.a{constructor(d,z,T,ya){super();this.value=null;this.$=
ya;this.H0d=d;this.xF=z;this.hph=T}dCh(d){this.addHandler("EnabledStateChanged",d)}get isEnabled(){return this.xF}set isEnabled(d){d!==this.xF&&(this.xF=d,be.a.Mo(this.$)&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.H0d.replace(" ","")+"Button",d)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get yo(){return this.value?String.format(ab.a.instance.sh(79),this.H0d,this.value):this.H0d}get pMc(){return this.hph}}Object(Va.a)(Fi,"StatusBarAggregateControl",
sa.a,[638]);class rh extends sa.a{constructor(d){super();this.controls=new vf.a(!1);this.UGe=null;this.vfe=()=>{this.raiseEvent("AggregatesChanged")};this.$=d;this.sla(0,415,"Average",!0);this.sla(1,416,"Count",!0);this.sla(2,417,"NumericalCount",!1);this.sla(3,418,"Minimum",!1);this.sla(4,419,"Maximum",!1);this.sla(5,420,"Sum",!0)}cBh(d){this.addHandler("AggregatesChanged",d)}Alk(d){this.removeHandler("AggregatesChanged",d)}get hfb(){return this.UGe||rh.Xsf}set hfb(d){var z;d=d||rh.Xsf;if(d!==this.hfb)if(this.QPa(0,
d.Average),this.QPa(1,d.Count),this.QPa(2,d.NumericalCount),this.QPa(3,d.Minimum),this.QPa(4,d.Maximum),this.QPa(5,d.Sum),this.UGe=d,be.a.Mo(this.$))if(Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8624907_movingStatusBarAggregatesToDispatch")){const T=[];null===(z=this.controls)||void 0===z?void 0:z.forEach(ya=>{const sb=ya.value;ya.key.startsWith("Query")&&(T.push(appChrome.actions.updateControlHiddenState(ya.key,!sb.isVisible)),T.push(appChrome.actions.setControlLabel(ya.key,sb.yo)))});0<T.length&&
appChrome.api.dispatch(T)}else this.vfe();else this.vfe()}dispose(){nb.a.gj(this.controls.values);this.controls.clear();super.dispose()}SJa(d){return this.controls.getItem(d)}Axh(d,...z){d=this.SJa(d.toString());for(const T of z)this.controls.add(T,d)}sla(d,z,T,ya){z=new Fi(ab.a.instance.Ea(z),ya,T,this.$);z.dCh(this.vfe);this.controls.add(d.toString(),z)}QPa(d,z){this.SJa(d.toString()).value=z}static get Xsf(){rh.eEa||(rh.eEa={},rh.eEa.Average=rh.eEa.Count=rh.eEa.NumericalCount=rh.eEa.Minimum=rh.eEa.Sum=
null);return rh.eEa}}rh.eEa=null;Object(Va.a)(rh,"StatusBarAggregateControlCollection",sa.a,[]);var Gi=a(398),li=a(4),Si=a(211),qi;const gi=[{ifb:0,name:"Average",Q9a:-1015637685,jfb:1,Jkb:!0},{ifb:1,name:"Count",Q9a:1957769939,jfb:3,Jkb:!1},{ifb:2,name:"NumericalCount",Q9a:-1292677035,jfb:2,Jkb:!1},{ifb:3,name:"Minimum",Q9a:405783320,jfb:5,Jkb:!0},{ifb:4,name:"Maximum",Q9a:1210824414,jfb:4,Jkb:!0},{ifb:5,name:"Sum",Q9a:1265371067,jfb:9,Jkb:!0}];let lh=qi=class{constructor(d,z){this.statusBarManager=
void 0===z?null:z;this.Kzc=this.h3c=this.i3c=this.g3c=null;this.kqb=new vf.a(!0);this.V_g=0;this.v3g=T=>{const ya=this.ha.qa.activeCell.clone(),sb=qd.d(this.ha.qa.selectedRanges);var cc=this.$.ma;const Fc=null===cc||void 0===cc?void 0:cc.sheetId,Wc=null===cc||void 0===cc?void 0:cc.hash,id=this.$.ea.Ek,Dd=this.$.ea.NC;cc=this.$.listSeparator;const ee=qd.j(qd.L(sb),cc,this.$,!1),re=`=${this.Sj.config.localeInfo.getWorksheetFuncName(485)}({0}${cc}5${cc}{1})`;Promise.all(gi.map(Ce=>this.Sj.evalFormula(String.format(re,
Ce.jfb,ee),ya,void 0,Ce.Jkb?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(Ce=>{var mf;const tf=this.ha.qa.selectedRanges,Df=this.ha.qa.activeCell,sf=null===(mf=this.$.ma)||void 0===mf?void 0:mf.sheetId;if(qd.X(sb,tf)&&ya.equals(Df)&&Fc===sf){mf=[];for(var $f of Ce.entries()){[,Ce]=$f;if(void 0===(null===Ce||void 0===Ce?void 0:Ce.formatted)||!excelOnlineCalc.util.isSuccess(Ce.formatted)||!excelOnlineCalc.util.isSuccess(Ce.value)){this.hXc();
return}Ce=this.Sj.mN.renderValue(Ce.formatted.value,excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(Ce)){this.hXc();return}if(Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8759742_ExcelOnlineCalcEs2015")&&excelOnlineCalc.numfmt.isHashesValue(Ce.value)){this.hXc();return}Ce=excelOnlineCalc.numfmt.renderedValueToString(Ce.value);mf.push(Ce)}$f={};for(var pg of gi)$f[pg.name]="";pg=mf[1];Ce=mf[2];if(1<+pg&&($f.Count=pg,0<+Ce))for(const hg of gi.entries()){const [Fg,Nh]=
hg;$f[Nh.name]=mf[Fg]}this.d8b($f);this.JYk($f,pg,id,Dd,sb,ya,Fc,Wc,T)}}).catch(Ce=>{ia.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason fields: ${JSON.stringify(Ce)}, reason message: ${String(Ce)}, stack: ${null!==Ce&&"object"===typeof Ce?Ce.stack:void 0}`);this.hXc()})};this.Jj=()=>{this.Z4g()};this.onBlockCacheItemChanged=(T,ya)=>{T=ya.mj.hash;ya=ya.mj.block;const sb=ya.Sfa;if(ya.state&4&&sb&&sb!==this.kqb.getItem(T)){this.kqb.add(T,sb);var cc=(T=ya.ql)?cd.e(T.getRowNumbers(),
T.getColumnNumbers()):null;Pi.a.any(this.ha.qa.selectedRanges,Fc=>Fc.Xi(cc))&&this.Z4g()}};this.qx=(T,ya)=>{this.kqb.remove(ya.mj.hash)};this.Cj=()=>{this.$.la.fi(29,T=>{this.statusBarManager=T;T.hO(this);ia.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};this.ij=(T,ya)=>{!T.ki&&Qc.b(ya)&&this.statusBarManager&&(this.statusBarManager.tN(this),this.statusBarManager=null,ia.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};
this.rZk=()=>{let T;const ya=this.ha.qa.selectedRanges;(()=>{let sb=this.E3k(ya);({bqc:T}=sb);return sb})().returnValue?this.d8b(T):this.vHg()};this.vHg=()=>{var T;const ya=qd.d(this.ha.qa.selectedRanges),sb=this.ha.qa.activeCell.clone(),cc=null===(T=this.$.ma)||void 0===T?void 0:T.sheetId;this.nbg(sb,ya,Fc=>{var Wc;const id=this.ha.qa.selectedRanges,Dd=this.ha.qa.activeCell,ee=null===(Wc=this.$.ma)||void 0===Wc?void 0:Wc.sheetId;qd.X(ya,id)&&sb.equals(Dd)&&cc===ee&&this.d8b(Fc.Result)})};this.initData(d);
d.Ma.Wta(this);this.z6e=Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AlwaysTestCalcResult",!1);this.$=d;this.da=cd.f(this.$);this.hma=wa.AFrameworkApplication.rj;this.Yp=Td.a.ih;this.wGa=new rh(this.$);this.$.ea.$q(this.ij);this.$.mr(this.Cj);this.ha.Zw(this.Jj);this.ha.add_activeCellChanged(this.Jj);this.za.nz(this.onBlockCacheItemChanged);this.za.lU(this.qx);for(const T of gi)this.zHk(T.ifb,T.name,T.Q9a);this.statusBarManager&&this.statusBarManager.hO(this);void zc.a.resolve(oc.E,
{va:1}).then(T=>this.Sj=T);void zc.a.sj(oc.Cd).then(T=>this.instantaneousSupportInformationManager=T)}oy(d){this.wGa.cBh(d)}cy(d){this.wGa.Alk(d)}get hfb(){return this.wGa.hfb}d8b(d){this.wGa.hfb=d}get za(){return this.da.za}get ha(){return this.da.ha}dispose(){this.$&&(this.$.ea.Uq(this.ij),this.$.Wr(this.Cj),this.ha.vx(this.Jj),this.ha.remove_activeCellChanged(this.Jj),this.za.Zy(this.onBlockCacheItemChanged),this.za.UV(this.qx),this.ndf());this.statusBarManager&&(this.statusBarManager.tN(this),
this.statusBarManager=null);nb.a.gj([this.g3c,this.i3c,this.h3c,this.wGa]);this.$=this.wGa=this.h3c=this.i3c=this.g3c=null;this.kqb&&(this.kqb.clear(),this.kqb=null)}Ay(d,z){return this.SJa(d)&&this.EKf(d,z)?!0:!1}EKf(d,z){const T=this.SJa(d);if(!T)return!1;const ya=T.yo;if(d.endsWith("Label"))z.Visible=T.isVisible,be.a.Mo(this.$)?z.LabelText=ya:z.Value=ya;else if(d.endsWith("Button"))z.LabelText=ya,z.On=T.isEnabled,$h.FocusManager.instance().Xr(Ei.AFrame.b2);else return!1;return!0}rr(){return!0}Ri(){return!1}executeCommand(d,
z){d=this.SJa(z.command);if(!d)return Si.a(z.command);d.isEnabled=!d.isEnabled;this.Dzj(d.pMc,d.isEnabled);return je.Task.Ua(!0)}Gi(d,z){return!!this.SJa(z.command)}dj(){return!1}nbg(d,z,T){var ya=this.$;this.ndf();if(this.$.ea.ki){var sb=ya.pa.ta;d=qd.q(d,ya);z=qd.t(z,ya);ya=sb.$a(1,null);ya.activeCell=d;ya.selectedRanges=z;this.Kzc=dc.h(sb,"GetStatusBarAggregates",ya,T,null,null,null,0)}}E3k(d){let z,T=qi.u3g(d);({bqc:z}=T);return{returnValue:T.returnValue||this.aJh(d)&&this.YIh(d),bqc:z}}JYk(d,
z,T,ya,sb,cc,Fc,Wc,id){const Dd=this.z6e?1:.05,ee=this.z6e?1E3:20;if(id||!(this.V_g>ee||Math.random()>Dd))this.V_g++,this.nbg(cc,sb,re=>{var Ce,mf,tf,Df;if(!Hb.a(re)){var sf=this.ha.qa.selectedRanges,$f=this.ha.qa.activeCell,pg=null===(Ce=this.$.ma)||void 0===Ce?void 0:Ce.sheetId;Ce=re.StateId;if(qd.X(sb,sf)&&cc.equals($f)&&Fc===pg&&T===this.$.ea.Ek&&ya===this.$.ea.NC&&T===Ce){var hg=re.Result;Ce={};const vj={};pg=!0;for(var Fg of gi){var Nh=hg[Fg.name],ch=d[Fg.name];const Al=Nh===ch;Ce[Fg.name]=
Al;vj[Fg.name]=[Nh.length,ch.length];pg&&(pg=Al)}({category:$f}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.y3k(null!==(Df=null===(tf=null===(mf=this.da.zh($f))||void 0===mf?void 0:mf.cell)||void 0===tf?void 0:tf.qo)&&void 0!==Df?Df:0):{category:"uninitialized"});mf=sf.length;sf=qd.b(sf);tf=this.da.cRf()||this.da.bRf();Fg=this.da.fh;Df=Fg.E2b;Fg=ue.c(cc,Fg.Gm,Fg.Ym,this.da.rowsPerBlock,this.da.columnsPerBlock,this.da.kj);Fg=Fg.X+"_"+Fg.Y+"_"+Fg.PaneType;
hg=hg.Count;Nh=d.Count;ch=this.da.oh.LBc(sb);re=`StatusBarAggregateManager.testCalcResult: allCorrect: ${pg}, ${JSON.stringify(Ce)}, numberFormatCategory: ${$f}, resLength(server,calc): ${JSON.stringify(vj)}, stateId: ${T}, latestSuccessfulStateId: ${ya}, prevSheetId: ${Fc}, prevSheetHash: ${Wc}, numOfRanges: ${mf}, numOfCells: ${sf}, prevActiveCell: ${cc}, prevSelectedRanges: ${sb.join(";")}, sheetHasHidden: ${tf}, panesState: ${Df}, blockPositionString: ${Fg}, ReportCalcState: ${re.ReportCalcState}, CalcComplete: ${re.CalcComplete}, serverCount: ${hg}, calcCount: ${Nh}, calcCountUnfiltered: ${z}, enumeratorCount: ${ch}, forceTestResult: ${id}`;
ia.ULS.sendTraceTag(520426510,0,50,re);pg||id||window.setTimeout(()=>{this.v3g(!0)},100)}}})}aJh(d){const z=this.da.Dp;return!!z&&Pi.a.all(d,T=>z.contains(T))&&Pi.a.all(d,T=>!this.da.kj.Coa(T))}YIh(d){if(500<qd.b(d))return!1;const z=this.Yp.$j;d=this.da.vfa("StatusBarAggregateManager.AreAllCellsEmpty",d);try{for(let T=0;d.$$mn();T++)if(d.$$cu().uQ||!(T%25)&&100<Yb.c(this.Yp,z))return!1}finally{d&&d.dispose()}return!0}SJa(d){return this.wGa.SJa(d)}zHk(d,z,T){this.wGa.Axh(d,"Query"+z+"Label","Query"+
z+"Button",T.toString())}Z4g(){var d;if(this.$.Ij&4&&!this.da.isEditing&&!this.da.lq){var z;(()=>{let T=qi.u3g(this.ha.qa.selectedRanges);({bqc:z}=T);return T})().returnValue?this.d8b(z):(this.d8b(null),(null===(d=this.Sj)||void 0===d?0:d.sGc)?this.jxk():this.g3c=Gc.AsyncMethodContext.wC(this.rZk,500,vd.a.vVk,this.g3c))}}jxk(){this.h3c=Gc.AsyncMethodContext.wC(()=>this.v3g(!1),10,vd.a.wVk,this.h3c)}hXc(){this.i3c=Gc.AsyncMethodContext.wC(this.vHg,500,vd.a.uVk,this.i3c)}ndf(){this.Kzc&&(this.hma.fE(this.Kzc.uD),
this.Kzc=null)}Dzj(d,z){const T={};T.a=this.$.ua.UserSessionId;T.b=d;T.c=z;gh.b().Ll(29,T)}initData(d){const z=Gi.a.rla;for(const T of gi)z(T.Q9a,be.a.Mo(d)?li.a.sk|8192:li.a.sk,0,0)}static u3g(d){return{returnValue:1===d.length&&d[0].isSingle,bqc:null}}};lh=qi=Object(rb.__decorate)([Object(zc.d)(oc.rg),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,Object(Ld.h)())],lh);Object(Va.a)(lh,"StatusBarAggregateManager",null,[593,4,155,156,34]);var vi=a(391),wi=a(953),Hi=a(228);class Oh{constructor(){this.vuh=
new Nb.a;this.wuh=new Nb.a}get I9a(){return this.vuh}get n0g(){return this.wuh}get dz(){return this.gZk}rAh(d,z){this.I9a.add(d);this.n0g.add(z)}sAh(d,z){this.gZk={c6d:d,N4d:z}}}Object(Va.a)(Oh,"ThemeInfoCache",null,[]);var Wf=a(45);let Kg=class{constructor(d){this.I9a=this.WZ=null;this.JHc=!1;this.Qwe=null;this.mNc=new Set;this.Gyb=this.ped=!1;this.HPb=0;this.FUj=z=>{this.JHc=!1;if(!z||Hb.a(z))ia.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${z?na.a.Yh(z.Errors):
"(no result)"}]`),this.dJg();else if(this.HPb=0,z=z.Result){null!==this.WZ&&this.N_h(z);this.WZ=new Oh;this.I9a=z.ThemeColors;this.Qwe=[];for(var T=0;10>T;T++)this.Qwe.push(wi.a.hKa(Hi.a.LM(this.I9a[T])));for(T=0;6>T;T++)for(let ya=0;10>ya;ya++){const sb=te.a.Oia(te.a.I2(this.I9a[10*T+ya])),cc=wi.a.jQi(T,ya,this.Qwe[ya],this.I9a[ya]);this.WZ.rAh(sb,cc)}this.WZ.sAh(z.MinorFont,z.MajorFont);this.Gyb=!1;be.a.el()&&(Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8768685_FixCommonUiStringsCrash")&&!vi.a.yfb&&
vi.a.TUb(),vi.a.syj([z.MajorFont,z.MinorFont]));Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)&&Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewOfficeDefaultThemeSurvey",!1)&&"Aptos Narrow"===z.MinorFont&&(z=Wf.a.instance.Gga(new Date),27E4>z?window.setTimeout(()=>{this.$.si(-569754003,-1,0,null)},27E4-z):this.$.si(-569754003,-1,0,null));this.ped=!1;this.jqa()}else ia.ULS.sendTraceTag(556656003,0,10,"ThemesManager: The obtained ThemeInfo is null")};
this.EUj=()=>{this.JHc=!1;this.dJg()};this.dJg=()=>{3>this.HPb?(this.HPb++,ia.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.HPb}`),this.$Ia(null,!0)):(this.HPb=0,ia.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.G1b=()=>{this.WZ&&(ia.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),this.Gyb=!0,this.$Ia(null,!0))};this.ij=(z,T)=>{this.WZ&&
(ia.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),T.RM&&(this.ped=!0))};this.Cj=(z,T)=>{T.dm&&yf.HelperMethods.RZc(this.$)&&this.$Ia(null,!0)};this.nN=()=>{this.mNc.clear()};this.$=d;this.$.ea.oO(this.G1b);this.$.ea.$q(this.ij);this.$.Ma.dIb(this.nN);Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8557769_fetchThemeInfoViewToEdit")&&this.$.mr(this.Cj)}dispose(){var d,z,T,ya,sb,cc,Fc;Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8557769_fetchThemeInfoViewToEdit")&&(null===(z=null===
(d=this.$)||void 0===d?void 0:d.ea)||void 0===z?void 0:z.aQ(this.G1b),null===(ya=null===(T=this.$)||void 0===T?void 0:T.ea)||void 0===ya?void 0:ya.Uq(this.ij),null===(cc=null===(sb=this.$)||void 0===sb?void 0:sb.Ma)||void 0===cc?void 0:cc.h5b(this.nN),null===(Fc=this.$)||void 0===Fc?void 0:Fc.Wr(this.Cj))}get Hyb(){return!this.WZ||this.Gyb?null:this.WZ.I9a}get m0g(){return!this.WZ||this.Gyb?null:this.WZ.n0g}get dz(){return!this.WZ||this.Gyb?null:this.WZ.dz}get F3f(){return this.ped}$Ia(d,z){if(this.$.isEditMode||
(void 0===z?0:z)||Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8768686_FixOpenMFPInEmbedView")&&this.$.Ih.allowTypingAndFormulaEntry)if(!this.WZ||this.F3f||this.Gyb)if(d&&""!==d&&this.mNc.add(d),!this.JHc){this.JHc=!0;d=this.$.pa.ta;z=this.FUj;var T=this.EUj;const ya=d.$a(1,null);dc.h(d,"GetThemeInfo",ya,z,T,null,null,4)}}getThemeColor(d){let z,T=-1;z=-1;if(!this.Hyb)return ia.ULS.sendTraceTag(537150475,0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,themeIndex:-1,OQa:z};for(let ya=
0;ya<this.Hyb.count;ya++)if(d===this.Hyb.na(ya)){T=ya;break}if(-1!==T)return z=Math.floor(T/10),{returnValue:!0,themeIndex:T%10,OQa:z};ia.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,OQa:z}}jqa(){for(const d of this.mNc)this.$.frame.VA(d);this.mNc.clear()}N_h(d){const z=this.WZ.dz.N4d;this.WZ.dz.c6d===d.MinorFont&&z===d.MajorFont||ia.ULS.sendTraceTag(512230155,0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};
Kg=Object(rb.__decorate)([Object(zc.d)(oc.Dg),Object(rb.__param)(0,Object(oc.Nb)())],Kg);Object(Va.a)(Kg,"ThemesManager",null,[594,4]);var Ph=a(1030);class hh{static jGi(d){try{return caches.open(hh.dIe).then(z=>z.match(d))}catch(z){return Promise.reject(null)}}static MJa(d,z){try{return hh.jGi(d).then(T=>T&&Number.parseInvariant(T.headers.get("cachedTime"))>Date.now()-z?Promise.resolve(T.text().toLocaleString()):Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch(T){return Promise.reject(null)}}static store(d,
z){try{return caches.open(hh.dIe).then(T=>{T.put(d,z).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(T){return Promise.resolve(!0)}}static RVk(d,z){const T={};T.body=z;const ya={};ya.cachedTime=Date.now().toString();T.headers=ya;z=new Response(z,T);hh.store(d,z).then(()=>!0)}}hh.dIe="ConsentState";Object(Va.a)(hh,"CacheManager",null,[]);class Ih{constructor(){this.message=null;this.httpStatusCode=0}}Object(Va.a)(Ih,"HttpRequstToPromiseRejectData",null,[]);class Jh{constructor(d){this.N9=
d}V6(d,z,T,ya,sb,cc){eb.a.sendTelemetryEvent({name:"Office.Online."+d,dataFields:[{name:"EventMessage",string:z},{name:"FormFactor",string:this.N9.formFactor},{name:"CorrelationId",string:this.N9.correlationId},{name:"AccountType",string:this.N9.accountType},{name:"OSVersion",string:this.N9.osVersion},{name:"AppId",string:this.N9.appId},{name:"ConsentSurface",string:"AppStart"},{name:"ConsentLanguage",string:this.N9.consentLanguage},{name:"EventCode",string:T},{name:"Region",string:this.N9.region},
{name:"ModelType",string:ya},{name:"ModelId",string:sb},{name:"Platform",string:this.N9.os},{name:"ReConsentReason",string:""},{name:"ConsentType",string:cc}]})}}Object(Va.a)(Jh,"TelemetryLogger",null,[]);var xi=a(241);class mh{constructor(d,z,T){this.tjh="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Ga=d;this.Yn=z;this.TFa=T;this.z_=new Jh(T)}XXa(d,z){return new Promise((T,ya)=>{const sb=this.Ga.Lj("UCNoticeCheckinCallTimeoutMs",5E3);let cc=this.Ga.Ya("UCNoticeCheckinStateUrl");
cc&&cc.length||(cc=this.tjh);this.Yn.c$(cc,1,null,this.ORb(d),null,!1,0,Fc=>{try{if(void 0===Fc||null===Fc||void 0===Fc.data||null===Fc.data||void 0===Fc.data.responseData||null===Fc.data.responseData){this.z_.V6("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");ya(this.QR(id,
Fc))}else if(Fc.data.httpStatus!==xi.a.HL){this.z_.V6("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",Fc.data.httpStatus.toString(),null,null,null);const id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Fc.data.httpStatus,"UnifiedConsent.ConsentGetFailed");ya(this.QR(id,Fc))}else{var Wc=z(Fc.data.responseData);if(Wc)T(Wc);else{this.z_.V6("UnifiedConsent.ConsentGetFailed",
"CheckInApi : Consent values are empty","712",null,null,null);const id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");ya(this.QR(id,Fc))}}}catch(id){this.z_.V6("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),Wc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",id,"UnifiedConsent.ConsentGetFailed"),ya(this.QR(Wc,
Fc))}},Fc=>{this.z_.V6("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Fc.data.httpStatus.toString(),null,null,null);const Wc=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",Fc.data.httpStatus,"UnifiedConsent.ConsentGetFailed");ya(this.QR(Wc,Fc))},null,void 0,void 0,2500,sb)})}QR(d,z){const T=new Ih;T.message=d;T.httpStatusCode=z&&z.data?z.data.httpStatus:-1;return T}ORb(d){const z={};z["Accept-Language"]=
this.TFa.consentLanguage;z.consentsurface="AppStart";z.platform="Web";z.formfactor=xf.a.j1?"Mobile":"Desktop";z["x-Cid"]=this.TFa.correlationId;z.Authorization="Bearer "+d;return z}}Object(Va.a)(mh,"HttpRequestToPromiseUtility",null,[]);var Od=a(117);class pe{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;
this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(Va.a)(pe,"WebSdkAdapterProps",null,[]);var ph=a(47);class Eg{constructor(d,z,T,ya){this.DNe=this.bsa=this.Yda=this.G9=null;this.C4j=sb=>{if(void 0===sb||null===sb)return this.z_.V6(Eg.HTa,"Checkin response undefined or null","705",this.G9,this.Yda,this.bsa),null;try{const {zz:cc}=ph.d(sb);return cc}catch(cc){this.z_.V6(Eg.HTa,"Checkin response parse error : "+cc.message,"706",this.G9,this.Yda,this.bsa)}return null};this.qab=
ya;this.Ga=d;this.Shh=T;this.Yn=z;this.TFa=this.getDimensions();this.z_=new Jh(this.TFa)}xUg(){"MSA"===(this.Ga.Ya("HostAuthType")||"").toUpperCase()&&hh.MJa(this.TFa.userId,this.Ga.Lj("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.z_.V6(Eg.HTa,"CacheFound","701",this.G9,this.Yda,this.bsa);return{}}).catch(()=>{this.Shh.execute(d=>{d.gE("Consent",Eg.$th).then(z=>{z.IsSuccess?(this.z_.V6(Eg.HTa,"CheckInTokenSuccess","702",this.G9,this.Yda,this.bsa),this.cIi(z.Token).then(T=>{this.hQi(T);this.G9&&
""!==this.G9&&d.gE("Consent",Eg.buh).then(ya=>{ya.IsSuccess?(this.z_.V6(Eg.HTa,"WebTokenSuccess","703",this.G9,this.Yda,this.bsa),this.lQk(ya,this.G9)):this.z_.V6(Eg.HTa,"WebTokenFailed : "+ya.ErrorMessage,ya.ErrorCode,this.G9,this.Yda,this.bsa);return{}});return{}})):this.z_.V6(Eg.HTa,"CheckInTokenFailed : "+z.ErrorMessage,z.ErrorCode,this.G9,this.Yda,this.bsa);return{}})})})}cIi(d){this.DNe=new mh(this.Ga,this.Yn,this.TFa);return this.DNe.XXa(d,this.C4j).then(z=>Promise.resolve(z),z=>Promise.reject("Error while getting result"+
z))}hQi(d){for(const z of d.consentValues)if(z.needConsent&&!z.maxPromptsReached){this.Yda=z.id;this.bsa=z.consentType;this.G9=z.modelType;return}hh.RVk(this.TFa.userId,ph.c(d))}lQk(d,z){if(Od.a("showConsentNotice")){const T=document.createElement("div");document.body.appendChild(T);appChrome.api.showConsentNotice(this.WJi(d.Token,z),T)}else this.z_.V6(Eg.Ioh,"1JS : ShowConsentNotice API not found","704",this.G9,this.Yda,this.bsa)}WJi(d,z){const T=this.TFa;T.token=d;T.modelType=z;return T}getDimensions(){const d=
this.jFc(this.Ga.Ya("SessionStartInfoJson"));return Object.assign(new pe,{emailId:this.Ga.Ya("UserPrincipalName"),userId:this.Ga.Ya("LoggableUserId"),accountType:"AAD"===(this.Ga.Ya("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Ga.Ya("OfficeApplicationId"),appVersion:this.Ga.Ya("appVersion"),appName:"Application"in d?d.Application:"",appEnv:this.qab,consentLanguage:this.Ga.Ya("UICulture")||"en-US",formFactor:xf.a.j1?"Mobile":"Desktop",os:"Os"in d?d.Os:"",osVersion:"OsVersion"in d?d.OsVersion:
"",region:this.Ga.Ya("region"),correlationId:gb.a.create().toString(),isDarkMode:this.Ga.ka("DarkModeIsOn"),useCache:!0})}jFc(d){let z={};try{z=ph.b(d)}catch(T){}return z}}Eg.buh="https://consentservice.microsoft.com/web";Eg.$th="https://consentservice.microsoft.com/checkin";Eg.Ioh="UnifiedConsent.ConsentGetFailed";Eg.HTa="UnifiedConsent.AuthTokenStatus";Object(Va.a)(Eg,"ConsentNoticeManager",null,[652]);class Ji{constructor(){this.Wh=null}get name(){return"Common.App.ConsentNoticeDialog"}$n(d){this.Wh=
d;d.register(Eg,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").yi().Ei(()=>new Eg(wa.AFrameworkApplication.fa,wa.AFrameworkApplication.rj,Object(Ph.a)(),wa.AFrameworkApplication.jwa))}init(){dg.a.instance.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){Lc.a.instance.Do(new Ji)}}Object(Va.a)(Ji,"ConsentNoticeDialogPackage",null,[11,12]);let yi=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");
Ji.main();dg.a.instance.fj("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(d=>d.xUg())}};yi=Object(rb.__decorate)([Object(zc.d)(oc.Jg)],yi);Object(Va.a)(yi,"UnifiedConsentAdapter",null,[]);var Eh=a(941);class Ki{constructor(d,z){this.viewportScenarioContext=d;this.ira=z}dispose(){var d;null===(d=this.ira)||void 0===d?void 0:d.FCa("dispose")}dia(d){var z;null===(z=this.ira)||void 0===z?void 0:z.FCa("navigationStart",d)}QP(){var d;null===(d=this.ira)||void 0===d?void 0:d.FCa("scrollEnd")}Jgg(d){var z;
null===(z=this.ira)||void 0===z?void 0:z.FCa("activeItemChanged",d)}usg(){var d;null===(d=this.ira)||void 0===d?void 0:d.FCa("viewportReachedRequiredStateId")}}Object(Va.a)(Ki,"ViewportObservedScenario",null,[]);var Kh=a(690);const Li={navigationStart:"navigationStarted",scrollEnd:"unexpected",viewportReachedRequiredStateId:"unexpected",activeItemChanged:"unexpected",zoomOrSizeChange:"idle",dispose:"disposed"},ai={idle:Li,navigationStarted:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"scrollEnded",
viewportReachedRequiredStateId:"navigationStarted",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"navigationStarted",dispose:"disposed"},scrollEnded:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"unexpected",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"scrollEnded",dispose:"disposed"},navigationEnd:Li,abortNavigationAndStartNew:Li,abortNavigationAndStartActiveItemChange:Li,unexpected:Li,
disposed:{navigationStart:"disposed",scrollEnd:"disposed",viewportReachedRequiredStateId:"disposed",activeItemChanged:"disposed",zoomOrSizeChange:"disposed",dispose:"disposed"}},sh={navigationStart:"unexpected",scrollEnd:"unexpected",viewportReachedRequiredStateId:"unexpected",activeItemChanged:"activeItemChangeStarted",zoomOrSizeChange:"idle",dispose:"disposed"},kj={idle:sh,activeItemChangeStarted:{navigationStart:"duringActiveItemChange",scrollEnd:"unexpected",viewportReachedRequiredStateId:"navigationEnd",
activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"activeItemChangeStarted",dispose:"disposed"},duringActiveItemChange:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"duringActiveItemChange",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"duringActiveItemChange",dispose:"disposed"},navigationEnd:sh,abortNavigationAndStartNew:sh,abortNavigationAndStartActiveItemChange:sh,unexpected:sh,disposed:{navigationStart:"disposed",
scrollEnd:"disposed",viewportReachedRequiredStateId:"disposed",activeItemChanged:"disposed",zoomOrSizeChange:"disposed",dispose:"disposed"}},Qi=new Ki({name:"ViewportObserverState.idle"});class hi{constructor(d){var {dia:z,B1b:T,J$d:ya}=d;this.dli=()=>{const sb=this.mB.viewportScenarioContext;this.mB.dispose();this.mB=Qi;this.B1b(sb)};this.Nvh=sb=>{this.C0e(sb);this.mB=new Ki(sb,new Kh.a("idle",ai,this.AQ));this.mB.dia(sb)};this.Mvh=sb=>{this.C0e(sb);this.mB=new Ki(sb,new Kh.a("idle",kj,this.AQ));
this.mB.Jgg(sb)};this.C0e=sb=>{this.J$d(sb);this.mB.dispose()};this.mB=Qi;this.dia=z;this.B1b=T;this.J$d=ya;this.AQ={abortNavigationAndStartNew:this.Nvh,abortNavigationAndStartActiveItemChange:this.Mvh,navigationEnd:this.dli}}dispose(){this.mB.dispose();this.mB=Qi}get mB(){return this.Sjh}set mB(d){d!==Qi&&this.dia(d.viewportScenarioContext);this.Sjh=d}get vob(){return this.mB===Qi}Npg(d){this.vob&&(this.mB=new Ki(d,new Kh.a("idle",ai,this.AQ)));this.mB.dia(d)}onActiveItemChanging(d){this.vob&&(this.mB=
new Ki(d,new Kh.a("idle",kj,this.AQ)));this.mB.Jgg(d)}zQc(d){this.mB.QP();this.n4f(d)&&this.mB.usg();return this.mB.viewportScenarioContext}d7(d){this.n4f(d)&&this.mB.usg()}n4f(d){return void 0!==this.mB.viewportScenarioContext.O5b&&d>=this.mB.viewportScenarioContext.O5b}}Object(Va.a)(hi,"ViewportObserverState",null,[]);class Jg{constructor(d){this.da=d}goj(d){if(!d)return!0;d.$_();return!this.da.fh.PYd(d)&&this.da.mba(d,!1)}}Object(Va.a)(Jg,"NavigationResultValidator",null,[]);let yh=class{constructor(d){this.da=
d;this.BD=C();this.Eng=(z,T)=>{this.jAb.Npg(this.Eod(T))};this.Nog=(z,T)=>{this.jAb.Npg(this.Eod(T))};this.A4a=()=>{};this.onActiveItemChanging=()=>{this.jAb.onActiveItemChanging(this.Eod({name:"GridView.OnActiveItemChanged"}))};this.nq=()=>{};this.zQc=()=>{const z=this.jAb.zQc(this.da.Nra);this.BD.dispatchEvent("ScrollEnd",{viewportScenarioContext:z})};this.d7=(z,T)=>{T.k1a&&this.jAb.d7(T.Nra)};this.B1b=z=>{y(z)||"zoom"===z.name||this.HJj.goj(z.targetRange)||this.Vck(z);this.Fzg(z,"complete")};this.Wck=
z=>{this.BD.dispatchEvent("NavigationStart",{viewportScenarioContext:z})};this.Uck=z=>{this.Fzg(z,"aborted")};Pb.EwaSettings.T2a()?(ia.ULS.sendTraceTag(507606538,0,50,"ViewportObserver.ctor: flight is on"),this.HJj=new Jg(d),this.jAb=new hi({dia:this.Wck,B1b:this.B1b,J$d:this.Uck}),d.Zod(this.A4a),d.$.xI(this.nq),d.$.fu.tX(this.onActiveItemChanging),d.npd(this.d7),d.view.z4e(this.Eng),d.view.fEh(this.Nog),d.view.bnc(this.zQc)):ia.ULS.sendTraceTag(507606539,0,50,"ViewportObserver.ctor: flight is off")}vod(d,
z){Pb.EwaSettings.T2a()&&this.BD.addEventListener("NavigationStart",d,{signal:z})}L2e(d,z){Pb.EwaSettings.T2a()&&this.BD.addEventListener("NavigationFail",d,{signal:z})}Ozh(d,z){Pb.EwaSettings.T2a()&&this.BD.addEventListener("ScrollEnd",d,{signal:z,once:!0})}K2e(d,z,T){Pb.EwaSettings.T2a()&&this.BD.addEventListener("NavigationEnd",d,{signal:z,once:T})}dispose(){Pb.EwaSettings.T2a()&&(this.da.Mie(this.A4a),this.da.$.gL(this.nq),this.da.$.fu.Gn(this.onActiveItemChanging),this.da.Yie(this.d7),this.da.view.BFg(this.Eng),
this.da.view.Znk(this.Nog),this.da.view.MFg(this.zQc),this.jAb.dispose())}Vck(d){this.BD.dispatchEvent("NavigationFail",{viewportScenarioContext:d})}Fzg(d,z){this.BD.dispatchEvent("NavigationEnd",{viewportScenarioContext:d,navigationEndReason:z})}Eod(d){return void 0!==d.O5b?d:Object.assign({},d,{O5b:this.da.$.ea.Ek})}};yh=Object(rb.__decorate)([Object(zc.d)(oc.Rg),Object(rb.__param)(0,Object(oc.id)())],yh);Object(Va.a)(yh,"ViewportObserver",null,[]);class Xi{constructor(){this.defaultRate=this.defaultCount=
this.total=0;this.defaultCountByReason={"ActivateItem-with-SheetCtor":0,"ActivateItem-with-BootFromCache":0,"ActivateItem-with-OpenWorkbook":0,"ActivateItem-with-HttpError":0,"ActivateItem-with-InternalServerError":0,"ActivateItem-with-OnLoadOnDemandOccurred":0,"ActivateItem-with-PartialResult":0,NewSheet:0,NullActiveItem:0,NotReceivedFromOpenWorkbook:0,PartialResult:0};this.prefetchInfo={success:!1,entriesCount:0,abortReason:void 0,maxEntries:void 0}}get reportName(){return"SPD"}}Object(Va.a)(Xi,
"SheetProcessedDataSessionEndsReport",null,[198]);class zh{constructor(){this.maxUsedRow=this.maxUsedColumn=0;this.isRowMaxPixelExceeded=!1}get reportName(){return"Viewport"}}Object(Va.a)(zh,"ViewportSessionEndsReport",null,[198]);class zi{constructor(){this.hitCount=this.total=0;this.missCountByReason={};this.firstScrollSheetMissCount=this.sheetOnBootMissCount=0}}Object(Va.a)(zi,"BlockCacheAccessesTelemetry",null,[]);class Fh{constructor(){this.sessionBoot=new zi;this.postSessionBoot=new zi;this.duringScroll=
new zi;this.blockCacheSize=this.numOfUsedPrefetchedBlocks=this.numOfPrefetchedBlocks=this.accessedBlocksDistinctCount=0}get reportName(){return"BlockCacheAccess"}}Object(Va.a)(Fh,"BlockCacheAccessSessionEndsReport",null,[198]);class Ah{constructor(){this.distinctCount=this.count=0;this.skeletonBlocksCounter={}}get reportName(){return"SkeletonCounter"}}Object(Va.a)(Ah,"SkeletonCounterSessionEndsReport",null,[198]);var Wh=a(176);class Sh extends sa.a{constructor(){super();this.n3b=[];this.rMj()}dispose(){var d;
null===(d=this.Jug)||void 0===d?void 0:d.disconnect();super.dispose()}pDh(d){this.addHandler(Sh.d6d,d)}vnk(d){this.removeHandler(Sh.d6d,d)}R9k(d){this.n3b.push({ZQc:d,timestamp:performance.now()})}rMj(){var d;if(null===(d=PerformanceObserver.supportedEntryTypes)||void 0===d?0:d.includes("long-animation-frame"))try{this.Jug=new PerformanceObserver(z=>{for(const T of z.getEntries())this.mei(T)}),this.Jug.observe({type:"long-animation-frame"})}catch(z){ia.ULS.sendTraceTag(507799641,345,10,`observeLongAnimationFrame: observe({ type: "long-animation-frame" }) failed with: ${z}`)}}mei(d){const z=
[],T=d.startTime;d=T+d.duration;let ya=0;for(let sb=0;sb<this.n3b.length;++sb){const cc=this.n3b[sb],Fc=cc.timestamp;if(Fc>=T&&Fc<=d){z.push({yCj:T,xCj:d,ZQc:cc.ZQc});ya=sb+1;break}if(Fc>T){ya=sb;break}}this.n3b=this.n3b.slice(ya);0<z.length&&this.raiseEvent(Sh.d6d,{VGj:z})}}Sh.d6d="mbdek";Object(Va.a)(Sh,"ScrollMissingBlocksDetector",sa.a,[4]);var lj=a(724);class Mf{constructor(d,z,T,ya,sb,cc,Fc,Wc){this.Yt=cc;this.context=Fc;this.W2=Wc;this.P4a=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8720834_OnMarkAddedRefactor");
this.Hj=!1;this.Uja=new AbortController;this.Rvh=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8731957_NavLatAbortWhenMarkLimitIsReached");this.muk=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8781622_RevertNavLatAbortWhenMarkLimitIsReached");this.f5d=()=>{this.mark("scroll-end")};this.SWj=id=>{this.Dca(id)};this.da=d;this.scenario=ya;this.UUf=z;this.bYc=sb;this.TWj=T;this.mark("start",void 0,null===Fc||void 0===Fc?void 0:Fc.timestamp);this.d7=(id,Dd)=>{Dd.k1a&&(id=Dd.Nra,this.GGa(id)?this.VMa(Dd.timestamp):
-1===id?this.mark("skeleton-blocks",void 0,Dd.timestamp):0<=id&&this.mark("stale-blocks",new lj.a(id),Dd.timestamp))};this.da.npd(this.d7)}get XHc(){return!this.Hj}get Y2d(){return 50}dispose(){this.Hj=!0;this.da.Yie(this.d7)}IJj(){var d,z;null===(d=this.W2)||void 0===d?void 0:d.Ozh(this.f5d,this.Uja.signal);null===(z=this.W2)||void 0===z?void 0:z.K2e(this.SWj,this.Uja.signal,!0)}GGa(d){return d>=this.UUf}d8(d,z,T){var ya;this.mark("end",void 0,T);this.log(d,z);this.uAe(d);null===(ya=this.TWj)||void 0===
ya?void 0:ya.call(this);this.Yt.z4c&&!this.Yt.QWb&&(d=this.Yt.markers,z=d[d.length-1],ia.ULS.shipAssertTag(507557020,0,!!z,"NavigationOperationLatencyTelemetry.scenarioEndLegacy: endMark is undefined!"),this.Yt.measure({from:d[0],H2:z,E5d:this.scenario}))}mark(d,z,T){this.muk?(d=this.Yt.mark(d,this.scenario,z,T),this.P4a&&d&&this.O4a(d,z)):this.Rvh?this.XHc&&!this.Yt.QWb&&(d=this.Yt.mark(d,this.scenario,z,T),this.Yt.QWb?this.d8("aborted","markersMaxLengthReached"):this.P4a&&d&&this.O4a(d,z)):(d=this.Yt.mark(d,
this.scenario,z,T),this.O4a(d,z))}O4a(d){this.P4a&&this.Yt.z4c&&performance.mark(d.name,{startTime:d.timestamp})}log(d,z){d=JSON.stringify(this.u_a(d,z));this.W2?ia.ULS.sendTraceTag(507570122,0,50,`NavigationOperationLatencyTelemetry.log: ${d}`):ia.ULS.sendTraceTag(356298771,0,this.Y2d,`NavigationOperationLatencyTelemetry.log: ${d}`)}u_a(d,z){return{scenario:this.scenario,endReason:d,endDetails:z,initialStateId:this.UUf,duration:this.Yt.duration.toFixed(4),skeletonDuration:this.Yt.skeletonDuration.toFixed(4),
staleDuration:this.Yt.staleDuration.toFixed(4),isMarkersMaxLengthReached:this.Yt.QWb}}VMa(d){this.d8("complete",void 0,d)}Dca(d){const z=d.detail.navigationEndReason;d=d.detail.viewportScenarioContext;ia.ULS.shipAssertTag(507570121,0,this.XHc,`NavigationOperationLatencyTelemetry.scenraioEnd: scenario already ended, logging twice, name=${d.name}, endReason=${z}, requiredViewportStateId=${d.O5b}`);this.d8(z);this.dispose()}}Object(Va.a)(Mf,"NavigationOperationLatencyTelemetry",null,[628]);class ii{constructor(d,
z,T){this.name=d;this.timestamp=z;this.context=T}toJSON(){return{n:this.name,t:this.timestamp.toFixed(4),c:this.context}}}Object(Va.a)(ii,"NavigationMark",null,[]);class Vg{constructor(d){d=void 0===d?!1:d;this.markers=[];this.z4c=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8720834_OnMarkAddedRefactor")&&Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8697299_NavLatPerfMeasureV2")&&!d&&!!performance.measure}get QWb(){return this.markers.length>=Vg.GEj}get duration(){return this.endTime-this.startTime}get skeletonDuration(){return this.markers.reduce((d,
z,T)=>{T=this.markers[T-1];return"skeleton-blocks"===(null===T||void 0===T?void 0:T.name)?d+(z.timestamp-T.timestamp):d},0)}get staleDuration(){return this.markers.reduce((d,z,T)=>{T=this.markers[T-1];return"stale-blocks"===(null===T||void 0===T?void 0:T.name)?d+(z.timestamp-T.timestamp):d},0)}get startTime(){return this.markers[0].timestamp}get endTime(){return this.markers[this.markers.length-1].timestamp}mark(d,z,T,ya){if(!this.QWb)return this.kp(d,T,ya)}j0a(d){return void 0!==this.fHd(d)}measure(d){var {from:z,
H2:T,E5d:ya}=d,sb;d=Object(Eh.e)(z)?this.fHd(z):z;const cc=Object(Eh.e)(T)?this.fHd(T):T;if(d&&cc){var Fc=null!==ya&&void 0!==ya?ya:`${d.name}->${cc.name}`;if(this.z4c)try{var Wc=null===(sb=performance.measure(Fc,d.name,cc.name))||void 0===sb?void 0:sb.duration;void 0===Wc&&ia.ULS.sendTraceTag(507536290,0,15,"NavigationLatencyTracker.measure: performance.measure returned undefined!")}catch(id){ia.ULS.sendTraceTag(507367692,0,15,`NavigationLatencyTracker.measure: performance.measure threw an error,! msg=${null===
id||void 0===id?void 0:id.message}, fromMark=${d.name}, toMark=${cc.name}, measurementName=${Fc}`)}return null!==Wc&&void 0!==Wc?Wc:cc.timestamp-d.timestamp}}kp(d,z,T){d=this.markers.push(new ii(d,null!==T&&void 0!==T?T:performance.now(),z));return this.markers[d-1]}fHd(d){for(let z=this.markers.length-1;0<=z;z--)if(this.markers[z].name===d)return this.markers[z]}}Vg.GEj=50;Object(Va.a)(Vg,"NavigationLatencyTracker",null,[]);class ah extends Vg{constructor(){super(...arguments);this.XLa=!1;this.Ira=
[];this.Ikd=this.hgd=this.Jkd=0}get skeletonDuration(){return this.Jkd}get missingBlocksDuration(){return this.hgd}get skeletonAndMissingBlocksDuration(){return this.Ikd}T$h(){let d=!1,z=void 0;for(let T=0;T<this.markers.length;T++){const ya=this.markers[T];switch(ya.name){case "missing-blocks-start":d?(this.Ira.push(new ii("skeleton-and-missing-blocks-start",ya.timestamp)),d=!1):this.Ira.push(ya);break;case "missing-blocks-end":"missing-blocks-start"===(null===z||void 0===z?void 0:z.name)&&this.Ira.push(ya);
break;case "only-missing-blocks-end":"only-missing-blocks-start"===(null===z||void 0===z?void 0:z.name)&&this.Ira.push(ya);break;case "skeleton-blocks":d||(d=!0,this.Ira.push(ya));break;default:ya.name!==(null===z||void 0===z?void 0:z.name)&&(d=!1,this.Ira.push(ya))}"start"!==ya.name&&"scroll-end"!==ya.name&&(z=ya)}return this.Ira}JSh(){let d=this.Ira[0];for(let z=1;z<this.Ira.length;++z){const T=this.Ira[z];if("start"!==T.name&&"scroll-end"!==T.name){switch(d.name){case "missing-blocks-start":case "only-missing-blocks-start":this.hgd+=
T.timestamp-d.timestamp;break;case "skeleton-and-missing-blocks-start":this.Ikd+=T.timestamp-d.timestamp;break;case "skeleton-blocks":this.Jkd+=T.timestamp-d.timestamp}d=T}}}kp(d,z,T){T=null!==T&&void 0!==T?T:performance.now();d=new ii(d,T,z);this.markers.splice(this.aOi(T),0,d);return d}aOi(d){for(let z=this.markers.length-1;0<=z;z--)if(this.markers[z].timestamp<=d)return z+1;return 0}}Object(Va.a)(ah,"ScrollLatencyTracker",Vg,[]);class ih extends Mf{constructor(d,z,T,ya,sb,cc){super(d,z,T,"scroll",
ya,new ah(!!cc),sb,cc);this.F_b=new Sh;this.dW={TUf:0,SUf:0,sne:0,gne:0,ine:0,nne:0};this.f5d=()=>{if(!this.XLa){this.mark("scroll-end");this.XLa=!0;var Fc=this.da.view,Wc=Fc.Rla.y-this.dW.TUf;0<Wc?this.dW.gne=Wc:0>Wc&&(this.dW.sne=Math.abs(Wc));Fc=Fc.Rla.x-this.dW.SUf;0<Fc?this.dW.nne=Fc:0>Fc&&(this.dW.ine=Math.abs(Fc))}};this.Iog=(Fc,Wc)=>{for(const id of Wc.VGj)Fc=id.ZQc?"only-missing-blocks-end":"missing-blocks-end",this.mark(id.ZQc?"only-missing-blocks-start":"missing-blocks-start",void 0,id.yCj),
this.mark(Fc,void 0,id.xCj)};this.Hog=(Fc,Wc)=>{this.F_b.R9k(Wc.d1f)};this.da.aEh(this.Hog);this.F_b.pDh(this.Iog);d=this.da.view;this.dW.TUf=d.Rla.y;this.dW.SUf=d.Rla.x}get XLa(){return this.Yt.XLa}set XLa(d){this.Yt.XLa=d}dispose(){this.Kgi();super.dispose()}VMa(d){this.XLa?this.d8("complete",void 0,d):this.mark("content")}u_a(d,z){const T=this.Yt.T$h();this.Yt.JSh();return Object.assign({},super.u_a(d,z),{missingBlocksDuration:this.Yt.missingBlocksDuration.toFixed(4),skeletonAndMissingBlocksDuration:this.Yt.skeletonAndMissingBlocksDuration.toFixed(4),
userExperienceMarks:T})}Kgi(){var d,z;this.da.Wnk(this.Hog);null===(d=this.F_b)||void 0===d?void 0:d.vnk(this.Iog);null===(z=this.F_b)||void 0===z?void 0:z.dispose();this.F_b=void 0}uAe(){const d=this.bYc.ScrollLatency;d.duration+=this.Yt.duration;d.skeletonDuration+=this.Yt.skeletonDuration;d.skeletonAndMissingBlocksDuration+=this.Yt.skeletonAndMissingBlocksDuration;d.missingBlocksDuration+=this.Yt.missingBlocksDuration;this.dW.sne>d.maxScrollDistance.maxScrollUpDistancePx&&(d.maxScrollDistance.maxScrollUpDistancePx=
this.dW.sne);this.dW.gne>d.maxScrollDistance.maxScrollDownDistancePx&&(d.maxScrollDistance.maxScrollDownDistancePx=this.dW.gne);this.dW.ine>d.maxScrollDistance.maxScrollLeftDistancePx&&(d.maxScrollDistance.maxScrollLeftDistancePx=this.dW.ine);this.dW.nne>d.maxScrollDistance.maxScrollRightDistancePx&&(d.maxScrollDistance.maxScrollRightDistancePx=this.dW.nne)}}Object(Va.a)(ih,"ScrollOperationLatencyTelemetry",Mf,[]);class mi{constructor(d){var {ZGa:z,HMa:T,Axa:ya}=d;this.ZGa=z;this.HMa=T;this.Axa=ya}toJSON(){return{logic:this.ZGa.toFixed(4),
endOfLogicToGoto:this.HMa.toFixed(4),"goto":this.Axa.toFixed(4)}}}Object(Va.a)(mi,"GotoDurationInformation",null,[]);class Xh extends Vg{get qOf(){if(Pb.EwaSettings.AY()||Pb.EwaSettings.hha()){if(!this.j0a("end"))return ia.ULS.sendTraceTag(507574408,0,10,"GotoLatencyTracker.gotoOperationDuration: operation hasn't ended yet!"),new mi({ZGa:0,HMa:0,Axa:0});if(this.j0a("web-method-error")){var d=this.measure({from:"start",H2:"web-method-error"}),z=this.measure({from:"web-method-error",H2:"end"});return new mi({ZGa:d,
HMa:0,Axa:z})}if(this.j0a("business-logic-success")&&this.j0a("goto-start")){d=this.measure({from:"start",H2:"business-logic-success"});z=this.measure({from:"business-logic-success",H2:"goto-start"});const T=this.measure({from:"goto-start",H2:"end"});return new mi({ZGa:d,HMa:z,Axa:T})}if(this.j0a("business-logic-success"))return d=this.measure({from:"start",H2:"business-logic-success"}),z=this.measure({from:"business-logic-success",H2:"end"}),new mi({ZGa:d,HMa:0,Axa:z});if(this.j0a("goto-start"))return d=
this.measure({from:"start",H2:"goto-start"}),z=this.measure({from:"goto-start",H2:"end"}),new mi({ZGa:0,HMa:d,Axa:z});d=this.measure({from:"start",H2:"end"});return new mi({ZGa:0,HMa:0,Axa:d})}}OQh(){return 0<=this.markers.findIndex(d=>Object(Eh.b)(d.name))}}Object(Va.a)(Xh,"GotoLatencyTracker",Vg,[]);let Ti=0;class ji extends Mf{constructor(d,z,T,ya,sb,cc,Fc){super(d,z,T,ya,sb,new Xh(!!Fc),cc,Fc);this.xwb=!1;this.xae=()=>{this.GGa(this.da.Nra)&&this.VMa()}}get Y2d(){return 20}dispose(){this.xwb&&
(this.da.ha.Q7(this.xae),this.xwb=!1);super.dispose()}mark(d,z,T){Object(Eh.b)(d)&&this.Yt.OQh()?this.d8("aborted","MultipleBusinessLogicMarks"):(this.P4a||"business-logic-success"!==d||(ia.ULS.shipAssertTag(507570067,0,!this.xwb,"SetFocusOnGotoOperationLatencyTelemetry.mark: selectionEndedBlockingRegistered is true"),this.da.ha.e4(this.xae),this.xwb=!0),super.mark(d,z,T))}O4a(d,z){this.P4a&&(super.O4a(d,z),"business-logic-success"===d.name&&(ia.ULS.shipAssertTag(507556764,0,!this.xwb,"SetFocusOnGotoOperationLatencyTelemetry.onMarkAdded: selectionEndedBlockingRegistered is true"),
this.da.ha.e4(this.xae),this.xwb=!0))}u_a(d,z){return Object.assign({},super.u_a(d,z),{gotoOperationDuration:this.Yt.qOf,marks:this.Yt.markers})}uAe(d){"complete"===d&&(Pb.EwaSettings.AY||Pb.EwaSettings.hha()||Pb.EwaSettings.W_d())&&Pb.EwaSettings.Stj()&&this.q4h()}q4h(){if(3E4<=Ti)ia.ULS.sendTraceTag(507360542,0,50,"GotoOperationLatencyTelemetry.createAndUpdateGotoReport: reached max");else{Ti++;var d=this.bYc.gotoScenarioLatency[this.scenario];d||(d=[],this.bYc.gotoScenarioLatency[this.scenario]=
d);d.push(Math.round(this.Yt.qOf.Axa))}}}Object(Va.a)(ji,"GotoOperationLatencyTelemetry",Mf,[]);class Ui extends Mf{constructor(d,z,T,ya,sb,cc,Fc,Wc){super(d,z,T,ya,sb,new Vg(!!Wc),cc,Wc);this.uA=Fc;this.H5c=1;this.bYb=this.vob=!1;this.G5i=()=>{const id=performance.now()-this.Yt.startTime;ia.ULS.sendTraceTag(507511395,0,15,`ZoomOperationLatencyTelemetry.handleTimeout: timeout occurred after ${id}ms!`);this.S1c=void 0;this.d8("aborted","timeout")};this.l5a=this.da.LW;if(this.Ruc=Pb.EwaSettings.$nb())this.S1c=
window.setTimeout(this.G5i,1E4),Pb.EwaSettings.Lsj()&&cc.FBd&&(this.bYb=this.uA.startTrackAnimation(cc.event,"viewport_zoom"))}get Y2d(){return 20}get dah(){return this.Mia>this.l5a?"zoom-in":"zoom-out"}get Ygj(){return 3<=this.H5c}get FYf(){return 1===this.H5c}dispose(){this.S1c&&(window.clearTimeout(this.S1c),this.S1c=void 0);this.bYb&&(ia.ULS.sendTraceTag(507384452,0,50,"ZoomOperationLatencyTelemetry.dispose: aborting animation tracking"),this.bYb=!1,this.uA.stopTrackAnimation("viewport_zoom"));
super.dispose()}mark(d,z,T){super.mark(d,z,T);this.P4a||"zoom-level-set"!==d||(this.Mia=null===z||void 0===z?void 0:z.LW,this.GGa(this.da.Nra)&&this.VMa(T))}O4a(d,z){if(this.P4a){super.O4a(d,z);if(this.Yt.z4c){var T=this.Yt.markers;(T=T[T.length-2])&&d&&this.Yt.measure({from:T,H2:d})}this.Ruc?"zoom-level-set"===d.name?(this.Mia=null===z||void 0===z?void 0:z.LW,ia.ULS.shipAssertTag(507543945,0,!!this.Mia,`ZoomOperationLatencyTelemetry.onMarkAdded: zoomLevel is ${this.Mia}!`)):"rezoom"===d.name?(this.vob=
!1,this.H5c++):"zoom-idle"===d.name&&(this.vob=!0,this.GGa(this.da.Nra)&&(this.Yt.j0a("zoom-blocks-updated")?this.d8("complete",void 0,d.timestamp):this.VMa(d.timestamp)),this.bYb&&(this.bYb=!1,this.uA.stopTrackAnimation("viewport_zoom"))):"zoom-level-set"===d.name&&(this.Mia=null===z||void 0===z?void 0:z.LW,this.GGa(this.da.Nra)&&this.VMa())}}GGa(d){return super.GGa(d)&&this.Mia?this.Mia===this.da.Rdl:!1}VMa(d){this.Ruc?(ia.ULS.shipAssertTag(507511424,0,!!this.Mia,`ZoomOperationLatencyTelemetry.markWhenAllTheBlocksInViewportAreUpdated: zoom level not set! requiredZoomLevel=${this.Mia}`),
this.mark("zoom-blocks-updated",void 0,d),this.vob&&this.d8("complete",void 0,d)):super.VMa()}u_a(d,z){d=Object.assign({},super.u_a(d,z),{zoomType:this.dah,caller:this.context.caller,delayed:this.context.FBd,isDiscrete:this.FYf,isAnimation:this.Ygj,zoomCount:this.H5c,startZoom:this.l5a,endZoom:this.Mia});this.Ruc&&((z=this.Yt.measure({from:"start",H2:"zoom-blocks-updated",E5d:"zoomDuration"}))&&(d.duration=z.toFixed(4)),z=this.FYf?z:this.Yt.measure({from:"rezoom",H2:"zoom-blocks-updated",E5d:"lastRezoomDuration"}),
d.lastRezoomDuration=z);return d}uAe(d){"complete"===d&&this.Mia&&(d=this.bYc.zoomScenarioLatency[this.dah])&&(d.count++,d.duration+=this.Yt.duration,d.skeletonDuration+=this.Yt.skeletonDuration,d.staleDuration+=this.Yt.staleDuration)}}Object(Va.a)(Ui,"ZoomOperationLatencyTelemetry",Mf,[]);class Yi{constructor(d,z,T){this.da=d;this.W2=z;this.aYc=T;this.Uja=new AbortController;this.ymc=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8704121_AddZoomNavContext");this.dia=ya=>{this.TUk(ya.detail.viewportScenarioContext)};
this.W2.vod(this.dia,this.Uja.signal)}dispose(){this.Uja.abort()}TUk(d){ia.ULS.shipAssertTag(507570112,0,void 0===this.oib||!this.oib.XHc,"ViewportOperationTelemetryManager.startNewScenario: expecting no running operation, but operation is still running");if(this.ymc)if(y(d))this.oib=new ih(this.da,this.da.$.ea.NC,void 0,this.aYc,d,this.W2);else if(Object(Eh.c)(d.name))this.oib=new ji(this.da,this.da.$.ea.NC,void 0,d.name,this.aYc,d,this.W2);else{ia.ULS.sendTraceTag(507549210,0,10,`ViewportOperationTelemetryManager.startNewScenario: unhandled scenario ${d.name}!`);
return}else y(d)?this.oib=new ih(this.da,this.da.$.ea.NC,void 0,this.aYc,void 0,this.W2):this.oib=new ji(this.da,this.da.$.ea.NC,void 0,d.name,this.aYc,void 0,this.W2);this.oib.IJj()}}Object(Va.a)(Yi,"ViewportOperationTelemetryManager",null,[]);class ni{constructor(){this.docId=this.host=this.applicationMode=this.browserVersion=this.browser=""}get reportName(){return"SessionInfo"}}Object(Va.a)(ni,"SessionInfoSessionEndsReport",null,[198]);class bi{constructor(){this.maxScrollLeftDistancePx=this.maxScrollRightDistancePx=
this.maxScrollDownDistancePx=this.maxScrollUpDistancePx=0}get reportName(){return"MaxScrollDistance"}}Object(Va.a)(bi,"MaxScrollDistanceSessionEndsReport",null,[]);class mj{constructor(){var d;this.missingBlocksDuration=this.skeletonAndMissingBlocksDuration=this.skeletonDuration=this.duration=0;this.isMissingBlocksSupported=null===(d=PerformanceObserver.supportedEntryTypes)||void 0===d?void 0:d.includes("long-animation-frame");this.isScrollEndEventSupportedByBrowser=yf.HelperMethods.isScrollEndEventSupportedByBrowser;
this.maxScrollDistance=new bi}get reportName(){return"scrollOperationLatency"}}Object(Va.a)(mj,"ScrollOperationLatencySessionEndsReport",null,[]);class Zi{constructor(){this.ScrollLatency=new mj;this.gotoScenarioLatency={};this.zoomScenarioLatency={}}get reportName(){return"NavigationOperationsLatency"}}Object(Va.a)(Zi,"NavigationOperationsLatencySessionEndsReport",null,[198]);let Ai=class{constructor(d,z,T){this.$=d;this.da=z;this.W2=T;this.Uja=new AbortController;this.BYf=yf.HelperMethods.LWb&&
Pb.EwaSettings.Ijj();this.Sqk=2E3;this.w_d=Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimation",!1);this.ymc=Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8704121_AddZoomNavContext");this.RVc=null;this.GXb=!1;this.dia=ya=>{ya=ya.detail.viewportScenarioContext;y(ya)&&this.I$d(null,ya)};this.I$d=(ya,sb)=>{this.LP?this.w0c("gotoOperationInProgress"):(!this.GXb&&this.w_d&&(this.GXb=Wh.b(this.$).startTrackAnimation(sb.event,"viewport_scroll")),this.J9h(sb))};this.QP=()=>
{this.w0c("scrollEnd");this.$.ea.nm&&!this.LP&&this.HZ&&(this.HZ.f5d(),this.HZ.GGa(this.da.Nra)&&this.HZ.d8("complete"))};this.Mpg=()=>{this.HZ.dispose();this.HZ=void 0};this.M$d=()=>{var ya;null===(ya=this.LP)||void 0===ya?void 0:ya.dispose();this.LP=void 0};this.Cj=()=>{this.$2e()};this.onViewportChange=()=>{this.RVc=Gc.AsyncMethodContext.wC(()=>{this.kke()},this.Sqk,vd.a.kke,this.RVc)};this.d7=(ya,sb)=>{-1===sb.jL&&sb.k1a&&this.h$k(sb.hashCode)};this.r9h();this.$2e();this.Raj();this.$.mr(this.Cj);
this.BYf&&this.da.pIb(this.onViewportChange);Pb.EwaSettings.W_d()&&(this.Qdl=new Yi(this.da,T,this.Irb));Pb.EwaSettings.lKc()?Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MeasureOldBrowsersImpactOnInteractivity",!1)?yf.HelperMethods.isScrollEndEventSupportedByBrowser&&(this.W2.vod(this.dia,this.Uja.signal),this.da.view.bnc(this.QP)):(this.W2.vod(this.dia,this.Uja.signal),this.da.view.bnc(this.QP)):(yf.HelperMethods.isScrollEndEventSupportedByBrowser&&this.da.view.z4e(this.I$d),this.da.view.bnc(this.QP));
this.da.npd(this.d7)}dispose(){this.$.Wr(this.Cj);Pb.EwaSettings.lKc()?this.Uja.abort():yf.HelperMethods.isScrollEndEventSupportedByBrowser&&this.da.view.BFg(this.I$d);this.da.view.MFg(this.QP);Pb.EwaSettings.W_d()&&this.Qdl.dispose();this.BYf&&this.da.t5b(this.onViewportChange);nb.a.gj([this.RVc,this.HZ,this.LP]);this.RVc=null;this.da.Yie(this.d7);this.LP=this.HZ=this.da=this.$=null;this.GXb=!1}get Ibc(){return this.dPa.viewport}get mSg(){return this.dPa.sheetProcessedData}get itd(){return this.dPa.IMh}get eSk(){return this.dPa.dSk}get Irb(){return this.dPa.FJj}get Qqj(){return!!this.HZ}prk(d){if(this.da.kj.isValid){if(this.Ibc.maxUsedRow<
d.bottom){this.Ibc.maxUsedRow=d.bottom;const z=this.da.xxa();this.Ibc.isRowMaxPixelExceeded=!!z&&this.da.Aza(z.nk,!0)}this.Ibc.maxUsedColumn<d.right&&(this.Ibc.maxUsedColumn=d.right)}}kHg(d){var z=this.mSg;z.total+=1;const T=Object(sd.e)(d);z.defaultCount+=T?1:0;z.defaultRate=z.defaultCount/z.total;T&&(z.defaultCountByReason[d.Eib]+=1);z=Object(sd.d)(d);z||(ia.ULS.sendTraceTag(507574417,0,10,`ViewportTelemetryManager.reportSheetProcessedDataAccess: spd miss, reason=${d.reason}`),ia.ULS.shipAssertTag(507574416,
0,!!d.reason,`ViewportTelemetryManager.reportSheetProcessedDataAccess: spd.reason is ${d.reason}!`));ia.ULS.shipAssertTag(507574415,0,null==this.$.ma||null!=this.$.ma.sheetProcessedData,`SheetProcessedDataProvider.getActiveSheetProcessedData: invalid SPD availability state! activeItem=${this.$.ma?"not null":"null"}, isHit=${z}`)}X6a(d){var {success:z,entriesCount:T,abortReason:ya,maxEntries:sb,sheetCount:cc}=d;d=this.mSg;null!=z&&(d.prefetchInfo.success=z);null!=T&&(d.prefetchInfo.entriesCount=T);
if(null!=ya){const Fc=d.prefetchInfo.abortReason;"workbookClosed"!==ya||"notScheduled"!==Fc&&"notStarted"!==Fc?"workbookClosed"!==ya&&(d.prefetchInfo.abortReason=ya):d.prefetchInfo.abortReason=`${Fc}-workbookClosed`}null!=sb&&(d.prefetchInfo.maxEntries=sb);null!=cc&&(d.prefetchInfo.sheetCount=cc);ia.ULS.sendTraceTag(507574414,0,50,`ViewportTelemetryManager.reportSheetProcessedDataPrefetch: success=${z}, entriesCount=${T}, abortReason=${ya}, maxEntries=${sb}`)}cke(d,z,T){var ya,sb;const cc=null!==
(sb=null===(ya=this.$.ma)||void 0===ya?void 0:ya.hash)&&void 0!==sb?sb:"";!this.kSg&&cc&&(this.kSg=cc);ya=this.itd;this.$.ea.nm?(this.Qqj&&(!this.vAf&&cc&&(this.vAf=cc),this.zze(ya.duringScroll,d,T)),this.zze(ya.postSessionBoot,d,T)):this.zze(ya.sessionBoot,d,T);ya.accessedBlocksDistinctCount+="WasNeverCached"===T?1:0;ya.numOfUsedPrefetchedBlocks+=z?1:0}brk(){this.itd.numOfPrefetchedBlocks+=1}Bxa(d,z){if(this.$.ea.nm)switch(d){case Eh.a.switchSheet:case Eh.a.insertSheet:case Eh.a.findNext:case Eh.a.gotoDialog:this.Rmd(d);
this.w0c("switchSheet|insertSheet|findNext");this.ymc&&ia.ULS.shipAssertTag(507549212,0,!z||Object(Eh.c)(z.name),`ViewportTelemetryManager.gotoNavigationStart: scenario=${d} got an invalid context = ${null===z||void 0===z?void 0:z.name}!`);this.LP=new ji(this.da,this.$.ea.NC,this.M$d,d,this.Irb,z);break;case "zoom":this.Rmd(d);this.ymc&&ia.ULS.shipAssertTag(507549211,0,"zoom"===z.name,`ViewportTelemetryManager.gotoNavigationStart: scenario=${d} got an invalid context = ${null===z||void 0===z?void 0:
z.name}!`);this.LP=new Ui(this.da,this.$.ea.NC,this.M$d,d,this.Irb,z,Wh.b(this.$));break;default:ia.ULS.shipAssertTag(507574413,0,!1,`ViewportTelemetryManager.navigationStart: Unexpected scenario name: ${d}`)}}Sra(d){var z;const T=!!this.HZ,ya="zoom"===(null===(z=this.LP)||void 0===z?void 0:z.scenario);z=this.LP&&"zoom"!==this.LP.scenario;(T||z)&&this.Rmd("zoom");ya?this.LP.mark("rezoom"):this.LP=new Ui(this.da,this.$.ea.NC,this.M$d,"zoom",this.Irb,d,Wh.b(this.$));return this.LP}UY(d,z){this.LP?Object(Eh.d)(this.LP.scenario,
d)&&this.LP.mark(d,z):ia.ULS.sendTraceTag(507574412,0,50,`ViewportTelemetryManager.navigationMark: Marking ${d} for an invalid / non-existing scenario`)}Dca(d){var z;if(Pb.EwaSettings.AY()||Pb.EwaSettings.hha())switch(d){case Eh.a.findNext:case Eh.a.gotoDialog:null===(z=this.LP)||void 0===z?void 0:z.d8("complete");break;default:ia.ULS.shipAssertTag(507574411,0,!1,`ViewportTelemetryManager.scenarioEnd: Unexpected scenario name: ${d}`)}}zze(d,z,T){var ya,sb,cc;d.total+=1;d.hitCount+=z?1:0;z||(z=null!==
(sb=null===(ya=this.$.ma)||void 0===ya?void 0:ya.hash)&&void 0!==sb?sb:"",d.sheetOnBootMissCount+=z===this.kSg?1:0,d.firstScrollSheetMissCount+=z===this.vAf?1:0,d.missCountByReason[T]=(null!==(cc=d.missCountByReason[T])&&void 0!==cc?cc:0)+1)}J9h(d){this.HZ?this.HZ.XLa&&(this.HZ.d8("aborted"),this.w0c("aborted"),this.HZ=new ih(this.da,this.$.ea.NC,this.Mpg,this.Irb,d)):this.HZ=new ih(this.da,this.$.ea.NC,this.Mpg,this.Irb,d)}w0c(d){this.w_d&&this.GXb&&(ia.ULS.sendTraceTag(507574410,0,50,`ViewportTelemetryManager.stopTrackAnimationIfRunning: reason: ${d}`),
Wh.b(this.$).stopTrackAnimation("viewport_scroll"));this.GXb=!1}r9h(){this.dPa={viewport:new zh,sheetProcessedData:new Xi,IMh:this.J4h(),dSk:new Ah,FJj:new Zi,Rul:Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8741920_SessionInfoReport")?this.S9h():void 0}}J4h(){const d=new Fh;d.blockCacheSize=this.da.za.Lpc;return d}S9h(){var d,z,T=this.$.ua;const ya=new ni,{browser:sb,version:cc,returnValue:Fc}=yf.HelperMethods.U_c(T.BrowserNameAndVersion);Fc&&(ya.browser=sb,ya.browserVersion=cc);ya.host=T.HostName;
ya.docId=T.DocumentHostInfo.ServerDocId;T=ph.b(wa.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());ya.applicationMode=null!==(z=T&&(null===(d=T.ApplicationModeExtended)||void 0===d?void 0:d.toString()))&&void 0!==z?z:"";return ya}$2e(){this.$.la.fi(276,d=>{for(const z in this.dPa)this.dPa[z]&&d.a4(this.dPa[z])})}Raj(){this.$aj()}$aj(){this.X6a({success:!1,entriesCount:0,abortReason:"notScheduled",maxEntries:1E3})}kke(){const d=this.da.iWh();0<d.size&&ia.ULS.sendTraceTag(507574409,
0,50,`ViewportTelemetryManager.reportMissingBlocks: found ${d.size} missing blocks ${JSON.stringify(Array.from(d))}`)}h$k(d){let z=!1;const T=this.eSk;T.skeletonBlocksCounter[d]?T.skeletonBlocksCounter[d]+=1:(T.skeletonBlocksCounter[d]=1,z=!0);T.count+=1;z&&(T.distinctCount+=1)}Rmd(d){var z,T;null===(z=this.LP)||void 0===z?void 0:z.d8("aborted",`abortedBy:${d}`);null===(T=this.HZ)||void 0===T?void 0:T.d8("aborted",`abortedBy:${d}`)}};Ai=Object(rb.__decorate)([Object(zc.d)(oc.Sg),Object(rb.__param)(0,
Object(oc.Nb)()),Object(rb.__param)(1,Object(oc.id)()),Object(rb.__param)(2,Object(oc.Rg)())],Ai);Object(Va.a)(Ai,"ViewportTelemetryManager",null,[586]);let ci=class extends sa.a{constructor(){super()}h5e(d){this.addHandler("ZCIEK",d)}cGg(d){this.removeHandler("ZCIEK",d)}gqd(d){this.addHandler("ZCUIK",d)}Hje(d){this.removeHandler("ZCUIK",d)}Kdk(){this.raiseEvent("ZCIEK")}Jdk(){this.raiseEvent("ZCUIK")}Ldk(){this.raiseEvent("ZCEK")}};ci=Object(rb.__decorate)([Object(zc.d)(oc.Yg)],ci);Object(Va.a)(ci,
"ZoomEventManager",sa.a,[585]);var $i=a(639),Vi=a(168),Xe=a(154),th=a(103),aj=a(350),nj=a(155),Wi=a(431);class ri{constructor(d,z){this.snb=this.qFc=0;this.Cqc=null;this.AZf=!1;this.$=d;this.zoomManager=z;this.AZf=d.rKc}Qlj(){return cd.f(this.$).isEditing?(ia.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.vh.ME?(ia.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),
!1):!0}TSj(d){this.Cqc=new Sys.UI.Point(Math.round(d.BJa.center.x),Math.round(d.BJa.center.y));this.qFc=this.zoomManager.zoom;this.snb=d.BJa.scale;const z={["InitialZoom"]:this.qFc,["Location"]:"canvas",["InputMethod"]:d.Dh};nj.b(this.$).Aj(Xe.a.p6j,z);ia.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.Cqc.x},${this.Cqc.y}), initial zoom ${this.qFc}, initial scale ${this.snb}`);this.grb(d,"onGestureStart");return!0}SSj(d){if(!this.snb)return ia.ULS.shipAssertTag(537149792,
0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.grb(d,"OnGestureEvent"),!0;if(!isFinite(this.snb))return ia.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.snb}`),this.grb(d,"OnGestureEvent"),!0;const z=d.BJa.scale/this.snb*this.qFc;this.zoomManager.aah(z,this.Cqc);ia.ULS.sendTraceTag(537149790,0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${z}. Current scale ${d.BJa.scale}`);
this.grb(d,"OnGestureEvent");return!0}RSj(d){this.zoomManager.bah();ia.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.grb(d,"OnGestureEnd")}QSj(d){ia.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.grb(d,"OnGestureCancel")}grb(d,z){var T,ya,sb;this.AZf&&(ia.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${z},        eventArgs non-null: ${isNullOrUndefined(d)}, gestureData non-null: ${isNullOrUndefined(null===
d||void 0===d?void 0:d.BJa)},        srcEvent non-null: ${isNullOrUndefined(null===(T=null===d||void 0===d?void 0:d.BJa)||void 0===T?void 0:T.srcEvent)}`),null===(sb=null===(ya=null===d||void 0===d?void 0:d.BJa)||void 0===ya?void 0:ya.srcEvent)||void 0===sb?void 0:sb.preventDefault())}}Object(Va.a)(ri,"PinchToZoomAdapter",null,[603]);var hf=a(979),bj=a(114);class Bi extends sa.a{constructor(d,z){super();this.statusBarManager=null;this.dCf=!1;this.zoomManager=z;this.$=d;this.$.la.fi(29,T=>{this.statusBarManager=
T;T.hO(this)})}oy(d){this.addHandler("Zoom",d)}cy(d){this.removeHandler("Zoom",d)}$v(){const d=be.a.Opb(this.$)?"QueryZoomComboBoxValue":"QueryZoomStatus";this.rr(d)&&this.raiseEvent("Zoom")}Ay(d,z){switch(d){case "QueryZoomStatus":return this.x4i(z);case "QueryZoomComboBoxValue":return this.w4i(z);default:return!1}}rr(d){switch(d){case "QueryZoomStatus":return be.a.X8(this.$);case "QueryZoomComboBoxValue":return be.a.Opb(this.$)&&be.a.X8(this.$);default:return!1}}dispose(){this.statusBarManager&&
(this.statusBarManager.tN(this),this.statusBarManager=null);this.$=null;super.dispose()}QNf(d){d=this.a0i(d);if(!d)return null;d=d.getElementsByClassName("cui-ctl-mediumlabel");return 1!==d.length?(ia.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):d[0]}w4i(d){if(!this.$)return!1;const z=bj.a().sAb;d[hf.a.Value]=z;return!0}x4i(d){if(!this.$)return!1;const z=this.zoomManager.sAb;let T=!1;if(be.a.Mo(this.$))$c.a.equals(appChrome.selectors.getControlLabel(lg.a.zoomStatusBarMenuOpen),
z,!1)||(T=!0);else{const ya=this.QNf("HandleQueryZoomStatusCommand");ya?$c.a.equals(d.LabelText.toString(),z,!1)||(ya.innerText="",T=!0):T=!0}T&&this.VEk(d,z);return!0}VEk(d,z){d.LabelText=z;be.a.Mo(this.$)&&(d.Visible=!0)}a0i(d){var z=De.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!z)return z=(z=this.$.ea.Ih)?z.inEmbedView:!1,xf.a.Zx||z||ia.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${d}`),
null;this.dCf||(this.dCf=!0,ia.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${d}`));return z}}Object(Va.a)(Bi,"ZoomStatusBarManager",sa.a,[4,155,156]);var pj=a(29),vg=a(243);let si=class extends $i.a{constructor(d,z){super(d,pj.yb);this.tAb=this.qMa=this.UYb=null;this.ZYb=-1;this.zZf=!1;this.Jj=()=>{this.ZYb=-1};this.EEj=Object(vg.a)(T=>{T.XHc&&T.mark("zoom-idle")},200);ia.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");
this.uAb=new Bi(d,this);this.q6j()&&(ia.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.nKh());this.tAb=z}dispose(){this.uAb&&(nb.a.dh(this.uAb),this.uAb=null);this.tAb&&(this.tAb=null);this.zZf&&this.Jei();super.dispose()}aah(d,z){d=this.BZa(d);if(cd.f(this.$).rtl){const T=Math.round(De.DOMElementExtensions.getBounds(this.$.Bl).width*this.zoom);this.UYb=new Sys.UI.Point(T-z.x,z.y)}else this.UYb=z;this.f8a(d,!1,"ZoomWithPinch")}kcc(){return!0}jcc(d,z,
T){var ya=xf.a.isMac?.07:.15;d=this.zoom+(d?ya:-ya);d=this.BZa(d);cd.f(this.$).rtl?(ya=Math.round(De.DOMElementExtensions.getBounds(this.$.Bl).width*this.zoom),this.qMa=new Sys.UI.Point(ya-z.x,z.y)):this.qMa=z;z=this.zoom;this.f8a(d,!0,"ZoomWithMouse",T);T={["InitialZoom"]:z,["FinalZoom"]:d,["Location"]:"canvas"};nj.b(this.$).Aj(Xe.a.igl,T)}bah(){this.UYb=null}K5c(d,z){this.f8a(this.BZa(d),!1,z?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}cah(d){isNaN(d)?ia.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):
this.f8a(this.BZa(d),!1,"ZoomToLevelInExcelLive")}L5c(d,z){this.f8a(this.BZa(d),!0,z?"ZoomWithShortcuts":"ZoomWithButtons")}vLf(d,z){const T=cd.f(this.$).rtl,[ya,sb]=this.GNd(T),[cc,Fc]=this.APd(d,sb);return this.qMa?(d=this.kNd(this.qMa,d,z,sb,ya,"ZoomWithMouse"),this.qMa=null,d):this.UYb?this.kNd(this.UYb,d,z,sb,ya,"ZoomWithPinch"):cd.f(this.$).ha.$e.isFloatingObjectSelected?this.hgl(d,z,sb,ya,cc,Fc,cd.f(this.$).rtl):this.jgl(d,z,sb,ya,cc,Fc,cd.f(this.$).rtl)}qMg(d,z,T){if(d){ia.ULS.sendTraceTag(537149782,
0,50,`Zoom To: (${d.x} ${d.y}) (new top-left) from zoom:${z} to zoom:${T}`);d=new Bc.a(d.x,d.y);T=cd.f(this.$).rtl;[,T]=this.GNd(T);const [ya,sb]=this.APd(z,T);cd.f(this.$).Q5e(d,ya,sb,{name:"ApplicationZoom"})}else ia.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${z} to zoom:${T}`)}zoomFitToScreen(){const d=this.zoom;var z=cd.f(this.$).rtl;const [T,ya]=this.GNd(z),[sb,cc]=this.APd(d,ya);var Fc=cd.f(this.$).ha.$e.isFloatingObjectSelected;(z=Fc?this.TGf(this.btb,sb,cc,!1):this.CLf(this.btb,
ya,T,sb,cc,z,!1))?(z=Math.min(sb/(z.width+100),cc/(z.height+100)),z=this.Hxi(z),this.f8a(z,!0,"ZoomWithFitToScreen"),Fc?cd.f(this.$).ha.$e.cXa(cd.f(this.$).ha.$e.Lh,!1):(Fc=qd.x(cd.f(this.$).ha.qa.activeRange,this.$),cd.f(this.$).ep(Fc,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.ZYb=d,this.zZf||this.kKh()):ia.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${Fc}`)}zoomFitToScreenUndo(){this.f8a(this.ZYb,!1,"ZoomWithFitToScreen")}tse(){return-1!==
this.ZYb}kKh(){const d=cd.f(this.$);d&&(d.ha.Zw(this.Jj),d.lO(this.Jj))}Jei(){const d=cd.f(this.$);d&&(d.ha.vx(this.Jj),d.$P(this.Jj))}Hxi(d){d=Math.min(d,Yd.a.QFj);d=Math.max(d,Yd.a.LGj);return Math.round(100*d)/100}f8a(d,z,T,ya){if(this.I5c()){var sb=cd.f(this.$).view.visibleArea.toString();d=this.BZa(d);var cc=Id.d(this.$.sa.ma);cc||(cc=$i.a.ffg);cd.f(this.$).Hk.lQ(5,aj.a.G5c,T);var Fc;if(Pb.EwaSettings.pYb()){const Wc=zc.a.nh(oc.Sg);Pb.EwaSettings.$nb()?Fc=null===Wc||void 0===Wc?void 0:Wc.Sra({name:"zoom",
caller:T,FBd:z,timestamp:null===ya||void 0===ya?void 0:ya.timeStamp,event:ya}):null===Wc||void 0===Wc?void 0:Wc.Bxa("zoom",{name:"zoom",caller:T,FBd:z,timestamp:null===ya||void 0===ya?void 0:ya.timeStamp})}cd.f(this.$).Hk.D1(aj.a.G5c,this.$.ea.Ek);ia.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${d} to sheet ${cc} origin ${T} prevZoom ${this.zoom}`);this.VHk(cc,d);this.tAb.Ldk();this.j2k(T,Fc);this.w2k(z);this.ZYb=-1;Wi.b(this.$,T);d=cd.f(this.$).view.visibleArea.toString();
ia.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${sb}, NewGridVisibleArea: ${d}, IsShyRibbonActive: ${this.$.E6}`);Fc&&this.EEj(Fc)}}dIi(d){return(d=yf.HelperMethods.tH(this.$.Bl,this.$.domElement,d))?d:new Sys.UI.Point(0,0)}GNd(d){const z=this.dIi(d);d=this.CNi(z,d);return[z,d]}APd(d,z){const T=De.DOMElementExtensions.getBounds(this.$.Bl);return[Math.round((T.width-z.x)*d),Math.round((T.height-z.y)*d)]}CNi(d,z){z=yf.HelperMethods.tH(cd.f(this.$).domElement,this.$.domElement,
z);return z?(d=new Sys.UI.Point(Math.round(z.x-d.x),Math.round(z.y-d.y)),d):new Sys.UI.Point(0,0)}jgl(d,z,T,ya,sb,cc,Fc){return(Fc=this.CLf(d,T,ya,sb,cc,Fc))?this.oKf(Fc,d,z,T,ya,sb,cc):null}CLf(d,z,T,ya,sb,cc,Fc){Fc=void 0===Fc?!0:Fc;var Wc=qd.K(cd.f(this.$).ha.qa.selectedRanges);if(Fc&&(Wc=Wc.Ik(qd.K(cd.f(this.$).RCc())),!Wc))return ia.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const id=cd.f(this.$).zh(Wc.topLeft);Wc=cd.f(this.$).zh(Wc.bottomRight);
if(!id||!Wc)return ia.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;d=id.cell.xH===Wc.cell.xH&&id.cell.IK===Wc.cell.IK?this.OGi(d,Wc,z,T,ya,cc):this.yZi(d,id,Wc,z,T,ya,cc);return d?Fc?this.EAf(d,ya,sb):d:(ia.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}EAf(d,z,T){if(0>d.x||d.x>z)d.x=0;if(0>d.y||d.y>T)d.y=0;d.x+d.width>z&&(d.width=z-d.x);
d.y+d.height>T&&(d.height=T-d.y);return d}yZi(d,z,T,ya,sb,cc,Fc){z=cd.f(this.$).getCellBounds(z.cell);if(!z)return null;const Wc=cd.f(this.$).getCellBounds(T.cell);if(!Wc)return null;let id=sb.x;Fc&&(id=0,z.x=Math.round(cc/d)-z.x-Math.round(z.width),Wc.x=Math.round(cc/d)-Wc.x-Math.round(Wc.width));d=new Sys.UI.Bounds(Math.round((z.x-ya.x)*d)-id,Math.round((z.y-ya.y)*d-sb.y),Math.round((Wc.x+Wc.width-z.x)*d),Math.round((Wc.y+Wc.height-z.y)*d));T=T.cell.getRange();ia.ULS.sendTraceTag(537149774,0,50,
`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${T.top}, b:${T.bottom}, r:${T.right}, l:${T.left}) in bounds (${d.x}, ${d.y}, ${d.width}, ${d.height})`);return d}OGi(d,z,T,ya,sb,cc){const Fc=cd.f(this.$).getCellBounds(z.cell);if(!Fc)return null;let Wc=ya.x;cc&&(Wc=0,Fc.x=Math.round(sb/d)-Fc.x-Math.round(Fc.width));d=new Sys.UI.Bounds(Math.round((Fc.x-T.x)*d)-Wc,Math.round((Fc.y-T.y)*d-ya.y),Math.round(Fc.width*d),Math.round(Fc.height*d));
z=z.cell.getRange();ia.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${z.top}, l:${z.left}) in bounds (${d.x}, ${d.y}, ${d.width}, ${d.height})`);return d}hgl(d,z,T,ya,sb,cc){const Fc=this.TGf(d,sb,cc);return Fc?this.oKf(Fc,d,z,T,ya,sb,cc):null}oKf(d,z,T,ya,sb,cc,Fc){d=new Sys.UI.Point(this.VKf(cc,d.x,d.width),this.VKf(Fc,d.y,d.height));return this.kNd(d,z,T,ya,sb)}VKf(d,z,T){return d===T?(ia.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),
d/2):d*z/(d-T)}TGf(d,z,T,ya){ya=void 0===ya?!0:ya;const sb=cd.f(this.$).ha.$e.Lh.domElement;var cc=yf.HelperMethods.tH(sb,cd.f(this.$).domElement,cd.f(this.$).rtl);if(!cc)return ia.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const Fc=cd.f(this.$).CKa();cc=new Sys.UI.Point(Math.round((cc.x-Fc.topLeft.x)*d),Math.round((cc.y-Fc.topLeft.y)*d));d=new Sys.UI.Bounds(cc.x,cc.y,Math.round(sb.offsetWidth*d),Math.round(sb.offsetHeight*d));
return ya?this.EAf(d,z,T):d}Efg(){this.uAb.$v()}ALj(d){"ZoomToLevelInExcelLive"===d?this.tAb.Kdk():this.tAb.Jdk()}kNd(d,z,T,ya,sb,cc){cc=void 0===cc?"":cc;var Fc=cd.f(this.$).rtl?0:sb.x;sb="ZoomWithPinch"===cc||"ZoomWithMouse"===cc?new Sys.UI.Point(d.x-Fc-Math.round(ya.x*z),d.y-sb.y-Math.round(ya.y*z)):d;sb=new Sys.UI.Point(Math.round(sb.x/z),Math.round(sb.y/z));ia.ULS.shipAssertTag(537149770,0,!!z,"Original zoom level must be different than 0");Fc=T/z;sb=new Sys.UI.Point(Math.round(sb.x*(1-1/Fc)),
Math.round(sb.y*(1-1/Fc)));"ZoomWithMouse"===cc||"ZoomWithPinch"===cc?(sb.x+=Math.round((ya.x-cd.f(this.$).vs)*(Fc-1)),sb.y+=Math.round((ya.y-cd.f(this.$).uC)*(Fc-1))):(Fc=Math.round(ya.x*(T-z)),0<Fc&&sb.x>Fc&&(sb.x+=Fc),z=Math.round(ya.y*(T-z)),0<z&&sb.y>z&&(sb.y+=z));"ZoomWithMouse"===cc&&(d.x||(sb.x=0),d.y||(sb.y=0));d=cd.f(this.$).CKa();return new Sys.UI.Point(sb.x+d.topLeft.x,sb.y+d.topLeft.y)}nKh(){const d=[];dg.a.instance.fj("Common.IGestureInputManager").execute(z=>{0===z.WMi()&&z.Phk(document.body,
new ri(this.$,this),d)})}q6j(){return this.I5c()&&(xf.a.Xv&&xf.a.uLa(67)||this.$.rKc)}VHk(d,z){Wi.a(this.$)?this.lqe(d,z,this.QCe,Yd.a.Lwg):this.lqe(d,z,this.zoomPerSheetId,this.btb)}lqe(d,z,T,ya){T.remove(d);z!==ya&&T.add(d,z)}j2k(d,z){const T=Pb.EwaSettings.pYb()?zc.a.nh(oc.Sg):void 0;Pb.EwaSettings.$nb()?null===z||void 0===z?void 0:z.mark("zoom-immediate-start"):null===T||void 0===T?void 0:T.UY("zoom-immediate-start");this.PQg();this.$.aqa(Se.a.ixa("TriggerImmediateZoomOperations"));this.oal();
this.ALj(d);Pb.EwaSettings.$nb()?null===z||void 0===z?void 0:z.mark("zoom-immediate-end"):null===T||void 0===T?void 0:T.UY("zoom-immediate-end")}oal(){this.kZd()?this.$.Dm():this.uAb.$v();const d=this.uAb.QNf("UpdateZoomStatusBar");d&&(d.innerText=this.sAb)}kZd(){const d=Vi.a(this.$);return d?d.us.OA===(be.a.PLa(this.$)?Ed.a.h6a:this.$.xi+Ed.a.gme):!1}w2k(d){cd.f(this.$).egl(d);this.$Fh()}$Fh(){const d=th.a(this.$);if(d)for(const z of cd.f(this.$).za.qA()){if(!z){ia.ULS.sendTraceTag(537149768,0,15,
"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!z.kq)continue;const T=z.$o;if(T)for(let ya=0;ya<T.count;ya++)if(2===T.sn(ya).type){const sb=d.Tx(T.sn(ya).rn());sb?(sb.Ara(!1),ia.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):ia.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else ia.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}};
si=Object(rb.__decorate)([Object(zc.d)(oc.Zg),Object(rb.__param)(0,Object(oc.Nb)()),Object(rb.__param)(1,Object(oc.Yg)())],si);Object(Va.a)(si,"ZoomManager",$i.a,[]);var cj=a(955),Ag=a(926),uh=a(1090);let Mi=class extends sa.a{constructor(d){super();this.caa=this.Rkb=this.statusBarManager=null;this.YEc=this.yXb=!1;this.Csg=()=>{var z=screen.height;z-=this.ExcelFullScreenCalloutSettings.ScreenSizeDelta*z;window.innerHeight>=z&&!this.yXb?(this.yXb=!0,this.$v()):this.yXb&&window.innerHeight<z&&(this.yXb=
!1,this.$v())};this.T9d=()=>{this.$v();uh.a.zya||(ia.ULS.sendTraceTag(507566092,0,50,"FullScreenStatuBarManager.OnFullScreenChangeEventHandler:  exit fullscreen mode"),this.YEc=!1)};this.$=d;this.$.Ma.Wta(this);this.$.la.fi(29,z=>{this.statusBarManager=z;z.hO(this)});this.ExcelFullScreenCalloutSettings=JSON.parse(wa.AFrameworkApplication.fa.Ya("ExcelFullScreenCalloutSettings"));this.CGj=6E4*this.ExcelFullScreenCalloutSettings.AppUsageTimeInMinutes;this.caa=document.getElementById("MainApp");this.Rkb=
this.T9d;$addHandler(this.caa,uh.a.fJd,this.Rkb);$addHandler(window,Z.a.resize,this.Csg);Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1)&&this.wPk()}oy(d){this.addHandler("FullScreenChangedEventKey",d)}cy(d){this.removeHandler("FullScreenChangedEventKey",d)}$v(){this.rr("QueryFullScreen")&&(Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1)&&this.kZd()&&this.$.Dm(),this.raiseEvent("FullScreenChangedEventKey"))}Ay(d,z){switch(d){case "QueryFullScreen":return z[cj.a.On]=
uh.a.zya,z[Ag.a.customTooltip]=uh.a.zya?ab.a.instance.ia(2409):ab.a.instance.ia(2408),Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8740765_TogglingOfFullScreenIcons")&&(z[Ag.a.IconSet]=uh.a.zya?{"default":"FullScreenMinimize_16"}:{"default":"FullScreenMaximize_16"}),!0;default:return!1}}rr(){return be.a.WWd()?!0:!1}dispose(){this.statusBarManager&&(this.statusBarManager.tN(this),this.statusBarManager=null);$removeHandler(this.caa,uh.a.fJd,this.Rkb);$removeHandler(window,Z.a.resize,this.Csg);this.caa=
this.$=null;super.dispose()}Gi(d,z){switch(z.command){case -1912752143:return!0;default:return!1}}Ri(d,z){switch(z){case -1912752143:return this.yXb&&!this.YEc?!0:!1;default:return!1}}dj(){return!1}executeCommand(d,z){switch(z.command){case -1912752143:return this.X_k(),this.$v(),je.Task.Ua(!0);default:return Si.a(z.command)}}X_k(){uh.a.zya?(uh.a.exitFullscreen(),this.YEc=!1):(ia.ULS.sendTraceTag(507533057,0,15,`FullScreenStatuBarManager.OnFullScreenChangeEventHandler:  enter fullscreen mode, winow height: ${window.innerHeight}, ribbon mode: ${appChrome.selectors.getRibbonMode()}`),
uh.a.requestFullscreen(this.caa),this.YEc=!0)}wPk(){setTimeout(()=>{(window.innerHeight<=this.ExcelFullScreenCalloutSettings.MaxWindowInnerHeight||screen.height/window.innerHeight<this.ExcelFullScreenCalloutSettings.MaxRatioOfScreenToWindowHeight)&&this.xPk()},this.CGj)}kZd(){const d=Vi.a(this.$);return d?d.us.OA===(be.a.PLa(this.$)?Ed.a.h6a:this.$.xi+Ed.a.gme):!1}xPk(){const d=new Sd.a(-847286761,$d.a.rh,this.$.hi,0,null);this.$.Ma.qh(d,{["InputMethod"]:$d.a.rh,CalloutName:22})}};Mi=Object(rb.__decorate)([Object(zc.d)(oc.Vc),
Object(rb.__param)(0,Object(oc.Nb)())],Mi);Object(Va.a)(Mi,"FullScreenStatusBarManager",sa.a,[4,156,34]);const Ci=()=>dg.a.instance.resolve("Common.App.InProductMessaging.InProductMessagingUIManager");var Ni=a(285),Lh=a(138),oi=a(462);class di extends oi.a{constructor(d){super(d)}get lMb(){return!1}createElement(){const d=document.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href",this.$D);return d}zzd(){return null}tUc(){this.element.setAttribute("href",
"");this.element.setAttribute("href",this.rJ.$D)}}Object(Va.a)(di,"CssResource",oi.a,[]);var Mh=a(530),Bh=a(294);class pi{constructor(){this.Dic=this.wfc=null}Pxj(){this.wfc||(ia.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.wfc=je.Task.WAA(pi.Wxj(),pi.Kxj()),this.wfc.continueWith(d=>{ia.ULS.sendTraceTag(21030599,324,10,"{0}",Lb.a.yLd(d.exception))},5));return this.wfc}Sxj(){if(!this.Dic)try{ia.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),
this.Dic=je.Task.WAA(pi.hEd(Bh.a.create(wa.AFrameworkApplication.fa.Ya("DimeUrl"),null,null))),this.Dic.continueWith(d=>{ia.ULS.sendTraceTag(39978391,324,10,"{0}",Lb.a.yLd(d.exception))},5)}catch(d){ia.ULS.sendTraceTag(594874951,324,10,"{0}",Lb.a.yLd(d))}return this.Dic}static Wxj(){var d=pi.LCc("inproductmessaging.js");d=Bh.a.create(d,null,null);return pi.hEd(d)}static Kxj(){var d=pi.LCc("inproductmessaging.css");d=new di(d);return pi.hEd(d)}static LCc(d){return Lh.a.JLb(String.format("ipm/{0}",
d))}static hEd(d){Mh.a.hwa(d);return d.Gqb}}Object(Va.a)(pi,"DependencyDownloader",null,[633]);class N{}N.q3j="inProductMessagingOverlayDiv";N.O6j="PlayButtonImage";N.dqk="ReplayButtonImage";Object(Va.a)(N,"Constants",null,[]);class pa{constructor(){this.uYe=this.FSe=this.vHe=!0;this.eqk=this.P6j=null;this.TIj=!1;this.locale=null;this.J3g={}}get q$e(){return this.vHe}set q$e(d){this.vHe=d}get hdg(){return this.FSe}set hdg(d){this.FSe=d}get hVg(){return this.uYe}set hVg(d){(this.uYe=d)&&this.SFk()}SFk(){this.z3e(N.O6j,
this.P6j);this.z3e(N.dqk,this.eqk)}z3e(d,z){z&&(this.J3g[d]=z)}}Object(Va.a)(pa,"FirstRunExperienceUISettings",null,[632]);class Xa{constructor(){this.completed=this.Ijk=!1}}Object(Va.a)(Xa,"FirstRunExperienceViewData",null,[631]);var Sb=a(214),fc=a(136);class Kc{constructor(d,z,T){this.yxi=(ya,sb,cc,Fc,Wc)=>{2===cc&&this.igc.awj(Wc);return 32};this.nfi=(ya,sb,cc,Fc,Wc)=>{2===cc&&this.igc.Vvj(Wc);return 32};this.d$i=(ya,sb,cc)=>2===cc?this.igc.m6d():32;this.c$i=(ya,sb,cc)=>2===cc?this.igc.j6d():32;
this.$f=d;this.Mm=z;this.igc=T}ho(){this.$f.dl(bc.a.Axi,fc.a.frame,this.yxi,64);this.$f.Uh(bc.a.tAf,fc.a.frame,this.d$i);this.$f.Uh(bc.a.sAf,fc.a.frame,this.c$i);this.$f.Uh(bc.a.mfi,fc.a.frame,this.nfi);this.$f.Uh(bc.a.UGg,fc.a.frame,Sb.ActionManager.ym);this.$f.Uh(bc.a.Fqk,fc.a.frame,Sb.ActionManager.ym);this.$f.Uh(bc.a.Gqk,fc.a.frame,Sb.ActionManager.ym);this.Mm&&this.Mm.XB()}}Object(Va.a)(Kc,"InProductMessagingActor",null,[]);class ud{constructor(){this.kDg=this.EIg=this.y_g=this.xLc=this.instance=
null}}Object(Va.a)(ud,"DimeExperienceUISettings",null,[]);var Jd=a(535);class ie{constructor(d,z,T,ya,sb){this.kzc=!1;this.WNb=null;this.$f=d;this.UUa=z;this.ejc=T;this.OW=ya;this.U7c=sb}ycj(d){Od.b("getHeaderApi")?(d.Nsj()&&appChrome.getHeaderApi().then(z=>{z.updateAnonymousStatus(!0);return null}),d.isFeatureEnabled("MsoPremiumBadge",!0).then(z=>{const T=d.isFreemiumUpsellEnabled();T&&(appChrome.getHeaderApi().then(ya=>{ya.updatePremiumStatus(z,T);return null}),d.v6a("MsoPremiumBadge",ya=>{appChrome.getHeaderApi().then(sb=>
{sb.updatePremiumStatus(ya.isEnabled,T);return null})}));return null})):ia.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}awj(d){this.ejc.Pxj().continueWith(()=>{this.UUa.ERk(d)})}Vvj(d){let z="gopremium",T=null,ya=()=>{};d?(d.experience&&""!==Object(Db.a)(String,d.experience)&&(z=Object(Db.a)(String,d.experience)),d.onTaskComplete&&(ya=d.onTaskComplete),d.campaignId&&""!==Object(Db.a)(String,d.campaignId)&&(T=Object(Db.a)(String,d.campaignId))):ia.ULS.sendTraceTag(51675402,324,50,
"Experience not given, using default experience");this.C6f(z,ya,T)}C6f(d,z,T){T=void 0===T?null:T;if(this.kzc&&this.WNb){const ya={};ya.experience=d||"gopremium";ya.campaignId=T||Jd.b(this.OW,this.U7c,Object(Db.a)(String,ya.experience),!0);this.$f.gl(bc.a.UGg,2);ia.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+ya.experience);try{const sb=Object.assign(new ud,{instance:this.WNb,xLc:ya,y_g:z||(()=>{}),EIg:cc=>{ia.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+cc.status)},
kDg:()=>{ia.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.kzc=!1;this.WNb=null}});this.UUa.uPk(sb)}catch(sb){ia.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+sb.message),this.kzc=!1,this.WNb=null,this.$f.ek(bc.a.lzc,2,{["experience"]:ya.experience})}}else ia.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.$f.ek(bc.a.lzc,2,{["experience"]:d})}t2d(){this.ejc.Sxj().continueWith(()=>{try{var d=Lb.a.ys(wa.AFrameworkApplication.uiCulture);const ya=
Jd.c(this.OW);if(ya){var z={};z.partnerId=ya;z.language=d;z.sessionId=wa.AFrameworkApplication.userSessionId;z.authHint=wa.AFrameworkApplication.fa.Ya("UserPrincipalName");var T=wa.AFrameworkApplication.fa.Ya("Puid")||"";""!==T&&(d={},d.puid=T,z.userInfo=d);this.WNb=new Dime(z);this.kzc=!0;ia.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else ia.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(ya){ia.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+ya.message)}},
3)}m6d(){return this.UUa.m6d()}j6d(){return this.UUa.j6d()}}Object(Va.a)(ie,"InProductMessagingUIManager",null,[630]);class we{constructor(){this.c_e=0;this.ocb=Array(5);this.ocb[0]=10;this.ocb[1]=15;this.ocb[2]=50;this.ocb[3]=100;this.ocb[4]=200}Init(d){this.c_e=d}SendTrace(d,z){ia.ULS.sendTraceTag(34182235,this.c_e,this.ocb[d],"{0}",z)}}Object(Va.a)(we,"DefaultNetworkingManager",null,[649]);var Qe=a(326);class ef{constructor(d){this.Wi=d}ERk(d){d&&(InProductMessaging.Networking.NetworkingMgr=new we,
InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(d.hVg,d.hdg,d.q$e,d.TIj,d.locale,Object(Aa.a)(this,this.TQj,"onDismissFirstRunExperience"),d.J3g),this.d8a(N.q3j,!0))}uPk(d){if(d&&d.instance&&d.xLc){let z=document.getElementById("wacDimeContainer");z||(z=document.createElement("div"),z.id="wacDimeContainer",document.body.appendChild(z));wa.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.d8a("wacDimeContainer",!1);d.xLc.parentElementId="wacDimeContainer";
d.instance.launch(d.xLc,d.y_g).then(T=>{this.O4b();document.body.removeChild(z);d.EIg(T)}).catch(T=>{this.O4b();document.body.removeChild(z);d.kDg(T)})}else throw Error.argument("DimeExperienceUISettings");}d8a(d,z){if(this.Wi&&d&&(d=document.getElementById(d),this.mcj(d),d=this.Wi.R0("InProductMessagingFocusId"))){const T=this.Wi.currentScope;T&&"InProductMessagingFocusId"===T.name||this.Wi.E7("InProductMessagingFocusId",!1);z&&this.pBg(d.scope)}}mcj(d){var z=!1;z=void 0===z?!0:z;const T=this.Wi.cr("InProductMessagingFocusId");
T.parent=Ei.AFrame.k4;const ya=new Qe.DOMFocusListing(()=>d);ya.H4b=z;ya.Ix(3);ya.Ix(2);ya.Ix(4);z=this.Wi.AWa(()=>d,T,ya);z.wUc();z.Kha=!0;z.Ihb=!0}pBg(d){d.WB($h.FocusManager.instance().mea);d.WB($h.FocusManager.instance().nea);d.bindAction($h.FocusManager.instance().mea,bc.a.tAf);d.bindAction($h.FocusManager.instance().nea,bc.a.sAf)}O4b(){this.Wi&&(this.Wi.tia("InProductMessagingFocusId"),this.Wi.M6a("InProductMessagingFocusId"))}TQj(d,z){this.O4b();d=Object.assign(new Xa,{completed:d,Ijk:z});
wa.AFrameworkApplication.yh.ek(bc.a.xxi,2,d)}m6d(){const d=document.activeElement,z=this.Wi.N0();return d&&z&&z.zo&&d===z.zo.cG?(z.zo.BG(d),z.M_b()?32:8):4}j6d(){const d=document.activeElement,z=this.Wi.N0();return d&&z&&z.zo&&d===z.zo.IM?(z.zo.BG(d),z.yrb()?32:8):4}}Object(Va.a)(ef,"InProductMessagingUIWrapper",null,[629]);class wf{constructor(){this.Wh=null}get name(){return"Common.App.InProductMessaging"}$n(d){d.register(pi,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").yi().Ei(()=>
new pi);d.register(ef,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").yi().Ei(()=>new ef($h.FocusManager.instance()));d.register(ie,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").yi().Ei(()=>new ie(wa.AFrameworkApplication.yh,dg.a.instance.resolve("Common.IInProductMessagingUIWrapper"),dg.a.instance.resolve("Common.App.InProductMessaging.IDependencyDownloader"),wa.AFrameworkApplication.ra.$g.kn,
wa.AFrameworkApplication.ra.$g.oNa));d.register(Kc,"Common.App.InProductMessaging.InProductMessagingActor").yi().Ei(()=>new Kc(wa.AFrameworkApplication.yh,wa.AFrameworkApplication.ra,dg.a.instance.resolve("Common.IInProductMessagingUIManager")));d.register(pa,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").yi().Ei(()=>new pa);d.register(Xa,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").yi().Ei(()=>
new Xa);this.Wh=d}init(){dg.a.instance.resolve("Common.App.InProductMessaging.InProductMessagingActor").ho();wa.AFrameworkApplication.fa.Yx(()=>{wa.AFrameworkApplication.ra.$g.Ew&&jh.a.get_instance().Fm(15,()=>{Object(Ni.a)().execute(d=>{Ci().ycj(d)})});wa.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&Jd.a()&&!xf.a.woa&&1!==wa.AFrameworkApplication.ra.$g.kn&&Object(Ni.a)().execute(d=>{d.isFeatureEnabled("MsoPremiumBadge",!0).then(z=>{!z&&d.isFreemiumUpsellEnabled()&&Ci().t2d();
return null})})})}dispose(){}static main(){Lc.a.instance.Do(new wf)}}Object(Va.a)(wf,"InProductMessagingPackage",null,[11,12]);var Tf=a(650);class gg{constructor(d,z,T,ya,sb){this.D_a=cc=>{let Fc=!1,Wc=null;try{if(0<cc.data.responseData.length){const id=Object(Db.a)(Object,ph.a(cc.data.responseData)),Dd=id?id[this.yF.brd]:null;Dd&&(Wc=Object(Db.a)(Object,ph.a(Dd.toString())))}Fc=!0}catch(id){this.qxa(null)}Fc&&this.ZCb&&this.ZCb(cc.data,Wc)};this.qxa=cc=>{this.VCb&&this.VCb(cc?cc.data:null)};this.A8j=
cc=>{this.hVe&&this.hVe(cc?cc.data:null)};this.zAa=cc=>{this.nFb&&this.nFb(cc?cc.data:null)};this.yF=d;this.ZCb=z;this.VCb=T;this.hVe=void 0===ya?null:ya;this.nFb=void 0===sb?null:sb}$Fd(d){const z=new Sys.StringBuilder(this.yF.n6b);z.append("RoamingServiceHandler.ashx?action=");z.append("getFirstRunExperienceSettings");z.append("&");z.append(this.VNd(d));z.append("&");z.append(wa.AFrameworkApplication.Jo);wa.AFrameworkApplication.rj.ov(z.toString(),1,null,null,!0,2,this.D_a,this.qxa,null)}Cxc(d){var z=
new Sys.StringBuilder(this.yF.n6b);z.append("RoamingServiceHandler.ashx?action=");z.append("saveFirstRunExperienceSettings");z.append("&");z.append(wa.AFrameworkApplication.Jo);z=z.toString();d=ph.c(d);wa.AFrameworkApplication.rj.ov(z,2,d,null,!0,4,this.A8j,this.zAa,null)}VNd(d){const z=new Sys.StringBuilder("requestedsettings=");for(let T=0;T<d.count;T++)z.append(d.na(T)),T<d.count-1&&z.append(";");return z.toString()}}Object(Va.a)(gg,"FirstRunExperienceRequestHandler",null,[]);var wg=a(250);class Lg{constructor(){this.NCb=
this.xfc=this.yF=null;this.D_a=(d,z)=>{d=d?+d.G$-+d.tP:-1;d>this.yF.LJg?ia.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",d,this.yF.LJg):z?this.ZNk(z)?(ia.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.yF.$cg),this.bte()):(this.xCd(!1),
ia.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(ia.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.bte())};this.qxa=d=>{this.xCd(!1);ia.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",d?d.httpStatus:-1)};this.zAa=d=>{ia.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
d?d.httpStatus:-1)};this.bSj=d=>{if(d){var z=d.detail;d=d.type;var T=this.yF&&this.yF.campaignId?this.yF.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===d||T&&z&&z.id&&-1!==z.id.indexOf(T)){if("FRELaunchedEvent"===d||z&&z.success)ia.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.hLg(this.yF.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.NCb,!0),window.removeEventListener("FRELaunchedEvent",
this.NCb,!0))}}}}ate(d){d?(this.yF=d,this.Lnj()&&(ia.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),d=new Nb.a,d.add(this.yF.brd),this.xfc=new gg(this.yF,this.D_a,this.qxa,null,this.zAa),this.xfc.$Fd(d)),(this.yF.zpb||wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.bte()):ia.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}Lnj(){try{if(this.yF.zpb)return!0;
if(!wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||wa.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;if(this.yF.wjj||this.yF.Cpb||wa.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const d=wa.AFrameworkApplication.fa.Ya("FlightId");return-1!==(d?d.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(d){ia.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",d?d.toString():null)}return!1}hLg(d){const z=
{},T={};T.FREDisplayedDate=(new Date).toUTCString();T.VersionDisplayed=d;T.RemindMeLater=!1;z[this.yF.brd]=ph.c(T);ia.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.xfc&&this.xfc.Cxc(z)}bte(){this.xCd(!0);var d=Object(Tf.b)();d?this.RUg(d):(ia.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((d=Object(Tf.a)())?d.execute(z=>{this.RUg(z)}):ia.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}RUg(d){if(d){var z=this.yF.Lxi;z&&ra.a.vV(z);ia.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",z);d.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.NCb=this.bSj,window.addEventListener("FGWebSurfaceEvent",this.NCb,!0),window.addEventListener("FRELaunchedEvent",this.NCb,!0)):(ia.ULS.sendTraceTag(51675545,
306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.hLg(this.yF.currentVersion))}else ia.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}ZNk(d){if("RemindMeLater"in d&&"FREDisplayedDate"in d){if("true"===d.RemindMeLater.toString()&&(+new Date-+new Date(d.FREDisplayedDate.toString()))/36E5>this.yF.$cg)return!0}else if(wa.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in d&&d.VersionDisplayed<this.yF.currentVersion)return ia.ULS.sendTraceTag(528262853,
306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}xCd(d){wa.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&wg.a.dispatch("FREDecisionEvent",{["show"]:d})}}Object(Va.a)(Lg,"FirstRunExperienceLauncher",null,[605]);class G{constructor(){this.Wh=null}get name(){return"Common.App.FirstRunExperienceLauncher"}$n(d){this.Wh=d;this.Wh.register(605,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").yi().Ei(()=>
new Lg)}init(){}dispose(){}static main(){Lc.a.instance.Do(new G)}}Object(Va.a)(G,"FirstRunExperienceLauncherPackage",null,[11,12]);var ta=a(9);class jb extends bg.a{constructor(d){super();this.$=d;this.gm()}create(){const d=Object(rg.a)(this.$.la,311,()=>new Hg(this.$));this.Bk(d)}static Ba(d){d.la.Hh(312,new jb(d))}}Object(Va.a)(jb,"FirstRunExperienceManagerFactory",bg.a,[]);var sc=a(621),Vc=a(675);class nd extends sc.a{constructor(d){super(1);this.Asa=!1;this.Xhg=()=>{this.refresh()};this.Yhg=()=>
{this.refresh()};this.da=cd.f(d);this.da.Fh.Iv(this.Yhg);this.da.Fh.Jx(this.Xhg);this.refresh()}get xS(){return this.qNc(this.Asa)}sqe(d){this.Asa!==d&&(this.Asa=d,this.U3b())}get name(){return Vc.a.cellEdit}dispose(){this.da.Fh.Cv(this.Yhg);this.da.Fh.Lw(this.Xhg);this.da=null;super.dispose()}U3b(){this.Kfe(this.Asa)}refresh(){this.sqe(!this.da.isEditing)}}Object(Va.a)(nd,"CellEditSafeStatePublisher",sc.a,[]);class xd{constructor(d,z){this.handler=null;this.ife=d;this.xS=z}}Object(Va.a)(xd,"SafeStatePublisherState",
null,[]);var Hd=a(726);const ke=d=>d?`${d.Current} / ${d.Pending} @${d.SuspensionStartTimestamp}`:null,V=d=>(null===d||void 0===d?void 0:d.SuspensionStartTimestamp)&&d.Pending>d.Current;class Wa extends sa.a{constructor(d,z){super();this.h6f=null;this.WKc=!1;this.v1b=(T,ya)=>{3===ya.Mcg&&this.WKc&&ia.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.WKc=!0;this.Y3b()};this.y7a=new Nb.a;this.srb=d;this.tAa=z;if(this.$Vb=
Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1))this.tAa.Jeb(this.ENa.bind(this)),this.srb.w4e(this.v1b)}get a6k(){return this.y7a.toArray().filter(d=>0!=d.xS).map(d=>d.ife.name)}anc(d){this.addHandler(Wa.x7a,d)}nVc(d){this.removeHandler(Wa.x7a,d)}TOa(d,z){const T=new xd(d,z);this.y7a.add(T);z=(ya,sb)=>{T.xS=sb.xS;this.Y3b()};d.anc(z);T.handler=z;this.Y3b()}lze(d){let z=null;for(const T of this.y7a)if(T.ife===d){this.R4g(T);z=T;break}z&&(this.y7a.remove(z),
this.Y3b())}dispose(){for(const d of this.y7a)this.R4g(d);this.y7a.clear();this.$Vb&&(this.tAa.nvb(this.ENa.bind(this)),this.srb.yFg(this.v1b));super.dispose()}Lzc(){const d=Cj.Lzc(this.y7a.toArray().map(z=>z.xS));return this.WKc&&1===d?2:d}R4g(d){d.ife.nVc(d.handler)}Y3b(){const d=this.Lzc();d!==this.h6f&&(this.raiseEvent(Wa.x7a,new Hd.a(d)),this.h6f=d)}ENa(d,z){d=z.lpa;(z=!V(d))||(z=this.pvj,z=(null===d||void 0===d?void 0:d.SuspensionStartTimestamp)!==(null===z||void 0===z?void 0:z.SuspensionStartTimestamp));
z&&(this.WKc=!1);this.pvj=d;this.Y3b()}}Wa.x7a="SSC";Object(Va.a)(Wa,"ClientStateMonitor",sa.a,[]);class Eb extends sc.a{constructor(d,z){z=void 0===z?null:z;super(1);this.Asa=!1;this.e7=()=>{this.refresh()};this.ejg=()=>{this.refresh()};this.$=d;this.HNe=z||bd.a(d).I5(hb.a.idle);bd.a(d).apd(this.ejg);this.gnb.oy(this.e7);this.refresh()}get xS(){return this.qNc(this.Asa)}sqe(d){d!==this.Asa&&(this.Asa=d,this.U3b())}get name(){return Vc.a.gnb}get gnb(){return this.HNe}dispose(){bd.a(this.$).UUc(this.ejg);
this.gnb.cy(this.e7);this.HNe=null;super.dispose()}U3b(){this.Kfe(this.Asa)}refresh(){this.sqe(1===this.gnb.wE||bd.a(this.$).Zp===this.gnb)}}Object(Va.a)(Eb,"IdleActivitySafeStatePublisher",sc.a,[]);class Jc extends kc.a{constructor(){super()}Ri(){return!1}executeCommand(){return je.Task.Ua(!0)}Gi(d,z){return 1905775613===z.command}dj(){return!1}}Object(Va.a)(Jc,"ToggleMergeSuspensionSafeState",kc.a,[34]);class od extends sa.a{constructor(d,z){super();this.statusBarManager=null;this.q7d=!1;this.ENa=
(T,ya)=>{T=`${ya.lpa.Current===ya.lpa.Pending?"\u26ad":"\u26ae"}${ya.lpa.Current}`;$c.a.equals(this.WNc,T,!1)||(this.WNc=T,this.$v())};this.X4a=(T,ya)=>{T=0==ya.xS;this.q7d!==T&&(this.q7d=T,this.$v())};this.mergeSuspensionManager=z;this.mergeSuspensionManager.tAa.Jeb(this.ENa);this.WNc="";Gi.a.rla(1905775613,li.a.mi,0,1);this.Ma=d.Ma;this.Y$b=new Jc;d.la.fi(29,T=>{this.mergeSuspensionManager&&(this.statusBarManager=T,T.hO(this),this.mergeSuspensionManager.cva.anc(this.X4a))});this.Ma.Wta(this.Y$b)}oy(d){this.addHandler(od.P5d,
d)}cy(d){this.removeHandler(od.P5d,d)}$v(){this.raiseEvent(od.P5d)}rr(d){return d===od.ubk&&!!this.mergeSuspensionManager}Ay(d,z){if(!this.rr(d))return!1;this.mergeSuspensionManager&&(z.LabelText=this.WNc,z.On=this.q7d);return!0}dispose(){this.Y$b&&(this.Ma.gvb(this.Y$b),this.Y$b.dispose(),this.Y$b=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.tAa.nvb(this.ENa),this.mergeSuspensionManager.cva.nVc(this.X4a),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.tN(this),
this.statusBarManager=null);this.WNc=null;super.dispose()}}od.P5d="MSMSC";od.ubk="QueryMergeSuspensionStatus";Object(Va.a)(od,"MergeSuspensionIndicatorManager",sa.a,[155,156,4]);var Pd=a(1076);class ge extends Sys.EventArgs{constructor(d){super();this.KLa=d}}Object(Va.a)(ge,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class Be{}Object(Va.a)(Be,"SuspensionState",null,[]);class Ye extends Be{constructor(d){super();this.n6e=!1;this.n6e=d}}Object(Va.a)(Ye,"ReadyForPendingMergeState",
Be,[]);const gf=new Be,Of=new Be,sg=new Ye(!1),Cg=new Ye(!0);var Pg=a(1075);class Qh extends Pg.a{constructor(d,z,T){super(d);this.WGh=z;this.wSk=T}}Object(Va.a)(Qh,"ReadyForPendingMergesUpdatedEventArgs",Pg.a,[]);class Vh extends sa.a{constructor(d,z,T){super();this.ENa=(ya,sb)=>{ya=this.getState();const cc=this.Jba;this.Jba=sb.lpa;sb=this.getState();this.bBj(ya,sb,cc);this.raiseEvent(Vh.L5d);this.gAf(ya,sb)};this.X4a=(ya,sb)=>{ya=this.getState();this.xS=sb.xS;sb=this.getState();this.gAf(ya,sb)};
this.v1b=(ya,sb)=>{4===sb.Mcg&&(ia.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",ke(this.Jba),ke(sb.Jba)),this.Qzg(this.getState(),!0))};this.$Vb=Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.cva=d;this.cva.anc(this.X4a);this.tAa=z;this.tAa.Jeb(this.ENa);this.srb=T;this.srb.w4e(this.v1b);this.Jba=Object(ed.a)(new Pd.a,{Pending:0,
Current:0,SuspensionStartTimestamp:null});this.xS=this.uaj()}uaj(){return Object(Ib.a)(Wa,this.cva)?Object(Db.a)(Wa,this.cva).Lzc():1}enc(d){this.addHandler(Vh.yxe,d)}qVc(d){this.removeHandler(Vh.yxe,d)}gEh(d){this.addHandler(Vh.wge,d)}$nk(d){this.removeHandler(Vh.wge,d)}oDh(d){this.addHandler(Vh.L5d,d)}unk(d){this.removeHandler(Vh.L5d,d)}Adk(){this.Hfe(this.getState()===Of)}dispose(){this.cva.nVc(this.X4a);this.cva=null;this.tAa.nvb(this.ENa);this.tAa=null;this.srb.yFg(this.v1b);this.srb=null;super.dispose()}$Md(){return Object(ed.a)(new Pd.a,
{Current:this.Jba.Current,Pending:this.Jba.Pending,SuspensionStartTimestamp:this.Jba.SuspensionStartTimestamp})}getState(){return V(this.Jba)?0==this.xS?Cg:this.$Vb&&1==this.xS?sg:Of:gf}gAf(d,z){d!==z&&(z===Of?this.Hfe(!0):d===Of&&this.Hfe(!1));this.Qzg(z)}Qzg(d,z){d instanceof Ye&&this.raiseEvent(Vh.wge,new Qh(this.Jba,d.n6e||!this.$Vb,void 0===z?!1:z))}bBj(d,z,T){d===gf&&z!==gf?(d=z===Of,z=z===sg,ia.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${z} publisher: ${z||
d?this.cva.a6k.join(","):""} counter: ${ke(this.Jba)} isBlockingAllMerges: ${d}`)):d!==gf&&z===gf&&ia.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${ke(T)}`)}Hfe(d){this.raiseEvent(Vh.yxe,new ge(d))}}Vh.yxe="TPMBBC";Vh.wge="RFPMU";Vh.L5d="MCC";Object(Va.a)(Vh,"MergeSuspensionStateHandler",sa.a,[]);class Rh extends sa.a{constructor(d){super();this.Wda=null;this.VKc=0;this.y_b=(z,T)=>{(null===T||void 0===T?0:T.lpa)&&this.Q4a(T.lpa,
Rh.rCe)};this.hYc=()=>{this.pIg();this.Ezg(this.Wda,Rh.psk)};this.E9d=(z,T)=>{T.committed&&this.Wda.SuspensionStartTimestamp&&ia.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${ke(this.Wda)}`)};this.pIg();this.$=d;this.$.ea.$q(this.hYc);this.$.ea.oO(this.hYc);cd.f(this.$).Fh.Jx(this.E9d);this.$.la.fi(292,z=>{z.Jeb(this.y_b);ia.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}Jeb(d){this.addHandler("MCU",d)}nvb(d){this.removeHandler("MCU",
d)}get Jba(){return this.Wda}Q4a(d,z){z=void 0===z?"":z;const T=this.Wda.Current<d.Current||this.Wda.Pending<d.Pending;if(d.SuspensionStartTimestamp&&this.VKc!==d.SuspensionStartTimestamp){if(this.VKc>d.SuspensionStartTimestamp){T&&ia.ULS.sendTraceTag(553736149,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${z}. S: ${Rh.x_b(d)}, C: ${Rh.x_b(this.Wda)}`);return}T||ia.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${Rh.x_b(d)}, C: ${Rh.x_b(this.Wda)}`)}else if(!T)return;
this.Wda=d;this.Ezg(d,z)}dispose(){this.$.ea.Uq(this.hYc);this.$.ea.aQ(this.hYc);cd.f(this.$).Fh.Lw(this.E9d);const d=this.$.la.kh(292);d&&d.nvb(this.y_b);super.dispose()}Ezg(d,z){z=void 0===z?"":z;V(d)&&d.SuspensionStartTimestamp>this.VKc&&(ia.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${ke(d)}, Origin: ${z}`),this.VKc=d.SuspensionStartTimestamp);this.raiseEvent("MCU",new Pg.a(d))}pIg(){ia.ULS.sendTraceTag(588276808,0,
50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${Rh.x_b(this.Wda)}`);this.Wda=Object(ed.a)(new Pd.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static x_b(d){return d?`(${d.Current}/${d.Pending} @${d.SuspensionStartTimestamp})`:"null"}}Rh.rCe="PMM.RTC";Rh.fwc="PMM.EwaResult";Rh.psk="PMM.resetMergeCounter";Object(Va.a)(Rh,"PendingMergeMonitor",sa.a,[]);class Ii{}Object(Va.a)(Ii,"ClientRevisions",null,[]);const zj=(d,z,T,ya,sb,cc,Fc)=>{Fc=d.$a(1,void 0===Fc?null:Fc);Fc.suspensionStartTimestamp=
z;return dc.h(d,"KeepBlockingPendingMerges",Fc,T,ya,sb,cc,0)};class ej extends sa.a{constructor(d,z,T,ya){super();this.FYa=null;this.yYb=0;this.zYb=this.Tpb=null;this.bpg=(sb,cc)=>{this.FYa.MKh(cc.lpa,cc.WGh,cc.wSk)};this.b2b=(sb,cc)=>{cc.KLa?this.KUk():this.t0c()};this.cng=()=>{this.yYb=0};this.lNg=()=>{const sb=this.Pha.$Md();zj(this.ta,null!=sb.SuspensionStartTimestamp?sb.SuspensionStartTimestamp:0,null,()=>{this.OVj(sb)},null,null,this.ta.Vh())};this.JRa=(sb,cc)=>{if(cc){cc.CIb.MergeCount=this.Pha.$Md();
const {min:Fc,max:Wc}=cd.f(this.$).GGj();Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?cc.CIb.ClientRevisions=Object(ed.a)(new Ii,{Min:Fc,Max:Wc,MaxFromBlockCache:cd.f(this.$).za.jcg}):cc.CIb.ClientRevisions=Object(ed.a)(new Ii,{Min:Fc,Max:Wc})}};this.$=d;this.Gfb=T;this.Pha=z;this.Pha.gEh(this.bpg);this.Pha.enc(this.b2b);this.Pha.oDh(this.cng);this.$.pa.qIb(this.JRa);this.ta=this.$.pa.ta;this.Tke=this.$.ua.MergeSuspensionRequestThrottlingTimeInMs;this.Iuj=this.$.ua.KeepBlockingPendingMergesRequestIntervalMs;
this.FYa=ya;ia.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.pa.u5b(this.JRa);this.t0c();this.Pha.$nk(this.bpg);this.Pha.qVc(this.b2b);this.Pha.unk(this.cng);this.Pha=null;super.dispose()}KUk(){this.t0c();if(this.Bpf()){const d=this.Pha.$Md();ia.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${ke(d)} fail count: ${this.yYb}`)}else this.zYb=
this.Gfb.create(this.lNg,this.Tke,vd.a.zYb),this.Tpb=this.Gfb.LO(this.lNg,this.Iuj,vd.a.Tpb)}t0c(){this.Tpb&&(this.zYb.cancel(),this.Tpb.cancel(),this.Tpb=this.zYb=null)}OVj(d){let z;z=" fail count: "+this.yYb;this.yYb++;this.Bpf()&&this.t0c();ia.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${ke(d)}${z}`)}Bpf(){return this.yYb>ej.jFj}}ej.jFj=5;Object(Va.a)(ej,"RequestController",sa.a,[]);class ti extends Sys.EventArgs{constructor(d,z){super();
this.Mcg=d;this.Jba=z}}Object(Va.a)(ti,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);class dj extends sa.a{get X0a(){return 0<this.$ae}constructor(d,z,T,ya,sb){T=void 0===T?null:T;ya=void 0===ya?null:ya;sb=void 0===sb?null:sb;super();this.UKc=null;this.$ae=0;this.documentVisibilityObserver=null;this.t5f=!1;this.oNc=null;this.ta=d;this.Tke=z.ua.MergeSuspensionRequestThrottlingTimeInMs;const cc=z.ua.GetRangeContentPrefetchDelayForMergeInMs;this.ZC=()=>{z.OLg(cc)};this.Yp=T||Td.a.ih;this.m8g=0;this.vW=
ya;this.CPa=sb;Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void zc.a.resolve(oc.Cb).then(Fc=>{this.documentVisibilityObserver=Fc}):z.la.fi(291,Fc=>{this.documentVisibilityObserver=Fc})}w4e(d){this.addHandler(dj.M5d,d)}yFg(d){this.removeHandler(dj.M5d,d)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.un}MKh(d,z,T){this.L8b(d,z,void 0===T?!1:T)?(new Ub.a).setResult(!0):(z=this.K5j(d,z),this.UKc=
d,this.$ae++,z.continueWith(()=>{this.XQj()},0,Rc.a.none,this.vW))}K5j(d,z){this.m8g=this.Yp.Kra;this.t5f=z;ia.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${d.Current} / ${d.Pending} @${d.SuspensionStartTimestamp}. allowSelectionAdjustment: ${z}`);this.isDocumentHidden||this.ZC();return this.Fzk(z,d)}L8b(d,z,T){T=void 0===T?!1:T;if(this.CPa&&!z&&!this.CPa.Prj())return ia.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),
!0;if(!this.UKc||d.SuspensionStartTimestamp>this.UKc.SuspensionStartTimestamp)return this.X0a&&ia.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${d.Current} / ${d.Pending} @${d.SuspensionStartTimestamp}`),!1;if(this.X0a)return!0;if(T)return!1;T=this.UKc;const ya=this.Yp.Kra-this.m8g<this.Tke;z=this.t5f===z;return(d||T?d&&T?d.Current===T.Current&&d.Pending===T.Pending&&d.SuspensionStartTimestamp===T.SuspensionStartTimestamp:
!1:!0)&&ya&&z}Fzk(d,z){const T=this.ta.Vh(),ya=()=>{ia.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${z.Current} / ${z.Pending} @${z.SuspensionStartTimestamp}`)};return this.CPa?this.CPa.Kvk(this.hKi(d,ya,T)):this.wcf(null,!0,void 0,ya,T)}hKi(d,z,T){return(ya,sb,cc)=>{let Fc=void 0;ia.ULS.shipAssertTag(523317955,0,null!=ya||d,"!allowSelectionAdjustment requires a non-null initialViewportState.");Fc=this.YQj.bind(this);sb&&(Fc=uc.c.call(null,Wc=>{const id=
Wc.Result;let Dd=null===id||void 0===id?void 0:id.AdjustedViewportState;3===(null===id||void 0===id?void 0:id.MergeResultState)&&(Dd=void 0);sb(Dd,Wc.StateId)},Fc));cc&&(z=uc.b.call(null,cc,z));return this.wcf(ya,d,Fc,z,T)}}wcf(d,z,T,ya,sb){var cc=this.ta;sb=cc.$a(1,void 0===sb?null:sb);sb.viewportState=d;sb.allowViewAdjustment=z;return dc.h(cc,"DoPendingMerge",sb,T,ya,null,null,0)}YQj(d){var z=d.Result;void 0!=z&&(z=z.MergeResultState,2!==z&&(this.oNc=[z,d.MergeCount]))}Sck(d,z){this.raiseEvent(dj.M5d,
new ti(d,z))}XQj(){this.$ae--;if(this.oNc){const d=this.oNc;this.oNc=null;this.Sck(...d)}}}dj.M5d="MDO";Object(Va.a)(dj,"DoPendingMergeSender",sa.a,[653,654]);class ui{constructor(d){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.$9i=void 0===d?!1:d}get reportName(){return this.$9i?"SelectionAdjustInHiddenDocument":
"SelectionAdjust"}}Object(Va.a)(ui,"SelectionAdjustSessionEndsReport",null,[198]);class Ij{constructor(d,z,T,ya,sb,cc){this.th=d;this.BQ=z;this.fla=T;this.GUa=ya;this.BGe=sb;this.cX=cc}get activeCell(){return this.BQ}get selectedRanges(){return this.fla}get Jy(){let d=!1;if(null===this.cX||void 0===this.cX)d=!0;else if(this.cX>=this.selectedRanges.length||!this.selectedRanges[this.cX].contains(this.activeCell))ia.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.cX}, selectedRangesLength: ${this.selectedRanges.length}`),
d=!0;d&&(this.cX=this.uSh());return this.cX}get activeRange(){return 0>this.Jy?this.activeCell:this.selectedRanges[this.Jy]}get sheetName(){return this.GUa}get activeItemName(){return this.BGe}get gdh(){return 1===this.selectedRanges.length}x9g(d){const z=this.selectedRanges.map(T=>this.r3k(T,this.BGe));for(const T of z)if(T)for(const ya of T)if(ya.kq&&ya.wk.Revision<d)return!1;return!0}G_k(){var d;return{SheetName:this.sheetName,ActiveCell:null===(d=this.activeCell)||void 0===d?void 0:d.toString(),
TopLeft:void 0,SelectedRanges:qd.t(this.selectedRanges,this.th)}}toString(){var d,z;return`active cell: ${null!==(z=null===(d=this.activeCell)||void 0===d?void 0:d.toString())&&void 0!==z?z:"null"} selection: ${this.selectedRanges.map(T=>{var ya;return null!==(ya=null===T||void 0===T?void 0:T.toString())&&void 0!==ya?ya:"null"}).join(",")}`}equals(d){return d?this.activeCell.equals(d.activeCell)&&qd.X(this.selectedRanges,d.selectedRanges)&&this.sheetName===d.sheetName:!1}uSh(){for(const d of this.selectedRanges.entries()){const [z,
T]=d;if(null===T||void 0===T?0:T.contains(this.activeCell))return z}return-1}r3k(d,z){var T;const ya=cd.f(this.th).za.JJa(d,z);ya||ia.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==(T=null===d||void 0===d?void 0:d.toString())&&void 0!==T?T:"null"} ; activeItemNameIsDefined: ${!!z}`);return ya}}Object(Va.a)(Ij,"SelectionState",null,[]);var ik=a(203),Wk=a(943);class Jj{constructor(d){this.l0c=0;this.iR=this.rP=null;this.VGe=new ui;this.WGe=
new ui(!0);this.oS=0;this.MYk=!1;this.KGj=1E4;this.Cj=()=>{this.kmf()};this.vp=()=>{this.ksd(!0,!1)};this.fsb=()=>{this.ksd(!1,!1)};this.$=d;this.da=cd.f(this.$);this.da.za.ny(this.vp);this.da.za.nz(this.fsb);this.da.za.N3e(this.fsb);this.da.za.eua(this.fsb);this.$.mr(this.Cj);this.kmf()}Kvk(d){let z=null,T=null;const ya=()=>{this.jNj()};this.VWf()?(this.I_.parallel++,ia.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.iR}`)):
(z=(sb,cc)=>{this.kNj(sb,cc)},T=this.YFk());return null===d||void 0===d?void 0:d(T,z,ya)}Prj(){return!this.VWf()&&this.uaa().gdh}YFk(){var d;ia.ULS.shipAssertTag(525135961,0,0===this.oS,"SelectionAdjustManager.setPreRequestState: unexpected state");this.iR&&(this.I_.errors++,ia.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.iR.toString()}`));this.iR=null;this.rP=this.uaa();let z=null;const T=null===(d=this.rP)||void 0===
d?void 0:d.G_k();T&&(z={ActiveSheetName:this.rP.sheetName,SheetViewportStateChanges:[T]});this.oS=1;return z}jNj(){ia.ULS.shipAssertTag(525135960,0,1===this.oS,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.I_.errors++;this.oS=2;this.Nx()}kNj(d,z){try{ia.ULS.shipAssertTag(525135959,0,1===this.oS,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.l0c=z,z=2,this.rP?d?(this.iR=this.dKk(d))?(z=7,this.rP.equals(this.iR)?this.rP.equals(this.uaa())?(this.I_.adjustedDidntChange++,
z=4):(this.I_.adjustedDidntChangeWithDivergence++,z=5):this.rP.sheetName!=this.iR.sheetName?(this.I_.differentSheetAdjust++,z=10):this.rP.equals(this.uaa())||(this.I_.divergenceOnResponse++,z=6,this.OGg())):this.I_.errors++:(this.I_.errors++,ia.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.rP.toString()}`)):(this.I_.errors++,ia.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===
d||void 0===d?void 0:d.ActiveCell}`)),this.oS=z}catch(T){this.oS=12,ia.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${T}`)}finally{7!=this.oS?this.Nx():this.ksd(!1,!0)}}dispose(){this.da.za.ux(this.vp);this.da.za.Zy(this.fsb);this.da.za.QEg(this.fsb);this.da.za.jvb(this.fsb);this.$.Wr(this.Cj)}VWf(){return 1===this.oS||7===this.oS}dKk(d){let z;if(!(()=>{let cc=qd.jb(d.ActiveCell,this.$.sa);({range:z}=cc);return cc})().returnValue)return ia.ULS.sendTraceTag(537155411,
0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${d.ActiveCell}`),null;let T=[];const ya=this.$.ma,sb=!!ya&&2===ya.zG;if(d.SelectedRanges)T=qd.h(d.SelectedRanges.Ranges);else if(!sb)return ia.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!ya}`),null;return new Ij(this.$,z,T,d.SheetName,this.rP.activeItemName,this.rP.Jy)}uaa(){const d=this.$.ma;if((null===d||
void 0===d?0:d.activeCell)&&d.selectedRanges&&d.sheetName)return new Ij(this.$,d.activeCell,d.selectedRanges,d.sheetName,this.$.activeItemName,d.Jy);ia.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!d}, activeCell null: ${!(null===d||void 0===d?0:d.activeCell)}, selectedRanges null: ${!(null===d||void 0===d?0:d.selectedRanges)}, sheetName null: ${!(null===d||void 0===d?0:d.sheetName)}`);return null}kmf(){this.$.la.fi(276,()=>{const d=
ik.a(this.$);d.a4(this.VGe);d.a4(this.WGe)})}ksd(d,z){var T;if(this.Tpj(d))if(8===this.oS)ia.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{z&&ia.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{ia.ULS.shipAssertTag(525135956,0,7===this.oS,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.rP.equals(this.uaa())?(null===(T=this.da)||void 0===
T?0:T.isEditing)?(this.I_.editBoxDivergence++,this.oS=11):(d=0,d=this.iR.Jy,-1==d?(this.I_.errors++,ia.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):(this.I_.adjusted++,this.oS=8,this.da.ha.yN(this.iR.selectedRanges,d,this.iR.activeCell,0,void 0,"SelectionAdjust"))):(this.I_.divergenceOnViewportReady++,this.OGg(),this.oS=9)}catch(ya){this.oS=12,ia.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${ya}`)}finally{this.Nx()}}}Tpj(d){if(!this.iR)return!1;
if(!this.rP)return ia.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.iR.toString()}`),!1;if(cd.f(this.$).za.jcg<this.l0c)return!1;if(d||this.MYk)ia.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.rP.x9g(this.l0c)||!this.iR.x9g(this.l0c))return!1;return!0}Nx(){this.rP=this.iR=
null;this.oS=0}OGg(){const d=this.uaa();ia.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.rP.toString()} current: ${d?d.toString():""} adjusted: ${this.iR.toString()} sheetSameBetweenInitialAndAdjusted: ${this.rP.sheetName===this.iR.sheetName} sheetSameBetweenInitialAndCurrent: ${this.rP.sheetName===(d?d.sheetName:null)}`)}get I_(){return Wk.a.UM(this.KGj)?this.WGe:this.VGe}}Object(Va.a)(Jj,"SelectionAdjustManager",null,[645,4]);class Cj extends kc.a{constructor(d,
z,T){T=void 0===T?null:T;super();this.wSa=this.cFc=this.hnb=this.Sgb=null;this.$=d;this.Mcb=new Rh(d);this.CPa=new Jj(this.$);this.FYa=new dj(this.$.pa.ta,this.$,void 0,void 0,this.CPa);this.Waj(d,T);this.Osa=new Vh(this.wSa,this.Mcb,this.FYa);this.Oke=new ej(d,this.Osa,z,this.FYa);Pb.EwaSettings.Ra(230)&&(this.cFc=new od(d,this));ia.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}enc(d){this.Osa.enc(d)}qVc(d){this.Osa&&this.Osa.qVc(d)}get cva(){return this.wSa}get tAa(){return this.Mcb}get Pha(){return this.Osa}TOa(d,
z){this.wSa.TOa(d,z)}lze(d){this.wSa.lze(d)}Q4a(d,z){this.Mcb.Q4a(d,void 0===z?"":z)}dispose(){this.cFc&&(this.cFc.dispose(),this.cFc=null);this.CPa&&this.CPa.dispose();this.FYa.dispose();this.Oke&&(this.Oke.dispose(),this.Oke=null);this.Osa&&(this.Osa.dispose(),this.Osa=null);this.Mcb.dispose();this.Mcb=null;this.wSa.dispose();this.wSa=null;this.Sgb&&(this.Sgb.dispose(),this.Sgb=null);this.hnb&&(this.hnb.dispose(),this.hnb=null);this.$=null;super.dispose()}U3b(){this.Osa.Adk()}static Lzc(d){let z=
0;for(const T of d){if(2==T)return 2;1==T&&(z=1)}return z}Waj(d,z){this.wSa=new Wa(this.FYa,this.Mcb);z?Object(Ib.a)(Eb,z)?this.TOa(z,Object(Db.a)(Eb,z).xS):Object(Ib.a)(nd,z)?this.TOa(z,Object(Db.a)(nd,z).xS):this.TOa(z,0):(this.Sgb=new nd(d),this.hnb=new Eb(d),this.TOa(this.Sgb,this.Sgb.xS),this.TOa(this.hnb,this.hnb.xS))}}Object(Va.a)(Cj,"MergeSuspensionManager",kc.a,[625,4]);class oj extends bg.a{constructor(d){super();this.pj=d;this.gm()}create(){ia.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");
this.Bk(this.pj.la.kh(343)||this.pj.la.Hh(343,new Cj(this.pj,Ve.a.instance)))}static Ba(d){ia.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");d.la.Hh(344,new oj(d))}}Object(Va.a)(oj,"MergeSuspensionFactory",bg.a,[]);class Kj extends bg.a{constructor(d){super();this.$=d;this.gm()}create(){Qf.uVd()?Ug.TaskExtensions.Xa(Object(Cf.d)(zc.a.resolve(oc.Md,{va:this.xh})),d=>{Ug.TaskExtensions.Xa(d.result.FTg(),z=>{this.Pkf(z.result)},this.$.ya,3)},this.$.ya,3):this.Pkf(!0)}Pkf(d){this.Bk(this.$.la.kh(458)||
this.$.la.Hh(458,new Qf(d)))}static Ba(d){d.la.Hh(459,new Kj(d))}}Object(Va.a)(Kj,"LineageCatchUpExperimentManagerFactory",bg.a,[]);class jk extends bg.a{constructor(d){super();this.$=d;this.gm()}create(){this.jhk(()=>P.Ba(this.$))}static Ba(d){d.la.Hh(50,new jk(d))}jhk(d){d=Object(rg.a)(this.$.la,183,d);this.Bk(d)}}Object(Va.a)(jk,"TaskPaneManagerFactory",bg.a,[]);const Lj=()=>dg.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),Xk=()=>dg.a.instance.resolve("Common.App.Rename.IRenameFlyoutActor");
var Ri=a(531),Yk=a(685),Rj=a(598),qj=a(188);class Sj{constructor(d,z,T){this.oVg=this.pVg=this.qVg=!1;this.$Vg=!d&&!z;this.aWg=!d&&!T;this.$Vg||this.aWg||(this.qVg=!d,this.pVg=!z,this.oVg=!T)}}Object(Va.a)(Sj,"RenameDisabledDialogInfo",null,[]);var tg=a(22);class Tj extends qj.a{constructor(d,z,T,ya,sb){super();this.Kwe=[];this.oDb=new Sj(d,z,T);this.TGb=ya;this.GDb=sb;this.kl="RenameDisabledDialog";this.Ph=0;this.ti(1,Object(tg.a)("DialogClose"));this.oHk();this.spk()}oHk(){if(this.oDb.$Vg){let d;
d=this.TGb?this.GDb?Object(tg.a)("RenameFileRenameReadOnlyRecommended"):Object(tg.a)("RenameFileRenameNotEveryoneSupportsRename"):Object(tg.a)("RenameFileRenameDisabledCoauthFull");this.ZVg(d)}else this.oDb.aWg?this.ZVg(Object(tg.a)("RenameFileRenameDisabledPermissionFull")):this.Eyh();this.Uta(this.Kwe)}ZVg(d){Array.add(this.Kwe,d)}Eyh(){const d=[];this.oDb.qVg||Array.add(d,Object(tg.a)("RenameFileRenameDisabledSignIn"));this.oDb.pVg||Array.add(d,Object(tg.a)("RenameFileRenameDisabledPermission"));
this.oDb.oVg||Array.add(d,Object(tg.a)("RenameFileRenameDisabledCoauth"));0<d.length&&Array.add(this.Kwe,d)}}Object(Va.a)(Tj,"ReactRenameDisabledDialogBase",qj.a,[]);class fh extends Tj{constructor(d,z,T,ya,sb){super(d,z,T,ya,sb)}spk(){this.trb(Object(tg.a)("RenameFileRenameDisabledTitle"),null,null,null,null,null)}}Object(Va.a)(fh,"RenameDisabledDialog",Tj,[]);class Ak{constructor(d,z,T){this.OTa=0;this.oma=(ya,sb,cc,Fc,Wc)=>{if(1===cc)return this.$f.gl(bc.a.renameFile,1);ya=Lb.a.Dz(this.ksa.Jv);
Wc=(0,Wc.getNewDocumentTitle)();Wc.length>this.OTa&&(Wc=Wc.substr(0,this.OTa));if(32!==this.$f.ek(bc.a.renameFile,2,Wc))return this.S8(ya),8;this.S8(Wc);this.Wi.tia(Ei.AFrame.ERd,!1);return 32};this.$f=d;this.ksa=z;this.Wi=T}initialize(d){if(!this.$f||!this.ksa)return!1;this.OTa=d;this.ho();return!0}ho(){this.$f.Uh(bc.a.oma,fc.a.frame,this.oma)}S8(d){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(d))}static FMd(){return new Ak(wa.AFrameworkApplication.yh,wa.AFrameworkApplication.ju,
$h.FocusManager.instance())}}Object(Va.a)(Ak,"ReactRenameUIHandler",null,[657]);const Bk=()=>dg.a.instance.fj("Common.App.Header.HeaderEventSource");var rj=a(109),Zk=a(608),$k=a(855),cg=a(482),Mj=a(59);class Uj{constructor(d,z,T,ya,sb,cc,Fc,Wc,id,Dd,ee,re){this._initialized=!1;this._element=null;this.OTa=0;this.Tjd=this.ycd=!1;this.$f=d;this.r8c=z;this.ol=T;this.VJ=ya;this.ksa=sb;this.kXe=cc;this.zjc=Fc;this.p9c=Wc;this.Gka=id;this.rPe=Dd;this.Wbb=ee;this.zdd=re}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(d,
z,T){if(!(this.$f&&this.ksa&&this.kXe&&this.zjc&&this.p9c&&z)||0>=d)return!1;this._element=z;this._element.title=T;this._element.setAttribute(cg.a.ik,cg.a.FF);this._element.setAttribute("Unselectable","on");this.OTa=d;this.ZE();return this._initialized=!0}ZE(){this.r8c&&(this.r8c.xa(Z.a.blur,this._element,Object(Aa.a)(this,this.onBlur,"onBlur")),this.r8c.xa(Z.a.paste,this._element,Object(Aa.a)(this,this.onPaste,"onPaste")));this.ol.xa(Z.a.Ui,this._element,Object(Aa.a)(this,this.onKeyDown,"onKeyDown"));
this.VJ.xa(Z.a.qj,this._element,Object(Aa.a)(this,this.onPointerDown,"onPointerDown"));this.VJ.xa(Z.a.Co,this._element,Object(Aa.a)(this,this.Bo,"onPointerUp"))}onBlur(){this.isActive&&!this.ycd&&(this.rPe||this.p9c(this._element),this.Ahf(),this.jBd(!1));return this.ycd=!1}onPaste(){ia.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(d){return this.isActive?this.SVj(d):this.TVj(d)}SVj(d){let z=!1;switch(d.La.keyCode){case Sys.UI.Key.enter:this.Ahf();
this.jBd(this.Wbb||this.zdd);z=!0;break;case Sys.UI.Key.tab:this.rPe&&this.p9c(this._element);break;case Sys.UI.Key.esc:this.Mle(),this.jBd(this.Wbb||this.zdd),z=!0}return z}TVj(d){let z=!1;switch(d.La.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.E2g(this.zdd),this.isActive&&this.zjc(this._element),z=!0}return z}onPointerDown(){this.isActive||(this.E2g(!1),this.isActive&&(this._element.focus(),this.zjc(this._element),this.Tjd=!0));return!1}Bo(){return this.Tjd?(this.zjc(this._element),
this.Tjd=!1,!0):!1}$ob(){return 32===this.$f.gl(bc.a.renameFile,1)}Ahf(){const d=Lb.a.Dz(this.ksa.Jv);let z=this._element.innerText.trim();z.length>this.OTa&&(z=z.substr(0,this.OTa));z!==d&&""!==z?32!==this.$f.ek(bc.a.renameFile,2,z)?this.Mle():this.S8(z):this.Mle()}Mle(){this.S8(Lb.a.Dz(this.ksa.Jv))}S8(d){this._initialized&&(this._element.innerText=d,this.kXe())}E2g(d){this.$ob()?this.isActive||(d&&(this.ycd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),
this._element.setAttribute(cg.a.ik,cg.a.Rrd),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,rj.a.gsf),this.Gka&&this.Gka.execute(z=>{z.Szg(!0)}),d&&this._element.focus(),ia.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.$f.gl(bc.a.Txb,2)}jBd(d){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(cg.a.ik,cg.a.FF);Sys.UI.DomElement.removeCssClass(this._element,rj.a.gsf);this.Gka&&
this.Gka.execute(z=>{z.Szg(!1)});d&&(this._element.blur(),this._element.focus())}static tJ(){Zk.a.tJ(wa.AFrameworkApplication.isRtl)}static FMd(){return new Uj(wa.AFrameworkApplication.yh,$k.a.instance,td.a.instance,cf.a.instance,wa.AFrameworkApplication.ju,Uj.tJ,Mj.a.Oyk,Mj.a.JXh,Bk(),xf.a.rha,xf.a.oo,xf.a.Am)}}Object(Va.a)(Uj,"RenameUIHandler",null,[657]);class fj{static get instance(){return wa.AFrameworkApplication.ra.$g.Ew?fj.Va||(fj.Va=Ak.FMd()):fj.Va||(fj.Va=Uj.FMd())}}fj.Va=null;Object(Va.a)(fj,
"RenameUIHandlerFactory",null,[]);var al=a(202);class Ck{constructor(){this.YJj=this.SJj=this.Bai=null}}Object(Va.a)(Ck,"RenameMruEntryProperties",null,[]);var bl=a(771),Dj;(function(d){d[d.unknown=-1]="unknown";d[d.success=0]="success";d[d.wul=1]="renameInvalidFileName";d[d.vul=2]="renameInCoauthNotSupported";d[d.xul=3]="renameNotSupportedInViewMode";d[d.aul=4]="permissionDenied";d[d.Pul=5]="serverCommunicationFailure";d[d.Bml=6]="fileNameTooLong"})(Dj||(Dj={}));Object(Va.b)("CommonOperationResult",
Dj);class kk{constructor(d,z){this.fileNameCandidate=d;this.disableFailedActionDialog=void 0===z?!1:z}}Object(Va.a)(kk,"RenameActionData",null,[]);class gj{constructor(d,z,T,ya,sb,cc,Fc,Wc,id,Dd,ee,re){this.UUb=()=>fj.instance.initialize(wa.AFrameworkApplication.jyc,wa.AFrameworkApplication.IYa,wa.AFrameworkApplication.Jje||Object(tg.a)("RenameFileTooltip"))?32:8;this.Txb=()=>{const Ce=this.cbl(),mf=this.ivh();ia.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.pcb,mf,Ce,this.TGb);new fh(this.pcb,!mf,!Ce,this.TGb,this.GDb());return 32};this.renameFile=(Ce,mf,tf,Df,sf)=>{if(1===tf)return this.$ob();if(!wa.AFrameworkApplication.Exc)return 8;if(8===this.$ob())return this.Qn.gl(bc.a.Txb,2),8;this.Sia&&this.Sia.E3c(!1);ia.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");Ce=!1;sf instanceof kk&&(Ce=sf.disableFailedActionDialog,sf=sf.fileNameCandidate);wa.AFrameworkApplication.Exc(sf,Object(Aa.a)(this,this.H1b,"onRenameFileSuccess"),Ce?this.NNj:this.LYj);
wa.AFrameworkApplication.epk=!0;return 32};this.NNj=Ce=>{ia.ULS.sendTraceTag(507655632,203,15,"OnAutoRenameFileFailure: {0}",{["Result"]:null!==Ce&&void 0!==Ce?Ce:-1});this.Sia&&this.Sia.E3c(!0)};this.LYj=Ce=>{ia.ULS.sendTraceTag(507655631,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==Ce&&void 0!==Ce?Ce:-1});const mf=new qj.a;mf.Ph=0;switch(Ce){case 1:ia.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");mf.WBa(Object(tg.a)("RenameFileInvalidNameTitle"),Object(tg.a)("RenameFileInvalidName"),
null);break;case 6:ia.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");mf.WBa(Object(tg.a)("RenameFileInvalidNameTitle"),Object(tg.a)("RenameFileNameTooLong"),null);break;default:ia.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==Ce&&void 0!==Ce?Ce:-1}),mf.WBa(Object(tg.a)("RenameFileGenericErrorTitle"),Object(tg.a)("RenameFileGenericError"),null)}wa.AFrameworkApplication.UF().execute(tf=>{tf.sendMessage(ub.a.nvi,{["FailureMessage"]:Dj[Ce]})});
this.TIg();this.Sia&&this.Sia.E3c(!0)};this.Xgk=(Ce,mf,tf)=>{if(1===tf)return this.$ob();if(!wa.AFrameworkApplication.lZa)return 8;wa.AFrameworkApplication.lZa(Object(Aa.a)(this,this.qQc,"onRefreshFilenameSuccess"),Object(Aa.a)(this,this.pQc,"onRefreshFilenameFailure"),!1);return 32};this.HNc=(Ce,mf,tf,Df,sf)=>{if(1===tf)return wa.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.$ob():8;if(2===tf){if(!wa.AFrameworkApplication.iNg)return fa.Health.instance.recordKpiFailure("MoveToFolder",
"Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!sf)return fa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(sf[Kb.a.$ij])if(sf[Kb.a.G7g])if(Ce=sf[Kb.a.G7g].toLowerCase(),mf=wa.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),tf=wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),mf&&wa.AFrameworkApplication.pV&&tf){const $f={};$f[Kb.a.l6a]="1";$f[Kb.a.documentUrl]=Ce;$f[Kb.a.reason]=
bl.a.saveAs;fa.Health.instance.recordKpiSuccess("MoveToFolder",null);wa.AFrameworkApplication.UF().execute(pg=>{pg.sendMessage(ub.a.d5,$f)})}else if(!wa.AFrameworkApplication.pV&&tf)fa.Health.instance.recordKpiSuccess("MoveToFolder",null),Mj.a.Cm(Ce,Mj.a.Y2(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return fa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else fa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else wa.AFrameworkApplication.lZa(Object(Aa.a)(this,
this.qQc,"onRefreshFilenameSuccess"),Object(Aa.a)(this,this.pQc,"onRefreshFilenameFailure"),!1),wa.AFrameworkApplication.iNg(),fa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.FPe=d;this.$f=z;this.z9c=T;this.oI=ya;this.pcb=sb;this.ivh=cc;this.TGb=Fc;this.u_e=Wc;this.Drh=id;this.GDb=Dd;this.Ga=ee;this.Crh=re;this.wUa=new Rj.a(()=>this.LVi())}ho(){wa.AFrameworkApplication.ra&&wa.AFrameworkApplication.ra.$g.Ew||this.Qn.Uh(bc.a.UUb,fc.a.frame,this.UUb);this.Qn.Uh(bc.a.Txb,fc.a.frame,
this.Txb);this.Qn.Uh(bc.a.renameFile,fc.a.frame,this.renameFile);this.Qn.dl(bc.a.kyc,fc.a.frame,this.Xgk,64);this.Qn.dl(bc.a.HNc,fc.a.frame,this.HNc,64);this.Qn.Uh(bc.a.Lba,fc.a.frame,Object(Aa.a)(this,this.Lba,"moveToFolder"));(wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||wa.AFrameworkApplication.ra&&(wa.AFrameworkApplication.fa.ka("PostMessageEmbedded")||wa.AFrameworkApplication.fa.ka("IsJsApi"))&&wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&wa.AFrameworkApplication.UF().execute(d=>{d.kr(ub.a.ydg);d.aq(ub.a.ydg,gj.xfk);d.kr(ub.a.SGd);d.aq(ub.a.SGd,gj.vfk)})}$ob(){return 0===this.Crh.WKf()?32:8}cbl(){return this.FI?this.TGb?this.FI.frf:this.FI.XQb:!0}LVi(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",!1)?dg.a.instance.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"):null}H1b(d,z){d?0!==d.OperationResult?this.oPf(d.OperationResult):(this.dAk(z,d.NewName),this.H6k(d,
Object(Aa.a)(wa.AFrameworkApplication.ra.$g,wa.AFrameworkApplication.ra.$g.G6g,"updateOpenInClientDocumentUrl")),wa.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&wa.AFrameworkApplication.ra.XB(),this.Drh.Y4g()):this.oPf(5);this.Sia&&this.Sia.E3c(!0)}dAk(d,z){const T={};T[Kb.a.ovi]=z;d.sendMessage(ub.a.SGd,T)}H6k(d,z){this.T6k(d);wa.AFrameworkApplication.kvc=d.DirectInvokeDavUrl;z=z(d.EditDocInClientUrl);const T=new Ck;T.YJj=this.oI.Jv;T.Bai=z;T.SJj=d.EditDocInClientUrl;this.Qn.ek(bc.a.renameMostRecentlyUsedFileEntry,
2,T)}oPf(d){switch(d){case 1:d=new qj.a,d.Ph=0,d.pW(Object(tg.a)("RenameFileInvalidNameTitle"),Object(tg.a)("RenameFileInvalidName"),null),this.TIg()}}T6k(d){this.oI.Jv=gj.XHh(this.oI.Jv,d.NewName);d.BreadcrumbFolderName&&(this.oI.breadcrumbFolderName=d.BreadcrumbFolderName);d.BreadcrumbFolderUrl&&(this.oI.breadcrumbFolderUrl=d.BreadcrumbFolderUrl);this.u_e(d.NewName)}Lba(d,z,T,ya,sb){if(1===T)return wa.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===T){const cc={};d=wa.AFrameworkApplication.pV;
z=wa.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");d=(!d||d&&z)&&wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);cc[Kb.a.YWk]=d;sb&&sb.MoveButtonClickedTime&&(cc[Kb.a.yHj]=sb.MoveButtonClickedTime.getTime());wa.AFrameworkApplication.fa.ka("DarkModeSupportInMoveFilePickerEnabled")&&(d={},Object(Od.a)("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(d[Kb.a.Vug]="Dark"),cc[Kb.a.Tug]=d);wa.AFrameworkApplication.UF().execute(Fc=>
{Fc.sendMessage(ub.a.Lba,cc)});if(sb&&sb.MoveButtonClickedTime){if(d=al.a.wy())sb=(new Date).getTime()-sb.MoveButtonClickedTime.getTime(),d.set("MovePostDuration",sb.toString());fa.Health.instance.recordKpiUsage("MoveToFolder",Ba.b.FailureBased,"smartfio",d)}return 32}return 8}ONk(d,z){return d&&z?d!==this.oI.breadcrumbFolderName||z!==this.oI.breadcrumbFolderUrl:!1}qQc(d,z){d&&(d.NewName!==Lb.a.Dz(this.oI.Jv)||this.ONk(d.BreadcrumbFolderName,d.BreadcrumbFolderUrl))&&this.H1b(d,z)}pQc(){}TIg(){this.u_e(Lb.a.Dz(this.oI.Jv))}get Qn(){return this.$f.value}get Sia(){return this.wUa.value}get FI(){return this.z9c.value}static get instance(){return gj.Va||
(gj.Va=gj.Swa())}static Swa(){return new gj(wa.AFrameworkApplication.QLa,new Rj.a(()=>wa.AFrameworkApplication.yh),new Rj.a(()=>wa.AFrameworkApplication.FI),wa.AFrameworkApplication.ju,wa.AFrameworkApplication.limitedEdit,()=>wa.AFrameworkApplication.userCanRename,wa.AFrameworkApplication.sVc,Object(Aa.a)(fj.instance,fj.instance.S8,"updateTitle"),Lj(),()=>wa.AFrameworkApplication.isReadOnlyRecommended,wa.AFrameworkApplication.fa,dg.a.instance.resolve("Common.IRenameProps"))}static XHh(d,z){d=Lb.a.vaa(d);
return z+d}static xfk(d){const z=d.Values[Kb.a.$nj];ia.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",z);z?wa.AFrameworkApplication.yh.ek(bc.a.HNc,2,d.Values):fa.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static vfk(d){wa.AFrameworkApplication.yh.ek(bc.a.renameFile,2,d.Values.NewName)}}gj.Va=null;Object(Va.a)(gj,"RenameActor",null,[]);a(680);class cl{}Object(Va.a)(cl,"ActivityEventName",null,[]);class Dk{}Dk.compatMode=
"CompatMode";Object(Va.a)(Dk,"ActivityEventReason",null,[]);class Vj{constructor(d,z){this.$f=d;this.Wab=z}ho(){this.$f.Uh(bc.a.OVg,fc.a.frame,Object(Aa.a)(this,this.YQk,"showRenameDialogAction"))}YQk(d,z,T){d=32;if(1===T)return kb.SessionStatusManager.instance.zmb||wa.AFrameworkApplication.oha?8:32;2===T&&(32!==this.$f.gl(bc.a.renameFile,1)?(this.$f.gl(bc.a.Txb,2),d=8):32===this.$f.gl(bc.a.f9b,1)?this.$f.gl(bc.a.f9b,2):this.Wab.value.create().Ose());return d}}Object(Va.a)(Vj,"RenameDialogActor",
null,[651]);var dl=a(240);class Th{constructor(d,z,T){this.dialog=null;this.$f=d;this.oI=z;this.nfc=T}QUi(){const d={};d.nameInputProps={["type"]:"AppInputProps",["id"]:Th.RCd,["label"]:Object(tg.a)("RenameDialogLabel"),["value"]:Lb.a.Dz(this.oI.Jv),["maxLength"]:this.nfc};return d}Ose(){const d={["id"]:"RenameDialog",["bodyControls"]:this.QUi()};this.dialog=new dl.a(!1,!1,!0);this.dialog.Ph=1;this.dialog.kl="RenameDialog";this.dialog.initializeAndShow(Object(tg.a)("RenameDialogTitle"),Object(Aa.a)(this,
this.dpk,"renameDialogHandler"),d)}dpk(d,z){z&&1===d&&z[Th.RCd]&&(d=Lb.a.Dz(this.oI.Jv),z=(z[Th.RCd]||"").trim(),z!==d&&""!==z&&this.$f.ek(bc.a.renameFile,2,z))}}Th.RCd="txtDocumentName";Object(Va.a)(Th,"RenameDialog",null,[658]);class Nj{constructor(d){this.ksa=null;this.nfc=0;this.$f=d;this._initialized=!1}initialize(d,z){this.ksa=d;this.nfc=z;this._initialized=!0}create(){return this._initialized?new Th(this.$f,this.ksa,this.nfc):null}}Object(Va.a)(Nj,"RenameDialogFactory",null,[650]);var wl=a(97);
class hj{constructor(d,z){this.$f=d;this.Wi=z}ho(){this.$f.Uh(bc.a.f9b,fc.a.frame,Object(Aa.a)(this,this.ZQk,"showRenameFlyoutAction"))}CTh(){return Od.d("setDocumentTitleFlyoutOpened")&&wa.AFrameworkApplication.ra.$g.Ew}ZQk(d,z,T){if(1===T)return this.CTh()?32:8;wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DocumentInlineRenameEnabled",!1)?(this.Wi.E7(Ei.AFrame.ERd,!1),appChrome.getHeaderApi().then(ya=>{ya.focusDocumentTitle()})):appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));
return 32}$zh(){hj.urj&&wa.AFrameworkApplication.ILa&&wl.TaskManager.instance.jm(new bb.a(5,1,5E3,()=>{32===this.$f.gl(bc.a.f9b,1)&&this.Wi&&this.Wi.currentScope.name===Ei.AFrame.n0&&(Fb.a("RenameFloatieShownOnNewDocumentLoad",!0),this.$f.gl(bc.a.f9b,2))}))}static get urj(){hj.Mgc&&null!=hj.Mgc||(ra.a.DA("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),hj.Mgc=wa.AFrameworkApplication.fa?wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",
!1):!1);return hj.Mgc}}hj.Mgc=null;Object(Va.a)(hj,"RenameFlyoutActor",null,[648]);class sj{constructor(d,z,T,ya,sb){this.z9c=sb;this.GPe=T;this.FPe=ya;this.lvh=d;this.GDb=z}get FI(){return this.z9c.value}WKf(){if(!this.FPe())return 5;if(this.GDb())return 1;if(this.FI){if(this.GPe&&!this.FI.frf)return 3;if(!this.GPe&&!this.FI.XQb)return 4}return this.lvh()?0:2}}Object(Va.a)(sj,"RenameProps",null,[647]);var ei=a(106);class wj{constructor(d,z,T,ya,sb,cc){this.xF=!1;this.gfd=new ei.a;this.dbb=z;this.WW=
T;this.Vih=ya;this.Ga=sb;this.XYe=cc}enable(){this.xF||(this.Y4g(),this.Vue(),this.xF=!0)}generateKey(d,z,T){return String.format("{0}/{1}/{2}",T,d,z)}NOi(){const d=Lb.a.Dz(this.dbb().Jv);return this.generateKey(this.dbb().breadcrumbFolderName,this.dbb().breadcrumbFolderUrl,d)}OOi(d,z,T){return d&&z?this.generateKey(d,z,T):T}ifi(d,z,T){return d&&d!==this.dbb().breadcrumbFolderName||z&&z!==this.dbb().breadcrumbFolderUrl?!0:T!==Lb.a.Dz(this.dbb().Jv)}Y4g(){const d=this.NOi();this.gfd.ga(d,new Date)}yce(d){this.YLk(d)&&
this.N0e(d)}YLk(d){const z=this.Vih();return z?this.XYe&&this.XYe.MWb||!z.rZf||!wa.AFrameworkApplication.lZa?(this.FYg(d),this.xF=!1):!0:!1}Vqg(d,z,T,ya){const sb=this.ifi(d,z,T),cc=this.OOi(d,z,T);d=(()=>this.gfd.wj(cc))().returnValue;sb&&!d&&(this.pPf(ya),ia.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.f3d));sb||this.gfd.ga(cc,this.WW())}}Object(Va.a)(wj,"ARenamedFileChecker",null,[627]);class Ek extends wj{constructor(d,z,T,ya,sb,cc,Fc,Wc){super(d,z,T,ya,sb,cc);this.hQf=(id,
Dd)=>{Dd&&Dd.g0b&&Dd.UMj&&(Dd.ipb("BreadcrumbDocName")||Dd.ipb("BreadcrumbFolderName")||Dd.ipb("BreadcrumbFolderUrl")||Dd.ipb("DirectInvokeDAVUrl")||Dd.ipb("EditDocInClientUrl"))&&(ia.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.f3d),this.yce(Dd))};this.aWe=sb;this.Brh=Fc;this.Omh=Wc}get f3d(){return"RenamedFileCheckerUsingSettingsRefresh"}Vue(){this.aWe.Fpd(this.hQf)}FYg(){this.aWe.FFg(this.hQf)}N0e(d){if(d&&d.g0b){const z=d.g0b;this.Vqg(z.Ya("BreadcrumbFolderName"),z.Ya("BreadcrumbFolderUrl"),
z.Ya("BreadcrumbDocName"),d)}}pPf(d){const z={OperationResult:0,classId:1};d=d.g0b;z.BreadcrumbFolderName=d.Ya("BreadcrumbFolderName");z.BreadcrumbFolderUrl=d.Ya("BreadcrumbFolderUrl");z.DirectInvokeDavUrl=d.Ya("DirectInvokeDAVUrl");z.EditDocInClientUrl=d.Ya("EditDocInClientUrl");d=d.Ya("BreadcrumbDocName");z.NewName=wa.AFrameworkApplication.pIa?d:Lb.a.Dz(d);this.Omh.execute(T=>{this.Yfj(z,T)})}Yfj(d,z){this.Brh().H1b(d,z)}}Object(Va.a)(Ek,"RenamedFileCheckerUsingSettingsRefresh",wj,[]);class lk extends wj{constructor(d,
z,T,ya,sb,cc,Fc,Wc,id,Dd){super(d,T,ya,sb,cc,id);this.EFb=this.flc=null;this.Jqh=z;this.$f=Fc;this.vk=Wc;Dd&&Dd.execute(ee=>{this.qjk(ee)})}get f3d(){return"RenamedFileCheckerUsingTask"}qjk(d){this.flc=d;this.flc.M4e(Object(Aa.a)(this,this.nTb,"handleVisibilityChange"))}nTb(d,z){!this.xF||0!==z.newState&&1!==z.newState||this.EFb||(this.Vue(),this.yce(this.EFb))}Vue(){this.EFb=new bb.a(3,2,this.Jqh(),Object(Aa.a)(this,this.yce,"performRenameFileCheckTick"),89);this.vk.jm(this.EFb)}FYg(d){this.vk.Px(d)}N0e(d){this.flc&&
2===this.flc.gll?this.ykk(d):wa.AFrameworkApplication.lZa(Object(Aa.a)(this,this.qQc,"onRefreshFilenameSuccess"),Object(Aa.a)(this,this.pQc,"onRefreshFilenameFailure"),!0)}ykk(d){this.vk.Px(d);this.EFb=null}qQc(d){d&&this.Vqg(d.BreadcrumbFolderName,d.BreadcrumbFolderUrl,d.NewName,null)}pPf(){this.$f.gl(bc.a.kyc,2)}pQc(){}}Object(Va.a)(lk,"RenamedFileCheckerUsingTask",wj,[]);class Fk{constructor(){this.Ga=this.Wh=null;this.XK=()=>{const d=wa.AFrameworkApplication.ra.$g.Ew;wa.AFrameworkApplication.QLa()&&
fj.instance.initialize(wa.AFrameworkApplication.jyc,d?null:wa.AFrameworkApplication.IYa,d?null:wa.AFrameworkApplication.Jje||Object(tg.a)("RenameFileTooltip"))&&(this.Wh.register(sj,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Ei(()=>new sj(()=>wa.AFrameworkApplication.userCanRename,()=>wa.AFrameworkApplication.isReadOnlyRecommended,wa.AFrameworkApplication.sVc,wa.AFrameworkApplication.QLa,new Rj.a(()=>wa.AFrameworkApplication.FI))).yi(),gj.instance.ho(),this.Ga.ka("RenameDialogIsEnabled")&&
(dg.a.instance.resolve("Common.App.Rename.RenameDialogFactory").initialize(wa.AFrameworkApplication.ju,wa.AFrameworkApplication.jyc),dg.a.instance.resolve("Common.App.Rename.IRenameDialogActor").ho()),Xk().ho(),wa.AFrameworkApplication.sVc&&Lj().enable(),Xk().$zh())}}get name(){return"Common.App.RenameFile"}$n(d){this.Wh=d;this.Ga=wa.AFrameworkApplication.fa;this.Wh.register(Vj,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Ei(()=>new Vj(wa.AFrameworkApplication.yh,
dg.a.instance.W5b("Common.App.Rename.RenameDialogFactory"))).yi();this.Wh.register(Nj,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Ei(()=>new Nj(wa.AFrameworkApplication.yh)).yi();this.Wh.register(627,"Common.App.Rename.IRenamedFileChecker").Ei(()=>this.p9h()).yi();this.Wh.register(hj,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Ei(()=>new hj(wa.AFrameworkApplication.yh,$h.FocusManager.instance())).yi()}p9h(){if(this.Ga.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const d=
Object(Yk.b)();if(d&&d.W1f)return new Ek(()=>d.Lj("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>wa.AFrameworkApplication.ju,()=>new Date,()=>wa.AFrameworkApplication.FI,d,dg.a.instance.Ho("Common.ISessionStatus"),()=>gj.instance,Object(Ri.a)())}return new lk(()=>this.Ga.Lj("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ga.Lj("RenamedFileCheckerPingIntervalInMs",12E4),()=>wa.AFrameworkApplication.ju,()=>new Date,()=>wa.AFrameworkApplication.FI,wa.AFrameworkApplication.fa,wa.AFrameworkApplication.yh,
wa.AFrameworkApplication.Lp,dg.a.instance.Ho("Common.ISessionStatus"),Object(S.a)())}init(){this.Ga.Yx(this.XK)}dispose(){}}Object(Va.a)(Fk,"PackageManager",null,[11,12]);var xj=a(77),Wj=a(256);class Xj extends bg.a{constructor(d){super();this.KHa=this.renameFileManager=null;this.$=d;this.gm()}create(){if(!this.KHa){const d=Wj.a.hib(gh.b(),this.ya,"Task","IRenameFileManager");this.KHa=d.task;const z=oc.nd.Aa()?Object(Cf.d)(zc.a.resolve(oc.nd,{va:this.xh})):xj.GetServiceTaskFactory.create(this.$.la,
137,this.ya,this.xh),T=Object(Cf.d)(zc.a.resolve(oc.cb,{va:this.xh}));Ug.TaskExtensions.Xa(Ug.TaskExtensions.Vo([T,z],this.ya),()=>{const ya=new Xc(this.$,z.result);this.$.la.Hh(120,ya);d.setResult(ya)},this.ya,3)}this.KHa.continueWith(d=>{this.Bk(d.result)})}dispose(){nb.a.dh(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static Ba(d){d.la.Hh(119,new Xj(d))}}Object(Va.a)(Xj,"RenameFileManagerServiceFactory",bg.a,[]);var el=a(1077);class Ej extends bg.a{constructor(){super();
this.gm()}create(){this.Bk(new el.a)}}Object(Va.a)(Ej,"CommonUIJsServiceFactory",bg.a,[]);var mk=a(1189),Gk=a(1174);class tj{}Object(Va.a)(tj,"LokiTokenResult",null,[]);class yj{constructor(d){this.Vhc=d}RMd(){const d=this.BPi();return d?yj.ZWb?new Promise((z,T)=>{this.Vhc.continueWith(()=>{this.Vhc.mo||this.Vhc.Hm?T(Error.create("Error downloading auth library")):this.Vhc.result.gE("Loki",d).then(ya=>{ya=wa.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.EPi():ya.IsSuccess&&
ya.Token?Object.assign(new tj,{isSuccess:!0,token:ya.Token,errorMessage:null}):Object.assign(new tj,{isSuccess:!1,token:null,errorMessage:JSON.stringify(ya)});z(ya);return ya})})}):Promise.resolve(Object.assign(new tj,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new tj,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Gk.a.eEf())}))}EPi(){const d=wa.AFrameworkApplication.fa.Ya("LokiUserDataSignature")||
"";return Object.assign(new tj,{isSuccess:!0,token:d,errorMessage:null})}BPi(){let d=null;const z=Gk.a.Pzc();2===z?d=wa.AFrameworkApplication.fa.Ya("LokiAADAppId"):1===z&&(d=wa.AFrameworkApplication.fa.Ya("LokiMSAAppId"));return d}static get ZWb(){return wa.AFrameworkApplication.fa.ka("IsO365CommercialHost")||wa.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(Va.a)(yj,"LokiTokenManager",null,[626]);var nk=a(605);class Yj{get name(){return"Common.App.LivePersonaUtils"}init(){Object(mk.a)()}dispose(){}$n(d){d.register(yj,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").yi().Ei(()=>new yj(nk.a.gw(Object(Ph.a)())))}static main(){Lc.a.instance.Do(new Yj)}}Object(Va.a)(Yj,"LivePersonaUtilsPackage",null,[11,12]);const Hk=()=>dg.a.instance.fj("Common.App.HostNotification.EditNotificationEventSource");class ok{constructor(d){this.kta=this.cta=this.cla=this.iea=null;this.Rbd=this.$ab=this.Iec=this.Qfc=this.KQe=this.FG=this.VT=!1;this.Oid=this.bRe=null;this.SQe=0;this.Ga=this.ZDb=null;this.Kda=
d;this.qF=3;this.yDb=this.CEa=!0}initialize(d,z,T){this.iea=this.mOd(d,z);this.cla=Object(tg.a)("SavingStatus");this.cta=Object(tg.a)("ReadOnlyStatus");this.kta=Object(tg.a)("ReviewModeStatus");this.Kda&&this.Kda.execute(ya=>{ya.Apd(Object(Aa.a)(this,this.ebc,"updateToSavingStatus"))});this.FG=!0;this.Ga=T;this.Iec=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);this.$ab=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",
!1);return!0}Fra(d,z){this.VT=d;this.qF=z;this.O2(this.CEa)}O2(d){!this.CEa&&d&&(this.ZDb=new Date);this.CEa=d;this.Rbd=!1;d=null;3===this.qF&&(d=this.CEa?this.iea:this.cla);this.$ab&&this.Qfc&&(this.iea=Object(tg.a)("SavedStatus"));this.nqf(d)}E3c(d){!this.yDb&&d&&(this.ZDb=new Date);this.yDb=d;this.Rbd=!1;d=null;3===this.qF&&(d=this.yDb?this.iea:this.cla);this.nqf(d)}mOd(d,z){return d?String.format(Object(tg.a)("SavedToStatus"),Object(tg.a)("OneDriveName")):z&&z.length?String.format(Object(tg.a)("SavedToStatus"),
z):Object(tg.a)("SavedStatus")}ebc(){this.O2(!1)}cNd(){switch(this.qF){case 1:return this.cta;case 2:return this.kta;default:return null}}getMode(){if(3!==this.qF)switch(this.qF){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.Rbd?"FailedToSave":this.CEa&&this.yDb?"Saved":"Saving"}Njj(d){return this.KQe===this.VT&&this.SQe===this.qF&&this.bRe===d}wCd(d){appChrome.getHeaderApi().then(z=>{z.updateDocumentTitleStatus(this.VT,d,this.cNd(),this.ZDb,this.CEa&&this.yDb,
this.Iec||this.$ab?z.getHeaderSaveStatusIconProps(this.getMode(),!1):null);"Saved"===this.getMode()&&this.$ab&&(this.Gjd&&(window.clearTimeout(this.Gjd),this.Gjd=null),this.Ijd&&(window.clearTimeout(this.Ijd),this.Ijd=null),this.Gjd=window.setTimeout(()=>{z.updateDocumentTitleStatus(this.VT,d,this.cNd(),this.ZDb,this.CEa,this.Iec||this.$ab?z.getHeaderSaveStatusIconProps(this.getMode(),!0):null)},500),this.Qfc&&(this.Ijd=window.setTimeout(()=>{z.updateDocumentTitleStatus(!0,d,this.cNd(),this.ZDb,this.CEa,
this.Iec||this.$ab?z.getHeaderSaveStatusIconProps(this.getMode(),!0):null)},3E3)));this.Qfc=!0;return null});this.Oid=null}nqf(d){this.FG&&Od.c()&&!this.Njj(d)&&(!this.Qfc&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.wCd(d):Mj.a.L5b()?(this.Oid&&ia.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.Oid=window.requestIdleCallback(()=>{this.wCd(d)})):window.requestAnimationFrame(()=>{this.wCd(d)}),
this.KQe=this.VT,this.bRe=d,this.SQe=this.qF)}}Object(Va.a)(ok,"ReactSaveStatusUIHandler",null,[646]);class Ik{constructor(d,z){this.Aw=null;this.iea=Object(tg.a)("SavedStatus");this.cla=Object(tg.a)("SavingStatus");this.cta=Object(tg.a)("ReadOnlyStatus");this.kta=Object(tg.a)("ReviewModeStatus");this.Zfc=z;this.Kda=d;this.qF=3;this.wFa=!0}ZE(){this.Kda&&this.Kda.execute(d=>{d.Apd(Object(Aa.a)(this,this.ebc,"updateToSavingStatus"))});this.Zfc.execute(d=>{this.Aw=d})}Fra(d,z){this.qF=z;3===z?this.O2(this.wFa):
2===z?this.Mye(this.kta):this.Mye(this.cta)}ebc(){this.O2(!1)}O2(d){this.wFa=d;this.Mye(this.wFa?this.iea:this.cla)}Mye(d){this.Aw&&this.Aw.sendMessage(ub.a.w4k,this.c1h(d))}c1h(d){const z={};z.StatusText=d;return z}}Object(Va.a)(Ik,"SaveStatusPostMessageHandler",null,[646]);var fl=a(132),Jk=a(68);class pk{constructor(d,z,T,ya){this.kta=this.cta=this.cla=this.iea=null;this.NTa=0;this.eO=this.Fjd=this.eSa=this.V7c=this.RUa=null;this.kk=d;this.Gka=z;this.Kda=T;this.Hq=ya;this.UOe=!0;this.VT=!1;this.qF=
3;this.wFa=!0}initialize(d,z){if(!this.kk)return!1;this.iea=this.mOd(d,z);this.cla=Object(tg.a)("SavingStatus");this.cta=Object(tg.a)("ReadOnlyStatus");this.kta=Object(tg.a)("ReviewModeStatus");this.ZE();return!0}mOd(d,z){return d?String.format(Object(tg.a)("SavedToStatus"),Object(tg.a)("OneDriveName")):z&&z.length?String.format(Object(tg.a)("SavedToStatus"),z):Object(tg.a)("SavedStatus")}ZE(){this.Gka&&this.Gka.execute(d=>{d.SDh(Object(Aa.a)(this,this.smf,"createStatusAndModeElements"));d.LDh(Object(Aa.a)(this,
this.EPk,"showHideSaveStatusElement"));d.P0k&&this.smf(null,null)});this.Kda&&this.Kda.execute(d=>{d.Apd(Object(Aa.a)(this,this.ebc,"updateToSavingStatus"))})}mF(){this.eO&&this.kk&&this.kk.vQ(this.eO)}EPk(d,z){this.Fra("true"===z,this.qF)}Fra(d,z){this.VT=d;this.qF=z;this.V7c&&(this.V7c.style.display=this.VT||3===this.qF||!this.RUa?"none":"");this.eSa&&(this.eSa.style.display=this.VT||3===this.qF?"none":"",this.eSa.innerText=1===this.qF?this.cta:this.kta,this.eSa.title=1===this.qF?Object(tg.a)("ReadOnlyStatusTooltip"):
Object(tg.a)("ReviewModeStatusTooltip"));this.Fjd&&(this.Fjd.style.display=this.VT||1===this.qF||!this.RUa&&!this.eSa?"none":"");this.eO&&(this.eO.style.display=this.VT||1===this.qF?"none":"",this.O2(this.wFa),this.eO.title=Object(tg.a)("SaveStatusTooltip"))}smf(d,z){d=document.getElementById(rj.a.LRf);z&&z.Sel||!d||""===this.iea||""===this.cla||""===this.cta||""===this.kta||(this.RUa=document.getElementById(rj.a.rpc),this.V7c=rj.a.FHa(d,"BreadcrumbAppModeDash","-",null,!1),this.eSa=rj.a.FHa(d,"BreadcrumbAppModeStatus",
1===this.qF?this.cta:this.kta,null,!1),this.M5g(this.eSa),this.Fjd=rj.a.FHa(d,"BreadcrumbSaveStatusDash","-",null,!1),this.eO=rj.a.FHa(d,"BreadcrumbSaveStatus",this.iea,null,!1),this.M5g(this.eO),this.Fra(this.VT,this.qF))}ebc(){this.O2(!1)}O2(d){this.wFa=d;this.m$k(this.wFa?this.iea:this.cla)}m$k(d){!this.eO||3!==this.qF&&2!==this.qF||(this.UOe&&!this.wFa?(this.NTa=this.eO.offsetWidth<this.NTa?this.NTa:this.eO.offsetWidth,this.G6k(this.cla),this.UOe=!1):this.eO.innerText=d)}M5g(d){d.style.direction=
this.Hq?"rtl":"ltr";d.style.width="auto";d.style.textAlign=this.Hq?"right":"left";d.style.display=this.VT?"none":"";d.setAttribute("Unselectable","on")}G6k(d){this.eO&&(this.eO.style.width="",this.eO.innerText=d,this.NTa=this.eO.offsetWidth<this.NTa?this.NTa:this.eO.offsetWidth,d=fl.a.CE(this.eO),this.eO.style.width=this.NTa-Jk.a.oN(d.paddingLeft)-Jk.a.oN(d.paddingRight)+1+"px")}}Object(Va.a)(pk,"SaveStatusUIHandler",null,[646]);var xl=a(108);class gl{constructor(){this.Hjd=this.zid=this.wUa=this.Wh=
null;this.XK=()=>{const d=wa.AFrameworkApplication.fa,z=!!wa.AFrameworkApplication.ra.$g&&4===wa.AFrameworkApplication.ra.$g.kn;if(d.ka("WordEditorAutoSaveImprovementIsEnabled")||d.ka("PptEditorSaveStatusInHeaderEnabled")||z&&d.ka("SimplifiedReactRibbonUxIsEnabled")||d.ka("ExcelSaveStatusInHeaderEnabled")||d.ka("VisioSaveStatusInHeaderEnabled"))wa.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&wa.AFrameworkApplication.hideHeaderEmbedded?(this.Hjd=dg.a.instance.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&
this.Hjd.ZE():wa.AFrameworkApplication.ra.$g.n3f||wa.AFrameworkApplication.hideHeader||(wa.AFrameworkApplication.ra.$g.Ew?(this.zid=dg.a.instance.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.zid.initialize(d.ka("IsSkyDrive"),d.Ya("HostNameToIncludeInSavedStatus"),wa.AFrameworkApplication.fa):(this.wUa=dg.a.instance.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.wUa.initialize(d.ka("IsSkyDrive"),d.Ya("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}$n(d){this.Wh=
d;wa.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&wa.AFrameworkApplication.hideHeaderEmbedded?this.Wh.register(Ik,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").yi().Ei(()=>new Ik(Hk(),Object(Ri.a)())):wa.AFrameworkApplication.ra.$g.n3f||(wa.AFrameworkApplication.ra.$g.Ew?this.Wh.register(ok,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").yi().Ei(()=>new ok(Hk())):this.Wh.register(pk,
"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").yi().Ei(()=>new pk(xl.EventHandlerManager.instance,Bk(),Hk(),wa.AFrameworkApplication.isRtl)))}init(){wa.AFrameworkApplication.fa.Yx(this.XK)}dispose(){this.wUa&&this.wUa.mF()}}Object(Va.a)(gl,"PackageManager",null,[11,12]);class Kk{constructor(d,z){this.iXe=this.hdd=!1;this.QNa=(T,ya)=>{(null===ya||void 0===ya?0:ya.EM)&&na.a.vJh([ya.EM])&&(this.D6b=!0)};this.$t=()=>{this.D6b=!1};this.ij=(T,ya)=>{Qc.b(ya)&&
this.Fra(!0);this.D6b=!1};this.Cj=()=>{this.f1=this.$.f1;this.Fra()};this.Jpg=()=>{this.O2()};this.Pog=()=>{this.f1=this.$.f1};this.Y8d=()=>{cd.f(this.$).za.ux(this.Y8d);this.f1=this.$.f1};this.Sia=z;this.$=d;this.$.userOperationManager.mw(this.Pog);this.$.mr(this.Cj);this.$.ea.vEh(this.Jpg);this.$.ea.$q(this.ij);this.$.Tmc(this.QNa);this.$.ea.oO(this.$t);this.Fra()}get tvj(){return this.$.ea?this.$.ea.k6f:!1}get f1(){return this.hdd}set f1(d){d?this.hdd=!0:cd.f(this.$)&&cd.f(this.$).za&&(cd.f(this.$).za.l6()?
this.hdd=!1:cd.f(this.$).za.ny(this.Y8d));this.O2()}get D6b(){return this.iXe}set D6b(d){this.iXe=d;this.O2()}dispose(){this.$&&(this.$.Wr(this.Cj),this.$.jVc(this.QNa),this.$.userOperationManager&&this.$.userOperationManager.uu(this.Pog),this.$.ea&&(this.$.ea.ook(this.Jpg),this.$.ea.Uq(this.ij),this.$.ea.aQ(this.$t)),cd.f(this.$)&&cd.f(this.$).za&&cd.f(this.$).za.ux(this.Y8d))}Fra(d){d=!this.$.isEditMode||(void 0===d?!1:d);this.Sia.Fra(d,this.$.isEditMode?3:1);this.O2()}O2(){this.$.isEditMode&&this.Sia.O2(!this.f1&&
!this.tvj&&!this.D6b)}}Object(Va.a)(Kk,"SaveStatusManager",null,[4]);class qk extends bg.a{constructor(d){super();this.pj=d;this.gm()}create(){const d=dg.a.instance;d.fj("Common.App.SaveStatus.ISaveStatusUIHandler").execute(z=>{const T=new Kk(this.pj,z);d.register(Kk,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").yi().Ei(()=>T);z=Object(rg.a)(this.pj.la,300,()=>d.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.Bk(z)})}static Ba(d){d.la.Hh(299,
new qk(d))}}Object(Va.a)(qk,"SaveStatusFactory",bg.a,[]);var hl=a(1379),il=a(592),jl=a(664),Yh=a(488),Lk=a(432),yl=a(1191);class Mk{Y8h(d,z){if(d&&!(1>d.length)&&z){var T=Object.assign(new Lk.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.k6h(d,T.ControlList);z.push(T)}}k6h(d,z){const T=Object.assign(new jl.a,{ExternalId:"ContextCoauthors",LabelText:Object(tg.a)("PresenceMenuSectionTitle"),Menu:Object.assign(new Yh.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});
Array.add(z,T);z=Object.assign(new Lk.a,{Title:"",ControlList:[]});Array.add(T.Menu.MenuSectionList,z);this.B8h(d,z.ControlList)}B8h(d,z){for(let T=0;T<d.length;T++){const ya=Object.assign(new yl.a,{ExternalId:String.format("CoauthorPersona_{0}",T),Command:"336231556",DisplayName:d[T].userName,LabelText:d[T].userName,ImageBackColor:d[T].color,PersonaId:d[T].email,IsAnonymous:d[T].isAnonymous});Array.add(z,ya)}}}Object(Va.a)(Mk,"PresenceContextMenuSectionBuilder",null,[623]);var kl=a(1192),Nk=a(657);
class Ok{constructor(d,z,T,ya){this.YHe=this.Ada=this.Aq=this.SN=this.gka=null;this.hLh=()=>{this.dkc.a$e()};this.zD=sb=>{1===sb?(Nk.a.sia(),this.showDialog(Object(tg.a)("AuthenticationLostSigninInProgressMessage")),wa.AFrameworkApplication.yh.gl(bc.a.R1d,2)):(this.y8a(),wa.AFrameworkApplication.yh.gl(bc.a.xdf,2))};this.NQh=()=>{this.Hfi();wa.AFrameworkApplication.yh.gl(bc.a.wdf,2)};this.dkc=d;this.Vsh=ya;this.dkc.g1a&&(this.Aq=new bb.a(3,2,5E3,this.hLh,2),wa.AFrameworkApplication.Lp.jm(this.Aq),
this.ho(z,T));this.dkc.VHb(()=>{this.khg()});this.dkc.Deb(()=>{this.lhg()})}get businessBar(){return this.Ada||(this.Ada=Object(kl.a)())}get vbf(){return this.YHe||(this.YHe=dg.a.instance.Ho("CommonUI.IBusinessBarEntryFactory"))}ho(d,z){const T=wa.AFrameworkApplication.yh;T.dl(bc.a.authenticationLost,fc.a.frame,d,96);T.dl(bc.a.b$e,fc.a.frame,z,96);T.Uh(bc.a.wdf,fc.a.frame,Sb.ActionManager.KCd);T.Uh(bc.a.xdf,fc.a.frame,Sb.ActionManager.KCd);T.Uh(bc.a.R1d,fc.a.frame,Sb.ActionManager.KCd)}khg(){this.showDialog(Object(tg.a)("AuthenticationLostMessage"));
wa.AFrameworkApplication.yh.gl(bc.a.authenticationLost,2)}lhg(){this.vYk();wa.AFrameworkApplication.yh.gl(bc.a.b$e,2)}vYk(){this.SN&&(this.SN.hide(),this.SN.dispose(),this.SN=null);this.gka&&this.businessBar&&(wa.AFrameworkApplication.Xl||this.businessBar.removeEntry(this.gka),this.gka.dispose(),this.gka=null)}showDialog(d){nb.a.dh(this.SN);this.SN=new qj.a;this.Vsh||(this.SN.GC=!1,this.SN.Ph=0);this.SN.ti(1,Object(tg.a)("SignIn"));this.SN.pW(Object(tg.a)("DefaultDialogTitle"),d,this.zD)}y8a(){this.businessBar&&
this.vbf&&(this.gka=this.vbf.create(Object(tg.a)("AuthenticationLostTitle"),Object(tg.a)("AuthenticationLostMessage"),null),this.gka.closeable=!0,this.gka.addButton(Object(tg.a)("SignIn"),Ok.KQh,""),this.gka.LX=this.NQh,this.businessBar.EF(this.gka,!1))}Hfi(){this.Aq&&(wa.AFrameworkApplication.Lp.Px(this.Aq),this.Aq=null)}dispose(){this.Aq=this.SN=this.gka=null}static KQh(){Nk.a.sia();wa.AFrameworkApplication.yh.gl(bc.a.R1d,2)}}Object(Va.a)(Ok,"SignOutResponseUI",null,[4]);class Uh{get name(){return"Common.App.UI"}$n(d){d.register(Mk,
"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").yi()}init(){}dispose(){nb.a.dh(Uh.kea);Uh.kea=null}static main(){Lc.a.instance.Do(new Uh)}}Uh.kea=null;Object(Va.a)(Uh,"CommonAppUIPackage",null,[11,12]);var Aj=a(187),ll=a(713);class ml extends ll.a{constructor(){super()}dispose(){Aj.WacAirSpace.OUd()&&Aj.WacAirSpace.W1c()}animate(d,z,T,ya,sb){z&&Aj.WacAirSpace.LZ(d.element,z);Aj.WacAirSpace.animate(d,ya,sb);T&&Aj.WacAirSpace.Sjk(d.element,T)}}
Object(Va.a)(ml,"AnimationManager",ll.a,[4]);var nl=a(123);class Zj extends bg.a{constructor(d){super();this.$=d;this.gm()}create(){wa.AFrameworkApplication.fa.ka("RefreshAccessTokenSilently")?this.Bk(this.$5h()):this.Bk(this.$.la.kh(38)||this.$.la.Hh(38,new Ab(this.$)))}$5h(){var d=this.$.la.kh(38);if(d)return d;d=new xb(wa.AFrameworkApplication.Lp,wa.AFrameworkApplication.UF(),new Ec);return this.$.la.Hh(38,new Zc(this.$,d))}static Ba(d){d.la.Hh(39,new Zj(d))}}Object(Va.a)(Zj,"AccessTokenExpirationManagerFactory",
bg.a,[]);var zl=a(1193),Oj;(function(d){d[d.generalException=0]="generalException";d[d.invalidArgument=1]="invalidArgument";d[d.kfg=2]="notAllowed";d[d.Nnc=3]="apiNotAvailable";d[d.Z5k=4]="unresolvedPendingRequest";d[d.timeout=5]="timeout";d[d.cod=6]="adalTimeout";d[d.cBe=7]="userNotSignedIn";d[d.Wzb=8]="userAborted";d[d.GWg=9]="silentSignInFailed";d[d.ynb=10]="invalidResourceUrl";d[d.QFc=11]="invalidGrant";d[d.tif=12]="connectionLost";d[d.qrc=13]="clientError";d[d.serverError=14]="serverError"})(Oj||
(Oj={}));Object(Va.b)("ErrorCodes",Oj);a(1434);class ol{constructor(d,z){this.requestCallback=this.requestParameters=null;this.requestParameters=d;this.requestCallback=z}}Object(Va.a)(ol,"OutstandingRequest",null,[]);class ki{}ki.xKj="AADSTS50058";ki.ynb="AADSTS50001";ki.sKj="AADSTS65001";ki.LKj="AADSTS70011";ki.Wzb="13002";ki.f8j="Popup Window is null";ki.e8j="Popup Window closed";ki.cod="Token renewal operation failed due to timeout";ki.q0k="tokenRevoked";Object(Va.a)(ki,"WopiHostErrorType",null,
[]);var Pj=a(602),ak=a(671),Qj=a(1433);class pl{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(Va.a)(pl,"WopiIdentityInfo",null,[348]);class ql{constructor(d,z,T){this.expiration=this.authority=this.accessToken=null;this.accessToken=d;this.authority=z;this.expiration=T}}Object(Va.a)(ql,"WopiIdentityToken",null,[347]);class bk{constructor(d){this._initialized=!1;this.AYj=z=>{let T=null;try{const sb=z.Values[Kb.a.Bue],cc=z.Values[Kb.a.bUk],
Fc=z.Values[Kb.a.GXg],Wc=z.Values[Kb.a.jUk];let id=null,Dd=null;const ee=this.htb[sb];if("undefined"!==typeof ee&&ee){var ya=[];Array.add(ya,{name:Kb.a.Aue,string:ee.requestParameters.correlationId});eb.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:ya});T=ee.requestCallback;delete this.htb[sb];"undefined"!==typeof cc&&cc&&cc.length?Dd=new ql(cc,Fc,Wc):id=Oj[this.qEj(z)];ya="getAccessToken_"+sb;ya in this.y0c&&(this.y0c[ya].stop(),delete this.y0c[ya]);
T(Dd,id)}else ia.ULS.sendTraceTag(37856066,344,10,ph.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:sb}))}catch(sb){z=z.Values[Kb.a.Bue],z in this.htb&&delete this.htb[z],this.YLc(),ia.ULS.sendTraceTag(37856067,344,10,ph.c({["error"]:sb.message,["stack"]:sb.stack})),T&&T(null,"generalException")}};this.htb={};this.y0c={};this.SZ=wa.AFrameworkApplication.ra.yL;this.pSd=d}YYa(d){this._initialized||(d.kr(ub.a.Svg),d.aq(ub.a.Svg,this.AYj),this._initialized=!0)}getAccessToken(d,
z,T){T=void 0===T?null:T;this.vV(d,z);return new Promise((ya,sb)=>{if(this.NUd(z))if(z in this.htb)sb("unresolvedPendingRequest");else{var cc=window.setTimeout(()=>{ia.ULS.sendTraceTag(37856032,344,10,ph.c({["error"]:"Request timeout.",["callerId"]:z}));sb("timeout")},12E4);this.OJd(d,z,T,(Fc,Wc)=>{window.clearTimeout(cc);Fc?ya(Fc):(ia.ULS.sendTraceTag(37856033,369,15,ph.c({["error"]:Oj[Wc]})),sb(Wc))})}else ia.ULS.sendTraceTag(37856034,344,10,ph.c({["error"]:"Caller is not allowed."})),sb("notAllowed")})}getPrimaryIdentityInfo(d){return new Promise((z,
T)=>{this.NUd(d)?this.wTi((ya,sb)=>{ya?z(ya):(ia.ULS.sendTraceTag(37856064,369,10,ph.c({["error"]:sb.toString()})),T(sb))}):(ia.ULS.sendTraceTag(37856065,344,10,ph.c({["error"]:"Caller is not allowed."})),T("notAllowed"))})}getAuthContext(d){return new Promise((z,T)=>{const ya=this.getAuthContextSync(d);ya?z(ya):T("notAllowed")})}getAuthContextSync(d){if(this.NUd(d)){const z=new Qj.a;z.upn=wa.AFrameworkApplication.fa.Ya("UserPrincipalName");z.userId=wa.AFrameworkApplication.fa.Ya("LoggableUserId");
z.authority=wa.AFrameworkApplication.fa.Ya("HostAuthAuthority");z.tenantId=wa.AFrameworkApplication.fa.Ya("TenantId");z.isAnonymous=wa.AFrameworkApplication.fa.ka("IsAnonymousUser");z.supportsAuthToken=this.W8i(d);d=wa.AFrameworkApplication.fa.Ya("HostAuthType");z.authorityType="aad"===d.toLowerCase()?2:"msa"===d.toLowerCase()?1:0;return z}ia.ULS.sendTraceTag(40751647,344,10,ph.c({["error"]:"Caller is not allowed."}));return null}W8i(d){const z=Pj.a.cUb,T=wa.AFrameworkApplication.fa.Ya(wa.AFrameworkApplication.a_);
return"teams"===(null===T||void 0===T?void 0:T.toLowerCase())||xf.a.ZLa?z&&Pj.a.G_g?Array.contains(Pj.a.G_g,d.toLowerCase()):!1:z}OJd(d,z,T,ya){var sb=[];Array.add(sb,{name:"CallerId",string:z});Array.add(sb,{name:Kb.a.Aue,string:d.correlationId});eb.a.sendTelemetryEvent({name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:sb});sb=ak.a.create().toString();const cc="getAccessToken_"+sb,Fc=this.SZ.Li("ComponentAttach",cc);this.y0c[cc]=Fc;const Wc={};Wc[Kb.a.Bue]=sb;Wc[Kb.a.gUk]=
d.resource;Wc[Kb.a.hUk]=d.scope;Wc[Kb.a.GXg]=wa.AFrameworkApplication.fa.Ya("HostAuthType");Wc[Kb.a.kUk]=wa.AFrameworkApplication.fa.Ya("UserPrincipalName");Wc[Kb.a.iUk]=d.silentLogin;Wc[Kb.a.dUk]=d.options;Wc[Kb.a.Aue]=d.correlationId;Wc[Kb.a.eUk]=z;T&&(Wc[Kb.a.addinName]=T.AddinName,Wc[Kb.a.cUk]=T.AddinTrustId);this.pSd.execute(id=>{this.YYa(id);id.sendMessage(ub.a.getAuthToken,Wc)});this.htb[sb]=new ol(d,ya)}wTi(d){const z=wa.AFrameworkApplication.fa.Ya("UserName"),T=wa.AFrameworkApplication.fa.Ya("UserPrincipalName"),
ya=wa.AFrameworkApplication.fa.Ya("LoggableUserIdSpace"),sb=new pl;sb.email=T;sb.displayName=z;switch(ya){case "OrgIdPuid":sb.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":sb.authority="MicrosoftAccount";break;default:sb.authority=ya}d(sb,null)}NUd(d){var z=wa.AFrameworkApplication.y0i();d=d.toLowerCase();for(const T of z)if(d===T.toLowerCase())return!0;z=Pj.a.ard;for(const T in z)if(d===z[T].toLowerCase())return!0;return!1}qEj(d){d=d.Values[Kb.a.fUk];this.YLc();ia.ULS.sendTraceTag(39068821,
344,50,ph.c({["error"]:d}));return d?-1<d.indexOf(ki.xKj)?9:-1<d.indexOf(ki.f8j)||-1<d.indexOf(ki.e8j)?12:-1<d.indexOf(ki.ynb)?10:-1<d.indexOf(ki.Wzb)?8:-1<d.indexOf(ki.LKj)||-1<d.indexOf(ki.sKj)||d===ki.q0k?11:-1<d.indexOf(ki.cod)?6:0:13}vV(d,z){d=this.Igk(d.resource);ia.ULS.sendTraceTag(39921882,344,50,ph.c({["callerId"]:z,["resource"]:d}))}YLc(){ia.ULS.sendTraceTag(39068822,344,50,ph.c({["userAgent"]:window.navigator.userAgent}))}Igk(d){return(d?d:"").replace("://","__").replace(RegExp("\\.","g"),
"_dot_").replace("/","\\")}}Object(Va.a)(bk,"WopiIdentityManager",null,[317]);class ck{constructor(){this.Wh=null;this.XK=()=>{try{dg.a.instance.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(d){ia.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+d)}}}get name(){return"Common.App.WopiIdentity"}$n(d){this.Wh=d;d.register(bk,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").yi().Ei(()=>new bk(Object(Ri.a)()))}init(){wa.AFrameworkApplication.fa&&
wa.AFrameworkApplication.fa.Yx(this.XK)}dispose(){}static main(){Lc.a.instance.Do(new ck)}}Object(Va.a)(ck,"WopiIdentityPackage",null,[11,12]);const rl=()=>dg.a.instance.resolve("Common.App.FloatPane.IFloatPaneActor");class Pk{constructor(d,z,T){this.HUa=null;this.S8b=()=>{this.HUa=null;ia.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.hMe.display()};this.mPk=(ya,sb,cc,Fc,Wc)=>ya!==bc.a.S8b?2:1===cc?32:2===cc&&Wc?(ia.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",
Wc),Wc?this.ZCg():(this.HUa?(ia.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.vk.Px(this.HUa)):(ia.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.hMe.remove(null)),this.HUa=null),32):8;this.vk=d;this.$f=z;this.hMe=T.create()}ZCg(){this.HUa?ia.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(ia.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.HUa=new bb.a(2,1,3E4,this.S8b,
67),this.vk.jm(this.HUa))}u6a(){this.$f.Uh(bc.a.S8b,fc.a.frame,this.mPk)}}Object(Va.a)(Pk,"FloatPaneActor",null,[621]);var rk=a(169);class sk{constructor(d,z,T,ya,sb){this.vfd=this.hDb=this.$ic=this.dta=this.v_=this.rF=this.I8c=this.eX=this.$Eb=this.kEb=this.lEb=this.Xad=null;this.mWj=()=>{const cc=this.Ga.Lj("O365AdPaneShowingDuration",60);this.ftc();this.eX.style.display="block";this.eX.style.height=this.v_.height+"px";this.hDb=new bb.a(2,1,1E3*cc,Object(Aa.a)(this,this.hide,"hide"),67);this.vk.jm(this.hDb);
this.aEg()};this.lWj=()=>{ia.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.aEg();this.v_=null};this.epg=()=>{ia.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.hDb&&this.vk.Px(this.hDb);this.hide();return!0};this.vk=z;this.Ga=d;this.zu=T;this.Wh=sb;this.OW=ya}ftc(){this.eX=document.createElement("div");this.eX.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");
this.eX.style.width=this.v_.width+"px";(this.vfd=this.yRi(this.OW))?(this.dta=document.createElement("a"),this.dta.setAttribute(cg.a.ik,cg.a.qz),this.zu.xa(Z.a.click,this.dta,this.epg),this.dta.href=this.vfd,this.dta.target="_blank",this.dta.appendChild(this.v_),this.eX.appendChild(this.dta)):this.eX.appendChild(this.v_);this.rF=document.createElement("a");this.rF.setAttribute(cg.a.ik,cg.a.FF);this.rF.className="StandardButton WACFloatPaneCloseButton";this.rF.title=Object(tg.a)("Close");this.rF.tabIndex=
-1;this.I8c=rk.a(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.I8c.setAttribute(cg.a.ik,cg.a.qz);this.rF.appendChild(this.I8c);this.zu.xa(Z.a.click,this.rF,this.onClose);this.eX.appendChild(this.rF);this.$Eb.appendChild(this.eX)}UNi(d){const z=this.Ga.ka("O365PromotionHasStarted");switch(d){case 2:return Lh.a.rHa(String.format("adppt{0}.png",z?"sale":""));case 1:return Lh.a.rHa(String.format("adxls{0}.png",z?"sale":""));case 3:return Lh.a.rHa(String.format("addoc{0}.png",
z?"sale":""))}return null}yRi(d){const z=this.Ga.Ya("O365AdPaneRedirectedURL");switch(d){case 1:return String.format(z,"Excel");case 2:return String.format(z,"PowerPoint");case 3:return String.format(z,"Word")}return null}hide(d){this.hDb=null;this.eX&&!this.$ic&&((void 0===d?0:d)?ia.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):ia.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.eX.className=String.format("{0} {1}","WACFloatPane",
"WACFloatPaneFadeOut"),this.eX.style.height="0px",this.$ic=new bb.a(2,1,1E3,Object(Aa.a)(this,this.remove,"remove"),67),this.vk.jm(this.$ic))}remove(){this.eX&&this.$Eb&&(this.dta&&this.zu.Qa(Z.a.click,this.dta,this.epg),this.zu.Qa(Z.a.click,this.rF,this.onClose),this.$Eb.removeChild(this.eX),this.eX=null);this.$ic=null}display(){if(this.Xad=dg.a.instance.Ho("Common.IFloatPaneContainer"))if(this.$Eb=this.Xad.container){var d=this.UNi(this.OW);d?(ia.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",
d),this.v_=document.createElement("img"),this.v_.className="WACFloatPaneImage",this.lEb=this.mWj,Ha.a.addHandler(this.v_,Z.a.load,this.lEb),this.kEb=this.lWj,Ha.a.addHandler(this.v_,Z.a.error,this.kEb),this.v_.src=d):ia.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else ia.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else ia.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}aEg(){this.lEb&&
this.v_&&Ha.a.removeHandler(this.v_,Z.a.load,this.lEb);this.lEb=null;this.kEb&&this.v_&&Ha.a.removeHandler(this.v_,Z.a.error,this.kEb);this.kEb=null}dispose(){this.hide()}}Object(Va.a)(sk,"FloatPane",null,[641]);class dk{constructor(d,z,T,ya,sb){this.vk=z;this.Ga=d;this.zu=T;this.Wh=sb;this.OW=ya}create(){return new sk(this.Ga,this.vk,this.zu,this.OW,this.Wh)}}Object(Va.a)(dk,"FloatPaneFactory",null,[622]);class tk{constructor(){this.Wh=null}get name(){return"Common.App.FloatPane"}get BZf(){return wa.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&
wa.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.BZf&&(ia.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),rl().ZCg(),ia.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),rl().u6a())}$n(d){this.Wh=d;this.BZf&&(this.Wh.register(dk,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Ei(()=>new dk(wa.AFrameworkApplication.fa,wa.AFrameworkApplication.Lp,If.a.instance,wa.AFrameworkApplication.ra.$g.kn,
this.Wh)).yi(),this.Wh.register(Pk,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Ei(()=>new Pk(wa.AFrameworkApplication.Lp,wa.AFrameworkApplication.yh,dg.a.instance.resolve("Common.App.FloatPane.IFloatPaneFactory"))).yi())}dispose(){}static main(){Lc.a.instance.Do(new tk)}}Object(Va.a)(tk,"FloatPanePackage",null,[11,12]);var uj=a(999);class ij{constructor(d,z){this.yCb=null;this.Q7k=(T,ya,sb,cc,Fc)=>{if(1===sb)return 32;Fc[uj.a.Value]=this.yCb;Fc[Ag.a.yo]=this.yCb;
Fc[uj.a.Visible]=!0;return 32};this.$f=d;this.Ga=z}ho(){(this.yCb=this.Ga.Ya("StatusBarEnvironmentNameToUse"))&&""!==this.yCb&&this.$f.dl(bc.a.Nyg,fc.a.frame,this.Q7k,96)}}Object(Va.a)(ij,"DisplayEnvironmentName",null,[]);class Oi{constructor(){this.Wh=null}get name(){return"Common.App.DisplayEnvironmentName"}$n(d){this.Wh=d;this.Wh.register(ij,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").yi().Ei(()=>new ij(wa.AFrameworkApplication.yh,wa.AFrameworkApplication.fa))}init(){dg.a.instance.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ho()}dispose(){}static main(){Lc.a.instance.Do(new Oi)}}
Object(Va.a)(Oi,"DisplayEnvironmentNamePackage",null,[11,12]);var uk=a(233),vk=a(178);class Qk extends uk.a{constructor(d){super();this.lJ=()=>{this.O0a()};this.aZ=()=>{this.O0a()};this.$=d}dispose(){this.$&&vk.a(this.$)&&(vk.a(this.$).T6a(this.aZ),this.$.ea.WH(this.lJ));this.$=null;super.dispose()}Uhi(){wa.AFrameworkApplication.QLa()&&!this.O0a()&&(vk.a(this.$).oGa(this.aZ),this.$.ea.cK(this.lJ))}O0a(){return this.$.isEditMode&&(wa.AFrameworkApplication.IYa||Og.a.Wl.Ew)?(vk.a(this.$).T6a(this.aZ),
Ug.TaskExtensions.Xa(xj.GetServiceTaskFactory.create(this.$.la,119,this.ya,1),d=>{d.result.initialize()},this.ya,3),!0):!1}static main(){ta.a.gh(d=>{oc.pf.Aa()||(new Qk(d)).Uhi()})}}Object(Va.a)(Qk,"FileOpSliceDownloaderBootStraper",uk.a,[]);var Fj=a(93),Rk=a(529);class ek{constructor(d){this.D5=null;this.g$f=new Set;this.q3f=!1;this.Eba=(z,T)=>{if(!this.g$f.has(z)){var ya=[];if(T){const sb=cd.f(this.$).oh.Kl(T,!1);if(!sb){1!==T.top||1!==T.left||this.q3f||(ya.push(jc.a.lm("IsTableOnA1","false",Oc.g.Boolean)),
Fb.a("MsFormsTableUsage",void 0,void 0,ya),this.q3f=!0);return}if(1!==sb.usedRange.top||1!==sb.usedRange.left)return}T=gh.b().zp(z);ya.push(jc.a.lm("Command",T,Oc.g.String));Fb.a("MsFormsTableUsage",void 0,void 0,ya);this.g$f.add(z)}};this.bAe=(z,T)=>{if(!this.$.ea.Vn.get(61)||Fj.j(this.$.Zk))Fj.j(this.$.Zk)&&T&&T.item.name===this.D5.OU&&this.p$e();else if(this.$.sa.Lq(this.D5.zQb)){const ya={};ya.SheetName=this.D5.zQb;ya.NamedObjectName=this.D5.zQb;ya.FirstColumn=0;ya.FirstRow=0;ya.LastColumn=0;
ya.LastRow=2;const sb=Fc=>{if(!Fj.j(this.$.Zk)){if(null===Fc||void 0===Fc?0:Fc.Result)this.$.workbookContext.MsFormId=Fc.Result[0][0],this.D5.OU=Fc.Result[1][0],Fc=Fc.Result[2][0],this.jW(!!this.$.workbookContext.MsFormId&&this.ntj(Fc),1024),this.p$e();Fj.c(this.$.Zk)&&(T?ia.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${Lb.a.qE(this.$.workbookContext.MsFormId).toString()}`):ia.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${Lb.a.qE(this.$.workbookContext.MsFormId).toString()}`));
Fj.c(this.$.Zk)&&!T&&ia.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${Lb.a.qE(this.$.workbookContext.MsFormId).toString()}`);!Fj.c(this.$.Zk)&&T||this.jW(!0,2048)}},cc=this.$.pa.ta.Vh();this.$.userOperationManager.$O(new Ta.a(159,0,(Fc,Wc,id)=>dc.s(this.$.pa.J1,ya,!1,uc.c(Fc,sb),Wc,id,null,cc),16))}else T||this.jW(!0,2048)};this.NWj=(z,T)=>{T&&T.item.name===this.D5.zQb&&(this.jW(!1,1024),this.jW(!0,2048))};this.$=d}G3k(){this.D5=Rk.a.current;this.bAe(null,
null);this.$.sa.fua(this.bAe);this.$.sa.d4(this.NWj)}dispose(){this.$.sa.UAa(this.bAe)}ntj(d){if(!d)return!0;const z=RegExp("-","g"),T=this.$.workbookContext.MsFormDocUrl.toLowerCase();return T.includes(d.toLowerCase())||T.includes(d.toLowerCase().replace(z,""))?!0:!1}p$e(){Fj.c(this.$.Zk)&&this.D5.OU&&this.$.sa.ma&&this.$.sa.ma.name!==this.D5.OU&&this.$.sa.Lq(this.D5.OU)&&this.$.sa.getItemByName(this.D5.OU).activate({scenario:"msForm"})}jW(d,z){this.$.workbookContext.Options=yf.HelperMethods.NZ(d,
this.$.workbookContext.Options,z)}}Object(Va.a)(ek,"MsFormInfoUpdatingService",null,[574,4]);class wk extends bg.a{constructor(d){super();this.msFormInfoUpdatingService=null;this.$=d;this.gm()}create(){this.Bk(Object(rg.a)(this.$.la,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new ek(this.$))));this.msFormInfoUpdatingService.G3k()}static Ba(d){d.la.Hh(236,new wk(d))}}Object(Va.a)(wk,"MsFormInfoUpdatingServiceFactory",bg.a,[]);var Sk=a(1435),sl=a(1079);class Gj{}Gj.BZk=864E5;
Gj.mFh=3;Gj.VMj=144E5;Object(Va.a)(Gj,"AddinConstantsNum",null,[]);var nh=a(928),tl=a(1031),Bj=a(1E3);class Tk{constructor(d,z,T,ya){this.fa=(ya=void 0===ya?null:ya)?ya:wa.AFrameworkApplication.fa;this.Lcd=2;this.K0a=d;this.jvh=z;this.Eh=T}get $xa(){return this.Lcd}get dbl(){return this.jvh}Ule(d){if(this.fa.ka("AgaveSupportsLiveIdSpoofing")){var z=(new Date).getTime();this.K0a(d,this.$xa,{["ak0"]:z})}else if(Bj.a.wMk(d)){z=String.format(wa.AFrameworkApplication.ra.$g.H1+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}",
"laststoreupdate",wa.AFrameworkApplication.ra.$g.kn,this.dbl,wa.AFrameworkApplication.Jo);const T=wa.AFrameworkApplication.rj;let ya=null;this.Eh&&(ya=this.Eh.Li("ComponentAttach",tl.a[d]+sl.a[this.$xa]));T.ov(z,1,null,null,!0,4,sb=>{this.s1j(d,sb.data.responseData);ya&&ya.stop()},sb=>{ia.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",sb.data.httpStatus);this.Ksb(d,1,"request failed");ya&&ya.stop()},null)}else Bj.a.yQf(d)?(z=Bj.a.DDf(d),this.K0a(d,this.$xa,{["ak0"]:z})):
this.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(this.JM?this.Ksb(d,1,"no local timestamp"):this.K0a(d,this.$xa,null))}s1j(d,z){if(z&&""!==z)if(z=Sys.Net.XMLDOM(z)){Bj.a.dRa(nh.a.s5e,((new Date).getTime()+Gj.VMj).toString(),d);let T=z.getElementsByTagName("update");T&&T.length||(T=z.getElementsByTagName("o:update"));T&&0<T.length?(z=Date.parse(T[0].firstChild.nodeValue),Bj.a.DDf(d)<z||Bj.a.yQf(d)?this.K0a(d,this.$xa,{["ak0"]:z}):this.Ksb(d,1,"outdate timestamp in reponse")):
this.Ksb(d,2,"no timestamp in response")}else this.Ksb(d,1,"response data is invalid");else this.Ksb(d,1,"no responseData")}Ksb(d,z,T){this.JM&&this.K0a(d,this.$xa,{["AddinServiceUserState"]:z,["DiagnosticInfo"]:T})}get JM(){return this.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.fa.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(Va.a)(Tk,"AddinCommandsAnonymousAPIInitializer",null,[636]);class fk{constructor(d,z,T){this.Lcd=T;this.K0a=
d;this.Io=z}get $xa(){return this.Lcd}Ule(d){let z=null;this.Io&&(z=this.Io.Li("ComponentAttach",tl.a[d]+sl.a[this.$xa]));if(null==this.mse(d)?0:this.mse(d)){const T=(new Date).getTime()-Gj.mFh*Gj.BZk;this.K0a(d,this.$xa,{["ak0"]:T})}z&&z.stop()}}Object(Va.a)(fk,"AddinCommandsInitializerBase",null,[636]);class Uk extends fk{constructor(d,z){super(d,z,5)}mse(){return!0}}Object(Va.a)(Uk,"AddinCommandsInitializer",fk,[]);class Vk extends fk{constructor(d,z){super(d,z,1)}mse(d){try{const z=nh.a.OGf()+
d;return Boolean.parse(this.lGi(z)||"false")}catch(z){ia.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",z.toString())}return null}lGi(d){const z=localStorage;return void 0!==z&&null!==z?z.getItem(d):null}}Object(Va.a)(Vk,"AddinCommandsLocalCacheInitializer",fk,[]);var jj=a(653);class xk{constructor(d,z){z=void 0===z?null:z;this.Eh=d;this.fa=z?z:wa.AFrameworkApplication.fa}get appUILocale(){return jj.a.UU(wa.AFrameworkApplication.lcid).name}ybj(){const d=this.lKd();if(d)if(this.fa.ka("OcpsIsEnabled"))Object(Ni.a)().execute(z=>
{z.isFeatureEnabled("ConnectedServices",!0).then(T=>{for(const ya of d){if(!T&&0===ya.key){this.JM&&this.j2g(0,ya.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const sb=this.ZCf(ya.value);sb&&sb.Ule(ya.key)}return null})});else for(const z of d){const T=this.ZCf(z.value);T&&T.Ule(z.key)}}Vle(d,z,T){T&&T[nh.a.EVa]?(T[nh.a.i$]=d,T[nh.a.f4]=z,this.Kee(bc.a.vqa,T),Bj.a.dRa(nh.a.EVa,T[nh.a.EVa].toString(),d)):this.JM?this.j2g(d,z,T):this.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&
0===d&&(T={},T[nh.a.i$]=d,T[nh.a.f4]=z,this.Kee(bc.a.qG,T))}ZCf(d){let z=null;switch(d){case 1:z=new Vk(Object(Aa.a)(this,this.Vle,"retrieveAddinFlagCompleted"),this.Eh);break;case 2:z=new Tk(Object(Aa.a)(this,this.Vle,"retrieveAddinFlagCompleted"),this.appUILocale,this.Eh,this.fa);break;case 5:z=new Uk(Object(Aa.a)(this,this.Vle,"retrieveAddinFlagCompleted"),this.Eh)}return z}j2g(d,z,T){0===d&&T&&T[nh.a.nnc]&&(T[nh.a.i$]=d,T[nh.a.f4]=z,ia.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",
T[nh.a.nnc].toString(),JSON.stringify(T)),this.Kee(bc.a.qG,T))}get JM(){return this.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.fa.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(Va.a)(xk,"AddinCommandsInitializerHost",null,[]);var Hj=a(942),gk=a(292),ul=a(395);let yk;class vl extends qj.a{constructor(d,z){super();this.HIe=wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeCheckboxLabel:
CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.ALe=wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeHelpUrlText:CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.BLe=wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeHelpUrl:CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.VEb=!1;this.AJb=()=>{this.hide();this.VEb&&B(this.Ida)};this.SOj=()=>{Hj.a.instance.getItem("optedIntoAddinDeveloperMode")?
(Hj.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.VEb=!1):(Hj.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.VEb=!0)};this.Ida=d;yk=z}showDialog(d,z){try{this.kl=void 0===this.kl||null===this.kl?gk.a.Z3b(ul.a.Z8).toString():this.kl,this.show({["type"]:"StandardDialogProps",["id"]:this.kl,["dialogIcon"]:3,["headerText"]:d,["titleText"]:z,["resultHandler"]:this.AJb,["messageAreaLink"]:this.m9h(),["permanentDismissCheckbox"]:this.i9h(),["renderMicrosoftLogoInHeader"]:!1})}catch(T){this.g6c(d,
z)}}m9h(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.ALe,["handler"]:{["href"]:this.BLe,["target"]:"_blank"},["onExecute"]:null}}i9h(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.HIe,["onExecute"]:this.SOj}}g6c(d,z){const T=new dl.a(!1,!1,!1);T.Ph=1;T.kl=gk.a.Z3b(ul.a.Z8).toString();T.lp=String.format(this.L5(),z,this.BLe,this.ALe,this.HIe);T.initializeAndShow(d,this.Kdh,{optInCheckbox:!1})}Kdh(d,z){1==d&&z.optInCheckbox&&(Hj.a.instance.getItem("optedIntoAddinDeveloperMode")?
(Hj.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.VEb=!1):(Hj.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.VEb=!0,B(this.Ida)))}L5(){return"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}Object(Va.a)(vl,"AppsForOfficeDeveloperModeOptInDialog",qj.a,[]);var eg=a(435);class zk extends xk{constructor(d){super(d.Eh);this.Ida=this.bCb=null;
this.REa=new We.a;this.qhe=z=>{1===z&&this.Ida&&this.HCg()};this.$=d;Sk.a.Vmb=Sk.a.Rxf}get appUILocale(){return this.$.ua.UICultureTag}f3g(){this.ybj();this.Y3k()}lKd(){const d=new eg.a;this.$.ea.Vn.get(27)&&(d.ga(0,2),""!==wa.AFrameworkApplication.fa.Ya("HostInstallAddIns")&&d.ga(16,5));this.$.ea.Vn.get(33)&&d.ga(1,1);Pb.EwaSettings.Ra(52)&&d.ga(8,1);this.$.uk.get(35)&&d.ga(10,5);return d}Kee(d,z){this.Pli(()=>{const T=new Sd.a(d,0,this.$.hi,0,null);this.$.Ma.qh(T,z)})}Pli(d){(z=>{z=this.$.la.kh(z);
return!!z&&jg.d(z)})(198)?this.$.la.fi(198,z=>{d(z)}):d(null)}Y3k(){this.Ida=wa.AFrameworkApplication.fa.Ya("DevAddinManifestFileUrl");this.bCb=wa.AFrameworkApplication.fa.Ya("DevAddinManifestGuid");var d=wa.AFrameworkApplication.fa.Ya("IsDevAddinTest");if(this.Ida&&this.bCb&&d){d="true"===d;var z=this.REa.getItem("optedIntoAddinDeveloperMode");const T=this.REa.getItem(this.bCb);z||d&&wa.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs")?!wa.AFrameworkApplication.disableWholeAppsForOfficeFeature&&
(T||d&&wa.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))?this.HCg():(d=new qj.a,d.Ph=4,wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?(z=CommonUiStrings.AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUiStrings.AppsForOfficeDeveloperManifestUrl,this.Ida)+CommonUiStrings.AppsforOfficeLoadManifestUrl,d.pW(CommonUiStrings.AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,z,this.qhe)):(z=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.Ida)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,d.pW(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,z,this.qhe))):(d=new vl(this.Ida,this.qhe),d.Ph=0,wa.AFrameworkApplication.fa.ka("IsNewStringEnabled")?d.showDialog(CommonUiStrings.AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUiStrings.AppsforOfficeNotOptedIntoAddinDeveloperModeMessage):d.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,
CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}HCg(){if(oc.xb.Aa())void zc.a.resolve(oc.xb,{va:1}).then(d=>{d.Cl.validateAndCacheNewDevAddinManifest(this.Ida);this.REa.setItem(this.bCb,"true")});else{const d=xj.GetServiceTaskFactory.create(this.$.la,106,this.$.ya,1);Ug.TaskExtensions.Xa(d,()=>{d.result.Cl.validateAndCacheNewDevAddinManifest(this.Ida);this.REa.setItem(this.bCb,"true")},this.$.ya,3)}}}Object(Va.a)(zk,"AddinCommandsInitService",xk,[575]);class hk extends bg.a{constructor(d){super();
this.addinCommandsInitService=null;this.ij=()=>{ia.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.ea.ki}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.Ij&16384)}] `);this.addinCommandsInitService.f3g();this.$.ea.Uq(this.ij)};this.$=d;this.gm()}create(){this.$.la.fi(53,()=>{this.Bk(Object(rg.a)(this.$.la,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new zk(this.$))));this.$.ea.ki?(ia.ULS.sendTraceTag(537170702,
0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.Ij&16384)}] `),this.addinCommandsInitService.f3g()):this.$.ea.$q(this.ij)})}static Ba(d){d.la.Hh(201,new hk(d))}}Object(Va.a)(hk,"AddinCommandsInitServiceFactory",bg.a,[]);Type.registerNamespace("Common.App.InProductMessaging");wf.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");G.main();(()=>{ta.a.gh(()=>{ta.a.gh(d=>{oc.oc.Aa()||jb.Ba(d)})})})();
(()=>{ta.a.gh(()=>{oc.ud.Aa()||ta.a.gh(Ma.Ba)})})();ta.a.gh(oj.Ba);(()=>{ta.a.gh(d=>{oc.Ld.Aa()||Kj.Ba(d)})})();(()=>{ta.a.gh(d=>{be.a.Ut()||jk.Ba(d)})})();Type.registerNamespace("Common.App.Rename");Lc.a.instance.Do(new Fk,7);(()=>{ta.a.gh(d=>{oc.pf.Aa()||Xj.Ba(d)})})();Pb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(636);(()=>{ta.a.gh(d=>{d.la.Hh(203,new Ej)})})();Type.registerNamespace("Common.App.LivePersonaUtils");Yj.main();Type.registerNamespace("Common.App.SaveStatus");
Lc.a.instance.Do(new gl);(()=>{ta.a.gh(d=>{oc.Ib.Aa()||Object(hl.a)();qk.Ba(d)})})();il.a.Bw('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Type.registerNamespace("CAUI");Uh.main();nl.a.Ux.Hh(141,new ml);Pb.EwaSettings.isChangeGateEnabled("OfficeVSO:8719582_RemoveVarsFromSlices")||a(1432);(()=>{ta.a.gh(d=>{oc.a.Aa()||Zj.Ba(d)})})();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=zl.a;Type.registerNamespace("Common.App.WopiIdentity");ck.main();Type.registerNamespace("Common.App.FloatPane");tk.main();Type.registerNamespace("Common.App.DisplayEnvironmentName");Oi.main();
Qk.main();ta.a.gh(wk.Ba);ta.a.gh(hk.Ba);String(E);String(K);String(F);String(W);String(Md);String(oe);String(J);String(L);String(se);String(M);String(Ue);String(Q);String(H);String(ba);String(U);String(D);String(I);String(X);String(Y);String(ja);String(Ua);String(ka);String(fb);String(ha);String(wc);String(ea);String(aa);String(ca);String(xa);String(Oa);String(ua);String(Ia);String(Sa);String(Ya);String(da);String(Ea);String(oa);String(za);String(la);String(Ca);window.___1710758652287_closurehack=
E;window.___1710758652287_closurehack=K;window.___1710758652287_closurehack=F;window.___1710758652287_closurehack=W;window.___1710758652287_closurehack=Md;window.___1710758652287_closurehack=oe;window.___1710758652287_closurehack=J;window.___1710758652287_closurehack=L;window.___1710758652287_closurehack=se;window.___1710758652287_closurehack=M;window.___1710758652287_closurehack=Ue;window.___1710758652287_closurehack=Q;window.___1710758652287_closurehack=H;window.___1710758652287_closurehack=ba;
window.___1710758652287_closurehack=U;window.___1710758652287_closurehack=D;window.___1710758652287_closurehack=I;window.___1710758652287_closurehack=X;window.___1710758652287_closurehack=Y;window.___1710758652287_closurehack=ja;window.___1710758652287_closurehack=Ua;window.___1710758652287_closurehack=ka;window.___1710758652287_closurehack=fb;window.___1710758652287_closurehack=ha;window.___1710758652287_closurehack=wc;window.___1710758652287_closurehack=ea;window.___1710758652287_closurehack=aa;
window.___1710758652287_closurehack=ca;window.___1710758652287_closurehack=xa;window.___1710758652287_closurehack=Oa;window.___1710758652287_closurehack=ua;window.___1710758652287_closurehack=Ia;window.___1710758652287_closurehack=Sa;window.___1710758652287_closurehack=Ya;window.___1710758652287_closurehack=da;window.___1710758652287_closurehack=Ea;window.___1710758652287_closurehack=oa;window.___1710758652287_closurehack=za;window.___1710758652287_closurehack=la;window.___1710758652287_closurehack=
Ca},1168:function(A,u,a){a.r(u);a.d(u,"CalcHelper",function(){return w});A=a(0);var c=a(15),b=a(245),h;(function(v){v[v.paren=0]="paren";v[v.lead=1]="lead";v[v.intern=2]="intern";v[v.trail=3]="trail";v[v.undefined=4]="undefined"})(h||(h={}));Object(A.b)("CurrencyFormatOption",h);var r;(function(v){v[v.none=-1]="none";v[v.mdy=0]="mdy";v[v.dmy=1]="dmy";v[v.ymd=2]="ymd";v[v.myd=3]="myd";v[v.dym=4]="dym";v[v.ydm=5]="ydm"})(r||(r={}));Object(A.b)("DateOrderOption",r);class f{constructor(v,k){({CalcHelper:v}=
a(1168));k&&(k.zk||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.aph=v.ulf(k,v.Zkf(k.Qwa));this.bph=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.bph}get localeData(){return this.aph}}Object(A.a)(f,"LocaleHolder",null,[]);var l=a(1205),m=a(60),x=a(1),n=a(28),t=a(122);class w{constructor(v,k){this.$=v;(this.tA=k)||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");
k=x.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelOnlineCalcWP5",!1)?m.a.current.Pu(79):m.a.current.Pu(77):m.a.current.Pu(78);this.logger=new l.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Myj=new f(v,this.tA);excelOnlineCalc.config.initCalc(this.logger,this.tA?y=>this.tA.isFeatureEnabled(y):()=>!1,k);this.RJ=excelOnlineCalc.config.calcConfig(this.Myj.localeInfo)}get config(){return this.RJ}Iai(){if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.sa)return c.ULS.shipAssertTag(537170069,
0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const v=this.$.sa.ma;return v?v.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.sa.ma.index}createParser(){const v={};v.config=this.config;return excelOnlineCalc.parse.createParser(v)}createAnalyzer(){const v={};v.config=this.config;return excelOnlineCalc.analyze.createAnalyzer(v)}createNumberFormatter(){const v=excelOnlineCalc.numfmt.createFormatGlobals(this.config,
(k,y)=>excelOnlineCalc.calc.getTime(this.config,k,y,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(v)}U9h(v,k,y,C){if(!C)return{range:{row:k,col:y},sheet:{document:this.documentLoc,index:v}};k=excelOnlineCalc.location.gridCell(k,y);v=excelOnlineCalc.location.sheetIndex(this.documentLoc,v);return excelOnlineCalc.location.sheetGridCell(v,k)}static ulf(v,k){k=void 0===k?null:k;const y=v.X5h(),C=v.zk.TrueValueString,B=v.zk.FalseValueString,E=v.zk.DecimalSeparator.toString(),K=v.zk.ListSeparator.toString(),
F=v.zk.ColumnSeparator.toString(),W=v.zk.RowSeparator.toString(),J=v.zk.ThousandsDataArray,L=v.zk.ThousandSeparator.toString(),M=v.zk.Lcid,Q=v.zk.Country,H=v.zk.DigitsNumber,ba=v.zk.ExpSeparatedBySpace,U=v.zk.FractionSeparator.toString(),D=v.zk.PercentSeparatedBySpace,I=n.a.sqc(Enum.toString(h,v.zk.CurrencyFormat)),X=v.zk.CurrencySymbolLead,Y=v.zk.CurrencySeparatedBySpace,ja=v.zk.CurrencySymbolString,Ua=v.zk.DigitsCurrency,ka=-1===v.zk.DateOrder?"MDY":t.e(Enum.toString(r,v.zk.DateOrder)),fb=v.zk.DateSeparator.toString(),
ha=v.zk.DateAlternativeSeparator.toString(),ea=v.zk.Year4Digits,aa=v.zk.Month2Digits,ca=v.zk.Day2Digits,xa=v.zk.LongDateFormat,Oa=v.zk.TimeSeparator.toString(),ua=v.zk.TimeAltSeparator,Ia=v.zk.Hour2Digits,Sa=v.zk.Use24HourClock,Ya=v.zk.AmPmSeparatedBySpace,da=[v.zk.AmString,v.zk.PmString],Ea=v.zk.DayNameShortArray,oa=v.zk.DayNameLongArray,za=v.zk.MonthNameShortArray,la=v.zk.MonthNameLongArray,Ca=v.zk.PictureSpecialArray,Va=b.a.map(("\x00"+v.zk.PictureSingleString).split(""),Ja=>"\x00"===Ja?null:Ja),
ia=v.zk.PictureColorArray,wa=v.zk.PictureDbnumArray,Jb=v.zk.RowLetter.toString(),$a=v.zk.ColumnLetter.toString(),Ka=v.zk.LeftBrace.toString(),nb=v.zk.RightBrace.toString(),sa=v.zk.LeftBracket.toString(),na=v.zk.RightBracket.toString(),ab=w.oXi(v.zk);return excelOnlineCalc.calc.localeData(k,y,C,B,Jb,$a,Ka,nb,sa,na,E,K,F,W,J,L,M,Q,H,ba,U,D,I,X,Y,ja,Ua,ka,fb,ha,ea,aa,ca,xa,Oa,ua,Ia,Sa,Ya,da,Ea,oa,za,la,Ca,Va,ia,wa,ab,v.zk.SysDateFormatString,v.zk.SysTimeFormatString)}static Zkf(v){const k=[];if(!v)return k;
for(const y of v)v=null,y.IsDynamicUdf||(v=excelOnlineCalc.calc.worksheetFunctionName(y.FunctionIndexInServer,y.NameUI)),v&&k.push(v);return k}static oXi(v){const k=Array(6);k[1]="#"+v.AllStructRefString;k[3]="#"+v.HeadersStructRefString;k[2]="#"+v.DataStructRefString;k[4]="#"+v.TotalsStructRefString;k[5]="#"+v.ThisRowStructRefString;return k}}Object(A.a)(w,"CalcHelper",null,[])},1194:function(A,u,a){a.d(u,"a",function(){return r});A=a(0);var c=a(15),b=a(59),h=a(79);a=a(917);class r extends a.a{constructor(f,
l){super(f,l);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=r.m_message;this.Pga=!0}get linkText(){return r.Fag}dZ(f){super.dZ(f);b.a.openWindow(4,h.a.fBc(r.Eag))}RD(f){super.RD(f);r.i4d&&r.i4d(null)}static initialize(f,l,m,x){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");r.m_message=f;r.Fag=l;r.Eag=m;r.i4d=x}}r.m_message=null;r.Fag=null;r.Eag=null;r.i4d=null;Object(A.a)(r,
"WacGdprNoticeBusinessBarEntry",a.a,[])},1195:function(A,u,a){a.d(u,"a",function(){return"ewa-bb"});a.d(u,"b",function(){return"ewa-bb-content"});a.d(u,"c",function(){return"ewa-bb-entry"});a.d(u,"d",function(){return"ewa-bb-entry-body"});a.d(u,"e",function(){return"ewa-bb-entry-button"});a.d(u,"f",function(){return"ewa-bb-entry-button-holder"});a.d(u,"g",function(){return"ewa-bb-entry-close"});a.d(u,"h",function(){return"ewa-bb-entry-icon"});a.d(u,"i",function(){return"ewa-bb-entry-link"});a.d(u,
"j",function(){return"ewa-bb-entry-message"});a.d(u,"k",function(){return"ewa-bb-entry-title"});a.d(u,"l",function(){return"ewa-bb-icon"});a.d(u,"m",function(){return"ewa-bb-react"})},1196:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);a=a(917);class c extends a.a{constructor(b,h){super(b,h);this.Vx=!0;this.title=c.wda;this.message=c.vda}get actionButton(){return c.b9}ur(b){super.ur(b);(b=c.b3)&&b(null)}static initialize(b,h,r,f){c.wda=b;c.vda=h;c.b9=r;c.b3=f}}c.wda=null;c.vda=null;c.b9=null;
c.b3=null;Object(A.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1197:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);a=a(917);class c extends a.a{constructor(b,h){super(b,h);this.Vx=!0;this.title=c.wda;this.message=c.vda}get actionButton(){return c.b9}ur(b){super.ur(b);(b=c.b3)&&b(null)}static initialize(b,h,r,f){c.wda=b;c.vda=h;c.b9=r;c.b3=f}}c.wda=null;c.vda=null;c.b9=null;c.b3=null;Object(A.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1198:function(A,u,a){a.d(u,
"a",function(){return r});A=a(0);u=a(1032);var c=a(1081),b=a(1082),h=a(15);class r extends u.a{constructor(f,l,m){super(f,l,m);r.b9&&r.b3&&(this.Vx=!0);this.title=r.wda;this.message=r.vda;this.Pga=Object(c.c)()}get actionButton(){return r.b9}static initialize(f,l,m,x,n){r.wda=f;r.vda=l;r.b9=m;r.b3=x;r.M6c=n}ur(f){super.ur(f);r.b3&&r.b3(null)}RD(f){super.RD(f);r.M6c&&r.M6c(null)}dZ(f){super.dZ(f);h.ULS.sendTraceTag(507561158,0,50,"DataCleansingBusinessBarEntry.onLinkClick was triggered.");Object(b.b)(this.businessBar.$)}}
r.wda=null;r.vda=null;r.b9=null;r.b3=null;r.M6c=null;Object(A.a)(r,"DataCleansingBusinessBarEntry",u.a,[])},1199:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);a=a(917);class c extends a.a{constructor(b,h){super(b,h);this.Vx=!0;this.title=c.wda;this.message=c.vda}get actionButton(){return c.b9}ur(b){super.ur(b);(b=c.b3)&&b(null)}static initialize(b,h,r,f){c.wda=b;c.vda=h;c.b9=r;c.b3=f}}c.wda=null;c.vda=null;c.b9=null;c.b3=null;Object(A.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,
[])},1200:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);a=a(917);class c extends a.a{constructor(b,h){super(b,h);this.Vx=!0;this.title=c.m_title;this.message=c.m_message}get actionButton(){return c.Xqb}ur(b){super.ur(b);c.MMa&&c.MMa(null)}static initialize(b,h,r,f){c.m_title=b;c.m_message=h;c.Xqb=r;c.MMa=f}}c.m_title=null;c.m_message=null;c.Xqb=null;c.MMa=null;Object(A.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1201:function(A,u,a){a.d(u,"a",function(){return c});
A=a(0);a=a(917);class c extends a.a{constructor(b,h){super(b,h);c.Xqb&&c.MMa&&(this.Vx=!0);this.title=c.m_title;this.message=c.m_message}get actionButton(){return c.Xqb}ur(b){super.ur(b);c.MMa&&c.MMa(null)}static initialize(b,h,r,f){c.m_title=b;c.m_message=h;c.Xqb=r;c.MMa=f}}c.m_title=null;c.m_message=null;c.Xqb=null;c.MMa=null;Object(A.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1207:function(A,u,a){a.d(u,"a",function(){return c});const c=b=>{const h=Array(b.length);for(let r=
0,f=b.length;r<f;r++)h[r]=b[r].cloneNode(!0);return h}},1210:function(A,u,a){a.d(u,"a",function(){return c});A=a(0);class c{}c.O5c="b-ring_Apc_Trans";c.Tah="cdn_static_resource_ewa_image";Object(A.a)(c,"ResourceHosts",null,[])},1211:function(A,u,a){a.d(u,"a",function(){return h});A=a(0);var c=a(61),b=a(1414);class h{static DJd(r,f,l,m){m=void 0===m?null:m;h.TNc||(h.TNc=Array.isArray(c.a.Sp(l.ua.NetworkMeasurementUrlList))?c.a.Sp(l.ua.NetworkMeasurementUrlList):null);const x=[];for(let n=0;n<h.TNc.length;n++){const t=
h.TNc[n];let w=t.key;w||(w=t.Key);if(m&&!m.includes(w))continue;let v=t.value;v||(v=t.Value);w&&v&&x.push(new b.a(l,w,v,r,f))}return x}}h.TNc=null;Object(A.a)(h,"NetworkConnectionHelpers",null,[])},1369:function(A,u,a){a.r(u);a.d(u,"BusinessBarControl",function(){return fa});A=a(0);var c=a(15),b=a(98),h=a(158),r=a(17),f=a(94),l=a(84),m=a(33),x=a(35),n=a(16);u=a(265);var t=a(1195),w=a(7),v=a(305),k=a(1196),y=a(917),C=a(1392),B=a(1032);class E extends B.a{constructor(kb,db,gb){super(kb,db,gb)}RD(kb){super.RD(kb)}}
Object(A.a)(E,"EditAttemptReadOnlyBusinessBarEntry",B.a,[]);var K=a(44);class F extends y.a{constructor(kb,db,gb,Kb){super(kb,db);this.error=gb;this.options=Kb;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.Vx=!(Kb&4)}ur(kb){super.ur(kb);this.error.Appearance&=-33;K.a(this.businessBar.$).aD([this.error])}}Object(A.a)(F,"ErrorBusinessBarEntry",y.a,[]);var W=a(83);class J extends F{constructor(kb,db,gb,Kb,ub){super(kb,
db,gb,Kb);this.command=ub;this.W5=!0}b7(kb){super.b7(kb);this.businessBar.$.Ma.qh(new W.a(this.command,kb,this.businessBar.$.hi,10,null))}}Object(A.a)(J,"ErrorAndCommandBusinessBarEntry",F,[]);var L=a(12);class M{constructor(kb,db,gb,Kb,ub,lb,Ba,ra,wb,mc,xb){this.ufd=this.WT=this.dka=this.g_=0;this.xih=kb;this.v_k=db;this.WQ=gb;this.Qmh=Ba;this.dDb=m.a.qE(wb);this.Wkh=wb;this.ZHe=ra;this.Rmh=mc;xb&&(this.ufd=xb);0!==Kb&&(this.g_=Kb);0!==ub&&(this.dka=ub);0!==lb&&(this.WT=lb)}get FLc(){return 0===
this.ufd?"":M.ia(this.ufd)}get title(){return M.ia(this.v_k)}get message(){return M.ia(this.WQ)}get messageId(){return this.WQ}get iconName(){return this.Rmh}get YGa(){return this.xih}get actionButton(){return M.ia(this.g_)}get RVa(){return M.ia(this.dka)}get link(){return M.ia(this.WT)}get Xx(){return this.Qmh}get businessBarType(){return this.ZHe}get hash(){return this.dDb}get alt(){const {BusinessBarControl:kb}=a(1369);switch(this.Xx){case kb.kwa:return M.ia(26);case kb.kD:return M.ia(25);case kb.Qp:return M.ia(24);
default:return M.ia(0)}}get MIa(){return this.Wkh}set businessBarType(kb){this.ZHe=kb}static ia(kb){return L.a.instance.ia(kb)}}Object(A.a)(M,"EwaBusinessBarEntry",null,[]);class Q extends M{constructor(kb,db,gb,Kb,ub,lb,Ba,ra,wb){super(kb,0,db,gb,Kb,ub,lb,Ba,ra,wb)}get title(){return""}}Object(A.a)(Q,"EwaNoTitleBusinessBarEntry",M,[]);var H=a(69),ba=a(1),U=a(65);class D extends y.a{constructor(kb,db){super(kb,db);this.W5=this.Vx=!0;this.Pga=this.Ckj=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WebWorkbookLinkNewTaskPaneEnabled",
!1)}ur(kb){super.ur(kb);this.set_visible(!1);this.businessBar.$.bQ();this.businessBar.$.Ma.qh(new W.a(1038998010,kb,this.businessBar.$.hi,10,null))}b7(kb){super.b7(kb);this.businessBar.$.Ma.qh(new W.a(-722953877,kb,this.businessBar.$.hi,10,null))}dZ(kb){super.dZ(kb);kb=new W.a(-859308420,U.a.rh,this.businessBar.$.hi,12,null);this.businessBar.$.Ma.qh(kb,{[U.a.Xk]:"AssetID="+w.a.Fyf,["InputMethod"]:U.a.rh,[U.a.Qi]:w.a.FK,["ShouldCanvasTakeFocus"]:!0})}RD(kb){this.businessBar.removeEntry(55);H.g(kb)}}
Object(A.a)(D,"ExternalLinksEnableContentBusinessBarEntry",y.a,[]);class I extends y.a{constructor(kb,db){super(kb,db);this.Vx=!0;this.W5=!1}ur(kb){super.ur(kb);this.businessBar.$.Ma.qh(new W.a(-722953877,kb,this.businessBar.$.hi,10,null))}RD(kb){this.businessBar.removeEntry(5);H.g(kb)}}Object(A.a)(I,"ExternalLinksShowErrorBusinessBarEntry",y.a,[]);var X=a(13);class Y extends y.a{constructor(kb,db,gb){super(kb,db);this.p0a=gb;this.Vx=!0}ur(kb){super.ur(kb);X.HelperMethods.n7(this.businessBar.$.EN,
this.p0a,this.businessBar.$.wQ)}}Object(A.a)(Y,"HelpButtonBusinessBarEntry",y.a,[]);class ja extends y.a{constructor(kb,db,gb){super(kb,db);this.p0a=gb;this.Pga=!0}dZ(kb){super.dZ(kb);X.HelperMethods.n7(this.businessBar.$.EN,this.p0a,this.businessBar.$.wQ)}}Object(A.a)(ja,"HelpTextBusinessBarEntry",y.a,[]);class Ua extends y.a{constructor(kb,db,gb,Kb){super(kb,db);this.p0a=gb;this.command=Kb;this.Pga=!0;this.Vx=1461300262!==Kb}ur(kb){super.ur(kb);this.businessBar.$.Ma.qh(new W.a(this.command,kb,this.businessBar.$.hi,
10,null))}dZ(kb){super.dZ(kb);const db=new W.a(-859308420,kb,this.businessBar.$.hi,12,null);this.businessBar.$.Ma.qh(db,{[U.a.Xk]:"HelpID="+this.p0a,["InputMethod"]:kb,[U.a.Qi]:w.a.FK,[w.a.wja]:!0})}}Object(A.a)(Ua,"HelpTextTaskPaneAndCommandBusinessBarEntry",y.a,[]);class ka extends y.a{constructor(kb,db){super(kb,db);this.W5=this.Vx=!0}ur(kb){super.ur(kb);this.set_visible(!1);this.businessBar.$.bQ();this.businessBar.$.Ma.qh(new W.a(-1081442996,kb,this.businessBar.$.hi,10,null))}b7(kb){super.b7(kb);
this.businessBar.$.Ma.qh(new W.a(1702917262,kb,this.businessBar.$.hi,10,null))}RD(kb){this.businessBar.removeEntry(59);H.g(kb)}}Object(A.a)(ka,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",y.a,[]);var fb=a(1199);class ha extends y.a{constructor(kb,db){super(kb,db);(this.policyManager=kb.$.la.kh(274))?(this.message=this.policyManager.hSc,this.title=this.policyManager.title,this.Pga=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}dZ(kb){super.dZ(kb);
(kb=this.policyManager.iWj)&&kb(null)}}Object(A.a)(ha,"PolicyBusinessBarEntry",y.a,[]);var ea=a(1197),aa=a(1201),ca=a(1200);a(652);var xa=a(101),Oa=a(26);class ua extends y.a{constructor(kb,db){super(kb,db);this.Vx=!0;this.title=""}ur(kb){super.ur(kb);xa.c(Oa.a.QJj);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(A.a)(ua,"UnsupportedBrowserBusinessBarEntry",y.a,[]);var Ia=a(1194),Sa=a(142),Ya=a(1170),da=a(1083),Ea=a(1381),oa=a(22);class za{constructor(){this.R7c=
new Ea.a;this.P7c=new Ea.a;this.O7c=new Ea.a;this.jOh(this.R7c);this.iOh(this.P7c);this.hOh(this.O7c);this.tcd=new Ea.a;this.scd=new Ea.a;this.rcd=new Ea.a;this.JQh(this.tcd);this.IQh(this.scd);this.HQh(this.rcd);this.m9c=new Ea.a;this.DOh(this.m9c);this.rVa(this.m9c);this.rVa(this.O7c);this.rVa(this.P7c);this.rVa(this.R7c);this.rVa(this.scd);this.rVa(this.tcd);this.rVa(this.rcd)}PXi(kb,db){switch(kb){case 1:return this.C0i(db);case 2:return this.EEi(db)}return da.a.Dse?this.m9c:null}jOh(kb){kb.add("Headline",
Object(oa.a)("WildFireWordBizBarHeadline"));kb.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));kb.add("CallToAction",Object(oa.a)("WildFireWordBizBarAndroidCallToAction"))}iOh(kb){kb.add("Headline",Object(oa.a)("WildFirePPTBizBarHeadline"));kb.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));kb.add("CallToAction",Object(oa.a)("WildFirePPTBizBarAndroidCallToAction"))}hOh(kb){kb.add("Headline",Object(oa.a)("WildFireExcelBizBarHeadline"));kb.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));
kb.add("CallToAction",Object(oa.a)("WildFireExcelBizBarAndroidCallToAction"))}JQh(kb){kb.add("Headline",Object(oa.a)("WildFireWordBizBarHeadline"));kb.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));kb.add("InstallButton",Object(oa.a)("WildFireBizBarInstallButtonText"));kb.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));kb.add("CallToAction",Object(oa.a)("WildFireWordBizBarIPadCallToAction"));kb.add("OverlayBig","Get the Word app");kb.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");
kb.add("OverlaySmallSplit1","Discover Word");kb.add("OverlaySmallSplit2","designed for the iPad.");kb.add("SkipButton","Skip for now")}DOh(kb){kb.add("Headline","Get the Office Online extension for Chrome");kb.add("UseAppButton","Get the extension");kb.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}IQh(kb){kb.add("Headline",Object(oa.a)("WildFirePPTBizBarHeadline"));kb.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));kb.add("InstallButton",
Object(oa.a)("WildFireBizBarInstallButtonText"));kb.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));kb.add("CallToAction",Object(oa.a)("WildFirePPTBizBarIPadCallToAction"));kb.add("OverlayBig","Get the PowerPoint app");kb.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");kb.add("OverlaySmallSplit1","Discover PowerPoint");kb.add("OverlaySmallSplit2","designed for the iPad.");kb.add("SkipButton","Skip for now")}HQh(kb){kb.add("Headline",
Object(oa.a)("WildFireExcelBizBarHeadline"));kb.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));kb.add("InstallButton",Object(oa.a)("WildFireBizBarInstallButtonText"));kb.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));kb.add("CallToAction",Object(oa.a)("WildFireExcelBizBarIPadCallToAction"))}rVa(kb){kb.add("Corporation","Microsoft Corporation")}C0i(kb){switch(kb){case 3:return this.tcd;case 2:return this.scd;case 1:return this.rcd}return null}EEi(kb){switch(kb){case 3:return this.R7c;
case 2:return this.P7c;case 1:return this.O7c}return null}static get instance(){za.Va||(za.Va=new za);return za.Va}}za.Va=null;Object(A.a)(za,"WildFireStringFactory",null,[]);var la=a(6),Ca=a(59);class Va{constructor(kb,db,gb,Kb,ub,lb){this.fhd=null;this._id=kb;this.Rhd=db;this.jmh=void 0===ub?null:ub;this.zDb=Kb;this.QFb=void 0===lb?null:lb;this.dSa=null;this.Wdb=gb;this.tGb=za.instance.PXi(db,kb)}tkf(){this.dSa=new Ya.a(this.title,this.message,null);this.dSa.addButton(this.Ebf,Object(Sa.a)(this,
this.Khg,"onButtonOneClick"),"");this.Wdb&&this.dSa.Qzh(this.Ibf,Object(Sa.a)(this,this.Nhg,"onButtonTwoClick"));this.dSa.LX=Object(Sa.a)(this,this.dqf,"dismissBar");this.dSa.image=3;this.dSa.id=16;this.dSa.closeable=!0}get title(){return this.tGb.na("Headline")}get message(){return this.tGb.na("CallToAction")}get Wal(){return this.Wdb}get Ebf(){return this.Wdb?this.tGb.na("InstallButton"):this.tGb.na("UseAppButton")}get Ibf(){return this.Wdb?this.tGb.na("OpenAppButton"):""}Khg(){this.Wdb?this.Rej():
this.Lal()}Nhg(){this.Wdb&&this.W1j()}get openUrl(){this.fhd||(this.fhd=this.jmh());return this.fhd}Rej(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.zDb&&this.QFb&&this.QFb();da.a.WBg(this._id,this.Rhd)}W1j(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.zDb&&this.QFb&&this.QFb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(da.a.q7e(this._id),this.openUrl,0,!1))}Lal(){da.a.Dse?this.PQh():(c.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),da.a.eqe("BizBarClicked"),1!==this.Rhd&&2!==this.Rhd||da.a.$Xh(this.openUrl,this.zDb,this._id,this.QFb))}PQh(){this.zDb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Ca.a.H0(la.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Nfi(){this.zDb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");da.a.eqe(da.a.IWh)}dqf(){da.a.Dse?
this.Nfi():(da.a.eqe(da.a.nEf(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static fai(){const kb=la.AFrameworkApplication.ra.$g,db=new Va(kb.kn,da.a.MNf(),8<x.a.fUb,1===kb.oNa,()=>kb.kB,kb.hwk());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return db}}Object(A.a)(Va,"WildFireBusinessBar",null,[]);class ia extends y.a{constructor(kb,db){super(kb,db);this.MRa=Va.fai();this.Vx=!0;this.W5=this.MRa.Wal;this.title=this.MRa.title;this.message=this.MRa.message}get actionButton(){return this.MRa.Ebf}get RVa(){return this.MRa.Ibf}ur(kb){super.ur(kb);
this.MRa.Khg(null)}b7(kb){super.b7(kb);this.MRa.Nhg(null)}RD(kb){super.RD(kb);this.MRa.dqf(null)}}Object(A.a)(ia,"WildFireMobileAppBusinessBarEntry",y.a,[]);var wa=a(283),Jb=a(28),$a=a(206),Ka=a(162),nb=a(45),sa=a(189),na=a(1202),ab=a(154),Ja=a(5),Pa=a(95);class hb extends y.a{constructor(kb,db,gb,Kb){super(kb,db);this.WK=Pa.a.nh(Ja.pe);c.ULS.shipAssertTag(512276321,0,!!this.WK);this.id=sa.a.create();this.$=gb;this.title=L.a.instance.ia(2282);this.message="";this.dve=L.a.instance.ia(2278);this.u9g=
L.a.instance.ia(2279);this.r9g=L.a.instance.ia(2280);this.Bif=L.a.instance.ia(2281);this.update(Kb)}update(kb){this.scriptLink=kb.scriptLink;this.runStatus=kb.runStatus;this.buttonText=kb.buttonText||"";this.gzj(kb.clickId);this.csk();"preparing"===this.runStatus?(this.ABa(0),this.message=String.format(L.a.instance.sh(208),this.buttonText),this.Vx=!0,this.$Fa=this.dve,this.vLb=this.Jta=this.Nsb):"running"===this.runStatus?(this.ABa(0),this.message=String.format(L.a.instance.sh(207),this.buttonText),
this.Vx=!0,this.$Fa=this.dve,this.vLb=this.Jta=this.Nsb):"succeeded"===this.runStatus?(this.ABa(0),this.message=String.format(L.a.instance.sh(210),this.buttonText),"true"===kb.hasLogs?(this.Vx=!0,this.$Fa=this.r9g,this.Jta=this.osg,this.W5=!0,this.Jqd=this.u9g,this.Kqd=this.psg):(this.Vx=!0,this.$Fa=this.u9g,this.Jta=this.psg)):"runFailed"===this.runStatus?(this.ABa(1),this.message=String.format(L.a.instance.sh(209),this.buttonText),this.enb=fa.kwa,"true"===kb.hasLogs?(this.Vx=!0,this.$Fa=this.r9g,
this.Jta=this.osg,"false"===kb.isOwner&&(this.W5=!0,this.Jqd=this.Bif,this.Kqd=this.Tig)):"false"===kb.isOwner&&(this.Vx=!0,this.$Fa=this.Bif,this.Jta=this.Tig)):"fetchFailed"===this.runStatus?(this.ABa(1),this.enb=fa.kwa,this.message=L.a.instance.ia(2284)):"canceled"===this.runStatus?(this.ABa(0),this.enb=fa.kD,this.message=String.format(L.a.instance.sh(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.ABa(5),this.enb=fa.kD,this.message=String.format(L.a.instance.sh(211),this.buttonText),
this.Vx=!0,this.$Fa=this.dve,this.vLb=this.Jta=this.Nsb):"initializing"===this.runStatus&&(this.ABa(0),this.enb=fa.Qp,this.message=L.a.instance.ia(2283))}get Xx(){return this.enb}get actionButton(){return this.$Fa}get RVa(){return this.Jqd}ur(kb){super.ur(kb);this.Jta&&this.Jta()}b7(kb){super.b7(kb);this.RVa&&this.Kqd()}RD(kb){super.RD(kb);this.vLb&&this.vLb()}csk(){this.message="";this.enb=fa.Qp;this.Vx=!1;this.$Fa="";this.Jta=void 0;this.W5=!1;this.Jqd="";this.Kqd=void 0;this.hideCloseButton=!1;
this.vLb=void 0}Nsb(){const kb=sa.a.create().toString();this.WK.R1i(kb);this.XLc(-2186799,kb)}osg(){const kb=sa.a.create().toString();this.WK.Q1i(kb);this.XLc(1036446140,kb)}psg(){const kb=sa.a.create();if(this.scriptLink){const db=new na.b(this.scriptLink);this.WK.iQf(this.id.toString(),JSON.stringify(db),kb)}this.XLc(-585097204,kb.toString())}Tig(){const kb=sa.a.create().toString();this.WK.P1i(kb);this.XLc(-639858579,kb)}gzj(kb){xa.a(ab.a.DMj,void 0,void 0,[{name:"id",string:this.id.toString()},
{name:"hasScriptLink",bool:!!this.scriptLink},{name:"runStatus",string:this.runStatus},{name:"clickId",string:kb},{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}])}XLc(kb,db){xa.d(kb,void 0,void 0,void 0,void 0,void 0,[{name:"id",string:this.id.toString()},{name:"hasScriptLink",bool:!!this.scriptLink},{name:"runStatus",string:this.runStatus},{name:"clickId",string:db}])}}Object(A.a)(hb,"OfficeScriptsRunStatusBusinessBarEntry",y.a,[]);var ac=a(58);class Hc extends B.a{constructor(kb,
db,gb,Kb,ub,lb){super(kb,db,gb);ac.a.instance.create(()=>{this.showCallout(db,Kb)},ub,lb,!0,!0)}showCallout(kb,db){if(this.businessBar&&this.businessBar.r6(kb.YGa)&&this.g6e()){kb=new W.a(-847286761,0,this.businessBar.$.hi,0,null);var gb={};gb.CalloutName=db;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?gb.Target=this.nna():gb.Target=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:
this.g_.domElement;this.businessBar.$.Ma.qh(kb,gb)}}g6e(){return!0}}Object(A.a)(Hc,"CalloutBusinessBarEntry",B.a,[]);class bd extends Hc{constructor(kb,db,gb,Kb,ub,lb){super(kb,db,gb,Kb,ub,lb)}g6e(){if(!ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0))return!0;if(!this.businessBar)return!1;const kb=Pa.a.nh(Ja.te);return kb&&kb.cXc?!1:!0}}Object(A.a)(bd,"OptimizeWorkbookCalloutBusinessBarEntry",Hc,[]);var zc=a(19),oc=a(115),Nb=
a(126),Aa=a(42),Ub=a(125);class Db extends y.a{constructor(kb,db,gb){super(kb,db);this.update(gb)}update(kb){this.title=kb.title?kb.title:"";this.message=kb.message?kb.message:"";const db=this.Q2h(kb.businessBarType);this.ABa(db);this.hideCloseButton=!!kb.hideCloseButton;if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7958899_LogMsFormsDataSyncBizBarShown")){const gb=[];gb.push(Nb.a.lm("Reason",kb.reason,oc.g.String));gb.push(Nb.a.lm("Type",db.toString(),oc.g.String));xa.a("MsFormsDataSyncBizBarShown",
void 0,void 0,gb)}ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormsDataSyncFGSurveyEnabled",!1)&&Aa.a.instance.fj("Common.ISystemInitiatedFeedback").execute(gb=>{la.AFrameworkApplication.Lp.jm(new Ub.a(5,1,2E4,()=>{gb.logActivity("ExcelFormsDataSync",null)}))})}Q2h(kb){switch(kb){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(A.a)(Db,"MsFormsDataSyncStatusBusinessBarEntry",y.a,[]);
class Ib extends y.a{constructor(kb,db,gb,Kb){super(kb,db);this.W5=this.Vx=!0;this.u$j=gb;this.$Gh=Kb}ur(kb){super.ur(kb);this.businessBar.$.Ma.qh(new W.a(this.u$j,kb,this.businessBar.$.hi,10,null))}b7(kb){super.ur(kb);this.businessBar.$.Ma.qh(new W.a(this.$Gh,kb,this.businessBar.$.hi,10,null))}}Object(A.a)(Ib,"DualCommandActionsBusinessBarEntry",y.a,[]);var yc=a(1198),xc=a(360),zb=a(156);class vb extends y.a{constructor(kb,db){super(kb,db);this.Vx=!0}ur(kb){super.ur(kb);void Pa.a.resolve(Ja.sb,{va:1}).then(db=>
{ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmActiveContent",!1)?db.Ayg(()=>{this.businessBar.$.Ma.qh(new W.a(-1995709983,kb,this.businessBar.$.hi,10,null))}):(db.Ayg(),this.businessBar.$.Ma.qh(new W.a(-1995709983,kb,this.businessBar.$.hi,10,null)),this.businessBar.removeEntry(74))})}}Object(A.a)(vb,"ExternalConnectionsEnableContentRefreshOnOpenBusinessBarEntry",y.a,[]);var bb=a(1081);class La extends y.a{constructor(kb,db){super(kb,db);this.p0a="6d24cece-a038-468a-8176-8b6568ca9be2";
this.Vx=this.Pga=!0}ur(kb){super.ur(kb);this.set_visible(!1);this.businessBar.$.bQ();this.businessBar.$.Ma.qh(new W.a(-1193102612,kb,this.businessBar.$.hi,10,null))}dZ(kb){super.dZ(kb);const db=new W.a(-859308420,U.a.rh,this.businessBar.$.hi,12,null);this.businessBar.$.Ma.qh(db,{[U.a.Xk]:"HelpID="+this.p0a,["InputMethod"]:kb,[U.a.Qi]:w.a.FK,[w.a.wja]:!0})}RD(kb){this.businessBar.set_visible(!1);H.g(kb)}}Object(A.a)(La,"AutoRefreshDisabledBusinessBarEntry",y.a,[]);class pb extends y.a{constructor(kb,
db,gb){super(kb,db);this.update(gb)}update(kb){const db=kb.entryToAdd;this.title=db.title;this.message=db.message;this.cKb=db.cKb;this.Vx=!0;this.RD=gb=>{super.RD(gb);db.LX(null)}}get actionButton(){return this.cKb.text}ur(kb){super.ur(kb);(kb=this.cKb.handler)&&kb(null);this.cKb.Xfi&&this.RD(null)}}Object(A.a)(pb,"SharedBusinessBarEntry",y.a,[]);class fa extends u.a{constructor(kb,db){super(db);this.rBf=n.DOMElementExtensions.RI+",div";this.N4=Array(76);this.AOe=this.mv=!1;this.g7=gb=>{if(gb.La.keyCode===
b.a.CG){var Kb=this.hj.querySelectorAll(this.rBf);const ub=n.DOMElementExtensions.DE(Kb);Kb=n.DOMElementExtensions.yaa(Kb);return n.DOMElementExtensions.b8a(gb.La,ub,Kb)}return!1};this.th=kb;this.set_visible(!1);h.a.instance.xa(r.a.Ui,this.hj,this.g7);v.a(kb).Tq(this)}get hl(){return wa.a.eud}get hj(){return this.domElement}get Zo(){return this.get_visible()}get $(){return this.th}Vp(kb,db){ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?db||n.DOMElementExtensions.setFocus(n.DOMElementExtensions.DE(this.hj.querySelectorAll(this.rBf))):
db||n.DOMElementExtensions.setFocus(this.domElement.firstChild);return!db}tq(kb){return n.DOMElementExtensions.eo(this.hj,kb)}Qs(){}nu(){}dispose(){this.mv||(h.a.instance.Qa(r.a.Ui,this.hj,this.g7),f.a.gj(this.N4),this.N4=Array(76),this.th=null,super.dispose(),this.mv=!0)}r6(kb){if(!this.get_visible())return!1;kb=this.N4[kb];return!!kb&&kb.isVisible}rKd(kb){return this.r6(kb)?this.N4[kb].nna():null}mM(kb){return!!this.N4[kb]}Czb(kb,db){if(kb=this.N4[kb])kb.update(db),kb.V6k()}EF(kb,db,gb,Kb){gb=void 0===
gb?null:gb;Kb=void 0===Kb?null:Kb;Object(zb.c)(()=>{this.Xxh(kb,db,gb,Kb)},this.th.ya)}Xxh(kb,db,gb,Kb){gb=void 0===gb?null:gb;Kb=void 0===Kb?null:Kb;let ub=!1;if(!this.AOe){var lb=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?`${t.a} ${t.m}`:t.a;this.addCssClass(lb);this.AOe=!0}if(this.mM(kb))gb=this.N4[kb].get_visible();else{this.set_visible(!0);lb=fa.UNf(this.$)[kb];this.N4[kb]=this.PX(kb,db,gb,Kb);gb=!1;ub=!0;Kb="";let Ba=0;db&&(Kb=db.MessageIdName,Ba=db.MessageId);
const ra=lb.MIa,wb=nb.a.instance.Gga(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${kb}, time from app interactive: ${wb}`);ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===lb.businessBarType||Ka.a(this.$).eke(lb.hash,Kb,Ba,l.a.P2c,!0,1,db,ra)}gb||!C.BusinessBarManager.TCc().includes(kb)&&!ub||(this.N4[kb].set_visible(!0),this.$.bQ())}removeEntry(kb){return this.nkk(kb)}Uhe(){f.a.gj(this.N4);this.N4=Array(76);this.set_visible(!1)}nkk(kb){if(!this.mM(kb))return!1;
f.a.dh(this.N4[kb]);this.N4[kb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.bQ();return!0}PX(kb,db,gb,Kb){gb=void 0===gb?null:gb;Kb=void 0===Kb?null:Kb;const ub=fa.UNf(this.$)[kb],lb=!!(this.$.Ij&64),Ba=this.$.dpb();switch(kb){case 23:kb=Ba?new B.a(this,ub,617689800):new y.a(this,ub);break;case 2:case 4:case 25:case 26:case 36:case 35:kb=new y.a(this,ub);break;case 12:case 29:case 30:case 31:case 32:case 57:kb=lb?new B.a(this,ub,-8805455):new y.a(this,ub);break;case 34:kb=lb?
new Ib(this,ub,-8805455,-104572626):new y.a(this,ub);break;case 22:kb=new E(this,ub,-8805455);break;case 46:case 45:kb=lb?new J(this,ub,db,0,-8805455):new F(this,ub,db,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:kb=new F(this,ub,db,0);break;case 19:kb=new y.a(this,ub);break;case 47:kb=new F(this,ub,db,0);break;case 6:case 14:kb=new Y(this,ub,db.HelpTopicId);break;case 67:case 65:kb=new ja(this,ub,db.HelpTopicId);break;case 73:kb=new ja(this,ub,xc.a.cwg);break;case 72:kb=new E(this,
ub,-1698025133);break;case 37:kb=new ja(this,ub,w.a.jbi);break;case 38:kb=new y.a(this,ub);break;case 71:kb=new y.a(this,ub);break;case 68:kb=new E(this,ub,924877417);break;case 16:kb=new y.a(this,ub);kb.title=m.a.Or(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);kb.message=m.a.Or(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:kb=new B.a(this,ub,-1762562205);kb.hideCloseButton=!0;break;case 20:kb=new ia(this,ub);break;case 21:case 56:kb=new y.a(this,ub);break;
case 28:kb=new y.a(this,ub);break;case 24:kb=new ua(this,ub);break;case 27:kb=new ha(this,ub);break;case 39:kb=new Ia.a(this,ub);break;case 40:kb=new k.a(this,ub);break;case 41:kb=new ea.a(this,ub);break;case 42:kb=new fb.a(this,ub);break;case 48:kb=new y.a(this,ub);break;case 49:kb=new y.a(this,ub);break;case 50:kb=new y.a(this,ub);break;case 51:kb=new y.a(this,ub);break;case 52:kb=new y.a(this,ub);break;case 53:kb=new ca.a(this,ub);break;case 54:kb=new aa.a(this,ub);break;case 55:kb=new D(this,
ub);break;case 5:kb=new I(this,ub);break;case 58:kb=new B.a(this,ub,-1753056834);db?(db=db.Directive,Jb.a.Kz(db)||"&nbsp;"===db||(kb.message=db)):gb&&(kb.message=gb);break;case 59:kb=new ka(this,ub);break;case 60:kb=new y.a(this,ub);break;case 63:kb=new ja(this,ub,w.a.CLj);break;case 61:kb=new Ua(this,ub,w.a.ULh,-8805455);break;case 44:kb=new La(this,ub);break;case 66:kb=new Ua(this,ub,w.a.Tek,1461300262);break;case 62:kb=new bd(this,ub,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");
kb.message=gb;break;case 70:kb=new yc.a(this,ub,-1190551534);break;case 64:kb=new hb(this,ub,this.$,Kb);break;case 69:kb=new Db(this,ub,Kb);break;case 74:kb=new vb(this,ub);break;case 75:kb=new pb(this,ub,Kb);break;default:kb=new F(this,ub,db,7)}kb.tkf();return kb}static UNf(kb){const db=kb.dpb();kb=$a.a.Cya()?261:260;const gb=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WebWorkbookLinkNewTaskPaneEnabled",!1);return fa.ubf||(fa.ubf=[new M(0,276,277,278,0,0,fa.kwa,1,"BB_UnableToRefreshLock"),
new M(1,276,277,278,0,0,fa.kwa,1,"BB_UnableToRefreshLockExpected"),new M(2,268,269,0,0,0,fa.kD,5,"BB_WorkbookAlmostTooLarge"),new M(3,270,271,272,0,0,fa.kwa,1,"BB_WorkbookTooLarge"),new M(4,259,kb,0,0,0,fa.kD,5,"BB_ExternalWorkbookLinksDisabled"),new M(5,263,262,264,0,0,fa.kwa,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new M(6,265,266,267,0,0,fa.Qp,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new M(7,251,252,253,0,0,fa.Qp,5,"BB_UnsupportedFeatures"),new M(8,0,0,0,0,0,fa.Qp,0,
"BB_CollabDataAndDataStringsLocaleMismatch"),new M(9,0,0,0,0,0,fa.Qp,0,"BB_CollabDataStringsLocaleMismatch"),new M(10,0,0,0,0,0,fa.Qp,0,"BB_CollabDataLocaleMismatch"),new M(11,279,280,281,0,0,fa.kwa,1,"BB_LastGenericStatusError"),new M(12,282,283,284,0,0,fa.kD,5,"BB_ScratchPadWarning"),new M(13,285,286,287,0,0,fa.kwa,1,"BB_AuthenticationLost"),new M(14,288,289,290,0,0,fa.kD,5,"BB_OdfCompatibilityIssues"),new M(15,0,575,0,0,0,fa.kD,5,"BB_PivotChartInteractivityMissingWarning"),new M(16,0,0,0,0,0,fa.Qp,
2,"BB_WorkbookIsIrmProtected"),new M(17,0,0,0,0,0,fa.Qp,0,"BB_BIFeatureNotAvailable"),new M(18,291,292,287,0,0,fa.kD,5,"BB_AnonymousCreateMode"),new M(19,254,255,0,0,0,fa.kD,5,"BB_UnsupportedInteractiveReportEditing"),new M(20,0,0,0,0,0,fa.Qp,0,"BB_MobileAppCampaignBizBar"),new M(21,297,298,0,0,0,fa.Qp,0,"BB_TransientServerCommunicationFailures"),new M(22,1643,1654,1655,0,0,fa.Qp,5,"BB_EditAttemptInReadOnly"),new M(23,1643,db?2348:1654,db?2349:0,0,0,fa.Qp,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),
new M(24,0,X.HelperMethods.p6k(),1632,0,0,fa.Qp,3,"BB_UnsupportedBrowser"),new M(25,300,301,0,0,0,fa.Qp,2,"BB_ReadOnlyPermissions"),new M(26,302,303,0,0,0,fa.Qp,2,"BB_DocumentIsIrmProtectedWarning"),new M(27,0,0,0,0,0,fa.kD,5,"BB_PolicyWarningMessage"),new M(28,1285,299,0,0,0,fa.Qp,0,"BB_WorkingOnIt"),new M(29,1643,1641,1642,0,0,fa.Qp,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new M(30,1656,1657,1658,0,0,fa.Qp,5,"BB_WorkbookIsReadOnlyRecommended"),new M(31,1643,1659,1660,0,0,fa.Qp,5,"BB_WorkbookHasPasswordToModify"),
new M(32,1643,1661,1664,0,0,fa.Qp,3,"BB_LegacySharedWorkbookEditWarning"),new M(33,1651,1662,253,0,0,fa.Qp,5,"BB_LegacyConnectionsWarning"),new M(34,1643,1960,1961,1962,0,fa.Qp,0,"BB_TooManyLoadBlockingFloatingObjects"),new M(35,1652,1653,0,0,0,fa.Qp,2,"BB_GroupedSlicers"),new M(36,313,314,0,0,0,fa.kD,5,"BB_ThirdPartyAddinDisabled"),new M(37,1789,1790,0,0,1791,fa.Qp,5,"BB_FinanceLinkedEntityDisclaimerBar"),new M(38,1818,1819,0,0,0,fa.kD,5,"BB_WolframDeprecationAlertBar"),new M(39,0,0,0,0,0,fa.Qp,
0,"BB_WacGdprNotice"),new M(40,0,0,0,0,0,fa.Qp,0,"BB_AutomaticSensitivityLabel"),new M(41,0,0,0,0,0,fa.Qp,0,"BB_RecommendedSensitivityLabel"),new M(42,0,0,0,0,0,fa.Qp,0,"BB_MandatorySensitivityLabel"),new M(43,315,316,317,0,0,fa.Qp,0,"BB_LocalStorageDisabled"),new M(44,632,633,2511,0,1319,fa.Qp,0,"BB_AutoRefreshDisabled"),new M(45,1014,1012,1016,1314,0,fa.Qp,4,"BB_CorruptedFileRepaired"),new M(46,1015,1013,1016,1314,0,fa.Qp,5,"CorruptedOdsFileRepaired"),new M(47,273,274,275,0,0,fa.kD,5,"BB_MinorVersionLimitReached"),
new M(48,304,305,0,0,0,fa.kD,5,"BB_SensitivityApplicationGenericError"),new M(49,306,308,0,0,0,fa.kD,5,"BB_SensitivityApplicationTooLargeFileError"),new M(50,307,308,0,0,0,fa.kD,5,"BB_SensitivityApplicationLabelNotSupportedError"),new M(51,309,310,0,0,0,fa.kD,5,"BB_SensitivityApplicationLabelDisabledError"),new M(52,311,312,0,0,0,fa.kD,5,"BB_SensitivityApplicationMandatoryConflictError"),new M(53,0,0,0,0,0,fa.kD,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new M(54,0,0,0,0,0,fa.kD,
5,"BB_SensitivityApplicationSetLabelError"),new M(55,gb?2470:2119,gb?2468:2120,gb?2469:2121,2124,gb?2467:0,fa.Qp,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16",gb?2512:0),new M(56,297,298,0,0,0,fa.Qp,0,"BB_NetworkDown"),new M(57,318,319,320,0,0,fa.Qp,2,"BB_DefaultToViewDueToCogs"),new M(58,1815,1816,1817,0,0,fa.Qp,1,"BB_RefreshLinkedEntityErrorBar"),new M(59,1792,1793,1794,1795,0,fa.Qp,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new Q(60,250,0,0,0,fa.Qp,5,"BB_CanvasHealth"),
new M(61,1017,1018,1314,0,1019,fa.Qp,5,"BB_MismatchedFileFormatConverted"),new M(62,2238,0,2240,0,0,fa.Qp,5,"BB_OptimizeWorkbook"),new M(63,321,322,0,0,323,fa.Qp,0,"BB_NovModePostDepreciation"),new M(64,0,0,0,0,0,fa.Qp,0,"BB_OfficeScriptsRunning"),new M(65,2214,2215,0,0,2217,fa.Qp,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new M(66,324,325,0,0,326,fa.Qp,5,"BB_ReadOnlyPivotTable"),new M(67,2214,2216,0,0,2217,fa.Qp,0,"BB_PowerQueryRefreshHostNotSupported"),new M(68,1057,x.a.GIc?1059:1058,1056,
0,0,fa.Qp,4,"BB_RefreshPageAfterEnablingTheExtension"),new M(69,0,0,0,0,0,fa.Qp,0,"BB_MsFormsDataSyncStatus"),new M(70,0,0,0,0,2485,fa.kD,5,"BB_DataCleansingSuggestions",ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8721279_DataCleansingBusinessBarIcon")?Object(bb.a)():void 0),new Q(71,2324,0,0,0,fa.Qp,4,"BB_EditInMiniWAC","EditExcel_16"),new M(72,2326,2327,2325,0,0,fa.kD,5,"BB_PowerQueryUnsupportedTeams"),new M(73,2326,2328,0,0,2217,fa.kD,5,"BB_PowerQueryEnableThirdPartyCookies"),new M(74,2487,2488,
2489,0,0,fa.kD,5,"BB_ExternalConnectionsEnableContentRefreshOnOpen"),new M(75,0,0,0,0,0,fa.kD,5,"BB_ApplicationNotification")])}}fa.kwa=zc.a.Yoi;fa.kD=zc.a.$oi;fa.Qp=zc.a.Zoi;fa.ubf=null;Object(A.a)(fa,"BusinessBarControl",u.a,[47])},1387:function(A,u,a){a.d(u,"a",function(){return Ua});A=a(0);var c=a(15),b=a(35),h=a(94),r=a(17),f=a(153),l=a(355);u=a(78);var m=a(10),x=a(85),n=a(5),t=a(95),w=a(532);class v{constructor(ka,fb){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=
this.convertToDomainName=this.cardViewManager=null;this.$=fb;this.parentElement=ka}C4h(){const ka=this.D4h();n.H.Aa()?void t.a.resolve(n.H,{va:0}).then(fb=>{this.cardViewManager=fb;fb.DUg(this.parentElement,ka)}):w.a(this.$,243,242,0,fb=>{this.cardViewManager=fb;fb.DUg(this.parentElement,ka)})}fSf(){this.cardViewManager&&this.cardViewManager.Rmb(-1,-1,this.parentElement)}D4h(){const ka={layoutId:"AutoDetectTooltip"};ka.description=this.longDescription;ka.convertToDomainName=this.convertToDomainName;
ka.longDescription=this.longDescription;ka.urlValue=this.urlValue;ka.imageAltText=this.imageAltText;ka.helpText=this.helpText;ka.helpId=this.helpId;return ka}}Object(A.a)(v,"AutoDetectCardManager",null,[]);var k=a(29),y=a(244),C=a(33),B=a(290),E=a(19),K=a(60);class F extends u.a{constructor(ka,fb,ha){super();this.vj=ea=>{if(ea.li.id===this.KYa.firstChild.id){ea=this.h$e;const aa={};aa.Id=ea.uJb;this.nt.uyd(aa,!0,ea);this.KYa.removeChild(this.KYa.firstChild);return!0}return!1};this.h$e=ka;this.nt=
fb;this.KYa=document.createElement("div");this.KYa.className="clip16x16";this.gLa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',C.a.Or("autodetectid"+this.h$e.left),E.a.AFd,K.a.An(11));ha.hr(this.KYa,this.gLa);ka=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.xa(r.a.click,ka,this.vj)}get domElement(){return this.KYa}dispose(){if(this.KYa){const ka=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");
B.a.instance.Qa(r.a.click,ka,this.vj)}super.dispose()}static get RQh(){return"clip16x16"}}Object(A.a)(F,"AutoDetectColumnHeaderButton",u.a,[]);var W=a(1),J=a(1207),L=a(13),M=a(23),Q=a(231);class H extends u.a{constructor(ka,fb,ha){super();this.Bi=null;this.$=ka;this.da=M.f(ka);this.nt=fb;this.Bi=ha;this.gxd=new Q.a}dispose(){super.dispose()}dgi(ka){for(const fb of this.da.d0)for(const ha of fb){const ea=ha,aa=ea.KD,ca=J.a(ea.m0a);this.wxh(ka,ca,aa);ea.zPg(ca)}}wxh(ka,fb,ha){if(fb.length){var ea=ha.length;
ha[ea-1]<ka.left||(ha=L.HelperMethods.eK(new y.a(ha),0,ea,ka.left,L.HelperMethods.FS),0>ha||!(fb=fb[ha]))||(this.da.rtl?fb.classList.add(k.vb):fb.classList.add(k.ub),this.gxd.lh(ka.left)||this.gxd.add(ka.left,new F(ka,this.nt,this.Bi)),ka=this.gxd.na(ka.left).domElement,!fb.getElementsByClassName(F.RQh).length&&this.ITk(fb)&&fb.appendChild(ka))}}ITk(ka){const fb=parseInt(ka.style.width,10);var ha=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";ha=H.o6h(ha);ka=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.Bi.JVi(ka.firstChild.innerHTML),
ha,!0,W.EwaSettings.isChangeGateEnabled("OfficeVSO:8633312_TextWidth"));return 18.4<fb-(fb/2+ka/2)?!0:!1}static o6h(ka){return`${"normal"} ${"normal"} ${ka} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(A.a)(H,"AutoDetectColumnHeaderManager",u.a,[]);var ba=a(497),U=a(27),D=a(73),I=a(139),X=a(16),Y=a(12),ja=a(101);class Ua extends u.a{constructor(ka,fb,ha,ea,aa){super();this.isMac=b.a.isMac;this.meb=-1;this.Htc=null;this.PHa=-1;this.i3a=this.AKc=this.Gte=this.mMa=
this.i$e=!1;this.n4=null;this.tm=()=>{this.rLa&&this.da&&this.z2()};this.ej=()=>{this.LD()};this.vj=()=>{this.OXa();M.f(this.$).Vp(!0,!1)};this.CNa=(xa,Oa)=>{Oa?(this.f5g(this.Htc),this.QVg()):(xa=[29],this.da.Gh.Mq(xa),this.da.Gh.tt(null,xa),this.n4&&this.n4.fSf())};this.nq=()=>{this.Lob()&&this.Eq.hide();1===this.da.ha.Ck&&this.z2()};this.QE=()=>{const xa=this.da.ha.Ck;this.da.ha.qa.activeCell&&1===xa&&this.z2()};this.onKeyUp=xa=>this.wLc?this.mMa?!1:17===xa.La.keyCode&&this.Gte?(this.i3a?(this.QVg(),
this.Hvb()):this.sPg(),!0):!1:this.mMa=!1;this.onKeyDown=xa=>{if(!this.wLc)return this.mMa=!1;this.Gte=!1;this.mMa=xa.ctrlKey;switch(xa.La.keyCode){case 27:return this.i3a?(this.CNa(null,!1),this.Hvb()):this.n4&&(this.n4.fSf(),this.sPg()),!0;case 13:if(this.i3a)return this.i3a=!1,this.OXa(),!0;break;case 17:return this.Gte=!0}return!1};const {AutoDetectActionButton:ca}=a(1438);this.$=ka;this.vJb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);fb||c.ULS.sendTraceTag(537166983,
0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.nt=ea;ea.e3b();this.Eq=new ca(ka,fb,this.vj,ha,"");this.lLh=new H(this.$,ea,aa);this.da=M.f(this.$);this.da.ha.wX(this.tm);this.da.Fh.YHb(this.tm);this.da.dA(this.QE);ka.gq(this.ej);ka.xI(this.nq);this.gridBlockManager=Object(f.a)(9,this.da.za);this.PD=ka.frame.fI;this.z2()}get hj(){return this.Eq.domElement(1)}get wLc(){const ka=this.Eq.domElement(Ua.Pja);return ka?X.DOMElementExtensions.isVisible(ka):!1}get rLa(){return this.$.isEditMode&&
W.EwaSettings.Ra(128)&&W.EwaSettings.Ra(131)&&(new I.a(this.$.sa)).wn?!1:-1!==this.PHa}dispose(){this.da&&this.da.ha.vZ(this.tm);if(this.$){const ka=this.$;ka.Yu(this.ej);ka.gL(this.nq);M.f(ka).$E(this.QE)}h.a.dh(this.Eq);this.PD=this.$=this.da=this.Eq=null;super.dispose()}LD(){this.CNa(null,!1);this.meb=-1;this.Eq.hide();this.X4k();this.i3a=!1}Hvb(){this.Eq.getButton(Ua.Pja).Q5b();this.i3a=!1}sPg(){this.Eq.getButton(Ua.Pja).Ntb();this.f5g(this.Htc);this.i3a=!0;W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)?void t.a.sj(n.l).then(ka=>{ka.mca(Y.a.instance.ia(1751))}):this.$.la.fi(211,ka=>{ka.mca(Y.a.instance.ia(1751))})}onAutoDetectUIShown(){if(this.rLa&&-1!==this.meb)this.nt.onAutoDetectUIShown()}mLh(ka){var fb=new U.Range(1===ka.top?1:ka.top-1,ka.left,ka.bottom,ka.right,!0,!1);fb=this.da.getRangeInformation(fb);for(const ha of fb)if(Object(l.a)(ba.AutoDetectRange,ha)&&this.wGc(ka,!1,ha))return!0;return!1}OXa(){if(this.rLa&&-1!==this.meb){this.Eq.getButton(Ua.Pja).Ntb();var ka={};ka.Id=this.PHa;ka.StringId=
null;this.nt.uyd(ka,!0,this.Htc);c.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");ja.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,[{name:"Domain",int64:this.PHa}]);this.PHa=-1}}bGi(){let ka=Y.a.instance.ia(1747);if(-1!==this.PHa){ka+=" ";try{ka+=this.nt.HYb(this.PHa.toString())}catch(fb){c.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.PHa}`)}}ka+=" ";return ka=
this.vJb?ka+Y.a.instance.ia(1750):ka+Y.a.instance.ia(this.isMac?1749:1748)}QVg(){this.vJb&&(this.n4||(this.n4=new v(this.hj,this.$),this.n4.convertToDomainName=Y.a.instance.ia(1752),this.n4.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.n4.imageAltText=Y.a.instance.ia(1754),this.n4.helpId="HID_DataTypes_Wolfram",this.n4.helpText=Y.a.instance.ia(1753)),this.n4.longDescription=this.nt.Ixe(this.meb.toString()),this.n4.C4h())}wGc(ka,fb,ha){if((new U.Range(ha.top,
ha.left,ha.bottom===m.a.Rk?ha.bottom:ha.bottom+1,ha.right,!0,!1)).Xi(ka)){if(fb){if(ha&&ha.uJb!==this.meb){this.meb=ha.uJb;ka=ha.uJb.toString();fb=this.vJb?"":this.nt.Ixe(ka);const ea=this.nt.s9i(ka);this.Eq.Rzb(this.nt.HYb(ka),fb,ea,Ua.Pja)}this.PHa=ha.uJb;this.Htc=ha}return!0}return!1}z2(){if(this.nt){var ka=this.da.ha.Ck;if(this.gridBlockManager&&this.gridBlockManager.$Qd){var fb=this.da.ha.qa.activeCell,ha=!this.gridBlockManager.Rx(fb),ea=this.da.getRangeInformation(this.da.Dp);for(const aa of ea)if(Object(l.a)(ba.AutoDetectRange,
aa))switch(ea=aa,ea.RWh){case 3:if(this.wGc(fb,!0,ea)){if(1!==ka||ha){this.LD();return}c.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.zhe();this.Eq.Yqa(fb,this.CNa);this.i$e||(this.i$e=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.lLh.dgi(ea);
break;default:c.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.LD()}}f5g(ka){const fb=[29];this.da.Gh.tt(ka,fb);this.da.Gh.Nw(fb)}Lob(){return this.$.ea.isNamedObjectViewMode&&D.f(this.$.ma)}zhe(){this.vJb&&!this.AKc&&this.PD&&(this.PD.YD(r.a.Ui,this.$.domElement,this.onKeyDown,!0),this.PD.YD(r.a.rk,this.$.domElement,this.onKeyUp,!0),this.AKc=!0)}X4k(){this.vJb&&this.AKc&&this.PD&&(this.PD.hE(r.a.Ui,this.$.domElement,
this.onKeyDown,!0),this.PD.hE(r.a.rk,this.$.domElement,this.onKeyUp,!0),this.AKc=!1)}static get Pja(){return 1}static wIi(ka){return Y.a.instance.ia(1808)+x.a.space+ka}}Object(A.a)(Ua,"AutoDetectManager",u.a,[])},1392:function(A,u,a){a.r(u);a.d(u,"BusinessBarManager",function(){return I});A=a(135);u=a(0);var c=a(15),b=a(6),h=a(94),r=a(35),f=a(40),l=a(78),m;(function(X){X[X.unableToRefreshLock=0]="unableToRefreshLock";X[X.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";X[X.workbookAlmostTooLarge=
2]="workbookAlmostTooLarge";X[X.workbookTooLarge=3]="workbookTooLarge";X[X.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";X[X.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";X[X.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";X[X.unsupportedFeatures=7]="unsupportedFeatures";X[X.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";X[X.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";
X[X.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";X[X.lastGenericStatusError=11]="lastGenericStatusError";X[X.scratchPadWarning=12]="scratchPadWarning";X[X.authenticationLost=13]="authenticationLost";X[X.odfCompatibilityIssues=14]="odfCompatibilityIssues";X[X.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";X[X.workbookIsIrmProtected=16]="workbookIsIrmProtected";X[X.biFeatureNotAvailable=17]="biFeatureNotAvailable";X[X.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";
X[X.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";X[X.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";X[X.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";X[X.editAttemptInReadOnly=22]="editAttemptInReadOnly";X[X.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";X[X.unsupportedBrowser=24]="unsupportedBrowser";X[X.readOnlyPermissions=25]="readOnlyPermissions";X[X.documentIsIrmProtectedWarning=26]=
"documentIsIrmProtectedWarning";X[X.policyWarningMessage=27]="policyWarningMessage";X[X.workingOnIt=28]="workingOnIt";X[X.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";X[X.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";X[X.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";X[X.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";X[X.legacyConnectionsBB=33]="legacyConnectionsBB";X[X.tooManyLoadBlockingFloatingObjectsBB=
34]="tooManyLoadBlockingFloatingObjectsBB";X[X.groupedSlicersBB=35]="groupedSlicersBB";X[X.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";X[X.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";X[X.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";X[X.wacGdprNotice=39]="wacGdprNotice";X[X.automaticSensitivityLabel=40]="automaticSensitivityLabel";X[X.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";X[X.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";
X[X.localStorageDisabled=43]="localStorageDisabled";X[X.autoRefreshDisabled=44]="autoRefreshDisabled";X[X.corruptedFileRepaired=45]="corruptedFileRepaired";X[X.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";X[X.minorVersionLimitReached=47]="minorVersionLimitReached";X[X.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";X[X.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";X[X.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";
X[X.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";X[X.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";X[X.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";X[X.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";X[X.promptEnableExternalLinks=55]="promptEnableExternalLinks";X[X.networkDown=56]="networkDown";X[X.defaultToViewDueToCogs=
57]="defaultToViewDueToCogs";X[X.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";X[X.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";X[X.canvasHealth=60]="canvasHealth";X[X.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";X[X.optimizeWorkbook=62]="optimizeWorkbook";X[X.novModePostDepreciation=63]="novModePostDepreciation";X[X.officeScriptsRunning=64]="officeScriptsRunning";X[X.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";
X[X.readOnlyPivotTable=66]="readOnlyPivotTable";X[X.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";X[X.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";X[X.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";X[X.dataCleansingSuggestions=70]="dataCleansingSuggestions";X[X.editInMiniWAC=71]="editInMiniWAC";X[X.powerQueryUnsupportedTeams=72]="powerQueryUnsupportedTeams";X[X.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";
X[X.externalConnectionsEnableContentRefreshOnOpen=74]="externalConnectionsEnableContentRefreshOnOpen";X[X.applicationNotification=75]="applicationNotification";X[X.count=76]="count"})(m||(m={}));Object(u.b)("EwaBusinessBarEntryType",m);var x=a(7),n=a(1196);class t extends Sys.EventArgs{constructor(X,Y,ja){ja=void 0===ja?null:ja;super();this.YGa=X;this.ECd=Y;this.data=ja}}Object(u.a)(t,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var w=a(1199),v=a(1197),k=a(1201);a(1200);var y=a(1194),
C=a(551),B=a(39),E=a(772),K=a(36),F=a(1),W=a(23),J=a(70),L=a(74),M=a(1083),Q=a(95),H=a(5),ba=a(1198),U=a(91),D;let I=D=class extends l.a{constructor(X,Y){Y=void 0===Y?!X.Xna:Y;super();this.eh=new f.a;this.V_=null;this.bad=[];this.EOc=()=>{this.$.pa.g1a?this.removeEntry(13):this.Om(13,null)};this.xp=(ja,Ua)=>{for(let ka=0,fb=D.TCc().length;ka<fb;ka++)ja=D.TCc()[ka],this.removeEntry(ja);Ua.context&&0<Ua.context.communicationErrorRetryCount&&(F.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ServerCommunicationBBTimeoutInMs",
0)&&!this.mM(21)?c.ULS.sendTraceTag(507359372,0,20,"OnWebMethodSuccess: webMethod failed initially, but succeeded before timeout, hence no business bar was shown"):c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.Tdb&&(window.clearTimeout(this.Tdb),this.Tdb=null),this.removeEntry(21));this.iqk()};this.Wy=(ja,Ua)=>{var ka;ja=this.Svi(Ua.errors);let fb=[];for(let ea=
0,aa=ja.length;ea<aa;++ea){const ca=ja[ea];if(1===ca.Type&&ca.Appearance&32)fb=this.X4i(ca,fb);else if(Ua.kBk){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var ha=(null===(ka=Ua.context)||void 0===ka?0:ka.stopwatch)?Ua.context.stopwatch.zi:-1;5E3>ha?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${ha}ms).`):
b.AFrameworkApplication.Krj()||this.IAh(ca,Ua.context.methodName)}ha=[...D.TCc()];for(let xa=0,Oa=fb.length;xa<Oa;++xa){const ua=fb[xa];this.Om(ua,ca);Array.remove(ha,ua)}for(let xa=0,Oa=ha.length;xa<Oa;++xa)this.removeEntry(ha[xa])}};this.ij=(ja,Ua)=>{this.ej(ja,Ua)};this.ej=()=>{const ja=this.$.ea;ja.ki||ja.dm()||(this.Uhe(),this.bad.length=0)};this.Cj=(ja,Ua)=>{this.$.ea.dm()&&!Ua.l1||this.sUf(Ua.l1)};this.h2b=()=>{const ja=this.$.userOperationManager.HCc();ja&&ja.operation.flags&1&&this.XUg()};
this.wlg=()=>{this.XUg()};this.Dl=()=>{this.Fef();this.jVg()};this.lJ=()=>{if(this.$.Eoa&&this.$.ea.dm()&&this.$.ea.ki)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const ja=H.Wb.Aa()?Q.a.nh(H.Wb):this.$.la.kh(331);ja&&ja.y0||this.removeEntry(55);this.removeEntry(5)}};this.$=X;this.kfb=Y;this.Tdb=null;a(1436);this.cKh();b.AFrameworkApplication.rj&&
b.AFrameworkApplication.rj.NHb(this);this.neb=Array(76);for(let ja=0;76>ja;ja++)this.neb[ja]=null;this.Yp=E.EcmaDateClock.instance;this.s5f=this.Yp.ri.getTime();Y&&(Y=X.pa,Y.xX(this.Wy),Y.yI(this.xp),Y.VHb(this.EOc),Y.Deb(this.EOc),X.ea.$q(this.ij),X.ea.pz(this.Dl),X.mr(this.Cj),X.gq(this.ej),X.ea.cK(this.lJ),X.userOperationManager.mw(this.h2b),F.EwaSettings.Ra(158)&&X.ea.Vn.get(45)&&b.AFrameworkApplication.fa.ka("SupportsPolicies")||this.VPf(),this.sUf(J.c(X)))}VPf(){K.a.Lx(this.$.ea.RP)&&this.Wy(this,
new C.a(this.$.ea.RP,null,!1,-1,-1,-1,-1,"",-1,"",-1))}pBh(X){this.eh.addHandler("bBarAttachedOrDetached",X)}get QDd(){return this.bad}get domElement(){return this.V_?this.V_.domElement:null}dispose(){if(this.$){const X=this.$,Y=X.pa;Y.wZ(this.Wy);Y.iL(this.xp);Y.PUc(this.EOc);Y.$4b(this.EOc);X.ea.Uq(this.ij);X.ea.LA(this.Dl);X.Wr(this.Cj);X.Yu(this.ej);X.ea.WH(this.lJ);X.userOperationManager.uu(this.h2b);W.f(X).Fh.Cv(this.wlg)}h.a.dh(this.V_);this.$=this.V_=null;super.dispose()}Fhj(X){switch(X){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;
default:return!1}}Vzh(X){switch(X.id){case 16:break;default:return}this.Om(75,null,null,null,{entryToAdd:X})}Om(X,Y,ja,Ua,ka){ja=void 0===ja?null:ja;Ua=void 0===Ua?null:Ua;ka=void 0===ka?null:ka;if(!this.$.isMobileMode||this.Fhj(X))this.kfb&&!this.mM(X)&&(this.neb[X]=this.Yp.Kra,this.V_.EF(X,Y,Ua,ka),this.eh.raiseEvent("bBarAttachedOrDetached",new t(X,!0,ja))),Y&&32===Y.Appearance&&L.a(this.$).xj.ipa(Y)}WUg(X,Y,ja,Ua){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");
y.a.initialize(X,Y,ja,Ua);this.Om(39,null)}pOk(X,Y,ja,Ua){n.a.initialize(X,Y,ja,Ua);this.Om(40,null)}WQk(X,Y,ja,Ua){v.a.initialize(X,Y,ja,Ua);this.Om(41,null)}SOk(X,Y,ja,Ua,ka){ba.a.initialize(X,Y,ja,Ua,ka);this.Om(70,null)}bQk(X,Y,ja,Ua){w.a.initialize(X,Y,ja,Ua);this.Om(42,null)}fRk(X,Y,ja,Ua){k.a.initialize(X,Y,ja,Ua);this.Om(54,null)}removeEntry(X){this.kfb&&(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(m,
X)}`),this.neb[X]=null,this.V_.removeEntry(X)&&this.eh.raiseEvent("bBarAttachedOrDetached",new t(X,!1)))}r6(X){return this.kfb?this.V_.r6(X):!1}mM(X){return this.kfb?this.V_.mM(X):!1}Krb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}c0b(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}cKh(){const {BusinessBarControl:X}=a(1369);
if(this.kfb&&!this.V_){W.f(this.$).Fh.Iv(this.wlg);var Y=document.getElementById(this.$.xi+x.a.wbf);this.V_=new X(this.$,Y)}}Uhe(){this.kfb&&this.V_.Uhe()}iqk(){if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const Y=this.Yp.Kra;if(3E5<=Y-this.s5f){this.s5f=Y;for(let ja=0;76>ja;ja++){var X=this.neb[ja];if(X&&(X=Y-X,3E5<=X)){const Ua=Enum.toString(m,ja);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Ua}] was activated but not turned off for ${X} Millis`)}}}}}Svi(X){const Y=
[];for(const ja of X)switch(ja.MessageId){case -113742550:const Ua=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||K.a.ko(X,Ua))&&Y.push(-113742550)}return K.a.WS(X,Y)}X4i(X,Y){switch(X.MessageId){case 2113407564:const ja=K.a.qgb([1821390342,-943219229,-502303485,1437034227]);for(let Ua=0;Ua<ja.length;Ua++)ja[Ua].HelpTopicId=X.HelpTopicId,ja[Ua].HelpDescription=X.HelpDescription,this.bad.push(ja[Ua])}switch(X.MessageId){case -395951567:this.Om(6,
X);break;case 1643490758:this.Om(4,X);break;case -907264831:this.Om(5,X);break;case 757111532:case 2113407564:this.Om(7,X);break;case 2010656511:this.Om(15,X);break;case 1321660996:this.$.Dnf=!0;this.Om(8,X);break;case 526339737:this.$.Dnf=!0;this.Om(9,X);break;case -407088521:this.Om(10,X);break;case 1756116017:this.Om(14,X);break;case -1703455218:this.Om(17,X);break;case 1393475740:this.Om(25,X);break;case -949523941:this.Om(26,X);break;case 1779381952:Y.push(44);break;case 1421575100:this.Om(45,
X);break;case 613676060:this.Om(46,X);break;case 1233668252:this.Om(61,X);break;case 1911608588:X=!!(this.$.Ij&64);!this.$.ea.dm()&&X&&Y.push(29);break;case 1544494907:break;case -655555355:Y.push(this.o_d()?1:0);break;case -1221382671:Y.push(2);break;case 1662282929:Y.push(3);break;case 104919273:this.$.ea.dm()||Y.push(30);break;case -689453604:X=!!(this.$.Ij&64);this.$.ea.mRf=!0;!this.$.ea.dm()&&X&&Y.push(31);break;case 157762400:this.$.ea.hIc=!0;!this.$.ea.dm()&&this.$.Ij&64&&!this.$.isEditMode&&
Y.push(32);break;case -1125398042:!this.$.ea.dm()&&this.$.Ij&64&&!this.$.isEditMode&&Y.push(34);break;case -73730134:!this.$.ea.dm()&&this.$.Ij&64&&Y.push(33);break;case -293349236:Y.push(65);break;case 1580811823:Y.push(67);break;case -37299333:break;case 136737622:Y.push(47);break;case -1780327030:this.Om(55,X);break;case -113742550:this.Om(57,X);break;case -260312420:this.$.ea.dm()||Y.push(66);break;case 784737213:this.$.ea.dm()||Y.push(70);break;case -156954846:this.Om(74,X);break;default:this.Om(11,
X)}return Y}obj(){if(b.AFrameworkApplication.fa.ka("WildFireExcelBizBar")&&!M.a.ynj(M.a.nEf(1))&&(r.a.Cw||r.a.oo))if(F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void Q.a.resolve(H.cb,{va:1}).then(()=>this.Om(20,null));else{const X=Object(U.d)(Q.a.resolve(H.cb,{va:1}));B.TaskExtensions.Xa(X,()=>{this.Om(20,null)},this.ya,3)}}yaj(X){X||3!==this.$.workbookContext.WorkbookNovType||this.Om(63,null)}get o6k(){return b.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",
!1)}lbj(){this.o6k&&r.a.Tsj&&this.Om(24,null)}sUf(X){(!X&&!this.$.printingEnabled||this.$.uk.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.Om(16,null));this.obj();this.Fef();this.jVg();this.yaj(X);this.lbj()}Fef(){this.$.workbookContext.Options&32768&&this.kPk()}kPk(){this.neb[37]||this.Om(37,null)}ORk(){this.neb[38]||this.Om(38,null)}jVg(){this.$.workbookContext.Options&
524288&&this.Om(59,null)}zte(X,Y){this.Om(58,X,null,Y)}jmc(X,Y){var ja=null,Ua=null;ja=void 0===ja?null:ja;Ua=void 0===Ua?null:Ua;Y=void 0===Y?null:Y;this.V_.mM(X)?this.V_.Czb(X,Y):this.Om(X,null,ja,Ua,Y)}XUg(){this.$.Ij&8&&this.Om(12,null)}o_d(){const X=H.a.Aa()?Q.a.nh(H.a):this.$.la.kh(38);return X?X.zxe:!1}IAh(X,Y){const ja=F.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ServerCommunicationBBTimeoutInMs",0);this.mM(21)||-1387426400===X.MessageId||this.Tdb||(this.Tdb=window.setTimeout(()=>
{this.q_k(X,Y)},ja))}q_k(X,Y){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const ja={};ja.FailedMethod=Y;this.Om(21,X,ja);this.Tdb=null}static TCc(){return D.e6e||(D.e6e=[0,1,2,3,44])}rKd(X){return this.V_.rKd(X)}};I.e6e=null;I=D=Object(A.__decorate)([Object(Q.d)(H.C),Object(A.__param)(0,Object(H.Nb)())],I);Object(u.a)(I,"BusinessBarManager",l.a,[613,4,136])},1397:function(A,u,a){a.r(u);a.d(u,"NetworkConnectionHealthChecker",function(){return y});
A=a(0);var c=a(2),b=a(15),h=a(489),r=a(36),f=a(13),l=a(266);class m{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(A.a)(m,"ConnectionErrorLogInfo",null,[]);var x=a(1210),n=a(1211);class t{constructor(C){this.uSd=[x.a.Tah,x.a.O5c];this.Gt=(B,E)=>{this.CZ[E]=B;this.H6i()&&this.$qk("OnNetworkDownImmediatePing"===B.caller)};this.Hza=C;this.$=C.$;this.CZ={}}Ivj(){const C=n.a.DJd(this.Gt,"OnNetworkDownImmediatePing",this.$,this.uSd);for(const B of C)B.runTest()}H6i(){for(const C of this.uSd)if(void 0===
this.CZ[C]||null===this.CZ[C])return!1;return!0}$qk(C){const B=this.$.km.uha;C&&this.$Vk(B);for(var E of this.uSd)this.CZ[E]=Sys.Serialization.JavaScriptSerializer.serialize(this.CZ[E]);C=Date.now();E=this.Hza.fPd(y.b0b).returnValue;const K=this.Hza.fPd(y.n7b).returnValue;this.CZ.isOfflineMode=B;this.CZ.networkDownBBAge=-1===E?E:C-E;this.CZ.transientServerCommunicationFailuresBBAge=-1===K?K:C-K;this.Hza.businessBar?(this.CZ.isNetworkDownBBShown=this.Hza.businessBar.mM(56).toString(),this.CZ.isServerErrorBBShown=
this.Hza.businessBar.mM(21).toString()):(this.CZ.isNetworkDownBBShown="unknown",this.CZ.isServerErrorBBShown="unknown");b.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.CZ)}`)}$Vk(C){const {NetworkConnectionHealthChecker:B}=a(1397),E={};for(const K of Object.keys(this.CZ)){const F=this.CZ[K];E[F.testName]=F.isSuccess}E.isOfflineMode=C;this.Hza.rve(B.Txd,Sys.Serialization.JavaScriptSerializer.serialize(E))}}Object(A.a)(t,
"ConnectionHealthTestsRunner",null,[]);var w=a(95),v=a(5),k=a(1);class y{constructor(C){this.businessBar=this.fqb=null;this.Rp=k.EwaSettings.Rp("NetworkConnectionHealthChecker");this.bOj=(B,E)=>{E.ECd?this.dOj(E):this.cOj(E)};this.xp=(B,E)=>{B=E.context.methodName;this.fqb&&B===this.fqb&&(b.ULS.sendTraceTag(537155230,0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.fqb}" has now succeeded. Querying local storage for BB showings.`),this.Oqb(y.n7b,!0),this.fqb=null);
this.x9f(!1);this.isc=!1};this.Wy=(B,E)=>{r.a.ko(E.errors,[-1387426400])&&!this.isc&&(this.isc=!0,this.hTg()&&window.performance.mark(y.wgg),(new t(this)).Ivj())};this.CZb=()=>{this.x9f(!0);this.Oqb(y.b0b,!1);this.Oqb(y.n7b,!1)};this.FNa=()=>{this.Oqb(y.b0b,!0)};this.$=C;this.pa=this.$.pa;this.localStorage=new l.a;this.isc=!1;this.Rp?this.$.ea.lw(this.CZb):k.EwaSettings.wl()?this.$.ea.Yq(this.CZb):this.$.ea.lr(this.CZb);this.pa.km.eIb(this.FNa);this.pa.yI(this.xp);void w.a.sj(v.C).then(B=>{const E=
this;return Lo(function*(){E.businessBar=B;B.pBh(E.bOj)})});this.pa.xX(this.Wy)}dispose(){this.$&&(this.$.ea&&(this.Rp?this.$.ea.KA(this.CZb):k.EwaSettings.wl()||this.$.ea.Bv(this.CZb)),this.pa&&(this.pa.km.j5b(this.FNa),this.pa.wZ(this.Wy),this.pa.iL(this.xp)))}dOj(C){const B={};B.Timestamp=Date.now().toString();switch(C.YGa){case 21:this.fqb=C.data.FailedMethod;B.FailedMethod=this.fqb;this.rve(y.n7b,JSON.stringify(B));break;case 56:this.rve(y.b0b,JSON.stringify(B))}}cOj(C){switch(C.YGa){case 21:this.Oqb(y.n7b,
!0);break;case 56:this.Oqb(y.b0b,!0)}}rve(C,B){try{this.localStorage.zl()&&this.localStorage.setItem(C,B)}catch(E){b.ULS.sendTraceTag(537155231,0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${E.message||"Unknown"}`)}}fPd(C){if(this.localStorage.zl()&&(C=this.localStorage.r_a(C))&&"null"!==C){var B=JSON.parse(C);C=parseInt(B.Timestamp,10);B=Sys.Serialization.JavaScriptSerializer.serialize(B);return{returnValue:C,rawData:B}}return{returnValue:-1,
rawData:null}}x9f(C){if(this.localStorage.zl()){const B=this.localStorage.r_a(y.Txd);if(B&&"null"!==B){let E=-1;this.isc&&(E=this.uKi(y.wgg,y.MMj));b.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(B)}, Period offline: ${E}, New session: ${C}`);this.localStorage.removeItem(y.Txd)}}}uKi(C,B){if(!this.hTg())return-1;window.performance.measure(B,C);C=window.performance.getEntriesByName(B);
return C.length&&C[C.length-1]?C[C.length-1].duration:(b.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${B} returned no measures.`),-1)}Oqb(C,B){try{let E;const K=(()=>{let F=this.fPd(C);({rawData:E}=F);return F})().returnValue;if(-1!==K){const F=Object(c.a)(new m,{timeElapsed:Date.now()-K,scenario:C,isNewSession:!B,rawData:E});b.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(F)}`)}this.localStorage.removeItem(C)}catch(E){b.ULS.sendTraceTag(537155226,
0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${E.message||"Unknown"}`)}}hTg(){return f.HelperMethods.Htd&&h.a.xWa}}y.b0b="NetworkDownBBShown";y.n7b="ServerCommunicationFailureBBShown";y.Txd="ConnectionHealthPingRsults";y.wgg="offMoStMa";y.MMj="offMoDuMea";Object(A.a)(y,"NetworkConnectionHealthChecker",null,[4])},1414:function(A,u,a){a.d(u,"a",function(){return f});A=a(0);var c=a(15),b=a(288);class h{constructor(l,m){this.testName=null;
this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=l;this.caller=m;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(A.a)(h,"NetworkTestResult",null,[]);var r=a(688);class f{constructor(l,m,x,n,t){this.url="";this.mnb=!1;this.qQ=-1;this.testIteration=
0;this.baseUrl=x;this.Gig=n;this.lSd=m;this.result=new h(m,t)}runTest(){try{if(this.mnb)return c.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.lSd} is already mid way, not starting a new one.`),!1;this.reset();this.mnb=!0;this.result.startTimeMs=Date.now();const l=new b.QueryStringBuilder(this.baseUrl);l.Eea("tid",this.result.startTimeMs.toString());this.url=l.toString();this.xzk();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(l){return this.VPb("Exeption: "+
l.message),!1}}reset(){this.url="";this.result.reset();this.mnb=!1;this.qQ=-1}clearTimeout(){-1!==this.qQ&&(window.clearTimeout(this.qQ),this.qQ=-1)}xzk(){try{const l=new XMLHttpRequest;l.onreadystatechange=()=>{4===l.readyState&&(200===l.status?this.axi():this.VPb(`Error when downloading resource. status code: ${l.status}, status text: ${l.statusText}`,l.status.toString()))};l.onerror=()=>{this.VPb(`Client error when attempting to download resource. status code: ${l.status}, response: ${l.statusText}`)};
this.qQ=window.setTimeout(()=>{this.qQ=-1;this.VPb("Request timeout")},1E4);l.open("GET",this.url,!0);l.send(null)}catch(l){this.VPb("Exeption: "+l.message)}}axi(){this.mnb&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=r.a(this.url),this.result.isSuccess=!0,this.Vrc())}VPb(l,m){m=void 0===m?null:m;this.mnb&&(this.clearTimeout(),this.result.errorMessage=l,this.result.isSuccess=!1,this.result.errorStatusCode=m,this.Vrc())}Vrc(){this.mnb=
!1;this.Gig&&this.Gig(this.result,this.lSd)}}Object(A.a)(f,"NetworkTestReq",null,[])},1432:function(A,u,a){function c(ca,xa,Oa,ua,Ia,Sa){this.ID=ca;this.type=xa;this.Afl=Oa;this.Ofl=ua;this.Bfl=Ia;this.Pfl=Sa}function b(ca,xa){this.value=ca;this.contextId=xa}function h(ca,xa,Oa,ua,Ia,Sa,Ya,da){this.type=ca;this.U4=xa;this.startTime=null==Oa||void 0==Oa.value?new b(Oa,null):Oa;this.endTime=null==ua||void 0==ua.value?new b(ua,null):ua;this.Sca=null==Ia||void 0==Ia.value?new b(Ia,null):Ia;this.VYa=null==
Sa||void 0==Sa.value?new b(Sa,null):Sa;this.mDg=Ya;this.operationType=da}function r(){}function f(ca,xa){this.ID=ca;this.j5f=xa}function l(){this.Z2=[];this.lxb=this.oxb=null;this.zca=5E3;this.pxb=0;this.dsc=[];this.lib=-1;this.Fwe=0}function m(){this.Index=0;this.Data=[];this.rcc=!1}function x(ca,xa,Oa,ua,Ia,Sa){this.Acc(ca,xa,Oa,ua,Ia,Sa)}function n(ca,xa,Oa,ua,Ia,Sa){this.Acc(ca,xa,Oa,ua,Ia,Sa)}function t(){this.uAa=[];this.Ll=[];this.nfb=[];this.Lqb=this.D5a=this.TVa=0;this.duration=this.startTime=
null;this.a8d=0;this.ojb={};this.Qfb=-1;this.Vhb=0;this.mrb=this.vrb=-1}function w(ca,xa,Oa,ua){K(ua)&&(ua="relative"==ca.style.position);var Ia=0;switch(xa){case 1:Ia=Oa?parseInt(ua?ca.style.marginRight.replace("px",""):ca.style.right.replace("px","")):parseInt(ua?ca.style.marginLeft.replace("px",""):ca.style.left.replace("px",""));break;case 2:Ia=parseInt(ua?ca.style.marginTop.replace("px",""):ca.style.top.replace("px",""));break;case 3:Ia=parseInt(ca.style.height.replace("px",""));break;case 4:Ia=
parseInt(ca.style.width.replace("px",""));break;case 5:Ia=W(ca);break;case 6:Ia=parseInt(ca.scrollTop);break;case 7:Ia=parseInt(ca.scrollLeft);break;case 8:Ia=L(ca)}return Ia}function v(ca){return ca*ca*ca}function k(ca){return 3*ca*ca*(1-ca)}function y(ca){return 3*ca*(1-ca)*(1-ca)}function C(ca){return(1-ca)*(1-ca)*(1-ca)}function B(ca,xa,Oa,ua,Ia){return 0*C(Ia)+xa*y(Ia)+ua*k(Ia)+1*v(Ia)}function E(ca){return"object"==typeof ca&&ca instanceof Array}function K(ca){return null==ca||void 0==ca}function F(ca,
xa){null!=document.body.style.opacity?ca.style.opacity=xa:ca.style.filter=1==xa?"":"alpha(opacity="+String(100*xa)+")"}function W(ca){if(null!=document.body.style.opacity)return ca=ca.style.opacity,null!=ca&&""!=ca?parseFloat(ca):1;ca=ca.style.filter;return null!=ca&&""!=ca?parseInt(ca.replace("alpha(opacity=","").replace(")",""))/100:1}function J(ca,xa){xa="rotate("+xa+"deg)";null!=document.body.style.msTransform?ca.style.msTransform=xa:null!=document.body.style.webkitTransform?ca.style.webkitTransform=
xa:null!=document.body.style.t6d?ca.style.t6d=xa:null!=document.body.style.h8d?ca.style.h8d=xa:null!=document.body.style.transform&&(ca.style.transform=xa)}function L(ca){if(null!=document.body.style.msTransform)var xa=ca.style.msTransform;else null!=document.body.style.webkitTransform?xa=ca.style.webkitTransform:null!=document.body.style.t6d?xa=ca.style.t6d:null!=document.body.style.h8d?xa=ca.style.h8d:null!=document.body.style.transform&&(xa=ca.style.transform);if(!xa)return 0;xa=xa.replace("rotate(",
"");xa=xa.replace("deg)","");return parseFloat(xa)}a.r(u);a.d(u,"WacAnimation",function(){return M});a.d(u,"WacCurve",function(){return c});a.d(u,"WacCurveType",function(){return Q});a.d(u,"WacCurveID",function(){return H});a.d(u,"g_AnimationCurves",function(){return ba});a.d(u,"WacIntWrapper",function(){return b});a.d(u,"WacKeyFrame",function(){return h});a.d(u,"g_numAnimationAttributes",function(){return U});a.d(u,"AnimRelativeTo",function(){return D});a.d(u,"WacKeyframeType",function(){return I});
a.d(u,"g_AnimationContextVariables",function(){return X});a.d(u,"WacAnimation_ContextVariableManager",function(){return r});a.d(u,"WacAnim",function(){return f});a.d(u,"g_WacAnimations",function(){return Y});a.d(u,"g_WacAnimationEngine",function(){return ja});a.d(u,"g_WacAnimationLogging",function(){return Ua});a.d(u,"g_WacAnimationThrottleFPS",function(){return ka});a.d(u,"g_WacAnimationThrottleNumInstance",function(){return fb});a.d(u,"WacAnimationEngine",function(){return l});a.d(u,"g_WacRadix",
function(){return ha});a.d(u,"WacAnimation_State",function(){return m});a.d(u,"WacAnimation_Object",function(){return x});a.d(u,"WacAnimationUnit",function(){return n});a.d(u,"WacAnimationTelemetry",function(){return t});a.d(u,"g_WacAnimationTelemetry",function(){return ea});a.d(u,"g_LastAnimationData",function(){return aa});a.d(u,"GetCurrentAttributeCssValue",function(){return w});a.d(u,"Bezier1",function(){return v});a.d(u,"Bezier2",function(){return k});a.d(u,"Bezier3",function(){return y});a.d(u,
"Bezier4",function(){return C});a.d(u,"CalculateBezier",function(){return B});a.d(u,"IsArrayCheck",function(){return E});a.d(u,"IsNullOrUndef",function(){return K});a.d(u,"SetCssOpacity",function(){return F});a.d(u,"GetCssOpacity",function(){return W});a.d(u,"SetCssRotation",function(){return J});a.d(u,"GetCssRotation",function(){return L});var M={},Q={Instant:0,zcc:1,Linear:2,GL:3},H={Instant:0,zcc:1,Linear:2,dt:3,QEe:4,ZEe:5,hEe:6,iEe:7,wcc:8,jEe:9,cab:10,QDe:11,PDe:12,ODe:13,RDe:14,SDe:15,TDe:16,
UDe:17,VDe:18,xEe:19,NEe:20,qEe:21},ba=Array(22);ba[H.Instant]=new c(H.Instant,Q.Instant,0,0,0,0);ba[H.zcc]=new c(H.zcc,Q.zcc,0,0,0,0);ba[H.Linear]=new c(H.Linear,Q.Linear,0,0,0,0);ba[H.dt]=new c(H.dt,Q.GL,0,0,0,1);ba[H.QEe]=new c(H.QEe,Q.GL,1,0,1,1);ba[H.ZEe]=new c(H.ZEe,Q.GL,0,0,.42,1);ba[H.hEe]=new c(H.hEe,Q.GL,.83,0,1,1);ba[H.iEe]=new c(H.iEe,Q.GL,0,0,.58,1);ba[H.wcc]=new c(H.wcc,Q.GL,.42,0,.58,1);ba[H.jEe]=new c(H.jEe,Q.GL,.1,.25,.75,.9);ba[H.cab]=new c(H.cab,Q.GL,.1,.9,.2,1);ba[H.QDe]=new c(H.QDe,
Q.GL,.1,.9,.2,1);ba[H.PDe]=new c(H.PDe,Q.GL,.9,.1,.2,1);ba[H.ODe]=new c(H.ODe,Q.GL,.4,0,0,1);ba[H.RDe]=new c(H.RDe,Q.GL,.13,.21,.1,.7);ba[H.SDe]=new c(H.SDe,Q.GL,.02,.33,.38,.77);ba[H.TDe]=new c(H.TDe,Q.GL,.57,.17,.95,.75);ba[H.UDe]=new c(H.UDe,Q.GL,0,.19,.07,.72);ba[H.VDe]=new c(H.VDe,Q.GL,0,0,.95,.37);ba[H.xEe]=new c(H.xEe,Q.GL,.66,0,.34,1);ba[H.NEe]=new c(H.NEe,Q.GL,.8,0,.2,1);ba[H.qEe]=new c(H.qEe,Q.GL,.8,0,.2,1);h.prototype={type:0,U4:0,startTime:new b(0,null),endTime:new b(0,null),Sca:new b(0,
null),VYa:new b(0,null),mDg:0,operationType:0};var U=8;M.hk={a9:1,JN:2,Height:3,Width:4,Opacity:5,A6c:6,z6c:7,Fjl:8};var D={Initial:0,Zl:1,Absolute:2},I={yt:0,Add:1};M.zAb={qcc:0};var X=Array(1);X[M.zAb.qcc]=new b(0,M.zAb.qcc);M.Rgl=r;r.prototype={};r.prototype.SetContextVariable=function(ca,xa){X[M.zAb[ca]].value=xa};M.ID={cDe:0,kDe:1,mDe:2,oDe:3,nDe:4,lDe:5,hDe:6,jDe:7,fDe:8,iDe:9,gDe:10,dDe:11,rDe:12,aDe:13,qDe:14,bDe:15,pDe:16,vDe:17,xDe:18,uDe:19,wDe:20,tDe:21,IEe:22,KEe:23,GEe:24,JEe:25,HEe:26,
MEe:27,TEe:28,eFe:29,gFe:30,fFe:31,hFe:32,SEe:33,eDe:34,sDe:35,DEe:36,ZDe:37,YDe:38,GFe:39,HFe:40,FFe:41};var Y=Array(42);Y[M.ID.cDe]=new f(M.ID.cDe,[new h(M.hk.Opacity,H.Instant,0,0,null,1,D.Zl,I.yt)]);Y[M.ID.kDe]=new f(M.ID.kDe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,0,50,null,1,D.Zl,I.yt)]);Y[M.ID.mDe]=new f(M.ID.mDe,[new h(M.hk.a9,H.dt,0,167,null,0,D.Zl,I.Add),new h(M.hk.JN,H.dt,0,167,null,0,D.Zl,I.Add)]);Y[M.ID.oDe]=new f(M.ID.oDe,[new h(M.hk.Height,
H.dt,0,167,null,0,D.Zl,I.Add),new h(M.hk.Width,H.dt,0,167,null,0,D.Zl,I.Add)]);Y[M.ID.nDe]=new f(M.ID.nDe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,0,167,null,1,D.Zl,I.yt)]);Y[M.ID.lDe]=new f(M.ID.lDe,[new h(M.hk.Opacity,H.Linear,0,167,null,0,D.Zl,I.yt)]);Y[M.ID.hDe]=new f(M.ID.hDe,[new h(M.hk.a9,H.dt,0,100,null,0,D.Zl,I.Add),new h(M.hk.JN,H.dt,0,100,null,0,D.Zl,I.Add)]);Y[M.ID.jDe]=new f(M.ID.jDe,[new h(M.hk.Height,H.dt,0,100,null,0,D.Zl,I.Add),new h(M.hk.Width,
H.dt,0,100,null,0,D.Zl,I.Add)]);Y[M.ID.fDe]=new f(M.ID.fDe,[new h(M.hk.Opacity,H.Linear,0,100,null,1,D.Zl,I.yt)]);Y[M.ID.iDe]=new f(M.ID.iDe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,0,100,null,1,D.Zl,I.yt)]);Y[M.ID.gDe]=new f(M.ID.gDe,[new h(M.hk.Opacity,H.Linear,0,100,null,0,D.Zl,I.yt)]);Y[M.ID.dDe]=new f(M.ID.dDe,[new h(M.hk.a9,H.dt,0,267,null,0,D.Zl,I.Add),new h(M.hk.JN,H.dt,0,267,null,0,D.Zl,I.Add)]);Y[M.ID.rDe]=new f(M.ID.rDe,[new h(M.hk.Height,H.dt,
0,267,null,0,D.Zl,I.Add),new h(M.hk.Width,H.dt,0,267,null,0,D.Zl,I.Add)]);Y[M.ID.aDe]=new f(M.ID.aDe,[new h(M.hk.Opacity,H.Linear,0,267,null,1,D.Zl,I.yt)]);Y[M.ID.qDe]=new f(M.ID.qDe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,0,267,null,1,D.Zl,I.yt)]);Y[M.ID.bDe]=new f(M.ID.bDe,[new h(M.hk.Opacity,H.Linear,0,267,null,0,D.Zl,I.yt)]);Y[M.ID.pDe]=new f(M.ID.pDe,[new h(M.hk.A6c,H.dt,0,267,null,0,D.Zl,I.Add),new h(M.hk.z6c,H.dt,0,267,null,0,D.Zl,I.Add)]);Y[M.ID.vDe]=
new f(M.ID.vDe,[new h(M.hk.a9,H.dt,0,750,null,0,D.Zl,I.Add),new h(M.hk.JN,H.dt,0,750,null,0,D.Zl,I.Add)]);Y[M.ID.xDe]=new f(M.ID.xDe,[new h(M.hk.Height,H.dt,0,750,null,0,D.Zl,I.Add),new h(M.hk.Width,H.dt,0,750,null,0,D.Zl,I.Add)]);Y[M.ID.uDe]=new f(M.ID.uDe,[new h(M.hk.Opacity,H.Linear,0,750,null,1,D.Zl,I.yt)]);Y[M.ID.wDe]=new f(M.ID.wDe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,0,750,null,1,D.Zl,I.yt)]);Y[M.ID.tDe]=new f(M.ID.tDe,[new h(M.hk.A6c,H.dt,0,
1E3,null,0,D.Zl,I.Add),new h(M.hk.z6c,H.dt,0,1E3,null,0,D.Zl,I.Add)]);Y[M.ID.IEe]=new f(M.ID.IEe,[new h(M.hk.a9,H.dt,0,367,null,0,D.Zl,I.Add),new h(M.hk.JN,H.dt,0,367,null,0,D.Zl,I.Add)]);Y[M.ID.KEe]=new f(M.ID.KEe,[new h(M.hk.Height,H.dt,0,367,null,0,D.Zl,I.Add),new h(M.hk.Width,H.dt,0,367,null,0,D.Zl,I.Add)]);Y[M.ID.GEe]=new f(M.ID.GEe,[new h(M.hk.Opacity,H.Linear,0,367,null,1,D.Zl,I.yt)]);Y[M.ID.JEe]=new f(M.ID.JEe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,
0,367,null,1,D.Zl,I.yt)]);Y[M.ID.HEe]=new f(M.ID.HEe,[new h(M.hk.Opacity,H.Linear,0,367,null,0,D.Zl,I.yt)]);Y[M.ID.MEe]=new f(M.ID.MEe,[new h(M.hk.A6c,H.Linear,0,X[M.zAb.qcc],null,0,D.Zl,I.Add),new h(M.hk.z6c,H.Linear,0,X[M.zAb.qcc],null,0,D.Zl,I.Add)]);Y[M.ID.TEe]=new f(M.ID.TEe,[new h(M.hk.Opacity,H.Linear,0,0,null,1,D.Zl,I.yt),new h(M.hk.Opacity,H.Linear,0,50,null,0,D.Zl,I.yt)]);Y[M.ID.eFe]=new f(M.ID.eFe,[new h(M.hk.a9,H.dt,0,433,null,0,D.Zl,I.Add),new h(M.hk.JN,H.dt,0,433,null,0,D.Zl,I.Add)]);
Y[M.ID.gFe]=new f(M.ID.gFe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,0,50,null,1,D.Zl,I.yt),new h(M.hk.JN,H.dt,0,0,null,40,D.Zl,I.Add),new h(M.hk.JN,H.dt,0,100,null,0,D.Zl,I.Add)]);Y[M.ID.fFe]=new f(M.ID.fFe,[new h(M.hk.JN,H.Instant,0,0,null,32,D.Zl,I.Add),new h(M.hk.JN,H.Instant,0,100,null,32,D.Zl,I.Add),new h(M.hk.JN,H.dt,101,350,null,0,D.Zl,I.Add),new h(M.hk.Height,H.Instant,0,0,null,0,D.Absolute,I.Add),new h(M.hk.Height,H.Instant,0,100,null,0,D.Absolute,
I.Add),new h(M.hk.Height,H.dt,101,350,null,0,D.Zl,I.Add),new h(M.hk.Opacity,H.Instant,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Instant,0,100,null,1,D.Zl,I.yt)]);Y[M.ID.hFe]=new f(M.ID.hFe,[new h(M.hk.JN,H.dt,0,267,null,32,D.Zl,I.Add),new h(M.hk.Height,H.dt,0,267,null,0,D.Absolute,I.Add),new h(M.hk.Opacity,H.Linear,0,0,null,1,D.Initial,I.yt),new h(M.hk.Opacity,H.Linear,0,267,null,0,D.Absolute,I.yt)]);Y[M.ID.SEe]=new f(M.ID.SEe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,
H.Linear,0,100,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,101,267,null,1,D.Zl,I.yt)]);Y[M.ID.eDe]=new f(M.ID.eDe,[new h(M.hk.a9,H.cab,0,300,null,0,D.Zl,I.Add),new h(M.hk.JN,H.cab,0,300,null,0,D.Zl,I.Add)]);Y[M.ID.sDe]=new f(M.ID.sDe,[new h(M.hk.Height,H.cab,0,300,null,0,D.Zl,I.Add),new h(M.hk.Width,H.cab,0,300,null,0,D.Zl,I.Add)]);Y[M.ID.DEe]=new f(M.ID.DEe,[new h(M.hk.a9,H.wcc,0,750,null,0,D.Zl,I.Add),new h(M.hk.JN,H.wcc,0,750,null,0,D.Zl,I.Add)]);Y[M.ID.ZDe]=new f(M.ID.ZDe,[new h(M.hk.Opacity,
H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,0,200,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.dt,201,500,null,1,D.Zl,I.yt)]);Y[M.ID.YDe]=new f(M.ID.YDe,[new h(M.hk.a9,H.Linear,0,0,null,0,D.Absolute,I.Add),new h(M.hk.JN,H.Linear,0,0,null,0,D.Absolute,I.Add),new h(M.hk.a9,H.Linear,0,200,null,0,D.Absolute,I.Add),new h(M.hk.JN,H.Linear,0,200,null,0,D.Absolute,I.Add),new h(M.hk.a9,H.dt,201,267,null,0,D.Zl,I.Add),new h(M.hk.JN,H.dt,201,267,null,0,D.Zl,I.Add)]);Y[M.ID.GFe]=new f(M.ID.GFe,
[new h(M.hk.a9,H.dt,0,267,null,0,D.Zl,I.Add),new h(M.hk.JN,H.dt,0,267,null,0,D.Zl,I.Add)]);Y[M.ID.HFe]=new f(M.ID.HFe,[new h(M.hk.Opacity,H.Linear,0,0,null,0,D.Absolute,I.yt),new h(M.hk.Opacity,H.Linear,0,267,null,1,D.Zl,I.yt)]);Y[M.ID.FFe]=new f(M.ID.FFe,[new h(M.hk.Opacity,H.Linear,0,267,null,0,D.Zl,I.yt)]);var ja=null,Ua=-1!=window.location.search.indexOf("AnimationLogging=1"),ka=0,fb=3;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||
window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(ca){window.setTimeout(ca,16)}}();M.State=m;M.Object=x;l.prototype={Z2:[],oxb:null,lxb:null,zca:5E3,pxb:0,dsc:[],lib:-1,Fwe:0};l.prototype.AEe=function(){ja.aFe()};l.prototype.ndh=function(){ja.aFe();ja.cFe()};l.prototype.Keh=function(){null==this.oxb&&null==this.lxb&&0==this.pxb&&(this.oxb=window.requestAnimationFrame(l.prototype.AEe),ja.$Ee(),this.pxb=0,ea.Start())};l.prototype.cFe=function(){ea.Meh();
ja.bFe();null!=this.oxb&&(this.oxb=null);this.pxb=0;this.dsc=[];this.Z2=[]};l.prototype.C6c=function(ca){this.Z2[this.pxb++]=ca};l.prototype.D6c=function(ca){for(var xa=0;xa<this.Z2.length;xa++)this.Z2[xa]==ca&&(this.ieh(ca),this.Z2[xa]=null)};l.prototype.aFe=function(){var ca=!1,xa=null;ja.bFe();for(var Oa=0;Oa<this.Z2.length;Oa++)null!=this.Z2[Oa]&&(K(xa)&&(xa=this.Z2[Oa].currentTime),this.lib=Oa,this.Z2[Oa].Leh(),ca=!0);this.lib=-1;ca&&!K(xa)&&ea.Cah(new Date-xa);ca?(ja.$Ee(),window.requestAnimationFrame(l.prototype.AEe)):
this.cFe()};l.prototype.JDe=function(ca,xa){if(null==ca.id||""==ca.id){var Oa="tempAnimID_"+String(this.Fwe);this.Fwe++;ca.id=Oa}ca=ca.id+"_"+String(xa);Oa=this.dsc[ca];if(K(Oa)||Oa==this.lib||null==this.Z2[Oa])this.dsc[ca]=this.lib;else if(ca=this.Z2[Oa],ca.U4.SetAttribute(xa,null),null!=ca.jaa){xa=this.Z2[this.lib];var ua=ca.jaa,Ia=ca.extraData,Sa=xa.jaa,Ya=xa.extraData;xa.jaa=null==Sa?function(){ua(Ia)}:function(){ua(Ia);Sa(Ya)};xa.extraData=null;ca.jaa=null}};l.prototype.ieh=function(ca){if(E(ca.element))for(var xa=
ca.element.length,Oa=0;Oa<xa;Oa++){var ua=ca.element[Oa];0==ua.id.indexOf("tempAnimID_")&&null==ua.id}else ua=ca.element,0==ua.id.indexOf("tempAnimID_")&&null==ua.id};l.prototype.bFe=function(){null!=this.lxb&&(window.clearTimeout(this.lxb),this.lxb=null)};l.prototype.$Ee=function(){this.lxb=window.setTimeout(l.prototype.ndh,this.zca)};var ha=10;m.prototype={Index:0,Data:[],rcc:!1};m.prototype.SetAttribute=function(ca,xa){var Oa=this.tEe(ca);-1==Oa?(Oa=this.Data.length,this.Index+=ca*Math.pow(ha,
Oa),this.Data[Oa]=xa):this.Data[Oa]=xa};m.prototype.URa=function(ca){ca=this.tEe(ca);return-1==ca?null:this.Data[ca]};m.prototype.tEe=function(ca){for(var xa=0,Oa=this.Index;0!=Oa;){if(Oa%ha==ca)return xa;Oa=Math.floor(Oa/ha);xa++}return-1};m.prototype.SetAnimateRight=function(ca){this.rcc=ca};x.prototype={Uqd:-1,delay:0,element:null,PPb:null,jaa:null,extraData:null,Dfb:null,KTf:0,Vbf:null};x.prototype.Acc=function(ca,xa,Oa,ua,Ia,Sa){if(K(Oa))throw"Argument Error: element cannot be null.";if(E(Oa)&&
!E(ua)||!E(Oa)&&E(ua))throw"Argument Error: element and finalState counts do not match";this.Uqd=ca;this.delay=xa;this.element=Oa;this.PPb=ua;this.jaa=Ia;this.extraData=Sa;this.Dfb=[];this.KTf=0;this.Vbf=X};x.prototype.IT=function(ca){return null==ca.contextId?ca.value:this.Vbf[ca.contextId].value};x.prototype.RunAnimation=function(){if(-1!=this.Uqd&&null!=this.element){this.Kch();for(var ca=this.Dfb.length,xa=0;xa<ca;xa++)this.Dfb[xa].C6c()}};x.prototype.Kch=function(){for(var ca=Y[this.Uqd],xa=
null,Oa=ca.j5f.length,ua,Ia=0;Ia<Oa;Ia++){var Sa=ca.j5f[Ia],Ya=this.Ech(Sa),da;if(null!=Ya)if(Ya.Sca.SetAttribute(Sa.type,this.IT(Sa.Sca)),Ya.U4.SetAttribute(Sa.type,Sa.U4),E(this.element)){var Ea=this.element.length;for(da=0;da<Ea;da++)if(ua=this.xcc(Sa,da),K(ua)){Ya.U4.SetAttribute(Sa.type,null);break}else Ya.G8[da].SetAttribute(Sa.type,ua)}else ua=this.xcc(Sa,-1),K(ua)?Ya.U4.SetAttribute(Sa.type,null):Ya.G8.SetAttribute(Sa.type,ua);else{Ya=new n(this.element,this.IT(Sa.startTime)+this.delay,this.IT(Sa.endTime)-
this.IT(Sa.startTime),null,null,this.PPb.rcc);Ya.Sca.SetAttribute(Sa.type,this.IT(Sa.Sca));Ya.U4.SetAttribute(Sa.type,Sa.U4);if(E(this.element))for(Ea=this.element.length,da=0;da<Ea;da++)if(null==Ya.G8&&(Ya.G8=Array(this.element.length)),null==Ya.G8[da]&&(Ya.G8[da]=new m),ua=this.xcc(Sa,da),K(ua)){Ya.U4.SetAttribute(Sa.type,null);break}else Ya.G8[da].SetAttribute(Sa.type,ua);else null==Ya.G8&&(Ya.G8=new m),ua=this.xcc(Sa,-1),K(ua)?Ya.U4.SetAttribute(Sa.type,null):Ya.G8.SetAttribute(Sa.type,ua);if(null==
xa||xa.delay+xa.duration<=Ya.delay+Ya.duration)xa=Ya;this.Dfb[this.KTf++]=Ya}}null!=xa&&(xa.jaa=this.jaa,xa.extraData=this.extraData)};x.prototype.Ech=function(ca){for(var xa=this.Dfb.length,Oa=0;Oa<xa;Oa++){var ua=this.Dfb[Oa];if(ua.delay==this.IT(ca.startTime)+this.delay&&ua.duration==this.IT(ca.endTime)-this.IT(ca.startTime))return ua}return null};x.prototype.xcc=function(ca,xa){var Oa=null;if(!K(this.IT(ca.VYa)))switch(ca.mDg){case 0:Oa=E(this.element)?this.element[xa]:this.element;Oa=null==this.IT(ca.Sca)?
w(Oa,ca.type,this.PPb.rcc):this.IT(ca.Sca);Oa=0==ca.operationType?this.IT(ca.VYa)*Oa:this.IT(ca.VYa)+Oa;break;case 1:xa=(E(this.element)?this.PPb[xa]:this.PPb).URa(ca.type);K(xa)||(Oa=0==ca.operationType?this.IT(ca.VYa)*xa:this.IT(ca.VYa)+xa);break;case 2:Oa=this.IT(ca.VYa)}return Oa};n.prototype={element:null,delay:0,duration:0,Sca:null,C5a:null,G8:null,U4:null,jaa:null,extraData:null,startTime:null,yGd:!1,JIb:!1,F6a:!1};n.prototype.Acc=function(ca,xa,Oa,ua,Ia,Sa){this.element=ca;this.delay=xa;this.duration=
Oa;this.jaa=ua;this.extraData=Ia;this.Sca=new m;this.G8=this.C5a=null;this.U4=new m;this.startTime=null;this.yGd=!1;this.JIb=Sa;this.F6a=!1};n.prototype.C6c=function(){null==ja&&(ja=new l);null==ja.oxb&&ja.Keh();"relative"==this.element.style.position&&(this.F6a=!0);this.startTime=new Date;this.currentTime=new Date;ja.C6c(this)};n.prototype.D6c=function(){ja.D6c(this)};n.prototype.Leh=function(){this.currentTime=new Date;var ca=Number(this.currentTime)-Number(this.startTime);if(!(ca<this.delay)){ca-=
this.delay;for(var xa=!0,Oa=!this.yGd,ua=U,Ia=1;Ia<=ua;Ia++){var Sa=this.U4.URa(Ia);if(!K(Sa))if(Sa=this.Wdh(ca,this.duration,Sa),E(this.element))for(var Ya=this.element.length,da=0;da<Ya;da++){var Ea=this.element[da];var oa=this.Sca.URa(Ia);var za=this.G8[da];za=za.URa(Ia);K(oa)&&(null==this.C5a&&(this.C5a=Array(this.element.length)),K(this.C5a[da])&&(this.C5a[da]=new m),oa=this.C5a[da].URa(Ia),K(oa)&&(oa=w(Ea,Ia,this.JIb,this.F6a),this.C5a[da].SetAttribute(Ia,oa)));oa+=Sa*(za-oa);ca>=this.duration||
1<Sa?oa=za:xa=!1;Oa&&ja.JDe(Ea,Ia);this.YEe(Ia,Ea,oa)}else oa=this.Sca.URa(Ia),za=this.G8,za=za.URa(Ia),K(oa)&&(oa=w(this.element,Ia,this.JIb,this.F6a),this.Sca.SetAttribute(Ia,oa)),oa+=Sa*(za-oa),ca>=this.duration||1<Sa?oa=za:xa=!1,Oa&&ja.JDe(this.element,Ia),this.YEe(Ia,this.element,oa)}this.yGd=!0;xa&&(this.D6c(),null!=this.jaa&&(ea.Vra("calling fnishfunc"),this.jaa(this.extraData)))}};n.prototype.Wdh=function(ca,xa,Oa){var ua=0;Oa=ba[Oa];switch(Oa.type){case 0:ua=1;break;case 1:ua=ca<xa?0:1;break;
case 2:ua=ca/xa;break;case 3:ua=B(Oa.Afl,Oa.Ofl,Oa.Bfl,Oa.Pfl,ca/xa)}return ua};n.prototype.YEe=function(ca,xa,Oa){ea.ojb[xa.id]=!0;switch(ca){case 1:this.Peh(xa,Oa);break;case 2:this.Ueh(xa,Oa);break;case 3:this.Oeh(xa,Oa);break;case 4:this.Veh(xa,Oa);break;case 5:this.Qeh(xa,Oa);break;case 6:this.Teh(xa,Oa);break;case 7:this.Seh(xa,Oa);break;case 8:this.Reh(xa,Oa)}};n.prototype.Peh=function(ca,xa){this.JIb?this.F6a?ca.style.marginRight=String(xa)+"px":ca.style.right=String(xa)+"px":this.F6a?ca.style.marginLeft=
String(xa)+"px":ca.style.left=String(xa)+"px";Ua&&ea.Vra("element: "+ca.id+", "+(this.JIb?"right":"left")+": "+String(xa)+", timestamp: "+String(Number(new Date)))};n.prototype.Ueh=function(ca,xa){this.F6a?ca.style.marginTop=String(xa)+"px":ca.style.top=String(xa)+"px";Ua&&ea.Vra("element: "+ca.id+", top: "+String(ca.style.top)+", timestamp: "+String(Number(new Date)))};n.prototype.Oeh=function(ca,xa){ca.style.height=String(xa)+"px";Ua&&ea.Vra("element: "+ca.id+", height: "+String(ca.style.height)+
", timestamp: "+String(Number(new Date)))};n.prototype.Veh=function(ca,xa){ca.style.width=String(xa)+"px";Ua&&ea.Vra("element: "+ca.id+", width: "+String(ca.style.width)+", timestamp: "+String(Number(new Date)))};n.prototype.Qeh=function(ca,xa){F(ca,xa);Ua&&ea.Vra("element: "+ca.id+", opacity: "+String(xa)+", timestamp: "+String(Number(new Date)))};n.prototype.Teh=function(ca,xa){ca.scrollTop=xa;Ua&&ea.Vra("element: "+ca.id+", scrollTop: "+xa+", timestamp: "+String(Number(new Date)))};n.prototype.Seh=
function(ca,xa){ca.scrollLeft=xa;Ua&&ea.Vra("element: "+ca.id+", scrollLeft: "+xa+", timestamp: "+String(Number(new Date)))};n.prototype.Reh=function(ca,xa){J(ca,xa);Ua&&ea.Vra("element: "+ca.id+", rotateZ: "+xa+", timestamp: "+String(Number(new Date)))};t.prototype={uAa:null,Ll:null,M6e:5,nfb:null,TVa:0,D5a:0,Lqb:0,startTime:null,duration:null,a8d:0,ojb:null,Qfb:-1,Vhb:0,vrb:-1,mrb:-1};t.prototype.Start=function(){this.startTime=new Date;this.Lqb=this.D5a=0;this.ojb={}};t.prototype.Meh=function(){this.duration=
Number(new Date)-Number(this.startTime);this.a8d=ja.pxb;this.sbh();this.Lqb=this.D5a=0};t.prototype.Cah=function(ca){this.uAa[this.D5a++]=ca};t.prototype.Vra=function(ca){this.Ll[this.Lqb++]=ca};t.prototype.tbh=function(){var ca=0,xa=Number.MAX_VALUE,Oa=Number.MIN_VALUE,ua=0,Ia=0,Sa="",Ya="",da=new Date,Ea="",oa=this.duration;K(oa)&&(oa=Number(da)-Number(this.startTime));if(Ua&&0<this.Lqb)for(var za=this.Lqb,la=0;la<za;la++)0!=la&&(Sa+="<br/>"),Sa+=this.Ll[la];if(0<this.D5a){ca=this.D5a;for(la=0;la<
ca;la++)this.uAa[la]<xa&&(xa=this.uAa[la]),this.uAa[la]>Oa&&(Oa=this.uAa[la]),ua+=this.uAa[la],0!=la&&(Ya+=", "),Ya+=this.uAa[la];1<ca&&(ua/=ca-1);ua=Math.round(100*ua)/100;for(la=0;la<ca;la++)za=this.uAa[la]-ua,za*=za,Ia+=za;1<ca&&(Ia/=ca-1);Ia=Math.sqrt(Ia);Ia=Math.round(100*Ia)/100;ca=this.D5a/oa*1E3;ca=Math.round(ca)}for(var Ca in this.ojb)Ea+=Ca,Ea+=",";if(-1==this.vrb||ca<this.vrb)this.vrb=ca;if(-1==this.mrb||ca>this.mrb)this.mrb=ca;0==this.Vhb?(this.Vhb++,this.Qfb=ca):(la=this.Qfb*this.Vhb,
this.Vhb++,this.Qfb=(la+ca)/this.Vhb);la=Array(12);la[0]=oa;la[1]=ca;la[2]=xa;la[3]=Oa;la[4]=ua;la[5]=Ia;la[6]=Ya;la[7]=Sa;la[8]=this.a8d;la[9]=Number(this.startTime);la[10]=Number(da);la[11]=Ea;return la};t.prototype.sbh=function(){var ca=this.tbh();aa=ca;this.Neh(ca)};t.prototype.Neh=function(ca){this.nfb[this.TVa]=ca;this.TVa++;this.TVa%=this.M6e};t.prototype.GetRecentAnimationStats=function(){for(var ca=[],xa=0,Oa=ea.TVa;Oa<ea.M6e;Oa++)null!=ea.nfb[Oa]&&(ca[xa]=ea.nfb[Oa],xa++);for(Oa=0;Oa<ea.TVa;Oa++)null!=
ea.nfb[Oa]&&(ca[xa]=ea.nfb[Oa],xa++);return ca};t.prototype.GetAnimationSqmStats=function(){var ca=[];ca[0]=0>ea.Qfb?0:ea.Qfb;ca[1]=0>ea.vrb?0:ea.vrb;ca[2]=0>ea.mrb?0:ea.mrb;return ca};var ea=new t,aa=null;M.Telemetry=ea},1436:function(A,u,a){u=a(483);a=a(1437);a=a.Qw?a.default:a;"string"===typeof a&&(a=[[A.i,a,""]]);u(a,{insert:"head",eD:!1});A.exports=a.EH||{}},1437:function(A,u,a){u=a(484)(!1);u.push([A.i,".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:700}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-button-holder,.ewa-bb-entry-link,.ewa-bb-entry-message,.ewa-bb-entry-title{vertical-align:middle}.ewa-nov2-ltr .ewa-bb-entry-close,.ewa-root-ltr .ewa-bb-entry-close{right:2px}.ewa-nov2-ltr .ewa-bb-content,.ewa-root-ltr .ewa-bb-content{margin-right:26px}.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-nov2-ltr .ewa-bb-entry-link,.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-root-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-nov2-rtl .ewa-bb-entry-close,.ewa-root-rtl .ewa-bb-entry-close{left:2px}.ewa-nov2-rtl .ewa-bb-content,.ewa-root-rtl .ewa-bb-content{margin-left:26px}.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-nov2-rtl .ewa-bb-entry-link,.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-root-rtl .ewa-bb-entry-link{margin-right:8px}",
""]);A.exports=u},1438:function(A,u,a){a.r(u);a.d(u,"AutoDetectActionButton",function(){return f});A=a(0);u=a(78);var c=a(1387),b=a(60),h=a(12),r=a(23);class f extends u.a{constructor(l,m,x,n,t){super();this.$=l;this.gM=n.GMb(l,m,x,"",b.a.An(11),t,"AutoDetectPointerDown",h.a.instance.ia(1808)+"...")}get IE(){return this.gM.IE}dispose(){this.gM.dispose();this.$=null;super.dispose()}domElement(l){return this.gM.domElement(l)}getButton(l){return this.gM.getButton(l,!1)}Rzb(l,m,x,n){this.gM.t$a(c.a.wIi(l),
m,n);this.gM.M3c(x,m,n)}Yqa(l,m){const x=r.f(this.$),n=x.fh.Lo(l);l=x.yl(l,n);const t=x.sl(n).Vr;if(l&&0<=l.x&&0<=l.y&&t.width>l.width+160){let w=l.bottomRight.x+this.IE,v=l.topLeft.y+this.IE,k=!1;w+160>t.bottomRight.x&&(w=l.topLeft.x-this.IE,k=!0);if(v<t.topLeft.y+this.IE){if(x.fh.V9a){this.hide();return}v=t.topLeft.y+this.IE}this.gM.XDd(m,n);this.fv(w,v,x.rtl,n,k)}else this.hide()}fv(l,m,x,n,t){this.gM.fv(l,m,x,n,!1,t)}hide(){this.gM.hide()}}Object(A.a)(f,"AutoDetectActionButton",u.a,[])},917:function(A,
u,a){a.d(u,"a",function(){return M});A=a(0);var c=a(2),b=a(15),h=a(94),r=a(290),f=a(17),l=a(158),m=a(182),x=a(6),n=a(98);u=a(265);var t=a(1195),w=a(19),v=a(7),k=a(368),y=a(60),C=a(16),B=a(69),E=a(12),K=a(23),F=a(96),W=a(1080),J=a(1),L=a(156);class M extends u.a{constructor(Q,H){super(document.createElement("div"));this.h7f=this.w6e=this.O0e=this.wrc=this.Xoa=this.dka=this.g_=this.EI=null;this.Pga=this.W5=this.Vx=this.hideCloseButton=!1;this.lPj=ba=>{this.RD(ba)};this.rPj=ba=>{13===ba.keyCode&&this.RD(ba)};
this.B8d=ba=>{this.ur(ba.Dh);return!0};this.H8d=ba=>{this.b7(ba.Dh);return!0};this.HPc=ba=>{this.dZ(ba.Dh?ba.Dh:0);return!0};this.mPj=ba=>{this.RD(ba.La);return!0};this.eeh=ba=>{ba=void 0===ba?null:ba;this.ur(ba.inputMethod?ba.inputMethod:0);return!0};this.feh=ba=>{ba=void 0===ba?null:ba;this.b7(ba.inputMethod?ba.inputMethod:0);return!0};this.Ada=Q;this.nA=H;this.Jsd=H.YGa.toString();this.title=H.title;this.message=H.message;this.set_visibilityMode(1)}get YGa(){return this.nA.YGa}get businessBar(){return this.Ada}get actionButton(){return this.nA?
this.nA.actionButton:""}get RVa(){return this.nA?this.nA.RVa:""}get linkText(){return this.nA?this.nA.link:""}get FLc(){return this.nA?this.nA.FLc:""}get Xx(){return this.nA?this.nA.Xx:""}get alt(){return this.nA?this.nA.alt:""}ABa(Q){this.nA.businessBarType=Q}dispose(){h.a.gj([this.wrc,this.g_,this.dka]);this.Vx&&this.g_&&(r.a.instance.Qa(f.a.click,this.g_.domElement,this.B8d),l.a.instance.N2(this.domElement,this.O0e));this.W5&&this.dka&&(r.a.instance.Qa(f.a.click,this.dka.domElement,this.H8d),l.a.instance.N2(this.domElement,
this.w6e));this.Pga&&this.Xoa&&(r.a.instance.Qa(f.a.click,this.Xoa,this.HPc),l.a.instance.N2(this.domElement,this.h7f));this.Xoa=this.EI=this.Ada=this.dka=this.g_=null;super.dispose()}update(){}V6k(){this.Plf(!0)}tkf(){this.Plf(!1)}g9h(){const Q=this.businessBar.$.Eh.em("DOMUpdate","ReactBusinessBar");Q.start();this.message=F.a.Qm(this.message);this.title=F.a.Qm(this.title);m.a.aNd().then(H=>{H.initializeMessageBarInStore();const ba=Object(c.a)(new W.a,{messageTitle:this.title,message:this.message,
isMultiline:!1,messageBarType:this.nA.businessBarType,dismissButtonAriaLabel:E.a.instance.ia(10),closeable:J.EwaSettings.isChangeGateEnabled("OfficeVSO:8549880_BizBarCloseIconChange")?!this.hideCloseButton:void 0});this.hideCloseButton||(ba.onDismiss=this.mPj);this.Pga&&(ba.linkProps=Object.assign({},{["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.HPc},J.EwaSettings.isChangeGateEnabled("OfficeVSO:8717551_AriaLabelForBusinessBarLinks")&&0<this.FLc.length?{["aria-label"]:this.FLc}:
{}));this.Vx&&(ba.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.eeh});this.W5&&(ba.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.RVa,["onExecute"]:this.feh});J.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.nA.iconName&&(ba.messageBarIconProps={["iconName"]:this.nA.iconName});H.createNewMessageBarWithCallback(this.domElement,ba,()=>{x.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")&&
(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");Object(L.d)(()=>{var U,D;return null===(D=null===(U=this.businessBar)||void 0===U?void 0:U.domElement)||void 0===D?void 0:D.appendChild(this.domElement)});Q.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.nA.MIa} in: ${Q.zi} milliSeconds.`)});return null},H=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.nA.MIa} could not be initialized. ${H}`);
return null})}o8h(Q){const H=this.businessBar.$.Eh.em("DOMUpdate","LegacyBusinessBar");H.start();Q||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var ba=this.businessBar.$.xi;Q=ba+"ewaBusinessBarEntryBody"+this.Jsd;const U=ba+"ewaBusinessBarEntryTitle"+this.Jsd;var D=ba+"ewaBusinessBarEntryIcon"+this.Jsd;this.domElement.className=t.c;C.DOMElementExtensions.nM(this.domElement);ba=document.createElement("div");ba.className=t.d;ba.id=Q;var I=document.createElement("div");
I.className=t.b;var X=document.createElement("a");X.className=t.l;X.title=this.alt;var Y=document.createElement("span");Y.classList.add(w.a.Hwd);Y.classList.add(t.h);Y.id=D;this.Xx.length&&(D=document.createElement("img"),D.classList.add(this.Xx),D.src=y.a.An(0),Y.appendChild(D));X.appendChild(Y);I.appendChild(X);X=document.createElement("span");X.classList.add(t.k);X.id=U;X.innerText=F.a.Qm(this.title);I.appendChild(X);X=document.createElement("span");X.classList.add(t.j);X.id="message";X.innerText=
F.a.Qm(this.message);I.appendChild(X);X=document.createElement("a");X.id="link";X.href="#";X.className=t.i;X.innerText=F.a.Qm(this.linkText);I.appendChild(X);X=document.createElement("span");X.classList.add(t.f);Y=document.createElement("button");Y.type="button";Y.id="action";Y.className=t.e;Y.innerText=F.a.Qm(this.actionButton);X.appendChild(Y);I.appendChild(X);X=document.createElement("span");X.classList.add(t.f);Y=document.createElement("button");Y.type="button";Y.id="altAction";Y.className=t.e;
Y.innerText=F.a.Qm(this.RVa);X.appendChild(Y);I.appendChild(X);ba.appendChild(I);I=document.createElement("a");I.className=t.g;I.tabIndex=0;I.setAttribute("role","button");X=document.createElement("span");X.id="close";X.classList.add(w.a.z4);Y=document.createElement("img");Y.classList.add(w.a.BFd);Y.src=y.a.An(13);Y.alt=E.a.instance.ia(793);Y.title=E.a.instance.ia(793);Y.setAttribute("role","button");X.appendChild(Y);I.appendChild(X);ba.appendChild(I);this.domElement.appendChild(ba);C.DOMElementExtensions.pL(this.domElement,
v.a.wua,U,Q);this.Xoa=$get("link",this.domElement);C.DOMElementExtensions.setVisible(this.Xoa,this.Pga);this.Pga&&(r.a.instance.xa(f.a.click,this.Xoa,this.HPc),this.h7f=l.a.instance.e2(this.Xoa,this.HPc,n.a.yu,n.a.dDa));this.g_=new k.a(C.DOMElementExtensions.getElementById(this.domElement,"action"));this.g_.isVisible=this.Vx;this.dka=new k.a(C.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.dka.isVisible=this.W5;this.Vx&&(r.a.instance.xa(f.a.click,this.g_.domElement,this.B8d),
this.O0e=l.a.instance.e2(this.g_.domElement,this.B8d,n.a.yu,n.a.dDa),this.W5&&(r.a.instance.xa(f.a.click,this.dka.domElement,this.H8d),this.w6e=l.a.instance.e2(this.g_.domElement,this.H8d,n.a.yu,n.a.dDa)));this.EI=$get("close",this.domElement);this.wrc=this.pl.Yk(this.EI);this.wrc.Ba("click",this.lPj);this.wrc.Ba("keydown",this.rPj);C.DOMElementExtensions.setVisible(this.EI,!this.hideCloseButton);H.stop();b.ULS.sendTraceTag(508387361,0,50,`Legacy Business Bar created for ${this.nA.MIa} in: ${H.zi} milliSeconds.`)}Plf(Q){J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.g9h():this.o8h(Q)}ur(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.nA.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.nA.MIa}`);K.f(this.businessBar.$).Tz(!0)}b7(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.nA.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.nA.MIa}`);K.f(this.businessBar.$).Tz(!0)}dZ(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.nA.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.nA.MIa}`);K.f(this.businessBar.$).Tz(!0)}RD(Q){b.ULS.sendTraceTag(21517971,
0,50,`BusinessBar [${this.nA.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.nA.MIa}`);this.set_visible(!1);this.businessBar.removeEntry(this.YGa);B.g(Q)}nna(){return J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.g_.domElement}}Object(A.a)(M,"BusinessBarEntry",u.a,[])},972:function(A,u,a){a.r(u);a.d(u,"ConvertToLinkedEntityManager",function(){return db});A=a(135);u=a(0);var c=a(15),b=a(94),h=a(245),
r=a(6),f=a(33),l=a(1003),m=a(145),x=a(42),n=a(40),t=a(19),w=a(7),v=a(168),k=a(1387),y=a(1163),C=a(189),B=a(653),E=a(395),K=a(64);const F=(gb,Kb,ub,lb,Ba,ra,wb,mc,xb,Ec,ed)=>{ed=gb.$a(1,void 0===ed?null:ed);ed.selectedRanges=Kb;ed.isChangeObject=ub;ed.isFloodgateEnabled=lb;ed.isStarterData=Ba;ed.starterDataDomainId=ra;return K.h(gb,"GetDataSelectorPaneData",ed,wb,mc,xb,Ec,4)};var W=a(142),J=a(944),L=a(1077);class M{}M.m9i="EnrichmentContentFrame";M.width=320;Object(u.a)(M,"EnrichmentConstants",null,
[]);class Q{constructor(gb){this.messageType=0;this.messageType=gb}}Object(u.a)(Q,"EnrichmentResponseMessage",null,[]);class H extends Q{constructor(gb,Kb){super(gb);this.messageContent=null;this.messageContent=Kb}}Object(u.a)(H,"EnrichmentResponseMessageWithContent",Q,[]);class ba extends H{constructor(gb,Kb,ub){super(gb,Kb);this.telemetryJson=null;this.telemetryJson=ub}}Object(u.a)(ba,"EnrichmentResponseMessageWithContentAndTelemetryData",H,[]);var U=a(599),D=a(17),I=a(130),X=a(53),Y=a(98),ja=a(158),
Ua=a(47),ka=a(79),fb=a(35),ha=a(136),ea=a(910),aa=a(26),ca=a(22);class xa{constructor(gb,Kb,ub,lb,Ba){this.rF=this.ht=this.ZNe=this.XNe=this.wF=this.jE=null;this.FG=!1;this.ymg=ra=>{ra=ra.La.keyCode;return ra===Sys.UI.Key.enter||ra===Sys.UI.Key.space?(this.yrc(),!0):!1};this.Vlg=()=>{};this.xPc=()=>{};this.Wlg=ra=>{ra=ra.rawEvent;if(!this.wF||-1!==this.wF.src.indexOf(ra.origin)){try{var wb=Ua.a(ra.data)}catch(mc){return}if(!ea.c(wb.messageType))switch(wb.messageType){case 2:this.sSc(new ba(1,Ua.c(this.XNe),
this.ZNe));break;case 1:this.sSc(new H(0,this.vEi()));break;case 3:this.jE&&this.jE.selectEntity(wb.messageContent);break;case 5:this.jE&&this.jE.N_b(wb.messageContent);break;case 8:this.jE&&(wb=Ua.a(wb.messageContent),0<wb.DomainId?this.jE.wne(wb.Query,wb.TelemetryJson,wb.DomainId,wb.DomainIdString):this.jE.searchEntity(wb.Query,wb.TelemetryJson));break;case 6:this.jE&&this.jE.cancelSearch();break;case 11:wb=Ua.a(wb.messageContent);wb=xa.ptc("keydown","f6",Y.a.Icc,!0,!1,wb,!0,!1);this.wF&&this.wF.dispatchEvent(wb);
break;case 12:if(Ua.a(wb.messageContent).keyCode===Y.a.d_&&(wb=xa.ptc("keydown","esc",Y.a.d_,!0,!1,!1,!1,!1),this.wF&&(this.wF.dispatchEvent(wb),this.hide(),this.jE)))this.jE.onPaneClosed();break;case 13:this.jE&&this.jE.R6b(wb.messageContent);break;case 14:this.jE&&this.jE.Rxb(wb.messageContent);break;case 15:this.jE&&this.jE.h9b(wb.messageContent);break;case 16:this.jE&&(wb=Ua.a(wb.messageContent),this.jE.R0a(wb.DomainId,wb.DomainIdString))}}};this.zu=gb;this.ol=Kb;this.wka=ub;this.Wi=lb;this.$f=
Ba;this.gEa=ja.a.Gy(Y.a.xRa,0)}get yxb(){return!0}get VOb(){return r.AFrameworkApplication.fa.Ya("EnrichmentPaneUrl")}dispose(){this.yxb&&this.rF&&(this.zu.Qa(D.a.click,this.rF,Object(W.a)(this,this.Uza,"onClosePaneClick")),this.ol.Qa(D.a.rk,this.rF,this.ymg));this.rF=null;this.wF&&(this.G5k(),this.wF.parentNode.removeChild(this.wF),this.wF=null);this.Wi.cr("EnrichmentPaneId").WB(this.gEa)}show(gb,Kb,ub){this.jE=gb;this.FG||(this.ht=this.ftc(),this.rme.appendChild(this.ht),this.eik(),this.$f.Uh(aa.a.ogf,
ha.a.frame,Object(W.a)(this,this.z2i,"handleEscapeKeyAction")),this.zqe(),this.FG=!0);this.wF.src=this.VOb&&this.VOb.length?this.VOb+"?culture="+Kb.market+"&appName="+Kb.applicationName+"&themeId="+Kb.themeId+"&featuresBitMask="+Kb.featuresBitMask:xa.Mfg;this.XNe=Kb;this.ZNe=ub;this.showInternal()}G3c(gb,Kb){gb=new ba(2,gb,Kb);this.sSc(gb)}zqe(){const gb=this.Wi.cr("EnrichmentPaneId");gb.parent=U.AFrame.crb;this.zu.amc("EnrichmentPaneId",this.ht);gb.bindAction(this.gEa,aa.a.ogf)}oPg(){if(this.wF){I.FocusManager.MCa(this.wF.contentWindow);
const gb=new ba(4,null,null);this.sSc(gb)}}Uza(){this.yrc();return!0}yrc(){this.hide();if(this.jE)this.jE.onPaneClosed()}ftc(){const gb=J.a("div","EnrichmentPaneId","EnrichmentPane");this.yxb&&gb.appendChild(this.D6h());this.Ccj(gb);return gb}D6h(){const gb=J.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),Kb=J.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");Kb.innerText=Object(ca.a)("EnrichmentPaneTitle");Kb.title=Object(ca.a)("EnrichmentPaneTitle");const ub=L.a.jh("CloseEnrichmentPane",
"EnrichmentPaneCloseButton",Object(ca.a)("Close"),"ClosePaneGlyph_16x16x32",!1);this.zu.xa(D.a.click,ub,Object(W.a)(this,this.Uza,"onClosePaneClick"));this.ol.xa(D.a.rk,ub,this.ymg);gb.appendChild(Kb);gb.appendChild(ub);this.rF=ub;return gb}Ccj(gb){this.wF=J.b("iframe","","EnrichmentFrame");gb.appendChild(this.wF);this.wF.id=M.m9i;this.wF.setAttribute("role","presentation")}eik(){X.a.addHandler(this.wF,"load",this.Vlg);X.a.addHandler(this.wF,"error",this.xPc);$addHandler(window,"message",this.Wlg)}G5k(){X.a.removeHandler(this.wF,
"load",this.Vlg);X.a.removeHandler(this.wF,"error",this.xPc);$removeHandler(window,"message",this.Wlg)}Ibi(){this.wF.src=xa.Mfg}hide(){this.hideInternal();this.Ibi()}z2i(gb,Kb,ub){if(1!==ub&&(this.hide(),this.jE))this.jE.onPaneClosed();return 32}vEi(){return Ua.c([2,1,3,5,8,6])}sSc(gb){gb=Ua.c(gb);this.wF.contentWindow.postMessage(gb,ka.a.getOrigin(this.VOb))}static ptc(gb,Kb,ub,lb,Ba,ra,wb,mc){fb.a.iS?(ra=String.format("{0} {1} {2}",ra?"Shift":"",wb?"Control":"",mc?"Alt":""),ra.trim(),ub=document.createEvent("KeyboardEvent"),
ub.initKeyboardEvent(gb,lb,Ba,window.self,Kb,0,ra,!1,"en-US")):(Kb={},Kb.keyCode=ub,Kb.ctrlKey=wb,Kb.shiftKey=ra,Kb.altKey=mc,Kb.bubbles=lb,Kb.cancelable=Ba,ub=new KeyboardEvent(gb,Kb));return ub}}xa.Mfg="about:blank";Object(u.a)(xa,"EnrichmentPane",null,[688,4]);var Oa=a(1);class ua extends xa{constructor(gb){super(r.AFrameworkApplication.ra.CJ,r.AFrameworkApplication.ra.fI,r.AFrameworkApplication.ra.uCa,r.AFrameworkApplication.ra.Km,r.AFrameworkApplication.yh);this.taskPane=gb;this.taskPane.BDh(this.oPg)}get rme(){return this.taskPane.hj}showInternal(){this.taskPane.isVisible||
this.taskPane.eF(!0)}hideInternal(){this.taskPane.eF(!1)}get yxb(){return!Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")}dispose(){this.taskPane&&(this.taskPane.Dnk(this.oPg),this.taskPane=null);super.dispose()}}Object(u.a)(ua,"EnrichmentTaskPaneWrapper",xa,[]);class Ia{constructor(gb){this.pI=null;this.psa=gb}Qvj(gb,Kb){this.pI=gb;this.psa&&this.psa.show(this,Kb,null)}G3c(gb,Kb){this.psa&&this.psa.G3c(gb,Kb)}TRd(){this.psa&&this.psa.hide()}dispose(){this.psa&&
(this.psa.dispose(),this.psa=null)}selectEntity(gb){return this.pI?this.pI.selectEntity(gb):!1}searchEntity(gb,Kb){this.pI&&this.pI.searchEntity(gb,Kb)}wne(gb,Kb,ub,lb){this.pI&&this.pI.wne(gb,Kb,ub,lb)}N_b(gb){return this.pI?this.pI.N_b(gb):!1}onPaneClosed(){if(this.pI)this.pI.onPaneClosed()}cancelSearch(){this.pI&&this.pI.cancelSearch()}R6b(gb){this.pI&&this.pI.R6b(gb)}Rxb(gb){this.pI&&this.pI.Rxb(gb)}h9b(gb){this.pI&&this.pI.h9b(gb)}R0a(gb,Kb){this.pI&&this.pI.R0a(gb,Kb)}}Object(u.a)(Ia,"EnrichmentManager",
null,[687,4]);class Sa extends Ia{constructor(gb){super(gb)}dispose(){super.dispose()}}Object(u.a)(Sa,"ExcelEnrichmentManager",Ia,[]);var Ya=a(12);class da{constructor(gb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=gb;this.commentQuestion=Ya.a.instance.sh(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];
this.ratingQuestion=Ya.a.instance.sh(195);this.ratingValuesAscending=[Ya.a.instance.sh(196),Ya.a.instance.sh(197),Ya.a.instance.sh(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Ya.a.instance.sh(194)}}Object(u.a)(da,"FloodgateSurvey",null,[]);var Ea=a(27),oa=a(65),za=a(487),la=a(46),Ca=a(427),Va=a(216),ia=a(83),wa=a(36),Jb=a(264),$a=a(23);class Ka{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;
this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(u.a)(Ka,"EnrichmentMessageContentAppProperties",null,[]);class nb{constructor(gb,Kb,ub,lb,Ba){this.nIa=this.Zpf=!1;this.wwb=this.xya=!0;this.n2b=this.F8b=!1;this.Zxb=null;this.yRc=0;this.QE=()=>{(this.wwb||this.nIa)&&2!==this.yRc&&(this.n2b||this.Q1d(!1))};this.ij=()=>{c.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.cQj=ra=>{wa.a.jl(ra.Errors)?(ra=wa.a.Yh(ra.Errors),
ra.includes("OperationSucceededWithAlert")?c.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):c.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${ra}`)):ra.Result&&(this.$.ea.Uq(this.ij),this.$.ea.$q(this.ij),ra=ra.Result,this.Zxb=ra.SkydanceFeatureBitmask,this.r6d(ra),this.F8b=!0)};this.tm=()=>{(this.wwb||this.nIa)&&this.Q1d(!1)};this.pPc=(ra,wb)=>{wa.a.jl(ra.Errors)?c.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${wa.a.Yh(ra.Errors)}`):
ra.Result&&(ra=ra.Result,ra.DisambiguationJson?(this.F8b=!1,this.vQg(wb),this.Zxb=ra.SkydanceFeatureBitmask,wb=ra.DisambiguationJson,c.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.n2b=!1,this.J6f(wb)):c.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.mTj=(ra,wb)=>{wa.a.jl(ra.Errors)?(wb=wa.a.Yh(ra.Errors),c.ULS.sendTraceTag(36975689,
0,10,`Failed to retrieve disambiguation data for search. errors: ${wb}`)):ra.Result&&(ra=ra.Result,ra.DisambiguationJson?(this.vQg(wb),this.Zxb=ra.SkydanceFeatureBitmask,wb=ra.DisambiguationJson,c.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.n2b=!0,this.J6f(wb)):c.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};
this.MWj=ra=>{wa.a.jl(ra.Errors)?(ra=wa.a.Yh(ra.Errors),c.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${ra}`),this.wwb=!0):ra.Result&&(ra=ra.Result,this.Zxb=ra.SkydanceFeatureBitmask,this.r6d(ra),this.F8b=!0)};this.KZj=ra=>{if(wa.a.jl(ra.Errors)){const wb=wa.a.Yh(ra.Errors);c.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${wb}`)}ra.Result?(this.r6d(ra.Result),this.F8b=!0):this.oHa()};this.dqg=ra=>{wa.a.jl(ra.Errors)?
(ra=wa.a.Yh(ra.Errors),c.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${ra}`)):ra.Result?this.Gwc.G3c(ra.Result,null):(c.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.oHa())};this.AVj=ra=>{wa.a.jl(ra.Errors)?(ra=wa.a.Yh(ra.Errors),c.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${ra}`)):this.oHa()};
this.$=gb;this.da=$a.f(this.$);this.da.ha.wX(this.tm);this.da.dA(this.QE);this.ouf=lb;this.nt=Ba;gb=new ua(Kb);this.Gwc=new Sa(gb);x.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ra=>{ra.isFeatureEnabled("mso_sendASmile",!0).then(wb=>{this.xya=wb;return null})})}dispose(){this.$&&(this.da.ha.vZ(this.tm),this.da.$E(this.QE))}selectEntity(gb){const Kb=la.q(this.da.ha.qa.activeCell,this.$),ub=()=>new za.a;Ca.a(this.$.userOperationManager,(lb,Ba,ra)=>{var wb=this.$.pa.ta;
lb=Jb.c(lb,this.KZj);const mc=wb.$a(9,null);mc.activeCell=Kb;mc.selectionIndex=gb;return K.h(wb,"SelectLinkedEntityForDisambiguation",mc,lb,Ba,ra,null,4)},lb=>new Va.a(109,0,lb,void 0,ub),null);return!0}searchEntity(gb,Kb,ub,lb,Ba){ub=void 0===ub?!1:ub;lb=void 0===lb?0:lb;Ba=void 0===Ba?null:Ba;c.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${Kb}`);const ra=la.q(this.da.ha.qa.activeCell,this.$);Ca.a(this.$.userOperationManager,
(wb,mc,xb)=>{var Ec=this.$.pa.ta,ed=this.xya,jd=ub,Xd=lb,Td=Ba;wb=Jb.c(wb,this.dqg);const gc=Ec.$a(1,null);gc.searchCell=ra;gc.searchQuery=gb;gc.isFloodgateEnabled=ed;gc.isStarterData=jd;gc.starterDataDomainId=Xd;gc.starterDataDomainIdString=Td;return K.h(Ec,"LinkedEntitySearch",gc,wb,mc,xb,null,4)},wb=>new Va.a(110,0,wb,16),null)}N_b(gb){const Kb=la.q(this.da.ha.qa.activeCell,this.$);this.wwb=!1;Ca.a(this.$.userOperationManager,(ub,lb,Ba)=>{var ra=this.$.pa.ta;ub=Jb.c(ub,this.MWj);const wb=ra.$a(1,
null);wb.activeCell=Kb;wb.isBackward=gb;return K.h(ra,"MoveToNextAmbiguousLinkedEntity",wb,ub,lb,Ba,null,4)},ub=>new Va.a(111,0,ub,16),null);return!0}onPaneClosed(){this.nIa=!1;this.Zpf=!0;this.yRc=0;this.n2b=!1}cancelSearch(){const gb=this.Tne();gb&&Ca.a(this.$.userOperationManager,(Kb,ub,lb)=>{var Ba=this.$.pa.ta;Kb=Jb.c(Kb,this.dqg);const ra=Ba.$a(9,null);ra.activeCell=gb;return K.h(Ba,"CancelSearchLinkedEntity",ra,Kb,ub,lb,null,4)},Kb=>new Va.a(112,0,Kb,16),null)}R6b(gb){c.ULS.sendTraceTag(537166977,
0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.oHa();if(gb&&gb.length)if(gb=JSON.parse(gb))if(null==gb.domainId)c.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var Kb={};Kb.Id=gb.domainId;Kb.StringId=gb.stringId;this.nt.convertToLinkedEntity(Kb)}else c.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else c.ULS.sendTraceTag(537166976,
0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}Rxb(gb){const Kb=new ia.a(-859308420,oa.a.rh,this.$.hi,9,null);this.$.Ma.qh(Kb,{[oa.a.Xk]:"HelpID="+gb,["InputMethod"]:oa.a.rh,["ShouldCanvasTakeFocus"]:!0,[oa.a.Qi]:w.a.FK})}h9b(gb){y.a.I8a(new da(gb))}R0a(gb,Kb){const ub=this.Tne();ub&&Ca.a(this.$.userOperationManager,(lb,Ba,ra)=>{var wb=this.$.pa.ta;lb=Jb.c(lb,this.AVj);const mc=wb.$a(1,null);mc.cell=ub;mc.starterDataDomainId=gb;mc.starterDataDomainIdString=Kb;return K.h(wb,
"InsertStarterDataTable",mc,lb,Ba,ra,null,4)},lb=>new Va.a(259,0,lb,1),null)}Q1d(gb){this.launchOrCloseDisambiguationPane(gb)}launchDisambiguationPaneForSearch(){c.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const gb=this.fzk();gb&&Ca.a(this.$.userOperationManager,(Kb,ub,lb)=>F(this.$.pa.ta,gb,!0,this.xya,!1,null,Jb.c(Kb,this.mTj),ub,lb,1),Kb=>new Va.a(114,0,Kb,16),null)}launchLinkedEntityDataTypeSelectorPane(gb,
Kb){Ca.a(this.$.userOperationManager,(ub,lb,Ba)=>{var ra=this.$.pa.ta;ub=Jb.c(ub,this.pPc);const wb=ra.$a(1,null);wb.selectedRanges=gb;wb.letyDomainId=Kb;return K.h(ra,"GetDataTypeSelectorData",wb,ub,lb,Ba,2,4)},ub=>new Va.a(233,0,ub,16),null)}Kvj(gb,Kb){gb&&Ca.a(this.$.userOperationManager,(ub,lb,Ba)=>F(this.$.pa.ta,gb,!1,!1,!0,Kb,Jb.c(ub,this.pPc),lb,Ba,2),ub=>new Va.a(257,0,ub,16),null)}vQg(gb){gb&&(this.yRc=gb)}J6f(gb){var Kb=new ia.a(-90814711,oa.a.rh,0,10,null);this.$.Ma.qh(Kb,null);this.nIa?
this.Gwc.G3c(gb,null):(Kb=3,null!=this.Zxb?Kb=this.Zxb:c.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(gb=this.UKi(gb,Kb))||c.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.ouf||c.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.Gwc.Qvj(this.ouf,gb),this.nIa=!0)}oHa(){this.nIa&&(c.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.Gwc.TRd(),
this.nIa=!1,this.yRc=0,this.n2b=!1)}r6d(gb){var Kb=gb.Row+1;gb=gb.Column+1;0>Kb||0>gb?(c.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.oHa(),this.$.ea.Uq(this.ij)):(Kb=new Ea.Range(Kb,gb,Kb,gb,!0,!1),this.da.ha.updateSelection(Kb,Kb,60),this.wwb=!0)}UKi(gb,Kb){const ub=new Ka;ub.applicationVersion=r.AFrameworkApplication.buildVersion;ub.applicationName="ExcelWac";ub.anid="00000000-0000-0000-0000-000000000000";
ub.sessionId=r.AFrameworkApplication.userSessionId;ub.appCorrelationId=C.a.create().toString();var lb=B.a.UU(r.AFrameworkApplication.lcid);lb=lb?lb.name:null;ub.uiLanguage=lb;ub.market=this.AAc(lb);ub.themeId=0;ub.disambiguationJson=gb;Kb<=E.a.Z8?ub.featuresBitMask=Kb:c.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return ub}AAc(gb){gb=gb.split("-");return gb[gb.length-1]}launchOrCloseDisambiguationPane(gb){const Kb=this.da.ha.qa.activeCell;
if(this.Tne()&&Kb)if(this.da.oh.oVb(Kb)){if((!this.Zpf||gb||this.F8b)&&!this.da.isEditing){gb&&(this.wwb=!0);var ub=la.s(Kb,this.$);Ca.a(this.$.userOperationManager,(lb,Ba,ra)=>F(this.$.pa.ta,ub,!1,this.xya,!1,null,Jb.c(lb,this.pPc),Ba,ra,1),lb=>new Va.a(114,0,lb,16),null)}}else this.oHa();else this.oHa()}Ugk(){if(this.nIa){var gb=this.da.ha.qa.activeCell;if(gb){var Kb=la.s(gb,this.$);Ca.a(this.$.userOperationManager,(ub,lb,Ba)=>F(this.$.pa.ta,Kb,!1,this.xya,!1,null,Jb.c(ub,this.pPc),lb,Ba,1),ub=>
new Va.a(114,0,ub,16),null)}else this.oHa()}}Tne(){const gb=this.da.ha.qa;return gb.Vya()?la.q(gb.activeCell,this.$):null}fzk(){const gb=this.da.ha.qa;return gb.Vya()?la.s(gb.activeCell,this.$):null}}Object(u.a)(nb,"ConvertToLinkedEntityDisambiguationPane",null,[4]);var sa=a(2),na=a(289),ab=a(1206),Ja=a(60),Pa=a(922);class hb{constructor(gb,Kb,ub){this.k7f=2;this.j7f="Size64by48";this.$=gb;this.Za=Kb;this.nt=ub}jCi(gb,Kb){var {ConvertToLinkedEntityManager:ub}=a(972);this.s8k();Kb=this.Za.qw(Kb).fM();
let lb=0,Ba=0,ra=!1;for(var wb of gb.Categories){const mc=this.UCi(wb,lb);mc&&(Ba===ub.Aqb&&(ra=!0),Kb.MenuSectionList.push(mc),++lb);++Ba}ra&&lb<=ub.l7f&&Kb.MenuSectionList.splice(ub.Aqb,1);ub=this.Za.ji().zpc();wb=Ja.a.An(11);for(const mc of gb.LongButtons)this.nt.kNk(mc)&&this.Mzh(ub,mc,wb);0<ub.ControlList.length&&Kb.MenuSectionList.push(ub);return Kb}Mzh(gb,Kb,ub){if(Kb){var lb="Data.ConvertToLinkedEntityMenuItem_"+Kb.Name,Ba=this.nt.f5(Kb.DomainId);Ba&&(Kb=Object(sa.a)(new na.a,{Id:lb,ExternalId:lb,
Command:"-1662108744",LabelText:Kb.Name,Alt:Kb.SuperTip,Visible:!0,MenuItemId:a(972).ConvertToLinkedEntityManager.cjb(Kb.DomainId),Image16by16:ub,Image16by16Class:this.L9i(Ba.FontLocator)}),gb.ControlList.push(Kb))}}NCi(gb,Kb){return Object(sa.a)(new ab.a,{Id:a(972).ConvertToLinkedEntityManager.Xrf+gb.toString(),ExternalId:a(972).ConvertToLinkedEntityManager.Xrf+gb.toString(),MenuItemId:a(972).ConvertToLinkedEntityManager.rDd+gb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",
Icon:this.ATf(Kb.FontLocator),LabelText:Kb.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.fLd(Kb)})}nLh(gb){switch(gb){case "Animal":return Pa.a.iHh;case "Apple":return Pa.a.pIh;case "Atom":return Pa.a.$Jh;case "Beaker":return Pa.a.eMh;case "Bridge":return Pa.a.NNh;case "Cat":return Pa.a.yUh;case "City":return Pa.a.OWh;case "Constellation":return Pa.a.V0h;case "Dog":return Pa.a.Lhi;case "Finance":return Pa.a.WLh;case "GradCap":return Pa.a.U0i;case "HumanAnatomy":return Pa.a.i9i;
case "LocationPointer":return Pa.a.Pyj;case "Map":return Pa.a.s2j;case "MedicineNeedle":return Pa.a.XFj;case "Mountain":return Pa.a.sHj;case "Movie":return Pa.a.KHj;case "Music":return Pa.a.SIj;case "OuterSpace":return Pa.a.f3j;case "Planet":return Pa.a.N6j;case "Satellite":return Pa.a.cwk;case "WolframGeneric":return Pa.a.Vuk;default:return Pa.a.S2h}}L9i(gb){if("PowerBIRibbon"!==gb)return t.a.AFd;switch(gb){case "AnimalRibbon":return t.a.Nqi;case "AppleRibbon":return t.a.Oqi;case "AtomRibbon":return t.a.Pqi;
case "BeakerRibbon":return t.a.Qqi;case "BridgeRibbon":return t.a.Rqi;case "CenterMapRibbon":return t.a.Sqi;case "CityRibbon":return t.a.Tqi;case "CurrencyRibbon":return t.a.Uqi;case "ExerciseRibbon":return t.a.Vqi;case "FinanceRibbon":return t.a.jxf;case "FirstAidRibbon":return t.a.Wqi;case "GlobeLightningRibbon":return t.a.Xqi;case "GradCapRibbon":return t.a.Yqi;case "HumanAnatomyRibbon":return t.a.Zqi;case "LeafRibbon":return t.a.$qi;case "LocationPointerRibbon":return t.a.bri;case "MapRibbon":return t.a.hxf;
case "MountainRibbon":return t.a.cri;case "MovieRibbon":return t.a.dri;case "MusicRibbon":return t.a.eri;case "NotablePeopleRibbon":return t.a.fri;case "OuterSpaceRibbon":return t.a.gri;case "PartlySunnyWeatherRibbon":return t.a.hri;case "PowerBIRibbon":return t.a.ixf;case "SatelliteRibbon":return t.a.iri;case "WolframGenericRibbon":return t.a.ari;case "YogaRibbon":return t.a.kri;default:return t.a.gxf}}ATf(gb){switch(gb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";
case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";
case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";
case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}UCi(gb,Kb){Kb=this.Za.wM("ConvertToLinkedEntitySection_"+Kb,this.k7f,this.j7f);var ub=!1;for(var lb of gb.DomainIds){const Ba=this.nt.f5(lb);if(!Ba||Ba.DomainBlocked||!Ba.ShowInRibbon)continue;
ub=Ba.Name;const ra=a(972).ConvertToLinkedEntityManager.cjb(lb);Kb.rD("Data.ConvertToLinkedEntityMenuItem_"+ra,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,ra,this.ATf(Ba.FontLocator),void 0,void 0,this.fLd(Ba),ub);ub=!0}if(!ub)return null;lb=Kb.ypc(!0);Kb=this.Za.ji();Kb.title=gb.Name;gb=Kb.zpc();gb.ControlList.push(lb);return gb}s8k(){this.k7f=5;this.j7f="Size112by64"}fLd(gb){return gb.RibbonTooltipHeader?gb.RibbonTooltipHeader+"\n\n"+gb.RibbonTooltip:gb.RibbonTooltip}}Object(u.a)(hb,"ConvertToLinkedEntityMenuRenderer",
null,[659]);var ac=a(61),Hc=a(358),bd=a(124),zc=a(101);class oc{constructor(gb,Kb){this.sRd=this.tRd=!1;this.V4a=ub=>{c.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.tRd=!0;if(wa.a.jl(ub.Errors))c.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${wa.a.Yh(ub.Errors)}`);else{var lb=0,Ba=[],ra=!1;try{if(!ub.Result)return;const wb=ub.Result;if(!wb){c.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");
return}Ba=this.O4j(wb);if(!Ba||!Ba.length)return;lb=Ba.length;this.nGj(Ba);this.qPa.fIg();c.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.qPa.Qub.length}`);if(Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const mc of this.qPa.Qub)if(1===(mc.Id&1048320)>>8){ra=!0;break}c.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${ra}`)}}finally{c.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${lb} data types.`),
zc.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,[{name:"MruCount",int64:lb},{name:"MruWolframAvailable",bool:ra}])}this.sRd&&(this.L$g(this.qPa.Qub),this.sRd=!1)}};this.e5a=ub=>{c.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");wa.a.jl(ub.Errors)?c.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${wa.a.Yh(ub.Errors)}`):ub.Result&&(ub.Result||c.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};
this.J1b=(ub,lb,Ba)=>{ub=bd.a.gk(ub.data);c.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${Ba}. Errors: ${wa.a.Yh(ub)}.`)};this.$=gb;this.qPa=Kb}AUi(){!this.tRd&&this.$.ea.ki&&(c.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),Hc.C(this.$.pa.ta,0,this.V4a,this.J1b,null,null))}L$g(gb){gb&&gb.length?this.tRd?(gb=this.bBk(gb))?(c.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),
Hc.J(this.$.pa.ta,0,gb,this.e5a,this.J1b,null,null)):c.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.sRd=!0:c.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}bBk(gb){if(!gb||!gb.length)return c.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var Kb=[];for(const ub of gb)gb=
{},gb.Id=ub.Id,ub.StringId&&(gb.StringId=ub.StringId),Kb.push(gb);Kb="<DataTypes>"+ac.a.Ci(Kb)+"</DataTypes>";return 1906<Kb.length?(c.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):Kb}O4j(gb){if(!gb)return c.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!gb.startsWith("<DataTypes>")||!gb.endsWith("</DataTypes>"))return c.ULS.sendTraceTag(537166684,
0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;gb=gb.substring(11,gb.length-12);if(!gb)return c.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let Kb=[];try{Kb=ac.a.Sp(gb)}catch(ub){return c.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${ub.message}`),null}c.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Kb.length} data types.`);
return Kb}nGj(gb){const Kb=this.qPa.Qub,ub=this.qPa.Dfk;if(Kb.length!==ub){for(let lb=0;lb<gb.length&&Kb.length<ub;++lb){const Ba=gb[lb];this.qPa.f5(Ba)&&!Kb.includes(Ba)&&Kb.push(Ba)}this.qPa.Qub=Kb}}}Object(u.a)(oc,"LinkedDataTypeRoamingHandler",null,[]);var Nb=a(63),Aa=a(77),Ub=a(156),Db=a(39),Ib=a(58),yc=a(32),xc=a(254),zb=a(28),vb=a(106),bb=a(91),La=a(95),pb=a(5),fa=a(773),kb;let db=kb=class extends n.a{constructor(gb,Kb,ub,lb,Ba,ra,wb){super();this.d3f=this.VZd=this.d0d=this.AYd=this.zYd=this.WIc=
null;this.o0b=this.WQd=0;this.mza=null;this.dVd=!1;this.eJd=this.ww=this.nme=null;this.EB=0;this.nR=null;this.f0a=8;this.Hud=this.i7f=this.xZf=this.dtb=!1;this.gOa=this.wDf=this.Kzf=null;this.Fsd=0;this.yLh=5;this.Noc=3E4;this.V1g=!1;this.Cua=null;this.xIa=Array(5);this.V4g=this.tze=!1;this.HJg=this.p2d=0;this.Bi=this.kSe=null;this.oWg=!0;this.ij=(mc,xb)=>{xb.ki&&!xb.LXb&&this.showUntrustedImageBusinessBarIfNecessary()};this.nUj=mc=>{if(mc.Result){var xb=mc.Result;if(xb&&xb.length){c.ULS.sendTraceTag(537166922,
0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${xb.length} labels`);var Ec=Aa.GetServiceTaskFactory.Tj(this.$.la,274,275,0);Db.TaskExtensions.Xa(Ec,()=>{Ec.result.tsd(xb,2)||c.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ya,3)}}else c.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.Dl=()=>{this.g3k();this.D3i(this.$.ea.Qq.LinkedEntityAsyncRefreshStateId);this.T4i(this.$.ea.Qq.RichDataClassificationLabelStateId)};
this.tRj=()=>{this.tze=!0;this.ww&&this.ww.Ugk()};this.ETj=mc=>{if(mc&&!xc.a(mc))try{mc.Result.HasUntrustedImageUrl&&(this.businessBar.Om(59,null),this.V4g=!0)}catch(xb){c.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${xb}.`)}};this.H6f=()=>{if(!this.i7f&&this.XVb()&&!this.fWd())if(zc.a("DataTabActive"),Nb.a.Wl.GY)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var mc=
this.dtc();if(mc){var xb={};xb.InputMethod=oa.a.rh;xb.CalloutName=8;xb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ma.qh(mc,xb);this.i7f=!0}else c.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else c.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else c.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};
this.dQj=mc=>{wa.a.jl(mc.Errors)||this.raiseEvent("LinkedEntityConverted")};this.R_j=()=>{Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void La.a.sj(pb.l).then(mc=>{mc.readText(Ya.a.instance.ia(1813))}):this.$.la.fi(211,mc=>{mc.readText(Ya.a.instance.ia(1813))})};this.Cj=(mc,xb)=>{c.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");xb.l1?c.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):
(this.$.isEditMode?this.Oef():this.osk(),this.tze&&this.ptf())};this.OTj=mc=>{this.brc();if(mc.Result){var xb=mc.Result;mc=xb.DomainDataArray;if(this.mza=xb.Ribbon){var Ec={};Ec.Name=Ya.a.instance.ia(1803);Ec.DomainIds=this.tV;this.mza.Categories.splice(kb.Aqb,0,Ec)}0<xb.MaximumCellsToConvert&&(this.kSe=xb.MaximumCellsToConvert);this.EB=2;xb=!1;if(mc){c.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${mc.length} domains`);this.l3a||(this.l3a=[]);Ec=Ya.a.instance.ia(1800);
const ed=Ya.a.instance.ia(1802);for(const jd of mc)jd.DomainId?(this.l3a.push(jd),jd.DomainBlocked?(mc=!!jd.DomainId.StringId,c.ULS.sendTraceTag(537166861,0,50,`Domain: ${mc?jd.DomainId.Id.toString():jd.Name} is telemetry only, do not show in menu (Has String ID: ${mc})`)):(this.e5.ga(kb.cjb(jd.DomainId),jd),jd.Name===Ec||268435456===jd.DomainId.Id?this.Kzf=jd.DomainId.Id.toString():jd.Name===ed||536870912===jd.DomainId.Id?this.wDf=jd.DomainId.Id.toString():268435712===jd.DomainId.Id&&jd.ShowInRibbon&&
(this.Hud=!0),xb=!0)):c.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}xb||(this.l3a=null);this.K5g();this.nme.AUi();this.V1g||(this.c3k(),this.V1g=!0)}else this.l3a=null,this.EB=3,-1<this.f0a&&window.setTimeout(()=>{this.e3b()},100*(8-this.f0a)),c.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.ghe();this.rlf();this.Hud&&this.h0f&&Ub.e(this.H6f,this.$.ya,500)};this.NTj=mc=>{mc=bd.a.gk(mc.data);c.ULS.sendTraceTag(34415007,
0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${wa.a.Yh(mc)}].`);this.l3a=null;this.EB=3;this.dtb=!0;this.ghe()};this.onContentReady=()=>{this.w3g()&&this.da.$E(this.onContentReady);this.oWg&&this.$.workbookContext.Options&1048576&&(this.businessBar.ORk(),this.oWg=!1)};this.nq=()=>{this.brc()};this.jWj=mc=>{if(xc.a(mc)){if(Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void La.a.resolve(pb.C,{va:0}).then(Ec=>{let ed=null;if(null===mc||void 0===
mc?0:mc.Errors)ed=mc.Errors[0];Ec.zte(ed,null)});else{const Ec=Object(bb.d)(La.a.resolve(pb.C,{va:0}));Db.TaskExtensions.Xa(Ec,()=>{let ed=null;if(null===mc||void 0===mc?0:mc.Errors)ed=mc.Errors[0];Ec.result.zte(ed,null)},this.$.ya,3)}c.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${wa.a.Yh(mc.Errors)}].`);const xb=wa.a.WS(mc.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");
this.$.ea.sx(xb)}};this.Bud=()=>{c.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.Noc} millisecond interval`);this.tWf("Periodic auto-refresh check",this.mOj,this.lOj)};this.mOj=mc=>{xc.a(mc)?(c.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${wa.a.Yh(mc.Errors)}].`),++this.Fsd):this.Fsd=0;b.a.dh(this.gOa);this.Fsd>=this.yLh?
(c.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.gOa=null):(c.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.gOa=Ib.a.instance.create(this.Bud,this.Noc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.lOj=mc=>{mc=bd.a.gk(mc.data);h.a.Im(mc)?c.ULS.sendTraceTag(537166791,
0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):c.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${wa.a.Yh(mc)}].`);b.a.dh(this.gOa);this.gOa=Ib.a.instance.create(this.Bud,this.Noc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.pXj=mc=>{mc=!!mc.Result&&mc.Result;c.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${mc.toString()}`);
mc?(c.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${yc.a.ih.$j.m-this.WQd} ms, retry count = ${this.o0b}`),this.e3b()):this.f0c()};this.oXj=()=>{c.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.f0c()};this.qTj=mc=>{mc.Result?(mc=mc.Result)?(this.Aie(),this.businessBar.zte(null,mc)):c.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):c.ULS.sendTraceTag(537166726,
0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=gb;this.businessBar=ra;this.svgIconProvider=ub;this.Bi=wb;this.l3a=[];this.tV=[];this.da=$a.f(this.$);this.HDc=-1;this.Bnj=Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.h0f=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.e5=new vb.a;this.qrb=new hb(gb,Kb,this);lb&&(this.ww=new nb(gb,lb,Ba,this,
this));this.$.mr(this.Cj);v.a(this.$)&&v.a(this.$).LCk(this);this.Oef();this.$.ea.pz(this.Dl);Oa.EwaSettings.Ra(123)&&Oa.EwaSettings.Ra(131)&&(this.w3g()||this.da.dA(this.onContentReady));this.$.xI(this.nq);this.$.ea.$q(this.ij);this.showUntrustedImageBusinessBarIfNecessary();this.nme=new oc(this.$,this)}dispose(){this.$.ea.LA(this.Dl);this.$.ea.Uq(this.ij);!this.Cua&&Oa.EwaSettings.Ra(123)&&Oa.EwaSettings.Ra(131)&&this.da.$E(this.onContentReady);this.ww&&this.ww.dispose();this.$.gL(this.nq);this.$.Wr(this.Cj);
b.a.dh(this.gOa)}fDh(gb){this.addHandler("LinkedEntityConverted",gb)}nnk(gb){this.removeHandler("LinkedEntityConverted",gb)}get Dfk(){return 5}get Qub(){return this.tV}set Qub(gb){this.tV=gb}selectEntity(gb){return this.ww?this.ww.selectEntity(gb):!1}searchEntity(gb,Kb){this.ww&&this.ww.searchEntity(gb,Kb)}wne(gb,Kb,ub,lb){this.ww&&this.ww.searchEntity(gb,Kb,!0,ub,lb)}N_b(gb){return this.ww?this.ww.N_b(gb):!1}onPaneClosed(){if(this.ww)this.ww.onPaneClosed()}cancelSearch(){this.ww&&this.ww.cancelSearch()}R6b(gb){this.ww&&
this.ww.R6b(gb)}Rxb(gb){this.ww&&this.ww.Rxb(gb)}h9b(gb){this.ww&&this.ww.h9b(gb)}R0a(gb,Kb){this.ww&&this.ww.R0a(gb,Kb)}T4i(gb){if(this.$.isEditMode&&this.HJg!==gb&&r.AFrameworkApplication.fa.ka("SupportsPolicies")){this.HJg=gb;c.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");gb=this.$.pa.ta;var Kb=this.nUj;const ub=gb.$a(1,null);K.h(gb,"GetRichDataClassificationLabels",ub,Kb,null,null,null,4)}}ptf(){this.$.userOperationManager.enqueueOperation(new Va.a(589,
0,(gb,Kb,ub)=>{var lb=this.$.pa.ta;gb=Jb.c(gb,this.tRj);const Ba=lb.$a(1,null);return K.h(lb,"LinkedEntitiesEnableUntrustedImages",Ba,gb,Kb,ub,null,0)},80),null)}showUntrustedImageBusinessBarIfNecessary(){this.tze||this.V4g||!this.$.ea.ki||this.Rzk()}Rzk(){this.$.userOperationManager.enqueueOperation(new Va.a(588,0,(gb,Kb,ub)=>{var lb=this.$.pa.ta;gb=Jb.c(gb,this.ETj);const Ba=lb.$a(1,null);return K.h(lb,"GetHasUntrustedImageUrls",Ba,gb,Kb,ub,null,4)},80),null)}get n_b(){return this.xIa.length}get TFj(){return this.kSe}T2h(gb){(gb=
this.Qhi(gb))?this.convertToLinkedEntity(gb):c.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(gb){c.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${gb.Id}].`);if(this.da){var Kb=this.da.ha.qa.jj,ub=Kb.Ik(this.da.H5);this.dVd&&this.AAh(gb);if(ub){ub=this.da.oh.OLa(ub);if(!this.LQf(gb)&&this.x1f(gb.Id)){c.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");
if(Nb.a.Wl.GY){Kb=this.uKd();if(!Kb){c.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}ub=this.dtc();if(!ub){c.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var lb={["InputMethod"]:oa.a.rh,CalloutName:3};lb.Target=Kb;lb.RibbonButtonLabel=Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.uJg(gb):this.HYb(gb.Id.toString());lb.ExampleEntities=this.Fxf(gb);this.$.Ma.qh(ub,
lb);return}c.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.x1f(gb.Id)&&!gb.StringId)this.launchLinkedEntityDataTypeSelectorPane(kb.cjb(gb));else{if(ub){c.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",
!1)&&this.gXk(gb)){Kb=la.t(this.da.ha.qa.selectedRanges,this.$);this.ww.Kvj(Kb,gb);return}if(Nb.a.Wl.GY){Kb=this.uKd();if(!Kb){c.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}ub=this.dtc();if(!ub){c.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}lb={["InputMethod"]:oa.a.rh,CalloutName:2};lb.Target=Kb;lb.RibbonButtonLabel=this.uJg(gb);lb.ExampleEntities=this.Fxf(gb);lb.BlankCellResourceId=this.GMh(gb);lb.HasBlankCellWalkthrough=
this.X5i(gb);lb.ServiceDomain=gb.Id;this.$.Ma.qh(ub,lb);return}c.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.uyd(gb,!1,Kb)}}}else c.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.Cua&&this.Cua.OXa()}onAutoDetectUIShown(){Ca.a(this.$.userOperationManager,(gb,Kb,ub)=>{var lb=this.$.pa.ta;const Ba=lb.$a(1,null);return K.h(lb,
"OnAutoDetectUIShown",Ba,gb,Kb,ub,null,4)},gb=>new Va.a(230,0,gb,80),null)}uyd(gb,Kb,ub){const lb=la.s(ub,this.$),Ba=()=>new za.a;Ca.a(this.$.userOperationManager,(ra,wb,mc)=>{var xb=this.$.pa.ta;ra=Jb.c(ra,this.dQj,this.R_j,this.ww.cQj);const Ec=xb.$a(1,null);Ec.selectedRanges=lb;Ec.domainId=gb;Ec.autodetect=Kb;return K.h(xb,"ConvertToLinkedEntity",Ec,ra,wb,mc,null,4)},ra=>new Va.a(115,0,ra,void 0,Ba),null)}AAh(gb){if(this.dVd){var Kb={};Kb.Id=gb.Id;gb.StringId&&(Kb.StringId=gb.StringId);if(!(0<
this.tV.length&&this.tV[0].Id===Kb.Id&&this.tV[0].StringId===Kb.StringId)){gb=!1;this.tV.splice(0,0,Kb);for(let ub=1;ub<this.tV.length;++ub)if(this.tV[ub].Id===Kb.Id&&this.tV[ub].StringId===Kb.StringId){this.tV.splice(ub,1);gb=!0;break}for(;5<this.tV.length;)this.tV.splice(this.tV.length-1,1);this.mza.Categories[kb.Aqb].DomainIds=this.tV;this.fIg();gb||this.nme.L$g(this.tV)}}}convertLinkedEntityToText(){c.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");
if(this.da){var gb=la.s(this.da.ha.qa.jj,this.$);Ca.a(this.$.userOperationManager,(Kb,ub,lb)=>{var Ba=this.$.pa.ta;const ra=Ba.$a(1,null);ra.selectedRanges=gb;return K.h(Ba,"ConvertLinkedEntityToText",ra,Kb,ub,lb,null,4)},Kb=>new Va.a(116,0,Kb),null)}else c.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){c.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if($a.f(this.$)){this.$.isEditMode||
c.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.Aie();var gb=la.t(this.da.ha.qa.selectedRanges,this.$);Ca.a(this.$.userOperationManager,(Kb,ub,lb)=>{var Ba=this.$.pa.ta;const ra=Ba.$a(1,null);ra.selectedRanges=gb;return K.h(Ba,"RefreshLinkedEntitiesInRange",ra,Kb,ub,lb,null,4)},Kb=>new Va.a(248,0,Kb),null)}else c.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}kNk(gb){gb=this.f5(gb.DomainId);
if(!gb||gb.DomainBlocked||!gb.HasCuratedData)return!1;if(this.Bnj){for(const Kb of this.e5)if(Kb.value.DomainId.Id===gb.DomainId.Id&&Kb.value.ShowInRibbon)return!0;return!1}return gb.ShowInRibbon}CLk(gb){return 2!==this.EB||!this.xIa[gb]}launchDisambiguationPaneForSearch(){this.ww&&this.ww.launchDisambiguationPaneForSearch()}dj(gb,Kb,ub){if("PopulateConvertToLinkedEntityMenu"!==Kb)return!1;this.eJd=ub.MenuId;if(0===this.EB||3===this.EB)return this.t7j(),!0;if(!this.mza)return c.ULS.sendTraceTag(537166873,
0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.e5)return c.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.nR=this.nR||this.qrb.jCi(this.mza,ub.MenuId);ub.MenuItems=this.nR;return this.dVd=!0}t7j(){-1===this.HDc&&(this.e3b(),this.HDc=window.setInterval(()=>{this.e3b()},2E3))}e3b(){if(this.$.ea.ki&&2!==this.EB){this.f0a--;c.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");
this.EB=1;var gb=this.$.pa.ta,Kb=this.OTj,ub=this.NTj;const lb=gb.$a(1,null);K.h(gb,"GetLinkedEntityMetadata",lb,Kb,ub,null,null,4)}}fWd(){return this.$.isEditMode&&2!==this.EB&&(0<=this.f0a||!this.dtb)}hAe(gb){r.AFrameworkApplication.Xl?c.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):v.a(this.$)?(this.b9k(),gb&&this.$.Dm()):c.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}osk(){this.o0b=0;this.f0a=
8;this.dtb=!1;this.EB=this.HDc=0;this.l3a=this.mza=null;this.brc();for(let gb=0;gb<this.n_b;++gb)this.xIa[gb]=null;this.XVb()&&this.hAe(!0)}brc(){this.nR=null}XVb(){const gb=w.a.Lub,Kb=v.a(this.$);return!!Kb&&Kb.us.OA===gb}K5g(){if(this.mza){let ub=0;var gb=-1,Kb=-1;let lb=0,Ba=0,ra=0,wb=0;const mc=[null,null,null,null,null];for(const xb of this.mza.Categories){let Ec=!1;for(const ed of xb.DomainIds){const jd=this.f5(ed);jd&&!jd.DomainBlocked&&jd.ShowInRibbon&&(ub<this.n_b?(this.xIa[ub]=ed,Ba===kb.Aqb&&
(-1===gb&&(gb=ub),Kb=ub,wb=Kb-gb+1),++ub):ub===this.n_b&&lb<wb&&Ba!==kb.Aqb&&(mc[lb]=ed,++lb),Ec=!0)}Ec&&++ra;++Ba}if(-1<gb&&ra<=kb.l7f){for(;Kb>=gb;--Kb)this.xIa.splice(Kb,1);for(gb=0;gb<wb;++gb)this.xIa.splice(ub+gb,0,mc[gb])}for(;ub<this.n_b;)this.xIa[ub]=null,++ub}}w3g(){const gb=$a.f(this.$).za,Kb=this.da.ha.Ck;if(gb&&gb.$Qd&&1===Kb&&this.da.ha.qa.activeCell){if(Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void La.a.resolve(pb.Qf,{va:1}).then(ub=>
{this.Cua=new k.a(this.$,this.svgIconProvider,ub,this,this.Bi)});else{const ub=Object(bb.d)(La.a.resolve(pb.Qf,{va:1}));Db.TaskExtensions.Xa(ub,()=>{this.Cua=new k.a(this.$,this.svgIconProvider,ub.result,this,this.Bi)},this.$.ya,3)}return!0}return!1}Nvj(){this.ww&&this.ww.Q1d(!0)}launchLinkedEntityDataTypeSelectorPane(gb){if(this.ww)if(gb=this.VCd(gb))if(gb.DomainId.StringId)c.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var Kb=la.t(this.da.ha.qa.selectedRanges,
this.$);this.ww.launchLinkedEntityDataTypeSelectorPane(Kb,gb.DomainId.Id)}else c.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}$0h(gb){const Kb=this.K9i(gb),ub=f.a.Or(this.HYb(gb));gb=f.a.Or(this.Ixe(gb));return kb.QBi(Kb,Ja.a.An(11),ub,gb)}Ixe(gb){try{return this.lrf(parseInt(gb,10)).Description}catch(Kb){}return Ya.a.instance.ia(1797)}HYb(gb){try{return this.lrf(parseInt(gb,10)).Name}catch(Kb){}return Ya.a.instance.ia(1783)}uJg(gb){try{return this.f5(gb).Name}catch(Kb){}return this.HYb(gb.Id.toString())}GMh(gb){try{return this.f5(gb).BlankCellResourceId}catch(Kb){}return null}X5i(gb){try{return this.f5(gb).HasBlankCellWalkthrough}catch(Kb){}return!1}LQf(gb){try{const Kb=
kb.cjb(gb);if(this.e5.lh(Kb))return this.e5.na(Kb).HasCuratedData}catch(Kb){}return!1}gXk(gb){try{return this.f5(gb).SupportsStarterData}catch(Kb){}return!1}x1f(gb){return 268435968===gb}uKd(){return 2===v.a(this.$).$S?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}dtc(){return new ia.a(-847286761,oa.a.rh,this.$.hi,0,w.a.K7)}rlf(){if(this.XVb()&&!this.fWd()&&!this.xZf&&Oa.EwaSettings.Ra(387)&&this.LQf({Id:268435968,StringId:null}))if(c.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
Nb.a.Wl.GY){const ub=this.uKd();if(ub){var gb=this.dtc();if(gb){var Kb={["InputMethod"]:oa.a.rh,CalloutName:6};Kb.Target=ub;Kb.ShouldCanvasTakeFocus=!0;this.$.Ma.qh(gb,Kb);this.xZf=!0}else c.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else c.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else c.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}s9i(gb){gb=
this.VCd(gb);return gb?this.qrb.nLh(gb.SubdomainFontLocator):(c.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}wGc(gb){return this.Cua?this.Cua.mLh(gb):!1}fFi(){return this.Cua?this.Cua.bGi():""}xKi(gb,Kb){const ub=this.kUf(gb);if(0>ub)c.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${gb}`);else if(gb=(gb=this.mrf(gb))?this.f5(gb):null)Kb[l.a.GalleryButtonProps]=
this.qrb.NCi(ub,gb),Kb[l.a.Alt]=this.qrb.fLd(gb)}fIg(){this.K5g();this.XVb()&&this.hAe(!0);this.brc()}K9i(gb){return gb===this.Kzf?t.a.jxf:gb===this.wDf?t.a.hxf:t.a.gxf}Fxf(gb){try{return this.f5(gb).ExampleEntities}catch(Kb){}return Ya.a.instance.ia(1805)}ghe(){(0>this.f0a||this.dtb)&&c.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.EB||0>this.f0a||this.dtb)&&window.clearInterval(this.HDc);this.fWd()?this.eJd&&this.$.frame.VA(this.eJd):
this.hAe(this.XVb())}ei(gb){return this.$.xi+gb}b9k(){var gb=!0;const Kb=Array(this.n_b),ub=v.a(this.$)?v.a(this.$).us:null;if(ub){for(let lb=0;lb<Kb.length;++lb)this.CLk(lb)?Kb[lb]=!0:gb=Kb[lb]=!1;ub.KQg(["ConvertToLinkedEntityGallery"],gb);if(!gb)for(gb=0;gb<Kb.length;++gb)Kb[gb]&&ub.KQg([this.wKi(gb)],!0)}else c.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}f5(gb){const Kb=kb.cjb(gb);if(this.e5.lh(Kb))return this.e5.na(Kb);c.ULS.sendTraceTag(592729218,
0,15,`No domain data for domain ID ${gb.Id} (Has String ID: ${!!gb.StringId})`);return null}wKi(gb){return"ConvertToLinkedEntityPreview"+gb.toString()}$ze(){m.a.get_instance().Fm(10,()=>{this.rlf();this.Hud&&this.h0f&&Ub.e(this.H6f,this.$.ya,500)})}vDc(gb,Kb){switch(gb){case "QueryLinkedEntityGalleryButtons":if(!Kb[l.a.InnerHTML]){gb=Kb[oa.a.Qi].toString();const ub=zb.a.equals(gb,Ya.a.instance.ia(1800),!0)||zb.a.equals(gb,Ya.a.instance.ia(1801),!0),lb=zb.a.equals(gb,Ya.a.instance.ia(1802),!0);ub||
lb||this.xKi(gb,Kb)}break;case "QueryLinkedEntityMenuGalleryButtons":Kb[l.a.InnerHTML]||(Kb[l.a.InnerHTML]=this.$0h(Kb[oa.a.Qi]))}return Kb}Qhi(gb){var Kb=this.mrf(gb);if(Kb)return Kb;if(Kb=this.VCd(gb))return Kb.DomainId;c.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${gb}`);return null}lrf(gb){const Kb={};Kb.Id=gb;return this.f5(Kb)}VCd(gb){return this.e5.lh(gb)?this.e5.na(gb):null}kUf(gb){if(!gb.startsWith(kb.rDd))return-1;const Kb=parseInt(gb.substr(kb.rDd.length),10);return isNaN(Kb)?
(c.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${gb}`),-1):Kb}mrf(gb){gb=this.kUf(gb);return 0>gb?null:this.xIa[gb]}tWf(gb,Kb,ub){if(this.e5&&this.e5.count){c.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${gb})`);var lb=this.$.pa.ta.Vh();this.$.ea.ki&&(gb=this.$.pa.ta,Kb=Jb.c(this.jWj,Kb),lb=gb.$a(1,void 0===lb?null:lb),K.h(gb,"LinkedEntityTryAutoRefresh",lb,Kb,ub,null,null,0))}}c3k(){this.tWf("Auto-refresh on load",
null,null)}g3k(){this.e5&&this.e5.count&&(this.gOa?c.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Qq.HasAutoRefreshableLinkedEntityDomainsEver?(c.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.gOa=Ib.a.instance.create(this.Bud,
this.Noc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):c.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}f0c(){if(this.$.ea.ki&&null!=this.WIc&&null!=this.zYd&&null!=this.AYd&&null!=this.d0d&&null!=this.VZd)if(++this.o0b,12>=this.o0b){1===this.o0b&&(this.WQd=yc.a.ih.$j.m,c.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));
const gb=this.$.pa.ta.Vh();Hc.z(this.$.pa.ta,this.Xwj,this.Ywj(),this.pXj,this.oXj,null,gb)}else c.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${yc.a.ih.$j.m-this.WQd} ms`),this.dtb=!0,this.ghe()}Oef(){if(this.$.isEditMode)if(null!=this.WIc)this.f0c();else{var gb=yc.a.ih.$j.m,Kb=[];x.a.instance.fj("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ub=>{ub.isFeatureEnabled("ExcelPowerBiPro",!1).then(lb=>
{c.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${yc.a.ih.$j.m-gb} Millisecond.`);c.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${lb}]`);return this.WIc=lb}).then(()=>{Kb.push(ub.isFeatureEnabled("ExcelWolframAlpha",!1).then(lb=>{c.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${yc.a.ih.$j.m-gb} Millisecond.`);
c.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${lb}]`);return this.d0d=lb}))}).then(()=>{Kb.push(ub.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(lb=>{c.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${yc.a.ih.$j.m-gb} Millisecond.`);c.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${lb}]`);
zc.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,[{name:"IsRestrictedByLicense",bool:lb}]);this.d3f=lb&&Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return lb}))}).then(()=>{Kb.push(ub.isFeatureEnabled("StockHistory",!1).then(lb=>{c.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${yc.a.ih.$j.m-gb} Millisecond.`);c.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${lb}]`);
return this.VZd=lb}))}).then(()=>{Kb.push(ub.isFeatureEnabled("ExcelPowerBiFree",!1).then(lb=>{c.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${yc.a.ih.$j.m-gb} Millisecond.`);c.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${lb}]`);return this.zYd=lb}))}).then(()=>{Kb.push(ub.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(lb=>{c.ULS.sendTraceTag(537166734,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${yc.a.ih.$j.m-gb} Millisecond.`);c.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${lb}]`);return this.AYd=lb}))}).then(()=>{Promise.all(Kb).then(()=>{this.f0c()})})})}}get Xwj(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}Ywj(){return[this.WIc,
this.d0d,this.VZd,this.zYd,this.AYd,this.d3f]}Aie(){this.businessBar&&this.businessBar.r6(58)&&this.businessBar.removeEntry(58)}D3i(gb){if(this.p2d!==gb&&this.businessBar)if(this.p2d=gb){gb=this.$.pa.ta;var Kb=this.qTj;const ub=gb.$a(1,null);K.h(gb,"GetErrorMessageForLinkedDataTypeRefresh",ub,Kb,null,null,null,4)}else this.Aie()}static QBi(gb,Kb,ub,lb){gb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',gb,Kb,lb);ub=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
ub);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',gb,ub)}static cjb(gb){return gb.StringId?gb.Id.toString()+"."+gb.StringId:gb.Id.toString()}};db.Xrf="ConvertToLinkedEntityPreview";db.rDd="PreviewGalleryButtonIndex.";db.Aqb=0;db.l7f=2;db=kb=Object(A.__decorate)([Object(La.d)(pb.hb),Object(A.__param)(0,Object(pb.Nb)()),Object(A.__param)(1,Object(pb.uf)()),Object(A.__param)(2,Object(fa.i)()),Object(A.__param)(3,Object(pb.Lb)()),Object(A.__param)(4,
Object(pb["if"])()),Object(A.__param)(5,Object(pb.C)()),Object(A.__param)(6,Object(pb.pd)())],db);Object(u.a)(db,"ConvertToLinkedEntityManager",n.a,[607,608,4,609])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pi.js.map/f0ae74007cc274bb9362ccb41aae2227/EwaTS.pi.js.map