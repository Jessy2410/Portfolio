'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1264:function(A,u,a){u=a(483);a=a(1454);a=a.Qw?a.default:a;"string"===typeof a&&(a=[[A.i,a,""]]);u(a,{insert:"head",eD:!1});A.exports=a.EH||{}},1454:function(A,u,a){u=a(484)(!1);u.push([A.i,".ewa-svg-icon{height:100%;width:100%}",""]);A.exports=u},1455:function(A,u,a){u=a(483);a=a(1456);a=a.Qw?a.default:a;"string"===typeof a&&(a=[[A.i,a,""]]);u(a,{insert:"head",eD:!1});A.exports=a.EH||{}},1456:function(A,u,
a){u=a(484)(!1);u.push([A.i,'.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-invalid-sheetname-container{position:fixed;top:0;right:0;bottom:0;left:0;z-index:-1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media (prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}.ewa-stb-uir .rename-textbox-active{background-color:#e0e0e0!important}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:transparent;border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width .4s cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-uir .tab-active.rename-textbox-active .tab-content-container::before{width:calc(100%)}.ewa-stb-tabs .tab-content-container,.ewa-stb-tabs .tab-text{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px!important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0!important;margin-right:4px!important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar ::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:700;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:700;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px!important;height:13px!important;width:12px!important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0!important;margin-left:4px!important}.ewa-stb-rename-textbox{position:relative;display:none;border:none;outline:0;font-family:inherit;font-size:inherit;background:0 0}.ewa-stb-rename-textbox::selection{color:#fff;background-color:#616161}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover,.ewr-presentMode-on .ewa-stb-uir .tab-hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39!important;border:1px solid #e5e5e5!important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}',
""]);A.exports=u},399:function(A,u,a){a.r(u);var c={};a.r(c);a.d(c,"IndexedDB",function(){return L});var b={};a.r(b);a.d(b,"MoreColorsHelper",function(){return la});var h={};a.r(h);var r={};a.r(r);a.d(r,"OAuthManagerWrapper",function(){return wa});var f={};a.r(f);a.d(f,"PopulateDynamicHelper",function(){return vb});var l={};a.r(l);a.d(l,"RibbonControlsManager",function(){return Xd});var m={};a.r(m);a.d(m,"SheetDropdownMenuCommandHandler",function(){return gc});var x={};a.r(x);a.d(x,"SheetTabBarFactory",
function(){return Wb});var n=a(135),t=a(0),w=a(15),v=a(35),k=a(183),y=a(233),C=a(39),B=a(32),E=a(1);class K{constructor(Qa){this.keyPath=Qa}}Object(t.a)(K,"KeyPathClass",null,[]);var F=a(67),W=a(95),J=a(5);let L=class extends y.a{constructor(Qa){super();this.nyb=this.ZAd=null;this.Fnf=1;this.Mbb=null;this.qLa=!1;this.$=Qa;this.qLa=E.EwaSettings.isChangeGateEnabled("OfficeVSO:8787787_AddPerfTelemetryForIndexedDbOps")}get indexedDBFactory(){this.Mbb||(window.indexedDB?this.Mbb=window.indexedDB:window.webkitIndexedDB?
this.Mbb=window.webkitIndexedDB:window.mozIndexedDB?this.Mbb=window.mozIndexedDB:window.msIndexedDB&&(this.Mbb=window.msIndexedDB));return this.Mbb}get initialized(){return!!this.ZAd&&!!this.nyb}initialize(Qa,Ob,Pc){this.ZAd=Qa;this.nyb=Ob;this.Fnf=Pc}zl(){try{return E.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&v.a.Foa||v.a.Am&&91===v.a.tHd?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(Qa){return w.ULS.sendTraceTag(537157640,0,15,`IndexedDB.IsSupported() failed. Exception: ${Qa.message}`),
!1}}lBa(Qa){if(!this.zl()||!this.initialized)return w.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),F.Task.Ua(!1);const Ob=B.a.ih.$j.m;return C.TaskExtensions.MXa(this.jbe(),Pc=>{if(void 0===Pc.result)return!1;var Cd=Pc.result;this.gtc(Cd);Pc=B.a.ih.$j.m;this.OOd(Cd,!1).put(Qa);Cd=B.a.ih.$j.m;this.qLa?w.ULS.sendTraceTag(507363798,0,50,`IndexedDB.saveToIndexedDB takes ${Cd-Ob} Millisecond.`):w.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${Cd-
Pc} Millisecond.`);return!0},this.ya)}IBd(Qa){if(!this.zl()||!this.initialized)return w.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),F.Task.Ua(!1);const Ob=B.a.ih.$j.m;return C.TaskExtensions.MXa(this.jbe(),Pc=>{if(void 0===Pc.result&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;var Cd=Pc.result;this.gtc(Cd);Pc=B.a.ih.$j.m;this.OOd(Cd,!1)["delete"](Qa);Cd=B.a.ih.$j.m;this.qLa?w.ULS.sendTraceTag(507363797,
0,50,`IndexedDB.DeleteFromIndexedDB takes ${Cd-Ob} Millisecond.`):w.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${Cd-Pc} Millisecond.`);return!0},this.ya)}fxa(Qa){if(!this.zl()||!this.initialized)return w.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),F.Task.Ua("");const Ob=B.a.ih.$j.m;return C.TaskExtensions.Z1h(this.jbe(),Pc=>{if(void 0===Pc.result&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return F.Task.Ua("");
Pc=Pc.result;return this.qLa?(Pc=this.kHf(Pc,Qa),w.ULS.sendTraceTag(507363796,0,50,`IndexedDB.getFromIndexedDB takes ${B.a.ih.$j.m-Ob} Millisecond.`),Pc):this.kHf(Pc,Qa)},this.ya)}deleteDatabase(Qa){if(!this.zl())return w.ULS.sendTraceTag(507872215,0,15,"IndexedDB.deleteDatabase: not supported."),F.Task.Ua(!1);const Ob=B.a.ih.$j.m,Pc=new k.a;Qa=this.indexedDBFactory.deleteDatabase(Qa);Qa.onsuccess=()=>{Pc.setResult(!0);this.qLa&&w.ULS.sendTraceTag(507363795,0,50,`IndexedDB.deleteDatabase takes ${B.a.ih.$j.m-
Ob} Millisecond.`)};Qa.onerror=()=>{Pc.setResult(!1)};return Pc.task}gtc(Qa){if(!Qa.objectStoreNames.contains(this.nyb)){const Ob=B.a.ih.$j.m;Qa.createObjectStore(this.nyb,new K("key"));this.qLa&&w.ULS.sendTraceTag(507363794,0,50,`IndexedDB.createDBObjectStore takes ${B.a.ih.$j.m-Ob} Millisecond.`)}}jbe(){const Qa=B.a.ih.$j.m,Ob=new k.a,Pc=this.indexedDBFactory.open(this.ZAd,this.Fnf);Pc.onsuccess=()=>{const Cd=Pc.result;w.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${Cd.name} success`);Ob.setResult(Cd)};
Pc.onupgradeneeded=()=>{const Cd=Pc.result;w.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${Cd.name} upgrade needed`);try{this.gtc(Cd),w.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${Cd.name} upgrade done`),this.qLa&&w.ULS.sendTraceTag(507363793,0,50,`IndexedDB.openIndexedDB takes ${B.a.ih.$j.m-Qa} Millisecond.`)}catch(Ud){w.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${Ud}`),E.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?Ob.setResult(void 0):Ob.setException(Error.create("Failed to upgrade IndexedDB"))}};
Pc.onerror=Cd=>{w.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${Cd} failed`);Ob.setResult(void 0)};return Ob.task}OOd(Qa,Ob){return Qa.transaction([this.nyb],Ob?"readonly":"readwrite").objectStore(this.nyb)}kHf(Qa,Ob){const Pc=B.a.ih.$j.m,Cd=new k.a;this.gtc(Qa);const Ud=B.a.ih.$j.m,Wd=this.OOd(Qa,!0).get(Ob);Wd.onsuccess=le=>{(le=le.target.result)?(Cd.setResult(le.value),le=B.a.ih.$j.m,this.qLa?w.ULS.sendTraceTag(507363792,0,50,`IndexedDB.getFromDB takes ${le-Pc} Millisecond.`):w.ULS.sendTraceTag(537157633,
0,50,`IndexedDB.GetFromIndexedDB takes ${le-Ud} Millisecond.`)):Cd.setResult("")};Wd.onerror=()=>{Cd.setException(Error.create(Wd.error?Wd.error.message:"DB error"))};return Cd.task}};L=Object(n.__decorate)([Object(W.d)(J.vd,{Fk:"transient"}),Object(n.__param)(0,Object(J.Nb)())],L);Object(t.a)(L,"IndexedDB",y.a,[236]);var M=a(33),Q=a(366),H=a(367),ba=a(210),U=a(83),D=a(395),I=a(154),X=a(427),Y=a(216),ja=a(228),Ua=a(197),ka=a(36),fb=a(254),ha=a(264),ea=a(155);class aa{constructor(Qa,Ob,Pc,Cd){this.red=
Qa;this.green=Ob;this.blue=Pc;this.alpha=Cd}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(t.a)(aa,"ColorObject",null,[]);class ca{constructor(Qa){this.T9=this.RQ=null;this.Vud=Qa}get head(){return this.RQ}get lwe(){return this.T9}Gof(Qa){this.head&&(Qa.pre?Qa.next?(Qa.pre.next=Qa.next,Qa.next.pre=Qa.pre):(this.T9=Qa.pre,this.lwe.next=null):Qa.next?(this.RQ=Qa.next,this.head.pre=null):this.T9=this.RQ=null,Qa.next=null,Qa.pre=null)}xAh(Qa){this.head?
(Qa.next=this.head,this.RQ=Qa,Qa.next.pre=this.head):this.T9=this.RQ=Qa}getItems(){if(!this.head)return null;const Qa=new ba.a;let Ob=this.head;for(;Ob;)if(Qa.add(Ob.value),Ob=Ob.next,Qa.count>this.Vud){w.ULS.sendTraceTag(537155399,0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return Qa}}Object(t.a)(ca,"CustomLinkedList",null,[]);class xa{constructor(Qa){this.pre=this.next=null;this.value=Qa}}Object(t.a)(xa,"CustomLinkedListNode",null,[]);class Oa{constructor(Qa){this.Vud=
Qa;this.INc={};this.Bqb=new ca(Qa);this.count=0}add(Qa,Ob){Qa&&Ob?(Ob=new xa(Ob),this.contains(Qa)?this.Bqb.Gof(this.INc[Qa]):this.count<this.Vud?this.count++:(delete this.INc[this.Bqb.lwe.value.toString()],this.Bqb.Gof(this.Bqb.lwe)),this.Bqb.xAh(Ob),this.INc[Qa]=Ob):w.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${Qa} or Value ${Ob} is null.`)}getItems(){return this.Bqb.getItems()}contains(Qa){return Qa?Qa in this.INc:!1}}Object(t.a)(Oa,"MRUCache",null,[]);var ua=a(240),Ia=a(12);class Sa extends ua.a{constructor(Qa,
Ob,Pc,Cd){Cd=void 0===Cd?null:Cd;super(!1,!1,!0);this.fm=null;this.nZh=(Ud,Wd)=>{this.Xgf(Ud,Wd)};this.$=Qa;this.W$i=Ob;this.rUf=Pc;this.Ygf=Cd}Zm(){const Qa=Ia.a.instance.ia(1346),Ob={};Ob[Sa.Wch]=this.W$i;Ob[Sa.sah]=Sa.tcc;Ob[Sa.Rch]=Sa.tcc;Ob[Sa.efh]=Sa.tcc;Ob[Sa.Deh]=Sa.tcc;Ob[Sa.beh]=Ia.a.instance.ia(2105);Ob[Sa.Ich]=Ia.a.instance.ia(2089);Ob[Sa.Pah]=Ia.a.instance.ia(2076);Ob[Sa.Och]=Ia.a.instance.ia(1347);Ob[Sa.tah]=Ia.a.instance.ia(1348);this.rUf!==Sa.uah&&(Ob[Sa.vah]=Sa.ALPHA,Ob[Sa.ALPHA]=
this.rUf);this.initializeAndShow(Qa,this.nZh,{[Sa.cch]:Sa.pbh,[Sa.Qah]:Ob})}Xgf(Qa,Ob){Ob=Ob[Sa.x6c];1===Qa&&this.zfg(Ua.a.Oia(Ob));this.Ygf&&this.Ygf(1===Qa,1===Qa?Ob:null)}zfg(Qa){this.fm||(this.fm=W.a.nh(J.Td));Qa=ja.a.LM(Ua.a.hP(Qa,!1));this.fm.YWc(Qa.r,Qa.g,Qa.b,D.a.scc)}}Sa.Wch="initColor";Sa.cch="id";Sa.pbh="ColorPickerDialog";Sa.Qah="bodyControls";Sa.x6c="selectedColorText";Sa.Rch="hueAriaLabel";Sa.efh="transparencyAriaLabel";Sa.Deh="svAriaLabel";Sa.tcc="Use left & right arrows keys to change values in color picker & hue slider";
Sa.ALPHA="alpha";Sa.P5c="alphaValue";Sa.sah="alphaAriaLabel";Sa.vah="alphaSliderType";Sa.uah=-1;Sa.vdh=100;Sa.beh="redLabel";Sa.Pah="blueLabel";Sa.Ich="greenLabel";Sa.Och="hexLabel";Sa.tah="alphaLabel";Object(t.a)(Sa,"MoreColorsDialog",ua.a,[]);var Ya=a(7),da=a(606),Ea=a(62);class oa extends Sa{constructor(Qa,Ob,Pc,Cd,Ud){super(Qa,Cd,Ud);this.commandName=null;this.ZWf=!1;this.command=Ob;this.Nh=Pc;this.O$i=Ud}Zm(){super.Zm();this.commandName=Ea.b().zp(this.Nh.command);w.ULS.sendTraceTag(545051016,
0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.Nh.jk}`)}Xgf(Qa,Ob){if(1===Qa)if(Qa=this.$.Eh.em("UserAction",this.commandName),Qa.start(),da.a(Qa),Ob)if(Sa.x6c in Ob){var Pc=Ob[Sa.x6c];if(Qa=Ua.a.Oia(Pc)){Pc=new U.a(this.command,this.Nh.method,this.Nh.mode,this.Nh.jk,this.Nh.tabName?this.Nh.tabName:1378078823===this.command||-400966242===this.command?Ya.a.EOa:Ya.a.VS);var Cd={};Cd.Color=Qa;Cd.UILocation=this.Nh.jk;Sa.P5c in Ob&&(this.O$i!==
Ob[Sa.P5c]&&(this.ZWf=!0),Cd.Alpha=(Ob[Sa.P5c]/Sa.vdh).toString(),w.ULS.sendTraceTag(508822752,0,50,"Alpha Value selected from the MoreColors Dialog."));this.$.Ma.qh(Pc,Cd);this.$.Dm();this.zfg(Qa);Ob={["Command"]:this.commandName,["Location"]:this.Nh.jk};Ob.AlphaApplied=this.ZWf.toString();ea.b(this.$).Aj(I.a.oHj,Ob,null,!0)}else this.hide(),w.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${Pc}, Command: ${this.commandName}`)}else this.hide(),
w.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),w.ULS.sendTraceTag(537155362,0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(t.a)(oa,"MoreColorsRibbonDialog",Sa,[]);var za=a(64);Object(W.b)(J.Td,{Fk:"singleton"})(Qa=>Lo(function*(){const Ob=yield W.a.resolve(J.Nb,Qa),Pc=(yield W.a.resolve(J.hf,Qa)).w7f();return new la(Ob,Pc)}));class la{constructor(Qa,Ob){this.YVe="00FFFF";this.ZVe="0000FF";this.vBg="00FFFF";this.wBg=
"BF7000";this.n6a=null;this.OIf=!1;this.zRe=null;this.vA=E.EwaSettings.Rp("MoreColorsHelper");this.Swd=()=>{var Pc;null===(Pc=this.Smd)||void 0===Pc?void 0:Pc.abort()};this.lPf=Pc=>{Pc&&Pc.key&&(1===Pc.key.length||"Backspace"===Pc.key||"Delete"===Pc.key||"Enter"===Pc.key?(Pc.preventDefault(),Pc.stopImmediatePropagation()):this.Swd())};this.QTj=Pc=>{if(!fb.a(Pc)){Pc=Pc.Result;this.n6a=new Oa(10);for(let Ud=Pc.length-1;0<=Ud;Ud--){var Cd=Pc[Ud];Cd=new aa(Cd.Red,Cd.Green,Cd.Blue,Cd.Alpha);this.n6a.add(Cd.toString(),
Cd)}this.tvg();w.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.PTj=()=>{w.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.iJ=()=>{this.byc()};this.gr=()=>{this.byc()};this.$=Qa;this.oZb=Ob;this.vA?this.$.ea.jn?this.gr():this.$.ea.lw(this.gr):this.$.ea.nm?this.byc():E.EwaSettings.wl()?this.$.ea.Yq(this.iJ):this.$.ea.lr(this.iJ)}get nZb(){return this.zRe}get o6a(){return this.YVe}set o6a(Qa){this.YVe=
Qa}get Pub(){return this.ZVe}set Pub(Qa){this.ZVe=Qa}get NTc(){return this.vBg}set NTc(Qa){this.vBg=Qa}get OTc(){return this.wBg}set OTc(Qa){this.wBg=Qa}sqb(Qa,Ob,Pc,Cd){Cd=void 0===Cd?-1:Cd;return this.oZb?C.TaskExtensions.Xa(this.oZb,()=>{(new oa(this.$,Qa,Ob,Pc,Cd)).Zm()},this.$.ya):null}launchEyedropper(Qa,Ob,Pc){const Cd=window.EyeDropper,Ud=new Cd;if(!Cd||!Ud||!(null!=Pc||Qa&&Ob))return F.Task.Ua(!1);let Wd=null;if(!Pc)switch(Qa){case 1188510340:Wd=1650812936;break;case -1828502776:Wd=1970784898;
break;case -1252156667:Wd=1378078823;break;case -2063061844:Wd=-400966242;break;case -260488795:Wd=-236759591;break;case -605730035:Wd=467002767;break;case -984702347:Wd=409031041;break;default:return w.ULS.shipAssertTag(508063765,0,!1,`MoreColorsHelper.launchEyedropper: Invalid eyedropper command ${Qa}`),F.Task.Ua(!1)}this.Smd=new AbortController;const le=Ob?Ea.b().zp(Ob.command):"EyedropperConditionalFormatting";Ud.open({signal:this.Smd.signal}).then(Fa=>{var mb=this.$.Eh.em("UserAction",le);mb.start();
da.a(mb);mb=Ua.a.Oia(Fa.sRGBHex);if(!mb)return w.ULS.shipAssertTag(508065669,0,!1,"MoreColorsHelper.launchEyedropper: Failed to return the color in expected format BBGGRR."),F.Task.Ua(!1);null!=Pc&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8572137_Eyedropper_Conditional_Formatting")?(w.ULS.sendTraceTag(507774978,0,50,"MoreColorsHelper.launchEyedropper: Eyedropper is used for Conditional Formatting."),Pc(Fa.sRGBHex?!0:!1,Fa.sRGBHex.substring(1))):(Fa=new U.a(Wd,Ob.method,Ob.mode,Ob.jk,Ob.tabName),
this.$.Ma.qh(Fa,{["Color"]:mb,["UILocation"]:Ob.jk}),this.$.Dm());Fa=ja.a.LM(Ua.a.hP(mb,!1));null!=Fa&&this.YWc(Fa.r,Fa.g,Fa.b,D.a.scc);Fa=Wd?{["Command"]:Ea.b().zp(Ob.command),["Location"]:Ob.jk}:{["IsCommand"]:!1,["Location"]:12};ea.b(this.$).Aj(I.a.hui,Fa,null,!0);return F.Task.Ua(!0)}).catch(Fa=>{w.ULS.sendTraceTag(508065668,0,10,"MoreColorsHelper.launchEyedropper: Failed to apply eyedropper color. Exception: {0}",Fa.toString());return F.Task.Ua(!1)}).finally(()=>{window.removeEventListener("blur",
this.Swd);window.removeEventListener("keydown",this.lPf,!0);this.Smd=null});window.addEventListener("blur",this.Swd);window.addEventListener("keydown",this.lPf,!0);return F.Task.Ua(!0)}gwj(Qa,Ob){var Pc=void 0;Pc=void 0===Pc?-1:Pc;Ob=void 0===Ob?null:Ob;this.oZb&&C.TaskExtensions.Xa(this.oZb,()=>{(new Sa(this.$,Qa,Pc,Ob)).Zm()},this.$.ya)}yUi(Qa){let Ob=null;switch(Qa){case "QueryRecentFillColor":Ob=this.o6a;break;case "QueryRecentFontColor":Ob=this.Pub;break;case "QueryRecentShapesFillColor":Ob=
this.NTc;break;case "QueryRecentShapesOutlineColor":Ob=this.OTc}return Ob?M.a.Xlb(Ob):null}dispose(){this.oZb=null;this.$&&(this.vA?this.$.ea.KA(this.gr):E.EwaSettings.wl()||this.$.ea.Bv(this.iJ))}byc(){if(this.$.isEditMode)if(this.n6a)this.tvg();else{this.OIf&&w.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");var Qa=this.$.pa.ta;this.$.userOperationManager.enqueueOperation(new Y.a(1009,0,(Ob,Pc,Cd)=>
{Ob=ha.c.call(null,Ob,this.QTj);Pc=ha.b.call(null,Pc,this.PTj);const Ud=Qa.$a(1,null);return za.h(Qa,"GetMRUColors",Ud,Ob,Pc,Cd,null,4)},80),null);this.OIf=!0}}tvg(){var Qa=this.n6a.getItems();if(Qa){this.zRe=new ba.a;for(const Ob of Qa)Qa=Ob,Qa=new ja.a(Qa.red,Qa.green,Qa.blue),this.nZb.add(Ua.a.DJ(Qa))}}YWc(Qa,Ob,Pc,Cd){this.n6a||(this.n6a=new Oa(10));const Ud=new aa(Qa,Ob,Pc,Cd);this.n6a.add(Ud.toString(),Ud);this.saveMRUColor(null,Qa,Ob,Pc,Cd)}LAa(Qa,Ob,Pc){(Qa||this.$.isEditMode)&&this.CTg(Qa.SqmControlId)&&
(Qa=ja.a.LM(Ua.a.hP(Ob,!1)))&&(this.YWc(Qa.r,Qa.g,Qa.b,D.a.scc),Pc={["Command"]:Ea.b().zp(Pc.command),["Location"]:Q.a[Pc.jk],["InputMethod"]:H.a[Pc.method]},ea.b(this.$).Aj(I.a.LAa,Pc,null,!0))}CTg(Qa){return!!Qa&&Qa.startsWith("RecentColorPicker")}saveMRUColor(Qa,Ob,Pc,Cd,Ud){return X.a(this.$.userOperationManager,(Wd,le,Fa)=>{var mb=this.$.pa.ta;Wd=ha.c(Wd,la.oZj());le=ha.b(le,la.nZj());const e=mb.$a(9,null);e.bRed=Ob;e.bGreen=Pc;e.bBlue=Cd;e.bAlpha=Ud;return za.h(mb,"SaveMRUColor",e,Wd,le,Fa,
null,0)},Wd=>new Y.a(1008,0,Wd,E.EwaSettings.isChangeGateEnabled("OfficeVSO:8546775_SaveMRUColor_NonBlockingOperation")?64:null),Qa)}static oZj(){return Qa=>{ka.a.jl(Qa.Errors)?w.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):w.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static nZj(){return()=>{w.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}
Object(t.a)(la,"MoreColorsHelper",null,[875,4]);var Ca=a(42);Object(W.b)(J.je)(()=>Ca.a.instance.resolve("Common.App.OAuth.IOAuthManager"));var Va=a(2),ia=a(1050);let wa=class{constructor(Qa){this.nNa=Qa}gE(Qa,Ob){return this.nNa?this.nNa.gE(Qa,Ob).then(Pc=>{Pc.IsSuccess||w.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+Pc.ErrorMessage+" Error code: "+Pc.ErrorCode+" App name: "+Qa);return Object(Va.a)(new ia.a,{IsSuccess:Pc.IsSuccess,Token:Pc.Token,ErrorCode:Pc.ErrorCode,
ErrorMessage:Pc.ErrorMessage})}):(w.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(Va.a)(new ia.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}f1a(){return this.nNa?this.nNa.f1a():null}};wa=Object(n.__decorate)([Object(W.d)(J.ke),Object(n.__param)(0,Object(J.je)())],wa);Object(t.a)(wa,"OAuthManagerWrapper",null,[873]);var Jb=a(488),$a=a(6),Ka=a(432),nb=a(289),sa=a(712);class na{constructor(){this.Alt=
this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(t.a)(na,"ColorCellProps",null,[]);var ab=a(355),Ja=a(19),Pa=a(60),hb=a(245),ac=a(153),Hc=a(244),bd=a(335),zc=a(13),oc=a(397),Nb=a(28),Aa=a(23);class Ub{constructor(Qa){this.z8c=null;this.$=Qa;this.grid=Aa.f(this.$)}get borderFormatManager(){this.z8c||(this.z8c=this.$.la.kh(296));return this.z8c}HNi(Qa){var Ob=null;switch(Qa){case 467002767:Ob={};this.$.dr(Ob);Ob=Object(ac.a)(oc.a,this.$.sa).VLf(Ob.SheetName,!0);break;case -236759591:Ob=this.KFi();
break;case 1970784898:Ob=this.WLd(0);break;case 1650812936:case 1378078823:Ob=this.WLd(1);break;case -400966242:Ob=this.getShapeOutlineColor();break;case 1597684571:E.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&this.grid.ha.$e&&this.grid.ha.$e.Lh&&(Qa=this.grid.ha.$e.Lh.floatingObject,0===Qa.type&&Qa.Ti&&(Ob=this.WLd(1)));break;case 409031041:E.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&(Ob=this.WEf(Qa));break;default:w.ULS.sendTraceTag(537154460,
0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${Qa}'`)}return Ob}KFi(){let Qa=null;this.borderFormatManager&&(Qa=this.borderFormatManager.yfa);(Qa="black"===Qa?"000000":Qa)&&(Qa=M.a.Xlb(Qa));return Qa}getShapeOutlineColor(){let Qa=null;if(this.grid.ha.$e&&this.grid.ha.$e.Lh){const Ob=this.grid.ha.$e.Lh.floatingObject;5===Ob.type&&Ob.Ch&&-1!==Ob.Ch.ShapeOutlineColor&&(Qa=Ua.a.I2(Ob.Ch.ShapeOutlineColor),Qa=Qa.toUpperCase())}return Qa}WEf(Qa){let Ob=
null;if(this.grid.ha.$e&&this.grid.ha.$e.Lh){const Pc=this.grid.ha.$e.Lh,Cd=Pc.floatingObject;0===Cd.type&&Cd.Ti&&(Ob=Pc.BSb(Qa))}return Ob}WLd(Qa){let Ob=null;if(this.grid.ha.$e&&this.grid.ha.$e.Lh){var Pc=this.grid.ha.$e.Lh.floatingObject;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&0===Pc.type&&Pc.Ti){if(0===Qa||1===Qa)Ob=this.WEf(0===Qa?1970784898:1597684571);return Ob}5===Pc.type&&Pc.Ch?1===Qa&&-1!==Pc.Ch.ShapeFillColor?(Ob=Ua.a.I2(Pc.Ch.ShapeFillColor),
Ob=Ob.toUpperCase()):w.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):w.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");return Ob}Pc=this.grid.vfa("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ha.qa.selectedRanges,1,!0);try{for(Pc.$$rst();Pc.$$mn();){const Cd=Pc.$$cu().cell;
if(!Cd)continue;let Ud="#000000";if(0===Qa){Ud=Cd.color;if(this.grid.isEditing)return this.oMi();Cd.hasRichText&&(Ud=this.pMi(Cd))}else if(1===Qa){const Wd=Cd.backgroundColor;Ud=Nb.a.compare(Wd,"transparent",!0)&&Wd?Cd.backgroundColor:null}if(!Ob)Ob=Ud;else if(Ob!==Ud){Ob=null;break}}}finally{Pc&&Pc.dispose()}return Ob}oMi(){var Qa=null,Ob=this.grid.Fh,Pc=this.grid.cellTextEditBox.formattedText;if(Pc){Qa=Pc.TextRuns;const Cd=hb.a.map(Qa,Ud=>Ud.StartIndex);Pc=Pc.Fonts;Ob=Ob.Wa.caretPosition;Ob=zc.HelperMethods.Pzf(new Hc.a(Cd),
Cd.length,Ob,zc.HelperMethods.FS);Qa=Pc[Qa[Ob].FontID].Color}return Qa?Qa.toUpperCase():null}pMi(Qa){Qa=bd.a(Qa.formattedText.Fonts);if(bd.e(Qa,32))(Qa=Ua.a.Oia(Ua.a.I2(Qa.FontColor)))&&(Qa="#"+Qa.toUpperCase());else return null;return Qa}}Object(t.a)(Ub,"ColorHighlighterHelper",null,[899]);var Db=a(227),Ib=a(25),yc=a(664);class xc{constructor(Qa,Ob,Pc){this.LTc=this.N9b=this.H1c=null;this.SMg="-1";this.Hij=$a.AFrameworkApplication.fa.ka("IsO365ConsumerHost");this.$=Qa;this.fm=Ob;this.Ow=Pc;this.Vgf=
new Ub(Qa)}VIf(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e,Ra){Ob=void 0===Ob?null:Ob;Pc=void 0===Pc?null:Pc;Cd=void 0===Cd?null:Cd;Fa=void 0===Fa?null:Fa;mb=void 0===mb?null:mb;return this.h0(null!=Ob,null!=Pc,null!=Cd,null!=Fa,null!=mb,!0,void 0===e?!1:e,Qa,Ob,Pc,Cd,void 0===Ud?null:Ud,void 0===Wd?null:Wd,void 0===le?null:le,Fa,mb,void 0===Ra?null:Ra)}uXi(Qa,Ob,Pc,Cd,Ud){return this.h0(Qa,Ob,Pc,Cd,Ud,!1)}WIf(Qa,Ob,Pc,Cd,Ud,Wd,le){const Fa=[];Qa=this.VIf(Qa,void 0===Ob?null:Ob,void 0===Pc?null:Pc,void 0===Cd?null:
Cd,void 0,void 0,void 0,void 0===Ud?null:Ud,void 0===Wd?null:Wd,!1,void 0===le?null:le);for(let mb=0,e=Qa.length;mb<e;mb++)Fa.push(Db.r(Qa[mb]));return Fa}h0(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e,Ra,O,qa,ob,R,Za,Cb){le=void 0===le?!1:le;Fa=void 0===Fa?null:Fa;mb=void 0===mb?null:mb;e=void 0===e?null:e;Ra=void 0===Ra?null:Ra;O=void 0===O?null:O;qa=void 0===qa?null:qa;ob=void 0===ob?null:ob;R=void 0===R?null:R;Za=void 0===Za?null:Za;Cb=void 0===Cb?null:Cb;w.ULS.shipAssertTag(537154456,0,!Wd||null!=Fa,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");
const rc=[];let ma=null,qb=3,Xb=null,qc=null,Uc=null;this.rmi();if(this.$&&this.$.isEditMode&&!this.V7j(Cb))return w.ULS.sendTraceTag(537154455,0,50,`Theme Info not present at the time of ${Cb} menu opening`),rc;le&&E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)&&Ib.a.hV()&&Ib.a.hHc()&&(le=Ia.a.instance.ia(2501),rc.push(this.sxa(xc.Cjf,this.oBi(xc.Cjf,le))));Qa&&(Wd&&null==mb?w.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):
rc.push(this.sxa(xc.ELh,this.jBi(xc.s$e,mb,ob,qa))));Wd&&null!=Fa&&this.Vgf&&(qc=Xb="-1",ma=this.Vgf.HNi(Fa))&&(w.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${Fa} is not null .`),ma=Ua.a.Oia(ma),qb=this.KHf(ma),Xb=this.rOd(ma,qb,0,!0),qc=this.rOd(ma,qb,1,!1));rc.push(this.sxa(xc.fZk,this.uJd(xc.l0g,Xb,this.H1c,Fa,O,qa),1341));rc.push(this.sxa(xc.rUk,this.uJd(xc.qUk,qc,this.N9b,Fa,O,qa),1342));this.$&&this.$.isEditMode&&this.fm&&(this.S7j(),Wd&&(Uc="-1",
ma&&(Uc=this.rOd(ma,qb,2,!0))),this.fm&&this.fm.nZb&&0<this.fm.nZb.count&&rc.push(this.sxa(xc.Cfk,this.uJd(xc.Bfk,Uc,this.LTc,Fa,O,qa),1349)));Ob&&(Wd&&null==e?w.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):rc.push(this.sxa(xc.qKj,this.kBi(xc.Aff,e,this.mHi(e),ob,qa))));!Pc||E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode||!this.Hij&&!E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ColorPickerHighlightWhenEnabled",
!1)||(Wd&&!Ra?w.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):rc.push(this.sxa(xc.z8i,this.TBi(xc.ISf,Ra))));Cd&&(Wd&&null==R?w.ULS.shipAssertTag(537154451,0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):rc.push(this.sxa(xc.pHj,this.tCi(xc.ndg,R,this.oQi(R)))));Ib.a.MK()&&Ud&&rc.push(this.sxa(xc.xGd,this.FBi(xc.xGd,Za)));return rc}rOd(Qa,Ob,Pc,Cd){3===Ob&&(Ob=this.KHf(Qa));
return 0===Pc&&Ob===Pc?this.SMg.toLowerCase():Ob===Pc?Cd?Qa.toLowerCase():Qa:"-1"}KHf(Qa){if(!Qa)return 3;const Ob=Qa.toLowerCase();return this.H1c&&this.Bsj(Ob,this.H1c)?0:this.N9b&&this.QXf(Qa,this.N9b)?1:this.LTc&&this.QXf(Ob,this.LTc)?2:3}sxa(Qa,Ob,Pc){Pc=void 0===Pc?null:Pc;Qa=Object(Va.a)(new Ka.a,{Id:Qa,Title:null!=Pc?Ia.a.instance.ia(Pc):"",ControlList:[],ControlsId:Qa+".Controls"});Qa.ControlList.push(Ob);return Qa}kBi(Qa,Ob,Pc,Cd,Ud){return this.KCf(Qa,Ob,Pc,Ja.a.Pvf,"transparent",void 0===
Cd?null:Cd,void 0===Ud?null:Ud)}TBi(Qa,Ob){return Object(Va.a)(new nb.a,{Command:null!=Ob?Ob.toString():null,LabelText:Ia.a.instance.ia(1433),Id:Qa,ExternalId:this.sna(Qa,Ob),ExternalImageId:"ConditionalFormatting_20"})}jBi(Qa,Ob,Pc,Cd){return this.KCf(Qa,Ob,542,Ja.a.Ovf,"000000",void 0===Pc?null:Pc,void 0===Cd?null:Cd)}KCf(Qa,Ob,Pc,Cd,Ud,Wd,le){Wd=void 0===Wd?null:Wd;le=void 0===le?null:le;return Object(Va.a)(new nb.a,{Command:null!=Ob?Ob.toString():null,CommandPreviewId:null!=Wd?Wd.toString():null,
CommandRevertId:null!=le?le.toString():null,MenuItemsStatefulData:this.VPi(Qa,Ob,Ud),LabelText:Ia.a.instance.ia(Pc),Id:Qa,ExternalId:this.sna(Qa,Ob),Image16by16:Pa.a.An(1),Image16by16Class:Cd})}VPi(Qa,Ob,Pc){const Cd={};Qa=this.sna(Qa,Ob);Cd[Qa]={};Cd[Qa].iconColor=Pc;return Cd}QXf(Qa,Ob){for(let Pc=0;Pc<Ob.length;Pc++)if(Qa===Ob[Pc].Color)return!0;return!1}Nqj(Qa,Ob){Qa=Ua.a.Ou(Qa);Ob=Ua.a.Ou(Ob);return 1>=Math.abs(Qa.r-Ob.r)&&1>=Math.abs(Qa.g-Ob.g)&&1>=Math.abs(Qa.b-Ob.b)?!0:!1}Bsj(Qa,Ob){for(let Pc=
0;Pc<Ob.length;Pc++){const Cd=Ob[Pc].Color;if(this.Nqj(Qa,Cd))return this.SMg=Cd.toLowerCase(),!0}return!1}uJd(Qa,Ob,Pc,Cd,Ud,Wd){Ud=void 0===Ud?null:Ud;Wd=void 0===Wd?null:Wd;return Object(Va.a)(new sa.a,{McuLayout:!0,Command:null!=Cd?Cd.toString():null,CommandPreviewId:null!=Ud?Ud.toString():null,CommandRevertId:null!=Wd?Wd.toString():null,Width:10,Id:`${Qa}.ColorPicker`,SelectedColorId:Ob,Colors:Pc,Stateful:!0,ExternalId:this.sna(Qa,Cd),McuExternalId:`${this.sna(Qa,Cd)}.MCU`})}sna(Qa,Ob){return`${Qa}.${null!=
Ob?Ob.toString():""}`}tJd(...Qa){const Ob=[];for(let Pc=0,Cd=Qa.length;Pc<Cd;Pc+=2)Ob.push(Object(Va.a)(new na,{Color:Qa[Pc],DisplayColor:Ua.a.DJ(ja.a.LM(parseInt(String("0x"+Qa[Pc]),16))),Alt:Object(ab.a)(String,Qa[Pc+1])&&this.$?Qa[Pc+1]:Ia.a.instance.ia(Qa[Pc+1])}));return Ob}tCi(Qa,Ob,Pc){const Cd=Ja.a.dwf;Qa=Object(Va.a)(new nb.a,{Command:null!=Ob?Ob.toString():null,LabelText:Ia.a.instance.ia(Pc),Id:Qa,ExternalId:this.sna(Qa,Ob),Image16by16:Pa.a.An(1),Image16by16Class:Cd});Qa.ShouldTakeFocus=
!1;return Qa}NOh(){const Qa=[2502,2503,2504,2505].map(Ob=>{Ob=Ia.a.instance.ia(Ob);return Object(Va.a)(new nb.a,{Command:(-1997160483).toString(),LabelText:Ob,Id:Ob,MenuItemId:Ob,ExternalId:this.sna(Ob,-1997160483)})});return Object(Va.a)(new Ka.a,{ControlList:Qa})}kOh(){var Qa=Ia.a.instance.ia(2506);Qa=[Object(Va.a)(new nb.a,{Command:(1485761473).toString(),LabelText:Qa,Id:xc.NJh,ExternalId:this.sna(Qa,1485761473),ExternalImageId:"ChatSparkle_20"})];return Object(Va.a)(new Ka.a,{ControlList:Qa})}oBi(Qa,
Ob){const Pc=Object(Va.a)(new Jb.a,{MenuSectionList:[],UpdateDynamically:!0});Pc.MenuSectionList.push(this.NOh());Pc.MenuSectionList.push(this.kOh());return Object(Va.a)(new yc.a,{Command:(1485761473).toString(),LabelText:Ob,ImageIsVisible:!0,Id:Qa,ExternalId:this.sna(Qa,1485761473),ExternalImageId:"M365Excel_20",Menu:Pc})}FBi(Qa,Ob){Qa=Object(Va.a)(new nb.a,{Command:null!=Ob?Ob.toString():null,LabelText:Ia.a.instance.ia(2401),Id:Qa,ExternalId:this.sna(Qa,Ob),Image16by16:Pa.a.An(1),ExternalImageId:"EyedropperFillColor_20"});
Qa.ShouldTakeFocus=!1;return Qa}rmi(){this.N9b||(this.N9b=this.tJd("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}S7j(){this.fm.byc();if(this.fm.nZb){var Qa=this.fm.nZb;const Ob=[];for(const Pc of Qa)Qa=Ua.a.Oia(Pc.substr(1)),Ob.push(Qa,Pc);this.LTc=this.tJd(...Ob)}}V7j(Qa){this.Ow.$Ia(Qa);if(this.Ow.Hyb&&this.Ow.m0g&&!this.Ow.F3f){Qa=this.Ow.Hyb;const Ob=this.Ow.m0g,Pc=[];for(let Cd=0;Cd<Qa.count;Cd++)Pc.push(Qa.na(Cd),
Ob.na(Cd));this.H1c=this.tJd(...Pc);return!0}return!1}oQi(Qa){switch(Qa){case -458147525:Qa=1344;break;case 1610379174:Qa=1345;break;default:Qa=1343}return Qa}mHi(Qa){switch(Qa){case 1549407384:Qa=541;break;case -1744769642:Qa=539;break;default:Qa=540}return Qa}}xc.qKj="NoColor";xc.ELh="Automatic";xc.fZk="ThemeColors";xc.rUk="StandardColors";xc.Cfk="RecentColors";xc.Aff="ClearColor";xc.z8i="HighlightWhen";xc.ISf="HighlightWhen";xc.s$e="AutomaticColor";xc.l0g="ThemeColorPicker";xc.qUk="StandardColorPicker";
xc.pHj="MoreColors";xc.ndg="MoreColors";xc.Bfk="RecentColorPicker";xc.xGd="Eyedropper";xc.Cjf="CopilotSuggestions";xc.NJh="AskCopilot";Object(t.a)(xc,"ColorPickerBuilder",null,[]);class zb{constructor(Qa,Ob,Pc,Cd){this.$=Qa;this.KB=Ob;this.fm=Pc;this.Ow=Cd}getColorPickerButtonMenuProps(Qa){Qa=this.KB.jMf(Qa.automaticColor,Qa.clearColor,Qa.highlightWhen,Qa.moreColors,Qa.eyedropper);return{sections:this.rUi(Qa)}}showMoreColorsDialog(Qa,Ob){this.fm.gwj(Qa,Ob)}onColorUsed(Qa){Qa=ja.a.LM(Ua.a.hP(Ua.a.Oia(Qa),
!1));this.fm.YWc(Qa.r,Qa.g,Qa.b,D.a.scc)}getThemeColor(Qa){const Ob=Ua.a.Oia(Qa);let Pc,Cd;return(()=>{let Ud=this.Ow.getThemeColor(Ob);({themeIndex:Pc,OQa:Cd}=Ud);return Ud})().returnValue?{index:Pc,row:Cd}:(w.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null)}launchEyedropper(Qa){E.EwaSettings.isChangeGateEnabled("OfficeVSO:8572137_Eyedropper_Conditional_Formatting")&&this.fm.launchEyedropper(null,null,Qa)}rUi(Qa){const Ob=[];for(let Cd=
0;Cd<Qa.length;Cd++){var Pc=Object(ac.a)(Ka.a,Qa[Cd]);const Ud={type:0};Ud.title=Pc.Title;const Wd=Object(ac.a)(sa.a,Pc.ControlList[0]);Wd?(Ud.type=1,Ud.colorSwatchProps=this.zHi(Wd),Ob.push(Ud)):(Pc=Object(ac.a)(nb.a,Pc.ControlList[0]))&&null!=this.lFf(Pc.Id)?(Ud.type=2,Ud.buttonProps={type:this.lFf(Pc.Id),label:Pc.LabelText},Ob.push(Ud)):w.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return Ob}zHi(Qa){const Ob=Qa.Colors;Qa={colors:Array(Qa.Colors.length),
notifyOnColorUsed:this.fm.CTg(Qa.ExternalId),isThemeColorSection:!!Qa.ExternalId&&Qa.ExternalId.includes(xc.l0g)};for(let Pc=0;Pc<Ob.length;Pc++)Qa.colors[Pc]={id:Ob[Pc].DisplayColor,color:Ob[Pc].DisplayColor,label:Ob[Pc].Alt,index:Pc};return Qa}lFf(Qa){switch(Qa){case xc.ndg:return 1;case xc.Aff:return 2;case xc.s$e:return 3;case xc.ISf:return 4;case xc.xGd:return 5}return null}}Object(t.a)(zb,"ColorPickerButtonController",null,[]);Object(W.b)(J.Ne,{Fk:"singleton"})(Qa=>Lo(function*(){const Ob=yield W.a.resolve(J.Nb,
Qa),Pc=yield W.a.resolve(J.Td,Qa),Cd=yield W.a.resolve(J.Dg,Qa);return new vb(Ob,Pc,Cd)}));class vb{constructor(Qa,Ob,Pc){this.Qy=this.ir=null;this.$=Qa;this.fm=Ob;this.DQh();this.CQh();this.Ow=Pc;this.Jrc=new xc(Qa,Ob,Pc)}DQh(){this.ir={};this.ir.style0=1535;this.ir.style1=1536;this.ir.style2=1537;this.ir.style3=1538;this.ir.style4=1539;this.ir.style5=1540;this.ir.style6=1541;this.ir.style7=1542;this.ir.style8=1543;this.ir.style9=1544;this.ir.style10=1545;this.ir.style11=1546;this.ir.style12=1547;
this.ir.style13=1548;this.ir.style14=1549;this.ir.style15=1550;this.ir.style16=1551;this.ir.style17=1552;this.ir.style18=1553;this.ir.style19=1554;this.ir.style20=1555;this.ir.style21=1556;this.ir.style22=1557;this.ir.style23=1558;this.ir.style24=1559;this.ir.style25=1560;this.ir.style26=1561;this.ir.style27=1562;this.ir.style28=1563;this.ir.style29=1564;this.ir.style30=1565;this.ir.style31=1566;this.ir.style32=1567;this.ir.style33=1568;this.ir.style34=1569;this.ir.style35=1570;this.ir.style36=1571;
this.ir.style37=1572;this.ir.style38=1573;this.ir.style39=1574;this.ir.style40=1575;this.ir.style41=1576}CQh(){this.Qy={};this.Qy.style0=1507;this.Qy.style1=1508;this.Qy.style2=1509;this.Qy.style3=1510;this.Qy.style4=1511;this.Qy.style5=1512;this.Qy.style6=1513;this.Qy.style7=1514;this.Qy.style8=1515;this.Qy.style9=1516;this.Qy.style10=1517;this.Qy.style11=1518;this.Qy.style12=1519;this.Qy.style13=1520;this.Qy.style14=1521;this.Qy.style15=1522;this.Qy.style16=1523;this.Qy.style17=1524;this.Qy.style18=
1525;this.Qy.style19=1526;this.Qy.style20=1527;this.Qy.style21=1528;this.Qy.style22=1529;this.Qy.style23=1530;this.Qy.style24=1531;this.Qy.style25=1532;this.Qy.style26=1533;this.Qy.style27=1534}mFf(Qa){return Db.i(this.Jrc.WIf(Qa,null,null,null,null,null,null))}nAc(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e,Ra){Ob=void 0===Ob?null:Ob;Pc=void 0===Pc?null:Pc;Cd=void 0===Cd?null:Cd;Ud=void 0===Ud?null:Ud;Wd=void 0===Wd?null:Wd;le=void 0===le?null:le;Fa=void 0===Fa?null:Fa;mb=void 0===mb?null:mb;e=void 0===e?!1:e;
Ra=void 0===Ra?null:Ra;return Object(Va.a)(new Jb.a,{MenuSectionList:this.Jrc.VIf(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e,Ra),UpdateDynamically:!0})}jMf(Qa,Ob,Pc,Cd,Ud){return this.Jrc.uXi(Qa,Ob,Pc,Cd,Ud)}AHi(Qa,Ob,Pc,Cd,Ud,Wd,le){return this.Jrc.WIf(Qa,void 0===Ob?null:Ob,void 0===Pc?null:Pc,void 0===Cd?null:Cd,void 0===Ud?null:Ud,void 0===Wd?null:Wd,void 0===le?null:le)}ROd(Qa,Ob){return(void 0===Ob?0:Ob)?this.Qy[Qa]:this.ir[Qa]}$4h(){return new zb(this.$,this,this.fm,this.Ow)}YU(Qa){var Ob;const Pc=null===
(Ob=this.$.shortcutKeyManager)||void 0===Ob?void 0:Ob.Pk(Qa);return Pc?Pc.substring(1,Pc.length-1):null}}Object(t.a)(vb,"PopulateDynamicHelper",null,[872]);var bb=a(41),La=a(1124);class pb{constructor(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e){this.m8e=Ob;this.r$e=void 0===Pc?null:Pc;this.zff=void 0===Ud?null:Ud;this.HSf=void 0===Wd?null:Wd;this.mdg=void 0===Fa?null:Fa;this.KB=Qa;this.Oyf=void 0===mb?null:mb;this.menuId=void 0===e?null:e}w$(){let Qa="";const Ob=this.KB.AHi(this.m8e,this.r$e,this.zff,this.HSf,
this.mdg,this.Oyf,this.menuId);for(const Pc of Ob)Qa+=Pc;return Qa}fM(){return this.KB.nAc(this.m8e,this.r$e,this.zff,this.HSf,void 0,void 0,void 0,this.mdg,this.Oyf,!1,this.menuId)}}Object(t.a)(pb,"RibbonColorPicker",null,[447]);var fa=a(670);class kb{constructor(Qa,Ob){this._id=Qa;this.WL=void 0===Ob?"":Ob}get id(){return this._id}get text(){return this.WL}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(Qa){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");
}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");}w$(){return`<Label id="${this._id}" LabelText="${this.WL}" />`}w2(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}F7b(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}u2(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");
}crc(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}Rua(){return Object(Va.a)(new fa.a,{Id:this.id,LabelText:this.text})}}Object(t.a)(kb,"RibbonLabel",null,[919,446,447]);class db{constructor(Qa){this.xph=[];this.id=Qa}get Mh(){return this.xph}w$(){return Db.q(this.fM())}fM(){const Qa=Object(Va.a)(new Jb.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const Ob of this.Mh)Object(ab.a)(pb,Ob)?Qa.MenuSectionList.push(...Object(ac.a)(pb,Ob).fM().MenuSectionList):
Qa.MenuSectionList.push(Ob.zpc());return Qa}}Object(t.a)(db,"RibbonMenu",null,[918,447]);class gb{constructor(){this.title=null;this.h9=[];this.Bz="Menu16";this.R0g=this.jWg=this.kWg=!0}get buttons(){return this.h9}w$(){return Db.r(this.zpc())}zpc(){const Qa=Object(Va.a)(new Ka.a,{ControlList:[]});if(1===this.buttons.length&&Object(ab.a)(917,this.buttons[0]))Qa.ControlList.push(this.buttons[0].ypc());else{let Pc="";for(let Cd=0;Cd<this.buttons.length;Cd++){var Ob=Object(ac.a)(446,this.buttons[Cd]);
Ob&&(Ob=Ob.Rua(),Qa.ControlList.push(Ob),Pc+=Ob.Id)}Qa.ControlsId=Pc+".Controls"}Qa.Title=this.title;Qa.DisplayMode=this.Bz;Qa.ShowMenuSectionTitleIcon=this.kWg;Qa.ShowMenuSectionTitleBackground=this.jWg;Qa.MenuSectionTitleFocusable=this.R0g;return Qa}}Object(t.a)(gb,"RibbonMenuSection",null,[376,447]);class Kb{constructor(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e,Ra,O,qa){qa=void 0===qa?null:qa;this.id=Qa;this.command=Pc;this.zvg=Cd;this.populateOnlyOnce=Ud;this.Y5a=Wd;this.P7j=le;this.alt=Fa;this.Dnc=mb;this.width=
e;this.QGh=Ra;this.autoComplete=O;this.XEa=new db(Ob);this.h9e=qa;Cd&&le&&(Qa=new gb,Qa.Bz="MenuLoading",Ob=new kb(Ob+"LoadingLabel"),Qa.buttons.push(Ob),this.menu.Mh.push(Qa))}w$(){return this.IOh()}get menu(){return this.XEa}IOh(){let Qa=Db.d(this.id,this.command,this.zvg,this.populateOnlyOnce,this.Y5a,this.P7j,this.alt,this.Dnc,this.width);const Ob=Qa.indexOf(" />");Qa=Qa.substring(0,Ob);Qa+=` ${"AllowDefaultContent"}="${this.QGh.toString()}"`;Qa+=` ${"AutoComplete"}="${this.autoComplete?"true":
"false"}"`;this.h9e&&(Qa+=` ${"ArrowImgId"}="${this.h9e}"`);Qa=Qa+">"+this.menu.w$();return Qa+"</ComboBox>"}}Object(t.a)(Kb,"RibbonComboBox",null,[920,447]);var ub=a(627),lb=a(1125);class Ba extends lb.a{constructor(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e,Ra,O,qa){O=void 0===O?null:O;qa=void 0===qa?null:qa;super(Qa,Ob,Pc,Ud,Wd,le,Fa,Ra,0);this.UCb=null;this.isa=0===mb?null:Ia.a.instance.ia(mb);this.dgd=e;this.lid=Cd;this.Nth=O;this.jv=qa}get description(){return this.isa}get QQb(){return this.UCb}get menuItemId(){return this.dgd}get Y5a(){return this.lid}get styles(){return this.Nth}get data(){return this.jv}w$(){return Db.n(this.Rua())}bpe(Qa){this.isa=
Qa}toString(){this.QQb||(this.UCb=this.w$());return this.QQb}Rua(){const Qa=new ub.a;this.myc(Qa);Qa.MenuItemId=this.menuItemId;Qa.QueryCommand=this.Y5a;Qa.Description=this.description;Qa.Styles=this.styles;Qa.Data=this.data;return Qa}}Object(t.a)(Ba,"RibbonComboBoxItem",lb.a,[377,446,447]);class ra extends lb.a{constructor(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb){super(Qa,Pc,Cd,Ud,Wd,le,Fa,!1,0);this.populateOnlyOnce=!1;this.BYb=this.menuCloseCommand=this.menuOpenCommand=this.VD=null;this.XEa=new db(Ob);this.VTf=
!0;this.jld=mb}get menu(){return this.XEa}w$(){return Db.o(this.Rua())}Rua(){const Qa=new yc.a;this.myc(Qa);Qa.PopulateOnlyOnce=this.populateOnlyOnce;Qa.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();Qa.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();Qa.PopulateQueryCommand=this.VD;Qa.KeyTip=this.BYb;Qa.Menu=this.menu.fM();Qa.ImageIsVisible=this.VTf;Qa.ExternalImageId=this.jld;return Qa}}Object(t.a)(ra,"RibbonFlyoutAnchor",lb.a,[378,
446,447]);var wb=a(1206),mc=a(669);class xb{constructor(){this.Wkb=[];this.id=null;this.width=0;this.title=this.cwa=null}w$(){return Db.p(this.ypc())}rD(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e,Ra){Cd=void 0===Cd?0:Cd;Ud=void 0===Ud?null:Ud;Wd=void 0===Wd?null:Wd;le=void 0===le?null:le;Fa=void 0===Fa?null:Fa;mb=void 0===mb?null:mb;e=void 0===e?null:e;Ra=(Ra=void 0===Ra?null:Ra)?Ia.a.instance.ia(Cd)+zc.HelperMethods.Mdf+Ra:Ia.a.instance.ia(Cd);this.HVf(this.Wkb.length,Qa,Ob,Pc,0===Cd?mb:Ra,Ud,Wd,le,Fa,e)}HVf(Qa,
Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e){Wd=void 0===Wd?null:Wd;le=void 0===le?null:le;Fa=void 0===Fa?null:Fa;mb=void 0===mb?null:mb;e=void 0===e?null:e;(Qa>this.Wkb.length||0>Qa)&&Error.argumentOutOfRange("Invalid Index");this.Wkb.splice(Qa,0,Object(Va.a)(new wb.a,{Id:Ob,Command:Pc.toString(),QueryCommand:null!==Cd&&void 0!==Cd?Cd:null,Alt:Ud,MenuItemId:Wd,Icon:le,Image:Fa?Pa.a.An(Fa):null,ImageClass:mb,LabelText:e}))}ypc(Qa){Qa=void 0===Qa?!1:Qa;let Ob=null,Pc=null;switch(this.cwa){case "Size120by20":Ob=this.WJb(120,
20,Qa);Pc=this.UJb(130,30,Qa);break;case "Size90by21":Ob=this.WJb(90,21,Qa);Pc=this.UJb(100,33,Qa);break;case "Size24by24With7Options":Ob=this.WJb(24,24,Qa);Pc=this.UJb(34,34,Qa);break;case "Size24by24":Ob=this.WJb(28,28,Qa);Pc=this.UJb(38,38,Qa);break;case "Size112by64":Ob=this.WJb(24,24,Qa),Pc=this.UJb(112,64,Qa)}for(Qa=0;Qa<this.Wkb.length;Qa++)this.Wkb[Qa].FullIconStyle=Ob;return Object(Va.a)(new mc.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.cwa,
GalleryItems:this.Wkb,GalleryStyle:Pc})}WJb(Qa,Ob,Pc){const Cd={},Ud={};Ud.width=Qa;Ud.height=Ob;Pc&&(Ud.alignSelf="center",Ud.marginBottom="4px");Cd.root=Ud;return Cd}UJb(Qa,Ob,Pc){const Cd={},Ud={},Wd={};Wd.width=Qa;Wd.height=Ob;Ud.root=Wd;Pc&&(Ud.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});Cd.galleryButtonInExpanded=Ud;return Cd}}Object(t.a)(xb,"RibbonGallery",null,[917,447]);var Ec=a(1265),ed=a(922),jd;let Xd=jd=class{constructor(Qa){this.KB=void 0===Qa?null:Qa}get ZBc(){return this.KB}qw(Qa){return new db(void 0===
Qa?null:Qa)}ji(){return new gb}jh(Qa){var Ob=bb.a.wj(jd.ugb,Qa.toString());if(Ob)return Ob;switch(Qa){case 249:return this.gi(Qa,"ContextMenu.Show.ChartTaskPane",1221897806,Ja.a.fxf,4,983);case 287:return this.gi(Qa,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.Np(Qa,"DataLabels.None.BoxWhisker",374300079,Ja.a.Owf,929,930,1600);case 0:return this.Np(Qa,"DataLabels.None.Column",374300079,Ja.a.Nwf,929,930,1600);case 1:return this.Np(Qa,
"DataLabels.None.Line",374300079,Ja.a.Pwf,929,930,1600);case 2:return this.Np(Qa,"DataLabels.None.Pie",374300079,Ja.a.Qwf,929,930,1600);case 3:return this.Np(Qa,"DataLabels.Show.Column",-1809877936,Ja.a.sxc,931,932,1601);case 143:return this.Np(Qa,"DataLabels.Show.Funnel",-1809877936,Ja.a.sxc,931,934,1601);case 144:return this.Np(Qa,"DataLabels.Show.Treemap",-1809877936,Ja.a.zFd,931,938,1601);case 145:return this.Np(Qa,"DataLabels.Show.Sunburst",-1809877936,Ja.a.yFd,931,934,1601);case 4:return this.Np(Qa,
"DataLabels.Center.Column",-1996266048,Ja.a.sxc,933,934,1602);case 5:return this.Np(Qa,"DataLabels.Center.Line",-1996266048,Ja.a.Iwf,933,934,1602);case 6:return this.Np(Qa,"DataLabels.Center.Pie",-1996266048,Ja.a.yFd,933,934,1602);case 7:return this.Np(Qa,"DataLabels.InsideEnd.Column",493396546,Ja.a.Jwf,935,936,1603);case 8:return this.Np(Qa,"DataLabels.InsideEnd.Pie",493396546,Ja.a.Kwf,935,936,1603);case 9:return this.Np(Qa,"DataLabels.InsideBase.Column",1599247052,Ja.a.zFd,937,938,1604);case 10:return this.Np(Qa,
"DataLabels.OutsideEnd.Column",342855531,Ja.a.Rwf,939,940,1605);case 11:return this.Np(Qa,"DataLabels.OutsideEnd.Pie",342855531,Ja.a.Swf,939,940,1605);case 140:return this.Np(Qa,"DataLabels.Left.BoxWhisker",-472675112,Ja.a.Mwf,941,942,1606);case 12:return this.Np(Qa,"DataLabels.Left.Line",-472675112,Ja.a.Lwf,941,942,1606);case 142:return this.Np(Qa,"DataLabels.Right.BoxWhisker",-1774499423,Ja.a.Uwf,943,944,1607);case 13:return this.Np(Qa,"DataLabels.Right.Line",-1774499423,Ja.a.Twf,943,944,1607);
case 138:return this.Np(Qa,"DataLabels.Above.BoxWhisker",-204160914,Ja.a.Ewf,945,946,1608);case 14:return this.Np(Qa,"DataLabels.Above.Line",-204160914,Ja.a.Vwf,945,946,1608);case 139:return this.Np(Qa,"DataLabels.Below.BoxWhisker",-87783054,Ja.a.Fwf,947,948,1609);case 15:return this.Np(Qa,"DataLabels.Below.Line",-87783054,Ja.a.Hwf,947,948,1609);case 16:return this.Np(Qa,"DataLabels.BestFit.Pie",1650379138,Ja.a.Gwf,949,950,1610);case 17:return this.Np(Qa,"Axes.Horizontal.None",895828731,Ja.a.twf,
929,951,1613);case 18:return this.Np(Qa,"Axes.Horizontal.ShowLTR",683614408,Ja.a.wFd,952,953,1614);case 19:return this.Np(Qa,"Axes.Horizontal.NoLabels",-1612014670,Ja.a.swf,956,957,1615);case 20:return this.Np(Qa,"Axes.Horizontal.ShowRTL",1259259728,Ja.a.uwf,958,959,1616);case 21:return this.Np(Qa,"Axes.Horizontal.Default",683614408,Ja.a.wFd,954,955,1617);case 22:return this.Np(Qa,"Axes.Horizontal.Thousands",-220179662,Ja.a.vwf,960,961,1618);case 23:return this.Np(Qa,"Axes.Horizontal.Millions",1534680966,
Ja.a.rwf,962,963,1619);case 24:return this.Np(Qa,"Axes.Horizontal.Billions",-238895611,Ja.a.pwf,964,965,1620);case 25:return this.Np(Qa,"Axes.Horizontal.LogScale",-892714755,Ja.a.qwf,966,967,1621);case 26:return this.Np(Qa,"Axes.Vertical.None",2006508979,Ja.a.Awf,929,951,1613);case 27:return this.Np(Qa,"Axes.Vertical.Default",252405382,Ja.a.Cwf,954,955,1617);case 28:return this.Np(Qa,"Axes.Vertical.Thousands",670842692,Ja.a.Dwf,960,961,1618);case 29:return this.Np(Qa,"Axes.Vertical.Millions",-572426128,
Ja.a.ywf,962,963,1619);case 30:return this.Np(Qa,"Axes.Vertical.Billions",-806496391,Ja.a.wwf,964,965,1620);case 31:return this.Np(Qa,"Axes.Vertical.LogScale",-1700998151,Ja.a.xwf,966,967,1621);case 32:return this.Np(Qa,"Axes.Vertical.NoLabels",2104548628,Ja.a.zwf,956,957,1615);case 33:return this.Np(Qa,"Axes.Vertical.ShowRTL",1717508862,Ja.a.Bwf,958,959,1616);case 34:return this.Np(Qa,"Gridlines.Horizontal.None",80515665,Ja.a.$wf,929,970,1624);case 35:return this.Np(Qa,"Gridlines.Horizontal.Major",
-306129902,Ja.a.Xwf,972,973,1625);case 36:return this.Np(Qa,"Gridlines.Horizontal.Minor",2147076534,Ja.a.Ywf,975,976,1626);case 37:return this.Np(Qa,"Gridlines.Horizontal.MajorMinor",-1253752845,Ja.a.Zwf,978,979,1627);case 38:return this.Np(Qa,"Gridlines.Vertical.None",1711257557,Ja.a.exf,929,971,1624);case 39:return this.Np(Qa,"Gridlines.Vertical.Major",-1772953364,Ja.a.bxf,972,974,1625);case 40:return this.Np(Qa,"Gridlines.Vertical.Minor",680253336,Ja.a.cxf,975,977,1626);case 41:return this.Np(Qa,
"Gridlines.Vertical.MajorMinor",-215161981,Ja.a.dxf,978,980,1627);case 135:return this.gi(Qa,"ContextMenu.NumberFormating",2105621672,Ja.a.lFd,1,476,135!==Qa,null,null,this.KB.YU(406));case 300:return this.gi(Qa,"ContextMenu.FormatCells",2055979337,null,1,477,300!==Qa,void 0,"PaintBrushandBucket_20",this.KB.YU(406));case 361:return this.gi(Qa,"ContextMenu.FormatCellsNumberFormatTaskPane",-395879625,null,1,477,361!==Qa,void 0,"PaintBrushandBucket_20",this.KB.YU(406));case 362:return this.gi(Qa,"ContextMenu.FontTaskPane",
456320978,null,1,477,362!==Qa,void 0,"PaintBrushandBucket_20",this.KB.YU(406));case 136:return this.gi(Qa,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,Ja.a.lFd,1,476,136!==Qa);case 42:return this.gi(Qa,"ContextMenu.Cut",-1985798686,Ja.a.Svf,1,12,!1,null,null,this.KB.YU(172));case 43:return this.gi(Qa,"ContextMenu.Copy",-911352779,Ja.a.lxc,1,11,!1,null,null,this.KB.YU(174));case 212:return this.gi(Qa,"ContextMenu.InsertCopiedCells",-160032004,Ja.a.xxc,3,15);case 213:return this.gi(Qa,
"ContextMenu.InsertCutCells",-1065525230,Ja.a.xxc,3,21);case 354:return this.gi(Qa,"ContextMenu.PasteValues",-185374993,Ja.a.gwf,8,1149,null,null,"PasteValues_20",this.KB.YU(178));case 355:return this.gi(Qa,"ContextMenu.PasteFormulas",1766348718,Ja.a.gwf,8,1150,null,null,"PasteFormulas_20");case 356:return this.gi(Qa,"ContextMenu.PasteFormatting",1804571062,Ja.a.tqi,3,1152,null,null,"PasteFormatting_20");case 357:return this.gi(Qa,"ContextMenu.PasteLink",42074747,Ja.a.wqi,3,1153,null,null,"PasteLink_20");
case 358:return this.gi(Qa,"ContextMenu.PasteWithColumnWidths",264209770,null,3,2299,null,null,"PasteWithColumnWidths_20");case 359:return this.gi(Qa,"ContextMenu.PasteTranspose",-958589048,Ja.a.yqi,3,1151,null,null,"PasteTranspose_20");case 44:case 57:return this.gi(Qa,"ContextMenu.Paste",237279923,Ja.a.qxc,1,13,44!==Qa,"Paste",null,this.KB.YU(176));case 248:return this.gi(Qa,"PasteAdvancedOptionsGallery",237279923,Ja.a.qxc,1,13,44!==Qa,"Paste");case 45:case 120:return this.gi(Qa,"ContextMenu.EditHyperlink",
-1583422759,Ja.a.uxc,8,1140,45!==Qa,"EditHyperlink");case 46:case 121:return this.gi(Qa,"ContextMenu.InsertHyperlink",-1583422759,Ja.a.uxc,8,1141,46!==Qa,"InsertHyperlink",null,this.KB.YU(156));case 47:case 122:return this.gi(Qa,"ContextMenu.RemoveHyperlink",-1253126584,Ja.a.GFd,8,1142,47!==Qa,"RemoveHyperlink");case 48:case 123:return this.gi(Qa,"ContextMenu.RemoveHyperlinks",-1253126584,Ja.a.GFd,8,1143,48!==Qa,"RemoveHyperlinks");case 250:return this.Jq(Qa,"ContextMenu.ContextMenuSmartLookup",-983891024,
1810);case 187:case 188:case 165:case 173:return this.gi(Qa,"ContextMenu.InsertCellsShiftRight",1035996630,Ja.a.awf,1,165===Qa||173===Qa?E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?18:341:E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?19:342,173===Qa||188===Qa,"InsertCellsShiftRight");case 166:case 174:return this.gi(Qa,"ContextMenu.InsertCellsShiftDown",1035996630,Ja.a.$vf,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?20:344,166!==Qa,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.gi(Qa,"ContextMenu.DeleteCellsShiftLeft",1035996630,Ja.a.Wvf,1,167===Qa||175===Qa?E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?19:342:E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?18:341,175===Qa||190===Qa,"DeleteCellsShiftLeft");case 168:case 176:return this.gi(Qa,"ContextMenu.DeleteCellsShiftUp",1035996630,
Ja.a.Xvf,1,343,168!==Qa,"DeleteCellsShiftUp");case 177:case 181:return this.gi(Qa,"ContextMenu.InsertRowsSheet",-1113896058,Ja.a.mFd,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)||E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?430:429,177!==Qa,"InsertRows");case 363:case 364:return this.gi(Qa,"ContextMenu.InsertRowsAfterSheet",75170472,null,1,2526,363!==Qa,"InsertRowsAfter");case 49:case 116:return this.gi(Qa,
"ContextMenu.InsertRows",-1113896058,Ja.a.mFd,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)||E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2420:346,49!==Qa,"InsertRows");case 365:case 366:return this.gi(Qa,"ContextMenu.InsertRowsAfter",75170472,null,1,2531,365!==Qa,"InsertRowsAfter");case 161:case 169:return this.gi(Qa,"ContextMenu.InsertRowsTable",942362098,Ja.a.cwf,1,421,161!==Qa,"InsertRowsTable");
case 50:case 117:return this.gi(Qa,"ContextMenu.InsertColumns",1415868706,Ja.a.pwa,1,406,50!==Qa,"InsertColumns");case 336:case 337:return this.gi(Qa,"ContextMenu.InsertColumnsToTheLeft",1415868706,Ja.a.pwa,1,407,336!==Qa,"InsertColumns");case 369:case 370:return this.gi(Qa,"ContextMenu.InsertColumnsToTheLeft",-612877076,Ja.a.pwa,1,407,369!==Qa,"InsertColumns");case 288:case 289:return this.gi(Qa,"ContextMenu.contextMenuInsertColumnsToTheRight",1415868706,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?null:Ja.a.pwa,1,408,288!==Qa,"InsertColumns");case 367:case 368:return this.gi(Qa,"ContextMenu.contextMenuInsertColumnsAfterToTheRight",-612877076,null,1,408,367!==Qa,"InsertColumnsAfter");case 178:case 182:return this.gi(Qa,"ContextMenu.InsertColumnsSheet",1415868706,Ja.a.pwa,1,426,178!==Qa,"InsertColumns");case 334:case 335:return this.gi(Qa,"ContextMenu.InsertColumnsSheetToTheLeft",1415868706,Ja.a.pwa,1,427,334!==Qa,"InsertColumns");case 371:case 372:return this.gi(Qa,"ContextMenu.InsertColumnsAfterSheetToTheLeft",
-612877076,Ja.a.pwa,1,427,371!==Qa,"InsertColumnsAfter");case 290:case 291:return this.gi(Qa,"ContextMenu.InsertColumnsSheet",1415868706,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?null:Ja.a.pwa,1,428,290!==Qa,"InsertColumns");case 373:case 374:return this.gi(Qa,"ContextMenu.InsertColumnsAfterSheetToTheRight",-612877076,null,1,428,373!==Qa,"InsertColumnsAfter");case 191:case 192:case 162:case 170:return this.gi(Qa,"ContextMenu.InsertColumnsTable",
622604322,Ja.a.bwf,1,162===Qa||170===Qa?419:420,170===Qa||192===Qa,"InsertColumnsTable");case 179:case 183:return this.gi(Qa,"ContextMenu.DeleteRowsSheet",1554436520,Ja.a.oxc,1,429,179!==Qa,"DeleteRows");case 51:case 118:return this.gi(Qa,"ContextMenu.DeleteRows",1554436520,Ja.a.oxc,1,410,51!==Qa,"DeleteRows");case 163:case 171:return this.gi(Qa,"ContextMenu.DeleteRowsTable",1405456548,Ja.a.oxc,1,418,163!==Qa,"DeleteRowsTable");case 180:case 184:return this.gi(Qa,"ContextMenu.DeleteColumnsSheet",
674605324,Ja.a.nxc,1,426,180!==Qa,"DeleteColumns");case 52:case 119:return this.gi(Qa,"ContextMenu.DeleteColumns",674605324,Ja.a.nxc,1,411,52!==Qa,"DeleteColumns");case 164:case 172:return this.gi(Qa,"ContextMenu.DeleteColumnsTable",284490184,Ja.a.nxc,1,417,164!==Qa,"DeleteColumnsTable");case 53:case 124:return this.Jq(Qa,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==Qa,"OpenHyperlink",this.KB.YU(101));case 263:return this.gi(Qa,"SheetOpsContextMenu.ShowChanges",1834994092,Ja.a.HFd,8,443,void 0,
Ya.a.EOk);case 264:return this.gi(Qa,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.gi(Qa,"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.gi(Qa,"GridContextMenu.ShowChanges",1834994092,Ja.a.HFd,8,443,void 0,Ya.a.qUg);case 54:return this.gi(Qa,"ContextMenu.InsertSheet",-1935155518,Ja.a.nFd,1,514);case 360:return this.gi(Qa,"ContextMenu.AppendSheet",-546331179,Ja.a.nFd,1,
514);case 56:case 127:return this.gi(Qa,"ContextMenu.DeleteSheet",1880294140,Ja.a.Yvf,1,515,56!==Qa,"DeleteSheet");case 55:return this.Jq(Qa,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.Jq(Qa,"ContextMenu.ReorderSheet",-383100692,517,125!==Qa,"ReorderSheet");case 158:return this.Jq(Qa,"ContextMenu.DuplicateSheet",-1254662242,441);case 338:case 339:return Ob=338!==Qa,this.gi(Qa,Ob?"ContextMenu.FullSheetCopyDisabled":"ContextMenu.FullSheetCopy",-207190267,Ja.a.lxc,1,2431,Ob,
null);case 340:case 341:return Ob=340!==Qa,this.gi(Qa,Ob?"ContextMenu.FullSheetPasteDisabled":"ContextMenu.FullSheetPaste",440556491,Ja.a.qxc,1,2430,Ob,null);case 112:case 114:return this.Jq(Qa,"ContextMenu.HideSheet",1458540255,519,112!==Qa,"HideSheet");case 113:case 115:return this.Jq(Qa,"ContextMenu.UnhideSheet",1129633328,520,113!==Qa,"UnhideSheet");case 277:return this.gi(Qa,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.gi(Qa,"ContextMenu.PauseProtection",
-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.gi(Qa,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.Jq(Qa,"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.gi(Qa,"ContextMenu.PivotExpand",-1687560254,Ja.a.rFd,9,1168);case 244:return this.gi(Qa,"ContextMenu.PivotCollapse",1176256599,Ja.a.qFd,9,1169);case 245:return this.gi(Qa,"ContextMenu.PivotExpandEntireField",-1751201991,Ja.a.rFd,9,1170);
case 246:return this.gi(Qa,"ContextMenu.PivotCollapseEntireField",-232434744,Ja.a.qFd,9,1171);case 247:return this.gi(Qa,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");case 301:return this.gi(Qa,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,ed.a.w6j);case 306:return this.gi(Qa,"ContextMenu.ManualUngroup",-1683649734,null,17,2347,void 0,void 0);case 307:return this.gi(Qa,"ContextMenu.ManualGroup",660506187,null,17,2346,void 0,void 0);
case 59:return this.gi(Qa,"ContextMenu.PivotFieldListShow",2140436015,Ja.a.sFd,9,1173);case 58:return this.gi(Qa,"ContextMenu.PivotFieldListHide",-1006032470,Ja.a.sFd,9,1174);case 258:return this.gi(Qa,"ContextMenu.PivotSettingsPaneShow",1529441790,Ja.a.uPb,17,636);case 257:return this.gi(Qa,"ContextMenu.PivotSettingsPaneHide",1529441790,Ja.a.uPb,17,637);case 259:return this.Jq(Qa,"ContextMenu.PivotTableNoSubtotal",-2016405815,638);case 260:return this.Jq(Qa,"ContextMenu.PivotTableSubtotalOnTop",
671485366,639);case 261:return this.Jq(Qa,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return Ob=60!==Qa,this.Jq(Qa,Ob?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,Ob,null);case 61:case 65:return Ob=61!==Qa,this.Jq(Qa,Ob?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,Ob,null);case 62:case 66:return Ob=62!==Qa,this.Jq(Qa,Ob?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",
389774337,1091,Ob,null);case 63:case 67:return Ob=63!==Qa,this.Jq(Qa,Ob?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",2033235475,1092,Ob,null);case 68:case 72:return Ob=68!==Qa,this.gi(Qa,Ob?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,Ja.a.ixc,9,1093,Ob,null);case 69:case 73:return Ob=69!==Qa,this.gi(Qa,Ob?"ContextMenu.FieldWellMoveToRowLabelsDisabled":"ContextMenu.FieldWellMoveToRowLabels",74086617,Ja.a.Ujb,9,1094,
Ob,null);case 70:case 74:return Ob=70!==Qa,this.gi(Qa,Ob?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",1529312473,Ja.a.Tjb,9,1095,Ob,null);case 71:case 75:return Ob=71!==Qa,this.gi(Qa,Ob?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,Ja.a.jxc,9,1098,Ob,null);case 76:return this.gi(Qa,"ContextMenu.FieldWellRemoveField",-1092351914,Ja.a.Uvf,9,1099);case 77:return this.gi(Qa,"ContextMenu.FieldWellValueFieldSettings",
-2141589616,Ja.a.owf,9,1100);case 79:case 83:return this.gi(Qa,"ContextMenu.FieldListMoveToReportFilter",359279088,Ja.a.ixc,9,1082,79!==Qa,null);case 80:case 84:return this.gi(Qa,"ContextMenu.FieldListMoveToRowLabels",-67292059,Ja.a.Ujb,9,1083,80!==Qa,null);case 81:case 85:return this.gi(Qa,"ContextMenu.FieldListMoveToColumnsLabels",745182485,Ja.a.Tjb,9,1084,81!==Qa,null);case 82:case 86:return this.gi(Qa,"ContextMenu.FieldListMoveToValues",926905850,Ja.a.jxc,9,1087,82!==Qa,null);case 95:case 97:return Ob=
95!==Qa,this.gi(Qa,Ob?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,Ja.a.Ujb,9,1096,Ob,null);case 96:case 98:return Ob=96!==Qa,this.gi(Qa,Ob?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,Ja.a.Tjb,9,1097,Ob,null);case 78:return this.gi(Qa,"ContextMenu.FieldListAddAsSlicer",547535945,Ja.a.iFd,9,1088);case 332:case 333:return this.gi(Qa,"ContextMenu.FieldListAddAsTimeline",-2108836646,
null,9,2393,333===Qa,void 0,"TimeSlicerInsert_20");case 91:case 93:return this.gi(Qa,"ContextMenu.FieldListMoveToRowChartLabels",-67292059,Ja.a.Ujb,9,1085,91!==Qa,null);case 92:case 94:return this.gi(Qa,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,Ja.a.Tjb,9,1086,92!==Qa,null);case 99:return this.gi(Qa,"ContextMenu.BIExploreShowCallout",1529658657,Ja.a.kxc,9,1193);case 100:return this.gi(Qa,"ContextMenu.ContextMenuRefresh",2054778433,Ja.a.jwf,9,1181);case 102:return this.gi(Qa,"ContextMenu.EditCell",
324156914,Ja.a.FFd,8,579);case 101:return this.gi(Qa,"Contextenu.DeleteChart",2045211913,Ja.a.txc,8,578);case 308:return this.gi(Qa,"Contextmenu.DeleteChartElement",2045211913,Ja.a.txc,8,2358);case 321:return this.Jq(Qa,"Contextmenu.AddDataLabels",1849330294,2359,!1);case 350:return this.Jq(Qa,"Contextmenu.AddErrorBarX",-873142594,2367,!1);case 351:return this.Jq(Qa,"Contextmenu.AddErrorBarY",1855740761,2367,!1);case 352:return this.Jq(Qa,"Contextmenu.AddErrorBarHz",-873142594,2438,!1);case 353:return this.Jq(Qa,
"Contextmenu.AddErrorBarVt",1855740761,2440,!1);case 322:return this.Jq(Qa,"Contextmenu.AddTrendline",2117491830,2363,!1);case 323:return this.Jq(Qa,"Contextmenu.AddTrendlineTitle",2107851680,2365,!1);case 324:return this.Jq(Qa,"Contextmenu.AddAxisTitle",-1986737526,2386,!1);case 325:return this.Jq(Qa,"Contextmenu.AddMajorGridlines",119706583,2370,!1);case 326:return this.Jq(Qa,"Contextmenu.AddMinorGridlines",-1741941813,2372,!1);case 342:return this.Jq(Qa,"Contextmenu.EditTextChartTitle",419803868,
818,!1);case 343:return this.Jq(Qa,"Contextmenu.EditTextAxisTitleHorizontal",-2011789595,818,!1);case 344:return this.Jq(Qa,"Contextmenu.EditTextAxisTitleVertical",-1513952223,818,!1);case 146:return this.gi(Qa,"Contextenu.AltText",1804967129,Ja.a.DFd,8,817);case 302:return this.gi(Qa,"ContextMenu.CellImageAltText",1516436924,Ja.a.DFd,8,817);case 147:return this.gi(Qa,"ContextMenu.EditShapeText",-445658892,Ja.a.oxf,8,818);case 186:return this.gi(Qa,"ContextMenu.ExitEditShapeText",1166778132,null,
8,819);case 281:return this.gi(Qa,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",ed.a.bringForward);case 282:return this.gi(Qa,"ContextMenu.BringToFront",-1480025782,null,8,822,!1,"ContextMenu.BringToFront",ed.a.bringToFront);case 283:return this.gi(Qa,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",ed.a.sendBackward);case 284:return this.gi(Qa,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",ed.a.sendToBack);
case 273:return this.gi(Qa,"ContextMenu.OfficeScriptsViewScript",-585097204,Ja.a.Nvf,8,2151);case 160:return this.gi(Qa,"ContextMenu.InsertComment",-1667294294,Ja.a.qxf,8,1146,!1,null,null,this.KB.YU(351));case 221:return this.gi(Qa,"ContextMenu.DeleteComment",467845448,Ja.a.nxf,8,1162);case 159:return this.gi(Qa,"ContextMenu.InsertReply",-1667294294,Ja.a.rxf,8,1145);case 226:return this.gi(Qa,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20",this.KB.YU(348));case 227:return this.gi(Qa,
"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.gi(Qa,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.gi(Qa,"ContextMenu.ShowOrHideNote",1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.Jq(Qa,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.J4(Qa,"Form.InsertForm",1305810481,Ja.a.pFd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.J4(Qa,"Form.ViewForm",
330035228,Ja.a.pFd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.J4(Qa,"Form.EditForm",1305810481,Ja.a.Zvf,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.J4(Qa,"Form.DeleteForm",-509039657,Ja.a.Vvf,1,"Image16by16",1270,0,null,!1,1598);case 106:return this.J4(Qa,"Form.ShareForm",1334518759,Ja.a.kwf,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Qa,"ContextMenu.ClearContent",
-848953656,Ja.a.eqi,1,445,148!==Qa,null,"Clear_20"):this.Jq(Qa,"ContextMenu.ClearContent",-848953656,445,148!==Qa);case 150:case 151:return this.gi(Qa,"ContextMenu.RowHeight",2040891415,Ja.a.sxf,8,434,151===Qa);case 152:case 153:return this.gi(Qa,"ContextMenu.ColumnWidth",957527587,Ja.a.mxf,8,433,153===Qa);case 108:case 154:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Qa,"ContextMenu.HideRows",1051390410,null,1,432,154===Qa,null,
"RowHideTouch_20"):this.Jq(Qa,"ContextMenu.HideRows",1051390410,432,154===Qa);case 110:case 156:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Qa,"ContextMenu.UnhideRows",1542466017,null,1,439,156===Qa,null,"RowUnhideTouch_20"):this.Jq(Qa,"ContextMenu.UnhideRows",1542466017,439,156===Qa);case 109:case 155:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Qa,"ContextMenu.HideColumns",
-706918724,null,1,438,155===Qa,null,"ColumnHideTouch_20"):this.Jq(Qa,"ContextMenu.HideColumns",-706918724,438,155===Qa);case 111:case 157:return E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?this.gi(Qa,"ContextMenu.UnhideColumns",369708605,null,1,440,157===Qa,null,"ColumnUnhideTouch_20"):this.Jq(Qa,"ContextMenu.UnhideColumns",369708605,440,157===Qa);case 216:return this.Jq(Qa,"ContextMenu.ShowCard",-843616717,1786,216!==Qa);case 217:return this.Jq(Qa,
"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.gi(Qa,"ContextMenu.PlaceInCell",-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.gi(Qa,"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.gi(Qa,"ContextMenu.CreateReference",1983877126,null,8,2302,void 0,void 0,"PictureLinked_20");case 215:case 268:return this.Jq(Qa,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===Qa);case 218:case 269:return this.Jq(Qa,
"ContextMenu.RefreshLinkedEntities",439914789,1788,269===Qa);case 220:case 271:return this.Jq(Qa,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===Qa);case 219:case 270:return this.Jq(Qa,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===Qa);case 234:return this.gi(Qa,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.gi(Qa,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.gi(Qa,
"ContextMenu.FilterByValue",1803952894,null,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2522:222);case 313:return this.gi(Qa,"ContextMenu.FilterByCellColor",486423932,null,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2523:2375);case 314:return this.gi(Qa,"ContextMenu.FilterByCellFontColor",-652157481,null,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?2524:2376);case 315:return this.gi(Qa,"ContextMenu.FilterByCellIcon",-1656122924,null,1,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2525:2377);case 223:return this.gi(Qa,"ContextMenu.SortAscending",-1010737776,Ja.a.mwf,1,228);case 292:return this.Jq(Qa,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2518:230);case 293:return this.Jq(Qa,"ContextMenu.PutSelectedFontColorOnTop",
-764711886,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2519:231);case 294:return this.Jq(Qa,"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2520:232);case 224:return this.gi(Qa,"ContextMenu.SortDescending",2123420468,Ja.a.nwf,1,229);case 225:return this.gi(Qa,"ContextMenu.SortCustom",-207540907,Ja.a.rxc,1,233);case 232:return this.gi(Qa,
"ContextMenu.ConvertToRange",323142015,Ja.a.Rvf,1,740);case 272:return this.gi(Qa,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,Ja.a.FFd,8,661);case 239:return this.gi(Qa,"ContextMenu.IgnoreError",886009118,Ja.a.EFd,8,2112,239!==Qa);case 240:return this.gi(Qa,"ContextMenu.IgnoreErrors",886009118,Ja.a.EFd,8,2113,240!==Qa);case 241:return this.Jq(Qa,"ContextMenu.ShowError",-1779556985,2114,241!==Qa);case 251:return this.gi(Qa,"ContextMenu.SlicerRefresh",-231711729,Ja.a.iwf,0,2177,251!==Qa);case 252:return this.gi(Qa,
"ContextMenu.SlicerClearFilter",-1909381757,Ja.a.jFd,0,2178,252!==Qa);case 375:return this.gi(Qa,"ContextMenu.AutoToggleFilter",368460465,null,1,2538,375!==Qa,null,"Filter_20");case 376:return this.gi(Qa,"ContextMenu.RemoveAutoToggleFilter",368460465,null,1,2533,void 0,void 0,"DeleteFilter_20");case 345:return this.gi(Qa,"ContextMenu.TimeSlicerClearFilter",-741340954,Ja.a.jFd,0,2178,345!==Qa);case 254:return this.Jq(Qa,"ContextMenu.SlicerDelete",2045211913,2181,254!==Qa);case 253:return this.gi(Qa,
"ContextMenu.SlicerMultiSelect",2108047455,Ja.a.oFd,0,2180,253!==Qa);case 255:return this.gi(Qa,"ContextMenu.SlicerSortAscending",-923375148,Ja.a.vxc,8,2183,255!==Qa);case 256:return this.gi(Qa,"ContextMenu.SlicerSortDescending",1164937340,Ja.a.wxc,8,2182,256!==Qa);case 267:return this.gi(Qa,"ContextMenu.SlicerSettingsPaneShow",522377926,Ja.a.uPb,17,636);case 266:return this.gi(Qa,"ContextMenu.SlicerSettingsPaneHide",522377926,Ja.a.uPb,17,637);case 128:return this.EHa(Qa,-619033944,1,1438);case 129:return this.EHa(Qa,
-619033944,2,1440);case 130:return this.EHa(Qa,-619033944,3,1442);case 131:return this.EHa(Qa,-619033944,4,1443);case 132:return this.sfa(Qa,-1736601456,7,1447);case 133:return this.sfa(Qa,-1736601456,8,1449);case 134:return this.sfa(Qa,-1736601456,0,1450);case 196:return this.EHa(Qa,-2136556471,1,1438);case 198:return this.EHa(Qa,-2136556471,2,1440);case 200:return this.EHa(Qa,-2136556471,3,1442);case 201:return this.EHa(Qa,-2136556471,4,1443);case 204:return this.sfa(Qa,1201641489,0,1447);case 205:return this.sfa(Qa,
1201641489,1,1448);case 206:return this.sfa(Qa,1201641489,7,1449);case 207:return this.sfa(Qa,1201641489,2,1450);case 208:return this.sfa(Qa,1201641489,4,1451);case 209:return this.sfa(Qa,1201641489,3,1452);case 210:return this.sfa(Qa,1201641489,5,1453);case 211:return this.sfa(Qa,1201641489,6,1454);case 274:return this.gi(Qa,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,Ib.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":
"ShareSectionEntry_20");case 275:return this.gi(Qa,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,Ib.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 276:return this.gi(Qa,"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,Ib.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 317:return this.gi(Qa,
"ContextMenu.ShareNamedSheetView",-1592351768,null,1,2382,void 0,void 0,Ib.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 319:return this.gi(Qa,"ContextMenu.ExitNamedSheetView",1690118309,null,3,2381,void 0,void 0,"ExitSheetView_20");case 299:return this.gi(Qa,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,Ib.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?
"LinkToSection_20":"ShareSectionEntry_20");case 312:return this.gi(Qa,"ContextMenu.ShareSheet",783415632,null,1,2374,void 0,void 0,Ib.a.isFluentIconsEnabled()&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 309:return this.gi(Qa,"ContextMenu.FlyoutShareSheet",783415632,null,1,2355,void 0,void 0);case 310:return this.gi(Qa,"ContextMenu.FlyoutShareRange",-1099009678,null,1,2356,void 0,void 0);case 311:return this.gi(Qa,"ContextMenu.FlyoutShareTable",
192430811,null,1,2357,void 0,void 0);case 285:return this.gi(Qa,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.gi(Qa,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20");case 330:return this.gi(Qa,"ContextMenu.CopyHyperlink",-1257360929,Ja.a.lxc,1,2410,330!==Qa);case 331:return this.gi(Qa,"ContextMenu.ShowLinkPreview",1915212877,null,1,2411,331!==Qa)}return null}J4(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e,Ra,O,qa){Ob=
new La.RibbonButtonObject(Ob,le,Pc,null,Ud,Cd,Wd,le,Fa,mb,e,Ra,!0,void 0===O?null:O,void 0===qa?null:qa);return jd.ugb[Qa.toString()]=Ob}gi(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e){mb=void 0===mb?null:mb;return this.J4(Qa,Ob,Pc,mb?null:Cd,Ud,"Image16by16",Wd,0,void 0===Fa?null:Fa,void 0===le?!1:le,0,mb,void 0===e?null:e)}PMb(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e){return new Ba(Qa,Wd,Ob,null,Cd,Pc,Ud,Wd,le,Fa,!1,void 0===mb?null:mb,void 0===e?null:e)}qlf(Qa,Ob){return new kb(Qa,void 0===Ob?"":Ob)}a4h(Qa,Ob,Pc,Cd){return new Ec.RibbonToggleButton(Qa,
0,Ob,null,8,null,"None",0,0,null,!1,0,Pc,Cd)}UXa(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa,mb){Fa=void 0===Fa?null:Fa;mb=void 0===mb?!1:mb;let e=bb.a.wj(jd.ugb,Qa);if(e)return e;e=new La.RibbonButtonObject(Qa,0,Pc,null,3,null,"None",0,0,Wd,le,0);e.u2(Ob);e.label=Ob;e.bpe(mb?null:Ob);e.F7b(Ud,Cd,Fa);return jd.ugb[Qa]=e}aie(Qa){this.eVd(Qa)&&delete jd.ugb[Qa]}eVd(Qa){return Qa in jd.ugb}xz(Qa,Ob,Pc,Cd){Qa=new ra(Qa,Ob,0,Cd,3,null,"None",0);Qa.u2(Pc);Qa.label=Pc;return Qa}yma(Qa,Ob,Pc,Cd,Ud,Wd,le){Qa=new ra(Qa,Ob,0,Cd,
Ud,le?null:Wd,"Image16by16",0,le);Qa.u2(Pc);Qa.label=Pc;return Qa}uMb(Qa,Ob,Pc,Cd,Ud,Wd){return new pb(this.KB,Qa,null,null,void 0===Ob?null:Ob,null,void 0===Pc?null:Pc,void 0===Cd?null:Cd,void 0===Ud?null:Ud,void 0===Wd?null:Wd)}wM(Qa,Ob,Pc,Cd){Pc=void 0===Pc?null:Pc;Cd=void 0===Cd?null:Cd;return Object(Va.a)(new xb,{id:Qa,width:Ob,cwa:Pc,title:Cd})}Np(Qa,Ob,Pc,Cd,Ud,Wd,le){return this.J4(Qa,Ob,Pc,Cd,4,"Image32by32",Ud,Wd,null,!1,le)}Jq(Qa,Ob,Pc,Cd,Ud,Wd,le){return this.J4(Qa,Ob,Pc,null,1,"None",
Cd,0,void 0===Wd?null:Wd,void 0===Ud?!1:Ud,0,null,void 0===le?null:le)}dkf(Qa,Ob,Pc,Cd,Ud,Wd){return this.J4(Qa,Ob,Pc,Cd,4,"Image16by16",Ud,0,Wd.toString(),!1,0)}sfa(Qa,Ob,Pc,Cd){return this.dkf(Qa,"OutlineDashStylePresent,"+Pc,Ob,Ja.a.mxc,Cd,Pc)}EHa(Qa,Ob,Pc,Cd){return this.dkf(Qa,"OutlineWidthPresent,"+Pc,Ob,Ja.a.pxc,Cd,Pc)}};Xd.ugb={};Xd=jd=Object(n.__decorate)([Object(W.d)(J.uf),Object(n.__param)(0,Object(J.Ne)()),Object(n.__param)(1,Object(J.cb)())],Xd);Object(t.a)(Xd,"RibbonControlsManager",
null,[869]);var Td=a(211);let gc=class{constructor(Qa){this.vii=Qa.zJk}Ri(){return!1}executeCommand(Qa,Ob){Qa=Ob.command;Ob=null;switch(Qa){case 1243860697:this.vii.i0k();break;default:Ob=Td.a(Qa)}return Ob||F.Task.Ua(!0)}Gi(Qa,Ob){return 1243860697===Ob.command}dj(){return!1}};gc=Object(n.__decorate)([Object(W.d)(J.Rf),Object(n.__param)(0,Object(J.Yf)()),Object(n.__param)(1,Object(J.gf)())],gc);Object(t.a)(gc,"SheetDropdownMenuCommandHandler",null,[34]);var nc=a(428),dc=a(87),Gc=a(77),vd=a(327),
zd=a(17),Yb=a(406),Pb=a(94),$c=a(53),wd=a(306),Bd=a(193),tc=a(158),Zc=a(59),Ab=a(198);class rb{constructor(){this.Ypf=new bb.a(!0);this.L$c=0}get kCd(){return this.L$c}get navigationButtonsDisabled(){return!!(this.kCd&1)}get operationButtonsDisabled(){return!!(this.kCd&2)}AIh(Qa,Ob){this.Ypf.add(Qa,Ob);this.P2()}P2(){this.L$c=0;bb.a.forEach(this.Ypf.CB,Qa=>{this.L$c=this.kCd|Qa.value})}}Object(t.a)(rb,"SheetTabBarDisabledStateManager",null,[]);var Fb=a(265),jc=a(29),Oc=a(977),cd=a(305),Ed=a(93),Sd=
a(283),$d=a(54),be=a(329),Fe=a(16),Pe=a(69),hc=a(243),Lb=a(118),kc=a(176),dd=a(431),yb=a(423),Ta=a(44),Hb=a(290),uc=a(98);class Sc extends Fb.a{constructor(Qa,Ob,Pc){Pc=void 0===Pc?!1:Pc;super(Qa);this.u3b=this.GWa=null;this.$=Ob;this.JQb=this.q9=Pc}get disabled(){return this.q9}dispose(){this.u3b=this.GWa=this.$=null;super.dispose()}J2(Qa){this.q9=Qa;this.domElement.setAttribute(Ya.a.dWa,Qa.toString());Fe.DOMElementExtensions.toggleCssClass(this.domElement,Oc.a.NHa,Qa)}X1c(Qa){this.JQb=Qa}zRa(Qa,
Ob){return this.disabled?!1:this.JQb&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")?(Ta.a(this.$).fL(Qa,Ob),!1):!0}}Object(t.a)(Sc,"SheetBarButton",Fb.a,[]);var bc=a(941),vc=a(171),Xc=a(152),ad=a(635);class Id extends Sc{constructor(Qa,Ob,Pc,Cd){Cd=void 0===Cd?!1:Cd;super(document.createElement("a"),Ob,Cd);this.vj=Ud=>{var Wd;if(!this.zRa(Xc.a.sheetTabBar,vc.a.LJk))return!0;null===(Wd=W.a.nh(J.Sg))||void 0===Wd?void 0:Wd.Bxa(bc.a.insertSheet);this.$.si(-1935155518,
Ud.Dh,30,null);return!0};this.Cn=()=>{this.J2(!0)};this.Rl=()=>{Aa.f(this.$).cellTextEditBox.isEditing||this.J2(!1)};this.GWa=Pc.jh(this.domElement,Ia.a.instance.ia(509),0,Id.HWa,Ia.a.instance.ia(510),ed.a.Dxd,Cd);Qa.appendChild(this.domElement);this.oj.Ba("contextmenu",Ud=>{Pe.g(Ud)});Hb.a.instance.xa(zd.a.click,this.domElement,this.vj);this.X2a=tc.a.instance.e2(this.domElement,this.vj,uc.a.yu,uc.a.dDa);Aa.f(this.$).cellTextEditBox.Iv(this.Cn);Aa.f(this.$).cellTextEditBox.uX(this.Rl)}dispose(){Hb.a.instance.Qa(zd.a.click,
this.domElement,this.vj);tc.a.instance.N2(this.domElement,this.X2a);Aa.f(this.$)&&Aa.f(this.$).cellTextEditBox&&(Aa.f(this.$).cellTextEditBox.Cv(this.Cn),Aa.f(this.$).cellTextEditBox.i2(this.Rl));super.dispose()}J2(Qa){const Ob=Id.USg(this.$);super.J2(Qa||Ob)}static USg(Qa){return ad.a.Dre(Qa)}}Id.HWa=Ja.a.hFd;Object(t.a)(Id,"InsertSheetButton",Sc,[]);class ue extends Sc{constructor(Qa,Ob,Pc){super(document.createElement("a"),Ob);this.vj=Cd=>{if(!this.zRa(Xc.a.sheetTabBar,vc.a.MJk))return!0;this.$.si(-684145703,
Cd.Dh,0,null);return!0};this.nng=Cd=>{zc.HelperMethods.Y_k(this.Cbf,ue.HWa,ue.HWa+Ya.a.fTf,("mouseover"===Cd.type||"focus"===Cd.type)&&!Aa.f(this.$).inRangePicker)};this.$=Ob;this.Cbf=Pc.jh(this.domElement,Ia.a.instance.ia(511),0,ue.HWa,Ia.a.instance.ia(512),ed.a.Dxd);Qa.appendChild(this.domElement);this.oj.Ba("contextmenu",Cd=>{Pe.g(Cd)});this.oj.Ba("mouseover",this.nng);this.oj.Ba("mouseout",this.nng);Hb.a.instance.xa(zd.a.click,this.domElement,this.vj);this.X2a=tc.a.instance.e2(this.domElement,
this.vj,uc.a.yu,uc.a.dDa)}dispose(){Hb.a.instance.Qa(zd.a.click,this.domElement,this.vj);tc.a.instance.N2(this.domElement,this.X2a);this.Cbf=null;super.dispose()}}ue.HWa=Ja.a.hFd;Object(t.a)(ue,"InsertTemplateButton",Sc,[]);class Vd{constructor(Qa,Ob){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Qa;this.newSheetIndex=Ob}getSheetName(){return this.sheetName}}Object(t.a)(Vd,"MacroRecorderSheetReorderedPayload",null,[60]);class Kd extends Fb.a{constructor(Qa,Ob){super(document.createElement("div"));
this.R1=()=>{w.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.xGg(!1,"OnSheetsChanged")};this.fRj=()=>{this.Hp()};this.eRj=()=>{this.to()};this.$=Qa;this.jYk=Ob;this.s5=!1;this.$$b=0}dispose(){this.to();super.dispose()}i0k(){this.xGg(!0,"TogglerSheetDropdownMenu")}xGg(Qa,Ob){w.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${Ob}, toggle: ${Qa}, toggleStateId: ${this.$$b}`);Qa&&(this.$$b+=1);const Pc=this.$.Eh.Li("UserAction",
`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${Ob}, toggle: ${Qa}, toggleStateId: ${this.$$b}, sheetCount: ${this.$.sa.count}`);Qa=this.W9h();appChrome.renderSheetDropdownMenu(this.domElement,this.jYk,Qa,this.$$b,this.fRj,this.eRj,()=>{Pc.stop()},dd.a(this.$))}W9h(){const Qa=this.$.sa,Ob=[];for(let Cd=0;Cd<Qa.count;Cd++){var Pc=Object(ac.a)(Lb.a,Qa.getItem(Cd));0===Pc.zJ&&(Pc=this.V9h(Pc),Ob.push(Pc))}return Ob}V9h(Qa){const Ob={};Ob.key=Qa.name;Ob.text=Qa.name;Ob.onClick=this.X9h(Qa);Qa.active&&
(Ob.className=dd.a(this.$)?"ewa-active-sheet-menu-item-present-mode":"ewa-active-sheet-menu-item");return Ob}X9h(Qa){return()=>{const Ob=new U.a(-1876836819,0,this.$.hi,30,null);this.$.Ma.qh(Ob,{[Ya.a.cre]:Qa.name})}}Hp(){if(!this.s5){const Qa=this.$.sa;Qa.pn(this.R1);Qa.Wod(this.R1);Qa.d4(this.R1);Qa.fua(this.R1);Qa.gua(this.R1);Qa.s4e(this.R1);Qa.Ieb(this.R1);this.s5=!0}}to(){if(this.s5){const Qa=this.$.sa;Qa.Gn(this.R1);Qa.Iie(this.R1);Qa.tca(this.R1);Qa.UAa(this.R1);Qa.VAa(this.R1);Qa.tFg(this.R1);
Qa.g5b(this.R1);this.s5=!1}}}Object(t.a)(Kd,"SheetDropdownMenu",Fb.a,[898,4]);class Yd extends Sc{constructor(Qa,Ob,Pc){super(document.createElement("a"),Qa,!E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled"));this.Jm=()=>{this.J2(!1);E.EwaSettings.wl()||this.$.ea.Bv(this.Jm)};this.vj=Cd=>{if(!this.zRa(Xc.a.sheetTabBar,vc.a.PJk))return!0;this.h1g(Cd.Dh);return!0};this.onKeyDown=Cd=>13===Cd.La.keyCode||32===Cd.La.keyCode?(this.h1g(Cd.Dh),!0):!1;this.GWa=Ob.jh(this.domElement,
Ia.a.instance.ia(513),0,Ja.a.Gpi,Ia.a.instance.ia(513),ed.a.z1i,this.disabled);this.domElement.classList.add("ewa-stb-dropdown-menu-button");Pc.appendChild(this.domElement);E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")||this.Hki();this.Ehk()}dispose(){this.z5k();super.dispose()}J2(Qa){super.J2(Qa||!this.$.ea.rya)}Hki(){const Qa=this.$.ea;Qa.nm?this.J2(!1):E.EwaSettings.wl()?this.$.ea.Yq(this.Jm):Qa.lr(this.Jm)}h1g(Qa){this.disabled||(w.ULS.sendTraceTag(537153793,
0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${H.a[Qa]}`),this.$.Ma.qh(new U.a(1243860697,Qa,this.$.hi,30,null)))}Ehk(){Hb.a.instance.xa(zd.a.click,this.domElement,this.vj);tc.a.instance.xa(zd.a.Ui,this.domElement,this.onKeyDown)}z5k(){Hb.a.instance.Qa(zd.a.click,this.domElement,this.vj);tc.a.instance.Qa(zd.a.Ui,this.domElement,this.onKeyDown)}}Object(t.a)(Yd,"SheetDropdownMenuAnchor",Sc,[]);var Bc=a(182),Mc=a(149),Fd=a(63),Md=a(194);class oe{constructor(Qa){this.sheet=Qa;this.altText=Ia.a.instance.ia(1994)}nV(){return this.sheet.active}Dya(){return this.sheet.isLockPausedInSession}kCa(){return this.sheet.wn?
ed.a.yyg:ed.a.l5k}Vve(){return 16}iHa(){return null}jHa(){return"ewa-stb-locked-sheet-svg-16px"}Gxe(){return null}SA(){return null}drd(){return!0}}Object(t.a)(oe,"LockPausedSheetIconDataSource",null,[905]);class ye{constructor(Qa){this.sheet=Qa;this.altText=Ia.a.instance.ia(1993)}nV(){return this.sheet.active}Dya(){return this.sheet.wn}kCa(){return ed.a.yyg}Vve(){return 16}iHa(){return null}jHa(){return"ewa-stb-locked-sheet-svg-16px"}Gxe(){return null}SA(){return null}drd(){return!0}}Object(t.a)(ye,
"LockedSheetIconDataSource",null,[905]);class te{constructor(Qa,Ob,Pc){this.sheet=Qa;this.altText=Ia.a.instance.ia(1908);this.x0k=Ob;this.VNk=Pc}nV(){return this.sheet.active}Dya(){return this.sheet.dk.jx}iHa(){return this.nV()?"ewa-stb-nsv-active-svg":"ewa-stb-nsv-inactive-svg"}kCa(){return!this.nV()&&this.VNk()?ed.a.cKk:ed.a.bKk}Vve(){return 14}jHa(){return"ewa_nsv_margin"}Gxe(){return this.sheet.dk.nHb}SA(){return this.x0k}drd(){return!1}}Object(t.a)(te,"NamedSeetViewSheetIconDataSource",null,
[905]);var ze=a(159);class He{constructor(Qa,Ob){this.xfd=this.Jda=this.EQa=this.sA=null;this.G1f=!1;this.Okd=this.kCa=this.jHa=this.iHa=null;this.fZ=()=>{this.dataSource.nV()&&C.TaskExtensions.Xa(this.P7f,()=>{dialogControls.renderToolTip(this.dataSource.SA(),"SheetIconTooltip",this.dataSource.Gxe(),this.B2,10,!1,!1,1)},this.$.ya,3)};this.eZ=()=>{this.dataSource.nV()&&this.clearToolTip()};this.$=Qa;this.dataSource=Ob}get oj(){return this.Jda||(this.Jda=ze.a.instance.Yk(this.B2))}get P7f(){if(this.xfd)return this.xfd;
const Qa=new k.a;this.$.P5(Ob=>{C.TaskExtensions.Xa(Ob.w7f(),()=>{Qa.setResult(!0)},this.$.ya,3)});return this.xfd=Qa.task}get B2(){return this.Okd}i6g(){if(this.B2&&(this.sA||this.EQa)){var Qa=this.dataSource.kCa();this.kCa!==Qa&&(this.EQa&&this.EQa.parentNode.removeChild(this.EQa),this.FVf(),this.kCa=Qa);Qa=this.dataSource.iHa();this.iHa!==Qa&&(this.Opk(this.EQa,this.iHa,Qa),this.iHa=Qa);Qa=this.dataSource.jHa();this.jHa!==Qa&&(this.Npk(this.B2,this.jHa,Qa),this.jHa=Qa);this.dataSource.SA()&&!this.dataSource.nV()&&
this.clearToolTip()}}BPk(Qa,Ob,Pc){this.Cdj(Qa,Ob,Pc);Fe.DOMElementExtensions.setVisible(this.B2,this.dataSource.Dya())}clearToolTip(){C.TaskExtensions.Xa(this.P7f,()=>{dialogControls.clearToolTip(this.dataSource.SA())},this.$.ya,3)}Cdj(Qa,Ob,Pc){this.B2&&this.G1f!==Qa&&(this.B2.parentNode.removeChild(this.B2),this.jHa=this.iHa=this.kCa=this.Okd=null,this.dataSource.SA()&&(this.oj.detach("mouseover",!0),this.oj.detach("mouseout",!0)));this.B2||(this.Okd=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.B2,
Oc.a.Etc),Sys.UI.DomElement.addCssClass(this.B2,Ja.a.z4),Qa===this.dataSource.drd()?Ob.appendChild(this.B2):Ob.insertBefore(this.B2,Pc),this.FVf(),this.dataSource.SA()&&(this.oj.Ba("mouseover",this.fZ,!0),this.oj.Ba("mouseout",this.eZ,!0)),this.G1f=Qa)}Opk(Qa,Ob,Pc){Qa&&(Sys.UI.DomElement.removeCssClass(Qa,Ob),Sys.UI.DomElement.addCssClass(Qa,Pc))}Npk(Qa,Ob,Pc){Ob&&Sys.UI.DomElement.removeCssClass(Qa,Ob);Pc&&Sys.UI.DomElement.addCssClass(Qa,Pc)}dispose(){Pb.a.dh(this.Jda)}FVf(){const Qa=this.$.la.kh(388);
Qa?(this.EQa=Qa.N_a(this.dataSource.kCa(),this.dataSource.Vve()))?this.B2.appendChild(this.EQa):w.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.kCa()} was not found.`):w.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to receive SvgIconProvider service.")}}Object(t.a)(He,"SheetIcon",null,[4]);var ne=a(105);class of extends ne.a{constructor(Qa,Ob){super(Qa.domElement);this.onKeyDown=Pc=>{121===Pc.keyCode&&Pc.shiftKey&&!this.xu.disabled&&
(this.showContextMenu(new Sys.UI.Point(0,0),1,this.xu.anchor),Pe.g(Pc))};this.c7=Pc=>{if(!this.$.isEditMode||this.xu.disabled)return!0;this.rename(!1,Pc.Dh);return!0};this.Ep=Pc=>{if(this.xu.disabled)return!0;E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncSheetOpsContextMenu",!1)&&kc.b(this.$).TA(Pc.La.rawEvent,"context_menu_sheet_ops",null,["context-menu"]);return this.showContextMenu(Pc.clientPoint,Pc.Dh,Pc.li)};this.eYe=Qa;this.$=Ob;Hb.a.instance.xa(zd.a.Nr,Qa.domElement,
this.c7);Yb.a.instance.xa(Qa.domElement,this.Ep);this.oj.Ba("keydown",this.onKeyDown)}get xu(){return this.eYe}dispose(){this.xu&&(Hb.a.instance.Qa(zd.a.Nr,this.xu.domElement,this.c7),Yb.a.instance.Qa(this.xu.domElement,this.Ep),this.eYe=null);this.$=null;super.dispose()}showContextMenu(Qa,Ob,Pc){if(!this.xu.zRa(Xc.a.sheetTabBar,vc.a.QJk))return!0;this.xu.activate("showContextMenu",Ob,Ib.a.o3f());Ob=new U.a(-1075099431,Ob,this.$.hi,30,null);let Cd;return!Ab.a(Cd=this.$.Ma.qh(Ob,{[Ya.a.dre]:Qa,[of.AJk]:this.xu.sheet,
[Ya.a.ere]:Pc}))&&(6!==Cd.status||Cd.result)}rename(Qa,Ob){this.$.si(817296323,Ob,Qa?19:0,null)}}of.AJk="Sheet";Object(t.a)(of,"SheetOpsSheetClickHelper",ne.a,[]);var lf=a(47),jf=a(120);class Cf extends Sc{constructor(Qa,Ob,Pc,Cd,Ud){super(document.createElement("li"),Qa);this.xJk=100;this.yJk=500;this.bnf=zc.HelperMethods.hre;this.s5=this.are=!1;this.color=this.z$c=this.X9c=this.W_b=this.Bld=null;this.UIc=this.f0f=!1;this.Ztc="#BEBBB8";this.M7c=null;this.onKeyDown=Wd=>13===Wd.La.keyCode&&this.zRa(Xc.a.sheetTabBar,
vc.a.VJk)?(this.activateSheet(1),!0):!1;this.RE=Wd=>32===Wd.La.charCode&&this.zRa(Xc.a.sheetTabBar,vc.a.WJk)?(this.activateSheet(1),!0):!1;this.fZ=()=>{this.disabled||this.JQb||this.yJ.m1||this.HBa(!0,void 0,"OnMouseOver")};this.eZ=()=>{this.disabled||this.JQb||this.HBa(!1,void 0,"OnMouseOut")};this.x1b=()=>{if(!this.yJ.m1){this.IUk();const Wd=this.sheet.sheetProcessedData;this.disabled||this.JQb||Object(jf.d)(Wd)||"PartialResult"===(null===Wd||void 0===Wd?void 0:Wd.reason)||Aa.f(this.$).ePa(this.sheet.sheetName,
"sheetTabButton.onMouseEnter",!0)}return!1};this.cia=()=>{this.ytf(!1);return!1};this.vj=Wd=>{if(!this.zRa(Xc.a.sheetTabBar,vc.a.TJk))return!0;const le=Aa.f(this.$);this.sheet.active||3!==Wd.Dh||!Ib.a.P2a()&&!this.jYb||le.isEditing||le.lq||le.ZNb();this.activateSheet(Wd.Dh);return 3!==Wd.Dh};this.onPointerDown=Wd=>{if(!this.zRa(Xc.a.sheetTabBar,vc.a.UJk))return!0;this.ytf(!0);Aa.f(this.$).inRangePicker&&w.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var le=3===Wd.Dh;if(2===Wd.Dh||le&&this.SLa)this.HBa(!0,!le,"OnPointerDown"),le=F.Task.delay(le?this.yJk:this.xJk).lB(()=>!0),this.wXb&&(this.UIc=!0,this.yJ.EVc=C.TaskExtensions.Xa(le,()=>{this.UIc&&this.yJ.m_j(this,Wd)},this.ya,11));return!1};this.Bo=Wd=>{if(this.disabled||!this.wXb&&E.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.UIc=!1;this.HBa(2===Wd.Dh,void 0,"OnPointerUp");this.yJ.EVc&&(C.TaskExtensions.Xa(this.yJ.EVc,()=>{this.yJ.l_j()},
this.ya,11),this.yJ.EVc=null);return!1};this.jZ=()=>{this.UIc=!1;this.are||this.HBa(!1,void 0,"OnTouchMove");return!1};this.Yff=new of(this,Qa);this.jYb=Ib.a.jYb();this.$=Qa;this.Ojc=Cd;this.yJ=Ud;this.wXb=Ud.m6e();this.i$h();this.V3h();this.xSd=Qa.Eh.em("UserAction",this.name);this.jXd=!1;Fe.DOMElementExtensions.pL(this.domElement,Ya.a.qz,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.xU);this.LBa=new ba.a;Qa=new ye(this.sheet);this.LBa.add(new He(this.$,Qa));this.$.ea.n8b&&
(Qa=new oe(this.sheet),this.LBa.add(new He(this.$,Qa)));Qa=new te(this.sheet,this.yJ.oZc,()=>this.color?Cf.Gse(this.color):!1);this.W_b=new He(this.$,Qa);this.LBa.add(this.W_b);this.SLa=this.yJ.SLa;this.Rzb();this.ajk();this.Haf=new be.a(this.domElement,1);Ob.insertBefore(this.domElement,Pc);dd.a(this.$)&&this.e7g(!0);w.ULS.sendTraceTag(507643663,0,50,`SheetTabButton.ctor: index=${Cd.index}, navigationButtonsDisabled=${Ud.navigationButtonsDisabled}, operationButtonsDisabled=${Ud.operationButtonsDisabled}`)}get ABd(){return this.z$c||
(this.z$c=Ua.a.Ou("#F5F5F5"))}get name(){return this.pQ.innerText}set name(Qa){this.pQ&&(this.pQ.innerText=Qa,this.j3c(),this.f7g())}get sheet(){return this.Ojc}get anchor(){return this.M7c}get pQ(){return this.Bld}get xU(){return this.X9c}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Qa){this.anchor.tabIndex=Qa}YGf(){return Fe.DOMElementExtensions.Zo(this.anchor)?this.anchor:null}dispose(){if(this.s5){wd.a.instance.Qa(zd.a.qj,this.domElement,this.onPointerDown);tc.a.instance.Qa(zd.a.Ui,
this.domElement,this.onKeyDown);tc.a.instance.Qa(zd.a.lx,this.domElement,this.RE);Hb.a.instance.Qa(zd.a.click,this.domElement,this.vj);wd.a.instance.Qa(zd.a.z7,this.domElement,this.x1b);wd.a.instance.Qa(zd.a.bL,this.domElement,this.cia);if(this.wXb||E.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))wd.a.instance.Qa(zd.a.Co,this.domElement,this.Bo),this.SLa&&(Bd.a.instance.Qa(zd.a.ml,this.domElement,this.Bo),Bd.a.instance.Qa(zd.a.Jn,this.domElement,this.jZ));this.s5=
!1;this.Ztc="#BEBBB8"}Pb.a.gj([this.Yff,this.Haf]);this.Bld=this.X9c=this.M7c=this.yJ=this.Haf=this.Yff=null;if(this.LBa){for(const Qa of this.LBa)Qa.dispose();this.LBa=null}this.color=this.Ojc=null;super.dispose()}J2(Qa){Qa&&this.HBa(!1,!1);super.J2(Qa)}rVg(Qa){Fd.a.Wl.GY&&(this.hqf(),void W.a.resolve(J.ae,{va:1}).then(Ob=>{Bc.a.zK().then(Pc=>{Ob.uFk(Pc);Ob.show(Qa);return null},Pc=>{w.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Pc}`);
return null})}))}Fzh(){if(this.sheet.active&&this.$.ax){var Qa=this.$.ax,Ob=Aa.f(this.$),Pc=Ob.fp;if(this.sheet.dk.jx){if(!this.W_b){const Cd=new te(this.sheet,this.yJ.oZc,()=>this.color?Cf.Gse(this.color):!1);this.W_b=new He(this.$,Cd);this.LBa.add(this.W_b)}Pc&&Ob.Ezb(1);Qa.classList.add(Ja.a.xxf);Qa=Cf.kJf(Ya.a.geg);Ob=Cf.kJf(Ya.a.I6d);"true"===Qa&&"true"===Ob?this.$.ea.rse&&this.$.ea.J8b&&(this.sheet.dk.cN?(Qa=1,Mc.a.yG(Ya.a.I6d,"false",Mc.a.Hba),this.$.ea.J8b=!1):Qa=0,Mc.a.yG(Ya.a.geg,"false",
Mc.a.Hba),this.$.ea.rse=!1,this.rVg(Qa)):this.sheet.dk.cN&&"true"===Ob&&this.$.ea.J8b&&(Mc.a.yG(Ya.a.I6d,"false",Mc.a.Hba),this.$.ea.J8b=!1,this.rVg(2))}else this.hqf(),Pc&&Ob.Ezb(0),Qa.classList.remove(Ja.a.xxf)}}hqf(){const Qa=W.a.nh(J.ae);Qa&&Qa.dismiss()}Rzb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.Oob()?"tab-active":"tab-inactive";E.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.pQ.parentNode.classList.add("leave-size-fixed-on-tab-hover"):
this.pQ.parentNode.classList.add("leave-size-fixed-on-tab-hover-old");this.f7g();this.CPk();this.m7g();this.j3c();this.Fzh()}k_j(){this.are=!0;this.HBa(!0,!0,"OnSheetReorderStarted")}j_j(){this.are=!1;this.HBa(!1,void 0,"OnSheetReorderEnded")}activate(Qa,Ob,Pc){Ob=void 0===Ob?0:Ob;Pc=void 0===Pc?!1:Pc;this.Lqc()||(this.sheet.activate({scenario:Qa}),Pc&&Aa.f(this.$).focus(),Qa={["InputMethod"]:H.a[Ob],["AppMode"]:this.$.hi,["Location"]:"canvas"},ea.b(this.$).Aj(I.a.uJk,Qa))}e7g(Qa){this.Ztc=Qa?"#797775":
"#BEBBB8";this.bnf=Qa?-.5:zc.HelperMethods.hre;this.z$c=Qa?Ua.a.Ou("#3B3A39"):Ua.a.Ou("#F5F5F5");this.m7g()}QBk(Qa){this.wXb=Qa}L_h(Qa){var Ob;const Pc=[];this.name!==Qa.SheetName&&Pc.push(`SheetName. CachedSheetName null or empty: ${null==Qa.SheetName||""===Qa.SheetName}`);if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8625911_addStbSheetColorSsr")){const Cd=null!==(Ob=Qa.TabColor)&&void 0!==Ob?Ob:Ua.a.DJ(this.ABd);Ua.a.DJ(this.color).toLowerCase()!==Cd.toLowerCase()&&Pc.push("TabColor")}else this.color.xCa()!==
this.ABd.xCa()&&Pc.push("TabColor");E.EwaSettings.isChangeGateEnabled("OfficeVSO:8654274_addLockedSheetSsr")?this.sheet.QK(128)!==zc.HelperMethods.gS(Qa.SheetOptions,128)&&Pc.push("Locked"):this.sheet.wn&&Pc.push("Locked");return Pc}jVh(Qa){Qa.zhb();this.sheet.activate({scenario:"switchSheet"})}zwh(Qa){Qa=new U.a(-1876836819,Qa,this.$.hi,30,null);return this.$.Ma.qh(Qa,{[Ya.a.cre]:this.sheet.name})}f7g(){this.pQ.parentNode.setAttribute("sheet-title",this.pQ.innerText)}j3c(){const Qa=this.REi();this.anchor.setAttribute(Ya.a.tD,
Qa);this.anchor.setAttribute(Ya.a.Ila,this.sheet.active.toString())}REi(){const Qa=this.sheet.dk.jx,Ob=this.sheet.dk.nHb,Pc=this.sheet.wn,Cd=this.sheet.isLockPausedInSession;return Qa&&Pc?String.format(Ia.a.instance.sh(20),this.name,Ob):Qa&&Cd?String.format(Ia.a.instance.sh(22),this.name,Ob):Qa?String.format(Ia.a.instance.sh(19),this.name,Ob):Pc?String.format(Ia.a.instance.sh(18),this.name):Cd?String.format(Ia.a.instance.sh(21),this.name):this.name}activateSheet(Qa){Qa=void 0===Qa?0:Qa;var Ob;if(Ib.a.o3f()){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.Lqc())return F.Task.Ua(!1);Md.a.current.FZ="ActivateSheet";null===(Ob=W.a.nh(J.Sg))||void 0===Ob?void 0:Ob.Bxa(bc.a.switchSheet);this.sheet.activate({scenario:"switchSheet"});return F.Task.Ua(!0)}return this.zwh(Qa)}m7g(){const Qa=this.sheet.tabColor;this.color=Qa?Ua.a.Ou(Qa):this.ABd;this.f0f=Cf.Gse(this.color);this.HBa(!1,void 0,"UpdateTabColor")}HBa(Qa,Ob,Pc){Ob=void 0===Ob?!1:Ob;Pc=void 0===Pc?null:Pc;if(this.sheet){Pc=this.sheet.active;var Cd=this.Oob(),Ud=!!this.sheet.tabColor,Wd=Ua.a.DJ(Pc||
Cd?ja.a.LRa:this.color);this.xU.style.background="";Pc||Cd?(Ud&&(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.Sxa?this.lHk():this.kHk()),this.xU.style.height=zc.HelperMethods.rSg.toString()+"px"):(this.xU.style.filter="",this.xU.style.backgroundColor=Wd,this.xU.style.height=zc.HelperMethods.sSg.toString()+"px");this.pQ.className=Pc?"tab-active-text":Cd?"dark":this.f0f?"light":"dark";for(const le of this.LBa)le.i6g();Qa&&!Ud&&(this.xU.style.backgroundColor=
"#E1DFDD");Fe.DOMElementExtensions.toggleCssClass(this.domElement,"tab-hover",Qa);Ob?(Ud||(this.xU.style.backgroundColor=this.Ztc),this.domElement.style.backgroundColor=this.Ztc):(Ud||(this.xU.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.pQ.style.fontWeight=Pc||Cd?"600":""}else w.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, which means its not rendered. caller: ${Pc}`)}kHk(){const Qa=this.xU.style,Ob=Ua.a.DJ(Ua.a.fef(this.color,
this.bnf));Qa.background=Ob}lHk(){this.xU.style.background="transparent"}V3h(){this.M7c=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className="tab-anchor-text";Fe.DOMElementExtensions.pL(this.anchor,Ya.a.gJb,null,null);this.tabIndex=-1}i$h(){this.X9c=document.createElement("span");this.xU.className="tab-content-container";this.Bld=document.createElement("span");this.pQ.className="tab-text";this.pQ.dir=this.sheet.rtlName?"rtl":"ltr";this.xU.appendChild(this.pQ)}CPk(){const Qa=
this.$.pX;for(const Ob of this.LBa)Ob.BPk(Qa,this.xU,this.pQ)}Oob(){return Aa.f(this.$).Oob(this.sheet)}IUk(){this.xSd.start();this.jXd=!0}ytf(Qa){this.jXd&&(this.xSd.stop(),w.ULS.sendTraceTag(537153686,0,50,lf.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.xSd.zi,["Has been clicked"]:Qa})),this.jXd=!1)}ajk(){wd.a.instance.xa(zd.a.qj,this.domElement,this.onPointerDown);tc.a.instance.xa(zd.a.Ui,this.domElement,this.onKeyDown);tc.a.instance.xa(zd.a.lx,
this.domElement,this.RE);this.oj.Ba("mouseover",this.fZ);this.oj.Ba("mouseout",this.eZ);wd.a.instance.xa(zd.a.z7,this.domElement,this.x1b);wd.a.instance.xa(zd.a.bL,this.domElement,this.cia);if(this.wXb||E.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))wd.a.instance.xa(zd.a.Co,this.domElement,this.Bo),this.SLa&&(Bd.a.instance.xa(zd.a.ml,this.domElement,this.Bo),Bd.a.instance.xa(zd.a.Jn,this.domElement,this.jZ));Hb.a.instance.xa(zd.a.click,this.domElement,this.vj);
this.s5=!0}Lqc(){const Qa=J.Qb.Aa()?W.a.nh(J.Qb):this.$.la.kh(65);return Qa&&Qa.sya()?(Qa.WWc(),this.jVh(Qa),!0):!1}static kJf(Qa){let Ob=Mc.a.get(Qa);Ob||(Mc.a.yG(Qa,"true",Mc.a.Hba),Ob=Mc.a.get(Qa));return Ob}static Gse(Qa){return 128>=(222*Qa.r+707*Qa.g+71*Qa.b)/1E3}}Object(t.a)(Cf,"SheetTabButton",Sc,[]);class Gf extends Sc{constructor(Qa,Ob,Pc){super(document.createElement("a"),Ob);this.HWa=Ja.a.hFd;Pc.jh(this.domElement,Ia.a.instance.ia(713),0,this.HWa,Ia.a.instance.ia(713),ed.a.Dxd,!0);Qa.appendChild(this.domElement);
this.oj.Ba("contextmenu",Cd=>{Pe.g(Cd)})}}Object(t.a)(Gf,"WorkbookProtectionButton",Sc,[]);var Af=a(45),Lf=a(70),Ef=a(651);class Hf extends Fb.a{constructor(Qa,Ob,Pc,Cd){Cd=void 0===Cd?null:Cd;super(Ob);this.$Ba=Pc;this.sheetTabActivatePreviousHidden=Ia.a.instance.ia(722);this.sheetTabActivateNextHidden=Ia.a.instance.ia(724);this.svgIconProvider=null;this.So=[];this.TY=Array(6);this.R6d=Array(6);this.uxb=this.kre=this.jre=this.ev=null;this.qHg=!1;this.p8a=this.XUb=this.b1=null;this.isRtl=!1;this.Toa=
this.eP=0;this.Uvc=this.DVc=!1;this.qBa=0;this.DFc=!0;this.fSc=0;this.UX=this.Ofa=this.Sma=this.bwc=null;this.$Cc=this.MM=0;this.n$b=null;this.KYb=-1;this.Bfa=null;this.kRc=0;this.h0c=-1;this.GAa=0;this.mIa=new rb;this.bed=!1;this.EVc=this.eQa=this.dQa=this.cYe=this.Mba=null;this.HPe=!1;this.bYe=null;this.wUf=()=>{this.vUf("onWorkbookOpened");this.$.Wr(this.wUf)};this.LH=(Ud,Wd)=>{this.Eqg(Wd.item)};this.P1=(Ud,Wd)=>{Ud=this.$.sa.ma.index;for(let le=0,Fa=this.So.length;le<Fa;le++){const mb=this.Baa(le);
if(mb.name===Wd.oldName){mb.name=Wd.newName;this.oca();le===Ud&&this.Bqa(6);break}}};this.Hqg=(Ud,Wd)=>{(Ud=this.qkb(Wd.item))&&Ud.Rzb()};this.Iqg=(Ud,Wd)=>{Wd.visible?(this.k8a(!1),this.Fqg(Wd.item)):this.Eqg(Wd.item)};this.D4a=Ud=>{this.m1?(this.Bfa=Ud,this.Iac()):(this.Bfa&&(this.fSc+=this.Bfa.clientPoint.x-Ud.clientPoint.x),this.Bfa=Ud,Math.abs(this.fSc)>=this.nii&&this.Iac());return!0};this.jZ=Ud=>{Ud.La.preventDefault();return!1};this.sMg=Ud=>{this.pMg(Ud,!0)};this.rMg=Ud=>{this.pMg(Ud,!1)};
this.E4a=Ud=>{if(this.m1){this.Uvc=this.vkj(Ud);let Wd;Ud=(Wd=this.Baa(this.MM+1))?Wd.sheet:null;this.reorderSheets(Ud,this.MM+1===this.o8b,!0)}this.n5();return!0};this.wq=(Ud,Wd)=>{Wd.LB&&this.EAe(Wd.LB);this.vYc(!1);this.oca();Wd.ma&&(this.EAe(Wd.ma),this.Bqa(6),this.ea.TNa())};this.Kgg=(Ud,Wd)=>{this.m4c(Wd.item)};this.Lgg=(Ud,Wd)=>{this.m4c(Wd.item)};this.Mgg=(Ud,Wd)=>{this.m4c(Wd.item)};this.L4a=(Ud,Wd)=>{this.m4c(Wd.item)};this.zNa=()=>{this.uwd()};this.Cj=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;
this.uwd();this.dAd();E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)||!Lf.d(this.$)&&!Lf.e(this.$)||this.pHg();this.Mzd();this.oca();this.k8a(!0);this.Bqa(6);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(Lf.d(this.$)||Lf.e(this.$))&&this.pHg()};this.nq=()=>{this.isVisible&&(this.oca(),this.Bqa(6))};this.Dl=()=>{Object(ab.a)(Id,this.b1)===Ed.l(this.$.Zk)&&this.Mzd();for(const Ud of this.So)Ud.QBk(!Ed.l(this.$.Zk))};
this.Gqg=(Ud,Wd)=>{this.Bpk(Wd.item,Wd.isUserOperation)};this.O1b=(Ud,Wd)=>{this.Fqg(Wd.item)};this.onKeyDown=Ud=>{switch(Ud.keyCode){case 9:var Wd=this.domElement.querySelectorAll(Fe.DOMElementExtensions.RI);const le=Fe.DOMElementExtensions.DE(Wd);Wd=Fe.DOMElementExtensions.yaa(Wd);Fe.DOMElementExtensions.b8a(Ud,le,Wd);break;case 39:case 37:Fe.DOMElementExtensions.tPg(Ud,this.domElement.querySelectorAll(Fe.DOMElementExtensions.RI),39===Ud.keyCode?!this.isRtl:this.isRtl)}w.ULS.sendTraceTag(537153691,
0,50,`SheetTabBarControl.OnKeyDown: Press on ${Ud.keyCode}`)};this.onScroll=()=>{this.ev.scrollLeft!==this.qBa&&this.qZk()};this.gZ=Ud=>{if(Ud.ctrlKey||Ud.ofa)return!1;this.ev.scrollLeft+=Math.floor(30*Ud.hDa);if(this.m1){const Wd=this.pHf("OnMouseWheel");Wd&&this.Xve(0<Ud.hDa,Wd.x+Wd.width/2)}return!0};this.Ep=Ud=>{if(!Ef.a.uWb)return!1;w.ULS.sendTraceTag(507363731,0,50,"SheetTabBarControl.onContextMenu: Context menu opened from sheet tab bar.");const Wd=new U.a(-1075099431,Ud.Dh,this.$.hi,30,null);
let le;return!Ab.a(le=this.$.Ma.qh(Wd,{[Ya.a.dre]:Ud.clientPoint,[Ya.a.ere]:Ud.li,[Ya.a.lSg]:!0}))&&(6!==le.status||le.result)};this.hZ=(Ud,Wd)=>{if(this.mIa)w.ULS.sendTraceTag(507847647,0,50,`SheetTabBarControl.onPartialInteractivityStatusChanged: sender=${!!Ud}, activated=${Wd.iU}, swappedPIType=${Wd.ora}`),this.bQf("PartialInteractivity",Wd.iU?3:0);else if(this.n5(!1),this.Epe(Wd.iU),E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")){for(const le of this.Qoc)le&&
le.X1c(Wd.iU);for(const le of this.So)le&&le.X1c(Wd.iU)}else{for(const le of this.Qoc)le&&le.J2(Wd.iU);for(const le of this.So)le&&le.J2(Wd.iU)}};this.X0b=(Ud,Wd)=>{Ud=0|(Wd.Lnd?2:0);Ud|=Wd.Lnd&&Wd.BJk?1:0;this.bQf("ComponentRangePicker",Ud)};this.$=Qa;this.svgIconProvider=Cd;this.$.sa?this.vUf("ctor"):this.$.mr(this.wUf);Pc||w.ULS.sendTraceTag(507536514,0,10,"SheetTabBarControl.ctor: SkeletonManager must always exist.")}vUf(Qa){w.ULS.sendTraceTag(507847648,0,50,`SheetTabBarControl.initComponent: caller=${Qa}`);
this.ea=this.$.ea;this.iwc=!E.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.qrj=E.EwaSettings.isChangeGateEnabled("OfficeVSO:8749006_EnrichSTBSkeleton");this.U2f=!this.$.LC;this.HPe=!v.a.iS;this.Jmj=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.rJj=this.$.ua.SheetTabNavigateButtonLongKeyPressPeriodMS;this.qJj=this.$.ua.SheetTabNavigateButtonIntervalPeriodMS;this.nii=this.$.ua.SheetTabDragStartPixelThreshold;
this.E5a=this.F5a=-1;this.lyd=!1;this.eM=new be.a(this.domElement,3);this.domElement.classList.add("ewa-stb-uir");this.N7h();this.l5h();this.O7h();document.getElementById(Ya.a.Rga)||this.W8h();this.vYc(!0);this.Cj(null,null);Qa=this.$.sa;Qa.pn(this.wq);Qa.Wod(this.zNa);Qa.d4(this.LH);Qa.fua(this.O1b);Qa.gua(this.P1);Qa.s4e(this.Gqg);Qa.Ieb(this.Iqg);Qa.SCh(this.Hqg);Qa.qpd(this.Kgg);Qa.q4e(this.Lgg);Qa.rpd(this.Mgg);Qa.r4e(this.L4a);this.$.mr(this.Cj);this.$.xI(this.nq);cd.a(this.$).Tq(this);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||this.$.la.Hh(32,this);E.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.pz(this.Dl);this.qZc=this.pl.Yk(this.domElement);this.qZc.Ba("keydown",this.onKeyDown);Ta.a(this.$).wv()&&this.hZ(null,new yb.a(!0));Ta.a(this.$).Tm.iua(this.hZ);Aa.f(this.$).T3e(this.X0b);this.qZc.Ba("mousedown",Ob=>{Ob.preventDefault()});vd.a.instance.xa(zd.a.kN,this.domElement,this.gZ);Yb.a.instance.xa(this.domElement,this.Ep);this.ire=this.pl.Yk(this.ev);this.ire.Ba("scroll",
this.onScroll);this.qZk=hc.b(()=>{this.oca()},200,this.$.ya,$d.a.JJk,!0);E.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")?this.$Ba.NM(Ya.a.y9b):this.$.oP(Ya.a.y9b);this.U2f&&(this.bYe=new Kd(this.$,this.p8a.domElement))}Abh(){if(!this.qrj)return!1;Af.a.instance.wL("SheetTabBarPromotion");const Qa=this.A_h(this.$Ba.RWg);Af.a.instance.mH("SheetTabBarPromotion");const Ob=0===Qa.length;w.ULS.sendTraceTag(507839499,0,15,`SheetTabBar Skeleton Model Comparison ${Ob?"Succeeded":"Failed"}.${Ob?
"":` Mismatches: ${Qa.join(", ")}.`}`);Ob&&Af.a.instance.Pm("SheetTabBarTTVRPromoted");return Ob}get hj(){return this.domElement}get Zo(){return this.isVisible}get hl(){return Sd.a.gre}get m1(){return this.bed}get o8b(){return this.So.length}get oZc(){return this.cYe}get SLa(){return this.HPe}get navigationButtonsDisabled(){return!!this.mIa&&this.mIa.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.mIa&&this.mIa.operationButtonsDisabled}get CJj(){return this.$.pX?[Ja.a.Jvf,Ja.a.Kvf,
Ja.a.Lvf,Ja.a.Ivf,Ja.a.hxc,Ja.a.hxc]:[Ja.a.Ivf,Ja.a.Lvf,Ja.a.Kvf,Ja.a.Jvf,Ja.a.hxc,Ja.a.hxc]}get S6d(){return this.$.pX?[null,ed.a.Ehf,ed.a.Chf]:[null,ed.a.Chf,ed.a.Ehf]}get Mwg(){return this.$.pX?[null,ed.a.Fhf,ed.a.Dhf]:[null,ed.a.Dhf,ed.a.Fhf]}get hZb(){if(this.isRtl){if(v.a.aJ)return 0;if(v.a.Am)return-1*(this.ev.scrollWidth-this.ev.clientWidth);if(v.a.iS)return this.ev.scrollWidth-this.ev.clientWidth;w.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get l6b(){if(this.isRtl){if(v.a.aJ)return this.ev.scrollWidth-
this.ev.clientWidth;if(v.a.Am||v.a.iS)return 0;w.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.ev.scrollWidth-this.ev.clientWidth}get Qoc(){return this.mIa?[this.b1,this.XUb]:[this.b1,this.XUb,this.p8a]}get h_g(){return this.So.concat(this.p8a)}get Zfe(){return!this.eP}get $fe(){return this.Toa===this.So.length-1}get zJk(){return this.bYe}jh(Qa,Ob,Pc,Cd,Ud,Wd,le){le=void 0===le?!1:le;Qa.removeAttribute("Href");Qa.setAttribute(Ya.a.ik,Ya.a.FF);
Qa.className="ewa-stb-navbutton";Qa.title=Ob;Qa.tabIndex=0;Wd?Pc=this.svgIconProvider.Zna(Wd,12,12,Qa,24,24):(Ob=document.createElement("span"),Ob.className=Ja.a.eYh,Ob.classList.add(Oc.a.Etc),Ob.tabIndex=-1,Qa.appendChild(Ob),Wd=document.createElement("img"),Wd.src=Pa.a.An(Pc),Wd.className=Cd,Wd.alt=Ud,Wd.tabIndex=-1,Ob.appendChild(Wd),Pc=Wd);le&&Qa.classList.add(Oc.a.NHa);return Pc}dispose(){if(this.$){var Qa=this.$.sa;Qa.Gn(this.wq);Qa.Iie(this.zNa);Qa.tca(this.LH);Qa.UAa(this.O1b);Qa.VAa(this.P1);
Qa.tFg(this.Gqg);Qa.g5b(this.Iqg);Qa.Zmk(this.Hqg);Qa.aje(this.Kgg);Qa.rFg(this.Lgg);Qa.bje(this.Mgg);Qa.sFg(this.L4a);this.$.Wr(this.Cj);this.$.gL(this.nq);Ta.a(this.$)&&Ta.a(this.$).Tm.WAa(this.hZ);this.mIa&&Aa.f(this.$).XEg(this.X0b);vd.a.instance.Qa(zd.a.kN,this.domElement,this.gZ);Yb.a.instance.Qa(this.domElement,this.Ep)}Pb.a.gj(this.R6d);this.R6d=null;if(this.TY)for(Qa=0;Qa<this.TY.length;Qa++){const Ob=Fe.DOMElementExtensions.jP(this.TY[Qa],this.domElement,!1,"a");Ob&&$c.a.VOa(Ob)}Pb.a.dh(this.eM);
Pb.a.dh(this.qZc);Pb.a.dh(this.ire);this.ire=this.qZc=this.XUb=this.b1=this.eM=null;this.$&&this.n5(!1);this.Sma=null;this.cpe(null,"Dispose");this.n$b=this.UX=this.bwc=null;this.uwd();this.uxb=this.kre=this.jre=this.ev=this.TY=this.$=this.ea=null;super.dispose()}A_h(Qa){var Ob,Pc;const Cd=[],Ud=[];if(null==Qa)Cd.push("WorkbookCacheItem was null, no cached state to compare");else if(Qa.vxb&&0!==Qa.vxb.length)if(this.o8b!==Qa.vxb.length)Cd.push(`SheetTab visible sheet number mismatch. Cached: ${Qa.vxb.length} Actual: ${this.o8b}`);
else{var Wd=Qa.vxb;for(let le=0;le<this.So.length;le++){const Fa=this.So[le].L_h(Wd[le]);0<Fa.length&&Ud.push(`Button position ${le}: ${Fa.join(", ")}`)}(Wd=null===(Pc=null===(Ob=this.$.sa)||void 0===Ob?void 0:Ob.ma)||void 0===Pc?void 0:Pc.name)&&Wd===Qa.activeSheetName||Cd.push(`Active sheet mismatch. Cached value is null: ${!(null===Qa||void 0===Qa?0:Qa.activeSheetName)} Actual value is null: ${!Wd}`);this.isRtl!==Qa.GYf&&Cd.push(`Rtl: isRtl: ${this.isRtl} cacheDisplayRtl: ${Qa.GYf}`);this.z_h(Cd,
Qa)}else Cd.push(`No cached sheet tabs, sheetTabs null: ${!Qa.vxb}`);0<Ud.length&&Cd.push(`SheetTabButton: [${Ud.join(", ")}]`);return Cd}Vp(Qa,Ob){if(!Ob){w.ULS.shipAssertTag(537153760,0,0<this.So.length,"There is no sheet tab button.");if(!this.So.length)return!1;Qa=null;for(const Pc of this.So)if(Qa=Pc.YGf())break;if(!Qa)return w.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;Fe.DOMElementExtensions.setFocus(Qa)}return!Ob}tq(Qa){return Fe.DOMElementExtensions.eo(this.hj,
Qa)}Qs(){}nu(){}reorderSheets(Qa,Ob,Pc){if(this.Mba&&this.Mba!==Qa){const Cd=this.Mba.index;this.Apk(this.Mba,Qa,Ob);Qa=Qa?Qa.index-1:Ob?this.$.sa.count-1:0;Cd!==Qa&&(this.BBj(Cd,Qa,Pc),this.rli(this.Mba.name,Qa))}}K_i(Qa){Qa=this.zwa(Qa);return-1!==Qa&&this.eP<=Qa&&Qa<=this.Toa?this.So[Qa].domElement:null}d7g(Qa){for(var Ob=0;Ob<this.TY.length;Ob++){const Pc=this.TY[Ob];if(Pc&&this.svgIconProvider){const Cd=Pc.parentNode;this.AEg(Pc);Cd&&(this.TY[Ob]=this.svgIconProvider.Zna(Qa?this.Mwg[Ob]:this.S6d[Ob],
12,12,Cd,24,24))}}for(Ob=0;Ob<this.So.length;Ob++)this.So[Ob].e7g(Qa);this.p8a&&this.p8a.GWa&&this.c7g(ed.a.A1i,this.p8a,Qa);this.b1&&this.b1.GWa&&this.c7g(ed.a.r_h,this.b1,Qa)}c7g(Qa,Ob,Pc){Ob.u3b||(Ob.u3b=this.svgIconProvider.Zna(Qa,12,12,Ob.GWa.parentNode,24,24));Ob.u3b&&(Fe.DOMElementExtensions.setVisible(Ob.GWa,!Pc),Fe.DOMElementExtensions.setVisible(Ob.u3b,Pc))}m_j(Qa,Ob){var Pc=Aa.f(this.$);const Cd=Pc.inRangePicker,Ud=zc.HelperMethods.rA(Ob);if(Pc.isEditing&&!Cd){const Wd=Pc.xA?"formulaBar_end_edit_sheet_changed":
"cell_text_end_edit_sheet_changed";let le;le=[Object(kc.a)(Pc.cellTextEditBox.Wa.KQa)];kc.b(this.$).TA(Ud.rawEvent,Wd,le);Pc.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Pc=this.SLa&&3===Ob.Dh;!(2===Ob.Dh&&Ud.button===Sys.UI.MouseButton.leftButton||Pc)||Cd||this.m1||Ta.a(this.$).wv()||(Pc&&Qa.k_j(),this.KYb=Ob.clientPoint.x,this.Bfa=Ob,this.rMh(Qa))}l_j(){this.oca()}m6e(){return this.$.isEditMode&&!Ed.l(this.$.Zk)}oca(){const Qa=zc.HelperMethods.jN(()=>{this.Y7k();this.PGk();this.Epe()});w.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Qa}`)}PGk(){const Qa=this.$fe;Fe.DOMElementExtensions.toggleCssClass(this.uxb,this.$.pX?"ewa-stb-right-scrollable":"ewa-stb-left-scrollable",!this.Zfe);Fe.DOMElementExtensions.toggleCssClass(this.uxb,this.$.pX?"ewa-stb-left-scrollable":"ewa-stb-right-scrollable",!Qa)}Epe(Qa){Qa=void 0===Qa?!1:Qa;const Ob=this.Zfe,Pc=this.$fe;this.dQg(4,this.sheetTabActivatePreviousHidden,!Ob);this.dQg(5,this.sheetTabActivateNextHidden,!Pc);
this.KYc(0,Ob||Qa);this.KYc(1,Ob||Qa);this.KYc(2,Pc||Qa);this.KYc(3,Pc||Qa)}dQg(Qa,Ob,Pc){if(Qa=this.TY[Qa]){Fe.DOMElementExtensions.setVisible(Qa,Pc);var Cd=this.mJf(Qa);Cd.title="img"===Qa.nodeName?Qa.alt=0<this.So.length&&Pc?Ob:"":Qa.title=0<this.So.length&&Pc?Ob:"";Cd.tabIndex=Pc?0:-1}}mJf(Qa){return Qa.parentNode}KYc(Qa,Ob){if(Qa=this.TY[Qa])Qa=this.mJf(Qa),void 0!==Qa&&null!==Qa&&(!this.So.length||Ob?(Qa.classList.add(Oc.a.NHa),Qa.setAttribute(Ya.a.dWa,"true")):(Qa.classList.remove(Oc.a.NHa),
Qa.setAttribute(Ya.a.dWa,"false")))}k8a(Qa){const Ob=this.$.pX?this.So.length-1:0;let Pc=this.ULf(this.$.pX?0:this.So.length-1);Pc&&(Pc.borderRightWidth=Qa?"1px":"0");this.eP!==this.Toa&&(Pc=this.ULf(Ob))&&(Pc.borderRightWidth="0")}n3e(Qa,Ob){this.So||(this.So=[]);-1===Ob?this.So.push(Qa):this.So.splice(Ob,0,Qa)}wtc(Qa,Ob){let Pc=-1,Cd=null;Ob||(Pc=this.fRi(Qa.index),-1!==Pc&&(Cd=this.L_a(Pc)));Qa=new Cf(this.$,this.ev,Cd,Qa,this);this.n3e(Qa,Pc);Fe.DOMElementExtensions.setVisible(Qa.domElement,!0)}Bqa(Qa){const Ob=
zc.HelperMethods.jN(()=>{switch(Qa){case 0:this.mXc(0);break;case 1:this.mXc(this.eP-1);break;case 2:this.mXc(this.eP+1);break;case 3:this.scrollIntoView(this.So.length-1);break;case 6:this.byk()}});this.iwc&&this.m1&&this.Iac();w.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Qa}, duration = ${Ob}`)}Xwi(Qa){if(0===Qa.zJ){const Ob=this.$.sa;let Pc=0;for(let Cd=0,Ud=Ob.count;Cd<Ud;Cd++){const Wd=Object(ac.a)(Lb.a,Ob.getItem(Cd));if(Wd===Qa)return Pc;0===Wd.zJ&&Pc++}}return-1}Kwi(Qa){const Ob=
this.$.sa;for(let Pc=Qa.index+1,Cd=Ob.count;Pc<Cd;Pc++)if(Qa=Object(ac.a)(Lb.a,Ob.getItem(Pc)),0===Qa.zJ)return Qa;return null}zwa(Qa){for(let Ob=0;Ob<this.So.length;Ob++){const Pc=this.Baa(Ob);if(!Pc)w.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${Ob}] is null even though index is not out of bounds!`);else if(Pc.sheet===Qa)return Ob}return-1}qkb(Qa){Qa=this.zwa(Qa);return this.Baa(Qa)}BBj(Qa,Ob,Pc){const Cd={};Cd.a=this.$.ua.UserSessionId;Cd.b=Pc;
Cd.c=this.Uvc;Cd.d=Qa;Cd.e=Ob;Cd.f=this.$.sa.count;Ea.b().Ll(2,Cd,Pc)}Apk(Qa,Ob,Pc){const Cd=Object(ac.a)(oc.a,this.$.sa);Ob?(Ob=Ob.index,Ob=Qa.index<Ob?Ob-1:Ob):Ob=Pc?Cd.count-1:0;Cd.reorderSheet(Qa,Ob,!0)}mEk(Qa){Aa.f(this.$).co.PA(Qa)}rMh(Qa){if(!this.DVc){const Ob=this.domElement.ownerDocument.body;wd.a.instance.xa(zd.a.zv,document.documentElement,this.D4a);this.SLa&&(Bd.a.instance.xa(zd.a.Jn,document.documentElement,this.D4a),Bd.a.instance.xa(zd.a.Jn,this.domElement,this.jZ));wd.a.instance.xa(zd.a.Co,
document.documentElement,this.E4a);Bd.a.instance.xa(zd.a.ml,Ob,this.E4a);this.DVc=!0}this.Mba=Qa.sheet;this.Uvc=!1;this.UX=null;this.bwc=Qa;this.Sma=Qa.domElement;this.cpe(Fe.DOMElementExtensions.getBoundingClientRect(this.Sma),"BeginSheetTabButtonDrag")}n5(Qa){Qa=void 0===Qa?!0:Qa;if(this.DVc){this.mEk(Ya.a.Gaa);const Ob=this.domElement.ownerDocument.body;wd.a.instance.Qa(zd.a.zv,document.documentElement,this.D4a);this.SLa&&(Bd.a.instance.Qa(zd.a.Jn,document.documentElement,this.D4a),Bd.a.instance.Qa(zd.a.Jn,
this.domElement,this.jZ));wd.a.instance.Qa(zd.a.Co,document.documentElement,this.E4a);Bd.a.instance.Qa(zd.a.ml,Ob,this.E4a);this.bed=this.DVc=!1}this.fSc=0;this.Uvc=!1;this.Mba=null;this.Sma&&(this.Sma.style.visibility="visible",this.Sma=null);this.bwc=null;this.cpe(null,"EndSheetTabButtonDrag");this.UX&&(this.UX.parentNode&&this.UX.parentNode.removeChild(this.UX),this.UX=null);this.jsk(Qa)}jsk(Qa){this.jve(Qa);this.MM=this.KYb=-1}rli(Qa,Ob){const Pc=this.$.pa,Cd=Pc?Pc.ta:null;this.$.userOperationManager.enqueueOperation(new Y.a(557,
0,(Ud,Wd,le)=>{const Fa=Cd.$a(9,null);Fa.sheetName=Qa;Fa.newSheetIndex=Ob;return za.h(Cd,"ReorderSheets",Fa,Ud,Wd,le,null,0)},64,()=>new Vd(Qa,Ob)),null)}Baa(Qa){return 0<=Qa&&Qa<this.So.length?this.So[Qa]:null}QWi(Qa){return(Qa=this.Baa(Qa))?Qa.sheet:null}L_a(Qa){return(Qa=this.Baa(Qa))?Qa.domElement:null}ULf(Qa){return(Qa=this.L_a(Qa))?Qa.style:null}fRi(Qa){const Ob=this.$.sa;Qa+=1;let Pc=-1;const Cd=this.So?this.So.length:0;for(;Qa<Ob.count;){const Ud=Object(ac.a)(Lb.a,Ob.getItem(Qa));if(0===Ud.zJ){for(Pc=
0;Pc<Cd&&this.QWi(Pc)!==Ud;Pc++);break}Qa++}return-1===Pc||Pc===Cd?-1:Pc}Eqg(Qa){var Ob=this.qkb(Qa);Ob&&(this.m1&&(w.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),E.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.n5()),this.ev.removeChild(Ob.domElement),Ob=Array.indexOf(this.So,Ob),this.So.splice(Ob,1),this.oca(),(!this.isRtl&&Ob===this.So.length||
this.isRtl&&!Ob)&&this.k8a(!0),this.iwc&&this.m1?Qa===this.Mba?(this.n5(),this.Bqa(6)):this.Iac():this.Bqa(6))}Fqg(Qa){const Ob=Object(ac.a)(Lb.a,Qa);this.m1&&(w.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),E.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.n5());if(0===Ob.zJ){this.k8a(!1);var Pc=this.zwa(Qa);-1===Pc&&(w.ULS.sendTraceTag(537153749,
0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.wtc(Ob,!1),Pc=this.zwa(Qa));this.kQf(Pc,!0)}}Bpk(Qa,Ob){const Pc=this.qkb(Qa);Pc&&(this.m1&&!Ob&&(w.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),E.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.n5()),Qa=this.CXk(Qa,Pc),!E.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&
Qa&&Ob&&Qa.j_j())}CXk(Qa,Ob){var Pc=Array.indexOf(this.So,Ob);const Cd=this.Xwi(Object(ac.a)(Lb.a,Qa));if(-1===Cd||-1===Pc)return null;this.k8a(!1);({Bxi:this.eP,wvj:this.Toa}=Hf.xpk(Pc,Cd,this.eP,this.Toa));Ob&&Ob.domElement.parentNode===this.ev&&(this.ev.removeChild(Ob.domElement),this.So.splice(Pc,1));Ob=this.Kwi(Qa);Ob=this.zwa(Ob);Pc=new Cf(this.$,this.ev,this.L_a(Ob),Object(ac.a)(Lb.a,Qa),this);this.n3e(Pc,Ob);Ob=this.zwa(Qa);this.kQf(Ob,!1);return Pc}qmi(){const Qa=this.So?this.So.length:0,
Ob=this.eP,Pc=this.Toa;for(let Cd=0;Cd<Qa;Cd++){const Ud=this.Baa(Cd),Wd=Cd>=Ob;Ud&&(Ud.tabIndex=Wd&&Cd<=Pc?0:-1)}}E6k(){const Qa=this.So?this.So.length:0;for(let Ob=0;Ob<Qa;Ob++){const Pc=this.Baa(Ob);Pc&&Pc.Rzb()}}kQf(Qa,Ob){Ob&&Qa<=this.eP&&this.eP++;this.qmi();this.k8a(!0);this.oca();this.iwc&&this.m1&&this.Iac()}vYc(Qa){const Ob=this.$.pX;if(Qa||this.isRtl!==Ob)this.isRtl=Ob,this.domElement.classList.remove(this.isRtl?Ja.a.qPb:Ja.a.rPb),this.domElement.classList.add(this.isRtl?Ja.a.rPb:Ja.a.qPb),
this.domElement.dir=this.isRtl?"rtl":"ltr",this.E6k();Qa||this.k8a(!0);for(Qa=0;Qa<this.TY.length;Qa++)0!==Qa&&3!==Qa&&4!==Qa&&5!==Qa&&this.eQg(Qa)}N7h(){const Qa=this.jre=document.createElement("div");Qa.className="ewa-stb-navarea";Qa.classList.add("ewa-stb-navarea-dimensions");this.domElement.appendChild(Qa);this.Alf(Qa,1,717,716);this.Alf(Qa,2,719,718);this.U2f&&(this.p8a=new Yd(this.$,this,Qa))}O7h(){const Qa=this.kre=document.createElement("div");Qa.className="ewa-stb-navareaextra";this.domElement.appendChild(Qa);
this.Mzd()}W8h(){const Qa=document.getElementById(Ya.a.vJk),Ob=document.getElementById(Ya.a.wJk);Qa&&!Ob&&w.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Qa.parentNode.id}. progressBar div has child: ${!!Qa.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(Ya.a.nZc)}`);const Pc=Ib.a.SZd(this.$);if(Pc&&Qa&&Ob)this.domElement.appendChild(Qa),this.dQa=Qa.firstChild,this.eQa=document.getElementById(Ya.a.nZc),
Ob.style.visibility="visible";else{const Cd=document.createElement("div"),Ud=document.createElement("div");Cd.className=Ja.a.Opi;Ud.className=Ja.a.Mpi;Ud.id=Ya.a.Zqe;Ud.style.display="none";const Wd=document.createElement("div");Wd.className=Ja.a.Ppi;const le=document.createElement("div");le.className=Ja.a.Npi;const Fa=document.createElement("div");Fa.className=Ja.a.Lpi;Ud.appendChild(Wd);Ud.appendChild(le);Ud.appendChild(Fa);Cd.appendChild(Ud);this.domElement.appendChild(Cd);this.dQa=Ud;this.eQa=
le;w.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Pc,Qa,Ob)}}eQg(Qa){var Ob=this.TY[Qa];if(Ob){const Pc=Ob.parentNode;this.AEg(Ob);Ob=dd.a(this.$)?this.Mwg[Qa]:this.S6d[Qa];this.TY[Qa]=this.svgIconProvider.Zna(Ob,12,12,Pc,24,24)}}AEg(Qa){(null===Qa||void 0===Qa?0:Qa.parentNode)&&Qa.parentNode.removeChild(Qa)}l5h(){const Qa=
this.uxb=document.createElement("div");Qa.className="ewa-stb-contentarea";this.domElement.appendChild(Qa);this.Y9h(Qa)}Y9h(Qa){const Ob=document.createElement("div");Ob.className="ewa-stb-tabarea";Ob.classList.add("ewa-stb-disable-scrollbar");this.$.printingEnabled||Ob.classList.add(jc.Vb);Qa.appendChild(Ob);this.ev=document.createElement("ul");Fe.DOMElementExtensions.pL(this.ev,Ya.a.Qrd,null,null);this.ev.className=jc.mb;Ob.appendChild(this.ev);this.F7h();this.cYe=document.createElement("div");this.oZc.id=
"SheetIconTooltipContainer";Ob.appendChild(this.oZc)}F7h(){const Qa=document.createElement("div"),Ob=document.createElement("div"),Pc=Pa.a.jFf(Ja.a.Gqi);Ob.className=Ja.a.iYh;Ob.appendChild(Pc);Qa.appendChild(Ob);Qa.className="ewa-stb-sheettabmoveindicator";Fe.DOMElementExtensions.setVisible(Qa,!1);this.ev.appendChild(Qa)}dAd(){const Qa=this.$.sa;for(let Ob=0,Pc=Qa.count;Ob<Pc;Ob++){const Cd=Object(ac.a)(Lb.a,Qa.getItem(Ob));0===Cd.zJ&&(this.wtc(Cd,!0),Cd.active&&Cd.activate({scenario:"createSheetTabs"}))}}uwd(){Pb.a.gj(this.So);
this.So=[];this.Toa=this.eP=0}Alf(Qa,Ob,Pc,Cd){const Ud=document.createElement("a");Qa.appendChild(Ud);Qa=this.S6d[Ob];this.TY[Ob]=this.jh(Ud,Ia.a.instance.ia(Cd),0,this.CJj[Ob],Ia.a.instance.ia(Pc),Qa);if(5===Ob||4===Ob)Fe.DOMElementExtensions.jP(this.TY[Ob],Ud,!1,"span").style.marginTop="10px";this.eQg(Ob);Pc=this.R6d[Ob]=this.pl.Yk(Ud);wd.a.instance.xa(zd.a.qj,Ud,le=>le.ctrlKey&&this.pQj(Ob)?!0:this.Gng(Ob));wd.a.instance.xa(zd.a.Co,Ud,()=>this.Hng());Bd.a.instance.xa(zd.a.ml,Ud,()=>this.Hng());
wd.a.instance.xa(zd.a.JB,Ud,()=>this.nwd());tc.a.instance.xa(zd.a.Ui,Ud,le=>13!==le.La.keyCode&&32!==le.La.keyCode||this.lyd?!1:(this.lyd=!0,this.Gng(Ob)));tc.a.instance.xa(zd.a.rk,Ud,le=>13===le.La.keyCode||32===le.La.keyCode?(this.lyd=!1,this.nwd()):!1);const Wd=this.m6e();Cd=le=>{"mouseup"===le.type&&this.m1||Pe.g(le);!Ud.classList.contains(Oc.a.NHa)&&Wd&&this.RWj(le,Ob)};Pc.Ba("mouseover",Cd);Pc.Ba("mouseout",Cd);Pc.Ba("focus",Cd);Pc.Ba("blur",Cd);Wd&&Pc.Ba("mouseup",Cd)}vkj(Qa){let Ob=!1;const Pc=
this.$.Bl;Pc&&(Ob=Zc.a.DY(Fe.DOMElementExtensions.getBoundingClientRect(Pc),Qa.clientPoint));return Ob}Iac(){if(!this.UX){w.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.UX=this.Sma.cloneNode(!0);if(!this.KKg(this.UX,this.Sma,!0,"UpdateDragAndDropState"))return;this.Sma.style.visibility="hidden";this.UX.classList.add("ewa-stb-tabs-ghost");this.UX.style.borderRightWidth="";this.$Cc=this.Bfa.clientPoint.x-this.Ofa.width/2;
this.UX.style.left=this.$Cc+"px";this.MM=this.zwa(this.Mba);0>this.MM&&w.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.iwc&&(this.MM=this.zwa(this.Mba));var Qa=Fe.DOMElementExtensions.getBoundingClientRect(this.ev);const Ob=Qa.x;Qa=Qa.x+Qa.width;let Pc=this.Bfa.clientPoint.x-this.Ofa.width/2;Pc=Math.min(Pc,Qa-this.Ofa.width);Pc=Math.max(Pc,Ob);this.UX.style.transform="translateX("+Math.abs(Pc-this.$Cc)*(this.$Cc<Pc?1:-1)+"px)";const Cd=this.Bfa.clientPoint.x>
this.KYb;let Ud=this.Bfa.clientPoint.x;Pc>=Qa-this.Ofa.width?(Ud=Qa-this.Ofa.width/2,this.lne()||this.GAa||(w.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.kRc=this.ev.scrollLeft,this.GAa=window.requestAnimationFrame(this.sMg))):Pc<=Ob?(Ud=Ob+this.Ofa.width/2,this.kne()||this.GAa||(w.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.kRc=this.ev.scrollLeft,this.GAa=window.requestAnimationFrame(this.rMg))):this.GAa&&(w.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.jve());this.Bfa.clientPoint.x!==this.KYb&&(this.Xve(Cd,Ud),this.KYb=this.Bfa.clientPoint.x);this.bed=!0}Xve(Qa,Ob){let Pc;for(;(()=>{let Cd=this.oii(Ob,Qa);({rqc:Pc}=Cd);return Cd})().returnValue;)this.n$b=Pc,this.mHh(Qa)}mHh(Qa){if(this.n$b){var Ob=(Qa?1:-1)*this.Ofa.width;
if(Qa&&!this.$.pX||!Qa&&this.$.pX){var Pc=this.Sma;var Cd=this.MM+1;var Ud=!0}else Pc=(Cd=this.Baa(this.MM+1))?Cd.domElement:null,Cd=this.MM-1,Ud=!1;if(this.KKg(this.n$b,Pc,Ud,"AnimateSheetSwap")){w.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.MM} and other sheet-index ${Cd}. amount of sheets in the bar: ${this.o8b} isMovingRight: ${Qa}`);0<=this.MM&&this.MM<this.So.length&&0<=Cd&&Cd<this.So.length?(Qa=this.So[Cd],this.So[Cd]=this.So[this.MM],
this.So[this.MM]=Qa):(w.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.So.length}, ghostIndex: ${this.MM}, swappedSheetIndex: ${Cd}`),this.n5());this.MM=Cd;var Wd=this.n$b;Wd.style.transform="translateX("+Ob+"px)";window.requestAnimationFrame(()=>{Wd.style.transform="translateX(0px)"})}}}KKg(Qa,Ob,Pc,Cd){const Ud=Wd=>Wd?`Node ID: ${Wd.id} , Node class: ${Wd.className}, Node name: ${Wd.nodeName},`:null;try{return this.ev.insertBefore(Qa,
Ob),!0}catch(Wd){return Qa=this.qkb(this.Mba),w.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",Qa?Qa!==this.bwc?"Changed":"NoChange":"Removed",Cd,Ud(Ob),Ud(Ob.parentNode),Ud(this.ev),Pc,
this.MM,this.o8b,Wd),this.n5(),!1}}oii(Qa,Ob){var Pc=this.$.pX===Ob?this.Baa(this.MM-1):this.Baa(this.MM+1);if(!Pc)return{returnValue:!1,rqc:null};Pc=Pc.domElement;const Cd=Fe.DOMElementExtensions.getBoundingClientRect(Pc);return this.Ofa?Ob?{returnValue:Qa+this.Ofa.width/2>=Cd.x+.5*Cd.width,rqc:Pc}:{returnValue:Qa-this.Ofa.width/2<=Cd.x+.5*Cd.width,rqc:Pc}:(w.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.n5(),{returnValue:!1,rqc:Pc})}pMg(Qa,Ob){let Pc;Pc=Ob?this.sMg:this.rMg;if(-1===this.h0c)this.h0c=Qa,this.GAa=window.requestAnimationFrame(Pc);else{Qa=Math.floor((Qa-this.h0c)/1E3*300);var Cd=this.l6b>this.hZb?1:-1;this.scrollLeft(Math.abs(this.ev.scrollLeft-(Ob?this.kRc+Qa*Cd:this.kRc-Qa*Cd))*(Ob?-1:1));if(Qa=this.pHf("ScrollStep"))this.Xve(Ob,Qa.x+Qa.width/2),Ob&&!this.lne()||!Ob&&!this.kne()?this.GAa=window.requestAnimationFrame(Pc):(w.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.jve())}}lne(){const Qa=this.l6b>this.hZb;return Qa&&this.qBa>=this.l6b||!Qa&&this.qBa<=this.l6b}kne(){const Qa=this.l6b>this.hZb;return Qa&&this.qBa<=this.hZb||!Qa&&this.qBa>=this.hZb}jve(Qa){Qa=void 0===Qa?!0:Qa;this.ev&&(this.qBa=this.ev.scrollLeft);window.cancelAnimationFrame(this.GAa);this.GAa=0;this.h0c=-1;Qa&&this.oca()}cpe(Qa,Ob){Qa||w.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${Ob}`);this.Ofa=Qa}pQj(Qa){return 2===
Qa?(this.Bqa(3),!0):1===Qa?(this.Bqa(0),!0):!1}Gng(Qa){w.ULS.shipAssertTag(537153732,0,-1===this.F5a&&-1===this.E5a,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.F5a&&(window.clearTimeout(this.F5a),this.F5a=-1);-1!==this.E5a&&(window.clearInterval(this.E5a),this.E5a=-1);this.Bqa(Qa);this.F5a=window.setTimeout(()=>{this.ZUk(Qa)},this.rJj);return!0}ZUk(Qa){this.E5a=window.setInterval(()=>{this.Bqa(Qa)},
this.qJj)}Hng(){this.nwd();return!this.m1}nwd(){window.clearTimeout(this.F5a);window.clearInterval(this.E5a);this.E5a=this.F5a=-1;return!0}RWj(Qa,Ob){const Pc=this.EWb(Ob),Cd=5===Ob;"mouseup"!==Qa.type||!Cd&&4!==Ob||(Pc||this.reorderSheets(null,Cd,!1),this.n5())}EWb(Qa){return!!Fe.DOMElementExtensions.LGf(this.TY[Qa],"a").title}m4c(Qa){this.EAe(Qa);this.oca()}EAe(Qa){(Qa=this.qkb(Qa))&&Qa.Rzb()}byk(){var Qa=this.$.sa;if(Qa.ma&&(!Lf.e(this.$)||Qa.count))if(Qa=this.zwa(Qa.ma),-1===Qa)w.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var Ob=this.L_a(Qa);Qa<this.eP?this.mXc(Qa):Qa>this.eP&&!this.b_d(Ob)&&this.scrollIntoView(Qa)}}Y7k(){this.eP=0;this.Toa=this.So.length-1;let Qa=!1;for(let Ob=0;Ob<this.So.length;Ob++){const Pc=this.Baa(Ob);if(!Pc)break;const Cd=this.b_d(Pc.domElement);Pc.tabIndex=Cd?0:-1;if(!Qa&&Cd)this.eP=Ob,Qa=!0;else if(Qa&&!Cd){this.Toa=Ob-1;break}}}mXc(Qa){this.$.sa.count&&(this.So.length||this.dAd(),this.hOg(this.L_a(Math.max(0,
Math.min(Qa,this.So.length-1)))),this.oca())}scrollIntoView(Qa){w.ULS.shipAssertTag(537153697,0,Qa>=this.eP,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.sa.count){this.So.length||this.dAd();var Ob=this.L_a(Math.max(0,Math.min(Qa,this.So.length-1))),Pc=this.L_a(this.eP);if(!this.b_d(Ob)){Ob=Fe.DOMElementExtensions.getBoundingClientRect(Ob);var Cd=Fe.DOMElementExtensions.getBoundingClientRect(this.uxb);Ob=this.isRtl?Cd.x-Ob.x:
Ob.x+Ob.width-(Cd.x+Cd.width);for(Cd=0;Pc&&Cd<Ob;){const Ud=Fe.DOMElementExtensions.getBoundingClientRect(Pc);Cd+=Ud.width;Pc=Pc.nextSibling}Pc?this.hOg(Pc):w.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.eP}, lastVisibleSheetTabIndex = ${this.Toa}, scroll to index: ${Qa}`)}this.oca()}}hOg(Qa){const Ob=Fe.DOMElementExtensions.getBoundingClientRect(this.ev);Qa=Fe.DOMElementExtensions.getBoundingClientRect(Qa);this.isRtl?
this.scrollLeft(Math.floor(Ob.x+Ob.width-(Qa.x+Qa.width+.5))):this.scrollLeft(Math.ceil(Ob.x-Qa.x-.5))}scrollLeft(Qa){(0>Qa&&this.lne()||0<Qa&&this.kne())&&w.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const Ob=this.ev.scrollLeft;if(this.isRtl){if(v.a.aJ||v.a.Am){this.ev.scrollLeft=this.qBa=Ob-Qa;return}if(v.a.vP){this.ev.scrollLeft=this.qBa=Ob+Qa;return}w.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.ev.scrollLeft=
this.qBa=Ob-Qa}b_d(Qa){Qa=Fe.DOMElementExtensions.getBoundingClientRect(Qa);const Ob=Fe.DOMElementExtensions.getBoundingClientRect(this.uxb);return Qa&&Ob?Qa.x>=Ob.x-1&&Qa.x+Qa.width<=Ob.x+Ob.width+1:(w.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}k8h(){const Qa=this.kre;Id.USg(this.$)?(Pb.a.dh(this.b1),this.b1=new Id(Qa,this.$,this,!0),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",
!1)&&(this.DFc=!1)):(Pb.a.dh(this.b1),Ed.l(this.$.Zk)?this.b1=new Gf(Qa,this.$,this):this.b1=new Id(Qa,this.$,this),E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(this.DFc=!0))}Jlf(Qa,Ob){var Pc=this.$.sa;if(!this.$.isEditMode||!Pc.count)Pb.a.dh(Ob),Ob=null;else if(!Ob)if(Pc=this.jre,Ed.l(this.$.Zk))Ob=new Gf(Pc,this.$,this);else switch(Qa){case 0:Ob=new Id(Pc,this.$,this);break;case 1:Ob=new ue(Pc,this.$,this);break;default:w.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return Ob}pHg(){this.qHg||(this.Abh()?Af.a.instance.tub(Ya.a.x2,["sheetTabBar"]):(this.$Ba.RWg||Af.a.instance.j2(Ya.a.x2,["sheetTabBar"]),this.$Ba.hXh(),Af.a.instance.zZ(Ya.a.x2,["sheetTabBar"])),Af.a.instance.wca(Ya.a.x2,["sheetTabBar"]),this.qHg=!0)}Mzd(){this.Jmj?(this.b1=this.Jlf(0,this.b1),this.XUb=this.Jlf(1,
this.XUb)):this.k8h()}pHf(Qa){const Ob=Fe.DOMElementExtensions.getBoundingClientRect(this.UX);Ob||(w.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Qa}: GetBoundingClientRect returned null for the dragged sheet.`),this.n5());return Ob}bQf(Qa,Ob){w.ULS.sendTraceTag(507646810,0,50,`SheetTabBarControl.handleRequestToChangeDisabledState: requestId=${Qa}, requestedState=${Ob}`);this.mIa.AIh(Qa,Ob);this.n5(!1);this.Epe(this.navigationButtonsDisabled);if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")){for(const Pc of this.h_g)Pc&&
Pc.X1c(this.navigationButtonsDisabled);for(const Pc of this.Qoc)Pc&&Pc.X1c(this.operationButtonsDisabled)}else{for(const Pc of this.h_g)Pc&&Pc.J2(this.navigationButtonsDisabled);for(const Pc of this.Qoc)Pc&&Pc.J2(this.operationButtonsDisabled)}}z_h(Qa,Ob){if(E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetTabCompareButtonsState",!1)){var Pc=!this.Zfe,Cd=!this.$fe;Pc===Ob.Xwg&&Cd===Ob.Ueg||Qa.push(`Sheet scroll buttons enabled mismatch. prevNavButtonEnabled: ${Pc} nextNavButtonEnabled: ${Cd}, cached prevNavButtonEnabled: ${Ob.Xwg} cached nextNavButtonEnabled: ${Ob.Ueg}`);
this.DFc!==Ob.CFc&&Qa.push(`New sheet button mismatch. insertSheetButtonEnabled: ${this.DFc}, skeletonNewSheetEnabled: ${Ob.CFc}`)}}static xpk(Qa,Ob,Pc,Cd){Qa<Pc?(Ob>Pc&&Pc--,Ob>Cd&&Cd--):Qa>Cd?(Ob<Pc&&Pc++,Ob<Cd&&Cd++):Ob<Pc&&Pc++;return{Bxi:Pc,wvj:Cd}}}Object(t.a)(Hf,"SheetTabBarControl",Fb.a,[887,4,47]);var $b=a(91);Object(W.b)(J.Yf,{Fk:"singleton"})(Qa=>Lo(function*(){const Ob=yield W.a.resolve(J.Nb,Qa);var Pc=Ob.xi;if(dc.a(Ob.ua,1))return Af.a.instance.Y6a(Ya.a.x2,["sheetTabBar"]),null;Pc=document.getElementById(Pc+
Ya.a.ouc);if(!Pc)return Af.a.instance.Y6a(Ya.a.x2,["sheetTabBar"]),null;Af.a.instance.PCa(Ya.a.x2);const Cd=Object($b.e)(Gc.GetServiceTaskFactory.Tj(Ob.la,388,387,null===Qa||void 0===Qa?void 0:Qa.va)),Ud=W.a.resolve(J.cg),[Wd,le]=yield Promise.all([Cd,Ud]);return new Hf(Ob,Pc,le,Wd)}));class Wb extends nc.a{constructor(Qa){super();this.$=Qa;this.gm()}create(){var Qa=this.$.xi;if(dc.a(this.$.ua,1))Af.a.instance.Y6a(Ya.a.x2,["sheetTabBar"]);else{var Ob=document.getElementById(Qa+Ya.a.ouc);if(Ob){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:8494154_FixSheetTabBarInitTime")&&
(Qa=this.$.la.kh(32))){this.Bk(Qa);return}Af.a.instance.PCa(Ya.a.x2);var Pc=Gc.GetServiceTaskFactory.Tj(this.$.la,388,387,this.xh),Cd=Object($b.d)(W.a.resolve(J.cg));C.TaskExtensions.Xa(C.TaskExtensions.Vo([Pc,Cd],this.$.ya),()=>{this.Bk(this.$.la.kh(32)||new Hf(this.$,Ob,Cd.result,Pc.result))},this.$.ya,3)}else Af.a.instance.Y6a(Ya.a.x2,["sheetTabBar"])}}static Ba(Qa){Qa.la.Hh(33,new Wb(Qa))}}Object(t.a)(Wb,"SheetTabBarFactory",nc.a,[]);var Dc=a(1122),Jf=a(1560),Rb;(function(Qa){Qa[Qa.unknown=0]=
"unknown";Qa[Qa.supported=1]="supported";Qa[Qa.Qvl=2]="userUnsupportedAnonymous";Qa[Qa.Rvl=3]="userUnsupportedNoLoginHint";Qa[Qa.Tml=4]="hostUnsupported";Qa[Qa.Ztl=5]="perfAutomation"})(Rb||(Rb={}));Object(t.b)("SupportStatus",Rb);var Gb;(function(Qa){Qa[Qa.external=0]="external";Qa[Qa.Xnl=1]="msa";Qa[Qa.Nkl=2]="aad"})(Gb||(Gb={}));Object(t.b)("AuthorityType",Gb);var Cc=a(969);class cb{constructor(Qa){this.Aph=Qa}initialize(){return Promise.resolve(0)}OLc(){return Promise.resolve(0)}gE(){w.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new Cc.a,{IsSuccess:!0,Token:this.Aph}))}A2c(){return Promise.resolve(Object.assign(new Cc.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}nEc(){}V0c(){return!1}ISb(){return"MockAuthTokenStrategy"}}Object(t.a)(cb,"MockAuthTokenStrategy",null,[906]);var pc=a(1174);class Ic{static get(Qa,Ob,Pc){if(!Pc)return Qa;
let Cd=0;return Promise.race([Qa,new Promise(Ud=>{Cd=window.setTimeout(()=>{Ud(Ob)},Pc)})]).then(Ud=>{window.clearTimeout(Cd);return Promise.resolve(Ud)}).catch(()=>{window.clearTimeout(Cd);return Promise.resolve(Ob)})}}Object(t.a)(Ic,"PromiseWithTimeout",null,[]);var rd=a(602);class Rd{constructor(Qa,Ob,Pc,Cd,Ud){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=Qa;this.scope=Ob;this.silentLogin=Pc;this.options=Cd;this.correlationId=Ud}}Object(t.a)(Rd,
"TokenRequestParameters",null,[297]);class va{constructor(){this.p0e=null;let Qa=$a.AFrameworkApplication.fa.Ya($a.AFrameworkApplication.a_),Ob=$a.AFrameworkApplication.fa.Ya($a.AFrameworkApplication.I3g);this.Ddb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Qa&&""!==Qa?Qa:"Unspecified",Ob&&""!==Ob?Ob:"Unspecified")}initialize(){return new Promise(Qa=>{Ca.a.instance.fj("Common.App.WopiIdentity.IWopiIdentity").execute(Ob=>{this.p0e=Ob;Qa(0)})})}cr(Qa){const Ob=["HTTPS:",
"API:"];let Pc=!1;const Cd=Qa.toLocaleUpperCase();for(const Ud of Ob)if(Cd.startsWith(Ud)){Pc=!0;break}return Pc||this.amj(Qa)?Qa+"/.default":Qa}amj(Qa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Qa)}OLc(){return Promise.resolve(0)}gE(Qa,Ob,Pc,Cd,Ud,Wd,le){if(v.a.ZLa){Ud=rd.a.hel;if(!Ud)return Ob=Object.assign(new Cc.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ob);if(!Array.contains(Ud,
Qa))return Ob=Object.assign(new Cc.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Qa}),Promise.resolve(Ob)}Qa=this.cr(Pc);Pc=new Rd(Pc,Qa,!Cd,null,$a.AFrameworkApplication.userSessionId);return this.p0e.getAccessToken(Pc,Ob,le).then(Fa=>Object.assign(new Cc.a,{IsSuccess:!0,Token:Fa.accessToken}),Fa=>Object.assign(new Cc.a,{IsSuccess:!1,ErrorCode:Fa}))}A2c(){return Promise.resolve(Object.assign(new Cc.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}nEc(){}V0c(){return!1}ISb(){return this.Ddb}}Object(t.a)(va,"ParentFrameTokenStrategy",null,[906]);var Bb=a(1170);class Ac{constructor(){this.reject=this.resolve=null;this.startTime=0;this.syg=this.Soc=null}}Object(t.a)(Ac,"PromiseWrapper",null,[]);class Nc{constructor(Qa){Qa=void 0===Qa?0:Qa;this.LL=0;this.gFb=!1;this.jw=new ba.a;this._timeout=Qa}enqueue(Qa){return new Promise((Ob,Pc)=>{this.jw.add(Object.assign(new Ac,
{syg:Qa,resolve:Ob,reject:Pc}));this.process()})}process(){if(this.gFb||this.LL===this.jw.count)return!1;const Qa=this.jw.na(this.LL++);try{this.gFb=!0,Qa.syg().then(Ob=>{this.gFb=!1;this.Kxd(Qa,Ob,null,!0)}).catch(Ob=>{this.gFb=!1;this.Kxd(Qa,null,Ob,!1)})}catch(Ob){this.gFb=!1,this.Kxd(Qa,null,Ob,!1)}return!0}Kxd(Qa,Ob,Pc,Cd){if(Cd){const Ud=()=>{Qa.resolve(Ob);this.process()};0<this._timeout?window.setTimeout(()=>{Ud()},this._timeout):Ud()}else{const Ud=()=>{Qa.reject(Pc);this.process()};0<this._timeout?
window.setTimeout(()=>{Ud()},this._timeout):Ud()}}}Object(t.a)(Nc,"PromiseQueue",null,[]);class hd{constructor(){this.correlationId=this.resolve=null}}Object(t.a)(hd,"ResolveWithCorrelation",null,[]);var qd=a(958),je=a(144),Ie=a(22);class Oe extends ua.a{constructor(Qa,Ob,Pc,Cd,Ud,Wd,le){le=void 0===le?!1:le;super(!1,!1,!0);this.vKe=this.Fda=null;this.f_j=()=>{this.DBf()};this.s6h=()=>this.qD;this.lJk=Fa=>{0===Fa&&(this.Uuh.reject(Object.assign(new Cc.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),
this.zTa(null))};this.O3=Qa;this.drh=Pc;this.tF=Cd;this.Uuh=Ud;this.zTa=Wd;this.qD=document.createElement("iframe");this.qD.id="SharedAuthInteractiveFrame";this.qD.setAttribute("name","SharedAuthInteractiveFrame");this.qD.setAttribute("title","SharedAuthInteractiveFrame");this.qD.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.qD.style.border="0";this.qD.style.height="48px";this.qD.style.width="190px";$addHandler(this.qD,"error",this.f_j);Qa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",
this.O3,Ob,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",le?"&msalv3=1":"","&WacUserType=",$a.AFrameworkApplication.userType);this.qD.src=Qa;this.ukh=new Promise(Fa=>{this.vKe=Fa});this.wKe=!1}Ose(){this.Fda={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.drh,["errorText"]:Object(Ie.a)("InternalError"),["rtl"]:$a.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.s6h,["resolveDialogStyles"]:this.vKe}};this.Ph=5;this.initializeAndShow(Object(Ie.a)("SignIn"),
this.lJk,this.Fda)}r$a(Qa,Ob,Pc){Qa=void 0===Qa?!1:Qa;Ob=void 0===Ob?!1:Ob;Pc=void 0===Pc?5:Pc;this.Fda&&this.Fda.bodyControls&&(Qa!==Object(ac.a)(Object,this.Fda.bodyControls).frameLoaded&&(Object(ac.a)(Object,this.Fda.bodyControls).frameLoaded=Qa),Ob!==Object(ac.a)(Object,this.Fda.bodyControls).frameLoadSuccess&&(Object(ac.a)(Object,this.Fda.bodyControls).frameLoadSuccess=Ob),Pc!==this.Fda.dialogButtonsOption&&(this.Fda.dialogButtonsOption=null,this.Ph=Pc),this.update(this.Fda))}jRk(Qa,Ob){const Pc=
new qd.a(je.a.pJk);Qa={["signInLabel"]:Object(Ie.a)("SignIn"),["cancelLabel"]:Object(Ie.a)("DialogCancel"),["rtl"]:$a.AFrameworkApplication.isRtl,["messageCorrelationId"]:Qa,["dialogStyles"]:Ob};Pc.Values=Qa;this.tF.Zia(Pc,this.qD.contentWindow,this.O3)}DBf(){this.r$a(!0,!1,6)}get XRg(){return this.qD}get dfi(){return this.ukh.then(Qa=>{this.wKe=!0;return Qa})}get efi(){return this.wKe}}Object(t.a)(Oe,"SharedAuthConsentDialog",ua.a,[921]);var Vb=a(1067),fd=a(107),Qd=a(202),me=a(189);class se{}se.Gw=
"OAuthManager";Object(t.a)(se,"OAuthManagerConstants",null,[]);class Ne{constructor(){this.qD=null;this.agc=0;this.y3=this.Udb=this.d8c=this.zTa=this.lX=this.d_e=null;this.fVj=()=>{const Qa=Zc.a.Dj()-this.agc;w.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Qa)};this.xPc=Qa=>{const Ob=Zc.a.Dj()-this.agc,Pc=Object.assign({},{durationMs:Ob});fd.Health.instance.recordKpiFailure(se.Gw,"SharedAuthWACOAuthAspxFrameError",!1,!0,Pc);w.ULS.sendTraceTag(572346567,3E3,
10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",Ob,this.mLe?JSON.stringify(Qa):"")};this.zZj=Qa=>{const Ob=this.fea.loadFrame;var Pc=Zc.a.Dj()-Ob.startTime,Cd=Qa.Values.AuthLibrary.toString();Qa=Qa.Values.Success.toString();w.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Qa,Cd,Pc);Cd&&(this.Ddb="SharedAuthTokenStrategy "+Cd);Cd=Boolean.parse(Qa);Cd||(Qa=Qd.a.wy(),void 0!==Qa&&null!==Qa&&(Qa.set("AuthLibrary",this.ISb()),
Pc=Object.assign({},{durationMs:Pc,extendedProperties:Qa}),fd.Health.instance.recordKpiFailure(se.Gw,"SharedAuthStrategyInitFailed",!1,!0,Pc)));Ob.resolve(Cd?0:1)};this.yZj=Qa=>{if(Qa.Values.interactive&&this.Udb&&this.Udb.Values.messageCorrelationId){const Pc=this.Udb.Values.messageCorrelationId.toString();if(Qa.Values.interactive&&this.lX){this.lX.dfi.then(Cd=>{this.tF.Zia(this.Udb,this.lX.XRg.contentWindow,this.O3);this.lX.jRk(Pc,Cd);this.lX.r$a(!0,!0);this.Udb=null});return}}Qa=this.fea.initFrame;
const Ob=Zc.a.Dj()-Qa.startTime;w.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ob);Qa.resolve(0)};this.HUj=Qa=>{if(Qa.Values.messageCorrelationId&&Qa.Values.messageCorrelationId.toString()){var Ob=Qa.Values.messageCorrelationId.toString(),Pc=this.fea[Ob];if(Pc){var Cd=Zc.a.Dj()-Pc.startTime;w.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",Cd);Qa.Values.isSuccess&&Qa.Values.isSuccess?Pc.resolve(Qa.Values.response):
Pc.reject(Qa.Values.response);this.m3g(Ob)}else w.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else w.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.CVj=()=>{if(this.lX.efi)this.lX.DBf();else if(this.d8c&&this.lX){const Qa=new qd.a(je.a.$Rg);Qa.Values=this.Z9e(this.d8c,!0);this.tF.Zia(Qa,this.lX.XRg.contentWindow,this.O3)}};this.$Uj=()=>
{this.lX&&this.lX.Omb()};this.nPj=Qa=>{if(Qa.Values.cancelled&&Qa.Values.cancelled&&Qa.Values.messageCorrelationId){Qa=Qa.Values.messageCorrelationId.toString();const Ob=this.fea[Qa];if(Ob){const Pc=new Cc.a;Pc.ErrorCode="UserCancelled";Pc.ErrorMessage="The interactive flow was cancelled by the user";Ob.reject(Pc)}this.m3g(Qa)}this.lX&&this.lX.hide()};this.rWj=Qa=>{if(Qa.Values.messageCorrelationId&&Qa.Values.messageCorrelationId.toString()){var Ob=this.fea[Qa.Values.messageCorrelationId.toString()];
if(Ob){var Pc=Zc.a.Dj()-Ob.startTime;w.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",Pc);Qa.Values.isSuccess&&Qa.Values.isSuccess?Ob.resolve(Qa.Values.response):Ob.reject(Qa.Values.response)}else w.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else w.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.tF=
new Vb.a(null,null);this.Ddb="SharedAuthTokenStrategy Unloaded";this.O3=rd.a.nJk;this.YXe=rd.a.mJk;rd.a.Fqe&&""!==rd.a.Fqe&&(this.ZXe=this.O3+rd.a.Fqe);this.mLe=rd.a.enableConsoleLogging;this.Rkh=$a.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.pth=$a.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.A_e=$a.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedMsalV3Enabled",
!1);this.fea={};this.onh=new Nc(1500)}ISb(){return this.Ddb}initialize(){if("loadFrame"in this.fea)return this.fea.loadFrame.Soc;if(!this.O3)return fd.Health.instance.recordKpiFailure(se.Gw,"SharedAuthFrameOriginNotSet",!1,!1,null),w.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const Qa=this.A0c("loadFrame");this.agc=Zc.a.Dj();var Ob=this.O3+this.YXe+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+
$a.AFrameworkApplication.userSessionId+"&WacUserType="+$a.AFrameworkApplication.userType;this.A_e&&(Ob+="&msalv3=1");this.qD=document.createElement("iframe");this.aya(this.qD);this.qD.style.cssText="height:0;width:0;display:none;";this.qD.id="SharedAuthFrame";this.qD.setAttribute("name","SharedAuthFrame");this.qD.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.qD.src=Ob;document.body.appendChild(this.qD);Ob=Zc.a.Dj()-this.agc;w.ULS.sendTraceTag(573112899,3E3,
50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}.",Ob,this.qD.src);return Qa}OLc(Qa){this.d8c=Qa;const Ob=new qd.a(je.a.$Rg);Ob.Values=this.Z9e(Qa);Qa=this.A0c("initFrame");this.tF.Zia(Ob,this.qD.contentWindow,this.O3);w.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Qa}gE(Qa,Ob,Pc,Cd,Ud,Wd){const le=new qd.a(je.a.qJk),Fa=this.$Kf();le.Values=this.c3g(Qa,Ob,Pc,Cd,Ud,Wd,Fa);Qa=this.A0c(Fa);Cd?(Wd&&
0!=Wd.length||(Wd=Object(Ie.a)("WAC_OAuth_CompleteSignIn_Body")),this.onh.enqueue(()=>new Promise(mb=>{this.D3k(Wd,le,mb,Fa)}))):(this.tF.Zia(le,this.qD.contentWindow,this.O3),w.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ob));return Qa}D3k(Qa,Ob,Pc,Cd){const Ud=this.fea[Cd];Ud&&(this.Udb=Ob,this.zTa=Object.assign(new hd,{resolve:Pc,correlationId:Cd}),this.lX=new Oe(this.O3,this.YXe,Qa,this.tF,Ud,Pc,this.A_e),this.lX.Ose())}$Kf(){return me.a.create().toString()}c3g(Qa,
Ob,Pc,Cd,Ud,Wd,le){const Fa={};Fa.appName=Qa;Fa.appId=Ob;Fa.target=Pc;Fa.withPopup=Cd;Fa.claims=Ud;Fa.promptMessage=Wd;Fa.messageCorrelationId=le;return Fa}aya(Qa){$addHandler(Qa,"load",this.fVj);$addHandler(Qa,"error",this.xPc);this.tF.sX(this.O3);this.tF.kr(je.a.cSg);this.tF.aq(je.a.cSg,this.zZj);this.tF.kr(je.a.bSg);this.tF.aq(je.a.bSg,this.yZj);this.tF.kr(je.a.YRg);this.tF.aq(je.a.YRg,this.HUj);this.tF.kr(je.a.dSg);this.tF.aq(je.a.dSg,this.rWj);this.tF.kr(je.a.aSg);this.tF.aq(je.a.aSg,this.CVj);
this.tF.kr(je.a.ZRg);this.tF.aq(je.a.ZRg,this.$Uj);this.tF.kr(je.a.WRg);this.tF.aq(je.a.WRg,this.nPj)}A0c(Qa){const Ob=new Ac;Ob.startTime=Zc.a.Dj();const Pc=new Promise((Cd,Ud)=>{Ob.resolve=Cd;Ob.reject=Ud});Ob.Soc=Pc;this.fea[Qa]=Ob;return Pc}Z9e(Qa,Ob){Ob=void 0===Ob?!1:Ob;const Pc={};Pc.appIds=this.HEi();Pc.upn=Qa.loginHint;Pc.authority=Qa.authority;Pc.authorityType=Object(Jf.a)(Gb,Qa.authorityType);Pc.tenantId=Qa.tenantId;Pc.correlationId=$a.AFrameworkApplication.userSessionId;Pc.enableConsoleLogging=
this.mLe;Pc.enablePopupFlash=this.Rkh;Pc.skipUpnCheck=this.pth;Pc.interactive=Ob;this.ZXe&&(Pc.redirectUri=this.ZXe);return Pc}HEi(){const Qa=[],Ob=rd.a.ard;for(const Cd in Ob){var Pc=Ob[Cd];Array.contains(Qa,Pc)||Array.add(Qa,Pc)}return Qa}A2c(Qa,Ob,Pc,Cd,Ud,Wd){const le=new qd.a(je.a.oJk),Fa=this.$Kf();le.Values=this.c3g(Qa,Ob,Pc,Cd,Ud,Wd,Fa);this.d_e=le;Qa=this.A0c(Fa);w.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ob);this.uOk(Fa);return Qa}V0c(){return!0}nEc(){var Qa;
this.y3&&(null===(Qa=$a.AFrameworkApplication.ra.businessBar)||void 0===Qa?void 0:Qa.removeEntry(this.y3))}uOk(Qa){if(!this.y3){this.y3=new Bb.a(Object(Ie.a)("WAC_OAuth_CompleteSignIn_Title"),Object(Ie.a)("WAC_OAuth_CompleteSignIn_Body"),null);this.y3.id=16;this.y3.TXd=!1;this.y3.Osd=0;this.y3.closeable=!0;var Ob=!1;this.y3.LX=()=>{if(!Ob){const Pc=this.fea[Qa];if(Pc){const Cd=new Cc.a;Cd.ErrorCode="UserCancelled";Cd.ErrorMessage="The interactive flow was cancelled by the user";Pc.reject(Cd)}}};this.y3.addButton(Object(Ie.a)("WAC_OAuth_CompleteSignIn_Button"),
()=>{w.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");Ob=!0;this.tF.Zia(this.d_e,this.qD.contentWindow,this.O3);this.y3=void 0},Object(Ie.a)("WAC_OAuth_CompleteSignIn_Button"),!0);if(!$a.AFrameworkApplication.ra.$g.Xlc(this.y3)){w.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user.");this.y3=void 0;const Pc=this.fea[Qa];if(Pc){const Cd=new Cc.a;Cd.ErrorCode="Cookies Disabled";Cd.ErrorMessage="Interaction Required - Current App Context does not support Business Bar";
Pc.reject(Cd)}}}}m3g(Qa){this.zTa&&this.zTa.correlationId===Qa&&(this.zTa.resolve(null),this.zTa=null)}}Object(t.a)(Ne,"SharedAuthTokenStrategy",null,[906]);class Ue{constructor(Qa){this.Fid=Qa;this.Ddb="UnsupportedAuthTokenStrategy Reason="+Rb[this.Fid]}initialize(){return Promise.resolve(0)}OLc(){return Promise.resolve(0)}gE(){return Promise.resolve(Object.assign(new Cc.a,{IsSuccess:!1,ErrorCode:Rb[this.Fid],ErrorMessage:"Unable to get a token. Reason: ["+Rb[this.Fid]+"]"}))}A2c(){return Promise.resolve(Object.assign(new Cc.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}nEc(){}V0c(){return!1}ISb(){return this.Ddb}}Object(t.a)(Ue,"UnsupportedAuthTokenStrategy",null,[906]);var nf=a(928),tb=a(357);class lc{constructor(Qa){Qa=void 0===Qa?null:Qa;this.DQ=0;this.NT=null;this.Lrh=0;this.xPe=!!window.location.search.match(RegExp("wdpa=1","gi"));const Ob=Zc.a.Dj();var Pc=new Cc.a;Pc.ErrorCode=lc.j6c;this.Xid=Promise.resolve(Pc);
const Cd=new Ac;Cd.startTime=Zc.a.Dj();Pc=new Promise((Ud,Wd)=>{Cd.resolve=Ud;Cd.reject=Wd});Cd.Soc=Pc;this.eVe=Cd;this.dnh=this.uei(Qa).then(Ud=>Ud?this.T$i():(w.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.sB(),Math.floor(Zc.a.Dj()-Ob)),Ud=Qd.a.wy(),void 0!==Ud&&null!==Ud&&(Ud.set("AuthLibrary",this.sB()),Ud=Object.assign({},{durationMs:Math.floor(Zc.a.Dj()-Ob),extendedProperties:Ud}),fd.Health.instance.recordKpiFailure(se.Gw,
"StrategyPickFailed",!1,!0,Ud)),Promise.resolve(1))).then(Ud=>0!==Ud?Promise.resolve(Ud):this.Bxj())}vei(){if(this.xPe)this.DQ=5,this.NT=new Ue(this.DQ);else{var Qa=rd.a.cHj;Qa&&0<Qa.length?(this.DQ=1,this.NT=new cb(Qa)):$a.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||$a.AFrameworkApplication.fa.ka("IsO365CommercialHost")?$a.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.DQ=2,this.NT=new Ue(this.DQ)):(Qa=pc.a.getAuthContext().loginHint)&&Qa.length?rd.a.cUb?(this.DQ=1,this.NT=new va):(this.DQ=
1,this.NT=new Ne):(this.DQ=3,this.NT=new Ue(this.DQ)):(this.DQ=4,this.NT=new Ue(this.DQ))}}sB(){return this.NT?this.NT.ISb()||"Unknown":"None"}uei(Qa){Qa=void 0===Qa?null:Qa;w.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const Ob=Zc.a.Dj();return $a.AFrameworkApplication.fa.dMd().then(Pc=>{Pc?(this.vei(),Qa&&(this.NT=Qa),w.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",rd.a.clientVersion,
rd.a.appVersion,rd.a.uhi,this.sB(),Math.floor(Zc.a.Dj()-Ob))):w.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(Zc.a.Dj()-Ob));return Promise.resolve(Pc)},()=>{w.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(Zc.a.Dj()-Ob));return Promise.resolve(!1)})}T$i(){w.ULS.sendTraceTag(573390991,
3E3,50,"Initializing {0}",this.sB());const Qa=Zc.a.Dj();return Ic.get(this.NT.initialize(),2,rd.a.Zee).then(Ob=>{if(0===Ob)w.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.sB(),Math.floor(Zc.a.Dj()-Qa));else if(1===Ob){w.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.sB(),Math.floor(Zc.a.Dj()-Qa));var Pc=Qd.a.wy();void 0!==Pc&&null!==Pc&&(Pc.set("AuthLibrary",this.sB()),Pc=Object.assign({},
{durationMs:Math.floor(Zc.a.Dj()-Qa),extendedProperties:Pc}),fd.Health.instance.recordKpiFailure(se.Gw,"StrategyInitFailed",!1,!0,Pc))}else 2===Ob&&(w.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.sB(),Math.floor(Zc.a.Dj()-Qa)),Pc=Qd.a.wy(),void 0!==Pc&&null!==Pc&&(Pc.set("AuthLibrary",this.sB()),Pc=Object.assign({},{durationMs:Math.floor(Zc.a.Dj()-Qa),extendedProperties:Pc}),fd.Health.instance.recordKpiFailure(se.Gw,
"StrategyInitTimedOut",!1,!0,Pc)));return Promise.resolve(Ob)},()=>{w.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.sB(),Math.floor(Zc.a.Dj()-Qa));return Promise.resolve(1)})}Bxj(){w.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.sB());const Qa=Zc.a.Dj();return Ic.get(this.NT.OLc(pc.a.getAuthContext()),2,rd.a.Zee).then(Ob=>{if(0===Ob)w.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.sB(),
Math.floor(Zc.a.Dj()-Qa));else if(1===Ob){w.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.sB(),Math.floor(Zc.a.Dj()-Qa));var Pc=Qd.a.wy();void 0!==Pc&&null!==Pc&&(Pc.set("AuthLibrary",this.sB()),Pc=Object.assign({},{durationMs:Math.floor(Zc.a.Dj()-Qa),extendedProperties:Pc}),fd.Health.instance.recordKpiFailure(se.Gw,"StrategyLoadFailed",!1,!0,Pc))}else 2===Ob&&(w.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.sB(),Math.floor(Zc.a.Dj()-Qa)),Pc=Qd.a.wy(),void 0!==Pc&&null!==Pc&&(Pc.set("AuthLibrary",this.sB()),Pc=Object.assign({},{durationMs:Math.floor(Zc.a.Dj()-Qa),extendedProperties:Pc}),fd.Health.instance.recordKpiFailure(se.Gw,"StrategyLoadTimedOut",!1,!0,Pc)));return Promise.resolve(Ob)},()=>{w.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.sB(),Math.floor(Zc.a.Dj()-Qa));return Promise.resolve(1)})}gE(Qa,Ob,Pc,Cd){return this.cRa(Qa,
Ob,!1,Cd,"",void 0===Pc?null:Pc)}y2c(Qa,Ob,Pc,Cd,Ud){return this.cRa(Qa,Ob,!0,Pc,Cd,void 0===Ud?null:Ud)}cRa(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa){le=void 0===le?0:le;Fa=void 0===Fa?0:Fa;le+=1;w.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",Qa,this.A7a(Qa,Ob),this.sB(),le);var mb=Qd.a.wy();void 0!==mb&&null!==mb&&(mb.set("AuthLibrary",this.sB()),mb.set("AppName",Qa),mb.set("Target",this.A7a(Qa,Ob)),fd.Health.instance.recordKpiUsage(se.Gw,
tb.b.FailureBased,"WacOAuthFC",mb));if(!rd.a.isEnabled||this.xPe){var e;return this.V2d((e=new Cc.a,e.IsSuccess=!1,e.Token=null,e.ErrorCode="NotEnabled",e.ErrorMessage="OAuthManager is disabled.",e),Qa)}const Ra=rd.a.ard[Qa];if(void 0===Ra||null===Ra){w.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",Qa);var O;return this.V2d((O=new Cc.a,O.IsSuccess=!1,O.Token=null,O.ErrorCode="DisallowedApp",O.ErrorMessage="Disallowed appName: "+
Qa,O),Qa)}const qa=Zc.a.Dj();let ob=qa;const R=this;mb=this.dnh.then(ma=>{ob=Zc.a.Dj();return R.igj(Qa,Ra,Ob,1==le?!1:Pc,Cd,Ud,Wd,ma)});e=Pc?0:rd.a.Zee;let Za;O=(Za=new Cc.a,Za.IsSuccess=!1,Za.Token=null,Za.ErrorCode="authTokenStrategy_timeout",Za.ErrorMessage="Auth Strategy timed out after ["+e+"] ms when fetching token",Za);const Cb=this,rc=this;return Ic.get(mb,O,e).then(ma=>{if(le<=lc.DFj&&(ma.ErrorCode===lc.lFe||ma.ErrorCode===lc.gLh))return w.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",
le,Math.floor(Zc.a.Dj()-qa)),Cb.cRa(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa|4);if(ma.ErrorCode===lc.I6c||ma.ErrorCode===lc.Bcc){w.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken failed with ITP error.  Fallback Flow Enabled: [{0}], Popup Requested [{1}]",lc.htf,Pc);if(Pc)return Cb.cRa(Qa,Ob,!0,Cd,Ud,Wd,le,Fa|32);if(lc.ifj(Ra))return this.Xid=this.Xid.then(qb=>{if(qb.IsSuccess)return Cb.cRa(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa|8);if(qb.ErrorCode===lc.j6c||qb.ErrorCode===lc.I6c)return Cb.BWf(Qa,Ra,Ob,Pc,Cd,Ud,Wd,qa,ob,Fa|16).then(Xb=>
Xb.ErrorCode===lc.Bcc?Cb.cRa(Qa,Ob,!0,Cd,Ud,Wd,le,Fa|32):Xb);if(qb.ErrorCode===lc.Bcc)return Cb.cRa(Qa,Ob,!0,Cd,Ud,Wd,le,Fa|32);if(qb.ErrorCode===lc.qFe)return qb}).catch(()=>Cb.BWf(Qa,Ra,Ob,Pc,Cd,Ud,Wd,qa,ob,Fa))}return Promise.resolve(Cb.iMc(ma,Qa,Ob,Ra,qa,ob,Fa,le))}).catch(()=>{let ma;const qb=(ma=new Cc.a,ma.IsSuccess=!1,ma.Token=null,ma.ErrorCode="authTokenStrategy_failure",ma.ErrorMessage="Auth Strategy failed with an unknown error",ma);return Promise.resolve(rc.iMc(qb,Qa,Ob,Ra,qa,ob,Fa,le))})}BWf(Qa,
Ob,Pc,Cd,Ud,Wd,le,Fa,mb,e){const Ra=new Cc.a;Ra.IsSuccess=!1;if(!this.NT.V0c())return Ra.ErrorCode="authTokenStrategy_loginNotSupported",Ra.ErrorMessage="This Token Strategy does not support login flow, TryLogin could not be completed",Promise.resolve(Ra);const O=this.NT.A2c(Qa,Ob,Pc,Cd,Ud,Wd).then(ob=>Promise.resolve(this.eOc(ob,!0,Qa))).catch(ob=>Promise.resolve(this.eOc(ob,!1,Qa))).then(ob=>{e|=16;return Promise.resolve(this.iMc(ob,Qa,Pc,Ob,Fa,mb,e))}).catch(()=>{Ra.ErrorCode="authTokenStrategy_failure";
Ra.ErrorMessage="LoginPopup failed, GetToken could not be called";e|=16;return Promise.resolve(this.iMc(Ra,Qa,Pc,Ob,Fa,mb,e))}),qa=this.eVe.Soc.then(()=>this.cRa(Qa,Pc,Cd,Ud,Wd,le,0,e|8));return Promise.race([qa,O])}igj(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa){return 1===Fa||2===Fa?this.V2d(Object.assign(new Cc.a,{IsSuccess:!1,Token:null,ErrorCode:1===Fa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Qa):this.NT.gE(Qa,Ob,Pc,Cd,Ud,Wd,le).then(mb=>{if(Cd){const e=new Cc.a;e.IsSuccess=
!0;this.NT.nEc();this.eVe.resolve(e)}return Promise.resolve(this.eOc(mb,!0,Qa))}).catch(mb=>Promise.resolve(this.eOc(mb,!1,Qa)))}iMc(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa){le=void 0===le?0:le;Fa=void 0===Fa?0:Fa;var mb;const e={},Ra=Zc.a.Dj()-Wd;e.IsSuccess=Qa.IsSuccess;e.ErrorCode=Qa.IsSuccess?"Success":Qa.ErrorCode||"";e.ErrorMessage=Qa.IsSuccess?"Success":this.A7a(Ob,Qa.ErrorMessage||"");e.Target=this.A7a(Ob,Pc||"");e.TimeInMS=Math.floor(Ra);e.LoadTimeInMS=Math.floor(Wd-Ud);e.AuthLibrary=this.sB();e.AppName=
Ob;e.AuthorityType=Object(Jf.a)(Gb,pc.a.Pzc());e.UserType=this.l_i(pc.a.getAuthContext());e.IsAuthSupportedInSession=Rb[this.DQ];e.RequestCount=++this.Lrh;e.AppId=Cd;e.RetryCount=Fa;Qa.IsSuccess&&(le=(null===(mb=Qa.Telemetry)||void 0===mb?0:mb.fromCache)?le|1:le|2);e.Type=le;w.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(e));Pc=Qd.a.wy();Qa.IsSuccess?void 0!==Pc&&null!==Pc&&(Pc.set("AppName",Ob),Pc.set("AuthLibrary",this.sB()),Pc.set("RetryCount",Fa.toString()),Pc.set("Type",le.toString()),Ob=
Object.assign({},{durationMs:Ra,extendedProperties:Pc}),fd.Health.instance.recordKpiSuccess(se.Gw,Ob)):void 0!==Pc&&null!==Pc&&(Pc.set("AppName",Ob),Pc.set("AuthLibrary",this.sB()),Pc.set("ErrorCode",Qa.ErrorCode),Pc.set("ErrorMessage",this.A7a(Ob,Qa.ErrorMessage)),Pc.set("Type",le.toString()),Ob=Object.assign({},{durationMs:Ra,extendedProperties:Pc}),fd.Health.instance.recordKpiFailure(se.Gw,"TryGetTokenFailure",!1,!0,Ob));return Qa}V2d(Qa,Ob){w.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",
Ob,this.A7a(Ob,Qa.ErrorMessage));const Pc=Qd.a.wy();void 0!==Pc&&null!==Pc&&(Pc.set("AppName",Ob),Pc.set("AuthLibrary",this.sB()),Pc.set("ErrorCode",Qa.ErrorCode),Pc.set("ErrorMessage",this.A7a(Ob,Qa.ErrorMessage)),Ob=Object.assign({},{extendedProperties:Pc}),fd.Health.instance.recordKpiFailure(se.Gw,"FailureBeforeGetToken",!1,!0,Ob));return Promise.resolve(Qa)}MZf(Qa){return Qa===nf.a.Jyb}A7a(Qa,Ob){return this.MZf(Qa)&&Ob?"REDACTED":Ob}l_i(Qa){return $a.AFrameworkApplication.fa.ka("IsAnonymousUser")?
"anonymous":!Qa.loginHint||1>Qa.loginHint.length?"empty":-1<Qa.loginHint.indexOf("guest#")?"guest":-1<Qa.loginHint.indexOf("ext#")?"external":0>Qa.upn.indexOf("@")?"no-at":"supported"}f1a(){return 1===this.DQ}eOc(Qa,Ob,Pc){let Cd=null,Ud=null,Wd=null,le=null;Qa?Qa.ErrorCode||Qa.ErrorMessage?(Ud=Qa.ErrorCode?Qa.ErrorCode:lc.Y5c,Wd=Qa.ErrorMessage?Qa.ErrorMessage:"No message"):Qa.errorCode||Qa.errorMessage?(Ud=Qa.errorCode?Qa.errorCode:lc.Y5c,Wd=Qa.errorMessage?Qa.errorMessage:"No message"):Qa.Token?
Ob?Cd=Qa.Token:(Ud=lc.heh,Wd="A rejected promise returned a token."):(Ud=lc.Y5c,Wd=JSON.stringify(Qa)):(Ud=lc.j6c,Wd="No result came from Auth Token Strategy");Qa&&Qa.Telemetry&&!this.MZf(Pc)&&(le=Qa.Telemetry,w.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(le)));if(Ud===lc.cLh||Ud===lc.eLh)Ud=lc.lFe,Wd="Auth Library Timed Out";Ud===lc.aLh&&(Ud=lc.I6c);if(Ud===lc.dLh||Ud===lc.$Kh||Ud===lc.bLh)Ud=lc.Bcc;Ud===lc.fLh&&(Ud=lc.qFe);if(Ud||Wd)Cd=null;return Object.assign(new Cc.a,{IsSuccess:!!Cd,Token:Cd,
ErrorCode:Ud,ErrorMessage:Wd,Telemetry:le})}static ifj(Qa){return lc.htf&&"243c63a3-247d-41c5-9d83-7788c43f1c43"===Qa}static get htf(){return $a.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}}lc.eLh="token_renewal_error";lc.cLh="monitor_window_timeout";lc.aLh="login_required";lc.dLh="popup_window_error";lc.$Kh="consent_required";lc.bLh="invalid_grant";lc.fLh="user_cancelled";lc.gLh="authTokenStrategy_timeout";lc.lFe="Timeout";lc.I6c=
"Cookies Disabled";lc.Bcc="UserInteractionRequired";lc.Y5c="Exception";lc.j6c="NoResult";lc.heh="RejectToken";lc.qFe="UserCancelled";lc.DFj=2;Object(t.a)(lc,"OAuthManager",null,[885]);var Tc=a(282),md=a(79),sd=a(92),Zd=a(106);class Ae{s4k(Qa){if(Qa&&$a.AFrameworkApplication.fa&&$a.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacTokenValidation",!1)){Qa=Qa.startsWith("Bearer ")?Qa:"Bearer "+Qa;var Ob=rd.a.TXa.Endpoint;if(Ob){var Pc=Zc.a.Dj();Qa={["Authorization"]:Qa};
var Cd=new Zd.a;Cd.add("IsSpoWacToken","1");Ob=md.a.S2e(Ob,Cd);$a.AFrameworkApplication.rj.vVa(Ob,1,null,Qa,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Ud=>{var Wd=Math.floor(Zc.a.Dj()-Pc),le=null;Ud.mo?Ud="Canceled":Ud.Hm?Ud="Faulted":(le=Ud.result,Ud=le.succeeded?"Completed":"Failed");Wd={["TaskResult"]:Ud,["BrowserValidationDurationMS"]:Wd};le&&(Wd.HttpStatus=le.wo.data.httpStatus,le.succeeded&&(le=lf.a(le.wo.data.responseData),Wd.ServerValidationDurationMS=le.ElapsedMilliseconds,
Wd.ServerValidationResult=le.ValidatedToken,Wd.KMSI=le.KMSI,Wd.Scopes=le.Scopes,Wd.TokenExpiration=Math.floor(parseInt(le.Expiration)-(new Date).getTime()/1E3)));w.ULS.sendTraceTag(507639839,3E3,"Completed"===Ud?20:15,sd.a.toJSON(Wd))})}}}}Object(t.a)(Ae,"WacTokenValidator",null,[886]);class Ee{Sgk(Qa,Ob){let Pc=Ee.oEe;Ob&&(Pc=1E3*Ob-Date.now()-Ee.oEe);w.ULS.sendTraceTag(507524500,3E3,50,"Core Token Refresh: Scheduling Refresh in {0} ms",Pc);setTimeout(()=>{this.GFf(Qa)},Pc)}GFf(Qa){return Qa.gE("Core",
Ee.LDe).then(Ob=>{var Pc,Cd;const Ud=Ob.IsSuccess,Wd=null===(Pc=Ob.Telemetry)||void 0===Pc?void 0:Pc.expiresOn;Pc=!1;if(Ob.IsSuccess){const le="Bearer "+Ob.Token;Pc=$a.AFrameworkApplication.rj.rda!==le;$a.AFrameworkApplication.rj.rda=le}w.ULS.sendTraceTag(507524499,3E3,50,"Core Token Fetch: Success={0}, ExpirationTime={1}, FetchedNewToken={2}",Ud,Wd,Pc);this.Sgk(Qa,null===(Cd=Ob.Telemetry)||void 0===Cd?void 0:Cd.expiresOn);return Ob})}get name(){return"Common.App.OAuth.OAuthPackage"}$n(Qa){Qa.register(885,
"Common.App.OAuth.IOAuthManager").yi().Ei(()=>new lc);Qa.register(886,"Common.App.OAuth.IWacTokenValidator").yi().Ei(()=>new Ae)}init(){const Qa=Object(Dc.a)();Ca.a.instance.resolve("Common.App.OAuth.IWacTokenValidator");this.p4k(Qa);this.o4k(Qa)}o4k(Qa){if($a.AFrameworkApplication.fa&&$a.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Ob=$a.AFrameworkApplication.fa.Ya("FileSource");if($a.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||
$a.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===Ob){var Pc=rd.a.TXa;if(Pc&&Pc.IsEnabled){var Cd=Pc.Application,Ud=rd.a.authority;if(void 0!==Cd&&null!==Cd&&Cd.length&&void 0!==Ud&&null!==Ud&&Ud.length){var Wd=Rb[Qa.DQ],le=v.a.v$,Fa=Qa.sB();Ud=JSON.stringify({Pkl:{["xms_cc"]:{values:["cp1"]}}});var mb=Zc.a.Dj();Qa.gE("CAETest",Cd,null,Ud).then(e=>{const Ra=Math.floor(Zc.a.Dj()-mb);Wd=Rb[Qa.DQ];le=v.a.v$;Fa=Qa.sB();w.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Ra,e.IsSuccess,Wd,e.ErrorCode,Ob,le,Fa);if(e.IsSuccess){e="Bearer "+e.Token;var O=Pc.Endpoint;if(O){var qa=Zc.a.Dj();e={["Authorization"]:e};var ob=new Zd.a;ob.add("EnforceCAE","1");ob.add("IsCAEToken","1");O=md.a.S2e(O,ob);$a.AFrameworkApplication.rj.vVa(O,1,null,e,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(R=>{var Za,Cb=Math.floor(Zc.a.Dj()-qa),rc=null;R.mo?R="Canceled":R.Hm?R="Faulted":(rc=R.result,R=rc.succeeded?"Completed":"Failed");Cb={["TaskResult"]:R,["BrowserTokenDurationMS"]:Ra,
["BrowserValidationDurationMS"]:Cb};rc&&(Cb.HttpStatus=rc.wo.data.httpStatus,rc.succeeded&&(rc=lf.a(rc.wo.data.responseData),Cb.ServerValidationDurationMS=rc.ElapsedMilliseconds,Cb.ServerValidationResult=rc.ValidatedToken,Cb.KMSI=rc.KMSI,Cb.Scopes=rc.Scopes,Cb.TokenExpirationS=Math.floor(parseInt(rc.Expiration)-(new Date).getTime()/1E3),Cb.ClaimChallenge=null===(Za=rc.ClaimChallenge)||void 0===Za?void 0:Za.length));w.ULS.sendTraceTag(508950354,3E3,"Completed"===R?50:15,sd.a.toJSON(Cb))})}}else w.ULS.sendTraceTag(508950353,
3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",e.ErrorCode,e.ErrorMessage)}).catch(e=>{const Ra=Math.floor(Zc.a.Dj()-mb);w.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",e.toString(),Ra)})}}}}}p4k(Qa){const Ob=$a.AFrameworkApplication.fa.Ya("FileSource");if($a.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||$a.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===Ob){var Pc=rd.a.TXa;if(Pc&&Pc.IsEnabled){var Cd=Pc.Application,Ud=rd.a.authority;
if(void 0!==Cd&&null!==Cd&&Cd.length&&void 0!==Ud&&null!==Ud&&Ud.length){Ee.LDe=Cd;var Wd=Rb[Qa.DQ],le=v.a.v$,Fa=Qa.sB();try{var mb=new Map;void 0!==mb&&null!==mb?(mb.set("SupportStatus",Wd),mb.set("Browser",le),mb.set("AuthStrategy",Fa)):mb=null}catch(Ra){mb=null}fd.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",mb);var e=Zc.a.Dj();($a.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthCorePFTRefreshEnabled",!0)?this.GFf(Qa):Qa.gE("Core",Cd)).then(Ra=>
{const O=Math.floor(Zc.a.Dj()-e);Wd=Rb[Qa.DQ];le=v.a.v$;Fa=Qa.sB();w.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',O,Ra.IsSuccess,Wd,Ra.ErrorCode,Ob,le,Fa);mb&&(mb.set("SupportStatus",Wd),mb.set("Browser",le),mb.set("AuthStrategy",Fa));var qa=Object.assign({},{durationMs:O,extendedProperties:mb});if(Ra.IsSuccess){if(fd.Health.instance.recordKpiSuccess("WacCorePFT",
qa),Ra="Bearer "+Ra.Token,$a.AFrameworkApplication.rj.rda=Ra,qa=Pc.Endpoint){var ob=Zc.a.Dj();$a.AFrameworkApplication.rj.vVa(qa,1,null,{["Authorization"]:Ra},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(R=>{var Za=Math.floor(Zc.a.Dj()-ob),Cb=null;R.mo?R="Canceled":R.Hm?R="Faulted":(Cb=R.result,R=Cb.succeeded?"Completed":"Failed");Za={["TaskResult"]:R,["BrowserTokenDurationMS"]:O,["BrowserValidationDurationMS"]:Za};Cb&&(Za.HttpStatus=Cb.wo.data.httpStatus,Cb.succeeded&&(Cb=
lf.a(Cb.wo.data.responseData),Za.ServerValidationDurationMS=Cb.ElapsedMilliseconds,Za.ServerValidationResult=Cb.ValidatedToken,Za.KMSI=Cb.KMSI,Za.Scopes=Cb.Scopes,Za.TokenExpirationS=Math.floor(parseInt(Cb.Expiration)-(new Date).getTime()/1E3)));w.ULS.sendTraceTag(520632322,3E3,"Completed"===R?50:15,sd.a.toJSON(Za))})}}else fd.Health.instance.recordKpiFailure("WacCorePFT",Ra.ErrorCode,!1,!1,qa)}).catch(Ra=>{var O=Math.floor(Zc.a.Dj()-e);O=Object.assign({},{durationMs:O,extendedProperties:mb});fd.Health.instance.recordKpiFailure("WacCorePFT",
"UNEXPECTED CATCH: "+Ra.toString(),!1,!1,O)})}}}}dispose(){}static main(){Tc.a.instance.Do(new Ee)}}Ee.LDe="";Ee.oEe=3E5;Object(t.a)(Ee,"OAuthPackage",null,[11,12]);var Ze=a(9),Te=a(220),We=a(248),qf=a(433),bf=a(916),af=a(1264);class Nf{constructor(Qa){this.Jm=()=>{this.u7f(Ib.a.iGa("excel-uiSlice20-sprite"));E.EwaSettings.wl()||this.$.ea.Bv(this.Jm)};this.$=Qa;this.WZg={};this.Wve={};const Ob=this.UHf("excelInitialAppSprite");Ob?(this.r3e(Ob),this.$.ea.nm?this.u7f(Ib.a.iGa("excel-uiSlice20-sprite")):
E.EwaSettings.wl()?Qa.ea.Yq(this.Jm):Qa.ea.lr(this.Jm),this.$.la.Hh(388,this)):w.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.Wve=null;E.EwaSettings.wl()||this.$.ea.Bv(this.Jm)}N_a(Qa,Ob,Pc,Cd){Pc=void 0===Pc?null:Pc;Cd=void 0===Cd?null:Cd;let Ud;(Ud=this.Wve[Qa])||(this.Wve[Qa]=Ud=this.X4j(this.WZg[Qa]));if(!Ud)return w.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${Qa} was not found in loaded SVG sprites.`),null;const Wd=
Ud.cloneNode(!0);if(!Wd.style){const le=qf.b(Ud),Fa=qf.b(Wd),mb={};mb.iconId=Qa;mb.isOriginalNodeStyleNull=void 0===Ud.style||null===Ud.style;mb.isOriginalNodeCurrentStyleNull=void 0===Ud.currentStyle||null===Ud.currentStyle;mb.isClonedNodeCurrentStyleNull=void 0===Wd.currentStyle||null===Wd.currentStyle;mb.originalNode=le.substring(0,le.indexOf(">")+1);mb.clonedNode=Fa.substring(0,Fa.indexOf(">")+1);w.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(mb)}`)}Wd.setAttribute("style",
`height: ${Ob}px; width: ${Ob}px;`);Cd&&(Qa=document.createElement("title"),Qa.textContent=Cd,Wd.insertBefore(Qa,Wd.childNodes[0]));if(Pc)for(const le of Pc)E.EwaSettings.isChangeGateEnabled("OfficeVSO:8719525_RemoveIE11Hacks")?Wd.classList.add(le):Sys.UI.DomElement.addCssClass(Wd,le);return Wd}Zna(Qa,Ob,Pc,Cd,Ud,Wd,le,Fa){Ud=void 0===Ud?0:Ud;Wd=void 0===Wd?0:Wd;le=void 0===le?null:le;Fa=void 0===Fa?null:Fa;Ud&&Wd||(Wd=Fe.DOMElementExtensions.getBoundingClientRect(Cd),Ud=Wd.height,Wd=Wd.width);if(le=
this.N_a(Qa,Ob,le,Fa))Cd.appendChild(le),(Cd=Fe.DOMElementExtensions.sga(le,"style",null))?le.setAttribute("style",Cd+` margin: ${(Ud-Ob)/2}px ${(Wd-Pc)/2}px;`):w.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${Qa}`);return le}u7f(Qa){void Object(bf.a)(Qa,{va:0}).then(()=>this.lAh())}lAh(){const Qa=this.UHf("excelUiSlice20Sprite");Qa?this.r3e(Qa):w.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}r3e(Qa){for(const Ob of Qa)Ob.type===
We.a.Uve&&(this.WZg[Ob.id]=Ob)}X4j(Qa){if(!Qa)return null;const Ob=Qa.viewBox;Qa=Qa.children;const Pc=document.createElementNS(Te.a.lCa,We.a.Uve);E.EwaSettings.isChangeGateEnabled("OfficeVSO:8719525_RemoveIE11Hacks")?Pc.classList.add("ewa-svg-icon"):Sys.UI.DomElement.addCssClass(Pc,"ewa-svg-icon");Pc.setAttribute("focusable","false");Pc.setAttribute("viewBox",Ob);this.mAh(Pc,Qa);return Pc}mAh(Qa,Ob){for(const Cd of Ob){const Ud=document.createElementNS(Te.a.lCa,Cd.type);for(const Wd in Cd){Ob=Wd;
var Pc=Cd[Wd];"className"===Ob?Ud.setAttribute("class",Pc):Ud.setAttribute(Ob,Pc)}Qa.appendChild(Ud)}}UHf(Qa){return(Qa=window[Qa])?Qa.icons:null}}Object(t.a)(Nf,"SvgIconProvider",null,[895,4]);String(af);window.___1710758625297_closurehack=af;class uf extends nc.a{constructor(Qa){super();this.$=Qa;this.gm()}create(){const Qa=[this.Jxj()];C.TaskExtensions.Xa(C.TaskExtensions.Vo(Qa,this.$.ya),()=>{window.excelInitialAppSprite?this.Bk(this.$.la.kh(388)||new Nf(this.$)):w.ULS.sendTraceTag(537151258,
0,50,"window.[excelInitialAppSprite] returned null.")},this.ya,3)}Jxj(){let Qa=Ya.a.RIb;$a.AFrameworkApplication.fa.ka("IsStringExperimentEnabled")&&(Qa=Ya.a.Rnc);Qa=Ib.a.iGa(Qa);return Object($b.d)(Object(bf.a)(Qa,{va:this.xh}))}static Ba(Qa){Qa.la.Hh(387,new uf(Qa))}}Object(t.a)(uf,"SvgIconProviderFactory",nc.a,[]);var pf=a(914);class ff extends pf.a{constructor(Qa){super(Qa)}Kt(){void W.a.resolve(J.gf,{va:this.xh}).then(()=>{C.TaskExtensions.Xa(E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)?Object($b.d)(W.a.resolve(J.Yf,{va:this.xh})):Gc.GetServiceTaskFactory.Tj(this.$.la,32,33,this.xh),Qa=>{this.Qr([new gc(Qa.result)])},this.$.ya)})}static Ba(Qa){pf.a.qy(392,new ff(Qa))}}Object(t.a)(ff,"SheetDropdownMenuCommandHandlerFactory",pf.a,[]);Type.registerNamespace("Common.App.OAuth");Ee.main();E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1264);Ze.a.gh(uf.Ba);(()=>{Ze.a.gh(Qa=>{a(1455);E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||Wb.Ba(Qa);J.Rf.Aa()||ff.Ba(Qa)})})();String(c);String(b);String(h);String(r);String(f);String(l);String(m);String(x);window.___1710758652350_closurehack=c;window.___1710758652350_closurehack=b;window.___1710758652350_closurehack=h;window.___1710758652350_closurehack=r;window.___1710758652350_closurehack=f;window.___1710758652350_closurehack=l;window.___1710758652350_closurehack=m;window.___1710758652350_closurehack=x}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrs.js.map/0bbb7cfc3435e29d16cab588ff944821/EwaTS.vrs.js.map