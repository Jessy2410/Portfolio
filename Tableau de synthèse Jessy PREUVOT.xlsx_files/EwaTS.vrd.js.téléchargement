'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[48],{1161:function(A,u,a){a.r(u);a.d(u,"FormulaBar",function(){return vb});A=a(0);var c=a(15),b=a(98),h=a(6),r=a(158),f=a(17),l=a(94),m=a(904),x=a(35),n=a(416),t=a(99),w=a(19),v=a(7),k=a(305),y=a(730),C=a(728),B=a(558),E=a(178),K=a(154);u=a(78);var F=a(105);class W extends F.a{constructor(bb,La,pb,fa,kb,db){super(bb);this.fZ=()=>{this.domElement.disabled||(this.Mrc.className=this.wuc+" "+this.pdg)};this.eZ=()=>{this.domElement.disabled||
(this.Mrc.className=this.wuc+" "+this.uHj)};this.ong=gb=>{if(!this.domElement.disabled){const Kb=gb.keyCode;if("mousedown"===gb.type||13===Kb||32===Kb)this.Mrc.className=this.wuc+" "+this.b$j}};this.qng=()=>{this.domElement.disabled||(this.Mrc.className=this.wuc+" "+this.pdg)};this.wuc=pb;this.pdg=fa;this.uHj=kb;this.b$j=db;this.oj.Ba("mouseover",this.fZ);this.oj.Ba("mouseout",this.eZ);this.oj.Ba("focus",this.fZ);this.oj.Ba("blur",this.eZ);this.oj.Ba("mousedown",this.ong);this.oj.Ba("keydown",this.ong);
this.oj.Ba("mouseup",this.qng);this.oj.Ba("keyup",this.qng);this.Mrc=La}}Object(A.a)(W,"PseudoClassBehavior",F.a,[]);var J=a(16);class L extends u.a{constructor(bb){super();this.instances=[];this.$=bb}dispose(){l.a.gj(this.instances);this.instances.length=0;this.$=null;super.dispose()}Koc(bb,La,pb,fa,kb){const db=J.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+bb);bb=bb===La?db:J.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+La);if(!db)return null;pb=new W(db,bb,
pb,fa,"",kb);this.instances.push(pb);return pb}}L.XQh="ewa-menu-btn-hover";L.ZQh="ewa-menu-btn-pressed";Object(A.a)(L,"InitializePseudoClasses",u.a,[]);var M=a(25),Q=a(283),H=a(205),ba=a(139),U=a(39),D=a(23);class I{constructor(bb,La){this.$=bb;this.Zi=La;k.a(this.$).Tq(this)}get hj(){return this.Zi.Wa.Yl}get Zo(){return D.f(this.$).isEditing&&D.f(this.$).xA}get hl(){return Q.a.SBf}Vp(bb,La){La||J.DOMElementExtensions.setFocus(this.hj);return!La}tq(bb){return J.DOMElementExtensions.eo(this.hj,bb)}Qs(){}nu(){}dispose(){k.a(this.$).VH(this)}}
Object(A.a)(I,"FormulaBarFocusManager",null,[47,4]);var X=a(290),Y=a(306),ja=a(60),Ua=a(83),ka=a(922),fb=a(169);class ha extends u.a{constructor(bb=null,La,pb,fa=null){super();this.O5a=this.fnb=this.Tkb=this.fTc=null;this.gJd=M.a.Jz()?16:13;this.hJd=M.a.Jz()?16:13;this.Ikg=()=>{const kb=new Ua.a(753860909,2,this.$.hi,2,null);this.$.Ma.qh(kb);return!0};this.Jkg=kb=>kb.La.keyCode===b.a.yu?(kb=new Ua.a(753860909,1,this.$.hi,2,null),this.$.Ma.qh(kb),!0):!1;this.Kkg=()=>{this.da.isEditing&&this.da.Bp.Wa.kpc();
return!1};this.$=pb;this.da=D.f(pb);this.Vq=La;this.svgIconProvider=fa;M.a.Jz()?this.Tkb=J.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+v.a.DQb):(this.JAi=La.ia(1035),this.fTc=bb.Koc(v.a.DQb,v.a.DQb,w.a.zCf+" "+w.a.q0,w.a.V0i,""),this.Tkb=this.fTc.domElement);this.oaj(this.Tkb)}oaj(bb){bb.role="button";bb.title=this.Vq.ia(1035);this.fnb=this.svgIconProvider?this.svgIconProvider.Zna(ka.a.IAi,this.gJd,this.hJd,bb,void 0,void 0,void 0,this.Vq.ia(1035)):fb.b(this.hJd,this.gJd,w.a.nqi,
ja.a.An(0),null,null,!0,this.Vq.ia(1035));bb.appendChild(this.fnb);X.a.instance.xa(f.a.click,bb,this.Ikg);r.a.instance.xa(f.a.Ui,bb,this.Jkg);Y.a.instance.xa(f.a.qj,bb,this.Kkg)}dispose(){this.j$a(this.Tkb);this.Tkb=null;M.a.Jz()||(l.a.dh(this.fTc),this.fTc=null);J.DOMElementExtensions.an(this.fnb);this.O5a=this.fnb=null;super.dispose()}j$a(bb){bb&&(X.a.instance.Qa(f.a.click,bb,this.Ikg),r.a.instance.Qa(f.a.Ui,bb,this.Jkg),Y.a.instance.Qa(f.a.qj,bb,this.Kkg))}n8k(bb){!this.O5a&&this.svgIconProvider&&
(this.O5a=this.svgIconProvider.Zna(ka.a.OAi,this.gJd,this.hJd,this.Tkb,void 0,void 0,void 0,this.JAi))&&this.O5a.classList.add("ewa-fb-function-button-img");this.fnb&&this.O5a&&(J.DOMElementExtensions.setVisible(this.fnb,!bb),J.DOMElementExtensions.setVisible(this.O5a,bb))}}Object(A.a)(ha,"FormulaBarFunctionControl",u.a,[]);var ea=a(327),aa=a(193),ca=a(53),xa=a(10),Oa=a(174),ua=a(159),Ia=a(13),Sa=a(1);const Ya=M.a.Jz()?1:2;class da{constructor(bb){this.uIa=this.expandButton=this.vJa=this.ebd=this.dbd=
this.cbd=null;this.yJc=this.lWd=this.aba=!1;this.Wbf=this.BIg=0;this.hEb=M.a.Jz()?16:0;this.pWe=0;this.hzc=M.a.Jz()?24:Oa.c;this.iha=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.gPc=La=>{this.nyf();La.La.rawEvent.preventDefault();return!0};this.cPc=La=>{this.lWd=!0;this.BIg=La.clientPoint.y;document.body.classList.add(w.a.pvf);this.aba||(this.b7a=0);this.hjb.Ba("mousemove",this.Cjg,!0);this.hjb.Ba("touchmove",this.Cjg);this.hjb.Ba("mouseup",this.C9d);this.hjb.Ba("touchend",
this.C9d);this.hjb.Ba("mouseleave",this.C9d);return!0};this.C9d=()=>{this.lWd=!1;this.b7a=M.a.Jz()?this.aba?this.vJa.clientHeight-this.hzc:0:this.xw.clientHeight-this.hzc;document.body.classList.remove(w.a.pvf);this.hjb.zM();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.xw.clientHeight} pixel`)};this.Cjg=La=>{this.lWd?(La=Ia.HelperMethods.lRb(La).y,La=this.nJf(this.b7a+Math.min(La,this.$.domElement.clientHeight-75)-this.BIg),
this.aba=La>=this.lineHeight,J.DOMElementExtensions.toggleCssClass(this.xw,w.a.qvf,this.aba),La=this.hzc+Math.round(Math.max(La-Ya,0)),(M.a.Jz()?this.vJa.clientHeight:this.xw.clientHeight)!==La&&(this.xw.style.height=La+"px",this.$.a7a())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.gZ=La=>{this.aba&&(this.JZa=Math.round((Math.round(this.JZa/this.lineHeight)+(0<La.hDa?1:-1))*this.lineHeight));La.La.preventDefault();
return!1};this.QP=()=>{this.Bsk();this.yJc&&(ea.a.instance.Qa(f.a.zS,document.body,this.QP),ea.a.instance.Qa(f.a.$Ma,document.body,this.QP),aa.a.instance.Qa(f.a.ml,document.body,this.QP),this.yJc=!1);return!1};this.onActiveCellChanged=()=>{this.JZa=0};this.Lpg=La=>{this.yJc||(ea.a.instance.xa(f.a.zS,document.body,this.QP),ea.a.instance.xa(f.a.$Ma,document.body,this.QP),aa.a.instance.xa(f.a.ml,document.body,this.QP),this.yJc=!0);La.preventDefault()};this.onScroll=La=>pb=>{La.onScroll();this.Lpg(pb)};
this.m0j=La=>{this.JZa=this.Wbf;La.preventDefault()};this.$=bb;this.hjb=ua.a.instance.VXa(document.body.ownerDocument)}get lineHeight(){return this.hEb?this.hEb:xa.a.TBf}set lineHeight(bb){this.hEb=bb}get xw(){const {FormulaBar:bb}=a(1161);this.cbd||(this.cbd=bb.dHf(this.$));return this.cbd}get izc(){this.dbd||(this.dbd=document.getElementById(v.a.EQb));return this.dbd}get J0(){this.ebd||(this.ebd=document.getElementById(v.a.EQb+"_"+v.a.Pwe));return this.ebd}get JZa(){return this.J0.scrollTop}set JZa(bb){this.Wbf=
bb;this.J0.scrollTop!==bb&&(this.J0.scrollTop=bb)}get Czi(){return 2*this.lineHeight-Ya}get b7a(){return this.pWe}set b7a(bb){this.pWe=bb}nyf(){this.aba=!this.aba;J.DOMElementExtensions.toggleCssClass(this.xw,w.a.qvf,this.aba);this.aba&&!this.b7a&&(this.b7a=this.Czi);this.xw.style.height=this.hzc+(this.aba?this.b7a:0)+"px";this.expandButton.setAttribute(v.a.tD,this.aba?"Collapse the formula bar":"Expand the formula bar");this.$.a7a();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.aba?
"expanded":"collapsed"}`)}y$h(bb){this.vJa=document.createElement("div");this.vJa.id=this.$.xi+v.a.MId;this.vJa.className=w.a.Ioi;this.expandButton=da.r6h(this.$.xi,bb);this.vJa.appendChild(this.expandButton);this.uIa=da.R5h(this.$.xi);this.vJa.appendChild(this.uIa);return this.vJa}Rik(){ea.a.instance.xa(f.a.Sy,this.expandButton,this.gPc);aa.a.instance.xa(f.a.Lm,this.expandButton,this.gPc);ea.a.instance.xa(f.a.Sy,this.uIa,this.cPc);aa.a.instance.xa(f.a.Lm,this.uIa,this.cPc)}Uik(bb){ea.a.instance.xa(f.a.kN,
this.izc,this.gZ);ca.a.addHandler(this.J0,f.a.scroll,this.iha?this.onScroll(bb):this.Lpg);M.a.Jz()&&ca.a.addHandler(this.J0,f.a.scrollEnd,this.QP);ca.a.addHandler(this.J0,f.a.focus,this.m0j);D.f(this.$).ha.add_activeCellChanged(this.onActiveCellChanged)}Q5k(){void 0!==this.expandButton&&null!==this.expandButton&&(ea.a.instance.Qa(f.a.Sy,this.expandButton,this.gPc),aa.a.instance.Qa(f.a.Lm,this.expandButton,this.gPc));void 0!==this.uIa&&null!==this.uIa&&(ea.a.instance.Qa(f.a.Sy,this.uIa,this.cPc),aa.a.instance.Qa(f.a.Lm,
this.uIa,this.cPc));void 0!==this.izc&&null!==this.izc&&ea.a.instance.Qa(f.a.kN,this.izc,this.gZ);D.f(this.$).ha.remove_activeCellChanged(this.onActiveCellChanged)}Bsk(){this.JZa=Math.round(this.nJf(this.JZa))}nJf(bb){return Math.round(bb/this.lineHeight)*this.lineHeight}static r6h(bb,La){const pb=document.createElement("a");pb.id=bb+v.a.Fzi;pb.classList.add(w.a.zoi);J.DOMElementExtensions.pL(pb,v.a.FF);pb.setAttribute(v.a.tD,"Expand the formula bar");La.Zna(ka.a.q_h,12,12,pb,M.a.Jz()?20:null,M.a.Jz()?
20:null).classList.add(w.a.Aoi);return pb}static R5h(bb){const La=document.createElement("div");La.id=bb+v.a.Dzi;La.className=w.a.yoi;return La}}Object(A.a)(da,"FormulaBarResizeControl",null,[]);F=a(265);var Ea=a(46),oa=a(683),za=a(190),la=a(103),Ca=a(44),Va=a(1359);class ia{}ia.disabled="disabled";ia.mUk="stale";ia.text="text";ia.V9j="presentationMode";ia.viewMode="viewMode";Object(A.a)(ia,"NameBoxStateUpdateKey",null,[]);var wa=a(152),Jb=a(171);class $a extends F.a{constructor(bb,La){super(document.createElement("div"));
this.$=bb;this.hm=null;this.Owe="";this.v2k=()=>{this.$.Ma.kTb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.c$d=()=>{this.eW(this.da.ha.JKf())};this.wq=(pb,fa)=>{this.fqa(pb,fa);this.v7b(pb,fa)};this.v7b=()=>{let pb=Va.c(this.$,this.da);oa.c(pb,!0)||(this.hm&&(pb=this.$.$h.getItemByName(this.hm))&&pb.deactivate(),this.eW(this.da.ha.qa.activeCell.toString()))};this.M0b=(pb,fa)=>{var kb,db,gb,Kb,ub;!(pb=fa.ma)||Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8137505_AvoidViewportJumpWhenScrollingNamedObject")&&
(null===(kb=fa.LB)||void 0===kb?void 0:kb.name)===(null===pb||void 0===pb?void 0:pb.name)&&(null===(db=fa.LB)||void 0===db?void 0:db.usedRange.top)===(null===pb||void 0===pb?void 0:pb.usedRange.top)&&(null===(gb=fa.LB)||void 0===gb?void 0:gb.usedRange.bottom)===(null===pb||void 0===pb?void 0:pb.usedRange.bottom)&&(null===(Kb=fa.LB)||void 0===Kb?void 0:Kb.usedRange.left)===(null===pb||void 0===pb?void 0:pb.usedRange.left)&&(null===(ub=fa.LB)||void 0===ub?void 0:ub.usedRange.right)===(null===pb||void 0===
pb?void 0:pb.usedRange.right)||(kb=pb.usedRange,2===pb.type&&(kb=za.a(pb)),db=this.da.ha.qa.Bn,gb=this.da.inRangePicker||this.da.lq,Kb=!1,2===pb.type&&db&&!gb&&(db=this.da.ha.qa.activeRange,Kb=pb.sheetName===this.$.sa.ma.name&&!!db&&db.top===kb.top&&db.left===kb.left&&db.bottom===kb.bottom&&db.right===kb.right),kb=Ea.x(kb,this.$),kb.NamedObjectName=pb.name,kb.SheetName=pb.sheetName,this.da.ep(kb,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,fa.disableAutoFocusOnGrid),
fa=oa.a(pb.name),this.eW(fa.name,fa.fullName))};this.Vu=()=>{const pb=Va.b(this.da);null!=pb&&this.eW(pb.name)};this.wkg=(pb,fa)=>{this.c$d(pb,fa)};this.j2b=()=>{this.nvc(!0)};this.i2b=()=>{this.nvc(!1)};this.rx=()=>{Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)?this.k8k(!this.$.isEditMode):this.nvc(!this.$.isEditMode)};this.lng=()=>{Ca.a(this.$).fL(wa.a.Gzi,Jb.a.vj)};this.hZ=(pb,fa)=>{this.cQg(fa.iU)};this.onKeyDown=pb=>pb.La.keyCode===b.a.xRa?(this.da.focus(),
!0):!1;this.fqa=()=>{this.a4c({[ia.mUk]:!0})};this.da=D.f(bb);this.Abj(La);Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8749712_AppendNameBoxStateDuringInit")||(this.eW(Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8749724_StartNameBoxWithNamedObjectIfExists")?this.da.ha.$Nd():this.da.ha.qa.activeCell.toString(),"",!0),this.nvc(!Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)&&!this.$.isEditMode));this.cQg(Ca.a(this.$).wv());this.Hp();r.a.instance.xa(f.a.Ui,
this.domElement,this.onKeyDown.bind(this))}get text(){return Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8654931_readNameBoxTextFromReact")?appChrome.getNameBoxText():this.Owe}dispose(){if(this.$){this.$.vh.aGg(this.j2b.bind(this));this.$.vh.$Fg(this.i2b.bind(this));var bb=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8768614_FixNameBoxNullReferences");bb&&!this.$.ea||this.$.ea.uZ(this.rx.bind(this));var La=la.a(this.$);if(!bb||La)La.YUc(this.wkg.bind(this)),La.tje(this.Vu.bind(this));La=Ca.a(this.$);
bb&&!La||La.Tm.WAa(this.hZ.bind(this));bb&&!this.$.ea||!this.$.$h||(this.$.$h.Gn(this.M0b.bind(this)),this.$.$h.bVc(this.v7b.bind(this)),this.$.$h.bVc(this.$Bg.bind(this)),this.$.$h.tca(this.fqa.bind(this)),this.$.$h.UAa(this.fqa.bind(this)),this.$.$h.VAa(this.fqa.bind(this)),this.$.$h.g5b(this.fqa.bind(this)));this.$.sa&&this.$.sa.Gn(this.wq.bind(this))}this.da&&(bb=this.da.ha,bb.Q7(this.v7b.bind(this)),bb.uca(this.c$d.bind(this)),bb.$e.VV(this.Vu.bind(this)));super.dispose()}j8k(bb){this.a4c({[ia.V9j]:bb})}k8k(bb){this.a4c({[ia.viewMode]:bb})}Abj(bb){const La=
document.getElementById(this.$.xi+v.a.UBf);void 0!==La&&null!==La&&bb.removeChild(La);appChrome.renderNameBoxUI(this.domElement,this.GQi(),this.v2k.bind(this));bb.insertBefore(this.domElement,bb.firstChild)}GQi(){return Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8749712_AppendNameBoxStateDuringInit")?{[ia.disabled]:Ca.a(this.$).wv()||!Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)&&!this.$.isEditMode,[ia.text]:Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8749724_StartNameBoxWithNamedObjectIfExists")?
this.da.ha.$Nd():this.da.ha.qa.activeCell.toString()}:{}}Hp(){this.$.vh.g5e(this.j2b.bind(this));this.$.vh.f5e(this.i2b.bind(this));this.$.ea.vX(this.rx.bind(this));const bb=this.da.ha;this.$.$h.pn(this.M0b.bind(this));this.$.sa.pn(this.wq.bind(this));bb.e4(this.v7b.bind(this));bb.g$(this.c$d.bind(this));bb.$e.nO(this.Vu.bind(this));la.a(this.$).Rpd(this.Vu.bind(this));la.a(this.$).Imc(this.wkg.bind(this));Ca.a(this.$).Tm.iua(this.hZ.bind(this));this.$.$h.Mmc(this.v7b.bind(this));this.$.$h.Mmc(this.$Bg.bind(this));
this.$.$h.d4(this.fqa.bind(this));this.$.$h.fua(this.fqa.bind(this));this.$.$h.gua(this.fqa.bind(this));this.$.$h.Ieb(this.fqa.bind(this))}cQg(bb){bb?this.domElement.addEventListener("pointerdown",this.lng):this.domElement.removeEventListener("pointerdown",this.lng);this.f0k(bb)}f0k(bb){for(let La=0;La<this.domElement.children.length;La++)this.domElement.children[La].style.pointerEvents=bb?"none":""}eW(bb,La="",pb=!1){this.Owe=bb;this.hm=""!==La?La:this.hm;appChrome.setNamedObjectOrActiveCellRange(La,
bb,pb)}nvc(bb){this.a4c({[ia.disabled]:bb})}$Bg(bb,La){Va.a(this.$,!0);this.fqa(bb,La)}a4c(bb){appChrome.updateNameBoxState(bb)}}Object(A.a)($a,"NameBox",F.a,[4]);var Ka=a(176),nb=a(156);const sa=w.a.Cgg+" "+w.a.q0,na=w.a.Adf+" "+w.a.q0;class ab extends u.a{constructor(bb=null,La,pb,fa){super();this.AKb=this.I0b=this.BKb=this.J0b=this.wO=this.NP=null;this.fS=this.fJc=!1;this.VCg=()=>{this.da.CU.Iv(this.Cn);this.da.CU.Jx(this.Rl);this.fJc=!0};this.Cn=()=>{this.k1g(!0)};this.Rl=()=>{this.k1g(!1)};this.Wng=
db=>this.LOc(!0,`OkCancelEditControl.OnOkClick: ${db.Dh}`,Ia.HelperMethods.rA(db));this.Xng=db=>this.LOc(!0,`OkCancelEditControl.OnOkKeyDown: ${db.Dh}`);this.Phg=db=>this.LOc(!1,`OkCancelEditControl.OnCancelClick: ${db.Dh}`,Ia.HelperMethods.rA(db));this.Shg=db=>this.LOc(!1,`OkCancelEditControl.OnCancelKeyDown: ${db.Dh}`);this.lJ=()=>{this.e0k(!this.$.isEditMode)};this.onPointerDown=()=>{this.da.isEditing&&(this.da.Bp.Wa.QM=!0);return!1};const {FormulaBar:kb}=a(1161);this.$=pb;this.da=D.f(pb);this.fS=
M.a.fS();fa?(this.J0b=fa.N_a(ka.a.cff,16),this.BKb=fa.N_a(ka.a.ndi,16),M.a.Jz()||(this.I0b=fa.N_a(ka.a.GWh,16),this.AKb=fa.N_a(ka.a.odi,16),this.J0b.style.display="none",this.BKb.style.display="none")):(this.J0b=fb.b(16,16,w.a.cqi,ja.a.An(1),null,null,!0,La.ia(1041)),this.BKb=fb.b(16,16,w.a.hqi,ja.a.An(1),null,null,!0,La.ia(1042)));M.a.Jz()?(this.NP=J.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+kb.vOc),this.wO=J.DOMElementExtensions.getElementById(this.$.domElement,this.$.xi+kb.kqc)):
(this.y8d=bb.Koc(kb.vOc,kb.vOc,sa,"",""),this.NP=this.y8d.domElement,this.Rud=bb.Koc(kb.kqc,kb.kqc,na,"",""),this.wO=this.Rud.domElement);this.NP.appendChild(this.J0b);this.wO.appendChild(this.BKb);M.a.Jz()?(this.NP.classList.add(w.a.Tua),this.wO.classList.add(w.a.Tua),J.DOMElementExtensions.toggleCssClass(this.NP,w.a.Rjb,!this.$.isEditMode),J.DOMElementExtensions.toggleCssClass(this.wO,w.a.Rjb,!this.$.isEditMode)):(this.NP.appendChild(this.I0b),this.wO.appendChild(this.AKb));this.da.cellTextEditBox.Iv(this.Cn);
this.da.cellTextEditBox.Jx(this.Rl);M.a.Jz()&&pb.ea.cK(this.lJ);X.a.instance.xa(f.a.click,this.NP,this.Wng);r.a.instance.xa(f.a.Ui,this.NP,this.Xng);Y.a.instance.xa(f.a.qj,this.NP,this.onPointerDown);X.a.instance.xa(f.a.click,this.wO,this.Phg);r.a.instance.xa(f.a.Ui,this.wO,this.Shg);Y.a.instance.xa(f.a.qj,this.wO,this.onPointerDown);this.fS&&this.da.XBh(this.VCg)}dispose(){this.da&&this.da.cellTextEditBox&&(this.da.cellTextEditBox.Cv(this.Cn),this.da.cellTextEditBox.Lw(this.Rl));this.da&&this.fS&&
(this.da.lmk(this.VCg),this.fJc&&(this.da.CU.Cv(this.Cn),this.da.CU.Lw(this.Rl),this.fJc=!1));this.NP&&(X.a.instance.Qa(f.a.click,this.NP,this.Wng),r.a.instance.Qa(f.a.Ui,this.NP,this.Xng),Y.a.instance.Qa(f.a.qj,this.NP,this.onPointerDown),this.NP=null);this.wO&&(X.a.instance.Qa(f.a.click,this.wO,this.Phg),r.a.instance.Qa(f.a.Ui,this.wO,this.Shg),Y.a.instance.Qa(f.a.qj,this.wO,this.onPointerDown),this.wO=null);M.a.Jz()||(l.a.dh(this.y8d),this.y8d=null,l.a.dh(this.Rud),this.Rud=null);M.a.Jz()&&this.$&&
this.$.ea.WH(this.lJ);M.a.Jz()||(J.DOMElementExtensions.an(this.AKb),this.AKb=null,J.DOMElementExtensions.an(this.I0b),this.I0b=null);super.dispose()}e0k(bb){Object(nb.c)(()=>{this.NP&&this.wO&&(J.DOMElementExtensions.toggleCssClass(this.NP,w.a.Rjb,bb),J.DOMElementExtensions.toggleCssClass(this.wO,w.a.Rjb,bb))},this.$.ya)}LOc(bb,La,pb=null){const fa=this.da.Bp;if(pb){const kb=this.da.xA?"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let db;db=[Object(Ka.a)(this.da.cellTextEditBox.Wa.KQa)];
Ka.b(this.$).TA(pb.rawEvent,kb,db)}this.fJc&&this.da.CU.UO?this.da.CU.endEdit(bb,La,0):fa.endEdit(bb,La,0);this.da.focus();return!0}k1g(bb){if(M.a.Jz())bb?(this.NP.classList.remove(w.a.Tua),this.wO.classList.remove(w.a.Tua)):(this.NP.classList.add(w.a.Tua),this.wO.classList.add(w.a.Tua));else{const La=bb?"block":"none";bb=bb?"none":"block";this.J0b.style.display=La;this.BKb.style.display=La;this.I0b.style.display=bb;this.AKb.style.display=bb}}}Object(A.a)(ab,"OkCancelEditControl",u.a,[]);var Ja=a(329),
Pa=a(338),hb=a(69),ac=a(211),Hc=a(12),bd=a(325),zc=a(234),oc=a(328),Nb=a(155),Aa=a(162),Ub=a(45),Db=a(433),Ib=a(243),yc=a(161),xc=a(383),zb=a(746);class vb extends n.a{constructor(bb,La,pb=null){super(D.f(bb));this.$Ba=La;this.tMe=this.PF=this.clearContentNotifier=this.nameBox=this.xw=this.u0g=null;this.hCe=!1;this.J0=null;this.VTg=this.Z0f=this.TGc=this.Zbf=this.NDc=!1;this.iha=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.Poj=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8614675_partialInteractivityFormulaBar");
this.c2f=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8704306_RemoveRegionHeightAfterFormulaBarVisible");this.Cn=()=>{this.hCe=!1;this.aqe();this.TGc&&this.W$b(!this.UZf)};this.Rl=()=>{this.aqe();this.TGc&&this.W$b(!1)};this.W$b=(fa,kb=!1)=>{if(vb.Pwa&&this.Zbf!==fa){if(M.a.Jz()){const db=()=>{vb.Pwa&&(J.DOMElementExtensions.toggleCssClass(vb.Pwa,w.a.Rjb,fa),J.DOMElementExtensions.toggleCssClass(vb.Pwa,w.a.Tua,fa))};kb?db():Object(nb.c)(()=>{db()},this.$.ya)}else J.DOMElementExtensions.toggleCssClass(vb.Pwa,
w.a.Tua,fa);this.Zbf=fa}};this.nrg=()=>{this.isEditing||this.Wa.disabled||this.startEdit(!0,!1,null)};this.aw=()=>{this.XPa()};this.hZ=(fa,kb)=>{this.XPa();vb.Pwa&&(kb.iU?this.Poj?this.W$b(!0):vb.Pwa.classList.add(w.a.Tua):this.qnc())};this.GA=(fa,kb)=>{fa=this.grid;this.hCe=!0;this.isEditing?(this.IWb||(kb.WGc||this.$Z(null),this.raiseEvent(n.a.JKb,kb)),this.IWb||fa.cellTextEditBox.Wa.isCursorAttached()&&!this.Wa.isCursorAttached()&&fa.cellTextEditBox.Wa.clearCursorFormatLocation()):fa.isEditing&&
this.XPa()};this.onBlockCacheItemChanged=(fa,kb)=>{(fa=this.grid.ha.qa.activeCell)&&(kb=this.grid.CL(kb.mj.hash))&&fa.Xi(kb.yj)&&this.XPa()};this.W$d=(fa,kb)=>{-185374993===kb.command&&this.XPa()};this.onActiveItemChanged=()=>{this.XPa();U.TaskExtensions.Xa(H.a(this.$.la),()=>{this.vPg()},this.ya,11)};this.aZ=()=>{this.vPg();M.a.O1a()?this.$Ba.S3k(this.DMi()):(Ub.a.instance.j2(v.a.E5,xc.a.E$b),Ub.a.instance.zZ(v.a.E5,xc.a.E$b));Ub.a.instance.wca(v.a.E5,xc.a.Gbf)};this.onKeyDown=fa=>{if(fa.La.keyCode===
b.a.CG){var kb=this.aKa();const db=J.DOMElementExtensions.DE(kb);kb=J.DOMElementExtensions.yaa(kb);return J.DOMElementExtensions.b8a(fa.La,db,kb)}return!1};this.lJ=()=>{this.qnc()};this.kdj=()=>{this.xw?(this.nameBox=new $a(this.$,this.xw),this.Tqk()):this.gHg()};pb||c.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");M.a.O1a()&&(La||c.ULS.sendTraceTag(507609984,0,10,"FormulaBar.ctor: SkeletonManager must always exist."));this.tMe=new da(bb);this.initialize(this.upe(bb,
pb));this.IZa.Rik();!this.c2f&&h.AFrameworkApplication.ra.$g.fl&&(La=document.getElementById("AdditionalBarsRegion"))&&(La.style.height="");this.RVd=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.eM=new Ja.a(this.xw,1);this.wlj=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");M.a.Jz()&&Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8773064_FormulabarRemovePseudoClass")?(this.KId=new ha(void 0,Hc.a.instance,bb,
pb),this.Bgg=new ab(void 0,Hc.a.instance,bb,pb)):(this.wFc=new L(bb),this.wFc.Koc(v.a.i1g,v.a.i1g,v.a.b0k+" cui-TabRowRight",L.XQh,L.ZQh),this.KId=new ha(this.wFc,Hc.a.instance,bb,pb),this.Bgg=new ab(this.wFc,Hc.a.instance,bb,pb));this.u0g=Ib.b(()=>{this.cRg()},1,this.$.ya,"FormulaBar.setTextBoxForActiveItem",!0);bb.sa.pn(this.onActiveItemChanged);pb=this.grid;pb.cellTextEditBox.Iv(this.Cn);pb.cellTextEditBox.Jx(this.Rl);pb.cellTextEditBox.AVa(this.GA);pb.lO(this.aw);pb.za.nz(this.onBlockCacheItemChanged);
pb.za.eua(this.onBlockCacheItemChanged);pb.Wmc(this.W$d);Ca.a(bb).Tm.iua(this.hZ);bb.ea.cK(this.lJ);la.a(bb).Rpd(this.aw);Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&bb.la.fi(313,fa=>{this.clearContentNotifier=fa;this.clearContentNotifier.Vod(this.GA)});r.a.instance.xa(f.a.Ui,this.hj,this.onKeyDown);pb=this.Wa.style;bd.c(pb,bb.isChromeRtl,"0px");pb.textAlign=this.mXf?"right":"left";this.isVisible=!1;this.RVd&&(this.Wa.isVisible=!1);pb=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8654712_PopulateFBTextBoxBeforeCommandUIAttach");
pb||(E.a(this.$).oGa(this.aZ),this.$.ea.rya&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.aZ(null,null)));Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8605252_FormulaBarInitStateFix")?this.cRg():this.XPa();Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8740111_setDisabledModeSyncInFormulaBarInit")?this.qnc(!0):this.qnc();this.Wa.pTg=!0;this.Vcj();k.a(bb).Tq(this);this.Wa.i4e(this.nrg);this.IWb=!1;this.PF=new I(this.$,
this);this.gbj();pb&&this.Jvk();this.Wa.$ea(()=>{Ub.a.instance.wca(v.a.E5,xc.a.Y_g);this.toggleEditingEvents(!1)});this.TGc=Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8106214_disableFunctionButtonV2")}set text(bb){this.isEditing?this.Wa.setPlainText(bb):super.text=bb}get isEditing(){return super.isEditing}set isEditing(bb){super.isEditing=bb;this.toggleEditingEvents(bb)}get UZf(){return this.XEc||0>=this.text.length}get h$b(){return!0}get formattedText(){return this.Wa.getFormattedText()}set formattedText(bb){this.Wa.setFormattedText(bb)}get eWb(){return this.isEditing}get isVisible(){return J.DOMElementExtensions.isVisible(this.xw)}set isVisible(bb){this.RVd?
J.DOMElementExtensions.setVisible(this.xw,bb):(J.DOMElementExtensions.setVisible(this.xw,bb),this.Wa.isVisible=bb)}get hj(){return this.xw}get Zo(){return this.isVisible}get hl(){return Q.a.LId}get IZa(){return this.tMe}Vp(bb,La){bb=!1;La||(bb=this.Pyi());return bb}dispose(){const bb=this.$;if(bb){bb.sa.Gn(this.onActiveItemChanged);var La=this.grid;La.cellTextEditBox.Cv(this.Cn);La.cellTextEditBox.Lw(this.Rl);La.cellTextEditBox.P6a(this.GA);La.$P(this.aw);La.za.Zy(this.onBlockCacheItemChanged);La.za.jvb(this.onBlockCacheItemChanged);
Ca.a(this.$).Tm.WAa(this.hZ);bb.ea.WH(this.lJ);la.a(bb).tje(this.aw);La=E.a(this.$);r.a.instance.Qa(f.a.Ui,this.hj,this.onKeyDown);this.IZa.Q5k();La&&La.T6a(this.aZ);k.a(bb).VH(this);Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.RUc(this.GA),bb.la.Kma(313))}this.Wa&&this.Wa.kFg(this.nrg);l.a.gj([this.eM,this.KId,this.Bgg,this.wFc,this.nameBox]);l.a.dh(this.PF);this.xw&&(J.DOMElementExtensions.nM(this.xw),
this.xw.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.xw=null;super.dispose()}endEdit(bb,La,pb,fa=null){this.Wa.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:bb,["Caller"]:La});this.tyb(!1);if(this.isEditing){var kb=null;fa&&(kb=this.$.shortcutKeyManager.FD(fa));var db=this.grid.Fh;this.isEditing=!1;this.xO(!0);this.wpb()&&this.grid.NI&&this.grid.NI.Lkb&&this.grid.NI.Ewb(v.a.wUb);if(bb){var gb=new y.a(this.grid.ha.qa.activeCell,
db.text,db.text,!1,this.grid.$.sa.ma);this.lzg(gb);null!==gb&&(db.text=gb.newValue)}else this.Wa.setPlainText(this.text);gb=new C.a(this.grid.ha.qa.activeCell,db.text,bb,fa);this.xfe(gb);db.endEdit(bb,`${La}->FormulaBar.EndEdit`,pb,fa);this.p3f(kb)||db.Wa.focus();this.Wa.Y9b("FormulaBar.EndEdit")}else this.Wa.Y9b("FormulaBar.EndEdit",{["IsEditing"]:"false"})}lna(bb,La,pb,fa=!0,kb=!0){super.lna(bb,La,pb,fa,kb);this.grid.Fh.lna(bb,La,pb,fa,kb)}bxg(bb){const La=this.grid.Fh,pb=this.Wa.selection;pb.length&&
La.lna(pb.index,pb.length,bb,!1,!1)}tq(bb){return J.DOMElementExtensions.eo(this.xw,bb)}Qs(){h.AFrameworkApplication.ra.Km.Ev(this.hl)}nu(){}$5g(bb){this.nameBox.j8k(bb);this.KId.n8k(bb)}BAe(){if(this.J0){var bb=Object(yc.g)(this.text);this.NDc!==bb&&(this.dRg(bb),this.NDc=bb)}}M8d(){this.Wa.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const bb=this.grid.Fh;bb.isEditing&&this.isEditing&&(bb.formattedText=this.formattedText,bb.setCaretPosition(this.Wa.caretPosition))}Z1b(bb){this.Wa.disabled||
(this.grid.cellTextEditBox.Wa.QM=!0,this.isEditing||this.startEdit(!1,!0,bb),this.$ua())}Osb(){this.tZ&&(this.hX=this.Wa.caretPosition,this.G3=this.Wa.Gqa.length);this.$Z(null);this.$Aa();this.z3g()}hAa(bb){var La=this.$.shortcutKeyManager.FD(bb);const pb=this.IWb;1872288872===La||125627505===La||267796030===La?super.hAa(bb):pb?hb.g(bb):this.isEditing&&this.grid.Fh.isEditing&&(La=this.grid.Fh,La.formattedText=this.formattedText,La.setCaretPosition(this.Wa.caretPosition),this.D3c(),0===this.Wa.selection.length&&
this.$Z(null,null),this.wlj&&this.inRangePicker&&this.Jue(),super.hAa(bb))}Jj(bb,La){this.isEditing&&super.Jj(bb,La)}Vy(bb,La){this.isEditing&&super.Vy(bb,La)}Jvk(){this.$.ea.rya?(c.ULS.sendTraceTag(507585433,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.aZ(null,null)):E.a(this.$).oGa(this.aZ)}gbj(){const bb=this.grid.zh(void 0);bb?(this.NDc=bb.HC||Object(yc.g)(bb.text),this.dRg(this.NDc)):c.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}dRg(bb){J.DOMElementExtensions.toggleCssClass(this.J0,
w.a.YEd,bb)}upe(bb,La){this.xw=vb.dHf(bb);this.xw.classList.add(w.a.Doi);this.xw.classList.add(w.a.Eoi);M.a.Jz()&&this.xw.classList.add(w.a.Boi);Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFluentHighLightsEnabled",!1)&&this.xw.classList.add("ewa-fb-fluent-formula-highlight");const pb=this.IZa.y$h(La);La=vb.lAd();pb.appendChild(La);vb.Pwa=vb.x6h(bb.xi);const fa=vb.q6h(),kb=vb.g8h(bb.xi),db=vb.f8h(bb.xi),gb=vb.R4h(bb.xi);db.tabIndex=-1;gb.tabIndex=-1;kb.appendChild(gb);kb.appendChild(db);
kb.appendChild(vb.Pwa);fa.appendChild(kb);fa.appendChild(pb);bb=vb.J7h(bb.xi);this.xw.appendChild(bb);this.xw.appendChild(fa);const Kb=new oc.a(La,!0,!1);this.J0=La;this.IZa.lineHeight=Kb.EMi();Kb.$ea(()=>{Db.c(Kb.Yl,m.a.ariaLabel,"formula bar")});Kb.$ea(()=>{this.IZa.Uik(this.iha?{onScroll:()=>this.zfe()}:{})});Kb.isVisible=!1;return Kb}$4a(bb){this.uTc(bb);super.$4a(bb);Nb.b(this.$).Aj(K.a.Nzi,{["Location"]:"canvas"});x.a.oo&&window.focus();const La=this.$.shortcutKeyManager.FD(bb);this.i$j(bb,
La);this.Wa.disabled||this.isEditing||this.startEdit(!0,!1,bb);let pb;pb={};pb.wasEditing=this.isEditing;pb.formulaBar=!0;let fa=this.Dq(bb,La);!fa&&ac.d(La,this.Kob,!0)&&(fa=this.p3f(La)?!0:this.grid.ha.Dq(bb,La,pb));fa||Aa.a(this.$).D3d(bb,0,7)}startEdit(bb,La,pb){const fa=this.grid;if(!this.isEditing||!fa.isEditing){this.Wa.Y9b("FormulaBar.StartEdit");this.Wa.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:bb,["IsOnMouseDown"]:La});Nb.b(fa.$).Aj(K.a.Mzi,{["Location"]:"canvas"});
this.isEditing=this.IWb=!0;fa.NB&&fa.NB.nYc(this);fa.cellTextEditBox.xO(!1);fa.cellTextEditBox.cle();this.Mpe(!1);var kb=()=>{var db=fa.$.sa.ma;const gb=fa.zh(null);db=new B.a(gb,db,void 0,void 0,void 0,this.zMd(gb));this.yfe(db);this.G7b(fa.cellTextEditBox.Wa.WO);db=()=>{if(this.isEditing&&fa.isEditing){fa.isEditing&&fa.cellTextEditBox.Wa.detachCursorFormat();if(!this.$Z(null)){const ub=fa.cellTextEditBox.formattedText;var Kb=this.Wa.caretPosition;const lb=ub.Text.length;Kb=this.Wa.text.length!==
lb?lb:Kb;this.formattedText=ub;this.Wa.caretPosition=Kb}this.IWb=!1;this.Wa.clearHistory()}else this.isEditing=!1};Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePostTaskHelperInFormulaBarStartEdit",!1)?void Object(nb.b)(db):setTimeout(db,0);fa.cellTextEditBox.iIg()};if(fa.isEditing)fa.CM=1,kb();else if(this.Wa.QM=!0,U.TaskExtensions.Xa(fa.startEdit(!1,1,pb,!1,void 0,La,1),db=>{db.result?(fa.isEditing||(this.Wa.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),c.ULS.sendTraceTag(37003425,
0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.isEditing&&fa.isEditing?(fa.cellTextEditBox.Wa.QM=!0,db=fa.zh(null),this.Wa.qBf(Number.NaN,this.zMd(db)),bb&&this.Wa.setCaretPositionToEnd(),kb()):this.isEditing=!1):this.isEditing=!1},this.ya,11),this.Wa.QM=!1,La=fa.zh(null),null===La||void 0===La?0:La.yXd)this.Wa.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=Ia.HelperMethods.$Yg(this.text)}}xQd(bb){super.xQd(bb);this.TGc&&
this.grid&&this.grid.isEditing&&2===bb&&this.W$b(!this.UZf)}onActiveCellChanged(bb,La){super.onActiveCellChanged(bb,La);this.aqe()}o8a(bb){Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&c.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!bb}`);super.o8a(bb)}aqe(){const bb=this.grid;bb.isEditing&&2===bb.CM||this.XPa()}tm(){var bb=this.grid;this.isEditing&&bb.isEditing&&(bb=bb.Fh,bb.text=
this.text,bb.setCaretPosition(this.Wa.caretPosition),this.inRangePicker&&this.Wa.focus())}XPa(){this.u0g()}qHk(){if(this.Wa){var bb=this.grid;this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,["TextBox.Initialized"]:this.Wa.initialized,["Grid.IsEditing"]:bb.isEditing});if(!this.isEditing){var La=Ca.a(this.$).wv();this.xw.disabled=La||!this.$.isEditMode;var pb=(La=this.$.QX===bb)&&1===bb.ha.Ck;this.Wa.initialized&&(this.Wa.disabled=this.xw.disabled||
La&&!pb);La=new zc.a(this.Wa.style);var fa=!1;if(pb)if(bb.isEditing)this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),pb=bb.cellTextEditBox.text;else{fa=bb.zh(null);pb=new ba.a(this.$.sa);if(!fa||!pb.qpb(fa.range,bb))return;bb=pb.wn;pb=fa.un;var kb=fa.formulaBarText;const db=fa.text;this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:bb,
["activeCell.IsHidden"]:pb,["activeCell.FormulaBarText"]:!!kb,["activeCell.Text"]:!!db});pb=bb&&pb?"":kb||db;fa=fa.ete}else pb="",kb=bb.ha.$e.Lh,kb=(null===kb||void 0===kb?0:kb.floatingObject)?kb.floatingObject.Ch:null,64===bb.ha.Ck&&kb&&kb.IsShapeFormulaPresent&&((bb=(bb=kb.ShapeText)?bb.substring(bb.indexOf(zb.a.jzc)+zb.a.jzc.length,bb.indexOf(zb.a.cCf)):null)?(this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),pb=
"="+bb):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.Mpe(fa);this.wDb=this.Zpc();La.hF.direction=this.o6?t.a.rtl:t.a.F3a;La.hF.textAlign=this.o6?t.a.right:t.a.left;M.a.Jz()&&J.DOMElementExtensions.toggleCssClass(this.J0,w.a.cxc,this.o6);La.n$();this.text=pb}}}cRg(){if(!Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8759863_SetTextBoxForActiveItemInternalRefactor"))this.qHk();else if(this.Wa){var bb=
this.grid;this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,["TextBox.Initialized"]:this.Wa.initialized,["Grid.IsEditing"]:bb.isEditing});if(!this.isEditing){var La=Ca.a(this.$).wv();this.xw.disabled=La||!this.$.isEditMode;La=this.$.QX===bb;this.Wa.initialized&&(this.Wa.disabled=this.xw.disabled||La&&!bb.qXd);if(bb=zb.a.dcf(bb))this.pHk(bb.uJa),this.Mpe(bb.Pca),this.wDb=this.Zpc(),La=new zc.a(this.Wa.style),La.hF.direction=this.o6?t.a.rtl:t.a.F3a,
La.hF.textAlign=this.o6?t.a.right:t.a.left,M.a.Jz()&&J.DOMElementExtensions.toggleCssClass(this.J0,w.a.cxc,this.o6),La.n$(),this.text=bb.uJa}}}pHk(bb){if(this.grid.qXd)if(this.grid.isEditing)this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"});else{bb=new ba.a(this.$.sa);const La=this.grid.zh(null);this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:bb.wn,
["activeCell.IsHidden"]:La.un,["activeCell.FormulaBarText"]:!!La.formulaBarText,["activeCell.Text"]:!!La.text})}else bb&&64===this.grid.ha.Ck&&this.Wa.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"})}DMi(){return{formulaBarText:this.text,zY:this.zY(),bMa:this.o6,Pca:this.VTg}}vPg(){var bb=this.$.QX;if(this.RVd){var La=!!this.grid.CU&&this.grid.CU.UO;this.isVisible=bb=!!bb&&this.$.NId&&!this.$.ea.Ih.inEmbedView;La||(this.Wa.isVisible=
bb)}else this.isVisible=!!bb&&this.$.NId&&!this.$.ea.Ih.inEmbedView;this.c2f&&h.AFrameworkApplication.ra.$g.fl&&(La=document.getElementById("AdditionalBarsRegion"))&&(La.style.height="",this.$.$0()&&(La=document.getElementById("RibbonRegion"),!this.Z0f&&La&&(La.style.height="",this.$.aPb(),this.Z0f=!0)));Sa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")&&M.a.O1a()?this.$Ba.NM(v.a.S8a):this.$.oP(v.a.S8a);M.a.O1a()&&this.$Ba.A5k();this.$.bQ()}Mpe(bb){this.VTg=bb;J.DOMElementExtensions.toggleCssClass(this.Wa.domElement,
w.a.rvf,bb)}aKa(){return this.xw.querySelectorAll(J.DOMElementExtensions.RI+", div[tabindex]")}DE(){return J.DOMElementExtensions.DE(this.aKa())}Pyi(){const bb=this.DE();return bb?(J.DOMElementExtensions.setFocus(bb),!0):!1}i$j(bb,La){La=-287251124===La||-1925065947===La||1764140053===La;Pa.a.Apb()&&La&&bb.preventDefault()}qnc(bb=!1){this.W$b(!this.$.isEditMode,bb);if(M.a.Jz()){const La=()=>{this.J0&&J.DOMElementExtensions.toggleCssClass(this.J0,w.a.Rjb,!this.$.isEditMode)};bb?La():Object(nb.c)(()=>
{La()},this.$.ya)}}G7b(bb){this.Wa.WO=bb}toggleEditingEvents(bb){this.Wa.toggleEditingEvents(bb)}Vcj(){this.xw?this.kdj():this.gHg()}Tqk(){M.a.O1a()?this.$Ba.T3k(this.HQi()):(Ub.a.instance.j2(v.a.E5,xc.a.Drb),Ub.a.instance.zZ(v.a.E5,xc.a.Drb));Ub.a.instance.wca(v.a.E5,xc.a.Drb)}HQi(){return{V_b:this.nameBox.text}}gHg(){c.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}p3f(bb){return!this.hCe&&(125627505===bb||706199415===bb)}get text(){return super.text}static dHf(bb){return document.getElementById(bb.xi+
v.a.yib)}static q6h(){const bb=document.createElement("div");bb.className=w.a.xoi;bb.classList.add(w.a.q0);return bb}static g8h(bb){const La=document.createElement("div");La.id=bb+vb.SMj;La.className=w.a.RMj;La.classList.add(w.a.q0);return La}static lAd(){const bb=Pa.a.Apb(),La=document.createElement(bb?"div":"textarea");La.className=w.a.Foi;M.a.I0f()&&La.classList.add(w.a.Hoi);Sa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFluentStylingEnabled",!1)&&La.classList.add("ewa-fb-fluent-border-highlight");
La.classList.add(w.a.Goi);La.classList.add(w.a.OKj);bb?La.id=v.a.EQb:(La.cols=20,La.rows=2);return La}static x6h(bb){const La=document.createElement("div");La.id=bb+v.a.DQb;La.className=w.a.zCf;J.DOMElementExtensions.pL(La,v.a.FF);La.setAttribute(v.a.tD,"insert function");La.tabIndex=0;La.classList.add(w.a.q0);return La}static f8h(bb){const La=document.createElement("div");La.id=bb+vb.vOc;La.className=w.a.Cgg;J.DOMElementExtensions.pL(La,v.a.FF);La.setAttribute(v.a.tD,"commit edit");La.tabIndex=0;
La.classList.add(w.a.q0);return La}static R4h(bb){const La=document.createElement("div");La.id=bb+vb.kqc;La.className=w.a.Adf;J.DOMElementExtensions.pL(La,v.a.FF);La.setAttribute(v.a.tD,"cancel edit");La.tabIndex=0;La.classList.add(w.a.q0);return La}static J7h(bb){const La=document.createElement("div");La.id=bb+v.a.UBf;La.className=w.a.Coi;return La}}vb.SMj="okCancelButtonContainer";vb.vOc="okboxButton";vb.kqc="cancelboxButton";vb.Pwa=null;Object(A.a)(vb,"FormulaBar",n.a,[47])},1359:function(A,u,
a){a.d(u,"d",function(){return m});a.d(u,"c",function(){return x});a.d(u,"b",function(){return n});a.d(u,"a",function(){return t});var c=a(28),b=a(683),h=a(1360),r=a(129),f=a(143),l=a(665);const m=v=>255<v.length||!w(v)||c.a.bI(v,"_xl")?!1:!0,x=(v,k)=>{var y=k.ha;k=y.qa.Bn;y=y.qa.activeRange;return v.sa.ma&&k?b.b(v.$h,y,v.sa.ma.name):null},n=v=>{let k=null;v=v.ha.$e;v.isFloatingObjectSelected&&(k=v.Lh.floatingObject);return k},t=(v,k=!0)=>{const y=h.a.getInstance(v),C=y.WQi();C&&!v.$h.Lq(C)&&l.a(f.a.jZh,
[r.a.Wdg],!0,!0,!1,!1,null);y.stop(k)},w=v=>{if(!v.length)return!1;for(let k=0;k<v.length;k++){const y=v.charAt(k),C=v.charCodeAt(k);if(!k){if("\\"!==y&&"_"!==y&&!c.a.isLetter(C))return!1}else if("_"!==y&&"."!==y&&!c.a.c0f(C)&&!c.a.isNumeral(C))return!1}return!0}},1360:function(A,u,a){A=a(0);var c=a(15);class b{constructor(h){this.start=r=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):(this.Jp.start(),
this.inProgress=!0,this.Reg=r)};this.stop=(r=!0)=>{this.inProgress&&(this.Jp.stop(),r&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.Jp.zi}}`),this.inProgress=!1,this.Reg=void 0)};this.WQi=()=>this.Reg;this.Jp=h.Eh.em("UserAction","CreateNamedObjectTimer");this.inProgress=!1}}b.getInstance=h=>{void 0===b.instance&&(b.instance=new b(h));return b.instance};u.a=b;Object(A.a)(b,"NameBoxTelemetry",null,[])},1495:function(A,u,a){u=a(483);a=a(1496);a=a.Qw?a.default:a;"string"===
typeof a&&(a=[[A.i,a,""]]);u(a,{insert:"head",eD:!1});A.exports=a.EH||{}},1496:function(A,u,a){u=a(484)(!1);u.push([A.i,'.ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-presence-cover,.ewa-fb-text-box{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-monospace-experiment,.ewa-fb-text-box-new-theme{overflow:hidden;border:1px solid #e6e7e8;outline:0;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-presence-cover,.ewa-root-ltr .ewa-fb-text-box{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#107C41}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0!important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit!important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000!important;border:1px solid #000!important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on .ewa-fb .okbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb .cancelbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor ::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130!important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886!important}.ewr-presentMode-transition .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition .functionbox.button-disabled,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb.ewa-fb-refactor.ewa-fb-fluent{height:24px;background-color:#F5F5F5;color:#444;overflow:hidden;padding:4px 8px;position:relative;margin:0;gap:8px;flex-flow:row}.ewa-fb-fluent .ewa-fb.drop-down{flex-flow:row;gap:8px;padding-left:0;padding-right:0}.ewa-fb-fluent .ewa-fb.drop-down .ok-cancel-buttons-container{display:flex;width:66px;border:1px solid #D1D1D1;border-radius:4px;flex-flow:row;top:0;margin:0}.ewa-fb-fluent .functionbox{display:flex;align-items:center;justify-content:center}.ewa-root-ltr .ewa-fb-fluent .functionbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-root-rtl .ewa-fb-fluent .functionbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-ltr .ewa-fb-fluent .cancelbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-rtl .ewa-fb-fluent .cancelbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-fb-fluent .cancelbox:hover,.ewa-fb-fluent .ewa-fb-expand-button-container:hover,.ewa-fb-fluent .functionbox:hover,.ewa-fb-fluent .okbox:hover{background-color:#F5F5F5}.ewa-fb-fluent .cancelbox:focus,.ewa-fb-fluent .ewa-fb-expand-button-container:focus,.ewa-fb-fluent .functionbox:focus,.ewa-fb-fluent .okbox:focus{background-color:#E0E0E0}.ewa-fb-fluent .cancelbox.button-disabled,.ewa-fb-fluent .functionbox.button-disabled,.ewa-fb-fluent .okbox.button-disabled{pointer-events:none;background-color:#FFF!important}.ewa-fb-fluent .cancelbox.button-disabled path,.ewa-fb-fluent .functionbox.button-disabled path,.ewa-fb-fluent .okbox.button-disabled path{fill:#BDBDBD}.ewa-fb-fluent .ewa-fb-text-div-container{display:flex;border-radius:4px;flex-flow:column}.ewa-fb-fluent .ewa-fb-expand-button-container{order:1;height:20px;width:20px;border-radius:4px;flex-grow:0;padding:0}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 4px 0 0}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 0 0 4px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new{border:1px solid #D1D1D1;border-radius:4px;top:0;line-height:16px;padding:3px 0 5px 0;color:#242424}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie.no-scrollbar-gutter-support .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-rtl .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:12px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement>.ewa-rteLine{cursor:text}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:calc(100% - 4px);width:calc(100% - 22px);margin-top:2px;cursor:default}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:4px;background-color:grey;background-clip:padding-box}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 8px}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 14px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within{outline:0;border:1px solid #D1D1D1;border-bottom-style:none}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:4px;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:3px solid #107c41;clip-path:inset(calc(100%-3px) 0 0)}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-disabled{border:1px solid #D1D1D1;border-radius:4px;background-color:#F5F5F5}.ewa-fb-fluent .cancelbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .functionbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .okbox.button-disabled.ewa-fb-disabled{background-color:#F5F5F5!important}.ewa-root-ltr .ewa-fb-rtl .ewa-rteLine{padding-right:20px!important}.ewa-fb-fluent .ql-editor ::selection{background:#616161;color:#FFF}.skel-fb-namebox-wrapper{height:24px;width:124px;line-height:22px;padding:0 16px 0 0;border-color:#d1d1d1;position:relative;background-color:#fff;border-width:1px;border-style:solid;overflow:hidden;white-space:nowrap;box-sizing:border-box;border-radius:4px}.skel-fb-namebox-wrapper.skel-legacy-namebox{border-radius:0;line-height:16px;border-color:#e1dfdd;margin:4px}.skel-fb-namebox-button{position:absolute;border:none;padding:0;background-color:transparent;color:#797775;min-width:16px;right:-1px;display:flex;height:24px;justify-content:center;align-items:center}.skel-fb-namebox-rtl{left:-1px;right:auto}.skel-fb-namebox-icon{display:flex;width:12px;fill:#252423;align-items:center;justify-content:center}.skel-legacy-namebox .skel-fb-namebox-icon{font-size:12px;margin:0;height:8px;line-height:8px;text-align:center;flex-shrink:0;display:flex;width:8px;align-items:center}.skel-fb-namebox-disabled{background-color:#f5f5f5}.skel-fb-namebox-disabled .skel-fb-namebox-span{color:#c8c6c4}.skel-fb-namebox-disabled .skel-svg-disabled{fill:#939393}.skel-fb-namebox-disabled svg{opacity:.4}.skel-fb-namebox-span{color:#252423;float:left;margin-right:4px;height:16px;line-height:16px;background-color:transparent;box-sizing:border-box;width:100px;border-style:none;outline:0;text-overflow:ellipsis;font-size:12px;padding:4px}.skel-fb-namebox-span.skel-fb-namebox-v9{font-family:"Aptos Narrow","Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;font-size:11pt;line-height:15px}',
""]);A.exports=u},867:function(A,u,a){a.r(u);A={};a.r(A);a.d(A,"FormulaBarCommandHandler",function(){return Ia});var c=a(135);u=a(0);a(210);var b=a(15),h=a(149),r=a(599),f=a(73),l=a(154),m=a(140),x=a(10),n=a(27),t=a(46),w=a(683),v=a(124),k=a(268),y;(function(ia){ia[ia.NONE=0]="NONE";ia[ia.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";ia[ia.PRINT_AREA=2]="PRINT_AREA";ia[ia.DISCONTINUOUS_RANGES=3]="DISCONTINUOUS_RANGES";ia[ia.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";ia[ia.INVALID_NAME=5]="INVALID_NAME";
ia[ia.EMPTY_RANGE=6]="EMPTY_RANGE";ia[ia.GENERIC_ERROR=7]="GENERIC_ERROR";ia[ia.VIEW_MODE=8]="VIEW_MODE"})(y||(y={}));Object(u.b)("NameBoxInvalidOperation",y);var C=a(36),B=a(28),E=a(12),K=a(129),F=a(143),W=a(665),J=a(106);class L extends k.a{constructor(ia,wa){super(ia,wa);this.fw()}get Di(){return"NameBoxErrorDialog"}fw(){super.fw();const ia=this.error.Caption,wa=this.ZKi(this.error),Jb=this.YKi(this.error);this.Ph=0;this.Uta(Jb);this.hp(ia,wa,2,this.C2)}ZKi(ia){return B.a.equals(ia.MessageIdName,
L.b3c,!0)?String.format(ia.Description):B.a.equals(ia.MessageIdName,L.gVb,!0)?"":ia.Description}YKi(ia){const wa=[];B.a.equals(ia.MessageIdName,L.gVb,!0)&&(ia=String.format(E.a.instance.ia(2253)),wa.push(...ia.split("-").map(Jb=>Jb.trim())));return wa}static x1(ia,wa=null){if(ia.MessageIdName===L.gVb)b.ULS.sendTraceTag(528053385,0,50,ia.Caption);else{let Jb=ia.Caption;ia.MessageIdName===L.b3c&&(Jb=`Unsupported Operation: ${y[wa]}`);ia=new J.a;ia.ga("errorCaption",Jb);W.a(F.a.Gti,[K.a.Wdg],!0,!0,!1,
!1,ia)}}static nj(ia){switch(ia){case 3:case 1:case 2:return C.a.nj(1,0,2254,2255,0,-1280789630,L.b3c);case 5:case 4:return C.a.nj(1,0,2252,2253,0,875859818,L.gVb);case 8:case 7:return C.a.nj(1,0,0,1,0,424201999,L.gVb);case 6:return C.a.nj(1,0,2256,2257,0,-1280789630,L.b3c);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}L.b3c="NameBoxUnsupportedOperation";L.gVb="NameBoxInvalidName";Object(u.a)(L,"NameBoxErrorDialog",k.a,[]);const M=
(ia,wa,Jb,$a,Ka,nb,sa)=>{a:switch(sa){case 2:sa="Table";break a;case 3:sa=B.a.ROb(wa,"Print_Area")?"Print Area":"Named Range";break a;default:sa="Unknown"}return{key:ia,name:wa,sheetName:Jb,topLeft:$a,bottomRight:Ka,location:nb,type:sa}};var Q=a(1359),H=a(1),ba=a(23),U=a(155),D=a(1360);class I{constructor(ia,wa){this.printArea="Print_Area";this.jvk="R";this.wZh="C";this.VIj="Value";this.$=ia;this.da=ba.f(this.$);this.dNa=wa;this.WIj=D.a.getInstance(this.$)}H7j(){var ia=this.$.$h.items,wa=this.$.ma.name;
const Jb={};for(var $a of ia){ia=w.a($a.name);var Ka=ia.txb;if(f.h($a)&&(!Ka||B.a.equals(ia.scope,wa,!1))){var nb=ia.name in Jb;if(!nb||nb&&Ka)Jb[ia.name]={["namedObjectDetails"]:ia,["namedObjectItem"]:$a}}}wa=[];for(const sa in Jb)ia=Jb[sa],$a=ia.namedObjectItem,ia=ia.namedObjectDetails,Ka=`${$a.sheetName}!${$a.usedRange.topLeft.FE(!1)}:${$a.usedRange.bottomRight.FE(!1)}`,nb=$a.type,wa.push(M($a.name,ia.name,$a.sheetName,$a.usedRange.topLeft.FE(!1),$a.usedRange.bottomRight.FE(!1),Ka,nb));wa.sort((sa,
na)=>sa.name.localeCompare(na.name));this.dNa.I7j(wa);Q.a(this.$,!1);this.eHg(wa.length)}P3i(ia){ia=w.a(ia[this.VIj].toString());const wa=ia.name,Jb=ia.scope.length?ia.scope:null;var $a=this.yWh(ia);this.Zyk(ia)||(this.Czj(ia),0!==$a?(this.dNa.pqf(this.$,$a),this.mJg()):Q.d(wa)?($a=t.t(ba.f(this.$).ha.qa.selectedRanges,this.$),this.dNa.K7h(this.$,wa,$a,Jb,I.fNj,I.eNj),this.WIj.start(ia.name)):(this.dNa.pqf(this.$,5),this.mJg()))}hId(){this.dNa.hId()}Zyk(ia){const wa=ia.fullName,Jb=ia.name,$a=ia.scope;
let Ka,nb,sa=!1;!({sheetName:Ka,range:nb}=t.jb(wa,this.$.sa)).returnValue||!nb.AB&&H.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?B.a.equals(Jb,this.jvk,!0)?(this.$yk($a),this.W6a(2)):B.a.equals(Jb,this.wZh,!0)?(this.Ryk($a),this.W6a(2)):this.$.$h.Lq(wa)?(this.GMg(wa),this.W6a(ia.txb?1:0)):this.$.$h.Lq(Jb)?(this.GMg(Jb),this.W6a(0)):sa=!0:(this.Uyk(Ka,nb),this.W6a(3));return!sa}Uyk(ia,wa){ia=ia||this.$.sa.ma.name;var Jb=w.b(this.$.$h,wa,ia);w.c(Jb)||
(Jb=t.x(wa,this.$),Jb.SheetName=ia,ba.f(this.$).ep(Jb,wa.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.da.focus())}$yk(ia=null){const wa=this.da.ha.qa.activeCell;this.jef(ia)&&(ia=new n.Range(wa.top,0,wa.bottom,x.a.Gk,!0,!1),this.da.ha.yN([ia],0,ia,0))}Ryk(ia=null){const wa=this.da.ha.qa.activeCell;this.jef(ia)&&(ia=new n.Range(0,wa.left,x.a.Rk,wa.right,!0,!1),this.da.ha.yN([ia],0,ia,0))}jef(ia){return ia?(ia=this.$.sa.getItemByName(ia),(null===ia||void 0===ia?0:ia.visible)?
(ia.activate({scenario:"namedObject"}),!0):!1):!0}GMg(ia){ia=this.$.$h.getItemByName(ia);w.c(ia);this.da.focus()}yWh(ia){return this.$.isEditMode?this.hlj()?1:B.a.equals(ia.name,this.printArea,!0)?2:this.Mfi()?3:this.G9i(ia)?4:this.gkj()?6:0:8}mJg(){var ia=Q.b(this.da);null!=ia?this.dNa.Bvd("",ia.name):(ia=Q.c(this.$,this.da))?this.dNa.Bvd(ia.name,ia.name):this.dNa.Bvd("",this.da.ha.qa.activeCell.toString())}hlj(){return!!this.da.ha.$e.activeFloatingObjectControlId}Mfi(){return 1<this.da.ha.qa.selectedRanges.length}G9i(ia){return ia.txb&&
!this.$.nV(ia.scope)}gkj(){return this.da.oh.OLa(this.da.ha.qa.selectedRanges[0])}static fNj(ia){return wa=>{C.a.jl(wa.Errors)&&(L.x1(wa.Errors[0]),new L(ia,wa.Errors[0]),D.a.getInstance(ia).stop(!1))}}static eNj(ia){return wa=>{(wa=v.a.gk(wa.data))&&0<wa.length?(L.x1(wa[0]),new L(ia,wa[0])):(L.x1(L.nj(7)),new L(ia,L.nj(7)));D.a.getInstance(ia).stop(!1)}}Czj(ia){const wa=null!=Q.c(this.$,this.da);ia.txb?this.W6a(wa?7:6):this.W6a(wa?5:4)}W6a(ia){U.b(this.$).Aj(l.a.vWk,{type:ia.toString()},null,!0)}eHg(ia){U.b(this.$).Aj(l.a.Hvg,
{bjl:ia},null,!0)}}Object(u.a)(I,"NameBoxCommandHandler",null,[]);var X=a(427),Y=a(216),ja=a(64);const Ua=(ia,wa,Jb,$a,Ka,nb,sa,na,ab,Ja,Pa=null)=>{Pa=ia.$a(9,Pa);Pa.name=wa;Pa.selectedRanges=Jb;Pa.sheetName=$a;Pa.formula=Ka;Pa.comment=nb;return ja.h(ia,"AddDefinedName",Pa,sa,na,ab,Ja,0)};var ka=a(264),fb=a(117),ha;(function(ia){ia[ia.EMPTY_RANGE=0]="EMPTY_RANGE";ia[ia.RANGE_CREATED=1]="RANGE_CREATED"})(ha||(ha={}));Object(u.b)("NameBoxStatusCalloutType",ha);class ea{ggi(){this.tmf();appChrome.renderNameBoxStatusCallout(ea.o0c,
ha.EMPTY_RANGE)}ngi(ia,wa){this.tmf();const Jb=Object(t.F)(wa.Ranges[0]);appChrome.renderNameBoxStatusCallout(ea.o0c,ha.RANGE_CREATED,ia,wa.SheetName,`${Jb.topLeft.toString()}:${Jb.bottomRight.toString()}`)}tmf(){null==ea.o0c&&(ea.o0c=document.createElement("div"))}I7j(ia){fb.c()&&appChrome.populateNameBoxMenu(ia)}K7h(ia,wa,Jb,$a,Ka,nb){const sa=()=>this.ngi(wa,Jb);X.a(ia.userOperationManager,(na,ab,Ja)=>Ua(ia.pa.ta,wa,Jb,$a,"","",ka.c(na,Ka(ia),H.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")?
sa:void 0),ka.b(ab,nb(ia)),Ja,ia),na=>new Y.a(1020,0,na),null)}pqf(ia,wa){L.x1(L.nj(wa),wa);8!==wa&&(H.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")&&6===wa?this.ggi():new L(ia,L.nj(wa)))}hId(){appChrome.updateNameBoxState({["focus"]:!0})}Bvd(ia,wa){appChrome.setNamedObjectOrActiveCellRange(ia,wa)}}ea.o0c=null;Object(u.a)(ea,"NamedObjectsService",null,[257]);var aa=a(211),ca=a(67),xa=a(7),Oa=a(5),ua=a(95);let Ia=class{constructor(ia,wa){this.$=ia;this.da=ba.f(this.$);
this.Za=wa;this.E6d=new I(ia,new ea)}Ri(){return!1}executeCommand(ia,wa,Jb){wa=wa.command;ia=null;switch(wa){case 1726517890:this.E6d.P3i(Jb);break;case 2045896573:Jb=m.a(this.$);(null===Jb||void 0===Jb?0:Jb.IZa)?Jb.IZa.nyf():b.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.E6d.hId();break;case -1790328692:Jb=m.a(this.$);wa=!this.$.sWb;Jb.isVisible=wa;Jb.Wa.isVisible=wa;this.$.sWb=
wa;this.$.Dm();try{h.a.yG(xa.a.SZf,wa.toString(),r.AFrame.QCa)}catch($a){b.ULS.sendTraceTag(509216780,0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${$a.message}`)}break;default:ia=aa.a(wa)}return ia||ca.Task.Ua(!0)}Gi(ia,wa,Jb){ia=!1;switch(wa.command){case 1726517890:ia=!!Jb;break;case -1003645154:case 2045896573:ia=!0;break;case -1790328692:ia=H.EwaSettings.isChangeGateEnabled("OfficeVSO:8235335_DisplaySettings")}return ia}dj(ia,wa){if("PopulateNameBoxMenu"!==wa)return!1;
ia=this.$.Eh.Li("UserAction","PopulateNameBoxMenuTimer");this.E6d.H7j();ia.stop();return!0}eHg(ia){ia={["NamedObjectsCount"]:ia};U.b(this.$).Aj(l.a.Hvg,ia,null,!0)}};Ia=Object(c.__decorate)([Object(ua.d)(Oa.Jc),Object(c.__param)(0,Object(Oa.Nb)()),Object(c.__param)(1,Object(Oa.uf)())],Ia);Object(u.a)(Ia,"FormulaBarCommandHandler",null,[34]);var Sa=a(9);c=a(428);var Ya=a(77),da=a(39),Ea=a(1161),oa=a(45),za=a(921),la=a(25),Ca=a(91);class Va extends c.a{constructor(ia){super();this.$=ia;this.gm()}create(){oa.a.instance.PCa(xa.a.E5);
const ia=Ya.GetServiceTaskFactory.Tj(this.$.la,388,387,this.xh),wa=la.a.O1a()?Object(Ca.d)(ua.a.resolve(Oa.cg)):ca.Task.Ua(null);da.TaskExtensions.Xa(da.TaskExtensions.Vo([ia,wa],this.ya),()=>{this.Bk(Object(za.a)(this.$.la,172,()=>new Ea.FormulaBar(this.$,wa.result,ia.result)))},this.$.ya,3)}}Object(u.a)(Va,"FormulaBarFactory",c.a,[]);(()=>{Sa.a.gh(ia=>{H.EwaSettings.isChangeGateEnabled("OfficeVSO:8704628_importFBLessAsCoreCss")||a(1495);ia.la.Hh(186,new Va(ia))})})();String(A);window.___1710758652348_closurehack=
A}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/fc3cd8800d495c5ef77396531936fdbf/EwaTS.vrd.js.map